{"version":3,"file":"js/chunk-common.js","mappings":"2IAGO,MAAMA,EAAwBC,OACnC,oC,oECFK,MAAMC,EAAyB,CACpCC,OAAAA,CAAQC,GAENA,EAAGC,aAAa,YAAa,SAG7B,MAAMC,EAAqBC,IACzBA,EAAQF,aAAa,YAAa,SAClCE,EAAQC,WAAWC,SAASC,IACtBA,aAAiBC,aACnBL,EAAkBI,E,GAEpB,EAGJJ,EAAkBF,EACpB,E,kFCFK,MAAMQ,EAA2B,CACtCT,OAAAA,CACEC,EACAS,EACAC,EACAC,GAEA,MAAMC,EAAUC,EAAgBb,GAkBhC,SAASc,IACP,MAAMC,EAAYC,EAAUP,GACtBQ,EAAaC,EAAeC,EAAAA,GAAiBJ,GAC7CK,EAAsBC,EAAmBJ,GAC/CL,EAAQU,MAAQF,EAAoBG,UACtC,CAtBAX,EAAQX,aAAa,qBAAsBe,EAAUP,GAASe,KAAK,MAEnExB,EAAGyB,iBAAiB,SAAUC,IAC5B,MAAMX,EAAYC,EAAUP,IACrBkB,KAAgBC,GAAcb,EAC/BO,EAAQZ,EAAMV,GAAGsB,MACjBO,EAAWC,KAAKC,MACpBD,KAAKE,UAAUb,EAAAA,GAAgBc,iBAEjCC,EAAeL,EAAUD,EAAYN,GACrCH,EAAAA,GAAgBgB,YAAY,CAC1BC,kBAAmBP,EACnBQ,UAAWtB,EAAUS,KAAK,OAE5Bc,QAAQC,IAAIvC,EAAIS,EAASC,EAAOC,EAAWe,EAAIX,EAAWO,EAAM,IASlEkB,EAAAA,GAAMC,OACJ,KACE,MAAM1B,EAAYC,EAAUP,GAC5B,OAAOS,EAAeC,EAAAA,GAAiBJ,EAAU,IAEnD,IAAMD,MAERA,GACF,GASF,SAASE,EAAUP,GACjB,GAA6B,kBAAlBA,EAAQa,MACjB,MAAM,IAAIoB,MAAMC,EAA2BlC,EAAQa,OAErD,MAAMP,EAAYN,EAAQa,MAAMsB,MAAM,KAChCjB,EAAcZ,EAAU,GAC9B,GAAoB,mBAAhBY,EACF,MAAM,IAAIe,MAAMG,EAAoCpC,EAAQa,OAE9D,OAAOP,CACT,CAEA,SAASF,EACPb,GAEA,GACEA,aAAc8C,kBACd9C,aAAc+C,qBACd/C,aAAcgD,kBAEd,OAAOhD,EAET,MAAM,IAAI0C,MAAMO,EAClB,CAEA,SAAS5B,EAAmB6B,GAC1B,GACiB,kBAARA,GACQ,kBAARA,GACQ,mBAARA,EAEP,MAAM,IAAIR,MAAMS,SAAwCD,GAE1D,OAAOA,CACT,CAEA,SAAShC,EAAekC,EAAWC,GACjC,OAAOA,EAAKC,QAAO,CAACC,EAAkBC,KACpC,IAAKC,OAAOC,UAAUC,eAAeC,KAAKL,EAAaC,GACrD,MAAM,IAAId,MAAMmB,EAAmBR,EAAK7B,KAAK,MAE/C,OAAO+B,EAAYC,EAAc,GAChCJ,EACL,CAEA,SAASlB,EAAekB,EAAWrC,EAA0BO,GAC3D,MAAOwC,KAAsBlC,GAAc,CAACb,EAAUgD,SAAUhD,GAChE,QAA0BiD,IAAtBF,EACF,MAAM,IAAIpB,MAAM,4BAElB,MAAMuB,EAAerC,EAAW0B,QAC9B,CAACC,EAAkCC,IACjCD,EAAYC,IACdJ,GAEFa,EAAaH,GAAqBxC,CACpC,CAGA,MAAMqB,EACJ,iKAIIE,EACJ,gQAKIM,EACJ,wJAGIU,EACJ,sFAGIZ,EACJ,gF,kFC7II,SAAUiB,EACdC,EACAC,GAEA,OACEC,EAAAA,EAAAA,IACE,+GAGF,KACAF,EALAE,gBAQAvC,KAAKE,UAAUoC,EAAW,KAAM,EAEpC,C,6rICbA,MAAME,EAAmBb,OAAOc,OAAOC,OAAOC,OAAOC,qBAAqBC,MACvEC,GAASA,EAAKC,WAEXC,GAAgBC,EAAAA,EAAAA,IAAc,CAClCC,mBAAoB,CAClBC,GAAI,UACJC,GAAI,WAENC,gBAAiBb,GAAkBjB,MAAQ,KAC3C+B,aAAcA,IAQVf,GAAWgB,EAAAA,EAAAA,SAAQP,EAAcT,UAAU,IAAIiB,IACnDxD,KAAKE,UAAUsD,KAGXC,GAAYF,EAAAA,EAAAA,SAAQP,EAAcS,WAAW,IAAID,IACrDxD,KAAKE,UAAUsD,KAOXE,IAJaH,EAAAA,EAAAA,SAAQP,EAAcW,YAAY,IAAIH,IACvDxD,KAAKE,UAAUsD,MAGCD,EAAAA,EAAAA,SAAQP,EAAcU,WAAW,IAAIF,IACrDxD,KAAKE,UAAUsD,MAGXI,GAAsBL,EAAAA,EAAAA,SAAQP,EAAca,aAAa,IAAIL,IACjExD,KAAKE,UAAUsD,I,kZCpCV,MAAMM,EAAYC,EAAAA,EAAEC,KAAK,CAAC,SAAU,SAErCC,EAAaF,EAAAA,EAAEG,OAAO,CAC1BC,KAAMJ,EAAAA,EAAEK,SACRC,KAAMN,EAAAA,EAAEK,SACRE,SAAUP,EAAAA,EAAEK,SACZG,EAAGR,EAAAA,EAAES,SACLC,EAAGV,EAAAA,EAAES,SACLE,UAAWZ,IAIAa,EAAsBZ,EAAAA,EAAEG,OAAO,CAC1CU,UAAWb,EAAAA,EAAEc,QAAQ,aACrBC,MAAOf,EAAAA,EAAEgB,MAAMd,GACfe,gBAAiBjB,EAAAA,EAAEkB,UACnBC,QAASnB,EAAAA,EAAEG,OAAO,CAChBiB,YAAapB,EAAAA,EAAEK,SACfgB,YAAarB,EAAAA,EAAEK,SACfiB,gBAAiBtB,EAAAA,EAAEK,SACnBkB,cAAevB,EAAAA,EAAEK,a,8FCpBnBmB,EAAAA,EAAAA,IAQM,OAPJC,KAAK,WACLC,OAAKC,EAAAA,EAAAA,IAAA,CAAC,yBAAwB,iBACHC,EAAAC,YAE1B,kBAAiBD,EAAAE,gB,EAElBC,EAAAA,EAAAA,IAAQH,EAAAI,OAAA,0BAHAJ,EAAAC,W,CASZ,OAAeI,EAAAA,EAAAA,IAAgB,CAC7BC,OAAQ,CAAC,gBAAiB,UAC1BC,MAAO,CACLC,MAAO,CACLC,KAAMC,OACNC,UAAU,GAEZC,KAAM,CACJH,KAAMC,OACNC,UAAU,EACVE,QAAS,KAGbC,IAAAA,GACE,MAAO,CAAEC,KAAM,GAAId,UAAU,EAC/B,EACAe,OAAAA,GACEC,KAAKF,KAAO,IAAME,KAAKT,MAAMU,cAAcC,QAAQ,KAAM,KAEzDF,KAAKG,OAAO,CACVZ,MAAOS,KAAKT,MACZO,KAAME,KAAKF,KACXH,KAAMK,KAAKL,MAEf,EACA5F,MAAO,CACLqG,aAAAA,GACEJ,KAAKhB,SAAWgB,KAAKI,gBAAkBJ,KAAKF,IAC9C,GAEFO,SAAU,CACRpB,cAAAA,GACE,MAAO,IAAMe,KAAKF,IACpB,K,UC3CJ,MAAMQ,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,KAEpE,Q,SCLO1B,MAAM,gB,GACJD,KAAK,UAAUC,MAAM,2B,6FAD5BF,EAAAA,EAAAA,IAsBM,MAtBN6B,EAsBM,EArBJC,EAAAA,EAAAA,IAmBM,MAnBNC,EAmBM,gBAlBJ/B,EAAAA,EAAAA,IAiBSgC,EAAAA,GAAA,MAAAC,EAAAA,EAAAA,IAhBO7B,EAAA8B,MAAPC,K,WADTnC,EAAAA,EAAAA,IAiBS,UAfNoC,IAAKD,EAAIvB,MACTyB,QAAKC,GAAElC,EAAAqB,cAAgBU,EAAIhB,KAC3BjB,OAAKC,EAAAA,EAAAA,IAAA,C,YAA2BgC,EAAIhB,OAASf,EAAAqB,c,0BAAmDU,EAAInB,QAA6B,KAARmB,EAAInB,MAAuB,KAARmB,EAAII,K,0BAAiDJ,EAAInB,QAA6B,KAARmB,EAAInB,MAAuB,KAARmB,EAAII,OAOjP,gBAAeJ,EAAIhB,OAASf,EAAAqB,cAC5B,gBAAeU,EAAIhB,KACnBqB,GAAE,IAAQL,EAAIhB,KACdsB,SAAU,I,QAERN,EAAIvB,OAAK,GAAA8B,M,SAGhBnC,EAAAA,EAAAA,IAAQH,EAAAI,OAAA,Y,CAOZ,OAAeC,EAAAA,EAAAA,IAAgB,CAC7BS,IAAAA,GACE,MAAO,CACLO,cAAe,GACfS,KAAM,GAEV,EACAS,OAAAA,GACE,MAAO,CACLnB,OAASW,IACP,MAAMS,EAAQvB,KAAKa,KAAKW,KAAKV,GAEf,IAAVS,IACFvB,KAAKI,cAAgBU,EAAIhB,KAC3B,EAEFM,eAAeC,EAAAA,EAAAA,KAAS,IAAML,KAAKI,gBAEvC,IC3CF,MAAM,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAAS,KAEpE,Q,6BCJA,MACMI,EAAa,CAAE3B,MAAO,eACtB6B,EAAa,CAAE7B,MAAO,wCACtBwC,EAAa,CAAExC,MAAO,uBACtB4C,EAAa,CAAC,WACdC,EAAa,CAAC,sBAAuB,UAAW,eAChDC,EAAa,CAAC,sBAAuB,UAAW,eAChDC,EAAa,CAAC,UAAW,SACzBC,EAAa,CAAEhD,MAAO,gBACtBiD,EAAa,CAAElJ,MAAO,UACtBmJ,EAAc,CAAEnJ,MAAO,QACvBoJ,EAAc,CAAEjB,IAAK,GACrBkB,EAAc,CAClBlB,IAAK,EACLmB,MAAO,CAAEC,UAAW,MAAOC,SAAU,EAAGC,WAAY,IAkBtD,OAA4BC,EAAAA,EAAAA,IAAiB,CAC3ChD,MAAO,CACP/F,eAAgB,CACdiG,KAAMzE,OACN2E,UAAU,IAGZ6C,KAAAA,CAAMC,GAER,MAAMlD,EAAQkD,ECgLRC,GAAapD,EAAAA,EAAAA,IAAwBnI,EAAAA,GAerCwL,GAHKC,IAGG7G,OAAOC,OAAO6G,gBAAgBC,kBAGtCC,GAAeC,EAAAA,EAAAA,MACfC,GAAsBD,EAAAA,EAAAA,KAAmBE,EAAAA,EAAAA,WAAU3D,EAAM/F,iBAGzD2J,GAAW7C,EAAAA,EAAAA,IAAS,CACxB8C,GAAAA,GACE,OAAOH,EAAoBpK,MAAMsF,KACnC,EACAkF,GAAAA,CAAIC,GACFL,EAAoBpK,MAAMsF,MAAQmF,EAClCC,GACF,IAYF,SAASA,EAAqB3J,GAE5BC,QAAQC,IAAI,0BACZ4I,EAAYhJ,YAAY,CACtBC,mBAAmBuJ,EAAAA,EAAAA,WAAUD,EAAoBpK,OACjDe,UAAWA,GAAa,CAAC,GAE7B,CAEA,SAAS4J,EAAWhG,GAClByF,EAAoBpK,OAAQ4K,EAAAA,EAAAA,IAAQR,EAAoBpK,OAAQ6K,IAC9D,MAAMC,EAAQD,EAAMvF,MAAMyF,WAAWC,GAASA,EAAKrG,OAASA,IAC5D,IAAe,IAAXmG,EACF,MAAM,IAAI1J,MAAM,mBAAqBuD,EAAO,WAE9CkG,EAAMvF,MAAM2F,OAAOH,EAAO,EAAE,IAG9BJ,GACF,CAEA,SAASQ,IACP,MAAMC,EAAgB,CACpBxG,MAAMyG,EAAAA,EAAAA,KACNvG,KAAM,GACNC,SAAU,GACVI,UAAW,SACXH,EAAG,EACHE,EAAG,GAELmF,EAAoBpK,OAAQ4K,EAAAA,EAAAA,IAAQR,EAAoBpK,OAAQ6K,IAC9DA,EAAMvF,MAAMsD,KAAKuC,EAAQ,IAE3BT,GACF,CAEA,SAASW,EAAY1G,GACnBuF,EAAalK,MAAQoK,EAAoBpK,MAAMsF,MAAMjC,MAClD2H,GAASA,EAAKrG,OAASA,GAE5B,CAEA,SAAS2G,EAAY3G,EAAcE,GACjCuF,EAAoBpK,OAAQ4K,EAAAA,EAAAA,IAAQR,EAAoBpK,OAAQ6K,IAC9D,MAAMC,EAAQD,EAAMvF,MAAMyF,WAAWC,GAASA,EAAKrG,OAASA,IAC5D,IAAe,IAAXmG,EACF,MAAM,IAAI1J,MAAM,mBAAqBuD,EAAO,WAE9CkG,EAAMvF,MAAMwF,GAAOjG,KAAOA,CAAI,IAGhC6F,EAAqB,OACvB,CAEA,SAASa,EAAgB5G,EAAcG,GACrCsF,EAAoBpK,OAAQ4K,EAAAA,EAAAA,IAAQR,EAAoBpK,OAAQ6K,IAC9D,MAAMC,EAAQD,EAAMvF,MAAMyF,WAAWC,GAASA,EAAKrG,OAASA,IAC5D,IAAe,IAAXmG,EACF,MAAM,IAAI1J,MAAM,mBAAqBuD,EAAO,WAE9CkG,EAAMvF,MAAMwF,GAAOhG,SAAWA,CAAQ,IAGxC4F,EAAqB,WACvB,CAEA,SAASc,EAAmB7G,EAAcI,GACxCqF,EAAoBpK,OAAQ4K,EAAAA,EAAAA,IAAQR,EAAoBpK,OAAQ6K,IAC9D,MAAMC,EAAQD,EAAMvF,MAAMyF,WAAWC,GAASA,EAAKrG,OAASA,IAC5D,IAAe,IAAXmG,EACF,MAAM,IAAI1J,MAAM,mBAAqBuD,EAAO,WAE9CkG,EAAMvF,MAAMwF,GAAO/F,EAAIA,CAAC,IAG1B2F,EAAqB,eACvB,CAEA,SAASe,EAAmB9G,EAAcM,GACxCmF,EAAoBpK,OAAQ4K,EAAAA,EAAAA,IAAQR,EAAoBpK,OAAQ6K,IAC9D,MAAMC,EAAQD,EAAMvF,MAAMyF,WAAWC,GAASA,EAAKrG,OAASA,IAC5D,IAAe,IAAXmG,EACF,MAAM,IAAI1J,MAAM,mBAAqBuD,EAAO,WAE9CkG,EAAMvF,MAAMwF,GAAO7F,EAAIA,CAAC,IAG1ByF,EAAqB,eACvB,CAEA,SAASgB,EAAkB/G,EAAcgH,GACvC,MAAMC,EAAqBD,EAAME,OAA6B7L,MAC9DgB,QAAQC,IAAI2K,GACZxB,EAAoBpK,OAAQ4K,EAAAA,EAAAA,IAAQR,EAAoBpK,OAAQ6K,IAC9D,MAAMC,EAAQD,EAAMvF,MAAMyF,WAAWC,GAASA,EAAKrG,OAASA,IAC5D,IAAe,IAAXmG,EACF,MAAM,IAAI1J,MAAM,mBAAqBuD,EAAO,WAEpB,WAAtBiH,EACFf,EAAMvF,MAAMwF,GAAO5F,UAAYZ,EAAUwH,KAAKC,OACf,SAAtBH,IACTf,EAAMvF,MAAMwF,GAAO5F,UAAYZ,EAAUwH,KAAKE,K,IAIlDtB,EAAqB,YACvB,CDjLA,OC+DAvJ,EAAAA,EAAAA,KACE,IAAMuF,EAAM/F,iBACZ,CAACG,EAAmBmL,KAClB7B,EAAoBpK,OAAQqK,EAAAA,EAAAA,WAAUvJ,EAAkB,GAE1D,CAAEoL,MAAM,IDpEH,CAAC/F,EAAUgG,MACRC,EAAAA,EAAAA,OAAcrG,EAAAA,EAAAA,IAAoB,MAAO6B,EAAY,EAC3DC,EAAAA,EAAAA,IAAoB,OAAQ,CAC1B5B,MAAO,UACPoG,SAAUF,EAAO,MAAQA,EAAO,KAAMG,EAAAA,EAAAA,KAAe,QAAU,CAAC,cAC/D,EACDzE,EAAAA,EAAAA,IAAoB,WAAY,KAAM,EACpCA,EAAAA,EAAAA,IAAoB,SAAU,MAAM0E,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,cAAe,IACrFC,EAAAA,EAAAA,IAAaC,EAAe,KAAM,CAChC1F,SAAS2F,EAAAA,EAAAA,KAAS,IAAM,EACtBF,EAAAA,EAAAA,IAAaG,EAAc,CACzBjG,OAAO6F,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,mBACxBzF,KAAM,UACNd,MAAO,iBACN,CACDe,SAAS2F,EAAAA,EAAAA,KAAS,IAAM,EACtB9E,EAAAA,EAAAA,IAAoB,MAAOC,EAAY,EACrCD,EAAAA,EAAAA,IAAoB,MAAOY,EAAY,EACrCgE,EAAAA,EAAAA,KAAaD,EAAAA,EAAAA,IAAOzC,KAAY,CAC9B8C,YAAYL,EAAAA,EAAAA,IAAOlC,GACnB,sBAAuB6B,EAAO,KAAOA,EAAO,GAAM9D,IAAiByE,EAAAA,EAAAA,IAAOxC,GAAaA,EAAUtK,MAAQqI,EAAS,MAClH,WAAY,OACZpC,MAAO,YACP8G,OAAQ,eACRC,iBAAiB,GAChB,CACDC,MAAMN,EAAAA,EAAAA,KAAS,EAAG9N,aAAc,EAC9BgJ,EAAAA,EAAAA,IAAoB,MAAO,CACzB5B,OAAOC,EAAAA,EAAAA,IAAgB,CAAC,OAAQ,CAClC,gBAAiBgE,EAAalK,OAAO2E,OAAS9F,EAAQ8F,QAEpDyD,QAAUC,GAAiBgD,EAAYxM,EAAQ8F,OAC9C,EACDuI,EAAAA,EAAAA,KAAgBrF,EAAAA,EAAAA,IAAoB,QAAS,CAC3CjB,KAAM,OACN,sBAAwByB,GAAkBxJ,EAAQgG,KAAQwD,EAC1D8E,QAAU9E,GAAiBiD,EAAYzM,EAAQ8F,KAAM9F,EAAQgG,MAC7DuI,aAAaZ,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,YAC7B,KAAM,GAAI1D,GAAa,CACxB,CAACuE,EAAAA,GAAaxO,EAAQgG,SAExBqI,EAAAA,EAAAA,KAAgBrF,EAAAA,EAAAA,IAAoB,QAAS,CAC3CjB,KAAM,OACN,sBAAwByB,GAAkBxJ,EAAQiG,SAAYuD,EAC9D8E,QAAU9E,GAAiBkD,EAAgB1M,EAAQ8F,KAAM9F,EAAQiG,UACjEsI,aAAaZ,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,WAC7B,KAAM,GAAIzD,GAAa,CACxB,CAACsE,EAAAA,GAAaxO,EAAQiG,aAExB+C,EAAAA,EAAAA,IAAoB,SAAU,CAC5BjB,KAAM,SACNX,MAAO,qBACPmC,QAAUC,GAAiBsC,EAAW9L,EAAQ8F,MAC9CgC,OAAO6F,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,wBACvB,KAAM,EAAGxD,IACX,GAAIH,MAETyE,EAAG,GACF,EAAG,CAAC,gBACPzF,EAAAA,EAAAA,IAAoB,SAAU,CAC5BjB,KAAM,SACNX,MAAO,SACPmC,QAAS8C,IACRqB,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,0BAA2B,MAElE3E,EAAAA,EAAAA,IAAoB,MAAOoB,EAAY,EACrCpB,EAAAA,EAAAA,IAAoB,WAAY,KAAM,EACpCA,EAAAA,EAAAA,IAAoB,SAAU,MAAM0E,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,oBAAqB,GAC1FtC,EAAalK,QACToM,EAAAA,EAAAA,OAAcrG,EAAAA,EAAAA,IAAoBgC,EAAAA,GAAW,CAAEI,IAAK,GAAK,EACxDN,EAAAA,EAAAA,IAAoB,QAAS,KAAM,EACjC0F,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,aAAe,IAAK,IACvEU,EAAAA,EAAAA,KAAgBrF,EAAAA,EAAAA,IAAoB,SAAU,CAC5C,sBAAuBsE,EAAO,KAAOA,EAAO,GAAM9D,GAAkB6B,EAAalK,MAAMkF,UAAamD,GACpGmF,SAAUrB,EAAO,KAAOA,EAAO,GAAM9D,GAAiBqD,EAAkBxB,EAAalK,MAAM2E,KAAM0D,KAChG,EACDR,EAAAA,EAAAA,IAAoB,SAAUqB,GAAYqD,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,eAAgB,IAC5F3E,EAAAA,EAAAA,IAAoB,SAAUsB,GAAaoD,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,cAAe,IAC3F,KAAM,CACP,CAACiB,EAAAA,GAAevD,EAAalK,MAAMkF,gBAGvC2C,EAAAA,EAAAA,IAAoB,QAAS,KAAM,EACjC0F,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,WAAa,IAAK,IACrEU,EAAAA,EAAAA,KAAgBrF,EAAAA,EAAAA,IAAoB,QAAS,CAC3CjB,KAAM,SACN,sBAAuBuF,EAAO,KAAOA,EAAO,GAAM9D,GAAkB6B,EAAalK,MAAM+E,EAAKsD,GAC5FqF,IAAK,IACLC,IAAK,MACLC,KAAM,IACNT,QAAShB,EAAO,KAAOA,EAAO,GAAM9D,GAC1CmD,EAAmBtB,EAAalK,MAAM2E,KAAMuF,EAAalK,MAAM+E,IAEzDqI,YAAa,KACZ,KAAM,KAAM,CACb,CACEC,EAAAA,GACAnD,EAAalK,MAAM+E,OACnB,EACA,CAAEC,QAAQ,SAIhB6C,EAAAA,EAAAA,IAAoB,QAAS,KAAM,EACjC0F,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,UAAY,IAAK,IACpEU,EAAAA,EAAAA,KAAgBrF,EAAAA,EAAAA,IAAoB,QAAS,CAC3CjB,KAAM,SACN,sBAAuBuF,EAAO,KAAOA,EAAO,GAAM9D,GAAkB6B,EAAalK,MAAMiF,EAAKoD,GAC5FqF,IAAK,IACLC,IAAK,MACLC,KAAM,IACNT,QAAShB,EAAO,KAAOA,EAAO,GAAM9D,GAC1CoD,EAAmBvB,EAAalK,MAAM2E,KAAMuF,EAAalK,MAAMiF,IAEzDmI,YAAa,KACZ,KAAM,KAAM,CACb,CACEC,EAAAA,GACAnD,EAAalK,MAAMiF,OACnB,EACA,CAAED,QAAQ,SAIf,OACFoH,EAAAA,EAAAA,OAAcrG,EAAAA,EAAAA,IAAoB,IAAKqD,GAAamD,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CACtE,wDACE,aAKdc,EAAG,GACF,EAAG,CAAC,WACPb,EAAAA,EAAAA,IAAaG,EAAc,CACzBjG,OAAO6F,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,iBACxBzF,KAAM,WACNd,MAAO,iBACN,CACDe,SAAS2F,EAAAA,EAAAA,KAAS,IAAM,EACtB9E,EAAAA,EAAAA,IAAoB,QAAS,KAAM,EACjC0F,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,4BAA8B,IAAK,IACtFU,EAAAA,EAAAA,KAAgBrF,EAAAA,EAAAA,IAAoB,QAAS,CAC3C,sBAAuBsE,EAAO,KAAOA,EAAO,GAAM9D,GAAkB+B,EAAoBpK,MAAMwF,gBAAmB6C,GACjHmF,SAAUrB,EAAO,KAAOA,EAAO,GAAM9D,GAAiBqC,EAAqB,mCAC3E9D,KAAM,YACL,KAAM,KAAM,CACb,CAACiH,EAAAA,GAAiBzD,EAAoBpK,MAAMwF,wBAIlD8H,EAAG,GACF,EAAG,CAAC,WACPb,EAAAA,EAAAA,IAAaG,EAAc,CACzBjG,OAAO6F,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,kBACxBzF,KAAM,GACNd,MAAO,iBACN,CACDe,SAAS2F,EAAAA,EAAAA,KAAS,IAAM,EACtB9E,EAAAA,EAAAA,IAAoB,QAAS,KAAM,EACjC0F,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,gCAAkC,IAAK,IAC1FU,EAAAA,EAAAA,KAAgBrF,EAAAA,EAAAA,IAAoB,QAAS,CAC3C,sBAAuBsE,EAAO,KAAOA,EAAO,GAAM9D,GAAkB+B,EAAoBpK,MAAM0F,QAAQC,YAAe0C,GACrH8E,QAAShB,EAAO,MAAQA,EAAO,IAAO9D,GACxCqC,EAAqB,uCAEnB9D,KAAM,QACL,KAAM,KAAM,CACb,CAACyG,EAAAA,GAAajD,EAAoBpK,MAAM0F,QAAQC,kBAGpDkC,EAAAA,EAAAA,IAAoB,QAAS,KAAM,EACjC0F,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,iCAAmC,IAAK,IAC3FU,EAAAA,EAAAA,KAAgBrF,EAAAA,EAAAA,IAAoB,QAAS,CAC3C,sBAAuBsE,EAAO,MAAQA,EAAO,IAAO9D,GAAkB+B,EAAoBpK,MAAM0F,QAAQE,YAAeyC,GACvH8E,QAAShB,EAAO,MAAQA,EAAO,IAAO9D,GACxCqC,EAAqB,uCAEnB9D,KAAM,QACL,KAAM,KAAM,CACb,CAACyG,EAAAA,GAAajD,EAAoBpK,MAAM0F,QAAQE,kBAGpDiC,EAAAA,EAAAA,IAAoB,QAAS,KAAM,EACjC0F,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,8BAAgC,IAAK,IACxFU,EAAAA,EAAAA,KAAgBrF,EAAAA,EAAAA,IAAoB,QAAS,CAC3C,sBAAuBsE,EAAO,MAAQA,EAAO,IAAO9D,GAAkB+B,EAAoBpK,MAAM0F,QAAQG,gBAAmBwC,GAC3H8E,QAAShB,EAAO,MAAQA,EAAO,IAAO9D,GACxCqC,EAAqB,2CAEnB9D,KAAM,QACL,KAAM,KAAM,CACb,CAACyG,EAAAA,GAAajD,EAAoBpK,MAAM0F,QAAQG,wBAItDyH,EAAG,GACF,EAAG,CAAC,WACPb,EAAAA,EAAAA,IAAaG,EAAc,CACzBjG,OAAO6F,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,YACxBvG,MAAO,iBACN,CACDe,SAAS2F,EAAAA,EAAAA,KAAS,IAAM,EACtB9E,EAAAA,EAAAA,IAAoB,QAAS,KAAM,EACjC0F,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAClC,iEACG,IAAK,IACRU,EAAAA,EAAAA,KAAgBrF,EAAAA,EAAAA,IAAoB,QAAS,CAC3C,sBAAuBsE,EAAO,MAAQA,EAAO,IAAO9D,GAAkB+B,EAAoBpK,MAAM0F,QAAQI,cAAiBuC,GACzH8E,QAAShB,EAAO,MAAQA,EAAO,IAAO9D,GACxCqC,EAAqB,yCAEnB9D,KAAM,QACL,KAAM,KAAM,CACb,CAACyG,EAAAA,GAAajD,EAAoBpK,MAAM0F,QAAQI,sBAItDwH,EAAG,GACF,EAAG,CAAC,WACNd,EAAAA,EAAAA,IAAO1C,KACHsC,EAAAA,EAAAA,OAAc0B,EAAAA,EAAAA,IAAalB,EAAc,CACxCzE,IAAK,EACLxB,MAAO,0BACPI,KAAM,sBACL,CACDC,SAAS2F,EAAAA,EAAAA,KAAS,IAAM,EACrBH,EAAAA,EAAAA,IAAO1C,KACHsC,EAAAA,EAAAA,OAAcrG,EAAAA,EAAAA,IAAoB,MAAOsD,GAAakD,EAAAA,EAAAA,IAAiB,CAC9E5L,eAAgBiJ,EAAQjJ,iBACtB,KACIoN,EAAAA,EAAAA,IAAoB,IAAI,MAE9BT,EAAG,GACF,EAAG,CAAC,YACPS,EAAAA,EAAAA,IAAoB,IAAI,MAE9BT,EAAG,OAGN,MAGP,IE3aA,MAAM,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE,Q,muICJA,MACM1F,EAAa,CCJZ3B,MAAM,sBDKP6B,EAAa,CCJV7B,MAAM,mBDKTwC,EAAa,CCJRxC,MAAM,oBDKX4C,EAAa,CCJN5C,MAAM,YAAYkE,IAAI,YDQ7BrB,EAAa,CAAC,OACdC,EAAa,CAAC,eACdC,EAAa,CAAC,eAEd,SAAUrB,GAAOxB,EAAUgG,EAAY6B,EAAYC,EAAYC,EAAWC,GAC9E,MAAMC,GAA0BC,EAAAA,EAAAA,IAAkB,gBAElD,OAAOnB,EAAAA,EAAAA,MAAiBd,EAAAA,EAAAA,OClBxBrG,EAAAA,EAAAA,IAwBM,MAxBN6B,EAwBM,EAvBJC,EAAAA,EAAAA,IAiBM,MAjBNC,EAiBM,EAhBJD,EAAAA,EAAAA,IAcM,MAdNY,EAcM,EAbJZ,EAAAA,EAAAA,IAAwC,MAAxCgB,EAAwC,UAEhC1C,EAAAmI,cDkBHlC,EAAAA,EAAAA,OCnBLrG,EAAAA,EAAAA,IAWE,ODSIoC,IAAK,EClBTlC,MAAM,cACNsI,IAAAC,EACAC,MAAM,KACNC,OAAO,KACNC,IAAkBxI,EAAApD,SDqBf,qFAGC,KAAM,EAAG+F,KACZiF,EAAAA,EAAAA,IAAoB,IAAI,KClBnB5H,EAAAL,gBDqBNsG,EAAAA,EAAAA,OCrBLrG,EAAAA,EAAAA,IAAuE,ODsBjEoC,IAAK,ECtBelC,MAAM,cDwB1B2I,aCxBwCrC,EAAAA,EAAAA,IAAsBpG,EAAAL,gBDyB7D,KAAM,EAAGiD,KACZgF,EAAAA,EAAAA,IAAoB,IAAI,KCvBtB5H,EAAA0I,kBD0BHzC,EAAAA,EAAAA,OC3BLrG,EAAAA,EAAAA,IAIE,ODwBIoC,IAAK,EC1BTlC,MAAM,gBD4BF2I,aC3BJrC,EAAAA,EAAAA,IAAwBpG,EAAA0I,kBD4BnB,KAAM,EAAG7F,KACZ+E,EAAAA,EAAAA,IAAoB,IAAI,MACzB,CACH,CAACK,IAEL,CCvBA,QAAe5H,EAAAA,EAAAA,IAAgB,CAC7B8B,KAAM,kBACN5B,MAAO,CACLoI,eAAgBC,OAChBC,UAAWD,OACXjJ,cAAee,OACfoI,SAAU9M,QAEZ8E,IAAAA,GACE,MAAO,CACLqH,aAAa,EAEjB,EACA7P,OAAAA,GACE2I,KAAK8H,gBACP,EACA/N,MAAO,CACL2N,eAAgB,CACdK,WAAW,EACXC,QAAS,WACPhI,KAAK8H,iBACD9H,KAAKiI,kBAEPC,YAAW,KACTlI,KAAKkH,aAAc,CAAI,GACtB,KAEHlH,KAAKkH,aAAc,CAEvB,IAGJiB,QAAS,CACP,oBAAML,SAEEM,EAAAA,EAAAA,MAEN,MAAMC,EAAWrI,KAAKsI,MAAMD,SACxBA,IAEFA,EAASE,aAETF,EAASnG,MAAMmF,MAAQ,GAAGrH,KAAKwI,qBAEnC,EAEAC,UAAAA,CAAWC,GACT,OACE5M,OAAOC,OAAO4M,WAAa,qBAAuBD,EAAW,MAEjE,GAEFrI,SAAU,CACRuI,qBAAAA,GACE,OAAI5I,KAAK6H,SACA7H,KAAK6H,SACTgB,KAAKjQ,GAAUA,IACfkQ,MAAK,CAACC,EAAGC,IAAMA,EAAEC,WAAaF,EAAEE,aAE9B,EACT,EAEAxB,eAAAA,GACE,GACiC,qBAAxBzH,KAAK0H,gBACc,qBAAnB1H,KAAK4H,UAEZ,OAGF,MAAMY,GAAoBU,EAAAA,EAAAA,OACvBlJ,KAAK0H,eAAiB1H,KAAK4H,UAAa,KAG3C,IAAK,MAAMC,KAAY7H,KAAK4I,sBAC1B,GAAIJ,GAAqBX,EAASoB,WAChC,OAAOpB,EAASsB,OAKtB,EAEAX,iBAAAA,GACE,OAAIxI,KAAK0H,gBAAkB1H,KAAK4H,WACvBsB,EAAAA,EAAAA,OAAOlJ,KAAK0H,eAAiB1H,KAAK4H,UAAa,KAC5C,CACd,EAEAK,iBAAAA,GACE,OAAOjI,KAAK0H,iBAAmB1H,KAAK4H,SACtC,KCrHJ,MAAM,IAA2B,OAAgB,GAAQ,CAAC,CAAC,SAAS,IAAQ,CAAC,YAAY,qBAEzF,UCNA,MACMpH,GAAa,CAAE3B,MAAO,eACtB6B,GAAa,CACjBK,IAAK,EACLlC,MAAO,mCAEHwC,GAAa,CAAC,QAAS,UACvBI,GAAa,CAAE5C,MAAO,aACtB6C,GAAa,CAAC,WACdC,GAAa,CAAEZ,IAAK,GACpBa,GAAa,CAAE/C,MAAO,iCACtBgD,GAAa,CAAEhD,MAAO,sBACtBiD,GAAa,CAAEjD,MAAO,gBACtBkD,GAAc,CAAC,eACfC,GAAc,CAAC,eACfC,GAAc,CAAC,eAoBrB,QAA4BK,EAAAA,EAAAA,IAAiB,CAC3ChD,MAAO,CACP8J,KAAM,CACJ5J,KAAMzE,OACN2E,UAAU,IAGZ6C,KAAAA,CAAMC,GAER,MAAMlD,EAAQkD,ECwCRE,EAAQ5G,OAAOC,OAAO6G,gBAAgBC,iBAgBtCwG,GAAmBtG,EAAAA,EAAAA,IAAwB,MAC3CuG,GAAYvG,EAAAA,EAAAA,IAA8B,MAG1CwG,GAAexG,EAAAA,EAAAA,MACfD,GAAeC,EAAAA,EAAAA,MACfyG,GAAezG,EAAAA,EAAAA,IAAgB,IAC/B0G,GAAgB1G,EAAAA,EAAAA,IAAgB,IAChC2G,GAAgB3G,EAAAA,EAAAA,KAAa,GAC7B4G,GAAgB5G,EAAAA,EAAAA,KAAa,GAC7B6G,GAAc7G,EAAAA,EAAAA,IAAkB,IAChC8G,GAAa9G,EAAAA,EAAAA,IAAI,IAIvB+G,EAAAA,EAAAA,KAAU,KACRC,IACAC,IACAC,IACAnO,OAAO/C,iBAAiB,SAAUiR,EAAiB,KAErDE,EAAAA,EAAAA,KAAgB,KACdpO,OAAOqO,oBAAoB,SAAUH,EAAiB,IAIxD,MAAMI,GAAW/J,EAAAA,EAAAA,KAAS,KACxB,IAAIgK,EAAO,EAgBX,OAdAnM,EAAMtF,MAAMjB,SAASiM,IACI,WAAnBA,EAAK9F,UACH8F,EAAKjG,EAAIiG,EAAKlG,SAAS4M,OAASD,IAClCA,EAAOzG,EAAKjG,EAAIiG,EAAKlG,SAAS4M,QAEJ,SAAnB1G,EAAK9F,WACV8F,EAAK/F,EAAI+F,EAAKlG,SAAS4M,OAASD,IAClCA,EAAOzG,EAAK/F,EAAI+F,EAAKlG,SAAS4M,O,IAKhC5H,GAAO9I,QAAQC,IAAI,eAAgBwQ,EAAM,IAAKA,GAE3CA,CAAI,IAGPE,GAAWlK,EAAAA,EAAAA,KAAS,IACxB+J,EAASxR,MAAQ,EAAI4R,KAAKC,MAAMZ,EAAWjR,MAAQwR,EAASxR,OAAS,IAGjE8R,GAAWrK,EAAAA,EAAAA,KAAS,IACxBkK,EAAS3R,MAAQ,EAAI4R,KAAKC,MAAMF,EAAS3R,MAAQ,GAAK,IAGlDsF,GAAQmC,EAAAA,EAAAA,KAAS,IACjBf,EAAM8J,MAAMlL,MACPoB,EAAM8J,KAAKlL,MAEb,KAGHyM,GAAWtK,EAAAA,EAAAA,KAAS,KACxB,IAAIsK,EAAW,EACf,IAAK,IAAIhN,EAAI,EAAGA,EAAIyM,EAASxR,MAAO+E,IAClC,IAAK,IAAIE,EAAI,EAAGA,EAAIuM,EAASxR,MAAOiF,IAC9B2L,EAAa5Q,MAAM+E,GAAGE,IACxB8M,IAIN,OAAOA,CAAQ,IAGXC,GAAQvK,EAAAA,EAAAA,KAAS,KACrB,IAAIuK,EAAQ,EACZ,IAAK,IAAIjN,EAAI,EAAGA,EAAIyM,EAASxR,MAAO+E,IAClC,IAAK,IAAIE,EAAI,EAAGA,EAAIuM,EAASxR,MAAOiF,IAEhC2L,EAAa5Q,MAAM+E,GAAGE,IACtB4L,EAAc7Q,MAAM+E,GAAGE,KAAO2L,EAAa5Q,MAAM+E,GAAGE,IAEpD+M,IAIN,OAAOA,CAAK,IAGRlM,GAAgB2B,EAAAA,EAAAA,KAAS,KAC7B,IAAIwK,EAASvL,EAAM8J,KAAK9K,QAAQI,cAAcwB,QAC5C,WACA0K,EAAMhS,MAAMC,YAId,OAFAgS,EAASA,EAAO3K,QAAQ,SAAUyK,EAAS/R,MAAMC,YAE1CgS,CAAM,IAGTC,GAAkBzK,EAAAA,EAAAA,KAAS,KACvBqJ,EAAc9Q,QAuDxB,SAASoR,IACP,MAAMe,EAAU1B,EAAiBzQ,MAC5BmS,IACLlB,EAAWjR,MAAQ4R,KAAKC,MACtBD,KAAKlE,IAAIyE,EAAQC,YAAaD,EAAQE,eAE1C,CAEA,SAASC,IACPxB,EAAc9Q,OAAQ,EACtB2Q,EAAa3Q,WAAQ0C,EACrBwH,EAAalK,WAAQ0C,CACvB,CAEA,SAAS6P,IACPzB,EAAc9Q,OAAQ,EACtB+Q,EAAc/Q,OAAQ,EACtB2Q,EAAa3Q,WAAQ0C,EACrByO,IACAE,GACF,CAEA,SAASmB,IACPzB,EAAc/Q,OAAQ,EACtB2Q,EAAa3Q,WAAQ0C,EACrBwH,EAAalK,WAAQ0C,EACrB2O,GACF,CAEA,SAASF,IACPjH,EAAalK,WAAQ0C,EACrBiO,EAAa3Q,WAAQ0C,EAErBkO,EAAa5Q,MAAQyS,MAAMC,KAAK,CAAEhB,OAAQF,EAASxR,QAAS,IAC1DyS,MAAMC,KAAK,CAAEhB,OAAQF,EAASxR,QAAS,IAAM,OAG/C6Q,EAAc7Q,MAAQyS,MAAMC,KAAK,CAAEhB,OAAQF,EAASxR,QAAS,IAC3DyS,MAAMC,KAAK,CAAEhB,OAAQF,EAASxR,QAAS,IAAM,OAI/CgR,EAAYhR,MAAQsF,EAAMtF,MAAMiQ,KAAKjF,IAAI,IACpCA,EACHjJ,KAAM4Q,EAAe3H,OAIvB,IAAK,MAAMA,KAAQgG,EAAYhR,MAC7B,IAAK,MAAM4S,KAAQ5H,EAAKjJ,KACtB6O,EAAa5Q,MAAM4S,EAAK7N,GAAG6N,EAAK3N,GAAK2N,EAAKC,MAGhD,CAOA,SAASF,EAAe3H,GACtB,IAAIjJ,EAAO,GAEX,MAAM+Q,EAAoB,CACxB/G,OAAQ,CAAEgH,GAAI,EAAGC,GAAI,GACrBhH,KAAM,CAAE+G,GAAI,EAAGC,GAAI,KAEf,GAAED,EAAE,GAAEC,GACVF,EAAkB9H,EAAK9F,WAEnBwM,EAAS1G,EAAKlG,SAAS4M,OAE7B,IAAK,IAAIuB,EAAI,EAAGA,EAAIvB,EAAQuB,IAAK,CAC/B,MAAMlO,EAAIiG,EAAKjG,EAAIgO,EAAKE,EAClBhO,EAAI+F,EAAK/F,EAAI+N,EAAKC,EACxBlR,EAAK6G,KAAK,CAAE7D,EAAGA,EAAGE,EAAGA,EAAG4N,OAAQ7H,EAAKlG,SAASmO,GAAGC,e,CAGnD,OAAOnR,CACT,CAEA,SAASsP,IACP,MAAM8B,EAASzC,EAAU1Q,MACzB,IAAKmT,EAEH,YADAnS,QAAQoS,MAAM,aAGhB,MAAMC,EAAMF,EAAOG,WAAW,MAC9B,GAAKD,EAAL,CAIAA,EAAIE,UAAU,EAAG,EAAGJ,EAAO1E,MAAO0E,EAAOzE,QAGzCxE,EAAalK,OAAO+B,KAAKhD,SAAS6T,IAChCY,EAASZ,EAAM,4BAA4B,IAIzCjC,EAAa3Q,OACfwT,EAAS7C,EAAa3Q,MAAO,6BAG/B,IAAK,IAAI+E,EAAI,EAAGA,EAAIyM,EAASxR,MAAO+E,IAClC,IAAK,IAAIE,EAAI,EAAGA,EAAIuM,EAASxR,MAAOiF,IAE9B2L,EAAa5Q,MAAM+E,GAAGE,IACxBoO,EAAII,YAAc,YAClBJ,EAAIK,WACF3O,EAAI4M,EAAS3R,MACbiF,EAAI0M,EAAS3R,MACb2R,EAAS3R,MACT2R,EAAS3R,QAEF0G,EAAM8J,MAAMhL,kBACrB6N,EAAIM,UAAY,wBAChBN,EAAIO,SACF7O,EAAI4M,EAAS3R,MACbiF,EAAI0M,EAAS3R,MACb2R,EAAS3R,MACT2R,EAAS3R,QAMX8Q,EAAc9Q,QACb+Q,EAAc/Q,OACf6Q,EAAc7Q,MAAM+E,GAAGE,KAEnB4L,EAAc7Q,MAAM+E,GAAGE,KAAO2L,EAAa5Q,MAAM+E,GAAGE,IACtDoO,EAAIM,UAAY,UAChBN,EAAIO,SACF7O,EAAI4M,EAAS3R,MACbiF,EAAI0M,EAAS3R,MACb2R,EAAS3R,MACT2R,EAAS3R,SAGXqT,EAAIM,UAAY,UAChBN,EAAIO,SACF7O,EAAI4M,EAAS3R,MACbiF,EAAI0M,EAAS3R,MACb2R,EAAS3R,MACT2R,EAAS3R,SAMfqT,EAAIQ,KAAO,QAAU/B,EAAS9R,MAAQ,aACtCqT,EAAIS,UAAY,SAChBT,EAAIU,aAAe,SAEfhD,EAAc/Q,OAChBqT,EAAIM,UAAY,UAChBN,EAAIW,SACFpD,EAAa5Q,MAAM+E,GAAGE,GACtBF,EAAI4M,EAAS3R,MAAQ2R,EAAS3R,MAAQ,EACtCiF,EAAI0M,EAAS3R,MAAQ2R,EAAS3R,MAAQ,KAGxCqT,EAAIM,UAAY,UAChBN,EAAIW,SACFnD,EAAc7Q,MAAM+E,GAAGE,GACvBF,EAAI4M,EAAS3R,MAAQ2R,EAAS3R,MAAQ,EACtCiF,EAAI0M,EAAS3R,MAAQ2R,EAAS3R,MAAQ,G,CAKhD,CAEA,SAASiU,EAAoBtI,GAC3B,GAAImF,EAAc9Q,MAAO,OAGzB,MAAMkU,EAAkBC,EAA8BxI,GACtD,GAAKuI,IAG4D,KAA7DtD,EAAa5Q,MAAMkU,EAAgBnP,GAAGmP,EAAgBjP,GACxD0L,EAAa3Q,MAAQ,CACnB+E,EAAGmP,EAAgBnP,EACnBE,EAAGiP,EAAgBjP,EACnB4N,OAAQjC,EAAa5Q,MAAMkU,EAAgBnP,GAAGmP,EAAgBjP,KAGhE0L,EAAa3Q,WAAQ0C,EACrBwH,EAAalK,WAAQ0C,GAKrBiO,EAAa3Q,YACY0C,IAAzBiO,EAAa3Q,MAAM+E,QACMrC,IAAzBiO,EAAa3Q,MAAMiF,GACnB,CACA,MAAMmP,EAAkBpD,EAAYhR,MAAM+M,QAAQ/B,GACzCA,EAAKjJ,KAAKsS,MACdzB,GACCA,EAAK7N,IAAM4L,EAAa3Q,MAAO+E,GAAK6N,EAAK3N,IAAM0L,EAAa3Q,MAAOiF,MAIrEmP,IAC6B,IAA3BA,EAAgB1C,OAClBxH,EAAalK,MAAQoU,EAAgB,GACD,IAA3BA,EAAgB1C,SACrBxH,EAAalK,QAAUoU,EAAgB,GACzClK,EAAalK,MAAQoU,EAAgB,GAErClK,EAAalK,MAAQoU,EAAgB,I,CAK/C,CAEA,SAASE,EAAgB3I,GACvB,IAAImF,EAAc9Q,MAIlB,GAAI2Q,EAAa3Q,OAEf,GAAI2L,EAAMxD,IAAIoM,MAAM,eAKlB,GAJA1D,EAAc7Q,MAAM2Q,EAAa3Q,MAAM+E,GAAG4L,EAAa3Q,MAAMiF,GAC3D0G,EAAMxD,IAAI+K,cAGRhJ,EAAalK,MAAO,CACtB,MAAMwU,EAAoBtK,EAAalK,MAAM+B,KAAKgJ,WAAW6H,GAEzDA,EAAK7N,IAAM4L,EAAa3Q,MAAO+E,GAAK6N,EAAK3N,IAAM0L,EAAa3Q,MAAOiF,IAGvE,GAAIuP,EAAoBtK,EAAalK,MAAM+B,KAAK2P,OAAS,EACvDf,EAAa3Q,MAAQkK,EAAalK,MAAM+B,KAAKyS,EAAoB,QAC5D,GAAIA,IAAsBtK,EAAalK,MAAM+B,KAAK2P,OAAS,EAAG,CACnE,MAAM+C,EAAmBzD,EAAYhR,MAAM+K,WAAWC,GAC7CA,EAAKrG,MAAQuF,EAAalK,OAAO2E,OAEtC8P,EAAmBzD,EAAYhR,MAAM0R,OAAS,IAChDxH,EAAalK,MAAQgR,EAAYhR,MAAMyU,EAAmB,GAC1D9D,EAAa3Q,MAAQkK,EAAalK,MAAM+B,KAAK,G,QAI9C,GAAkB,cAAd4J,EAAMxD,KAIf,GAHA0I,EAAc7Q,MAAM2Q,EAAa3Q,MAAM+E,GAAG4L,EAAa3Q,MAAMiF,GAAK,GAG9DiF,EAAalK,MAAO,CACtB,MAAMwU,EAAoBtK,EAAalK,MAAM+B,KAAKgJ,WAAW6H,GAEzDA,EAAK7N,IAAM4L,EAAa3Q,MAAO+E,GAAK6N,EAAK3N,IAAM0L,EAAa3Q,MAAOiF,IAGnEuP,EAAoB,IACtB7D,EAAa3Q,MAAQkK,EAAalK,MAAM+B,KAAKyS,EAAoB,G,OAGhE,GAAkB,WAAd7I,EAAMxD,KAIf,GAHA0I,EAAc7Q,MAAM2Q,EAAa3Q,MAAM+E,GAAG4L,EAAa3Q,MAAMiF,GAAK,GAG9DiF,EAAalK,MAAO,CACtB,MAAMwU,EAAoBtK,EAAalK,MAAM+B,KAAKgJ,WAAW6H,GAEzDA,EAAK7N,IAAM4L,EAAa3Q,MAAO+E,GAAK6N,EAAK3N,IAAM0L,EAAa3Q,MAAOiF,IAGnEuP,EAAoBtK,EAAalK,MAAM+B,KAAK2P,OAAS,IACvDf,EAAa3Q,MAAQkK,EAAalK,MAAM+B,KAAKyS,EAAoB,G,OAGhE,GACL,CAAC,UAAW,YAAa,YAAa,cAAcE,SAAS/I,EAAMxD,MAGnE,GADAwD,EAAMgJ,iBACFzK,EAAalK,MAAO,CACtB,MAAMwU,EAAoBtK,EAAalK,MAAM+B,KAAKgJ,WAAW6H,GAEzDA,EAAK7N,IAAM4L,EAAa3Q,MAAO+E,GAAK6N,EAAK3N,IAAM0L,EAAa3Q,MAAOiF,IAGvE,GAAqC,WAAjCiF,EAAalK,MAAMkF,WACrB,GAAkB,cAAdyG,EAAMxD,IAEJqM,EAAoB,EACtB7D,EAAa3Q,MACXkK,EAAalK,MAAM+B,KAAKyS,EAAoB,GACf,IAAtBA,IACT7D,EAAa3Q,MACXkK,EAAalK,MAAM+B,KAAKmI,EAAalK,MAAM+B,KAAK2P,OAAS,SAExD,GAAkB,eAAd/F,EAAMxD,IAEXqM,EAAoBtK,EAAalK,MAAM+B,KAAK2P,OAAS,EACvDf,EAAa3Q,MACXkK,EAAalK,MAAM+B,KAAKyS,EAAoB,GAE9CA,IACAtK,EAAalK,MAAM+B,KAAK2P,OAAS,IAEjCf,EAAa3Q,MAAQkK,EAAalK,MAAM+B,KAAK,SAE1C,GAAkB,YAAd4J,EAAMxD,IAAmB,CAElC,MAAMyM,EAAY5D,EAAYhR,MAAMqD,MAAM2H,GACjCA,EAAKjJ,KAAKsS,MAAMzB,GAEnBA,EAAK7N,IAAM4L,EAAa3Q,MAAO+E,GAC/B6N,EAAK3N,IAAM0L,EAAa3Q,MAAOiF,EAAI,MAIrC2P,IACF1K,EAAalK,MAAQ4U,EACrBjE,EAAa3Q,MAAQ4U,EAAU7S,KAAKsB,MAAMuP,GAEtCA,EAAK7N,IAAM4L,EAAa3Q,MAAO+E,GAC/B6N,EAAK3N,IAAM0L,EAAa3Q,MAAOiF,EAAI,I,MAIpC,GAAkB,cAAd0G,EAAMxD,IAAqB,CAEpC,MAAM0M,EAAY7D,EAAYhR,MAAMqD,MAAM2H,GACjCA,EAAKjJ,KAAKsS,MAAMzB,GAEnBA,EAAK7N,IAAM4L,EAAa3Q,MAAO+E,GAC/B6N,EAAK3N,IAAM0L,EAAa3Q,MAAOiF,EAAI,MAIrC4P,IACF3K,EAAalK,MAAQ6U,EACrBlE,EAAa3Q,MAAQ6U,EAAU9S,KAAKsB,MAAMuP,GAEtCA,EAAK7N,IAAM4L,EAAa3Q,MAAO+E,GAC/B6N,EAAK3N,IAAM0L,EAAa3Q,MAAOiF,EAAI,I,OAKtC,GAAqC,SAAjCiF,EAAalK,MAAMkF,UAC5B,GAAkB,YAAdyG,EAAMxD,IAEJqM,EAAoB,EACtB7D,EAAa3Q,MACXkK,EAAalK,MAAM+B,KAAKyS,EAAoB,GACf,IAAtBA,IACT7D,EAAa3Q,MACXkK,EAAalK,MAAM+B,KAAKmI,EAAalK,MAAM+B,KAAK2P,OAAS,SAExD,GAAkB,cAAd/F,EAAMxD,IAEXqM,EAAoBtK,EAAalK,MAAM+B,KAAK2P,OAAS,EACvDf,EAAa3Q,MACXkK,EAAalK,MAAM+B,KAAKyS,EAAoB,GAE9CA,IACAtK,EAAalK,MAAM+B,KAAK2P,OAAS,IAEjCf,EAAa3Q,MAAQkK,EAAalK,MAAM+B,KAAK,SAE1C,GAAkB,cAAd4J,EAAMxD,IAAqB,CAEpC,MAAM2M,EAAgB9D,EAAYhR,MAAMqD,MAAM2H,GACrCA,EAAKjJ,KAAKsS,MAAMzB,GAEnBA,EAAK7N,IAAM4L,EAAa3Q,MAAO+E,EAAI,GACnC6N,EAAK3N,IAAM0L,EAAa3Q,MAAOiF,MAIjC6P,IACF5K,EAAalK,MAAQ8U,EACrBnE,EAAa3Q,MAAQ8U,EAAc/S,KAAKsB,MAAMuP,GAE1CA,EAAK7N,IAAM4L,EAAa3Q,MAAO+E,EAAI,GACnC6N,EAAK3N,IAAM0L,EAAa3Q,MAAOiF,I,MAIhC,GAAkB,eAAd0G,EAAMxD,IAAsB,CAErC,MAAM4M,EAAiB/D,EAAYhR,MAAMqD,MAAM2H,GACtCA,EAAKjJ,KAAKsS,MAAMzB,GAEnBA,EAAK7N,IAAM4L,EAAa3Q,MAAO+E,EAAI,GACnC6N,EAAK3N,IAAM0L,EAAa3Q,MAAOiF,MAIjC8P,IACF7K,EAAalK,MAAQ+U,EACrBpE,EAAa3Q,MAAQ+U,EAAehT,KAAKsB,MAAMuP,GAE3CA,EAAK7N,IAAM4L,EAAa3Q,MAAO+E,EAAI,GACnC6N,EAAK3N,IAAM0L,EAAa3Q,MAAOiF,I,QAOtC,GAAkB,QAAd0G,EAAMxD,IAAe,CAC9BwD,EAAMgJ,iBAEN,MAAMF,EAAmBzD,EAAYhR,MAAM+K,WAAWC,GAC7CA,IAASd,EAAalK,QAG3B2L,EAAMqJ,SAEN9K,EAAalK,MADXyU,EAAmB,EACAzD,EAAYhR,MAAMyU,EAAmB,GAErCzD,EAAYhR,MAAMgR,EAAYhR,MAAM0R,OAAS,GAGhE+C,EAAmBzD,EAAYhR,MAAM0R,OAAS,EAChDxH,EAAalK,MAAQgR,EAAYhR,MAAMyU,EAAmB,GAE1DvK,EAAalK,MAAQgR,EAAYhR,MAAM,GAI3C2Q,EAAa3Q,MAAQkK,EAAalK,OAAO+B,KAAK,E,MAK9C,CAAC,UAAW,YAAa,YAAa,aAAc,OAAO2S,SACzD/I,EAAMxD,OAGRwD,EAAMgJ,iBACNzK,EAAalK,MAAQgR,EAAYhR,MAAM,GACvC2Q,EAAa3Q,MAAQkK,EAAalK,MAAM+B,KAAK,GAGnD,CAEA,SAASkT,EAAYjK,GACflB,GAAO9I,QAAQC,IAAI,mBAAoB+J,EAAKnG,MAE5CiM,EAAc9Q,QAElBkK,EAAalK,MAAQgR,EAAYhR,MAAMqD,MACpCrD,GAAUA,EAAM2E,OAASqG,EAAKrG,OAEjCgM,EAAa3Q,MAAQkK,EAAalK,OAAO+B,KAAK,GAE9C2O,EAAU1Q,OAAOkV,QACnB,CAEA,SAASf,EAA8BxI,GAMrC,IAAK+E,EAAU1Q,MAAO,OAEtB,MAAMmV,EAAOzE,EAAU1Q,MAAMoV,wBACvBrQ,EAAI4G,EAAM0J,QAAUF,EAAKG,KACzBrQ,EAAI0G,EAAM4J,QAAUJ,EAAKK,IACzBC,EAAQ7D,KAAKjE,IACjB,EACAiE,KAAKlE,IAAIkE,KAAKC,MAAM9M,EAAI4M,EAAS3R,OAAQwR,EAASxR,MAAQ,IAEtD0V,EAAQ9D,KAAKjE,IACjB,EACAiE,KAAKlE,IAAIkE,KAAKC,MAAM5M,EAAI0M,EAAS3R,OAAQwR,EAASxR,MAAQ,IAG5D,MAAO,CAAE+E,EAAG0Q,EAAOxQ,EAAGyQ,EACxB,CAEA,SAASlC,EAASZ,EAAYe,GAC5B,GACEf,EAAK7N,EAAI,GACT6N,EAAK7N,EAAIyM,EAASxR,MAAQ,GAC1B4S,EAAK3N,EAAI,GACT2N,EAAK3N,EAAIuM,EAASxR,MAAQ,EAE1B,OAGF,IAAK0Q,EAAU1Q,MAAO,OACtB,MAAMqT,EAAM3C,EAAU1Q,MAAMsT,WAAW,MAEnCD,IACFA,EAAIM,UAAYA,EAChBN,EAAIO,SACFhB,EAAK7N,EAAI4M,EAAS3R,MAClB4S,EAAK3N,EAAI0M,EAAS3R,MAClB2R,EAAS3R,MACT2R,EAAS3R,OAGf,CD9CA,OC9fAmB,EAAAA,EAAAA,KACE,IAAMuF,EAAM8J,OACZ,KACEW,IACIT,EAAU1Q,OACR0Q,EAAU1Q,MAAMsT,WAAW,OAC7B5C,EAAU1Q,OACNsT,WAAW,OACXC,UAAU,EAAG,EAAG7C,EAAU1Q,MAAMyO,MAAOiC,EAAU1Q,MAAM0O,QAG/D2C,GAAU,GAEZ,CAAEnF,MAAM,KAGV/K,EAAAA,EAAAA,KACE,IAAM0P,EAAc7Q,QACpB,KACEqR,GAAU,GAEZ,CAAEnF,MAAM,KAGV/K,EAAAA,EAAAA,KACE,IAAMwP,EAAa3Q,QACnB,KACEqR,IACIvH,GACF9I,QAAQC,IACN,iBACA0P,EAAa3Q,OAAO+E,EACpB4L,EAAa3Q,OAAOiF,E,GAI1B,CAAEiH,MAAM,KAGV/K,EAAAA,EAAAA,KACE,IAAM+I,EAAalK,QACnB,KACEqR,IACIvH,GACF9I,QAAQC,IAAI,iBAAkBiJ,EAAalK,OAAO8E,S,GAGtD,CAAEoH,MAAM,ID+cH,CAAC/F,EAAUgG,MACRC,EAAAA,EAAAA,OAAcrG,EAAAA,EAAAA,IAAoB,MAAO6B,GAAY,CAC1DlB,EAAM8J,MAAMlL,MAAMoM,OAAS,IACvBtF,EAAAA,EAAAA,OAAcrG,EAAAA,EAAAA,IAAoB,MAAO+B,GAAY,EACpDD,EAAAA,EAAAA,IAAoB,MAAO,CACzB8N,QAAS,mBACTxL,IAAKsG,EACLxK,MAAO,kBACN,EACD4B,EAAAA,EAAAA,IAAoB,SAAU,CAC5B8N,QAAS,YACTxL,IAAKuG,EACLlI,SAAU,IACViG,MAAOwC,EAAWjR,MAClB0O,OAAQuC,EAAWjR,MACnBsJ,OAAOsM,EAAAA,EAAAA,IAAgB,CAAEnH,MAAOwC,EAAWjR,MAAQ,KAAM0O,OAAQuC,EAAWjR,MAAQ,OACpF6V,cAAe1J,EAAO,KAAOA,EAAO,IAAKG,EAAAA,EAAAA,KAAgBjE,GAAiB4L,EAAoB5L,IAAU,CAAC,UACzGyN,UAAW3J,EAAO,KAAOA,EAAO,IAAKG,EAAAA,EAAAA,KAAgBjE,GAAiBiM,EAAgBjM,IAAU,CAAC,UACjGpC,MAAO,UACN,KAAM,GAAIwC,KACZ,MACHZ,EAAAA,EAAAA,IAAoB,MAAOgB,GAAY,GACpCuD,EAAAA,EAAAA,KAAW,IAAOrG,EAAAA,EAAAA,IAAoBgC,EAAAA,GAAW,MAAMC,EAAAA,EAAAA,IAAYtB,EAAM8J,MAAMlL,OAAQ0F,KAC9EoB,EAAAA,EAAAA,OAAcrG,EAAAA,EAAAA,IAAoB,MAAO,CAC/CoC,IAAK6C,EAAKrG,KACVyD,QAAUC,GAAiB4M,EAAYjK,GACvC/E,OAAOC,EAAAA,EAAAA,IAAgB,CAAC,OAAQ,CAAE,gBAAiBgE,EAAalK,OAAO2E,OAASqG,EAAKrG,UACpF4H,EAAAA,EAAAA,IAAiBvB,EAAKnG,MAAO,GAAIiE,OAClC,aAGPsD,EAAAA,EAAAA,OAAcrG,EAAAA,EAAAA,IAAoB,MAAOgD,IAAYwD,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,gEAAiE,KAC7J3E,EAAAA,EAAAA,IAAoB,MAAOmB,GAAY,EACrCnB,EAAAA,EAAAA,IAAoB,MAAOoB,GAAY,CACpC6H,EAAc9Q,QACVoM,EAAAA,EAAAA,OAAc0B,EAAAA,EAAAA,IAAaiI,GAAiB,CAC3C5N,IAAK,EACL2G,gBAAgBtC,EAAAA,EAAAA,IAAOwF,GACvBhD,WAAWxC,EAAAA,EAAAA,IAAOuF,GAClB,kBAAkBvF,EAAAA,EAAAA,IAAO1G,IACxB,KAAM,EAAG,CAAC,iBAAkB,YAAa,qBAC5CiI,EAAAA,EAAAA,IAAoB,IAAI,MAE9BlG,EAAAA,EAAAA,IAAoB,MAAOqB,GAAY,EACpCsD,EAAAA,EAAAA,IAAO0F,KACH9F,EAAAA,EAAAA,OAAcrG,EAAAA,EAAAA,IAAoB,SAAU,CAC3CoC,IAAK,EACLyG,aAAarC,EAAAA,EAAAA,IAAiB3C,EAAQ4G,KAAK9K,QAAQC,aACnDyC,QAASkK,EACT1L,KAAM,SACNX,MAAO,iBACN,KAAM,EAAGkD,MACZ4E,EAAAA,EAAAA,IAAoB,IAAI,GAC3B+C,EAAc9Q,QACVoM,EAAAA,EAAAA,OAAcrG,EAAAA,EAAAA,IAAoB,SAAU,CAC3CoC,IAAK,EACLyG,aAAarC,EAAAA,EAAAA,IAAiB3C,EAAQ4G,KAAK9K,QAAQE,aACnDwC,QAASmK,EACT3L,KAAM,SACNX,MAAO,iBACN,KAAM,EAAGmD,MACZ2E,EAAAA,EAAAA,IAAoB,IAAI,GAC3B+C,EAAc9Q,QAAU+Q,EAAc/Q,QAClCoM,EAAAA,EAAAA,OAAcrG,EAAAA,EAAAA,IAAoB,SAAU,CAC3CoC,IAAK,EACLyG,aAAarC,EAAAA,EAAAA,IAAiB3C,EAAQ4G,KAAK9K,QAAQG,iBACnDuC,QAASoK,EACT5L,KAAM,SACNX,MAAO,iBACN,KAAM,EAAGoD,MACZ0E,EAAAA,EAAAA,IAAoB,IAAI,SAKpC,IEjxBA,MAAM,IAA2B,OAAgB,GAAQ,CAAC,CAAC,YAAY,qBAEvE,UCNA,MAAMnG,GAAa,CCDZ3B,MAAM,eDEP6B,GAAa,CCDT7B,MAAM,WDEVwC,GAAa,CCENxC,MAAM,qBDDb4C,GAAa,CAAC,gBACdC,GAAa,CCgBJQ,MAAA,wBDfTP,GAAa,CAAC,gBACdC,GAAa,CC4BH/C,MAAM,yBD3BhBgD,GAAa,CAAC,YACdC,GAAa,CCkFHjD,MAAM,yBDjFhBkD,GAAc,CAAC,YACfC,GAAc,CAAC,YACfC,GAAc,CAAC,YACf2M,GAAc,CAAC,YAEf,SAAUrO,GAAOxB,EAAUgG,EAAY6B,EAAYC,EAAYC,EAAWC,GAC9E,MAAM8H,GAA4BC,EAAAA,EAAAA,IAAkB,kBAC9CC,GAA6BD,EAAAA,EAAAA,IAAkB,mBAErD,OAAQ9J,EAAAA,EAAAA,OCnBRrG,EAAAA,EAAAA,IAqKM,MArKN6B,GAqKM,EApKJC,EAAAA,EAAAA,IAmKO,OAnKPC,GAmKO,EAlKLD,EAAAA,EAAAA,IA+BW,kBA9BTA,EAAAA,EAAAA,IAAiD,eAAA0E,EAAAA,EAAAA,IAAtCpG,EAAApD,SAAS,mBAAD,IAEnB8E,EAAAA,EAAAA,IAKM,MALNY,GAKM,EAJJZ,EAAAA,EAAAA,IAES,UAFAO,QAAK+D,EAAA,KAAAA,EAAA,GDqBxB,IAAInI,ICrBsBmC,EAAAiQ,UAAAjQ,EAAAiQ,YAAApS,IAAUiC,MAAM,mBAAmBW,KAAK,WDwBrD2F,EAAAA,EAAAA,ICvBEpG,EAAApD,SAAS,qBAAD,IAEb8E,EAAAA,EAAAA,IAAiE,OAA5D5B,MAAM,uBAAwB,eAAcE,EAAAkQ,cDyB9C,KAAM,EAAGxN,OCtBd4D,EAAAA,EAAAA,IAOEwJ,EAAA,CANCpJ,WAAY1G,EAAAiE,oBAAoBkM,SAChC,sBAAmBnQ,EAAAoQ,eACpBpM,IAAI,UACJ,uBACA,2BACA,yBDyBC,KAAM,EAAG,CAAC,aAAc,yBCtB3BtC,EAAAA,EAAAA,IAWQ,QAXRiB,GAWQ,EDaNyE,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,ICvBdpG,EAAApD,SAAS,2BAA4B,IACxC,IAAA8E,EAAAA,EAAAA,IAGE,QAFA5B,MAAM,uBACL,eAAcE,EAAAqQ,uBDwBd,KAAM,EAAGzN,KACZmE,EAAAA,EAAAA,KCvBArF,EAAAA,EAAAA,IAIE,SDoBA,sBAAuBsE,EAAO,KAAOA,EAAO,GAAM9D,GCvBzClC,EAAAiE,oBAAoBqM,YAAWpO,GACvC8E,QAAKhB,EAAA,KAAAA,EAAA,GAAA9D,GAAElC,EAAAuE,qBAAqB,+BAC7B9D,KAAK,QDwBJ,KAAM,KAAM,CACb,CAACyG,EAAAA,GC3BQlH,EAAAiE,oBAAoBqM,oBAOnC5O,EAAAA,EAAAA,IAsDW,WAtDXmB,GAsDW,EArDTnB,EAAAA,EAAAA,IAAgD,eAAA0E,EAAAA,EAAAA,IAArCpG,EAAApD,SAAS,kBAAD,IAEnB8E,EAAAA,EAAAA,IAOQ,eDiBNqF,EAAAA,EAAAA,KCvBArF,EAAAA,EAAAA,IAIE,SDoBA,sBAAuBsE,EAAO,KAAOA,EAAO,GAAM9D,GCvBzClC,EAAAiE,oBAAoBsM,gBAAerO,GAC3CmF,SAAMrB,EAAA,KAAAA,EAAA,GDyBnB,IAAInI,ICzBiBmC,EAAAuE,sBAAAvE,EAAAuE,wBAAA1G,IACT4C,KAAK,YD0BJ,KAAM,KAAM,CACb,CAACiH,EAAAA,GC7BQ1H,EAAAiE,oBAAoBsM,oBD+B/BnJ,EAAAA,EAAAA,IC5BE,KACFhB,EAAAA,EAAAA,IAAGpG,EAAApD,SAAS,8BAAD,MAGb8E,EAAAA,EAAAA,IAOQ,eDoBNqF,EAAAA,EAAAA,KC1BArF,EAAAA,EAAAA,IAIE,SDuBA,sBAAuBsE,EAAO,KAAOA,EAAO,GAAM9D,GC1BzClC,EAAAiE,oBAAoBuM,gBAAetO,GAC3CmF,SAAMrB,EAAA,KAAAA,EAAA,GD4BnB,IAAInI,IC5BiBmC,EAAAuE,sBAAAvE,EAAAuE,wBAAA1G,IACT4C,KAAK,YD6BJ,KAAM,KAAM,CACb,CAACiH,EAAAA,GChCQ1H,EAAAiE,oBAAoBuM,oBDkC/BpJ,EAAAA,EAAAA,IC/BE,KACFhB,EAAAA,EAAAA,IAAGpG,EAAApD,SAAS,qCAAD,MAGb8E,EAAAA,EAAAA,IAOQ,eDuBNqF,EAAAA,EAAAA,KC7BArF,EAAAA,EAAAA,IAIE,SD0BA,sBAAuBsE,EAAO,KAAOA,EAAO,GAAM9D,GC7BzClC,EAAAiE,oBAAoBwM,aAAYvO,GACxCmF,SAAMrB,EAAA,KAAAA,EAAA,GD+BnB,IAAInI,IC/BiBmC,EAAAuE,sBAAAvE,EAAAuE,wBAAA1G,IACT4C,KAAK,YDgCJ,KAAM,KAAM,CACb,CAACiH,EAAAA,GCnCQ1H,EAAAiE,oBAAoBwM,iBDqC/BrJ,EAAAA,EAAAA,IClCE,KACFhB,EAAAA,EAAAA,IAAGpG,EAAApD,SAAS,8BAAD,MAGb8E,EAAAA,EAAAA,IAOQ,eD0BNqF,EAAAA,EAAAA,KChCArF,EAAAA,EAAAA,IAIE,SD6BA,sBAAuBsE,EAAO,KAAOA,EAAO,GAAM9D,GChCzClC,EAAAiE,oBAAoByM,qBAAoBxO,GAChDmF,SAAMrB,EAAA,MAAAA,EAAA,IDkCnB,IAAInI,IClCiBmC,EAAA2Q,4BAAA3Q,EAAA2Q,8BAAA9S,IACT4C,KAAK,YDmCJ,KAAM,KAAM,CACb,CAACiH,EAAAA,GCtCQ1H,EAAAiE,oBAAoByM,yBDwC/BtJ,EAAAA,EAAAA,ICrCE,KACFhB,EAAAA,EAAAA,IAAGpG,EAAApD,SAAS,+BAAD,MAGb8E,EAAAA,EAAAA,IAcQ,SAbL5B,OAAKC,EAAAA,EAAAA,IAAA,CDoCJ,oBCpCyCC,EAAAiE,oBAAoByM,wBDsC9D,EACD3J,EAAAA,EAAAA,KCnCArF,EAAAA,EAAAA,IAKE,SD+BA,sBAAuBsE,EAAO,MAAQA,EAAO,IAAO9D,GCnC3ClC,EAAAiE,oBAAoB2M,kCAAiC1O,GAC7DmF,SAAMrB,EAAA,MAAAA,EAAA,IDqCnB,IAAInI,ICrCiBmC,EAAA2Q,4BAAA3Q,EAAA2Q,8BAAA9S,IACRgT,UAAW7Q,EAAAiE,oBAAoByM,qBAChCjQ,KAAK,YDsCJ,KAAM,GAAIqC,IAAa,CACxB,CAAC4E,EAAAA,GC1CQ1H,EAAAiE,oBAAoB2M,sCD4C/BxJ,EAAAA,EAAAA,ICxCE,KACFhB,EAAAA,EAAAA,IACEpG,EAAApD,SAAS,4DAAD,IDuCT,MClCL8E,EAAAA,EAAAA,IAiEW,WAjEXqB,GAiEW,EAhETrB,EAAAA,EAAAA,IAAiD,eAAA0E,EAAAA,EAAAA,IAAtCpG,EAAApD,SAAS,mBAAD,IAEnB8E,EAAAA,EAAAA,IAUQ,SATL5B,OAAKC,EAAAA,EAAAA,IAAA,oBAAwBC,EAAAiE,oBAAoBsM,mBDoCjD,EACDnJ,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,ICnCdpG,EAAApD,SAAS,gCAAiC,IAC7C,IDmCAmK,EAAAA,EAAAA,KCnCArF,EAAAA,EAAAA,IAKE,SD+BA,sBAAuBsE,EAAO,MAAQA,EAAO,IAAO9D,GCnC3ClC,EAAAiE,oBAAoB1E,QAAQC,YAAW0C,GAC/C8E,QAAKhB,EAAA,MAAAA,EAAA,IAAA9D,GAAElC,EAAAuE,qBAAqB,uCAC5BsM,SAAU7Q,EAAAiE,oBAAoBsM,gBAC/B9P,KAAK,QDoCJ,KAAM,GAAIuC,IAAc,CACzB,CAACkE,EAAAA,GCxCQlH,EAAAiE,oBAAoB1E,QAAQC,gBD0CtC,ICnCHkC,EAAAA,EAAAA,IAUQ,SATL5B,OAAKC,EAAAA,EAAAA,IAAA,qBAAyBC,EAAAiE,oBAAoBwM,gBDqClD,EACDrJ,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,ICpCdpG,EAAApD,SAAS,iCAAkC,IAC9C,IDoCAmK,EAAAA,EAAAA,KCpCArF,EAAAA,EAAAA,IAKE,SDgCA,sBAAuBsE,EAAO,MAAQA,EAAO,IAAO9D,GCpC3ClC,EAAAiE,oBAAoB1E,QAAQE,YAAWyC,GAC/C8E,QAAKhB,EAAA,MAAAA,EAAA,IAAA9D,GAAElC,EAAAuE,qBAAqB,uCAC5BsM,UAAW7Q,EAAAiE,oBAAoBwM,aAChChQ,KAAK,QDqCJ,KAAM,GAAIwC,IAAc,CACzB,CAACiE,EAAAA,GCzCQlH,EAAAiE,oBAAoB1E,QAAQE,gBD2CtC,ICpCHiC,EAAAA,EAAAA,IAcQ,SAbL5B,OAAKC,EAAAA,EAAAA,IAAA,CDsCJ,oBCtCyCC,EAAAiE,oBAAoByM,wBDwC9D,EACDtJ,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,ICrCdpG,EAAApD,SAAS,8BAA+B,IAC3C,IDqCAmK,EAAAA,EAAAA,KCrCArF,EAAAA,EAAAA,IAOE,SD+BA,sBAAuBsE,EAAO,MAAQA,EAAO,IAAO9D,GCrC3ClC,EAAAiE,oBAAoB1E,QAAQG,gBAAewC,GACnD8E,QAAKhB,EAAA,MAAAA,EAAA,IAAA9D,GAAiBlC,EAAAuE,qBAAoB,2CAG1CsM,UAAW7Q,EAAAiE,oBAAoByM,qBAChCjQ,KAAK,QDsCJ,KAAM,GAAIyC,IAAc,CACzB,CAACgE,EAAAA,GC5CQlH,EAAAiE,oBAAoB1E,QAAQG,oBD8CtC,ICrCHgC,EAAAA,EAAAA,IAqBQ,SApBL5B,OAAKC,EAAAA,EAAAA,IAAA,CDuCJ,oBCvCuDC,EAAAiE,oBAAoByM,uBAAuC1Q,EAAAiE,oBAAoB2M,qCD2CvI,EACDxJ,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,ICtCdpG,EAAApD,SAAS,qDAAsD,IAClE,IDsCAmK,EAAAA,EAAAA,KCtCArF,EAAAA,EAAAA,IAYE,SD2BA,sBAAuBsE,EAAO,MAAQA,EAAO,IAAO9D,GCtC3ClC,EAAAiE,oBAAoB1E,QAAQuR,uBAAsB5O,GAC1D8E,QAAKhB,EAAA,MAAAA,EAAA,IAAA9D,GAAiBlC,EAAAuE,qBDwCnB,kDCnCHsM,UAA0B7Q,EAAAiE,oBAAoByM,uBAAuC1Q,EAAAiE,oBAAoB2M,kCAI1GnQ,KAAK,QDuCJ,KAAM,GAAIoP,IAAc,CACzB,CAAC3I,EAAAA,GClDQlH,EAAAiE,oBAAoB1E,QAAQuR,2BDoDtC,MCrCLxK,EAAAA,EAAAA,IAKE0J,EAAA,CAJClH,SAAU9I,EAAAiE,oBAAoB6E,SAC9B,iBAAgB9I,EAAAiE,oBAAoB1E,QAAQI,cAC5C,oBAAiBK,EAAA+Q,eACjB,yBAAuB/Q,EAAAgR,qBDwCvB,KAAM,EAAG,CAAC,WAAY,iBAAkB,oBAAqB,8BAGtE,C,eE5MA,MACMvP,GAAa,CCFP3B,MAAM,yBDGZ6B,GAAa,CAAEK,IAAK,GACpBM,GAAa,CCUR2O,IAAI,sBDTTvO,GAAa,CCcVN,GAAG,qBAAqBtC,MAAM,sBDVjC6C,GAAa,CCWR7C,MAAM,8BDVX8C,GAAa,CAAC,sBAAuB,WACrCC,GAAa,CCwBR/C,MAAM,2BDvBXgD,GAAa,CAAC,sBAAuB,WACrCC,GAAa,CAAC,QAAS,WACvBC,GAAc,CAAC,MAAO,OAEtB,SAAUxB,GAAOxB,EAAUgG,EAAY6B,EAAYC,EAAYC,EAAWC,GAC9E,OAAQ/B,EAAAA,EAAAA,OCjBRrG,EAAAA,EAAAA,IAyEW,WAzEX6B,GAyEW,EAxETC,EAAAA,EAAAA,IAA2C,eAAA0E,EAAAA,EAAAA,IAAhCpG,EAAApD,SAAS,aAAD,GAENoD,EAAAkR,qBDiBRjL,EAAAA,EAAAA,OCjBLrG,EAAAA,EAAAA,IASQ,QAAA+B,GAAA,EDSFyF,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,IChBnBpG,EAAApD,SAAS,iEACT,IACF,IDeImK,EAAAA,EAAAA,KCfJrF,EAAAA,EAAAA,IAIE,SAHAjB,KAAK,ODgBD,sBAAuBuF,EAAO,KAAOA,EAAO,GAAM9D,GCf7ClC,EAAAkR,mBAAkBhP,GAC1B8E,QAAKhB,EAAA,KAAAA,EAAA,GDiBd,IAAInI,ICjBYmC,EAAAmR,0BAAAnR,EAAAmR,4BAAAtT,KDkBH,KAAM,KAAM,CACb,CAACqJ,EAAAA,GCpBIlH,EAAAkR,0BDuBTtJ,EAAAA,EAAAA,IAAoB,IAAI,IClB5BlG,EAAAA,EAAAA,IAIQ,QAJRY,IAIQ8D,EAAAA,EAAAA,IAFJpG,EAAApD,SAAS,+DAAD,IAGZ8E,EAAAA,EAAAA,IAiDM,MAjDNgB,GAiDM,EAhDJhB,EAAAA,EAAAA,IAaM,MAbNiB,GAaM,EAZJjB,EAAAA,EAAAA,IAEQ,cAAA0E,EAAAA,EAAAA,IADHpG,EAAApD,SAAS,eAAD,KDeZqJ,EAAAA,EAAAA,KAAW,ICbZrG,EAAAA,EAAAA,IAQWgC,EAAAA,GAAA,MAAAC,EAAAA,EAAAA,IARuB7B,EAAAoR,cAAY,CAA5BtI,EAAUgE,KDcnB/F,EAAAA,EAAAA,MAAiBd,EAAAA,EAAAA,OCbxBrG,EAAAA,EAAAA,IAME,SDQAoC,ICfkD8K,EAElDrM,KAAK,SACL8G,IAAI,IACJC,IAAI,MDeJ,sBAAwBtF,GCdflC,EAAAoR,aAAatE,GAAG5C,WAAUhI,EAClC8E,QAAK9E,GAAElC,EAAAqR,oBAAoB,gBAAgBvE,kBDe3C,KAAM,GAAIlK,KAAc,CACzB,CAACsE,EAAAA,GCjBQlH,EAAAoR,aAAatE,GAAG5C,gBDmBzB,SCbNxI,EAAAA,EAAAA,IAgCM,MAhCNmB,GAgCM,EA/BJnB,EAAAA,EAAAA,IAEQ,cAAA0E,EAAAA,EAAAA,IADHpG,EAAApD,SAAS,eAAD,KDeZqJ,EAAAA,EAAAA,KAAW,ICbZrG,EAAAA,EAAAA,IA2BMgC,EAAAA,GAAA,MAAAC,EAAAA,EAAAA,IAzBoB7B,EAAAoR,cAAY,CAA5BtI,EAAUgE,MDYV7G,EAAAA,EAAAA,OCdVrG,EAAAA,EAAAA,IA2BM,OA1BJE,MAAM,sCAELkC,IAAK8K,GDcH,EACD/F,EAAAA,EAAAA,KCbFrF,EAAAA,EAAAA,IAIE,SAHAjB,KAAK,ODcH,sBAAwByB,GCbjBlC,EAAAoR,aAAatE,GAAG1C,QAAOlI,EAC/B8E,QAAK9E,GAAElC,EAAAqR,oBAAoB,gBAAgBvE,eDczC,KAAM,GAAIhK,IAAa,CACxB,CAACoE,EAAAA,GChBMlH,EAAAoR,aAAatE,GAAG1C,YAG3B1I,EAAAA,EAAAA,IAgBS,UAfPjB,KAAK,SACJD,MAAOR,EAAAsR,gCAAgCxI,GACxChJ,MAAM,yBACLmC,QAAKC,GAAElC,EAAAuR,eAAezI,IDgBpB,ECdHpH,EAAAA,EAAAA,IASE,OARC0G,IAAKpI,EAAA0J,WAAW,SAChBlB,IAAsBxI,EAAApD,SDiBnB,iECZJ0L,MAAM,KACNC,OAAO,MDgBJ,KAAM,EAAGvF,KACX,EAAGD,SAEN,WCZRrB,EAAAA,EAAAA,IAES,UAFDjB,KAAK,SAASX,MAAM,SAAUmC,QAAK+D,EAAA,KAAAA,EAAA,GDoB/C,IAAInI,ICpB6CmC,EAAAwR,aAAAxR,EAAAwR,eAAA3T,MDqB1CuI,EAAAA,EAAAA,ICpBEpG,EAAApD,SAAS,kBAAD,IDsBjB,CCXA,QAAeyD,EAAAA,EAAAA,IAAgB,CAC7B8B,KAAM,iBAEN5B,MAAO,CACLuI,SAAU,CACRrI,KAAM6L,MACN3L,UAAU,GAEZhB,cAAe,CACbc,KAAMC,OACNC,UAAU,IAGd8Q,MAAO,CACL,CAAC,mBAAmBC,EAAuB9W,GACzC,OAAO,CACT,EACA,CAAC,yBAAyBwP,GAMxB,OAAO,CACT,GAEFtJ,IAAAA,GACE,MAAO,CACLsQ,cAAclN,EAAAA,EAAAA,WAAUjD,KAAK6H,UAC7BoI,mBAAoBjQ,KAAKtB,eAAiB,GAE9C,EACA3E,MAAO,CAEL8N,SAAU,CACRE,WAAW,EACXC,QAAS,WACPhI,KAAKmQ,cAAelN,EAAAA,EAAAA,WAAUjD,KAAK6H,SACrC,GAEFnJ,cAAe,CACbqJ,WAAW,EACXC,QAAS,WACPhI,KAAKiQ,mBAAqBjQ,KAAKtB,eAAiB,EAClD,IAGJyJ,QAAS,CACPxM,SAAQ,KAER0U,+BAAAA,CAAgCxI,GAC9B,OAAO7H,KAAKrE,SACV,kEACA,CAAEsN,WAAYpB,EAASoB,WAAWpQ,YAEtC,EAEA0X,WAAAA,GACE,MAAMG,EAAc,CAClBzH,WAAY,GACZE,QAAS,YAEXnJ,KAAKmQ,aAAa3O,KAAKkP,GACvB1Q,KAAKoQ,qBACP,EAEAE,cAAAA,CAAeK,GACb3Q,KAAKmQ,aAAenQ,KAAKmQ,aAAaxK,QACnCkC,GAAaA,IAAa8I,IAE7B3Q,KAAKoQ,qBACP,EAEAA,mBAAAA,CAAoBzW,EAAqB,CAAC,GACxCqG,KAAK4Q,MAAM,mBAAmB3N,EAAAA,EAAAA,WAAUjD,KAAKmQ,cAAexW,EAC9D,EAEAuW,wBAAAA,GACElQ,KAAK4Q,MAAM,wBAAyB5Q,KAAKiQ,mBAC3C,EAEAxH,UAAAA,CAAWC,GACT,OACE5M,OAAOC,OAAO4M,WAAa,qBAAuBD,EAAW,MAEjE,KCjKJ,MAAM,IAA2B,OAAgB,GAAQ,CAAC,CAAC,SAAS,IAAQ,CAAC,YAAY,qBAEzF,UH8KA,IAAetJ,EAAAA,EAAAA,IAAgB,CAC7B8B,KAAM,qBACNqB,KAAAA,GACE,MAAO,CACLE,YAAYpD,EAAAA,EAAAA,IAAwBnI,EAAAA,GAExC,EACA2Z,WAAY,CAAEC,cAAa,KAAEC,eAAcA,IAC3CzR,MAAO,CACL/F,eAAgB,CACdiG,KAAMzE,OACN2E,UAAU,IAGdG,IAAAA,GACE,MAAO,CACLmD,qBAAqBC,EAAAA,EAAAA,WAAUjD,KAAKzG,gBAExC,EACAQ,MAAO,CAELR,eAAgB,CACdwO,WAAW,EACXC,QAAS,WACPhI,KAAKgD,qBAAsBC,EAAAA,EAAAA,WAAUjD,KAAKzG,eAC5C,IAGJ8G,SAAU,CACR4O,YAAAA,GACE,OAAOtT,EAAAA,EAAAA,IACL,qRAEJ,EAEAyT,qBAAAA,GACE,OAAOzT,EAAAA,EAAAA,IACL,gHAEJ,GAEFwM,QAAS,CACPxM,SAAQ,KAKRqT,QAAAA,GACE,MAAMgC,EAAahR,KAAKsI,MAAM2I,SAAiBC,IACzCC,EAASrV,OAAOC,OAAOkV,QAAQG,UAAUJ,GAC/C,IAAKG,EAEH,MADAvX,QAAQoS,MAAM,kCAAmCmF,GAC3C,IAAInX,MAAM,6CAElB,MAAMqX,EAAYF,EAAOG,MAAMC,SAASF,UAClCG,EAAQH,EAAUI,mBAClBC,EAAML,EAAUM,kBACtB,IAAKH,IAAUE,EAEb,MADA9X,QAAQoS,MAAM,oBAAqBwF,EAAO,mBAAoBE,GACxD,IAAI1X,MAAM,qCAElBmX,EAAOG,MAAMM,QAAQC,IACnBA,EAAOC,WAAW,IAAKJ,GACvBG,EAAOC,WAAW,IAAKN,EAAM,GAEjC,EAEArC,cAAAA,CAAetP,GAEbG,KAAKyC,WAAYhJ,YAAY,CAC3BC,mBAAmB8J,EAAAA,EAAAA,IACjBxD,KAAKgD,qBACJoG,IACCA,EAAK8F,SAAWrP,CAAI,IAGxBlG,UAAW,2BAEf,EAEA2J,oBAAAA,CAAqB3J,GAEnBqG,KAAKyC,WAAYhJ,YAAY,CAC3BC,mBAAmBuJ,EAAAA,EAAAA,WAAUjD,KAAKgD,qBAClCrJ,UAAWA,GAAa,CAAC,GAE7B,EAEA+V,0BAAAA,GACO1P,KAAKgD,oBAAoByM,uBAC5BzP,KAAKgD,oBAAoB2M,mCAAoC,GAE/D3P,KAAKsD,sBACP,EAEAwM,cAAAA,CAAeiC,GACb/R,KAAKyC,WAAYhJ,YAAY,CAC3BC,mBAAmB8J,EAAAA,EAAAA,IACjBxD,KAAKgD,qBACJgP,IACCA,EAAUnK,SAAWkK,CAAe,IAGxCpY,UAAW,2BAEf,EAEAoW,mBAAAA,CAAoBkC,GAClBjS,KAAKyC,WAAYhJ,YAAY,CAC3BC,mBAAmB8J,EAAAA,EAAAA,IACjBxD,KAAKgD,qBACJgP,IACCA,EAAU1T,QAAQI,cAAgBuT,CAAoB,IAG1DtY,UAAW,wCAEf,EAEA8O,UAAAA,CAAWC,GACT,OACE5M,OAAOC,OAAO4M,WAAa,qBAAuBD,EAAW,MAEjE,KI7SJ,MAAM,IAA2B,OAAgB,GAAQ,CAAC,CAAC,SAAS,MAEpE,UCLA,MACMlI,GAAa,CCFZ3B,MAAM,eDGP6B,GAAa,CCDV7B,MAAM,8BDETwC,GAAa,CCARxC,MAAM,+BDCX4C,GAAa,CCAN5C,MAAM,uBDCb6C,GAAa,CAAC,aACdC,GAAa,CAAC,QAAS,YAAa,cAAe,SAAU,WAC7DC,GAAa,CAAC,SAAU,WACxBC,GAAa,CAAEd,IAAK,GACpBe,GAAa,CAAC,gBACdC,GAAc,CAClBhB,IAAK,EC6CSlC,MAAM,mBD1ChBmD,GAAc,CCmDPnD,MAAM,iCDlDboD,GAAc,CAAC,eACf2M,GAAc,CCkEL/P,MAAM,gBDjEfqT,GAAc,CAAC,eACfC,GAAc,CAAC,eACfC,GAAc,CAAC,eACfC,GAAc,CAAC,YAAa,cAAe,WAE3C,SAAU9R,GAAOxB,EAAUgG,EAAY6B,EAAYC,EAAYC,EAAWC,GAC9E,MAAMuL,GAA6BxD,EAAAA,EAAAA,IAAkB,mBAErD,OAAQ9J,EAAAA,EAAAA,OC1BRrG,EAAAA,EAAAA,IAqIM,MArIN6B,GAqIM,EAnIJC,EAAAA,EAAAA,IAkIM,MAlINC,GAkIM,EAhIJD,EAAAA,EAAAA,IAyGM,MAzGNY,GAyGM,EAxGJZ,EAAAA,EAAAA,IA0DM,MA1DNgB,GA0DM,GDjCHuD,EAAAA,EAAAA,KAAW,ICxBZrG,EAAAA,EAAAA,IAwDWgC,EAAAA,GAAA,MAAAC,EAAAA,EAAAA,IAxDiB7B,EAAAwT,gBAAX9a,KDyBPuN,EAAAA,EAAAA,OAAcrG,EAAAA,EAAAA,IAAoBgC,EAAAA,GAAW,CACnDI,IC1B8CtJ,EAAQ8F,MD2BrD,CCxBsB,eAAjB9F,EAAQ+H,OD0BTwF,EAAAA,EAAAA,OC3BPrG,EAAAA,EAAAA,IAIE,QDwBMoC,IAAK,EC1BXlC,MAAM,cACN2T,UAAQ/a,EAAQgb,MD4BT,KAAM,EAAG/Q,KCxBoB,UAAjBjK,EAAQ+H,OD0BpBwF,EAAAA,EAAAA,OC1BTrG,EAAAA,EAAAA,IA8CWgC,EAAAA,GAAA,CAAAI,IAAA,IA3CDhC,EAAA2T,WAAWjb,EAAQ8F,QDyBdyH,EAAAA,EAAAA,OC1BbrG,EAAAA,EAAAA,IAcO,QDaOoC,IAAK,ECzBjBlC,OAAKC,EAAAA,EAAAA,IAAA,CAAC,eAEEC,EAAA4T,oBAAoBlb,KAD3B8H,MAAOR,EAAA6T,cAAc7T,EAAA2T,WAAWjb,EAAQ8F,QAAQkV,KAEhD9P,UAAW5D,EAAA8T,SACXC,YAAS7R,GAAqBlC,EAAAgU,oBAAoB9R,EAAQxJ,EAASsH,EAAA2T,WAAWjb,EAAQ8F,OAGtFyV,OAAI/R,GAAElC,EAAAkU,YAAYhS,EAAQxJ,GAC1Byb,WAAQnO,EAAA,KAAAA,EAAA,IAAAG,EAAAA,EAAAA,KAAT,QAAiB,cAChBlE,QAAKC,GAAElC,EAAAoU,mBAAmB1b,KD0Bd0N,EAAAA,EAAAA,ICxBVpG,EAAA6T,cAAc7T,EAAA2T,WAAWjb,EAAQ8F,QAAQkV,MAAI,GAAA9Q,ODyBrCqD,EAAAA,EAAAA,OCrBbrG,EAAAA,EAAAA,IAUO,QDYOoC,IAAK,ECpBjBlC,MAAM,QACLmU,OAAI/R,GAAElC,EAAAkU,YAAYhS,EAAQxJ,GAC1B2b,YAASrO,EAAA,KAAAA,EAAA,GAAA9D,GAAElC,EAAAsU,YAAYpS,IACvBqS,YAASvO,EAAA,KAAAA,EAAA,GAAA9D,GAAElC,EAAAwU,YAAYtS,IACvBiS,WAAQnO,EAAA,KAAAA,EAAA,IAAAG,EAAAA,EAAAA,KAAT,QAAiB,cAChBlE,QAAKC,GAAElC,EAAAyU,aAAa/b,IACtB,MAED,GAAAmK,KAGanK,EAAQgG,ODkBRuH,EAAAA,EAAAA,OClBbrG,EAAAA,EAAAA,IAKQ,QAAAkD,GAAA,EAJNpB,EAAAA,EAAAA,IAGE,QAFA5B,MAAM,uBACL,eAAcpH,EAAQgG,MDmBV,KAAM,EAAGqE,QAEd6E,EAAAA,EAAAA,IAAoB,IAAI,GCf5B5H,EAAA4K,gBAAkB5K,EAAA0U,yBAAyBhc,KDiBtCuN,EAAAA,EAAAA,OClBbrG,EAAAA,EAAAA,IAKO,OALPoD,IAKOoD,EAAAA,EAAAA,IADF1N,EAAQiG,UAAQ,KDeTiJ,EAAAA,EAAAA,IAAoB,IAAI,IAC3B,MACHA,EAAAA,EAAAA,IAAoB,IAAI,IAC7B,OACD,SCZNlG,EAAAA,EAAAA,IA0CM,MA1CNuB,GA0CM,CAvCIjD,EAAA2U,gCDaH1O,EAAAA,EAAAA,OCdLrG,EAAAA,EAAAA,IAIE,ODWIoC,IAAK,ECbTlC,MAAM,iBDeF2I,aCdJrC,EAAAA,EAAAA,IAAkCpG,EAAA4U,4BDe7B,KAAM,EAAG1R,MACZ0E,EAAAA,EAAAA,IAAoB,IAAI,GCXpB5H,EAAA6U,cDaH5O,EAAAA,EAAAA,OCdL0B,EAAAA,EAAAA,IAME4L,EAAA,CDSIvR,IAAK,ECbR,kBAAiBhC,EAAA8U,eACjB,aAAY9U,EAAA6I,UACZC,SAAU9I,EAAAqK,KAAKvB,SACf,iBAAgB9I,EAAAL,eDeZ,KAAM,EAAG,CAAC,kBAAmB,aAAc,WAAY,qBAC1DiI,EAAAA,EAAAA,IAAoB,IAAI,ICb5BlG,EAAAA,EAAAA,IAwBM,MAxBNmO,GAwBM,CAtBI7P,EAAA+L,kBDcH9F,EAAAA,EAAAA,OCfLrG,EAAAA,EAAAA,IAME,UDUIoC,IAAK,EACLyG,aCfJrC,EAAAA,EAAAA,IAAiCpG,EAAAqK,KAApB9K,QAAQC,aACpByC,QAAK+D,EAAA,KAAAA,EAAA,GDiBpB,IAAInI,ICjBkBmC,EAAA+U,oBAAA/U,EAAA+U,sBAAAlX,IACR4C,KAAK,SACLX,MAAM,iBDkBD,KAAM,EAAGqT,MACZvL,EAAAA,EAAAA,IAAoB,IAAI,GCfpB5H,EAAAgV,sBDiBH/O,EAAAA,EAAAA,OClBLrG,EAAAA,EAAAA,IAME,UDaIoC,IAAK,EACLyG,aClBJrC,EAAAA,EAAAA,IAAqCpG,EAAAqK,KAAxB9K,QAAQG,iBACpBuC,QAAK+D,EAAA,KAAAA,EAAA,GDoBpB,IAAInI,ICpBkBmC,EAAAiV,wBAAAjV,EAAAiV,0BAAApX,IACR4C,KAAK,SACLX,MAAM,iBDqBD,KAAM,EAAGsT,MACZxL,EAAAA,EAAAA,IAAoB,IAAI,GClBpB5H,EAAAkV,kBDoBHjP,EAAAA,EAAAA,OCrBLrG,EAAAA,EAAAA,IAME,UDgBIoC,IAAK,EACLyG,aCrBJrC,EAAAA,EAAAA,IAAiCpG,EAAAqK,KAApB9K,QAAQE,aACpBwC,QAAK+D,EAAA,KAAAA,EAAA,GDuBpB,IAAInI,ICvBkBmC,EAAAmV,oBAAAnV,EAAAmV,sBAAAtX,IACR4C,KAAK,SACLX,MAAM,iBDwBD,KAAM,EAAGuT,MACZzL,EAAAA,EAAAA,IAAoB,IAAI,UClBlClG,EAAAA,EAAAA,IAmBM,OAlBJ5B,MAAM,sBACLmU,OAAIjO,EAAA,KAAAA,EAAA,GAAA9D,GAAElC,EAAAoV,oBAAoBlT,IAC1BiS,WAAQnO,EAAA,KAAAA,EAAA,IAAAG,EAAAA,EAAAA,KAAT,QAAiB,eDuBhB,GACAF,EAAAA,EAAAA,KAAW,ICtBZrG,EAAAA,EAAAA,IAaOgC,EAAAA,GAAA,MAAAC,EAAAA,EAAAA,IAZY7B,EAAAqV,eAAVC,KDsBCrP,EAAAA,EAAAA,OCvBVrG,EAAAA,EAAAA,IAaO,QAXJoC,IAAKsT,EAAO9W,KACbsB,OAAKC,EAAAA,EAAAA,IAAA,CAAC,gBAAe,CDuBnB8Q,UAAW5P,KCtByB6S,SDuBpC1W,SCvBoEkY,EAAO9W,OAAI,KAAU+W,mBAI1F3R,UAAW5D,EAAA8T,SACXC,YAAS7R,GAAElC,EAAAwV,sBAAsBtT,EAAQoT,GACzCrT,QAAKC,GAAElC,EAAAyV,oBAAoBH,KDsBzBlP,EAAAA,EAAAA,ICpBAkP,EAAO5B,MAAI,GAAAJ,ODqBZ,OACH,OAGT,CCYA,QAAejT,EAAAA,EAAAA,IAAgB,CAC7B8B,KAAM,qBACN2P,WAAY,CAAElC,gBAAeA,IAC7BrP,MAAO,CACL8J,KAAM,CACJ5J,KAAMzE,OACN2E,UAAU,IAGdG,IAAAA,GACE,MAAO,CAEL6S,WAAY,CAAC,EACb+B,iBAAkB,KAClBC,yBAAyB,EACzBC,qBAAiBrZ,EACjBsZ,qBAAiBtZ,EACjBgZ,qBAAiBhZ,EACjBuX,UAAU,EAEd,EACA1K,QAAS,CACPxM,SAAQ,KAER8X,wBAAAA,CAAyBoB,GACvB,MAAMC,EAAoB9U,KAAKyU,mBAAmBI,EAAMtX,MACxD,IAAKuX,EAAmB,OAAO,EAE/B,MAAMC,EAAkB/U,KAAK4S,cAAckC,IAAoBrC,KAC/D,QAAKsC,GAEE/U,KAAKgV,gBAAgBD,EAAiBF,EAAMnX,SACrD,EAEAsX,eAAAA,CAAgBC,EAAoBvX,GAClC,OAAOuX,IAAevX,CACxB,EAEAwX,aAAAA,GAEE,MAAMC,EAAS,CAAC,EAChBnV,KAAKoV,OAAOzd,SAAQ,CAACkd,EAAOnR,KAI1ByR,EAAO,GAAGzR,OAAWmR,EAAMnX,YAAcsC,KAAKyT,yBAC5CoB,GAEE,EACA,CAAC,IAEP7U,KAAK4Q,MAAM,gBAAiB,CAC1BuE,SAEAE,QAASrV,KAAK6T,iBAAmB7T,KAAKoV,OAAO9K,QAEjD,EAEAgL,UAAAA,CAAWC,GACT,MAAMje,EAAK0I,KAAKuS,eAAetW,MAAM3E,GAAOA,EAAGiG,OAASgY,IACxD,IAAKje,EACH,MAAM,IAAI0C,MACR,uDAAyDub,GAG7D,OAAOje,CACT,EAEAyb,mBAAAA,CACEyC,EACAX,EACAY,GAEA,IAAKzV,KAAK6S,SAAU,OAChB2C,EAAUE,eACZF,EAAUE,aAAaC,WAAa,OACpCH,EAAUE,aAAaE,cAAgB,QAEzC,MAAMvB,EAASrU,KAAK4S,cAAc6C,GAClC7b,QAAQC,IAAI,oBAAqBwa,EAAQ,eAAgBQ,GAEzD,IAAK,MAAMgB,KAAY7V,KAAK0S,WAC1B9Y,QAAQC,IAAIgc,GAGd7V,KAAK2U,gBAAkBc,CACzB,EAEAlB,qBAAAA,CAAsBiB,EAAsBnB,GACtCmB,EAAUE,eACZF,EAAUE,aAAaC,WAAa,OACpCH,EAAUE,aAAaE,cAAgB,OAEvChc,QAAQC,IAAI,oBAAqBwa,GACjCrU,KAAK2U,gBAAkBN,EAAO9W,KAElC,EAEA0V,WAAAA,CAAYuC,EAAsBX,GAChC,IAAK7U,KAAK2U,gBACR,MAAM,IAAI3a,MAAM,kCAGlBJ,QAAQC,IAAI,mBAAoBmG,KAAK8V,cAAe,aAAcjB,GAGlE,MAAMkB,EAAgB/V,KAAKoV,OAAOnZ,MAC/B4Y,GAAU7U,KAAK0S,WAAWmC,EAAMtX,QAAUyC,KAAK2U,kBAG9CoB,UACK/V,KAAK0S,WAAWqD,EAAcxY,MAIvCyC,KAAK0S,WAAWmC,EAAMtX,MAAQyC,KAAK2U,gBAEnC3U,KAAK2U,qBAAkBrZ,CACzB,EAEA6Y,mBAAAA,CAAoBnb,GAElB,GADAA,EAAGuU,kBACEvN,KAAK8V,cACR,MAAM,IAAI9b,MAAM,8BAGlB,MAAM6a,EAAQ7U,KAAKoV,OAAOnZ,MACvB4Y,GAAU7U,KAAK0S,WAAWmC,EAAMtX,QAAUyC,KAAK2U,kBAE9CE,UACK7U,KAAK0S,WAAWmC,EAAMtX,KAEjC,EAEA8V,WAAAA,CAAY9O,GACV,MAAME,EAASF,EAAME,OACjBA,IACFA,EAAOvC,MAAM8T,gBAAkB,UAEnC,EAEAzC,WAAAA,CAAYhP,GACV,MAAME,EAASF,EAAME,OACjBA,IACFA,EAAOvC,MAAM8T,gBAAkB,GAEnC,EAEAlC,kBAAAA,GAEE9T,KAAKyU,iBAAmB,IAAKzU,KAAK0S,YAClC1S,KAAK6S,UAAW,CAClB,EAEAmB,sBAAAA,GACEhU,KAAK0U,yBAA0B,CACjC,EAEAR,kBAAAA,GACElU,KAAK0U,yBAA0B,EAC/B1U,KAAK0S,WAAa,CAAC,EACnB1S,KAAKyU,iBAAmB,KACxBzU,KAAK6S,UAAW,CAClB,EAEAF,mBAAAA,CAAoBkC,GAClB,OAAK7U,KAAKyU,kBAAqBzU,KAAKoJ,KAAKkG,iBAIrCtP,KAAKoJ,KAAKkG,kBACZtP,KAAKyU,iBAAmB,IAAKzU,KAAK0S,aAGhC1S,KAAK0S,aAAamC,EAAMtX,MACtByC,KAAKyT,yBAAyBoB,GACzB,mBAEA,qBAGF,IAdA,EAgBX,EAEAjC,aAAAA,CAAczR,GACZ,OAAOnB,KAAKiW,QAAQha,MAAMoY,GAAWA,EAAO9W,OAAS4D,GACvD,EAEAqT,mBAAAA,CAAoBH,GAClBza,QAAQC,IAAI,kBAAmBwa,GAC3BrU,KAAK6S,WAAU7S,KAAKsU,gBAAkBD,EAAO9W,KACnD,EAEAiW,YAAAA,CAAaqB,GACXjb,QAAQC,IAAI,iBAAkBgb,GACzB7U,KAAKsU,kBACVtU,KAAK0S,WAAWmC,EAAMtX,MAAQyC,KAAKsU,gBACnCtU,KAAKsU,qBAAkBhZ,EACzB,EAEA6X,kBAAAA,CAAmB0B,GACjBjb,QAAQC,IAAI,wBAAyBgb,GAChC7U,KAAK6S,UAENgC,UACK7U,KAAK0S,WAAWmC,EAAMtX,KAEjC,EAEA2Y,WAAAA,CAAYzD,GAEV,OAAOA,EAAKvS,QAAQ,UAAW,GACjC,GAEFG,SAAU,CACR8V,aAAAA,GACE,MAAMC,EAAgBpW,KAAKkW,YAAYlW,KAAKoJ,KAAK8F,UAGjD,OAAOkH,EAAclc,MAAM,cAC7B,EAEAqY,cAAAA,GACE,OAAOvS,KAAKmW,cAActN,KAAI,CAACjQ,EAAO8K,KACpC,GAAIA,EAAQ,IAAM,EAChB,MAAO,CAAElE,KAAM,aAAciT,KAAM7Z,EAAO2E,MAAM8Y,EAAAA,EAAAA,MAC3C,CACL,IAAIC,EAAc1d,EAAMsB,MAAM,KAC1BwD,EAAW4Y,EAAY,GACvB7Y,EAAO6Y,EAAY,GACvB,MAAO,CACL9W,KAAM,QACN9B,SAAUA,EACVD,KAAMA,EACNF,MAAM8Y,EAAAA,EAAAA,K,IAId,EAEAE,iBAAAA,GAEE,MAAMlH,GAAerP,KAAKoJ,KAAKiG,YAAYlC,MAAM,eAAiB,IAC/DtE,KAAK2N,GAAeA,EAAWtW,QAAQ,MAAO,IAAIuW,SAErD,OAAOpH,CACT,EAEA+F,MAAAA,GACE,OAAOpV,KAAKuS,eAAe5M,QACxB/B,GAAuB,UAAdA,EAAKpE,MAEnB,EAEAyW,OAAAA,GACE,MAAMpC,EAAiB7T,KAAKoV,OAAOvM,KAAKgM,IAAK,CAC3CtX,MAAM8Y,EAAAA,EAAAA,KACN5D,KAAMoC,EAAMnX,aAGRgZ,EAAoB1W,KAAKuW,kBAAkB1N,KAAK2N,IAAU,CAC9DjZ,MAAM8Y,EAAAA,EAAAA,KACN5D,KAAM+D,MAGR,MAAO,IAAI3C,KAAmB6C,EAChC,EAEAZ,aAAAA,GACE,OAAK9V,KAAK2U,gBAGD3U,KAAK4S,cAAc5S,KAAK2U,sBAF/B,CAIJ,EAEAgC,iBAAAA,GAEE,OAAO3W,KAAKiW,QACTpN,KAAKjQ,IAAK,CAAQA,QAAOkQ,KAAM0B,KAAKoM,aACpC9N,MAAK,CAACC,EAAGC,IAAMD,EAAED,KAAOE,EAAEF,OAC1BD,KAAI,EAAGjQ,WAAYA,GACxB,EAEAie,aAAAA,GAEE,OAAO7W,KAAKiW,QACTpN,KAAKjQ,GAAUA,IACfkQ,MAAK,CAACC,EAAGC,IAAMD,EAAE0J,KAAKqE,cAAc9N,EAAEyJ,OAC3C,EAEAsE,YAAAA,GACE,OAAK/W,KAAKyU,iBAGD1Z,OAAOic,KAAKhX,KAAKyU,kBAAkBnK,OAFnC,CAIX,EAEA2M,kBAAAA,GACE,OAAOjX,KAAK+W,cAAgB/W,KAAKoV,OAAO9K,MAC1C,EAEAuJ,cAAAA,GACE,OAAO7T,KAAKoV,OAAOzP,QAAQkP,GAAU7U,KAAKyT,yBAAyBoB,KAChEvK,MACL,EAEA4M,oBAAAA,GACE,OAAOlX,KAAKoV,OAAO+B,OAAOtC,GAAU7U,KAAKyT,yBAAyBoB,IACpE,EAEAjN,SAAAA,GACE,OAAO5H,KAAKoV,OAAO9K,MACrB,EAEA8J,aAAAA,GACE,OAAIpU,KAAKoJ,KAAKmG,gBACLvP,KAAK6W,cAAclR,QACvB0O,IAAYtZ,OAAOc,OAAOmE,KAAK0S,YAAYpF,SAAS+G,EAAO9W,QAGvDyC,KAAK2W,kBAAkBhR,QAC3B0O,IAAYtZ,OAAOc,OAAOmE,KAAK0S,YAAYpF,SAAS+G,EAAO9W,OAGlE,EAEA6Z,eAAAA,GACE,QAAQC,EAAAA,EAAAA,SAAQrX,KAAKyU,iBAAkBzU,KAAK0S,WAC9C,EAEA5H,eAAAA,GACE,OAC6B,OAA1B9K,KAAKyU,kBAA6BzU,KAAKoX,mBACvCpX,KAAKoJ,KAAKkG,eAEf,EAEAyE,mBAAAA,GACE,OACE/T,KAAKoJ,KAAKqG,uBACTzP,KAAK2J,eACN3J,KAAK4T,cACJ5T,KAAKkX,oBAEV,EAEAjD,eAAAA,GACE,OACEjU,KAAKoJ,KAAKoG,cACVxP,KAAK4T,cACJ5T,KAAKkX,sBACoB,OAA1BlX,KAAKyU,gBAET,EAEA9K,aAAAA,GACE,OACE3J,KAAK0U,0BACJ1U,KAAKiX,qBACHjX,KAAKoJ,KAAKuG,kCAEjB,EAEA+D,6BAAAA,GACE,OACE1T,KAAKoJ,KAAKuG,mCACV3P,KAAK0U,0BACJ1U,KAAKiX,qBACLjX,KAAKoX,eAEV,EAEAxD,WAAAA,GACE,QAC8B,OAA1B5T,KAAKyU,oBACNzU,KAAK0T,iCACJ1T,KAAKoJ,KAAKkG,iBAAmBtP,KAAKiX,sBACnCjX,KAAKoX,eAEV,EAEA1Y,aAAAA,GACE,IAAIA,EAAgBsB,KAAKoJ,KAAK9K,QAAQI,cAAcwB,QAClD,WACAF,KAAK6T,eAAehb,YAQtB,OALA6F,EAAgBA,EAAcwB,QAC5B,SACAF,KAAKoV,OAAO9K,OAAOzR,YAGd6F,CACT,EAEAiV,yBAAAA,GACE,OAAO3T,KAAKoJ,KAAK9K,QAAQuR,uBACrB7P,KAAKoJ,KAAK9K,QAAQuR,wBAClBlU,EAAAA,EAAAA,IACE,6DAER,KCpjBJ,MAAM,IAA2B,OAAgB,GAAQ,CAAC,CAAC,SAAS,IAAQ,CAAC,YAAY,qBAEzF,UCPA,MACM6E,GAAa,CCFZ3B,MAAM,eDGP6B,GAAa,CCFT7B,MAAM,WDGVwC,GAAa,CCCNxC,MAAM,uCDAb4C,GAAa,CAAC,gBACdC,GAAa,CCgBH7C,MAAM,yBDfhB8C,GAAa,CAAC,YACdC,GAAa,CC+EH/C,MAAM,yBD9EhBgD,GAAa,CAAC,YACdC,GAAa,CAAC,YACdC,GAAc,CAAC,YACfC,GAAc,CAAC,YAEf,SAAUzB,GAAOxB,EAAUgG,EAAY6B,EAAYC,EAAYC,EAAWC,GAC9E,MAAM8H,GAA4BC,EAAAA,EAAAA,IAAkB,kBAC9CC,GAA6BD,EAAAA,EAAAA,IAAkB,mBAErD,OAAQ9J,EAAAA,EAAAA,OClBRrG,EAAAA,EAAAA,IA+JM,MA/JN6B,GA+JM,EA9JJC,EAAAA,EAAAA,IA6JO,OA7JPC,GA6JO,EA5JLD,EAAAA,EAAAA,IAkBW,kBAjBTA,EAAAA,EAAAA,IAAqD,eAAA0E,EAAAA,EAAAA,IAA1CpG,EAAApD,SAAS,uBAAD,IAEnB8E,EAAAA,EAAAA,IAKM,MALNY,GAKM,EAJJZ,EAAAA,EAAAA,IAES,UAFAO,QAAK+D,EAAA,KAAAA,EAAA,GDoBxB,IAAInI,ICpBsBmC,EAAAiQ,UAAAjQ,EAAAiQ,YAAApS,IAAUiC,MAAM,mBAAmBW,KAAK,WDuBrD2F,EAAAA,EAAAA,ICtBEpG,EAAApD,SAAS,qBAAD,IAEb8E,EAAAA,EAAAA,IAAiE,OAA5D5B,MAAM,uBAAwB,eAAcE,EAAAkQ,cDwB9C,KAAM,EAAGxN,OCrBd4D,EAAAA,EAAAA,IAOEwJ,EAAA,CANCpJ,WAAY1G,EAAAiE,oBAAoBkM,SAChC,sBAAmBnQ,EAAAoQ,eACpBpM,IAAI,UACJ,uBACA,2BACA,yBDwBC,KAAM,EAAG,CAAC,aAAc,2BCpB7BtC,EAAAA,EAAAA,IA+DW,WA/DXiB,GA+DW,EA9DTjB,EAAAA,EAAAA,IAAgD,eAAA0E,EAAAA,EAAAA,IAArCpG,EAAApD,SAAS,kBAAD,IAEnB8E,EAAAA,EAAAA,IAOQ,eDeNqF,EAAAA,EAAAA,KCrBArF,EAAAA,EAAAA,IAIE,SDkBA,sBAAuBsE,EAAO,KAAOA,EAAO,GAAM9D,GCrBzClC,EAAAiE,oBAAoBsU,cAAarW,GACzCmF,SAAMrB,EAAA,KAAAA,EAAA,GDuBnB,IAAInI,ICvBiBmC,EAAAuE,sBAAAvE,EAAAuE,wBAAA1G,IACT4C,KAAK,YDwBJ,KAAM,KAAM,CACb,CAACiH,EAAAA,GC3BQ1H,EAAAiE,oBAAoBsU,kBD6B/BnR,EAAAA,EAAAA,IC1BE,KACFhB,EAAAA,EAAAA,IAAGpG,EAAApD,SAAS,uCAAD,MAGb8E,EAAAA,EAAAA,IAOQ,eDkBNqF,EAAAA,EAAAA,KCxBArF,EAAAA,EAAAA,IAIE,SDqBA,sBAAuBsE,EAAO,KAAOA,EAAO,GAAM9D,GCxBzClC,EAAAiE,oBAAoBuU,YAAWtW,GACvCmF,SAAMrB,EAAA,KAAAA,EAAA,GD0BnB,IAAInI,IC1BiBmC,EAAAuE,sBAAAvE,EAAAuE,wBAAA1G,IACT4C,KAAK,YD2BJ,KAAM,KAAM,CACb,CAACiH,EAAAA,GC9BQ1H,EAAAiE,oBAAoBuU,gBDgC/BpR,EAAAA,EAAAA,IC7BE,KACFhB,EAAAA,EAAAA,IAAGpG,EAAApD,SAAS,4CAAD,MAGb8E,EAAAA,EAAAA,IAOQ,eDqBNqF,EAAAA,EAAAA,KC3BArF,EAAAA,EAAAA,IAIE,SDwBA,sBAAuBsE,EAAO,KAAOA,EAAO,GAAM9D,GC3BzClC,EAAAiE,oBAAoBwU,YAAWvW,GACvCmF,SAAMrB,EAAA,KAAAA,EAAA,GD6BnB,IAAInI,IC7BiBmC,EAAAuE,sBAAAvE,EAAAuE,wBAAA1G,IACT4C,KAAK,YD8BJ,KAAM,KAAM,CACb,CAACiH,EAAAA,GCjCQ1H,EAAAiE,oBAAoBwU,gBDmC/BrR,EAAAA,EAAAA,IChCE,KACFhB,EAAAA,EAAAA,IAAGpG,EAAApD,SAAS,8BAAD,MAGb8E,EAAAA,EAAAA,IAOQ,eDwBNqF,EAAAA,EAAAA,KC9BArF,EAAAA,EAAAA,IAIE,SD2BA,sBAAuBsE,EAAO,KAAOA,EAAO,GAAM9D,GC9BzClC,EAAAiE,oBAAoBwM,aAAYvO,GACxCmF,SAAMrB,EAAA,KAAAA,EAAA,GDgCnB,IAAInI,IChCiBmC,EAAAuE,sBAAAvE,EAAAuE,wBAAA1G,IACT4C,KAAK,YDiCJ,KAAM,KAAM,CACb,CAACiH,EAAAA,GCpCQ1H,EAAAiE,oBAAoBwM,iBDsC/BrJ,EAAAA,EAAAA,ICnCE,KACFhB,EAAAA,EAAAA,IAAGpG,EAAApD,SAAS,8BAAD,MAGb8E,EAAAA,EAAAA,IAOQ,eD2BNqF,EAAAA,EAAAA,KCjCArF,EAAAA,EAAAA,IAIE,SD8BA,sBAAuBsE,EAAO,KAAOA,EAAO,GAAM9D,GCjCzClC,EAAAiE,oBAAoByM,qBAAoBxO,GAChDmF,SAAMrB,EAAA,MAAAA,EAAA,IDmCnB,IAAInI,ICnCiBmC,EAAA2Q,4BAAA3Q,EAAA2Q,8BAAA9S,IACT4C,KAAK,YDoCJ,KAAM,KAAM,CACb,CAACiH,EAAAA,GCvCQ1H,EAAAiE,oBAAoByM,yBDyC/BtJ,EAAAA,EAAAA,ICtCE,KACFhB,EAAAA,EAAAA,IAAGpG,EAAApD,SAAS,+BAAD,MAGb8E,EAAAA,EAAAA,IAcQ,SAbL5B,OAAKC,EAAAA,EAAAA,IAAA,CDqCJ,oBCrCyCC,EAAAiE,oBAAoByM,wBDuC9D,EACD3J,EAAAA,EAAAA,KCpCArF,EAAAA,EAAAA,IAKE,SDgCA,sBAAuBsE,EAAO,MAAQA,EAAO,IAAO9D,GCpC3ClC,EAAAiE,oBAAoB2M,kCAAiC1O,GAC7DmF,SAAMrB,EAAA,MAAAA,EAAA,IDsCnB,IAAInI,ICtCiBmC,EAAAuE,sBAAAvE,EAAAuE,wBAAA1G,IACRgT,UAAW7Q,EAAAiE,oBAAoByM,qBAChCjQ,KAAK,YDuCJ,KAAM,GAAImC,IAAa,CACxB,CAAC8E,EAAAA,GC3CQ1H,EAAAiE,oBAAoB2M,sCD6C/BxJ,EAAAA,EAAAA,ICzCE,KACFhB,EAAAA,EAAAA,IACEpG,EAAApD,SAAS,4DAAD,IDwCT,MCnCL8E,EAAAA,EAAAA,IA+DW,WA/DXmB,GA+DW,EA9DTnB,EAAAA,EAAAA,IAAiD,eAAA0E,EAAAA,EAAAA,IAAtCpG,EAAApD,SAAS,mBAAD,IAEnB8E,EAAAA,EAAAA,IAQQ,SARA5B,OAAKC,EAAAA,EAAAA,IAAA,oBAAwBC,EAAAiE,oBAAoBwU,eDsCtD,EACDrR,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,ICtCdpG,EAAApD,SAAS,gCAAiC,IAC7C,IDsCAmK,EAAAA,EAAAA,KCtCArF,EAAAA,EAAAA,IAKE,SDkCA,sBAAuBsE,EAAO,MAAQA,EAAO,IAAO9D,GCtC3ClC,EAAAiE,oBAAoB1E,QAAQC,YAAW0C,GAC/C8E,QAAKhB,EAAA,MAAAA,EAAA,IAAA9D,GAAElC,EAAAuE,qBAAqB,uCAC5BsM,SAAU7Q,EAAAiE,oBAAoBwU,YAC/BhY,KAAK,QDuCJ,KAAM,GAAIqC,IAAa,CACxB,CAACoE,EAAAA,GC3CQlH,EAAAiE,oBAAoB1E,QAAQC,gBD6CtC,ICtCHkC,EAAAA,EAAAA,IAUQ,SATL5B,OAAKC,EAAAA,EAAAA,IAAA,qBAAyBC,EAAAiE,oBAAoBwM,gBDwClD,EACDrJ,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,ICvCdpG,EAAApD,SAAS,iCAAkC,IAC9C,IDuCAmK,EAAAA,EAAAA,KCvCArF,EAAAA,EAAAA,IAKE,SDmCA,sBAAuBsE,EAAO,MAAQA,EAAO,IAAO9D,GCvC3ClC,EAAAiE,oBAAoB1E,QAAQE,YAAWyC,GAC/C8E,QAAKhB,EAAA,MAAAA,EAAA,IAAA9D,GAAElC,EAAAuE,qBAAqB,uCAC5BsM,UAAW7Q,EAAAiE,oBAAoBwM,aAChChQ,KAAK,QDwCJ,KAAM,GAAIsC,IAAa,CACxB,CAACmE,EAAAA,GC5CQlH,EAAAiE,oBAAoB1E,QAAQE,gBD8CtC,ICvCHiC,EAAAA,EAAAA,IAcQ,SAbL5B,OAAKC,EAAAA,EAAAA,IAAA,CDyCJ,oBCzCyCC,EAAAiE,oBAAoByM,wBD2C9D,EACDtJ,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,ICxCdpG,EAAApD,SAAS,8BAA+B,IAC3C,IDwCAmK,EAAAA,EAAAA,KCxCArF,EAAAA,EAAAA,IAOE,SDkCA,sBAAuBsE,EAAO,MAAQA,EAAO,IAAO9D,GCxC3ClC,EAAAiE,oBAAoB1E,QAAQG,gBAAewC,GACnD8E,QAAKhB,EAAA,MAAAA,EAAA,IAAA9D,GAAiBlC,EAAAuE,qBAAoB,2CAG1CsM,UAAW7Q,EAAAiE,oBAAoByM,qBAChCjQ,KAAK,QDyCJ,KAAM,GAAIuC,IAAc,CACzB,CAACkE,EAAAA,GC/CQlH,EAAAiE,oBAAoB1E,QAAQG,oBDiDtC,ICxCHgC,EAAAA,EAAAA,IAqBQ,SApBL5B,OAAKC,EAAAA,EAAAA,IAAA,CD0CJ,oBC1CuDC,EAAAiE,oBAAoByM,uBAAuC1Q,EAAAiE,oBAAoB2M,qCD8CvI,EACDxJ,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,ICzCdpG,EAAApD,SAAS,qDAAsD,IAClE,IDyCAmK,EAAAA,EAAAA,KCzCArF,EAAAA,EAAAA,IAYE,SD8BA,sBAAuBsE,EAAO,MAAQA,EAAO,IAAO9D,GCzC3ClC,EAAAiE,oBAAoB1E,QAAQuR,uBAAsB5O,GAC1D8E,QAAKhB,EAAA,MAAAA,EAAA,IAAA9D,GAAiBlC,EAAAuE,qBD2CnB,kDCtCHsM,UAA0B7Q,EAAAiE,oBAAoByM,uBAAuC1Q,EAAAiE,oBAAoB2M,kCAI1GnQ,KAAK,QD0CJ,KAAM,GAAIwC,IAAc,CACzB,CAACiE,EAAAA,GCrDQlH,EAAAiE,oBAAoB1E,QAAQuR,2BDuDtC,MCxCLxK,EAAAA,EAAAA,IAKE0J,EAAA,CAJClH,SAAU9I,EAAAiE,oBAAoB6E,SAC9B,iBAAgB9I,EAAAiE,oBAAoB1E,QAAQI,cAC5C,oBAAiBK,EAAA+Q,eACjB,yBAAuB/Q,EAAAgR,qBD2CvB,KAAM,EAAG,CAAC,WAAY,iBAAkB,oBAAqB,8BAGtE,CC1BA,QAAe3Q,EAAAA,EAAAA,IAAgB,CAC7B8B,KAAM,wBACNqB,KAAAA,GACE,MAAO,CACLE,YAAYpD,EAAAA,EAAAA,IAAwBnI,EAAAA,GAExC,EACA2Z,WAAY,CAAEC,cAAa,KAAEC,eAAcA,IAC3CzR,MAAO,CACL/F,eAAgB,CACdiG,KAAMzE,OACN2E,UAAU,IAGdG,IAAAA,GACE,MAAO,CACLmD,qBAAqBC,EAAAA,EAAAA,WAAUjD,KAAKzG,gBAExC,EACAQ,MAAO,CAELR,eAAgB,CACdwO,WAAW,EACXC,QAAS,WACPhI,KAAKgD,qBAAsBC,EAAAA,EAAAA,WAAUjD,KAAKzG,eAC5C,IAGJ8G,SAAU,CACR4O,YAAAA,GACE,OAAOtT,EAAAA,EAAAA,IACL,qRAEJ,GAEFwM,QAAS,CACPxM,SAAQ,KAKRqT,QAAAA,GACE,MAAMgC,EAAahR,KAAKsI,MAAM2I,SAAiBC,IACzCC,EAASrV,OAAOC,OAAOkV,QAAQG,UAAUJ,GAC/C,IAAKG,EAEH,MADAvX,QAAQoS,MAAM,kCAAmCmF,GAC3C,IAAInX,MAAM,6CAElB,MAAMqX,EAAYF,EAAOG,MAAMC,SAASF,UAClCG,EAAQH,EAAUI,mBAClBC,EAAML,EAAUM,kBACtB,IAAKH,IAAUE,EAEb,MADA9X,QAAQoS,MAAM,oBAAqBwF,EAAO,mBAAoBE,GACxD,IAAI1X,MAAM,qCAElBmX,EAAOG,MAAMM,QAAQC,IACnBA,EAAOC,WAAW,IAAKJ,GACvBG,EAAOC,WAAW,IAAKN,EAAM,GAEjC,EAEArC,cAAAA,CAAetP,GAEbG,KAAKyC,WAAYhJ,YAAY,CAC3BC,mBAAmB8J,EAAAA,EAAAA,IACjBxD,KAAKgD,qBACJS,IACCA,EAAMyL,SAAWrP,CAAI,IAGzBlG,UAAW,2BAEf,EAEA2J,oBAAAA,CAAqB3J,GAEnBC,QAAQC,IAAI,0BACZmG,KAAKyC,WAAYhJ,YAAY,CAC3BC,mBAAmBuJ,EAAAA,EAAAA,WAAUjD,KAAKgD,qBAClCrJ,UAAWA,GAAa,CAAC,GAE7B,EAEA+V,0BAAAA,GACO1P,KAAKgD,oBAAoByM,uBAC5BzP,KAAKgD,oBAAoB2M,mCAAoC,GAE/D3P,KAAKsD,sBACP,EAEAwM,cAAAA,CAAeiC,GACb/R,KAAKyC,WAAYhJ,YAAY,CAC3BC,mBAAmB8J,EAAAA,EAAAA,IACjBxD,KAAKgD,qBACJgP,IACCA,EAAUnK,SAAWkK,CAAe,IAGxCpY,UAAW,2BAEf,EAEAoW,mBAAAA,CAAoBkC,GAClBjS,KAAKyC,WAAYhJ,YAAY,CAC3BC,mBAAmB8J,EAAAA,EAAAA,IACjBxD,KAAKgD,qBACJgP,IACCA,EAAU1T,QAAQI,cAAgBuT,CAAoB,IAG1DtY,UAAW,wCAEf,EAEA8O,UAAAA,CAAWC,GACT,OACE5M,OAAOC,OAAO4M,WAAa,qBAAuBD,EAAW,MAEjE,KChSJ,MAAM,IAA2B,OAAgB,GAAQ,CAAC,CAAC,SAAS,IAAQ,CAAC,YAAY,qBAEzF,UCPA,MACMlI,GAAa,CCFZ3B,MAAM,cAAckE,IAAI,kBDMzBrC,GAAa,CCLV7B,MAAM,2BDMTwC,GAAa,CAAC,aACdI,GAAa,CAAC,sBAAuB,WAAY,YACjDC,GAAa,CAAEX,IAAK,GACpBY,GAAa,CAAC,gBACdC,GAAa,CACjBb,IAAK,ECoBKlC,MAAM,mBDjBZgD,GAAa,CC0BVhD,MAAM,iCDzBTiD,GAAa,CAAC,eACdC,GAAc,CCuCTlD,MAAM,gBDtCXmD,GAAc,CAAC,eACfC,GAAc,CAAC,eACf2M,GAAc,CAAC,eAEf,SAAUrO,GAAOxB,EAAUgG,EAAY6B,EAAYC,EAAYC,EAAWC,GAC9E,MAAMuL,GAA6BxD,EAAAA,EAAAA,IAAkB,mBAErD,OAAQ9J,EAAAA,EAAAA,OCzBRrG,EAAAA,EAAAA,IAqFM,MArFN6B,GAqFM,EApFJC,EAAAA,EAAAA,IAqCM,MArCNC,GAqCM,GDXHsE,EAAAA,EAAAA,KAAW,ICzBZrG,EAAAA,EAAAA,IAmCWgC,EAAAA,GAAA,MAAAC,EAAAA,EAAAA,IAnCiB7B,EAAAwT,gBAAX9a,KD0BPuN,EAAAA,EAAAA,OAAcrG,EAAAA,EAAAA,IAAoBgC,EAAAA,GAAW,CACnDI,IC3B8CtJ,EAAQ8F,MD4BrD,CC3B0B,eAAjB9F,EAAQ+H,OD6BbwF,EAAAA,EAAAA,OC7BPrG,EAAAA,EAAAA,IAAmE,QD8B3DoC,IAAK,EC9B8ByR,UAAQ/a,EAAQgb,MDgClD,KAAM,EAAGpR,KC9BoB,UAAjB5J,EAAQ+H,ODgCpBwF,EAAAA,EAAAA,OChCTrG,EAAAA,EAAAA,IA+BWgC,EAAAA,GAAA,CAAAI,IAAA,KDED+E,EAAAA,EAAAA,KChCRrF,EAAAA,EAAAA,IAcE,SAbAjB,KAAK,ODiCG,sBAAwByB,GChCvBlC,EAAA2T,WAAWjb,EAAQ8F,MAAI0D,EAC/BwW,UAAW1Y,EAAA8T,SACXjD,UAAW7Q,EAAA8T,SACXhU,OAAKC,EAAAA,EAAAA,IAAA,CDiCJ,QACA,CAAE4Y,YClC0D3Y,EAAAqK,KAAKoO,aAA6BzY,EAAA4Y,cAAclgB,KAK7GmgB,OAAI7S,EAAA,KAAAA,EAAA,GDkCjB,IAAInI,IClCemC,EAAA6Y,QAAA7Y,EAAA6Y,UAAAhb,IACNib,QAAK9S,EAAA,KAAAA,EAAA,IAAA+S,EAAAA,EAAAA,KAAA7W,GAAQlC,EAAAgZ,QAAQ9W,IAAM,YAC3B8E,QAAKhB,EAAA,KAAAA,EAAA,GDoClB,IAAInI,ICpCgBmC,EAAAgH,SAAAhH,EAAAgH,WAAAnJ,IDqCAob,SAAS,ECpCjBjV,IAAI,UDsCK,KAAM,GAAItB,IAAa,CACxB,CAACwE,EAAAA,GClDAlH,EAAA2T,WAAWjb,EAAQ8F,SAcjB9F,EAAQgG,ODuCRuH,EAAAA,EAAAA,OCvCbrG,EAAAA,EAAAA,IAEQ,QAAA+C,GAAA,EADNjB,EAAAA,EAAAA,IAAkE,QAA5D5B,MAAM,uBAAwB,eAAcpH,EAAQgG,MD0C3C,KAAM,EAAGkE,QAEdgF,EAAAA,EAAAA,IAAoB,IAAI,ICxCb5H,EAAA4K,eAAgC5K,EAAA2U,+BAAgD3U,EAAA0U,yBAAyBhc,ID+CpHkP,EAAAA,EAAAA,IAAoB,IAAI,KADvB3B,EAAAA,EAAAA,OC/CbrG,EAAAA,EAAAA,IASO,OATPiD,IASOuD,EAAAA,EAAAA,IADF1N,EAAQwgB,UAAU,IAAD,KDyCb,MACHtR,EAAAA,EAAAA,IAAoB,IAAI,IAC7B,OACD,SCrCNlG,EAAAA,EAAAA,IA2CM,MA3CNoB,GA2CM,CAzCI9C,EAAA2U,gCDuCH1O,EAAAA,EAAAA,OCxCLrG,EAAAA,EAAAA,IAIE,ODqCIoC,IAAK,ECvCTlC,MAAM,iBDyCF2I,aCxCJrC,EAAAA,EAAAA,IAAkCpG,EAAA4U,4BDyC7B,KAAM,EAAG7R,MACZ6E,EAAAA,EAAAA,IAAoB,IAAI,GCtCpB5H,EAAA6U,cDwCH5O,EAAAA,EAAAA,OCzCL0B,EAAAA,EAAAA,IAME4L,EAAA,CDoCIvR,IAAK,ECxCR2G,eAAgB3I,EAAA8U,eAChBjM,UAAW7I,EAAA6I,UACXC,SAAU9I,EAAAqK,KAAKvB,SACfnJ,cAAeK,EAAAL,eD0CX,KAAM,EAAG,CAAC,iBAAkB,YAAa,WAAY,oBACxDiI,EAAAA,EAAAA,IAAoB,IAAI,ICxC5BlG,EAAAA,EAAAA,IA2BM,MA3BNsB,GA2BM,CAzBIhD,EAAA+L,kBDyCH9F,EAAAA,EAAAA,OC1CLrG,EAAAA,EAAAA,IAOE,UDoCIoC,IAAK,EACLyG,aC1CJrC,EAAAA,EAAAA,IAAiCpG,EAAAqK,KAApB9K,QAAQC,aACpByC,QAAK+D,EAAA,KAAAA,EAAA,GAAA9D,GAAElC,EAAAmM,cAAa,IACrB1L,KAAK,SACLX,MAAM,gBACNkE,IAAI,eD2CC,KAAM,EAAGf,MACZ2E,EAAAA,EAAAA,IAAoB,IAAI,GCzCZ5H,EAAAmZ,mBD2CXlT,EAAAA,EAAAA,OC3CLrG,EAAAA,EAAAA,IAgBWgC,EAAAA,GAAA,CAAAI,IAAA,IAdDhC,EAAAoZ,qBD2CCnT,EAAAA,EAAAA,OC5CTrG,EAAAA,EAAAA,IAME,UDuCQoC,IAAK,EACLyG,aC5CRrC,EAAAA,EAAAA,IAAqCpG,EAAAqK,KAAxB9K,QAAQG,iBACpBuC,QAAK+D,EAAA,KAAAA,EAAA,GD8ClB,IAAInI,IC9CgBmC,EAAAqZ,qBAAArZ,EAAAqZ,uBAAAxb,IACR4C,KAAK,SACLX,MAAM,iBD+CG,KAAM,EAAGoD,MACZ0E,EAAAA,EAAAA,IAAoB,IAAI,GC5CxB5H,EAAAkV,kBD8CCjP,EAAAA,EAAAA,OC/CTrG,EAAAA,EAAAA,IAME,UD0CQoC,IAAK,EACLyG,aC/CRrC,EAAAA,EAAAA,IAAiCpG,EAAAqK,KAApB9K,QAAQE,aACpBwC,QAAK+D,EAAA,KAAAA,EAAA,GDiDlB,IAAInI,ICjDgBmC,EAAAsZ,iBAAAtZ,EAAAsZ,mBAAAzb,IACR4C,KAAK,SACLX,MAAM,iBDkDG,KAAM,EAAG+P,MACZjI,EAAAA,EAAAA,IAAoB,IAAI,IAC3B,MACHA,EAAAA,EAAAA,IAAoB,IAAI,QAG/B,IACL,CCvBA,MAAM2R,GAAOC,EAAQ,MAErB,QAAenZ,EAAAA,EAAAA,IAAgB,CAC7B8B,KAAM,wBAEN2P,WAAY,CACVlC,gBAAeA,IAGjBrP,MAAO,CACL8J,KAAM,CACJ5J,KAAMzE,OACN2E,UAAU,IAIdG,IAAAA,GACE,MAAO,CACL6S,WAAY,CAAC,EACb+B,iBAAkB,KAClB9K,eAAe,EACfkJ,UAAU,EAEd,EAEA1K,QAAS,CACPxM,SAAQ,KAER8X,wBAAAA,CAAyBhc,GACvB,MAAMod,EAAQpd,EAERsd,EAAkB/U,KAAKyU,mBAAmBI,EAAMtX,MACtD,QAAKwX,GAGIF,EAAMoD,UAAUhL,MAAMvP,GAC3BsC,KAAKgV,gBAAgBD,EAAiBrX,IAG5C,EAEAsX,eAAAA,CAAgBC,EAAoBvX,GAClC,OAAIsC,KAAKoJ,KAAKkO,cACRtX,KAAKoJ,KAAKmO,YACLvX,KAAKwY,wBAAwBvD,EAAYvX,GAEzCuX,IAAevX,EAIpBsC,KAAKoJ,KAAKmO,YACLvX,KAAKwY,wBACVvD,EAAWhV,cACXvC,EAASuC,eAGJgV,EAAWhV,gBAAkBvC,EAASuC,aAGnD,EAEAuY,uBAAAA,CAAwBvD,EAAoBvX,GAC1C,GAAIuX,IAAevX,EAAU,OAAO,EAGpC,MAAM+a,EAAWH,GAAKG,SAASxD,EAAYvX,GAI3C,OACGuX,EAAW3K,OAAS,GAAKmO,GAAY,GACrCxD,EAAW3K,OAAS,GAAKmO,GAAY,CAE1C,EAEAvD,aAAAA,GAEE,MAAMC,EAAS,CAAC,EAChBnV,KAAKoV,OAAOzd,SAAQ,CAACkd,EAAOnR,KAI1ByR,EAAO,GAAGzR,OAAWmR,EAAMoD,UAAU,MACnCjY,KAAKyT,yBAAyBoB,GAAS,EAAI,CAAC,IAEhD7U,KAAK4Q,MAAM,gBAAiB,CAC1BuE,SAEAE,QAASrV,KAAK6T,iBAAmB7T,KAAKoV,OAAO9K,QAEjD,EAOAoO,iBAAAA,CAAkBC,GAKhB,MAAMC,EAAiB9c,OAAO+c,iBAAiBF,EAAO,MAChDG,EAAmBF,EAAeG,iBAAiB,aACnDC,EAAqBJ,EAAeG,iBAAiB,eACrDE,EAAkBL,EAAeG,iBAAiB,WAClDrO,EAAWwO,SAASJ,EAAkB,IACtCK,EAAQ,EACRC,EAAQ1O,EAAWyO,EACnBE,EAAa,KACbC,EAAa5O,EAAW2O,EACxBE,EAAiB,GAAM7O,EAE7BxC,YAAW,KACT,MAAMsR,EAAMjI,SAASkI,cAAc,OACnCD,EAAIhS,YAAcmR,EAAM/f,MACxB,MAAM8gB,EAAY,CAChBC,SAAU,WACV,cAAe,SACf,YAAab,EACb,cAAeE,EACfY,QAASX,EACT5R,MAAO,WAET,IAAK,MAAOtG,EAAKnI,KAAUmC,OAAO8e,QAAQH,GACxCF,EAAItX,MAAMnB,GAAcnI,EAE1B+f,EAAMmB,cAAeC,OAAOP,GAC5B,MAAMnS,EAAQmS,EAAIxO,YACZgP,EAAeha,KAAKsI,MAAM2R,eAC7BjP,YACHwO,EAAIU,SAGFvB,EAAMzW,MAAMmF,MAFVA,GAAS+R,GAEUA,EAAQG,GAAgB1gB,WAAa,KACjDwO,EAAQiS,GAAcU,GAEVA,EAAcV,GAAYzgB,WAAa,MAGvCwO,EAAQkS,GAAgB1gB,WAAa,I,GAE3D,EACL,EAEAqS,YAAAA,CAAaiP,GAEXna,KAAKyU,iBAAmB,IAAKzU,KAAK0S,YAClC1S,KAAKkV,gBACLlV,KAAK6S,SAAWsH,CAClB,EAEA/B,mBAAAA,GACEpY,KAAK2J,eAAgB,CACvB,EAEA0O,eAAAA,GACErY,KAAKoa,YACLpa,KAAKqa,kBACP,EAEAD,SAAAA,GACEpa,KAAK2J,eAAgB,EACrB3J,KAAK0S,WAAa,CAAC,EACnB1S,KAAKyU,iBAAmB,KACxBzU,KAAK6S,UAAW,CAClB,EAEAwH,gBAAAA,GACGra,KAAKsI,MAAM8M,OAA8Bzd,SACvCghB,IACC3Y,KAAK0Y,kBAAkBC,EAAM,GAGnC,EAEAf,MAAAA,GACE5X,KAAKsa,mBACP,EAEAvC,OAAAA,CAAQxT,GACNvE,KAAKsa,oBACLta,KAAKua,eAAehW,EAAME,OAC5B,EAEA6V,iBAAAA,GACEta,KAAK2J,eAAgB,EACjB3J,KAAKoJ,KAAKoO,aACZxX,KAAKkL,cAAa,EAEtB,EAEAqP,cAAAA,CAAe1F,GACb,MAAMO,EAASpV,KAAKsI,MAAM8M,OAGpBoF,EAAepF,EAAOqF,QAAQ5F,GAGpC,IAAsB,IAAlB2F,GAAuBA,EAAepF,EAAO9K,OAAS,EAAG,CAC3D,MAAMoQ,EAAYtF,EAAOoF,EAAe,GACxCE,EAAU5M,O,MAGN9N,KAAK8K,iBACN9K,KAAKsI,MAAM/J,YAAiCuP,OAGnD,EAEA/H,OAAAA,CAAQxB,GACNvE,KAAK0Y,kBAAkBnU,EAAME,OAC/B,EAEAkT,aAAAA,CAAc9C,GACZ,OAAK7U,KAAKyU,sBAIiCnZ,GAAvC0E,KAAKyU,mBAAmBI,EAAMtX,MAC5ByC,KAAKyT,yBAAyBoB,GACzB,UAEA,YAGL7U,KAAKoJ,KAAKoO,YACL,cAEA,wBAbF,EAgBX,EAEA/O,UAAAA,CAAWC,GACT,OACE5M,OAAOC,OAAO4M,WAAa,qBAAuBD,EAAW,MAEjE,EAEAwN,WAAAA,CAAYzD,GAEV,OAAOA,EAAKvS,QAAQ,UAAW,GACjC,GAGFG,SAAU,CACR8V,aAAAA,GACE,MAAMC,EAAgBpW,KAAKkW,YAAYlW,KAAKoJ,KAAK8F,UAIjD,OAAOkH,EAAclc,MAAM,cAC7B,EAEAqY,cAAAA,GACE,OAAOvS,KAAKmW,cAActN,KAAI,CAACjQ,EAAO8K,KACpC,GAAIA,EAAQ,IAAM,EAChB,MAAO,CAAElE,KAAM,aAAciT,KAAM7Z,EAAO2E,MAAM8Y,EAAAA,EAAAA,MAC3C,CACL,IAAIC,EAAc1d,EAAMsB,MAAM,KAC1B+d,EAAY3B,EAAY,GAAGpc,MAAM,KACjCuD,EAAO6Y,EAAY,GACvB,MAAO,CACL9W,KAAM,QACNyY,UAAWA,EACXxa,KAAMA,EACNF,MAAM8Y,EAAAA,EAAAA,K,IAId,EAEAjB,MAAAA,GACE,OAAOpV,KAAKuS,eAAe5M,QACxB/B,GAAuB,UAAdA,EAAKpE,MAEnB,EAEAuX,YAAAA,GACE,OAAK/W,KAAKyU,iBAGD1Z,OAAOic,KAAKhX,KAAKyU,kBAAkBnK,OAFnC,CAIX,EAEA2M,kBAAAA,GACE,OAAOjX,KAAK+W,cAAgB/W,KAAKoV,OAAO9K,MAC1C,EAEAuJ,cAAAA,GACE,OAAO7T,KAAKoV,OAAOzP,QAAQkP,GAAU7U,KAAKyT,yBAAyBoB,KAChEvK,MACL,EAEA4M,oBAAAA,GACE,OAAOlX,KAAKoV,OAAO+B,OAAOtC,GAAU7U,KAAKyT,yBAAyBoB,IACpE,EAEAjN,SAAAA,GACE,OAAO5H,KAAKoV,OAAO9K,MACrB,EAEA8M,eAAAA,GACE,QAAQC,EAAAA,EAAAA,SAAQrX,KAAKyU,iBAAkBzU,KAAK0S,WAC9C,EAEAwF,gBAAAA,GACE,OAAIlY,KAAKoJ,KAAKoO,cACRxX,KAAKiX,qBAEqB,OAA1BjX,KAAKyU,mBACJzU,KAAKoX,kBACLpX,KAAKkX,sBAOkB,OAA1BlX,KAAKyU,mBACJzU,KAAKoX,kBACLpX,KAAKkX,oBAGZ,EAEApM,eAAAA,GACE,OAC6B,OAA1B9K,KAAKyU,kBAA6BzU,KAAKoX,mBACvCpX,KAAKoJ,KAAKoO,WAEf,EAEAW,kBAAAA,GACE,OACEnY,KAAKoJ,KAAKqG,sBACVzP,KAAK4T,cACJ5T,KAAK2J,aAEV,EAEAsK,eAAAA,GACE,OAAOjU,KAAKoJ,KAAKoG,cAA0C,OAA1BxP,KAAKyU,gBACxC,EAEAf,6BAAAA,GACE,OACE1T,KAAKoJ,KAAKuG,mCACV3P,KAAK2J,gBACJ3J,KAAKiX,qBACLjX,KAAKoX,eAEV,EAEAxD,WAAAA,GACE,QAC8B,OAA1B5T,KAAKyU,oBACNzU,KAAK0T,iCACJ1T,KAAKoJ,KAAKoO,aAAexX,KAAKiX,sBAC/BjX,KAAKoX,eAEV,EAEA1Y,aAAAA,GACE,IAAIA,EAAgBsB,KAAKoJ,KAAK9K,QAAQI,cAAcwB,QAClD,WACAF,KAAK6T,eAAehb,YAQtB,OALA6F,EAAgBA,EAAcwB,QAC5B,SACAF,KAAKoV,OAAO9K,OAAOzR,YAGd6F,CACT,EAEAkK,qBAAAA,GACE,OAAO5I,KAAKoJ,KAAKvB,SACdgB,KAAKjQ,GAAUA,IACfkQ,MAAK,CAACC,EAAGC,IAAMA,EAAEC,WAAaF,EAAEE,YACrC,EAEA0K,yBAAAA,GACE,OAAO3T,KAAKoJ,KAAK9K,QAAQuR,uBACrB7P,KAAKoJ,KAAK9K,QAAQuR,wBAClBlU,EAAAA,EAAAA,IACE,6DAER,KCnfJ,MAAM,IAA2B,OAAgB,GAAQ,CAAC,CAAC,SAAS,IAAQ,CAAC,YAAY,qBAEzF,UCPA,MAAM6E,GAAa,CAAEO,IAAK,GACpBL,GAAa,CAAEK,IAAK,GACpBM,GAAa,CAAC,UAEd,SAAUd,GAAOxB,EAAUgG,EAAY6B,EAAYC,EAAYC,EAAWC,GAC9E,OCNYhI,EAAA4b,uBDOP3V,EAAAA,EAAAA,OCPLrG,EAAAA,EAAAA,IAES,OAAA6B,IAAA2E,EAAAA,EAAAA,IADPpG,EAAApD,SAAS,2BAAD,MDOLqJ,EAAAA,EAAAA,OCLLrG,EAAAA,EAAAA,IAUM,MAAA+B,GAAA,EATJD,EAAAA,EAAAA,IAKE,SAJAsC,IAAI,YACJvD,KAAK,OACJob,OAAQ7b,EAAA6b,OACRxU,SAAMrB,EAAA,KAAAA,EAAA,GDOb,IAAInI,ICPWmC,EAAA8b,eAAA9b,EAAA8b,iBAAAje,KDQJ,KAAM,GAAIyE,MACZ2D,EAAAA,EAAAA,KAAW,ICPhBrG,EAAAA,EAAAA,IAEIgC,EAAAA,GAAA,MAAAC,EAAAA,EAAAA,IAFwC7B,EAAA+b,QAAT9O,KDQrBhH,EAAAA,EAAAA,OCRdrG,EAAAA,EAAAA,IAEI,KAFDE,MAAM,mBAA4CkC,IAAKiL,IDWjD7G,EAAAA,EAAAA,ICVJ6G,GAAK,MDWF,QAEZ,C,wBCIA,IAAe5M,EAAAA,EAAAA,IAAgB,CAC7B8B,KAAM,aACNsP,MAAO,CAAC,gBACRlR,MAAO,CAELsb,OAAQ,CACNpb,KAAMC,OACNC,UAAU,EACVE,QAAS,YAGbC,IAAAA,GACE,MAAO,CAGL8a,0BAAsBrf,EACtByf,sBAAkBzf,EAClBwf,OAAQ,GACRE,iBAAkB,qBAEtB,EACA,aAAM3jB,GACJ,MAAM4jB,QAAgBC,EAAAA,GAAAA,IAAW,CAAEC,OAAQnb,KAAKmb,SAE1CC,EAAoBH,EAAQhf,MAC/Bof,GAAMA,EAAEC,WAAWpa,OAASlB,KAAKgb,mBAGpC,GAAII,EACFxhB,QAAQC,IAAI,QAASmG,KAAKgb,iBAAkB,WAC5Chb,KAAK+a,iBAAmBK,EAAkBja,OACrC,CACLvH,QAAQC,IACN,SACAmG,KAAKgb,iBACL,gEAEF,IACE,MAAMO,EAAaN,EAAQhf,MACxBof,GAAsC,eAAhCA,EAAEC,WAAW,iBAGtB,IAAKC,EAAY,CACf,MAAMC,GAAe7f,EAAAA,EAAAA,IACnB,gHAKF,OAFAqE,KAAK8a,OAAOtZ,KAAKga,QACjB5hB,QAAQoS,MAAMwP,E,CAIZD,GACF3hB,QAAQC,IACN,yBACA0hB,EAAWD,WAAWpa,KACtB,IAAMqa,EAAWD,WAAW,eAAiB,KAIjD,MAAMG,QAAkBC,EAAAA,GAAAA,IAAa,CACnCP,OAAQnb,KAAKmb,OACbja,KAAMlB,KAAKgb,iBACXW,eAAgBJ,EAAWpa,GAC3Bya,WAAY,iBAGVH,GACF7hB,QAAQC,IACN,iBACA4hB,EAAUH,WAAWpa,KACrB,YACAqa,EAAWD,WAAWpa,MAI1BlB,KAAK+a,iBAAmBU,EAAUta,E,CAClC,MAAO6K,GACP,MAAMwP,GAAe7f,EAAAA,EAAAA,IACnB,kBACEqE,KAAKgb,iBADP,6EAKFhb,KAAK8a,OAAOtZ,KAAKga,GACjB5hB,QAAQoS,MAAMwP,EAAcxP,E,EAGlC,EACA3L,SAAU,KACLwb,EAAAA,GAAAA,IAAW,CACZC,eAAgB,oBAElBX,MAAAA,GAEE,OAAOrf,OAAOC,OAAOggB,OACvB,EACAC,UAAAA,GACE,MAAO,CAAExc,KAAM,QAAS2B,GAAI,GAAGnB,KAAKmb,SACtC,EACAc,iBAAAA,GACE,IAAIA,EAAiC,GACjCC,EACFlc,KAAK8b,eAAe,CAClBK,OAAQnc,KAAKgc,WACbI,aAAc,aACV,GAOR,OANAF,EAAYvkB,SAAS0kB,IACsB,iBAArCA,EAAOf,WAAW,gBACpBW,EAAkBza,KAAK6a,E,IAIpBJ,CACT,GAEF9T,QAAS,CACPxM,SAAQ,SACL2gB,EAAAA,GAAAA,IAAW,CACZC,oBAAqB,wBAGvBC,kBAAAA,CAAmBC,GAUjB,OAAOzc,KAAKuc,oBAAoBE,EAClC,EACA,oBAAMC,GACJ,MAAMP,EAASnc,KAAKgc,WACdI,EAAe,UACfO,EAAU,CAAE,cAAe,KACjC,aAAa3c,KAAKwc,mBAAmB,CAAEL,SAAQC,eAAcO,WAC/D,EACA9B,aAAAA,CAActW,GACZ,GAAIvE,KAAK2a,qBAIP,YAHA/gB,QAAQgjB,KACN,kFAIJ,MAAMjE,EAAQ3Y,KAAKsI,MAAMuU,UACnBC,EAAOnE,EAAMoE,OAAOlX,KAAK,GAC/B,GAAKiX,EAAL,CAMA,IAAK9c,KAAK+a,iBAAkB,CAC1B,MAAM/O,GAAQrQ,EAAAA,EAAAA,IACZ,wEAIF,OAFA/B,QAAQoS,MAAMA,QACdhM,KAAK8a,OAAOtZ,KAAKwK,E,CAGnBhM,KAAK8a,OAAS,GACd9a,KAAK2a,sBAAuBqC,EAAAA,GAAAA,IAAW,CACrCF,KAAM,CACJxB,WAAY,CACVpa,KAAM4b,EAAK5b,OAGf+b,SAAUH,EACVT,OAAQ,CAAElb,GAAInB,KAAK+a,oBAElBmC,MAAMC,IACLnd,KAAK4Q,MAAM,eAAgBuM,GAC3Bnd,KAAK2a,0BAAuBrf,EAC5B0E,KAAK8a,OAAS,EAAE,IAEjBsC,OAAOpR,IAKNpS,QAAQoS,MAAMA,GACdhM,KAAK8a,OAAOtZ,KAAKwK,GACjBhM,KAAK2a,0BAAuBrf,CAAS,G,MAnCvC1B,QAAQgjB,KACN,+DAoCN,KCnNJ,MAAM,IAA2B,OAAgB,GAAQ,CAAC,CAAC,SAAS,MAEpE,UCEO,MAAMS,GAAmClmB,OAC9C,kCCRImmB,GAAeC,KAAMC,EAAAA,EAAAA,IAAa,mBAAmBD,EAAEA,KAAIE,EAAAA,EAAAA,MAAcF,GACzE/c,GAAa,CCKV3B,MAAM,+BAA+BkE,IAAI,QDD5CrC,GAAa,CAAC,KAAM,UAAW,gBAAiB,gBAAiB,eACjEW,GAAa,CAAC,gBAAiB,gBAAiB,eAChDI,GAAa,CACjBV,IAAK,EC2CAmB,MAAO,CAAAC,UAAA,MAAAC,SAAA,EAAAC,WAAA,IDxCRX,GAAa,CACjBX,IAAK,EC4CAmB,MAAO,CAAAC,UAAA,MAAAC,SAAA,EAAAC,WAAA,IDzCRV,GAAa,CCoDRO,MAAA,iEDnDLN,GAAa,CCoDJM,MAAA,6DDnDTL,GAAa,CAAC,WACdC,GAAa,CAAC,SACdC,GAAc,CAAC,QAAS,SACxBC,GAA4Bsb,IAAa,KCyEzC7c,EAAAA,EAAAA,IAA2C,OAAtC5B,MAAM,QAAQ,wBDtEtB,MAAO,KAEJ,SAAU0B,GAAOxB,EAAUgG,EAAY6B,EAAYC,EAAYC,EAAWC,GAC9E,MAAM2W,GAAuB5O,EAAAA,EAAAA,IAAkB,aAE/C,OAAQ9J,EAAAA,EAAAA,OC7BRrG,EAAAA,EAAAA,IAgGM,OA/FJE,OAAKC,EAAAA,EAAAA,IAAA,CAAC,uCAAsC,CD8B1C4D,MC7BqB3D,EAAA2D,SAGvBK,IAAI,WD6BH,EC3BDtC,EAAAA,EAAAA,IA0CM,MA1CND,GA0CM,GDbHwE,EAAAA,EAAAA,KAAW,ICzBZrG,EAAAA,EAAAA,IA+BSgC,EAAAA,GAAA,MAAAC,EAAAA,EAAAA,IA9BW7B,EAAA4e,UAAXC,KDyBC5Y,EAAAA,EAAAA,OC1BVrG,EAAAA,EAAAA,IA+BS,UA7BNoC,IAAK6c,EAAQrgB,KACdiC,KAAK,SACLX,OAAKC,EAAAA,EAAAA,IAAA,CAAC,UAAS,CD0Bb,qBCzBwCC,EAAAoS,OD0BxChV,SC1BoE4C,EAAAoS,QAAQ0M,kBAAkBjlB,QAAUglB,EAAQrgB,QAIjH4D,GAAE,WAAapC,EAAA+e,OAAOF,EAAQrgB,OAC9B2E,OAAKsM,EAAAA,EAAAA,IAAEzP,EAAAgf,gBAAgBH,IACvB5c,QAAKC,GAAElC,EAAAif,eAAe/c,EAAQ2c,GAC9BnP,cAAWxN,GAAElC,EAAAkf,qBAAqBhd,EAAQ2c,GAC1CM,cAAWjd,GAAElC,EAAAof,qBAAqBld,EAAQ2c,GAC1CQ,YAASnd,GAAElC,EAAAsf,mBAAmBpd,EAAQ2c,IDyBpC,CCvBa7e,EAAAoS,SDyBTnM,EAAAA,EAAAA,KAAW,ICxBhBrG,EAAAA,EAAAA,IAYEgC,EAAAA,GAAA,CAAAI,IAAA,IAAAH,EAAAA,EAAAA,IAXiB7B,EAAAuf,eAAVC,KDwBKvZ,EAAAA,EAAAA,OCzBdrG,EAAAA,EAAAA,IAYE,OAVCoC,IAAKwd,EACN1f,OAAKC,EAAAA,EAAAA,IAAA,CAAC,gBACEyf,IACP9P,eAAWvJ,EAAAA,EAAAA,KAAAjE,GAAsBlC,EAAAyf,0BAA0Bvd,EAAQsd,EAAQX,IDyBzE,CAAC,SCtBHM,eAAWhZ,EAAAA,EAAAA,KAAAjE,GAAsBlC,EAAA0f,0BAA0Bxd,EAAQsd,EAAQX,IDyBzE,CAAC,SCtBHQ,aAASlZ,EAAAA,EAAAA,KAAAjE,GAAOlC,EAAA2f,wBAAwBzd,EAAQsd,EAAQX,IAAO,WDwBzD,KAAM,GAAIvc,OACX,OACJsF,EAAAA,EAAAA,IAAoB,IAAI,IAC3B,GAAIjG,OACL,OCxBJ2E,EAAAA,EAAAA,IAKEqY,EAAA,CAJCvW,IAAKpI,EAAA4f,YAAY5f,EAAA6f,MAAMC,SACvBtX,IAAKxI,EAAA6f,MAAME,QACX9d,QAAOjC,EAAAggB,kBACRlgB,MAAM,kBD0BL,KAAM,EAAG,CAAC,MAAO,MAAO,aAC1B,KCvBKE,EAAA2D,OAAS3D,EAAAoS,SDyBZnM,EAAAA,EAAAA,OC1BLrG,EAAAA,EAAAA,IAIC,MAJD8C,IAIC0D,EAAAA,EAAAA,IAAA,CAAA6Z,gBADOjgB,EAAAigB,gBAAeC,UAAElgB,EAAAkgB,YAAS,KDwB9BtY,EAAAA,EAAAA,IAAoB,IAAI,GCrBpB5H,EAAA2D,OAAS3D,EAAAmgB,SDuBZla,EAAAA,EAAAA,OCxBLrG,EAAAA,EAAAA,IAIC,MAJD+C,IAICyD,EAAAA,EAAAA,IAAA,CAAA6Z,gBADOjgB,EAAAigB,gBAAeC,UAAElgB,EAAAkgB,YAAS,KDsB9BtY,EAAAA,EAAAA,IAAoB,IAAI,GClBpB5H,EAAAoS,SDoBHnM,EAAAA,EAAAA,OCtBLrG,EAAAA,EAAAA,IAmCM,ODZAoC,IAAK,ECtBTgC,IAAI,yBAEJlE,OAAKC,EAAAA,EAAAA,IAAA,CAAC,2BAA0B,CDuB9BqgB,QCtByBpgB,EAAAigB,oBDwBtB,ECpBLve,EAAAA,EAAAA,IAgBM,MAhBNkB,GAgBM,EAfJlB,EAAAA,EAAAA,IAOQ,QAPRmB,GAOQ,EANNnB,EAAAA,EAAAA,IAIE,SAHC2e,QAASrgB,EAAAigB,iBAAiBK,QAC3B7f,KAAK,WACJ4G,SAAMrB,EAAA,KAAAA,EAAA,GAAA9D,GAAElC,EAAAoS,OAAQmO,yBAAyBre,EAAOwD,OAAO2a,WDsBnD,KAAM,GAAIvd,KACbsE,EAAAA,EAAAA,ICtBF,KACFhB,EAAAA,EAAAA,IAAGpG,EAAApD,SAAS,YAAD,MAEb8E,EAAAA,EAAAA,IAME,UALAjB,KAAK,SACLX,MAAM,qBACNqD,MAAA,uBACClB,QAAK+D,EAAA,KAAAA,EAAA,GAAA9D,GAAElC,EAAAoS,OAAQoO,yBACfhgB,MAAOR,EAAApD,SAAS,2BDsBZ,KAAM,EAAGmG,OCnBlBrB,EAAAA,EAAAA,IAQQ,eDcF0F,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,ICrBlBpG,EAAApD,SAAS,cAAe,IAC3B,IAAA8E,EAAAA,EAAAA,IAKE,SAJC7H,MAAQmG,EAAAigB,iBAA6BnX,SACrC9B,QAAKhB,EAAA,KAAAA,EAAA,GAAA9D,GAAElC,EAAAoS,OAAQqO,mBAAmBve,EAAOwD,OAAO7L,QACjD4G,KAAK,OACJD,MAAOR,EAAApD,SAAS,0CDsBZ,KAAM,GAAIoG,MCnBnBC,IDsBK,KACH2E,EAAAA,EAAAA,IAAoB,IAAI,IAC3B,EACL,CEtHA,MACMnG,GAAa,CAAC,MAAO,OACrBE,GAAa,CACjBK,IAAK,ECMQlC,MAAM,eDFf,SAAU0B,GAAOxB,EAAUgG,EAAY6B,EAAYC,EAAYC,EAAWC,GAC9E,MAAMC,GAA0BC,EAAAA,EAAAA,IAAkB,gBAElD,OCVQlI,EAAA0gB,UDWJ3Z,EAAAA,EAAAA,MAAiBd,EAAAA,EAAAA,OCZrBrG,EAAAA,EAAAA,IASE,OATF+gB,EAAAA,EAAAA,IASE,CDII3e,IAAK,ECXRoG,IAAKpI,EAAAoI,IACLI,IAAKxI,EAAAwI,IACLoY,OAAI5a,EAAA,KAAAA,EAAA,GDcT,IAAInI,ICdOmC,EAAA4gB,QAAA5gB,EAAA4gB,UAAA/iB,IACNgjB,QAAK7a,EAAA,KAAAA,EAAA,GDgBV,IAAInI,IChBQmC,EAAA6gB,SAAA7gB,EAAA6gB,WAAAhjB,IACRiC,MAAM,cACEE,EAAA8gB,QAAM,QAAArf,KAAA,CDiBV,CAACwG,OAEFhC,EAAAA,EAAAA,OChBLrG,EAAAA,EAAAA,IAAmC,OAAnC+B,IDiBF,C,eCVA,IAAetB,EAAAA,EAAAA,IAAgB,CAC7B8B,KAAM,YAEN5B,MAAO,CACL6H,IAAK,CAAE3H,KAAMC,OAAQC,UAAU,GAC/B6H,IAAK,CAAE/H,KAAMC,OAAQG,QAAS,KAEhC7F,MAAO,CACLoN,IAAK,WAOHnH,KAAK8f,kBACP,GAEFjgB,IAAAA,GACE,MAAO,CACL4f,UAAU,EAEd,EACAtX,QAAS,CACPwX,MAAAA,GACE/lB,QAAQC,IAAI,iBAAiBmG,KAAKmH,MACpC,EAEAyY,OAAAA,GACEhmB,QAAQoS,MAAM,yBAAyBhM,KAAKmH,MAC9C,EAEA2Y,gBAAAA,GACEC,GAAAA,GAAkBC,SAAQC,UACxB,IAEE,MAAMC,EAAM,IAAIC,MAChBD,EAAI/Y,IAAMnH,KAAKmH,UAET,IAAIiZ,SAAc,CAACC,EAASC,KAChCJ,EAAIK,OAAS,KACXF,GAAS,EAEXH,EAAIM,QAAU,IACZF,EAAO,IAAItmB,MAAM,yBAAyBgG,KAAKmH,OAAO,IAG1DnH,KAAKyf,UAAW,C,CAChB,MAAOzT,GACPpS,QAAQoS,MAAMA,E,IAGpB,GAEF3L,SAAU,CACRogB,cAAAA,GACE,OAAO3kB,OAAOC,OAAO6G,gBAAgB8d,sBACvC,GAEFrpB,OAAAA,GACE,GAAK2I,KAAKygB,eAIH,CAEL,MAAME,EAAwB7kB,OAAO8kB,YAAc,EAAxB,KAErBC,EAAW,IAAIC,sBACnB,EAAEC,MACIA,EAAMC,iBACRhhB,KAAK8f,mBACLe,EAASI,UAAUF,EAAMtc,QACzBoc,EAASK,a,GAGb,CACEC,WAAYR,EACZS,UAAW,MAIfP,EAASQ,QAAQrhB,KAAKkR,I,MApBtBlR,KAAK8f,kBAsBT,IC/FF,MAAM,IAA2B,OAAgB,GAAQ,CAAC,CAAC,SAAS,IAAQ,CAAC,YAAY,qBAEzF,UCDO,MAAMwB,GAAmCnqB,OAC9C,kC,eJiIF,IAAeiI,EAAAA,EAAAA,IAAgB,CAC7B8B,KAAM,oBACN2P,WAAY,CAAE0Q,UAASA,IACvBhf,KAAAA,GACE,MAAO,CACL4O,QAAQ9R,EAAAA,EAAAA,IACNge,QAIA/hB,GAEF4jB,QAAQ7f,EAAAA,EAAAA,IACNiiB,QAIAhmB,GAGN,EACAgE,MAAO,CACLqe,SAAU,CACRne,KAAMzE,OACN2E,UAAU,GAEZkf,MAAO,CACLpf,KAAMzE,OACN2E,UAAU,IAGdG,IAAAA,GACE,MAAO,CACL2hB,oBAAgBlmB,EAChB2jB,eAAW3jB,EAEf,EACA+E,SAAU,CACRqC,KAAAA,GACE,OAAO5G,OAAOC,OAAO6G,gBAAgBC,mBAAoB,CAC3D,EAIAib,GAAAA,GACE,OAAO9Z,EAAAA,EAAAA,IACT,EACAgb,eAAAA,GACE,OAAOhf,KAAK2d,SAAS1hB,MAClBwlB,GAAMA,EAAElkB,OAASyC,KAAKmR,QAAQ0M,kBAAkBjlB,OAErD,EACA0lB,aAAAA,GACE,MAAO,CACL,OACA,WACA,MACA,YACA,QACA,eACA,SACA,cAEJ,GAEFvkB,MAAO,CACLilB,gBAAiB,CACfjX,WAAW,EACXC,QAAS,SAAU4V,GACjB5d,KAAKwhB,gBAAgBE,UACjB9D,GAOF5d,KAAK2hB,WAAU,KACb,MAAMC,EAAiBrQ,SAASsQ,eAC9B,WAAW7hB,KAAK8d,OAAOF,EAAQrgB,QAE3BukB,EAAiB9hB,KAAKsI,MACzByZ,uBACH/hB,KAAKwhB,gBAAiBQ,EAAAA,GAAAA,IAAaJ,EAAgBE,EAAgB,CACjEG,UAAW,MACXC,UAAW,CACT,CACEhhB,KAAM,SACNyb,QAAS,CACPwF,OAAQ,CAAC,EAAG,QAIlB,GAGR,IAGJha,QAAS,CACPxM,SAAQ,KACRgjB,YAAW,GACXI,iBAAAA,CAAkBxa,GAChB,GAAIvE,KAAKmR,OACPnR,KAAKmR,QAAQiR,mBAAc9mB,QACtB,GAAI0E,KAAKkf,OAAQ,CAEtB,MAAMmD,EACJriB,KAAKsI,MAAMyC,QACXiD,wBAEF,IAAIsU,EAAS/d,EAAM0J,QAAUoU,EAAYnU,KACrCqU,EAAShe,EAAM4J,QAAUkU,EAAYjU,IAEzCpO,KAAKkf,OAAOsD,gBAAgBF,EAAQC,E,CAExC,EACAvE,cAAAA,CAAezZ,EAAqBqZ,GAGlC,GAFAhkB,QAAQC,IAAI,iBAAkB+jB,GAE1B5d,KAAKmR,OACPnR,KAAKmR,QAAQiR,cAAcxE,EAAQrgB,WAC9B,GAAIyC,KAAKkf,OAAQ,CAEtB,MAAMmD,EACJriB,KAAKsI,MAAMyC,QACXiD,wBAEF,IAAIsU,EAAS/d,EAAM0J,QAAUoU,EAAYnU,KACrCqU,EAAShe,EAAM4J,QAAUkU,EAAYjU,IAEzCpO,KAAKkf,OAAOuD,aAAa7E,EAAQrgB,KAAM+kB,EAAQC,E,CAEnD,EACAtE,oBAAAA,CAAqB1Z,EAAqBqZ,GACxChkB,QAAQC,IAAI,wBACPmG,KAAKmR,SAGVnR,KAAKmR,OAAOiR,cAAcxE,EAAQrgB,MAClCyC,KAAKif,UAAY,CACfzf,KAAM,cACNkjB,UAAW9E,EAAQrgB,KACnBolB,QAAQ3e,EAAAA,EAAAA,KACR4e,gBAAiB,CAACre,EAAM0J,QAAS1J,EAAM4J,SACvC0U,gBAAiB,CAACjF,EAAQjgB,EAAGigB,EAAQ/f,IAEtC0G,EAAME,OAAuBqe,kBAAkBve,EAAMwe,WACxD,EACA1E,kBAAAA,CAAmB9Z,EAAqBqZ,GACtChkB,QAAQC,IAAI,sBACZmG,KAAKif,eAAY3jB,EAChBiJ,EAAME,OAAuBue,sBAAsBze,EAAMwe,UAC5D,EACA5E,oBAAAA,CAAqB5Z,EAAqBqZ,GACxC,GAC2B,gBAAzB5d,KAAKif,WAAWzf,MAChBQ,KAAKif,UAAUyD,YAAc9E,EAAQrgB,KACrC,CACA,MAAM0lB,EACJjjB,KAAKsI,MAAM4a,KACXlV,wBACImV,EAAY5e,EAAM6e,cAElBC,EAAW9e,EAAM0J,QAAUjO,KAAKif,UAAU2D,gBAAgB,GAC1DU,EAAaD,EAAWJ,EAAS5b,MACjCkc,EAAYvjB,KAAKif,UAAU4D,gBAAgB,GAAKS,EAChDE,EAAeL,EAAUnY,YAAciY,EAAS5b,MAChDoc,EAAO,IAAOD,EACdE,EAAO,IACPC,EAAmBnZ,KAAKlE,IAAIod,EAAMlZ,KAAKjE,IAAIkd,EAAMF,IAEjDK,EAAWrf,EAAM4J,QAAUnO,KAAKif,UAAU2D,gBAAgB,GAC1DiB,EAAaD,EAAWX,EAAS3b,OACjCwc,EAAY9jB,KAAKif,UAAU4D,gBAAgB,GAAKgB,EAChDE,EAAgBZ,EAAUlY,aAAegY,EAAS3b,OAClD0c,EAAO,IAAOD,EACdE,EAAO,IACPC,EAAmB1Z,KAAKlE,IAAI2d,EAAMzZ,KAAKjE,IAAIyd,EAAMF,IAEjD3iB,EAAKnB,KAAKif,UAAUyD,UAC1B1iB,KAAKmR,QAAQgT,YACXnkB,KAAKif,UAAU0D,OACfxhB,EACAwiB,EACAO,GAEFlkB,KAAKwhB,gBAAgB4C,Q,CAEzB,EACA5F,yBAAAA,CACEja,EACAga,EACAX,GAEAhkB,QAAQC,IAAI,6BACPmG,KAAKmR,SAGVnR,KAAKmR,OAAOiR,cAAcxE,EAAQrgB,MAClCyC,KAAKif,UAAY,CACfzf,KAAM,gBACNmjB,QAAQ3e,EAAAA,EAAAA,KACR0e,UAAW9E,EAAQrgB,KACnBqlB,gBAAiB,CAACre,EAAM0J,QAAS1J,EAAM4J,SACvC0U,gBAAiB,CAACjF,EAAQjgB,EAAGigB,EAAQ/f,GACrCwmB,iBAAkB,CAACzG,EAAQvW,MAAOuW,EAAQtW,QAC1CiX,UAEDha,EAAME,OAAuBqe,kBAAkBve,EAAMwe,WACxD,EACArE,uBAAAA,CACEna,EACAga,EACAX,GAEAhkB,QAAQC,IAAI,2BACZmG,KAAKif,eAAY3jB,EAChBiJ,EAAME,OAAuBue,sBAAsBze,EAAMwe,UAC5D,EACAtE,yBAAAA,CACEla,EACAga,EACAX,GAEA,GAC2B,kBAAzB5d,KAAKif,WAAWzf,MAChBQ,KAAKif,UAAUyD,YAAc9E,EAAQrgB,KACrC,CACA,MAAM0lB,EACJjjB,KAAKsI,MAAM4a,KACXlV,yBAEA6U,iBAAkByB,EAAUC,GAC5BF,kBAAmBG,EAAcC,IAC/BzkB,KAAKif,UACT,IAAIyF,EAAOJ,EACPK,EAAWH,EACXI,EAAOL,EACPM,EAAYJ,EAGhB,MAAMK,EACJvgB,EAAM0J,QAAUjO,KAAKif,UAAU2D,gBAAgB,GAC3CmC,EAAYD,EAAkB7B,EAAS5b,MAEvC2d,EACJzgB,EAAM4J,QAAUnO,KAAKif,UAAU2D,gBAAgB,GAC3CqC,EAAYD,EAAkB/B,EAAS3b,OAIhC,SAAXiX,GACW,aAAXA,GACW,gBAAXA,EAEIwG,EAAYP,GACdE,EAAOJ,EAAWE,EAClBG,EAAWI,EAAYP,IAEvBE,EAAOJ,EAAWS,EAClBJ,EAAWH,EAAeO,GAGjB,UAAXxG,GACW,cAAXA,GACW,iBAAXA,KAEKwG,EAAYP,GACfE,EAAOJ,EAAWE,EAAeO,EACjCJ,GAAYI,EAAYP,IAExBE,EAAOJ,EACPK,EAAWH,EAAeO,IAMjB,aAAXxG,GACW,QAAXA,GACW,cAAXA,EAEI0G,EAAYR,GACdG,EAAOL,EAAWE,EAClBI,EAAYI,EAAYR,IAExBG,EAAOL,EAAWU,EAClBJ,EAAYJ,EAAgBQ,GAGnB,gBAAX1G,GACW,WAAXA,GACW,iBAAXA,KAEK0G,EAAYR,GACfG,EAAOL,EAAWE,EAAgBQ,EAClCJ,GAAaI,EAAYR,IAEzBG,EAAOL,EACPM,EAAYJ,EAAgBQ,IAKhC,IAAIC,EAAiBtH,EAAQtW,OAC3B6d,EAAgBvH,EAAQvW,MACxB+d,EAAYxH,EAAQjgB,EACpB0nB,EAAYzH,EAAQ/f,EACtB,MAAMynB,EAAkBT,EAAY5B,EAAS3b,OACvCie,EAAiBZ,EAAW1B,EAAS5b,MACrCme,EAAoB,GACtBF,EAAkBE,IACpBN,EAAiBL,EACjBQ,EAAYT,GAEVW,EAAiBC,IACnBL,EAAgBR,EAChBS,EAAYV,GAId,MAAMe,EACJL,EAAY,KAAQA,EAAYD,EAAgB,IAC5CO,EACJL,EAAY,KAAQA,EAAYH,EAAiB,IAC/CO,IACFL,EAAYxH,EAAQjgB,EACpBwnB,EAAgBvH,EAAQvW,OAEtBqe,IACFL,EAAYzH,EAAQ/f,EACpBqnB,EAAiBtH,EAAQtW,QAG3BtH,KAAKmR,OAAQwU,cACX3lB,KAAKif,UAAU0D,OACf/E,EAAQrgB,KACR6nB,EACAC,EACAF,EACAD,GAEFllB,KAAKwhB,gBAAgB4C,Q,CAEzB,EACArG,eAAAA,CAAgBH,GACd,MAAqB,cAAjBA,EAAQpe,KACH,CACL0O,KAAqB,IAAZ0P,EAAQjgB,EAAX,IACNyQ,IAAoB,IAAZwP,EAAQ/f,EAAX,IACLwJ,MAA0B,IAAhBuW,EAAQvW,MAAX,IACPC,OAA4B,IAAjBsW,EAAQtW,OAAX,KAGH,CACL4G,KAAqB,IAAZ0P,EAAQjgB,EAAX,IACNyQ,IAAoB,IAAZwP,EAAQ/f,EAAX,IACLwJ,MAA0B,IAAhBuW,EAAQvW,MAAX,IACPC,OAA4B,IAAjBsW,EAAQtW,OAAX,IACRse,aAAc,MAGpB,KK9eJ,MAAM,IAA2B,OAAgB,GAAQ,CAAC,CAAC,SAAS,IAAQ,CAAC,YAAY,qBAEzF,UCNA,MAAMtI,GAAeC,KAAMC,EAAAA,EAAAA,IAAa,mBAAmBD,EAAEA,KAAIE,EAAAA,EAAAA,MAAcF,GACzE/c,GAAa,CAAE3B,MAAO,eACtB6B,GAAa,CAAE7B,MAAO,WACtBwC,GAAa,CACjBN,IAAK,EACLlC,MAAO,4BAEH4C,GAAa,CAAE5C,MAAO,cACtB6C,GAAa,CAAC,SACdC,GAA2B2b,IAAa,KAAmB7c,EAAAA,EAAAA,IAAoB,MAAO,CAC1F4G,MAAO,KACPC,OAAQ,KACRue,QAAS,YACTC,MAAO,8BACN,EACYrlB,EAAAA,EAAAA,IAAoB,OAAQ,CACvC9C,EAAG,IACHE,EAAG,IACHwJ,MAAO,KACPC,OAAQ,KACRye,KAAM,OACNC,OAAQ,eACR,eAAgB,MAChBC,GAAI,QAEJ,KACErkB,GAAa,CACjBD,IAEIE,GAAa,CAAC,SACdC,GAA2Bwb,IAAa,KAAmB7c,EAAAA,EAAAA,IAAoB,MAAO,CAC1F4G,MAAO,KACPC,OAAQ,KACRue,QAAS,YACTC,MAAO,8BACN,EACYrlB,EAAAA,EAAAA,IAAoB,SAAU,CACzCylB,GAAI,KACJC,GAAI,KACJC,EAAG,KACHL,KAAM,OACNC,OAAQ,eACR,eAAgB,UAEhB,KACEjkB,GAAc,CAClBD,IAEIE,GAAc,CAAEjB,IAAK,GACrBkB,GAAc,CAAEpD,MAAO,yBACvB+P,GAAc,CAAE1M,MAAO,CAAC,gBAAgB,IAAI,MAAQ,gBACpDgQ,GAAc,CAAEhQ,MAAO,CAAC,QAAU,OAAO,cAAc,SAAS,IAAM,WACtEiQ,GAAc,CAAC,WAAY,OAC3BC,GAAc,CAAElQ,MAAO,CAAC,MAAQ,gBAChCmQ,GAAc,CAAEnQ,MAAO,CAAC,QAAU,OAAO,cAAc,SAAS,IAAM,WACtEmkB,GAAc,CAAC,WAAY,OAC3BC,GAAc,CAAEvlB,IAAK,GACrBwlB,GAAc,CAAE1nB,MAAO,yBACvB2nB,GAAc,CAAE3nB,MAAO,yBACvB4nB,GAAc,CAClB1lB,IAAK,EACLmB,MAAO,CAAEC,UAAW,MAAOC,SAAU,EAAGC,WAAY,IA0BtD,QAA4BC,EAAAA,EAAAA,IAAiB,CAC3ChD,MAAO,CACP/F,eAAgB,CACdiG,KAAMzE,OACN2E,UAAU,IAGZ6C,KAAAA,CAAMC,GAER,MAAMlD,EAAQkD,ECqJRC,GAAapD,EAAAA,EAAAA,IAAwBnI,EAAAA,GASrCwL,EAAQ5G,OAAOC,OAAO6G,gBAAgBC,iBAGtCG,GAAsBD,EAAAA,EAAAA,KAC1BE,EAAAA,EAAAA,WAAU3D,EAAM/F,iBAEZskB,GAAoB9a,EAAAA,EAAAA,SAAwBzH,GAC5CorB,GAAsB3jB,EAAAA,EAAAA,KAAa,GACnC4jB,GAAiB5jB,EAAAA,EAAAA,IAAmB,MACpC6jB,GAAc7jB,EAAAA,EAAAA,KAAa,GAC3B8jB,GAAgB9jB,EAAAA,EAAAA,IAAmB,MACnC+jB,GAAuB/jB,EAAAA,EAAAA,OAI7BzB,EAAAA,EAAAA,IAAQ+b,GAAkC,CACxCQ,oBACAuE,gBACA7C,wBACAD,2BACAE,qBACA2E,cACAwB,kBAIF,MAAMoB,GAA0B1mB,EAAAA,EAAAA,KAC9B,IACE2C,EAAoBpK,MAAM+kB,SAAShY,QAAQiY,GAAYA,EAAQyB,UAC5D/U,SAGD0c,GAAyB3mB,EAAAA,EAAAA,KAC7B,IAAM2C,EAAoBpK,MAAM+tB,iBAG5BM,GAAwB5mB,EAAAA,EAAAA,KAC5B,IAAM2C,EAAoBpK,MAAMiuB,gBAmBlC,SAASvjB,EAAqB3J,GAE5BC,QAAQC,IAAI,0BACZ4I,EAAYhJ,YAAY,CACtBC,mBAAmBuJ,EAAAA,EAAAA,WAAUD,EAAoBpK,OACjDe,UAAWA,GAAa,CAAC,GAE7B,CAEA,SAASutB,IACFN,EAAYhuB,OASbiuB,EAAcjuB,OACdiuB,EAAcjuB,QACXouB,EAAuBpuB,MACpBouB,EAAuBpuB,MACvBmuB,EAAwBnuB,SAW9BiuB,EAAcjuB,MAAQ4R,KAAKjE,IACzBygB,EAAuBpuB,MACnBouB,EAAuBpuB,MACvBmuB,EAAwBnuB,MAC5B,IAZFoK,EAAoBpK,OAAQ4K,EAAAA,EAAAA,IAC1BR,EAAoBpK,OACnB6K,IACCA,EAAMojB,cAAgBA,EAAcjuB,KAAe,MAjBzDiuB,EAAcjuB,MAAQ,KACtBoK,EAAoBpK,OAAQ4K,EAAAA,EAAAA,IAAQR,EAAoBpK,OAAQ6K,IAC9DA,EAAMojB,cAAgB,CAAC,KAmC3BvjB,GACF,CAEA,SAAS6jB,IACFT,EAAoB9tB,OASrB+tB,EAAe/tB,OACf+tB,EAAe/tB,OAASmuB,EAAwBnuB,QAahD+tB,EAAe/tB,MAAQ4R,KAAKjE,IAAIwgB,EAAwBnuB,MAAO,IAV/DoK,EAAoBpK,OAAQ4K,EAAAA,EAAAA,IAC1BR,EAAoBpK,OACnB6K,IACCA,EAAMkjB,eAAiBA,EAAe/tB,MAClC+tB,EAAe/tB,MACfmuB,EAAwBnuB,KAAK,MAhBvC+tB,EAAe/tB,MAAQ,KACvBoK,EAAoBpK,OAAQ4K,EAAAA,EAAAA,IAAQR,EAAoBpK,OAAQ6K,IAC9DA,EAAMkjB,eAAiB,CAAC,KA+B5BrjB,IAIA4jB,GACF,CAEA,SAASE,EAAgBtK,GACvB9Z,EAAoBpK,OAAQ4K,EAAAA,EAAAA,IAAQR,EAAoBpK,OAAQ6K,IAC9DA,EAAMmb,MAAQ,CACZrhB,MAAMyG,EAAAA,EAAAA,KACNxE,KAAM,QACNqf,QAAS/B,EAAK3b,GACd2d,QAAS,GACV,IAGHxb,GACF,CAEA,SAAS+jB,IACP,MAAMC,EAAQ/V,SAASgW,cAAc,mBAC/BC,EAAmBF,EAAQA,EAAMtc,YAAc,GAC/Cyc,EAAoBH,EAAQA,EAAMrc,aAAe,GACvD,IAAIyc,EAA6BC,EACjC,MAAMtd,EAAO,GACPud,EAAcJ,EAAmBC,EAAoB,SAAW,QACtE,GAAoB,WAAhBG,EAA0B,CAC5BD,EAAuBtd,EACvB,MAAMwd,EAAsBF,EAAuBF,EACnDC,EAAsBG,EAAsBL,C,KACvC,CACLE,EAAsBrd,EACtB,MAAMyd,EAAqBJ,EAAsBF,EACjDG,EAAuBG,EAAqBL,C,CAG9C,MAAMM,EAAsB,CAC1BxqB,MAAMyG,EAAAA,EAAAA,KACNxE,KAAM,YACN7B,EAAG,GAAM+pB,EAAsB,EAC/B7pB,EAAG,GAAM8pB,EAAuB,EAChCtgB,MAAOqgB,EACPpgB,OAAQqgB,EACRtI,SAAS,EACTxX,SAAU,IAEZ7E,EAAoBpK,OAAQ4K,EAAAA,EAAAA,IAAQR,EAAoBpK,OAAQ6K,IAC9DA,EAAMka,SAASnc,KAAKumB,EAAW,IAGjCzkB,IAEA8e,EAAc2F,EAAWxqB,KAC3B,CAEA,SAASyqB,IACP,MAAMV,EAAQ/V,SAASgW,cAAc,mBAC/BC,EAAmBF,EAAQA,EAAMtc,YAAc,GAC/Cyc,EAAoBH,EAAQA,EAAMrc,aAAe,GACvD,IAAIyc,EAA6BC,EACjC,MAAMtd,EAAO,GACPud,EAAcJ,EAAmBC,EAAoB,SAAW,QACtE,GAAoB,WAAhBG,EAA0B,CAC5BD,EAAuBtd,EACvB,MAAMwd,EAAsBF,EAAuBF,EACnDC,EAAsBG,EAAsBL,C,KACvC,CACLE,EAAsBrd,EACtB,MAAMyd,EAAqBJ,EAAsBF,EACjDG,EAAuBG,EAAqBL,C,CAG9C,MAAMM,EAAsB,CAC1BxqB,MAAMyG,EAAAA,EAAAA,KACNxE,KAAM,UACN7B,EAAG,GAAM+pB,EAAsB,EAC/B7pB,EAAG,GAAM8pB,EAAuB,EAChCtgB,MAAOqgB,EACPpgB,OAAQqgB,EACRtI,SAAS,EACTxX,SAAU,IAEZ7E,EAAoBpK,OAAQ4K,EAAAA,EAAAA,IAAQR,EAAoBpK,OAAQ6K,IAC9DA,EAAMka,SAASnc,KAAKumB,EAAW,IAGjCzkB,IAEA8e,EAAc2F,EAAWxqB,KAC3B,CAEA,SAAS0qB,IACPjlB,EAAoBpK,OAAQ4K,EAAAA,EAAAA,IAAQR,EAAoBpK,OAAQ6K,IAC9DA,EAAMka,SAAW,EAAE,IAGrBra,GACF,CAEA,SAAS4kB,IAEPllB,EAAoBpK,OAAQ4K,EAAAA,EAAAA,IAAQR,EAAoBpK,OAAQ6K,IAC9DA,EAAMmb,MAAQ,CACZpf,KAAM,QAERiE,EAAMka,SAAW,EAAE,IAGrBra,GACF,CAEA,SAASic,IACF1B,EAAkBjlB,MAMvBuvB,EAActK,EAAkBjlB,OAL9BgB,QAAQoS,MACN,mEAKN,CAEA,SAASmc,EAAchnB,GACrB6B,EAAoBpK,OAAQ4K,EAAAA,EAAAA,IAAQR,EAAoBpK,OAAQ6K,IAC9D,MAAMC,EAAQD,EAAMka,SAASha,WAAWia,GAAYA,EAAQrgB,OAAS4D,IACrE,IAAe,IAAXuC,EACF,MAAM,IAAI1J,MAAM,sBAAwBmH,EAAK,WAE/CsC,EAAMka,SAAS9Z,OAAOH,EAAO,EAAE,IAGjCJ,GACF,CAEA,SAASgc,EAAyBD,GAC3BxB,EAAkBjlB,OAOvBoK,EAAoBpK,OAAQ4K,EAAAA,EAAAA,IAAQR,EAAoBpK,OAAQ6K,IAC9D,MAAMma,EAAUna,EAAMka,SAAS1hB,MAC5B2hB,GAAYA,EAAQrgB,OAASsgB,EAAkBjlB,QAE9CglB,IACFA,EAAQyB,QAAUA,E,IAItB/b,KAfE1J,QAAQoS,MACN,mEAeN,CAEA,SAASwT,EAAmB3X,GAC1BjO,QAAQC,IAAI,qBAAsBgO,GAE7BgW,EAAkBjlB,OAOvBoK,EAAoBpK,OAAQ4K,EAAAA,EAAAA,IAAQR,EAAoBpK,OAAQ6K,IAC9D,MAAMma,EAAUna,EAAMka,SAAS1hB,MAC5B2hB,GAAYA,EAAQrgB,OAASsgB,EAAkBjlB,QAE9CglB,IACFA,EAAQ/V,SAAWA,E,IAIvBvE,EAAqB,yBAA2Bua,EAAkBjlB,QAfhEgB,QAAQoS,MACN,8DAeN,CAEA,SAASoW,EAAcjhB,GACrB0c,EAAkBjlB,MAAQuI,CAC5B,CAEA,SAASgjB,EACPxB,EACAD,EACAa,EACAO,GAEA9gB,EAAoBpK,OAAQ4K,EAAAA,EAAAA,IAAQR,EAAoBpK,OAAQ6K,IAC9D,MAAMma,EAAUna,EAAMka,SAAS1hB,MAAMwlB,GAAMA,EAAElkB,OAASmlB,IACtD,IAAK9E,EACH,MAAM,IAAI5jB,MAAM,mBAAmB0oB,eAErC9E,EAAQjgB,EAAI4lB,EACZ3F,EAAQ/f,EAAIimB,CAAS,IAGvBxgB,EAAqBqf,EACvB,CAEA,SAASgD,EACPhD,EACAD,EACAa,EACAO,EACAzc,EACAC,GAEAtE,EAAoBpK,OAAQ4K,EAAAA,EAAAA,IAAQR,EAAoBpK,OAAQ6K,IAC9D,MAAMma,EAAUna,EAAMka,SAAS1hB,MAAMwlB,GAAMA,EAAElkB,OAASmlB,IACtD,IAAK9E,EACH,MAAM,IAAI5jB,MAAM,mBAAmB0oB,eAErC9E,EAAQjgB,EAAI4lB,EACZ3F,EAAQ/f,EAAIimB,EACZlG,EAAQvW,MAAQA,EAChBuW,EAAQtW,OAASA,CAAM,IAGzBhE,EAAqBqf,EACvB,CDtJA,OC3KA5oB,EAAAA,EAAAA,KACE,IAAMuF,EAAM/F,iBACZ,CAACG,EAAmBmL,KAClB7B,EAAoBpK,OAAQqK,EAAAA,EAAAA,WAAUvJ,EAAkB,GAE1D,CAAEoL,MAAM,KAGV/K,EAAAA,EAAAA,IAAMgtB,GAA0B1jB,IAE9BqjB,EAAoB9tB,OAAQ,EAC5BguB,EAAYhuB,OAAQ,EACpBuuB,GAAsC,ID+JjC,CAACpoB,EAAUgG,MACRC,EAAAA,EAAAA,OAAcrG,EAAAA,EAAAA,IAAoBgC,EAAAA,GAAW,KAAM,EACzDF,EAAAA,EAAAA,IAAoB,MAAOD,GAAY,EACrCC,EAAAA,EAAAA,IAAoB,OAAQC,GAAY,EACtCD,EAAAA,EAAAA,IAAoB,WAAY,KAAM,EACpCA,EAAAA,EAAAA,IAAoB,SAAU,MAAM0E,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,sBAAuB,GACtD,UAAtC5C,EAAQjJ,eAAeqlB,MAAMpf,OACzBwF,EAAAA,EAAAA,OAAcrG,EAAAA,EAAAA,IAAoB,MAAO0C,GAAY,EACpDZ,EAAAA,EAAAA,IAAoB,MAAOgB,GAAY,EACrChB,EAAAA,EAAAA,IAAoB,SAAU,CAC5BO,QAASqmB,EACT7nB,KAAM,SACNX,MAAO,iBACPU,OAAO6F,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,oCACvBxD,GAAY,EAAGF,KAClBjB,EAAAA,EAAAA,IAAoB,SAAU,CAC5BO,QAASgnB,EACTxoB,KAAM,SACNX,MAAO,iBACPU,OAAO6F,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,8BACvBrD,GAAa,EAAGF,KACnBpB,EAAAA,EAAAA,IAAoB,SAAU,CAC5BO,QAASinB,EACTzoB,KAAM,SACNX,MAAO,mBACNsG,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,4BAA6B,IAClE3E,EAAAA,EAAAA,IAAoB,SAAU,CAC5BO,QAASknB,EACT1oB,KAAM,SACNX,MAAO,mBACNsG,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,iBAAkB,MAEzDC,EAAAA,EAAAA,IAAa+iB,GAAmB,CAC9B7Z,QAAS,uBACTxL,IAAK+jB,EACLnJ,SAAUnb,EAAQjJ,eAAeokB,SACjCiB,MAAOpc,EAAQjJ,eAAeqlB,OAC7B,KAAM,EAAG,CAAC,WAAY,eAE1B5Z,EAAAA,EAAAA,OAAcrG,EAAAA,EAAAA,IAAoB,QAASqD,GAAa,EACvDmE,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,yBAA2B,IAAK,IACnFC,EAAAA,EAAAA,IAAagjB,GAAY,CACvBC,eAAgBlB,EAChBxM,OAAQ,kBAIlBna,EAAAA,EAAAA,IAAoB,WAAYwB,GAAa,EAC3CxB,EAAAA,EAAAA,IAAoB,SAAU,MAAM0E,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,kBAAmB,IACxFA,EAAAA,EAAAA,IAAO2hB,KACH/hB,EAAAA,EAAAA,OAAcrG,EAAAA,EAAAA,IAAoBgC,EAAAA,GAAW,CAAEI,IAAK,GAAK,EACxDN,EAAAA,EAAAA,IAAoB,QAASmO,GAAa,EACxCnO,EAAAA,EAAAA,IAAoB,OAAQyR,GAAa,EACvCpM,EAAAA,EAAAA,KAAgBrF,EAAAA,EAAAA,IAAoB,QAAS,CAC3C,sBAAuBsE,EAAO,KAAOA,EAAO,GAAM9D,GAAkBylB,EAAqB9tB,MAAQqI,GACjGmF,SAAU+gB,EACV3nB,KAAM,YACL,KAAM,KAAM,CACb,CAACiH,EAAAA,GAAiBigB,EAAoB9tB,UAExCuN,EAAAA,EAAAA,IAAiB,KAAMhB,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,gDAAkD,IAAK,IAChHU,EAAAA,EAAAA,KAAgBrF,EAAAA,EAAAA,IAAoB,QAAS,CAC3C,sBAAuBsE,EAAO,KAAOA,EAAO,GAAM9D,GAAkB0lB,EAAgB/tB,MAAQqI,GAC5FiB,MAAO,CAAC,gBAAgB,SAAS,MAAQ,MAAM,QAAU,qBACzD0N,UAAW8W,EAAoB9tB,MAC/BiG,OAAOC,EAAAA,EAAAA,IAAgB,CAAE,oBAAqB4nB,EAAoB9tB,QAClEwN,SAAU+gB,EACV3nB,KAAM,SACN8G,IAAK,EACLC,KAAKnB,EAAAA,EAAAA,IAAO2hB,IACX,KAAM,GAAI5U,IAAc,CACzB,CAAClM,EAAAA,GAAa0gB,EAAe/tB,cAInC6H,EAAAA,EAAAA,IAAoB,QAAS2R,GAAa,EACxC3R,EAAAA,EAAAA,IAAoB,OAAQ4R,GAAa,EACvCvM,EAAAA,EAAAA,KAAgBrF,EAAAA,EAAAA,IAAoB,QAAS,CAC3C,sBAAuBsE,EAAO,KAAOA,EAAO,GAAM9D,GAAkB2lB,EAAahuB,MAAQqI,GACzFmF,SAAU8gB,EACV1nB,KAAM,YACL,KAAM,KAAM,CACb,CAACiH,EAAAA,GAAiBmgB,EAAYhuB,UAEhCuN,EAAAA,EAAAA,IAAiB,KAAMhB,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,4CAA8C,IAAK,IAC5GU,EAAAA,EAAAA,KAAgBrF,EAAAA,EAAAA,IAAoB,QAAS,CAC3C,sBAAuBsE,EAAO,KAAOA,EAAO,GAAM9D,GAAkB4lB,EAAejuB,MAAQqI,GAC3FiB,MAAO,CAAC,gBAAgB,SAAS,MAAQ,MAAM,QAAU,qBACzD0N,UAAWgX,EAAYhuB,MACvBiG,OAAOC,EAAAA,EAAAA,IAAgB,CAAE,oBAAqB8nB,EAAYhuB,QAC1DwN,SAAU8gB,EACV1nB,KAAM,SACN8G,IACJkE,KAAKjE,IACHvD,EAAoBpK,MAAM+tB,eACtB3jB,EAAoBpK,MAAM+tB,gBAC1BvhB,EAAAA,EAAAA,IAAO2hB,GACX,IAGG,KAAM,GAAIV,IAAc,CACzB,CAACpgB,EAAAA,GAAa4gB,EAAcjuB,cAIjC,OACFoM,EAAAA,EAAAA,OAAcrG,EAAAA,EAAAA,IAAoB,QAAS2nB,IAAanhB,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,wDAAyD,OAE1J3E,EAAAA,EAAAA,IAAoB,WAAY8lB,GAAa,EAC3C9lB,EAAAA,EAAAA,IAAoB,SAAU,MAAM0E,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,mBAAoB,IAC1F3E,EAAAA,EAAAA,IAAoB,QAAS,KAAM,EACjC0F,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,iCAAmC,IAAK,IAC3FU,EAAAA,EAAAA,KAAgBrF,EAAAA,EAAAA,IAAoB,QAAS,CAC3C,sBAAuBsE,EAAO,KAAOA,EAAO,GAAM9D,GAAkB+B,EAAoBpK,MAAM0F,QAAQE,YAAeyC,GACrH8E,QAAShB,EAAO,KAAOA,EAAO,GAAM9D,GAAiBqC,EAAqB,uCAC1E9D,KAAM,QACL,KAAM,KAAM,CACb,CAACyG,EAAAA,GAAajD,EAAoBpK,MAAM0F,QAAQE,oBAItDiC,EAAAA,EAAAA,IAAoB,WAAY+lB,GAAa,EAC3C/lB,EAAAA,EAAAA,IAAoB,SAAU,MAAM0E,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,aAAc,IACpF3E,EAAAA,EAAAA,IAAoB,QAAS,KAAM,EACjC0F,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAChC,iEACG,IAAK,IACVU,EAAAA,EAAAA,KAAgBrF,EAAAA,EAAAA,IAAoB,QAAS,CAC3C,sBAAuBsE,EAAO,KAAOA,EAAO,GAAM9D,GAAkB+B,EAAoBpK,MAAM0F,QAAQI,cAAiBuC,GACvH8E,QAAShB,EAAO,KAAOA,EAAO,GAAM9D,GACpCqC,EAAqB,yCAErB9D,KAAM,QACL,KAAM,KAAM,CACb,CAACyG,EAAAA,GAAajD,EAAoBpK,MAAM0F,QAAQI,oBAGpD+B,EAAAA,EAAAA,IAAoB,QAAS,KAAM,EACjC0F,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,yDAA2D,IAAK,IACnHU,EAAAA,EAAAA,KAAgBrF,EAAAA,EAAAA,IAAoB,QAAS,CAC3C,sBAAuBsE,EAAO,KAAOA,EAAO,GAAM9D,GAAkB+B,EAAoBpK,MAAM0F,QAAQiqB,+BAAkCtnB,GACxI8E,QAAShB,EAAO,KAAOA,EAAO,GAAM9D,GACpCqC,EACE,0DAGF9D,KAAM,QACL,KAAM,KAAM,CACb,CAACyG,EAAAA,GAAajD,EAAoBpK,MAAM0F,QAAQiqB,qCAGpD9nB,EAAAA,EAAAA,IAAoB,QAAS,KAAM,EACjC0F,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAChC,wEACG,IAAK,IACVU,EAAAA,EAAAA,KAAgBrF,EAAAA,EAAAA,IAAoB,QAAS,CAC3C,sBAAuBsE,EAAO,MAAQA,EAAO,IAAO9D,GACpD+B,EAAoBpK,MAAM0F,QAAQkqB,iCAChCvnB,GACF8E,QAAShB,EAAO,MAAQA,EAAO,IAAO9D,GACtCqC,EACE,4DAGF9D,KAAM,QACL,KAAM,KAAM,CACb,CAACyG,EAAAA,GACDjD,EAAoBpK,MAAM0F,QAAQkqB,6CAO3CpjB,EAAAA,EAAAA,IAAO1C,KACHsC,EAAAA,EAAAA,OAAcrG,EAAAA,EAAAA,IAAoB,MAAO8nB,IAAathB,EAAAA,EAAAA,IAAiB,CACxE4hB,yBAAyB3hB,EAAAA,EAAAA,IAAO2hB,GAChCL,oBAAqBA,EAAoB9tB,MACzC+tB,eAAgBA,EAAe/tB,MAC/BguB,YAAaA,EAAYhuB,MACzBiuB,cAAeA,EAAcjuB,MAC7BquB,uBAAuB7hB,EAAAA,EAAAA,IAAO6hB,GAC9BD,wBAAwB5hB,EAAAA,EAAAA,IAAO4hB,KAC7B,KACFrgB,EAAAA,EAAAA,IAAoB,IAAI,IAC3B,IAEL,IE1oBA,MAAM,IAA2B,OAAgB,GAAQ,CAAC,CAAC,YAAY,qBAEvE,UCLA,MACMnG,GAAa,CAAE3B,MAAO,eACtB6B,GAAa,CAAEwB,MAAO,CAAC,SAAW,aAClCb,GAAa,CAAExC,MAAO,iCACtB4C,GAAa,CAAE5C,MAAO,sBACtB6C,GAAa,CAAE7C,MAAO,iBACtB8C,GAAa,CAAE9C,MAAO,gBACtB+C,GAAa,CAAC,eAwBpB,QAA4BU,EAAAA,EAAAA,IAAiB,CAC3ChD,MAAO,CACP8J,KAAM,CACJ5J,KAAMzE,OACN2E,UAAU,IAGZ8Q,MAAO,CAAC,iBACRjO,KAAAA,CAAMC,GAER,MAAMlD,EAAQkD,GCuBdlB,EAAAA,EAAAA,IAAQggB,GAAkC,CACxCmB,eACAD,qBAGFzoB,EAAAA,EAAAA,KACE,IAAMuF,EAAM8J,OACZ,KACEqf,GAAkB,GAEpB,CAAE3jB,MAAM,IAcV,MAAM4jB,GAAe3lB,EAAAA,EAAAA,IAAa,IAC5BoS,GAASpS,EAAAA,EAAAA,IAAY,GACrB4lB,GAAS5lB,EAAAA,EAAAA,IAAY,GACrB6lB,GAAkB7lB,EAAAA,EAAAA,IAAc,IAGhC6Q,GAAcvT,EAAAA,EAAAA,KAAS,IAAMsoB,EAAO/vB,MAAQ,IAE5CgP,GAAYvH,EAAAA,EAAAA,KAAS,IACrBf,EAAM8J,MAAMud,eAAiB,EACxBrnB,EAAM8J,MAAMud,eAEZrnB,EAAM8J,KAAKuU,SAAShY,QAAQiY,GAAYA,EAAQyB,UAAS/U,SAI9DuI,GAAWxS,EAAAA,EAAAA,KAAS,IACxBf,EAAM8J,KAAKyd,cAAgB,EACvB1R,EAAOvc,MAAQgP,EAAUhP,OAAS+vB,EAAO/vB,MAAQ0G,EAAM8J,MAAMyd,cAC7D1R,EAAOvc,MAAQgP,EAAUhP,QAGzB8F,GAAgB2B,EAAAA,EAAAA,KAAS,KAC7B,IAAIwK,EAASvL,EAAM8J,KAAK9K,QAAQI,cAAcwB,QAC5C,WACAiV,EAAOvc,MAAMC,YAIf,OAFAgS,EAASA,EAAO3K,QAAQ,SAAU0H,EAAUhP,MAAMC,YAE3CgS,CAAM,IAGThD,GAAWxH,EAAAA,EAAAA,KAAS,IAEjBqoB,EAAa9vB,MAAMiwB,IAAI,IAAIhhB,WAG9BoM,GAAkB5T,EAAAA,EAAAA,KAAS,KACvBwS,EAASja,QAInB,SAAS6vB,IACPtT,EAAOvc,MAAQ,EACf+vB,EAAO/vB,MAAQ,EACfgwB,EAAgBhwB,MAAQ,GACxB8vB,EAAa9vB,MAAQ,EACvB,CAEA,SAAS6pB,EAAathB,EAAwBxD,EAAWE,GACvD,IAAKgV,EAASja,MAAO,OAGrB,GADAgB,QAAQC,IAAI,kCAAmCsH,IAC1CA,EAEH,YADAvH,QAAQoS,MAAM,8BAIhB,MAAM4R,EAAUte,EAAM8J,KAAKuU,SAAS1hB,MAAM2hB,GAAYA,EAAQrgB,OAAS4D,IACvE,GAAKyc,EAKL,GAAIgL,EAAgBhwB,MAAM0U,SAASnM,IAAOyc,EAAQyB,QAAS,CACzD,MAAM3b,EAAQglB,EAAa9vB,MAAM+K,WAAWmlB,GAAUA,EAAMlL,UAAYzc,IACxE,IAAe,IAAXuC,EAAc,CAChB,MAAMolB,EAAQJ,EAAa9vB,MAAM8K,GACjColB,EAAMnrB,EAAIA,EACVmrB,EAAMjrB,EAAIA,EACVirB,EAAMjhB,SAAWvI,EAAM8J,KAAK9K,QAAQkqB,iCACpCE,EAAa9vB,MAAMiL,OAAOH,EAAO,GACjCglB,EAAa9vB,MAAM4I,KAAKsnB,E,MAErB,CACLF,EAAgBhwB,OAAO4I,KAAKL,GAC5BwnB,EAAO/vB,QAEHglB,EAAQyB,SACVlK,EAAOvc,QAGT,MAAMkwB,EAAQ,CACZnrB,EAAGA,EACHE,EAAGA,EACH+f,QAASzc,EACTke,QAASzB,EAAQyB,QACjBxX,SAAU+V,EAAQ/V,UAEpB6gB,EAAa9vB,MAAM4I,KAAKsnB,E,MA7BxBlvB,QAAQoS,MAAM,2BAA4B7K,EA+B9C,CAEA,SAASqhB,EAAgB7kB,EAAWE,GAClC,IAAKgV,EAASja,MAAO,OACrBgB,QAAQC,IAAI,8BACZ8uB,EAAO/vB,QAEP,MAAMkwB,EAAQ,CACZnrB,EAAGA,EACHE,EAAGA,EACH+f,QAAS,GACTyB,SAAS,EACTxX,SAAUvI,EAAM8J,MAAM9K,QAAQiqB,gCAEhCG,EAAa9vB,MAAM4I,KAAKsnB,EAC1B,CAEA,SAAS3d,IACPsd,GACF,CD1BA,MAAO,CAAC1pB,EAAUgG,MACRC,EAAAA,EAAAA,OAAcrG,EAAAA,EAAAA,IAAoB,MAAO6B,GAAY,EAC3DC,EAAAA,EAAAA,IAAoB,MAAOC,GAAY,EACrC2E,EAAAA,EAAAA,IAAa+iB,GAAmB,CAC9BzK,SAAUnb,EAAQ4G,KAAKuU,SACvBiB,MAAOpc,EAAQ4G,KAAKwV,OACnB,KAAM,EAAG,CAAC,WAAY,YACxB5Z,EAAAA,EAAAA,KAAW,IAAOrG,EAAAA,EAAAA,IAAoBgC,EAAAA,GAAW,MAAMC,EAAAA,EAAAA,IAAY8nB,EAAa9vB,OAAO,CAACkwB,EAAOplB,MACtFsB,EAAAA,EAAAA,OAAcrG,EAAAA,EAAAA,IAAoB,OAAQ,CAChDoC,IAAK,GAAG+nB,EAAMnrB,KAAKmrB,EAAMjrB,IACzBgB,OAAOC,EAAAA,EAAAA,IAAgB,CAAC,kBAAmB,CAC3CiqB,MAAOrlB,IAAUglB,EAAa9vB,MAAM0R,OAAS,EAC7C+U,QAASyJ,EAAMzJ,QACf2J,WAAYF,EAAMzJ,WAElBnd,OAAOsM,EAAAA,EAAAA,IAAgB,CACvBN,KAAS4a,EAAMnrB,EAAI,GAAb,KACNyQ,IAAQ0a,EAAMjrB,EAAI,GAAb,SAEJsH,EAAAA,EAAAA,IAAiB2jB,EAAMzJ,QAAU,IAAM,KAAM,MAC9C,SAEN5e,EAAAA,EAAAA,IAAoB,MAAOY,GAAY,EACrCZ,EAAAA,EAAAA,IAAoB,MAAOgB,GAAY,EACpC2D,EAAAA,EAAAA,IAAOwO,KACH5O,EAAAA,EAAAA,OAAc0B,EAAAA,EAAAA,IAAaiI,GAAiB,CAC3C5N,IAAK,EACL2G,eAAgByN,EAAOvc,MACvBgP,WAAWxC,EAAAA,EAAAA,IAAOwC,GAClB,kBAAkBxC,EAAAA,EAAAA,IAAO1G,IACxB,KAAM,EAAG,CAAC,iBAAkB,YAAa,qBAC5CiI,EAAAA,EAAAA,IAAoB,IAAI,IAC5BlG,EAAAA,EAAAA,IAAoB,MAAOiB,IAAYyD,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOyC,IAAY,MAE7EpH,EAAAA,EAAAA,IAAoB,MAAOkB,GAAY,EACpCyD,EAAAA,EAAAA,IAAO6O,KACHjP,EAAAA,EAAAA,OAAcrG,EAAAA,EAAAA,IAAoB,SAAU,CAC3CoC,IAAK,EACLyG,aAAarC,EAAAA,EAAAA,IAAiB3C,EAAQ4G,KAAK9K,QAAQE,aACnDwC,QAASmK,EACT3L,KAAM,SACNX,MAAO,iBACN,KAAM,EAAG+C,MACZ+E,EAAAA,EAAAA,IAAoB,IAAI,SAKpC,IEzNA,MAAM,IAA2B,OAAgB,GAAQ,CAAC,CAAC,YAAY,qBAEvE,UCLA,MAAMnG,GAAa,CAAE3B,MAAO,eACtB6B,GAAa,CAAC,eACdW,GAAa,CAAC,eACdI,GAAa,CAAE5C,MAAO,yBACtB6C,GAAa,CAAE7C,MAAO,yBACtB8C,GAAa,CAAE9C,MAAO,yBAa5B,QAA4ByD,EAAAA,EAAAA,IAAiB,CAC3ChD,MAAO,CACP/F,eAAgB,CACdiG,KAAMzE,OACN2E,UAAU,IAGZ6C,KAAAA,CAAMC,GAER,MAAMlD,EAAQkD,ECwLRC,GAAapD,EAAAA,EAAAA,IAAwBnI,EAAAA,GAYrC8L,GAHQlH,OAAOC,OAAO6G,gBAAgBC,kBAGhBE,EAAAA,EAAAA,KAC1BE,EAAAA,EAAAA,WAAU3D,EAAM/F,kBAEZ0vB,GAAoBlmB,EAAAA,EAAAA,IAAY,IAChCmmB,GAAYnmB,EAAAA,EAAAA,IAAYC,EAAoBpK,MAAMsF,OAClDirB,GAAiBpmB,EAAAA,EAAAA,IAAYC,EAAoBpK,MAAMsF,OACvDkrB,GAAsBrmB,EAAAA,EAAAA,IAAY,IAElC7E,GAAQmC,EAAAA,EAAAA,KAAS,IACjBf,EAAM/F,gBAAgB2E,MACjBoB,EAAM/F,eAAe2E,MACzBhE,MAAM,KACNyL,QAAQ/B,GAASA,EAAK6S,SACtB5N,KAAKjF,GAASA,EAAK6S,OAAO3K,gBAExB,KAWT,SAASud,IACPJ,EAAkBrwB,MAAQ,GAC1BwwB,EAAoBxwB,MAAQ,EAC9B,CAEA,SAAS0wB,EAAaprB,GACpB,IAAIqrB,EAAYrrB,EACbhE,MAAM,KACNyL,QAAQ/B,GAASA,EAAK6S,SACtB5N,KAAKjF,GAASA,EAAK6S,OAAO3K,gBAEzB0d,EAAc,EAClB,IAAK,MAAM5lB,KAAQ2lB,EACb3lB,EAAK0G,OAASkf,IAChBA,EAAc5lB,EAAK0G,QAIvB,MAAMmf,EAAcD,EAAc,GAC5BE,EAAeH,EAAUjf,OAAS,GAExC,OAAImf,GACFR,EAAkBrwB,OAAQ+C,EAAAA,EAAAA,IACxB,wDAEFutB,EAAUtwB,MAAQuwB,EAAevwB,QAExB8wB,GACTT,EAAkBrwB,OAAQ+C,EAAAA,EAAAA,IACxB,uDAEFutB,EAAUtwB,MAAQuwB,EAAevwB,SAGjCqwB,EAAkBrwB,MAAQ,GAC1BuwB,EAAevwB,MAAQsF,EAGzB8E,EAAoBpK,OAAQ4K,EAAAA,EAAAA,IAAQR,EAAoBpK,OAAQ6K,IAC9DA,EAAMvF,MAAQA,CAAK,IAGjBsrB,EAAcxmB,EAAoBpK,MAAMyR,OAC1C+e,EAAoBxwB,MAAQ,GAC5BoK,EAAoBpK,OAAQ4K,EAAAA,EAAAA,IAAQR,EAAoBpK,OAAQ6K,IAC9DA,EAAM4G,KAAOmf,CAAW,KAK5B5vB,QAAQC,IAAI,+BACZ4I,EAAYhJ,YAAY,CACtBC,mBAAmBuJ,EAAAA,EAAAA,WAAUD,EAAoBpK,SAErD,CAEA,SAAS+wB,EAAYtf,GACnB,IAAImf,EAAc,EAElB,IAAK,MAAM5lB,KAAQ1F,EAAMtF,MACvBgB,QAAQC,IAAI+J,EAAMA,EAAK0G,QACnB1G,EAAK0G,OAASkf,IAChBA,EAAc5lB,EAAK0G,QAIvB,IAAIsf,EAAMjiB,OAAO0C,GACbuf,EAAM,KACRhwB,QAAQC,IAAI+vB,GACZA,EAAM,IAEJA,EAAMJ,GACRI,EAAMJ,EACNJ,EAAoBxwB,OAAQ+C,EAAAA,EAAAA,IAC1B,4EACA,CAAEkuB,WAAYD,EAAI/wB,cAGpBuwB,EAAoBxwB,MAAQ,GAG9BoK,EAAoBpK,OAAQ4K,EAAAA,EAAAA,IAAQR,EAAoBpK,OAAQ6K,IAC9DA,EAAM4G,KAAOuf,CAAG,IAGlBtmB,EAAqB,OACvB,CAEA,SAASwmB,EAAgBC,GACvB/mB,EAAoBpK,OAAQ4K,EAAAA,EAAAA,IAAQR,EAAoBpK,OAAQ6K,IAC9DA,EAAMsmB,SAAWA,CAAQ,IAG3BzmB,EAAqB,WACvB,CAEA,SAAS0mB,IACPhnB,EAAoBpK,OAAQ4K,EAAAA,EAAAA,IAAQR,EAAoBpK,OAAQ6K,IAC9DA,EAAMsmB,SAAW,4BAA4B,IAG/CzmB,GACF,CAEA,SAAS2mB,IACPjnB,EAAoBpK,OAAQ4K,EAAAA,EAAAA,IAAQR,EAAoBpK,OAAQ6K,IAC9DA,EAAMsmB,SAAW1e,MAAMC,KACrB,IAAI4e,IAAIzmB,EAAMvF,MAAM+B,cAAcC,QAAQ,SAAU,IAAIhG,MAAM,MAC9DpB,KAAK,GAAG,IAGZwK,GACF,CAEA,SAASA,EAAqB3J,GAE5BC,QAAQC,IAAI,0BACZ4I,EAAYhJ,YAAY,CACtBC,mBAAmBuJ,EAAAA,EAAAA,WAAUD,EAAoBpK,OACjDe,UAAWA,GAAa,CAAC,GAE7B,CDzLA,OCwDAI,EAAAA,EAAAA,KACE,IAAMuF,EAAM/F,iBACZ,CAACG,EAAmBmL,KAClB7B,EAAoBpK,OAAQqK,EAAAA,EAAAA,WAAUvJ,EAAkB,GAE1D,CAAEoL,MAAM,ID7DH,CAAC/F,EAAUgG,MACRC,EAAAA,EAAAA,OAAcrG,EAAAA,EAAAA,IAAoB,MAAO6B,GAAY,EAC3DC,EAAAA,EAAAA,IAAoB,OAAQ,CAC1B5B,MAAO,UACPoG,SAAUF,EAAO,MAAQA,EAAO,KAAMG,EAAAA,EAAAA,KAAe,QAAU,CAAC,cAC/D,EACDzE,EAAAA,EAAAA,IAAoB,WAAY,KAAM,EACpCA,EAAAA,EAAAA,IAAoB,SAAU,MAAM0E,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,mBAAoB,IAC1F3E,EAAAA,EAAAA,IAAoB,QAAS,KAAM,EACjC0F,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,wBAA0B,IAAK,IAClFU,EAAAA,EAAAA,KAAgBrF,EAAAA,EAAAA,IAAoB,QAAS,CAC3C,sBAAuBsE,EAAO,KAAOA,EAAO,GAAM9D,GAAkBioB,EAAWtwB,MAAQqI,GACvF8E,QAAShB,EAAO,KAAOA,EAAO,GAAM9D,GAAiBqoB,EAAaroB,EAAOwD,OAAO7L,QAChF4G,KAAM,QACL,KAAM,KAAM,CACb,CAACyG,EAAAA,GAAaijB,EAAUtwB,UAE1B6H,EAAAA,EAAAA,IAAoB,IAAK,CACvB+G,aAAarC,EAAAA,EAAAA,IAAiB8jB,EAAkBrwB,QAC/C,KAAM,EAAG8H,OAEdD,EAAAA,EAAAA,IAAoB,QAAS,KAAM,EACjC0F,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,eAAiB,IAAK,IACzEU,EAAAA,EAAAA,KAAgBrF,EAAAA,EAAAA,IAAoB,QAAS,CAC3C,sBAAuBsE,EAAO,KAAOA,EAAO,GAAM9D,GAAkB+B,EAAoBpK,MAAMyR,KAAQpJ,GACtGmF,SAAUrB,EAAO,KAAOA,EAAO,GAAM9D,GAAiB0oB,EAAY1oB,EAAOwD,OAAO7L,QAChFgf,OAAQ7S,EAAO,KAAOA,EAAO,GAAM9D,GAAiBooB,KACpD/iB,IAAK,IACLC,IAAK,KACL/G,KAAM,UACL,KAAM,KAAM,CACb,CAACyG,EAAAA,GAAajD,EAAoBpK,MAAMyR,SAE1C5J,EAAAA,EAAAA,IAAoB,IAAK,CACvB+G,aAAarC,EAAAA,EAAAA,IAAiBikB,EAAoBxwB,QACjD,KAAM,EAAGyI,OAEdZ,EAAAA,EAAAA,IAAoB,QAAS,KAAM,EACjC0F,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,kDAAoD,IAAK,IAC5GU,EAAAA,EAAAA,KAAgBrF,EAAAA,EAAAA,IAAoB,QAAS,CAC3C,sBAAuBsE,EAAO,KAAOA,EAAO,GAAM9D,GAAkB+B,EAAoBpK,MAAMmxB,SAAY9oB,GAC1G8E,QAAShB,EAAO,KAAOA,EAAO,GAAM9D,GAAiB6oB,EAAgB7oB,EAAOwD,OAAO7L,QACnF4G,KAAM,QACL,KAAM,KAAM,CACb,CAACyG,EAAAA,GAAajD,EAAoBpK,MAAMmxB,aAE1CtpB,EAAAA,EAAAA,IAAoB,SAAU,CAC5BjB,KAAM,SACNX,MAAO,SACPqD,MAAO,CAAC,cAAc,UACtBlB,QAASgpB,IACR7kB,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,2BAA4B,IACjE3E,EAAAA,EAAAA,IAAoB,SAAU,CAC5BjB,KAAM,SACNX,MAAO,SACPqD,MAAO,CAAC,cAAc,UACtBlB,QAASipB,IACR9kB,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,iCAAkC,QAG3E3E,EAAAA,EAAAA,IAAoB,WAAYgB,GAAY,EAC1ChB,EAAAA,EAAAA,IAAoB,SAAU,MAAM0E,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,kBAAmB,IACzF3E,EAAAA,EAAAA,IAAoB,QAAS,KAAM,EACjCqF,EAAAA,EAAAA,KAAgBrF,EAAAA,EAAAA,IAAoB,QAAS,CAC3C,sBAAuBsE,EAAO,KAAOA,EAAO,GAAM9D,GAAkB+B,EAAoBpK,MAAMuxB,aAAgBlpB,GAC9GmF,SAAU9C,EACV9D,KAAM,YACL,KAAM,KAAM,CACb,CAACiH,EAAAA,GAAiBzD,EAAoBpK,MAAMuxB,iBAE9ChkB,EAAAA,EAAAA,IAAiB,KAAMhB,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,uBAAwB,MAEnF3E,EAAAA,EAAAA,IAAoB,WAAY,KAAM,EACpCA,EAAAA,EAAAA,IAAoB,SAAU,MAAM0E,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,mBAAoB,IAC1F3E,EAAAA,EAAAA,IAAoB,QAAS,KAAM,EACjCqF,EAAAA,EAAAA,KAAgBrF,EAAAA,EAAAA,IAAoB,QAAS,CAC3C,sBAAuBsE,EAAO,KAAOA,EAAO,GAAM9D,GAAkB+B,EAAoBpK,MAAMwxB,WAAW3uB,EAAKwF,GAC9GmF,SAAU9C,EACV9D,KAAM,YACL,KAAM,KAAM,CACb,CAACiH,EAAAA,GAAiBzD,EAAoBpK,MAAMwxB,WAAW3uB,MAEzD0K,EAAAA,EAAAA,IAAiB,KAAMhB,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,2BAA4B,MAEvF3E,EAAAA,EAAAA,IAAoB,QAAS,KAAM,EACjCqF,EAAAA,EAAAA,KAAgBrF,EAAAA,EAAAA,IAAoB,QAAS,CAC3C,sBAAuBsE,EAAO,KAAOA,EAAO,GAAM9D,GAAkB+B,EAAoBpK,MAAMwxB,WAAWC,EAAKppB,GAC9GmF,SAAU9C,EACV9D,KAAM,YACL,KAAM,KAAM,CACb,CAACiH,EAAAA,GAAiBzD,EAAoBpK,MAAMwxB,WAAWC,MAEzDlkB,EAAAA,EAAAA,IAAiB,KAAMhB,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,0BAA2B,MAEtF3E,EAAAA,EAAAA,IAAoB,QAAS,KAAM,EACjCqF,EAAAA,EAAAA,KAAgBrF,EAAAA,EAAAA,IAAoB,QAAS,CAC3C,sBAAuBsE,EAAO,MAAQA,EAAO,IAAO9D,GAAkB+B,EAAoBpK,MAAMwxB,WAAWE,EAAKrpB,GAChHmF,SAAU9C,EACV9D,KAAM,YACL,KAAM,KAAM,CACb,CAACiH,EAAAA,GAAiBzD,EAAoBpK,MAAMwxB,WAAWE,MAEzDnkB,EAAAA,EAAAA,IAAiB,KAAMhB,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,wBAAyB,MAEpF3E,EAAAA,EAAAA,IAAoB,QAAS,KAAM,EACjCqF,EAAAA,EAAAA,KAAgBrF,EAAAA,EAAAA,IAAoB,QAAS,CAC3C,sBAAuBsE,EAAO,MAAQA,EAAO,IAAO9D,GAAkB+B,EAAoBpK,MAAMwxB,WAAW7M,EAAKtc,GAChHmF,SAAU9C,EACV9D,KAAM,YACL,KAAM,KAAM,CACb,CAACiH,EAAAA,GAAiBzD,EAAoBpK,MAAMwxB,WAAW7M,MAEzDpX,EAAAA,EAAAA,IAAiB,KAAMhB,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,uBAAwB,MAEnF3E,EAAAA,EAAAA,IAAoB,QAAS,KAAM,EACjCqF,EAAAA,EAAAA,KAAgBrF,EAAAA,EAAAA,IAAoB,QAAS,CAC3C,sBAAuBsE,EAAO,MAAQA,EAAO,IAAO9D,GAAkB+B,EAAoBpK,MAAMwxB,WAAWG,GAAMtpB,GACjHmF,SAAU9C,EACV9D,KAAM,YACL,KAAM,KAAM,CACb,CAACiH,EAAAA,GAAiBzD,EAAoBpK,MAAMwxB,WAAWG,OAEzDpkB,EAAAA,EAAAA,IAAiB,KAAMhB,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,8BAA+B,MAE1F3E,EAAAA,EAAAA,IAAoB,QAAS,KAAM,EACjCqF,EAAAA,EAAAA,KAAgBrF,EAAAA,EAAAA,IAAoB,QAAS,CAC3C,sBAAuBsE,EAAO,MAAQA,EAAO,IAAO9D,GAAkB+B,EAAoBpK,MAAMwxB,WAAWI,GAAMvpB,GACjHmF,SAAU9C,EACV9D,KAAM,YACL,KAAM,KAAM,CACb,CAACiH,EAAAA,GAAiBzD,EAAoBpK,MAAMwxB,WAAWI,OAEzDrkB,EAAAA,EAAAA,IAAiB,KAAMhB,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,+BAAgC,MAE3F3E,EAAAA,EAAAA,IAAoB,QAAS,KAAM,EACjCqF,EAAAA,EAAAA,KAAgBrF,EAAAA,EAAAA,IAAoB,QAAS,CAC3C,sBAAuBsE,EAAO,MAAQA,EAAO,IAAO9D,GAAkB+B,EAAoBpK,MAAMwxB,WAAWK,GAAMxpB,GACjHmF,SAAU9C,EACV9D,KAAM,YACL,KAAM,KAAM,CACb,CAACiH,EAAAA,GAAiBzD,EAAoBpK,MAAMwxB,WAAWK,OAEzDtkB,EAAAA,EAAAA,IAAiB,KAAMhB,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,6BAA8B,MAEzF3E,EAAAA,EAAAA,IAAoB,QAAS,KAAM,EACjCqF,EAAAA,EAAAA,KAAgBrF,EAAAA,EAAAA,IAAoB,QAAS,CAC3C,sBAAuBsE,EAAO,MAAQA,EAAO,IAAO9D,GAAkB+B,EAAoBpK,MAAMwxB,WAAWM,GAAMzpB,GACjHmF,SAAU9C,EACV9D,KAAM,YACL,KAAM,KAAM,CACb,CAACiH,EAAAA,GAAiBzD,EAAoBpK,MAAMwxB,WAAWM,OAEzDvkB,EAAAA,EAAAA,IAAiB,KAAMhB,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,8BAA+B,UAI9F3E,EAAAA,EAAAA,IAAoB,WAAYiB,GAAY,EAC1CjB,EAAAA,EAAAA,IAAoB,SAAU,MAAM0E,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,mBAAoB,IAC1F3E,EAAAA,EAAAA,IAAoB,QAAS,KAAM,EACjC0F,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,yBAA2B,IAAK,IACnFU,EAAAA,EAAAA,KAAgBrF,EAAAA,EAAAA,IAAoB,QAAS,CAC3C,sBAAuBsE,EAAO,MAAQA,EAAO,IAAO9D,GAAkB+B,EAAoBpK,MAAM0F,QAAQqsB,cAAiB1pB,GACzH8E,QAAShB,EAAO,MAAQA,EAAO,IAAO9D,GACpCqC,EAAqB,yCAEvB9D,KAAM,QACL,KAAM,KAAM,CACb,CAACyG,EAAAA,GAAajD,EAAoBpK,MAAM0F,QAAQqsB,oBAGpDlqB,EAAAA,EAAAA,IAAoB,QAAS,KAAM,EACjC0F,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,gCAAkC,IAAK,IAC1FU,EAAAA,EAAAA,KAAgBrF,EAAAA,EAAAA,IAAoB,QAAS,CAC3C,sBAAuBsE,EAAO,MAAQA,EAAO,IAAO9D,GAAkB+B,EAAoBpK,MAAM0F,QAAQC,YAAe0C,GACvH8E,QAAShB,EAAO,MAAQA,EAAO,IAAO9D,GAAiBqC,EAAqB,uCAC5E9D,KAAM,QACL,KAAM,KAAM,CACb,CAACyG,EAAAA,GAAajD,EAAoBpK,MAAM0F,QAAQC,kBAGpDkC,EAAAA,EAAAA,IAAoB,QAAS,KAAM,EACjC0F,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,iCAAmC,IAAK,IAC3FU,EAAAA,EAAAA,KAAgBrF,EAAAA,EAAAA,IAAoB,QAAS,CAC3C,sBAAuBsE,EAAO,MAAQA,EAAO,IAAO9D,GAAkB+B,EAAoBpK,MAAM0F,QAAQE,YAAeyC,GACvH8E,QAAShB,EAAO,MAAQA,EAAO,IAAO9D,GAAiBqC,EAAqB,uCAC5E9D,KAAM,QACL,KAAM,KAAM,CACb,CAACyG,EAAAA,GAAajD,EAAoBpK,MAAM0F,QAAQE,kBAGpDiC,EAAAA,EAAAA,IAAoB,QAAS,KAAM,EACjC0F,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,0BAA4B,IAAK,IACpFU,EAAAA,EAAAA,KAAgBrF,EAAAA,EAAAA,IAAoB,QAAS,CAC3C,sBAAuBsE,EAAO,MAAQA,EAAO,IAAO9D,GAAkB+B,EAAoBpK,MAAM0F,QAAQssB,MAAS3pB,GACjH8E,QAAShB,EAAO,MAAQA,EAAO,IAAO9D,GAAiBqC,EAAqB,iCAC5E9D,KAAM,QACL,KAAM,KAAM,CACb,CAACyG,EAAAA,GAAajD,EAAoBpK,MAAM0F,QAAQssB,cAItDnqB,EAAAA,EAAAA,IAAoB,WAAYkB,GAAY,EAC1ClB,EAAAA,EAAAA,IAAoB,SAAU,MAAM0E,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,aAAc,IACpF3E,EAAAA,EAAAA,IAAoB,QAAS,KAAM,EACjC0F,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAC9B,iEACG,IAAK,IACZU,EAAAA,EAAAA,KAAgBrF,EAAAA,EAAAA,IAAoB,QAAS,CAC3CjB,KAAM,OACN,sBAAuBuF,EAAO,MAAQA,EAAO,IAAO9D,GAAkB+B,EAAoBpK,MAAM0F,QAAQI,cAAiBuC,GACzH8E,QAAShB,EAAO,MAAQA,EAAO,IAAO9D,GACpCqC,EAAqB,0CAEtB,KAAM,KAAM,CACb,CAAC2C,EAAAA,GAAajD,EAAoBpK,MAAM0F,QAAQI,sBAIrD,MAGP,IEtZA,MAAM,GAAc,GAEpB,UCFA,MAAM4e,GAAeC,KAAMC,EAAAA,EAAAA,IAAa,mBAAmBD,EAAEA,KAAIE,EAAAA,EAAAA,MAAcF,GACzE/c,GAAa,CAAE3B,MAAO,eACtB6B,GAAa,CAAE7B,MAAO,kCACtBwC,GAAa,CAAC,QAAS,UACvBI,GAAa,CACjBV,IAAK,EACLlC,MAAO,aAEH6C,GAAa,CAAC,eACdC,GAAa,CAAC,SACdC,GAAa,CAAE/C,MAAO,kBACtBgD,GAA2Byb,IAAa,KAAmB7c,EAAAA,EAAAA,IAAoB,OAAQ,KAAM,KAAM,KACnGqB,GAAa,CAAC,eACdC,GAAc,CAAC,eACfC,GAAc,CAAEnD,MAAO,iCACvBoD,GAAc,CAAEpD,MAAO,sBACvB+P,GAAc,CAAE/P,MAAO,gBACvBqT,GAAc,CAAC,eACfC,GAAc,CAAC,eACfC,GAAc,CAAC,eACfC,GAAc,CAAEtR,IAAK,GAqC3B,QAA4BuB,EAAAA,EAAAA,IAAiB,CAC3ChD,MAAO,CACP8J,KAAM,CACJ5J,KAAMzE,OACN2E,UAAU,IAGZ6C,KAAAA,CAAMC,GAER,MAAMlD,EAAQkD,ECgCRqoB,EAAatS,EAAQ,MAgCrBjP,GAAYvG,EAAAA,EAAAA,IAA8B,MAGhD,IAAI+nB,EAAmB,GACnBC,EAA6B,GAC7BC,EAA4B,GAC5BC,EAAkD,GACtD,MAAMC,GAAanoB,EAAAA,EAAAA,IAAc,IAC3Bkc,GAAYlc,EAAAA,EAAAA,MACZ2G,GAAgB3G,EAAAA,EAAAA,KAAa,GAC7B4G,GAAgB5G,EAAAA,EAAAA,KAAa,GAC7B6nB,GAAQ7nB,EAAAA,EAAAA,IAAY,GAC1B,IAAIooB,GAAwB,EACxBC,EAA+B,MAGnCthB,EAAAA,EAAAA,KAAU,KACRuhB,IACAphB,IACAsH,SAASxY,iBAAiB,cAAeuyB,GACzC/Z,SAASxY,iBAAiB,YAAawyB,EAAyB,KAGlErhB,EAAAA,EAAAA,KAAgB,KACdqH,SAASpH,oBAAoB,cAAemhB,GAC5C/Z,SAASpH,oBAAoB,YAAaohB,EAAyB,IAIrE,MAAMnhB,GAAW/J,EAAAA,EAAAA,KAAS,IACjBf,EAAM8J,MAAMiB,OAGfE,GAAWlK,EAAAA,EAAAA,KAAS,IACjB,KAGHwJ,GAAaxJ,EAAAA,EAAAA,KAAS,IACnB+J,EAASxR,MAAQ2R,EAAS3R,QAG7BsF,GAAQmC,EAAAA,EAAAA,KAAS,IACjBf,EAAM8J,MAAMlL,MACPoB,EAAM8J,KAAKlL,MACfhE,MAAM,KACNyL,QAAQ/B,GAASA,EAAK6S,SACtB5N,KAAKjF,GAASA,EAAK6S,OAAO3K,gBAExB,KAGH0f,GAAqBnrB,EAAAA,EAAAA,KAAS,KAClC,IAAIwK,EAAS,GAWb,OAVIvL,EAAM8J,MAAMghB,aACT9qB,EAAM8J,KAAKghB,WAAW7M,GAAG1S,EAAOrJ,KAAK,KACrClC,EAAM8J,KAAKghB,WAAWG,IAAI1f,EAAOrJ,KAAK,MACtClC,EAAM8J,KAAKghB,WAAW3uB,GAAGoP,EAAOrJ,KAAK,KACrClC,EAAM8J,KAAKghB,WAAWI,IAAI3f,EAAOrJ,KAAK,MACtClC,EAAM8J,KAAKghB,WAAWE,GAAGzf,EAAOrJ,KAAK,KACrClC,EAAM8J,KAAKghB,WAAWM,IAAI7f,EAAOrJ,KAAK,MACtClC,EAAM8J,KAAKghB,WAAWC,GAAGxf,EAAOrJ,KAAK,KACrClC,EAAM8J,KAAKghB,WAAWK,IAAI5f,EAAOrJ,KAAK,OAEtCqJ,CAAM,IAGTkf,GAAW1pB,EAAAA,EAAAA,KAAS,IACpBf,EAAM8J,MAAM2gB,SACPzqB,EAAM8J,KAAK2gB,SACfje,cACA5R,MAAM,IACNyL,QAAQ8lB,GAASA,EAAKte,MAAM,iBAE1B,KAGHvC,GAAQvK,EAAAA,EAAAA,KAAS,IACd6qB,EAAWtyB,MAAM0R,SAGpBK,GAAWtK,EAAAA,EAAAA,KAAS,IACjBnC,EAAMtF,MAAM0R,SAGfohB,GAAgBrrB,EAAAA,EAAAA,KAAS,IACtBuK,EAAMhS,QAAU+R,EAAS/R,OAAS8Q,EAAc9Q,QAGnD8F,GAAgB2B,EAAAA,EAAAA,KAAS,KAC7B,IAAIwK,EAASvL,EAAM8J,KAAK9K,QAAQI,cAAcwB,QAC5C,WACA0K,EAAMhS,MAAMC,YAId,OAFAgS,EAASA,EAAO3K,QAAQ,SAAUyK,EAAS/R,MAAMC,YAE1CgS,CAAM,IAGTC,GAAkBzK,EAAAA,EAAAA,KAAS,KACvBqrB,EAAc9yB,QAuBxB,SAAS+yB,IACPR,GAAe,EAGfC,EAAgBQ,aAAY,KAC1BhB,EAAMhyB,OAAO,GACZ,IACL,CAEA,SAASizB,IAEe,OAAlBT,IACFU,cAAcV,GACdA,EAAgB,MAGlBD,GAAe,CACjB,CAEA,SAASjgB,IACPxB,EAAc9Q,OAAQ,EACtBizB,GACF,CAEA,SAAS1gB,IACPzB,EAAc9Q,OAAQ,EACtB+Q,EAAc/Q,OAAQ,EACtBgyB,EAAMhyB,MAAQ,EACdqyB,EAAsB,GACtBY,IACAR,IACAphB,GACF,CAEA,SAASmB,IACPzB,EAAc/Q,OAAQ,EACtBqR,GACF,CAEA,SAAS8hB,IACP,GAAIhC,EAASnxB,MAAM0R,OAAS,EAAG,CAC7B,MAAM0hB,EAAcxhB,KAAKC,MAAMD,KAAKoM,SAAWmT,EAASnxB,MAAM0R,QAC9D,OAAOyf,EAASnxB,MAAMozB,E,CAExB,MAAO,EACT,CAEA,SAASC,IACPlB,EAAgB,GAChB,IAAK,IAAIptB,EAAI,EAAGA,EAAIyM,EAASxR,MAAO+E,IAAK,CACvCotB,EAAcptB,GAAK,GACnB,IAAK,IAAIE,EAAI,EAAGA,EAAIuM,EAASxR,MAAOiF,IAClCktB,EAAcptB,GAAGE,IAAK,C,CAG5B,CAEA,SAASquB,IACPlB,EAAe,GACf,IAAK,IAAIrtB,EAAI,EAAGA,EAAIyM,EAASxR,MAAO+E,IAAK,CACvCqtB,EAAartB,GAAK,GAClB,IAAK,IAAIE,EAAI,EAAGA,EAAIuM,EAASxR,MAAOiF,IAClCmtB,EAAartB,GAAGE,IAAK,C,CAG3B,CAEA,SAASwtB,IACPY,IACAC,IACAhB,EAAWtyB,MAAQ,GACnBqyB,EAAsB,GAGtB,MAAMtO,EAAU,CACdwP,KAAM/hB,EAASxR,MACfwzB,KAAMhiB,EAASxR,MACf4yB,mBAAoBA,EAAmB5yB,MACvCyzB,WAAYnuB,EAAMtF,MAClB0zB,SAAUpuB,EAAMtF,MAAM0R,OACtBiiB,qBAAsB,GACtBC,WAAW,EACXC,YAAY,GAGd,IAAIC,EAAK,IAAI7B,EAAWlO,GAGpBpb,EAAQ,EACZ,MAAOmrB,EAAGxuB,MAAMoM,SAAWpM,EAAMtF,MAAM0R,QAAU/I,GAAS,GACxD3H,QAAQC,IACN,uFACA0H,EAAQ,aAEVmrB,EAAK,IAAI7B,EAAWlO,GACpBpb,IAIFmrB,EAAGxuB,MAAMvG,SAASiM,IAChBqnB,EAAoBzpB,QAAQoC,EAAKjJ,KAAK,IAIxCmwB,EAAO,GACP,IAAK,IAAIntB,EAAI,EAAGA,EAAIyM,EAASxR,MAAO+E,IAAK,CACvCmtB,EAAKntB,GAAK,GACV,IAAK,IAAIE,EAAI,EAAGA,EAAIuM,EAASxR,MAAOiF,IAC9BotB,EAAoBhe,MAAM0f,GAAUA,EAAMhvB,IAAMA,GAAKgvB,EAAM9uB,IAAMA,IACnEitB,EAAKntB,GAAGE,GAAK6uB,EAAG5B,KAAKjtB,GAAGF,GAExBmtB,EAAKntB,GAAGE,GAAKkuB,G,CAIrB,CAEA,SAAS9hB,IACP,MAAM8B,EAASzC,EAAU1Q,MACzB,IAAKmT,EAEH,YADAnS,QAAQoS,MAAM,aAGhB,MAAMC,EAAMF,EAAOG,WAAW,MAC9B,GAAID,EAAK,CACPA,EAAIE,UAAU,EAAG,EAAGJ,EAAO1E,MAAO0E,EAAOzE,QACzC2E,EAAIQ,KAAO,oBACXR,EAAIS,UAAY,SAChBT,EAAIU,aAAe,SACnB,IAAK,IAAIhP,EAAI,EAAGA,EAAIyM,EAASxR,MAAO+E,IAClC,IAAK,IAAIE,EAAI,EAAGA,EAAIuM,EAASxR,MAAOiF,IAC9BmtB,EAAartB,GAAGE,IAClBuO,EAASzO,EAAGE,EAAG,YAEZ8L,EAAc/Q,OAASmyB,EAAcptB,GAAGE,IAC3CuO,EAASzO,EAAGE,EAAG,6BAGf8L,EAAc/Q,OACdqyB,EAAoBhe,MAAM0f,GAAUA,EAAMhvB,IAAMA,GAAKgvB,EAAM9uB,IAAMA,MAChEmtB,EAAartB,GAAGE,IAEjBuO,EAASzO,EAAGE,EAAG,6BAEjBoO,EAAII,YAAc,YAClBJ,EAAIK,WACF3O,EAAI4M,EAAS3R,MACbiF,EAAI0M,EAAS3R,MACb2R,EAAS3R,MACT2R,EAAS3R,OAEXqT,EAAIM,UAAY,UAChBN,EAAIW,SACFke,EAAKntB,GAAGE,GACRF,EAAI4M,EAAS3R,MAAQ2R,EAAS3R,MAAQ,EACtCiF,EAAI0M,EAAS3R,MAAQ2R,EAAS3R,MAAQ,E,CAKhD,CAEA,SAASg0B,EAAoBroB,GAC3B,IAAImnB,EAAc9yB,MAOlB,GALKuyB,IACHvxB,QAAQC,IAAI,kBACZ8xB,KAGG1M,EAAUrmB,MAiBbi0B,QAjBoB,CAEpB,MAAM,MAAExe,EAAK,MAAEC,GAAUwe,EAAmBvoB,GAE5C0a,EAAUrmB,MAAQ,CAChB+pB,QAAQ3e,EAAAA,EAAAA,KACR+oB,UAAW,CAAC1e,EAAOC,GACnB0e,YAAa,CAAC3e,EAAOC,GACrBxQ,eAAWxC,GAGb2wB,IACAlB,EAAc1c,GAAOC,IAAS,EAC9BrE,G,CAMJ,CAEA,SAAS6iB,EAAmBvoB,GAC1B,MAAMwH,EAASwF,SAASsQ,eAAe,KACjC9T,EAAOhC,EAAOiC,wBACdrQ,EAAI4G,EAAM0J,QAAUF,EAAKG,KACzBrQ,EAAI0G,EAAM4J,QAAUJ,EAAKK,IACzBC,EAAQ7D,KAAKjE,IACjB,EACAiE,KAAKlE,IAAIkE,KAAKC,MAAM9M,EAAI4M,EAAS3R,OAAQwR,EAASxR,MAAQ,IAEtD0V,EAAQ9D,KAAKjE,IACjB,EACAiE,KAAKlE,IAAIkE,KAAKC,MAAM5M,EAAI0M,EAAS3R,OAAQwR,EAASxR,MAAQ,IAE5D,MAAO,CAAEyV,QAAOC,QAClB,CAEA,SAAS2e,EAAoB1oB,GAC3B,GAAI0a,EAAUrmB,MAAO,CACnB,MAAM,MAAEyV,EAAK,MAAEC,GAAUwe,EAAmBvoB,GAEtCzG,EAAYovB,GAChBjO,EAAUrmB,MAAMm0B,UAAU,GAC1B9N,EAAUrmB,MAAMm0B,UAAU,GAC1B1e,EACAC,GAQF,GALA2d,IAEAlB,EAAc9L,EAAUrmB,MAAMm0B,UAAU,IAAI9N,EAAUrmB,MAAMm0B,UAAU,KACpE,EAEgB,SAAdjvB,EACF,IACE,IAAIqvB,EAAclO,EAAUrmB,MAAMm0B,UAAU,GAC5CI,GAAe9e,EACf8e,IAEApC,EAAcoC,GAAalO,EAAUrmB,MAAMm0B,UAAU,KAAM,OAExD,GAAkB,UAAdjvB,EACT,IACE,IAAIqvB,EAAclO,EAAUrmB,MAAMm0B,UAAU,GAC5CI,GAAe9e,EACf8e,IAEApC,EAAcoC,GAAalO,EAAUrmB,MAAMm0B,UAAU,KAAM,OAExD,GAAkB,OAAdjvB,EACT,IACE,IAAIsvB,EAAcnO,EAAUrmB,MAAMm0B,UAAU,GAC5CK,GAAe9e,EACf8e,IAEArC,EAAc9L,EAAUrmB,MAAMm0B,UAAU,IAAIK,IAAe,OAExD,GAAkB,SAAdtvB,EACT,IACE,IAAIsvB,EAAcnO,EAAUrmB,MAAMm0B,UAAU,GAC5CK,GAAe9e,EACf8e,IAEArC,EAAc9L,EAAUrmB,MAAMm0B,UAAU,IAAIK,IAAe,OAExD,GAAkB,aAAdtvB,EACT,IACE,IAAIsvB,EAAcnO,EAAUrmB,MAAMm0B,UAAU,GAC5CK,GAAe9e,EACf8e,IACA,CACA,MAAMD,EACJlO,EAAUrmB,MAAMm0B,UAAU,IACzBK,EAAcnO,EAAUrmB,MAAMm0B,UAAU,IACvCM,EAAoBF,EAAaC,KACnCrC,EAAcoC,GAAaC,IAAe,E,MAGzC,GAAkB,YAAdtvB,EACT,IACE,IAAIsvB,EAAcnO,EAAUrmB,MAAMm0B,UAAU,GAC5CK,GAAe9e,EACf8e,IACA,CACA,MAAMD,EACJlO,EAAUrmB,MAAMm0B,UAAU,IACzBK,EAAcnO,EAAUrmB,MAAMm0B,UAAU,IACvCM,EAAoBF,EAAaC,KACnCrC,EAAcoC,GAAaC,IAAe,E,MAGzC,GAAkB,cAAdtvB,EACT,IACE,IAAIsvB,EAAcnO,EAAUrmB,MAAMm0B,UAAU,GAC5CK,GAAe9e,EACf8e,IACA,CACA,MAAMD,EACJlO,EAAUrmB,MAAMm0B,UAAU,IACzBK,EAAcnO,EAAUrmB,MAAMm0B,UAAU,IACvCM,EAAoBF,EAAaC,KACnCrC,EAAcoC,GAAaC,IAAe,E,MAGzC,GAAkB,eAAdtvB,EACT,IACE,IAAIsvB,EAAcnO,EAAUrmB,MAAMm0B,UAAU,GAC5CK,GAAe9e,EACf8e,IACA,CACA,MAAMD,EACJlO,EAAUrmB,MAAMm0B,UAAU,IACzBK,EAAcnO,EAAUrmB,MAAMm0B,UAAU,IACvCM,EAAoBF,EAAaC,KACnCrC,EAAcoC,GAAaC,IAAe,E,CAKhDnO,EAAUrmB,MAAQ,CAChB+pB,OAAQ1D,EAAUrmB,MAAM+pB,OACxBoK,UAAW9N,EAAUrmB,MAAMm0B,UAC3BC,YAAa,CAAC3e,EAAOC,GACrBxQ,UAAWA,GAGbmM,G,CAEJ,CAEA,SAASqjB,EAAkB/oB,GACzB,GAAI0a,EAAUrmB,MAAO,CACnB,MAAM,MAAEyV,EAAK,MAAEC,GAAUwe,EAAmBvoB,GAG1C0a,EAAUrmB,MAAMm0B,UAAU,IAAM1e,GAChC4Q,EAAUrmB,MAAMm0B,UAAU,IAAMze,GAGhCue,G,CAGN,CAEA,SAASvB,EAA2B/mB,GAC9B0a,EAAUrmB,OACZi0B,GAEJ,CAEA,SAAStB,EAAyBhnB,GAC5B0a,EAAUrmB,OACZi0B,GAEJ,CAEA,SAASA,IACP,MAAM/pB,EAAeyqB,IACfC,EAAuB1qB,EAAa5I,MAAM,IAAIuzB,UAAU30B,KAAK,IACnEc,QAAQC,IAAI,YAAaiJ,EAAc0qB,GAEvC,MAAME,EACJxvB,EAAMtF,MAAM0U,SAASxK,IACrB5E,EAAMtF,MAAM0U,SAASkgB,GAEnBE,GAAaC,IAEjB,MAAMC,GACH1C,EAAWtyB,MAAM0U,SAASxK,KAC1BooB,EAAWtyB,MAAM0U,SAASkgB,GAEzBE,GAAeE,IACb1vB,EAAMtF,MAAM0U,SAASxK,IACvBlJ,QAAQC,IAAI,SAAUiJ,GACtBooB,EAAWtyB,MAAM4I,KAAKsB,KAEtBlJ,QAAQC,IAAI,SAAU2zB,GACtBtC,EAAWtyB,MAAM4I,KAAKgsB,KAI1BvO,EAAUrmB,WAAQ0C,EAClB2O,GACF,CAEA,SAASojB,EAAoB1vB,EAAWE,GACtC,QAASF,EAAI,GAAKA,GAAKyM,EAASxR,OAASiF,EAAI,GAAKA,GAAKuM,EAASxR,MAClE,CAEA,SAAS20B,IACP,IAAIzqB,EAAe,GAEnB,MAAMiqB,EAAY9N,EAAUrmB,OAAOm0B,UAC7Bc,EAAU5O,EAAUrmB,OAAOo0B,YAC3BlvB,EAAYmhB,EAAUrmB,OAAOkF,UAEnC,GAAIivB,GAAac,EACf,GAAkB,SAAd/vB,EACF,IAAK,IAAIH,EAAIovB,EAAU,GAAIpvB,GAAKkwB,EAAQ,GAAIlwB,IAC1CmF,GAAgBgoB,EAAKntB,GAAGovB,EAAU,SAE/B,GAAkB,UAAdjvB,EACT,IAAK,IAAIH,EAAIovB,EAAU,GAAIpvB,GAAKkwB,EAAQ,GAAIlwB,IAC1CmF,GAAgBgoB,EAAKntB,GAAGovB,EAAU,SAE/B,GAAkB,OAAdjvB,EACT,IAAK,IAAID,EAAIkvB,EAAU,GAAIlvB,GAAKgwB,EAAQ,GAAIhwB,IAC1CiF,GAAgBgoB,EAAKiC,EAAU,IAAIlvB,QAEhC,GAAkB,SAAdC,EACT,IAAK,IAAID,EAAIkvB,EAAU,GAAIlvB,GAAKgwB,EAAQ,GAAIhwB,IAC1CiF,GAAgBgoB,EAAKiC,EAAU,IAAIlvB,QAEhC,GAAkB,YAAdC,EACT,IAAK,IAAI+N,EAAI,EAAGA,GAAKkhB,EAAU,GAAKc,EAAQ,GAAIhiB,IAAK,CACnD,MAAMlO,EAAIovB,EAAU,GAAKlhB,EACnBhO,EAAIkvB,EAAU,GAAKlhB,EACzB,IAAIwhB,EAAoB1vB,EAAGE,GAGzB,MAFAiF,GAAgBgoB,EAAKntB,GAAGE,E,MAKvB,GAAkB,aAAdC,EACT,IAAK,IAAI+N,EAAI,EAAGA,GAAKkhB,EAAU,GAAKc,EAAQ,GAAIhiB,IAAK,CACnD,MAAMlO,EAAIovB,EAAU,GAAKlhB,EACnBhO,EAAIkvB,EAAU,GAAKlhB,EACzB,IAAIwhB,EAAoB1vB,EAAGE,GAGzB,MAFAiF,GAAgBgoB,EAAKntB,GAAGE,E,MAKvB,GAAkB,cAAdC,EACT,IAAK,IAAI+N,EAAI,EAAGA,GAAKgiB,EAAQ,GAAKd,EAAU,GAAIlhB,IAAK,CACnD,MAAMlO,EAAIovB,EAAU,GAAKlhB,EACnBhO,EAAIkvB,EAAU,GAAKlhB,EACzB,IAAIwhB,EAAoB1vB,EAAGE,GAGzB,MAFAiF,GAAgBgoB,EAAKntB,GAAGE,E,MAKvB,GAAkB,eAAdC,EACT,IAAK,IAAI+N,EAAI,EAAGA,GAAKgiB,EAAQ,GAAKd,EAAU,GAAIlhB,IAAK,CACnD,MAAMlO,EAAIovB,EAAU,GAAKlhB,EACnBhO,EAAIkvB,EAAU,GAAKlhB,EACzB,IAAIwhB,EAAoB1vB,EAAGE,GAGzB,MAFAiF,GAAgBgoB,EAAKntB,GAAGE,E,MAM5BiF,EAAegoB,EAAKiC,EAAU,IAAIA,EAAU,IAIhD,OAAOjqB,CACT,CAEA,SAASsJ,EAAS0hB,EAAeC,EAAexhB,GAC9C,GACEuhB,EAAQ,GACRA,EAAQ1jB,EAASxR,MAAQ,GACzBm1B,EAAQ,GACRA,EAAQ3jB,EAASxR,MAAQ,EAEzB,OAGF,MAAMmT,EAASwF,SAASsQ,eAAe,KACjC5V,EAAMF,EAAOG,WAAW,MAE1BD,IACFA,EAAIM,UAAYA,EAChBN,EAAIO,SACFshB,EAAQvjB,EAAS3R,MACjBm1B,EAAQxjB,EAAS3R,MACjB2R,EAAS3R,MACT2R,EAAS3R,OAGf,CAEA,SAAS+0B,IACP,IAAK,IAAIhwB,EAAI,EAAGA,EAAIyM,EAASxR,MAAO+E,IAClC,IAAK,IAAIE,EAAI,EAAGA,EAAIuM,EAASxR,MAAOiF,IAC7BmtB,EAAartB,GAAGE,KACnBmtB,EAAartB,GAAGE,GAAKktB,EAAcptB,GAAGE,IAK5CouB,GACF,CAEA,SAASiB,GACPc,EACAC,EACAtwB,EACAE,GAEA,MAAM8N,EAAKhO,EAAIqwB,EACTpiB,EAAK/N,EAAIowB,EAEf,GAAW,IAAPtiB,EAAU,CACZ,GAAIC,EAAK,EACP,MAAO,OACF,GAAIA,EAAK,EACd,MAAO,I,KAEJ,IAAW,IAAPA,EAMJ,OAAID,GAAM,GAAKC,GAAM,EACnB,aACED,IAAO,GAAKC,GAAM,EACpB,YACED,GAAM,GAAKC,IAAO,EACpB,WACED,IAAO,GAAKC,IAAO,EACrB,eAEP,EAdA,GAAID,EAAK,EACP,MAAO,QACF,GAAIA,EAAK,EACd,MAAO,M,CAab,CDtDA,OCpeA5R,EAAAA,EAAAA,KACE,IAAMuF,EAAM8J,OACZ,KACEiiB,IACAphB,GAAU,GAEZ,CAAEnF,MAAM,KAGV/K,EAAAA,EAAAA,KACE,IAAM2xB,EAAc9yB,QACnByK,IACKA,GACFwoB,G,IDudC,CAAC9sB,EAAUgG,MACRC,EAAAA,EAAAA,OAAcrG,EAAAA,EAAAA,IAAoB,MAAO6B,GAAY,EAC1D4E,EAAAA,EAAAA,IAAOlH,GAAOoM,OAAS,IACnBtF,EAAAA,EAAAA,OAAcrG,EAAAA,EAAAA,IAAoBgC,EAAAA,GAAW,CAAEI,IAAK,GAAK,EACxDN,EAAAA,EAAAA,IAAoB,MAAOC,GAAY,EACrCD,EAAAA,EAAAA,IAAoB,SAAU,CAC5B8N,QAAS,YACTxL,IAAKuG,EACLjC,OAAOjC,EAAAA,EAAAA,IAAOyE,GACdvC,QAAQlC,EAAAA,EAAAA,IAAOyE,GACf4E,cAAe1J,EAAO,KAAOA,EAAO,IAAKG,EAAAA,EAAAA,KAAgBjE,GAAiB2rB,EAAoB3rB,IAAU,CAAC,UACzGid,cAAenZ,EAAO,KAAOA,EAAO,IAAKG,EAAAA,EAAAA,KAAgBjE,GAAiBgsB,EAAoBhsB,IAAU,CAAC,UACzGmd,YAAarZ,EAAO,KAAOA,EAAO,IAAKG,EAAAA,EAAAA,KAAgBjE,GAAiBqsB,EAAkBrsB,IAAU,CAAC,WACpG,KAAM,GAAII,IACZmB,EAAQ4G,KAAK+gB,eACTnlB,EAAAA,EAAAA,OAAcrG,EAAAA,EAAAA,IAAoB,MAAO8C,GAAY,EACpDhB,EAAAA,EAAAA,IAAoB,KAAM,CACxB5B,MAAO,kBACP2I,aAAarC,EAAAA,EAAAA,IAAiB3C,EAAQ4G,KAAK9K,QAAQqsB,gBAClD,KAAM,EAAGjpB,KACZjB,EAAAA,EAAAA,IAAoB,KAAM,KAAM,GAC7BuE,EAAAA,EAAAA,KAAW,IAAOrG,EAAAA,EAAAA,IAAoBgC,EAAAA,GAAW,MAAMC,EAAAA,EAAAA,KAAYwE,EAAAA,EAAAA,IAAOlH,IAAS0F,KAC1EoB,EAAAA,EAAAA,OAAcrG,EAAAA,EAAAA,IAAoB,KAAM,CAC9CoC,IAAK6C,EACLrE,MAAOqE,EACP/E,OAAOC,EAAAA,EAAAA,IAAgB,CAAC,OAAQ,CAAE,aAAcosB,EAAWtyB,MAAM0U,SAAS1J,QACzEuB,EAAAA,EAAAA,IAAiBvB,GAAO,GAAIjC,OAC7B,YAGRgF,EAAAA,EAAAA,IAAoB,IAAI,MAE9BlG,EAAAA,EAAAA,IAAoB,MAAOmB,GAAY,CACrCC,IACApB,EAAAA,EAAAA,IAAoB,OAAQ,CAC1B5B,MAAO,YACP2I,aAAarC,EAAAA,EAAAA,IAAiB3C,EAAQ4G,KAAK9K,QAAQssB,QAClD,KAAM,EAAG9oB,KACZrB,EAAAA,EAAAA,IAAoB,OAAQ,CAC1B+G,aAAarC,EAAAA,EAAAA,IACfqF,KAAKC,MAAMmgB,EAAMhyB,MAAQ,IACzB,KACCgyB,EAAMhyB,MAAQ,IAAIC,WAAWq1B,SAAS,EAAG,OAEvC,KAAM,EAAGnsB,OAEdtB,EAAAA,EAAAA,IAAoB,MAAOuB,GAAa,EACtCvB,EAAAA,EAAAA,IAAoB,MAAOwB,GAAa,EACrCmD,EAAAA,EAAAA,IAAOsmB,KACH1mB,EAAAA,EAAAA,OAAc0B,EAAAA,EAAAA,IAAaiI,GAAiB,CAC3C5N,IAAK,EACL2G,gBAAgBtC,EAAAA,EAAAA,IAAOwF,GACvBhD,WAAWxC,EAAAA,EAAAA,IAAOuF,GAClB,kBAAkBvF,EAAAA,EAAAA,IAAO1G,IACxB,KAAM,EAAG,CAAC,iBAAkB,YAAa,qBAC5CiI,EAAAA,EAAAA,IAAoB,IAAI,MAE9BlG,EAAAA,EAAAA,IAAoB,MAAOmO,GAAa,EACrCxJ,EAAAA,EAAAA,IAAO0F,KACH9F,EAAAA,EAAAA,OAAcrG,EAAAA,EAAAA,IAAoB,SAAU,CAC3CoC,IAAK,EACLyG,aAAarC,EAAAA,EAAAA,IAAiB3C,EAAQ4G,KAAK9K,QAAQC,aACnDyC,QAASkK,EACT1L,KAAM,SACNX,MAAO,iBACN,KAAM,EAAGqT,MACZvL,EAAAA,EAAAA,IAAoB,IAAI,IAC3BvB,EAAAA,EAAAA,IAAOsmB,KACH1mB,EAAAA,EAAAA,OAAcrG,EAAAA,EAAAA,IAAoB,SAAU,CAC3CoC,IAAK,EACLyG,aAAarC,EAAAA,EAAAA,IAAiB3C,EAAQ4G,KAAK9K,QAAQE,aACnDwC,QAASmK,EACT3L,KAAM,SACNX,MAAO,iBACN,KAAM,EAAGsT,MACZxL,EAAAA,EAAAA,IAAoB,IAAI,GAC3B+C,EAAc9Q,QAAU+Q,EAAc/Q,QAClCoM,EAAAA,EAAAA,OAAcrG,EAAAA,EAAAA,IAAoB,SAAU,CAC3CoC,IAAK,EACLyG,aAAarC,EAAAA,EAAAA,IAAiB3C,EAAQ4G,KAAK9K,QAAQG,iBACnDuC,QAASoK,EACT5L,KAAM,SACNX,MAAO,iBACN,KAAM,EAAGuT,MACZzL,EAAAA,EAAAA,IAAoB,IAAI,QAG/B,OACF3B,EAAAA,EAAAA,OAAcrG,EAAAA,EAAAA,IAAoB,MAAO0T,IAAalN,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CACtE,sEACE,MAGZ,IEvyBA,MAAM,IAA2B,OAAgB,GAAQ,CAAC,CAAC,YAAY,qBAEvE,UCHM,SAAU7E,GAAOxB,EAAUgG,EAAY6B,EAAYC,EAAYC,EAAWC,GAC9E,MAAMonB,GAAyBrf,EAAAA,EAAAA,IAAkB,eAC3Csf,GAA0Btf,EAAAA,EAAAA,IAAkB,gBAC5Cuf,GAA6Bvf,EAAAA,EAAAA,IAAkB,mBAC/Cwf,GAA+Bxf,EAAAA,EAAAA,IAAkB,qBACjDyf,GAA2Bzf,EAAAA,EAAAA,IAAkB,iBAEnD,OAAQ9J,EAAAA,EAAAA,OAAcrG,EAAAA,EAAAA,IAAoBgC,EAAAA,GAAW,KAAM,EC6C3D0E,EAAAA,EAAAA,IAmBgBkpB,EAAA,MD9DZ3uB,SAAS2F,EAAAA,EAAAA,KC4CX,IAEe,EAFfF,EAAAA,EAAAA,IAEe+oB,EAAA,CAFA7uB,MAAOR,EAAApD,SAAS,sBAAuBgE,KAAK,UDxCpD,CACDC,SAAS2F,EAAAA,EAAAA,KCwCb,IAAiD,EAAjDF,EAAAA,EAAAA,IAAiD8oB,EAAA,CAAnC,kBAAiBpvB,EAAAxF,gBAAc,+BDrCzC2M,EAAG,GACF,EAAG,CAAC,WCsCXb,EAAAA,EAAAA,IAKe+oB,EAAA,CAJZ7uB,MAAOR,EAAApD,SAAS,+BACjBgE,KAAK,WDpCA,CACDC,SAAS2F,EAAAA,EAAAA,KCqCb,IAAqD,EAArDF,EAAAA,EAAAA,IAAqDgpB,EAAA,CAAnC,kBAAiBtvB,EAAAxF,gBAAc,+BDlC7C2M,EAAG,GACF,EAAG,CAAC,WCmCXb,EAAAA,EAAAA,IAQe+oB,EAAA,CAPZ7uB,MAAOR,EAAApD,SAAS,8BACjBgE,KAAK,sBDjCA,CACDC,SAAS2F,EAAAA,EAAAA,KCkCb,IAGE,EAHFF,EAAAA,EAAAA,IAGEipB,EAAA,CAFCE,SAAUzvB,EAAAxF,eAAek1B,iBACzBC,SAAQ3vB,EAAA4vB,wBDhCF,KAAM,EAAG,CAAC,WAAY,gBAE3BzoB,EAAG,GACF,EAAG,CAAC,aAETA,EAAG,KAODS,EAAAA,EAAAA,IAAoB,IAAI,IAC3B,GACL,CErDA,MAAM2W,GAAeC,KAAMC,EAAAA,EAAAA,IAAa,mBAAmBD,EAAEA,KAAIE,EAAAA,EAAAA,MAAcF,GACzE/c,GAAa,CAAEO,IAAK,GACpBL,GAAa,CC0oBTwB,MAAA,uBDzoBJb,GAAa,CCgpBV0B,IAAI,oBD/oBPtB,GAAa,CAAC,UAAW,SACzBC,GAAa,CAAC,SACdC,GAAa,CAAC,SACdC,GAAa,CAAC,SACdC,GAA2Byb,IAAa,KC2rBxC7c,EAAAA,EAAAA,IAA2C,OAAtC5B,MAAM,QAAQ,wBDxrBtB,MAAO,KACJiD,GAAa,CCmuBNjD,MAAM,sBDjuBb,SAAU0B,GAAOxB,EAAUgG,EAAY6B,EAAYC,EAAYC,EAAWC,GAC9E,MAAM6nB,GAAgC9f,EAAAA,EAAAA,IAAkB,sBAClD+f,GAAgC/f,EAAAA,EAAAA,IAAkB,sBAExD,OAAQ9J,EAAAA,EAAAA,OAAcrG,EAAAA,EAAAA,IAAoBgC,EAAAA,GAAW,KAAM,CCwnBlD5B,EAAA+vB,oBDtnBF9pB,EAAAA,EAAAA,OCsnBPrG,EAAAA,EAAAA,IAGI,IAAA6B,GAAA,EDxnBI2F,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,ICsnBpBpG,EAAApD,SAAS,mDAAoD,IAChE,IAAA8E,EAAAA,EAAAA,IAA6D,OAA7DC,IAA6DyE,EAAAA,EAAAA,IAA3BpG,EAAA+vB,mBAAiB,ODpnB/CnoB,EAAAA,EAAAA,IAAoB,IAAI,ICsnB9BlG,EAAAA,EAAAA,IA+GM,OA9GJ5B,OAAKC,EAAAA,EAAAA,IAAA,CAAC,oBAAmB,sBAEOC,EAAAkgB,aADhClc,IAAI,QDpnBD,ECunBHtC,EAAAA,EAAAA,IAAkC,MAAlCY,GAAkC,UAGxBtC,EAAAgwB,wBDvnBH/pB,EAAAA,EAAAA,OCqnBPrG,EAAAA,EAAAA,IAIO,ODxnBCoC,IAAK,ECqnBXlC,MAAM,2BAELmC,QAAK+D,EAAA,KAAAA,EAAA,GAAA9D,GAAElC,EAAAoS,OAAQ6d,uBAAkB1zB,QDnnB9BqL,EAAAA,EAAAA,IAAoB,IAAI,KAC3B3B,EAAAA,EAAAA,KAAW,IConBdrG,EAAAA,EAAAA,IAWEgC,EAAAA,GAAA,MAAAC,EAAAA,EAAAA,IATsB7B,EAAAqK,KAAK6lB,cAApBC,KDrnBGlqB,EAAAA,EAAAA,OCmnBZrG,EAAAA,EAAAA,IAWE,UAVAE,MAAM,kCAELkC,IAAKmuB,EAAY/tB,GACjBe,OAAKsM,EAAAA,EAAAA,IAAEzP,EAAAowB,kCAAkCD,IACzCluB,QAAKC,GAAElC,EAAAqwB,yBAAyBF,GAChC3vB,MAAgBR,EAAApD,SAAQ,gCDlnBrBuzB,YCknB+EnwB,EAAAswB,qBAAqBH,MD/mBnG,KAAM,GAAIztB,OACX,MCsnBE1C,EAAAoS,SDpnBDnM,EAAAA,EAAAA,OCknBPrG,EAAAA,EAAAA,IA+BM,ODhpBEoC,IAAK,ECknBXgC,IAAI,6BAEJlE,OAAKC,EAAAA,EAAAA,IAAA,CAAC,+BAA8B,CDjnBlCqgB,QCknByBpgB,EAAAuwB,yBDhnBpB,CCynB+B,YAA9BvwB,EAAAwwB,qBAAqB/vB,ODvnBlBwF,EAAAA,EAAAA,OCknBXrG,EAAAA,EAAAA,IAMU,UDvnBEoC,IAAK,ECknBfvB,KAAK,SACLX,MAAM,kCACLmC,QAAK+D,EAAA,KAAAA,EAAA,GAAA9D,GAAElC,EAAAywB,oBAAoBzwB,EAAAwwB,sBAC3BhwB,MAAOR,EAAApD,SAAS,aDhnBN,KAAM,EAAG+F,MACZiF,EAAAA,EAAAA,IAAoB,IAAI,ICknBlClG,EAAAA,EAAAA,IAKU,UAJRjB,KAAK,SACLX,MAAM,oBACLmC,QAAK+D,EAAA,KAAAA,EAAA,GAAA9D,GAAElC,EAAAwwB,qBAAuBxwB,EAAA0wB,gBAAgB1wB,EAAAwwB,sBAC9ChwB,MAAOR,EAAApD,SAAS,eDhnBV,KAAM,EAAGgG,KCknBlBlB,EAAAA,EAAAA,IAQU,UAPRjB,KAAK,SACLX,MAAM,qBACLmC,QAAK+D,EAAA,KAAAA,EAAA,GAAA9D,GAAalC,EAAAgwB,uBAAqChwB,EAAAoS,QAAQue,kBAAkB3wB,EAAAgwB,wBAIjFxvB,MAAOR,EAAApD,SAAS,YDhnBV,KAAM,EAAGiG,ICknBlBC,IDhnBO,KACH8E,EAAAA,EAAAA,IAAoB,IAAI,KAC3B3B,EAAAA,EAAAA,KAAW,ICgnBdrG,EAAAA,EAAAA,IAmCWgC,EAAAA,GAAA,MAAAC,EAAAA,EAAAA,IAnCqB7B,EAAA4wB,qBAAfT,KD/mBLlqB,EAAAA,EAAAA,OAAcrG,EAAAA,EAAAA,IAAoBgC,EAAAA,GAAW,CACnDI,IC8mBqDmuB,EAAY/tB,ID7mBhE,CC+mBwB,YAArB+tB,EAAY1vB,OD7mBXwF,EAAAA,EAAAA,OC4mBT0B,EAAAA,EAAAA,IAcEkoB,EAAA,CDznBQ7tB,IAAK,EC6mBZI,GAAE,eAAiBpC,EAAA+e,OAAOoR,EAAY/tB,KACvCtC,MAAM,2BACLqD,OAAKsM,EAAAA,EAAAA,IAAA,CD3mBJN,KC2mBwC,IAAbghB,EAAYvxB,ED3mBjC,IACNyQ,IC0mBkF,IAAb8gB,EAAYrxB,ED1mB5E,MC8mBNqxB,YAAaA,EACbluB,QAAKC,GAAElC,EAAAoS,QAAQ6d,kBAAkBE,EAAY/tB,IAC7CsN,cAAWxN,GAAElC,EAAA6wB,yBAAyB3uB,EAAQiuB,GAC9ChR,cAAWjd,GAAElC,EAAA8wB,yBAAyB5uB,EAAQiuB,GAC9C9Q,YAASnd,GAAElC,EAAA+wB,uBAAuB7uB,EAAQiuB,GAC1Ca,sBAAqBhxB,EAAAywB,qBD3mBb,KAAM,EAAG,CAAC,KAAM,QAAS,cAAe,UAAW,gBAAiB,gBAAiB,cAAe,2BC8mB7E,YAArBN,EAAY1vB,OD5mBdwF,EAAAA,EAAAA,OC2mBX0B,EAAAA,EAAAA,IAkBEmoB,EAAA,CD5nBU9tB,IAAK,EC4mBdI,GAAE,eAAiBpC,EAAA+e,OAAOoR,EAAY/tB,KACvCtC,MAAM,2BACLqD,OAAKsM,EAAAA,EAAAA,IAAA,CD1mBJN,KC0mBwC,IAAbghB,EAAYvxB,ED1mBjC,IACNyQ,ICymBkF,IAAb8gB,EAAYrxB,EDzmB5E,IACLwJ,MCwmBkI,IAAjB6nB,EAAY7nB,MDxmBtH,IACPC,OCumBoL,IAAlB4nB,EAAY5nB,ODvmBtK,MC6mBT4nB,YAAaA,EACbluB,QAAKC,GAAElC,EAAAoS,QAAQ6d,kBAAkBE,EAAY/tB,IAC7CsN,cAAWxN,GAAElC,EAAA6wB,yBAAyB3uB,EAAQiuB,GAC9ChR,cAAWjd,GAAElC,EAAA8wB,yBAAyB5uB,EAAQiuB,GAC9C9Q,YAASnd,GAAElC,EAAA+wB,uBAAuB7uB,EAAQiuB,GAC1Cc,0BAAyBjxB,EAAAixB,0BACzBC,0BAAyBlxB,EAAAkxB,0BACzBC,wBAAuBnxB,EAAAmxB,yBD1mBb,KAAM,EAAG,CAAC,KAAM,QAAS,cAAe,UAAW,gBAAiB,gBAAiB,cAAe,4BAA6B,4BAA6B,8BACjKvpB,EAAAA,EAAAA,IAAoB,IAAI,IAC7B,OACD,OC0mBNtB,EAAAA,EAAAA,IAmBa8qB,EAAAA,GAAA,CAnBDjvB,KAAK,QAAM,CDxmBnBtB,SAAS2F,EAAAA,EAAAA,KCymBX,IAiBM,CAhB8B,YAA5BxG,EAAAqxB,mBAAmB5wB,ODxmBlBwF,EAAAA,EAAAA,OCumBTrG,EAAAA,EAAAA,IAiBM,ODvnBIoC,IAAK,ECwmBblC,MAAM,+BACLmC,QAAK+D,EAAA,KAAAA,EAAA,IAAAG,EAAAA,EAAAA,KDrmBd,IAAItI,ICqmBiBmC,EAAAsxB,kBAAAtxB,EAAAsxB,oBAAAzzB,IAAgB,YDpmBpB,ECsmBT6D,EAAAA,EAAAA,IAWM,MAXNqB,GAWM,EAVJrB,EAAAA,EAAAA,IAEK,WAAA0E,EAAAA,EAAAA,IADApG,EAAAuxB,cAAcvxB,EAAAqxB,kBAAkB72B,eAAeyE,YAAS,KDrmBpDgH,EAAAA,EAAAA,OCumBT0B,EAAAA,EAAAA,KAGE6pB,EAAAA,EAAAA,IAFKxxB,EAAAyxB,kBAAkBzxB,EAAAqxB,kBAAkB72B,eAAeyE,YAAS,CAChEoL,KAAMrK,EAAAqxB,kBAAkB72B,gBDvmBhB,KAAM,EAAG,CAAC,WCymBrBkH,EAAAA,EAAAA,IAES,UAFDjB,KAAK,SAASX,MAAM,gBAAiBmC,QAAK+D,EAAA,KAAAA,EAAA,GDnmB5D,IAAInI,ICmmB0DmC,EAAAsxB,kBAAAtxB,EAAAsxB,oBAAAzzB,MDlmBzCuI,EAAAA,EAAAA,ICmmBNpG,EAAApD,SAAS,cAAD,SDhmBTgL,EAAAA,EAAAA,IAAoB,IAAI,MAE9BT,EAAG,KAEJ,IACF,GACL,C,oCE3IA,MAAMuqB,GAAmBtzB,EAAAA,EAAEG,OAAO,CAChCkC,KAAMrC,EAAAA,EAAEc,QAAQ,WAChBkD,GAAIhE,EAAAA,EAAEK,SACNkzB,UAAWvzB,EAAAA,EAAES,SACb+yB,QAASxzB,EAAAA,EAAES,SACXD,EAAGR,EAAAA,EAAES,SACLC,EAAGV,EAAAA,EAAES,SACLyJ,MAAOlK,EAAAA,EAAES,SACT0J,OAAQnK,EAAAA,EAAES,SACV6U,KAAMtV,EAAAA,EAAEK,SACRozB,iBAAkBzzB,EAAAA,EAAEkB,UAAUwyB,WAAWjxB,SAAQ,KAE7CkxB,GAAmBL,GAAiBM,KAAK,CAAEte,MAAM,IAAQue,OAAO,CACpEC,EAAG9zB,EAAAA,EAAEc,QAAQ,GACbizB,gBAAiB/zB,EAAAA,EAAEK,WAGf2zB,GAAgBh0B,EAAAA,EACnBi0B,MAAM,CAACX,GAAkBK,KACzBO,WAAW72B,IACV,GAAKO,OAAOu2B,OAAO92B,EAAK,KAkBtB,OAAOA,EAlBqB,CAE5B,MAAM+2B,EAAS/2B,GACT,KAAEiY,KAAS+e,GAAgBD,EAC3BE,EAAS,CACbR,EAAG,EACHC,gBAAiBze,KACd+e,GASL,OAPA53B,QAAQC,IACN,sDACA,MACA03B,EACA,MACAE,GAEKA,C,KASPC,GAA2Bv0B,EAAAA,EAAEG,OAAO,CACxCkC,KAAMrC,EAAAA,EAAEc,QAAQ,WAChBkD,GAAIhE,EAAAA,EAAEK,SACNkzB,UAAWvzB,EAAAA,EAAES,SACb+yB,QAASxzB,EAAAA,EAAES,SACXD,EAAGR,EAAAA,EAAES,SACLC,EAAGV,EAAAA,EAAES,SACLrE,eAAgB4D,EAAAA,EAAEw0B,MAAK,IAAMC,KAC7BhB,iBAAkBzzB,EAAAA,EAAEkB,UAAUwyB,WAAWjxB,SAAQ,KAI7CiyB,GAAoC10B,EAAAA,EACvCi0B,MAAM,CAACD,GAAeO,KACtBI,QAAQjyB,GAASA,EAAK8wB,QAAU9wB,EAAK6wB,WAAW,CAC/CvnB,QAAS,2CACTxO,KAAM,CAAC,aAILo3B,GAAgB50B,EAAAA,EAAEG,OAAO,CAC7BkC,KAAMrC,EAAAA,EAAEc,QAAQ,UAGZ+zB,GAAqB70B,EAAAA,EAAEG,OAAO,CAClCkC,KAAMrC,EAAAA,EAAEc,QAAQ,WAChBg0B,IAAK90B,EAAAA,EAAEK,WAOH00B,GAA2B/0B,EAAAA,EAAEG,OAAO,CACxCkC,KAAMrC,EAAAA,EAAEc,QAAQ,uBAChB6e,KAAMqV,GAAAA,KAEFC,GAA2Bj1B,EAAAA,EAAEG,OAAO,CACxC2zB,EAAG9zB,EAAAA,EAAEc,QAAQ,GACbuB,KAAMrC,EAAAA,EAAEc,QAAQ,uBAChB4gB,QAAS1hB,EAAAA,EAAEK,WAEP60B,GAAwBl1B,EAAAA,EAC3Bi0B,MAAM,CAACc,GAA0BE,KACjCf,WAAW72B,IACV,GAAKO,OAAOu2B,OAAO92B,EAAK,KAyBtB,OAAOA,EAzBqB,CAE5B,MAAM+2B,EAAS/2B,EACT83B,EAAY,IAAIC,gBAAgBhB,EAAOzU,KAAKmV,KAC5CpT,EAAUyT,EAAUnvB,IAAI,WAC9B,IAAK0b,EACH,MAAM,IAAI7kB,MAEN,6HAAoDu3B,EAAOzU,KAAKmV,QAGtE,MAAMR,EAAS,CACbR,EAAG,EACHzxB,KAAM,sBACNqf,WASF,OAPAjlB,QAAQC,IACN,sEACA,MACA03B,EACA,MACAE,GAEKA,C,KAOPe,GAAcr1B,EAAAA,EAAEi0B,MAAM,CAC1BW,GACAC,GACAK,KAIWI,GAAyBt1B,EAAAA,EAAEG,OAAO,CAC7Co1B,QAASv1B,EAAAA,EAAEkB,UACXs0B,aAAcx1B,EAAAA,EAAEK,SAChBo1B,mBAAoBz1B,EAAAA,EAAEK,WAIXq1B,GAA6B11B,EAAAA,EAAEG,OAAO,CACjDU,UAAWb,EAAAA,EAAEc,QAAQ,oBACrB60B,MAAON,GACPO,SAAU51B,EAAAA,EAAEkB,UAAUwyB,WAAWjxB,SAAQ,GACzCozB,QAAS71B,EAAAA,EAAES,SAASizB,WAAWjxB,QAAQ,GACvCqzB,kBAAmB91B,EAAAA,EAChBi0B,MAAM,CACLj0B,EAAAA,EAAEc,QAAQ,gBACVd,EAAAA,EAAEc,QAAQ,oBACVd,EAAAA,EAAEc,QAAQ,mCAEX2B,QAAQ,gBACXqvB,aAAc9xB,EAAAA,EAAEgB,MAAM0zB,IACtBpD,iBAAkBgE,GAAuB5B,WAAWjxB,SAClD,MACE8yB,SAAS,EACTC,aAAc,GACdC,mBAAoB,SAMpB,SAAUvD,GAAqBH,GACnC,OAAQA,EAAY1vB,MAClB,IAAK,UACH,OAAO8wB,GAAcpB,EAAY31B,eAAeyE,WAClD,IAAK,UACH,OAAOrC,EAAAA,EAAAA,IAAS,eAEtB,CAEM,SAAUu3B,GAAmBhE,GACjC,OAAQA,EAAY1vB,MAClB,IAAK,UACH,MAAO,OACT,IAAK,UACH,OAAO2zB,GAAgBjE,EAAY31B,eAAeyE,WAExD,CAEO,MAYDo1B,GAAoBj2B,EAAAA,EAAEG,OAAO,CACjC+1B,QAASl2B,EAAAA,EAAEkB,UACXi1B,UAAWn2B,EAAAA,EAAEkB,YAGTk1B,GAAyBp2B,EAAAA,EAAEi0B,MAAM,CACrCj0B,EAAAA,EAAEc,QAAQ,QACVd,EAAAA,EAAEc,QAAQ,SACVd,EAAAA,EAAEc,QAAQ,SACVd,EAAAA,EAAEc,QAAQ,UAGNu1B,GAA2B,CAC/BC,SAAUt2B,EAAAA,EAAEK,SACZk2B,WAAYv2B,EAAAA,EAAEC,KAAK,CAAC,oBAAqB,cACzCu2B,WAAYx2B,EAAAA,EAAEy2B,OAAOh2B,SACrBi2B,SAAU12B,EAAAA,EAAEy2B,OAAOh2B,SAASk2B,WAC5BC,SAAU52B,EAAAA,EAAEK,SACZw2B,UAAWT,IAGAU,GAAqB92B,EAAAA,EAAEG,OAAO,CACzCge,WAAYne,EAAAA,EAAEG,OAAO,CACnB6D,GAAIhE,EAAAA,EAAEK,SACN02B,WAAY/2B,EAAAA,EAAEK,SACd22B,OAAQh3B,EAAAA,EAAEK,SAAS42B,SAAS,CAAEjS,QAAQ,IACtCkS,OAAQl3B,EAAAA,EAAEK,SAAS42B,SAAS,CAAEjS,QAAQ,OACnCqR,KAELc,KAAMn3B,EAAAA,EAAEG,OAAO,CAAEi3B,YAAanB,OAkB1BoB,IAdiCr3B,EAAAA,EAAEG,OAAOk2B,IAETr2B,EAAAA,EAAEG,OAAO,CAC9C6D,GAAIhE,EAAAA,EAAEK,SACN8d,WAAYne,EAAAA,EAAEG,OAAO,CACnBq2B,WAAYx2B,EAAAA,EAAEy2B,OAAOh2B,SACrBi2B,SAAU12B,EAAAA,EAAEy2B,OAAOh2B,SAASk2B,WAC5BC,SAAU52B,EAAAA,EAAEK,SACZw2B,UAAWT,OAMqB,CAClCkB,QAASt3B,EAAAA,EAAEK,SACXu2B,SAAU52B,EAAAA,EAAEK,WAGDk3B,GAAwBv3B,EAAAA,EAAEG,OAAO,CAC5Cge,WAAYne,EAAAA,EAAEG,OAAO,CACnB6D,GAAIhE,EAAAA,EAAEK,SACN02B,WAAY/2B,EAAAA,EAAEK,SACd22B,OAAQh3B,EAAAA,EAAEK,SAAS42B,SAAS,CAAEjS,QAAQ,IACtCkS,OAAQl3B,EAAAA,EAAEK,SAAS42B,SAAS,CAAEjS,QAAQ,OACnCqS,KAELF,KAAMn3B,EAAAA,EAAEG,OAAO,CAAEi3B,YAAanB,OChQnBuB,IDoQ6Bx3B,EAAAA,EAAEG,OAAO,CACjDge,WAAYne,EAAAA,EAAEG,OAAOk3B,MAImBr3B,EAAAA,EAAEG,OAAO,CACjD6D,GAAIhE,EAAAA,EAAEK,SACN8d,WAAYne,EAAAA,EAAEG,OAAO,CACnBy2B,SAAU52B,EAAAA,EAAEK,aC5QiCrG,OAC/C,mCCXImmB,GAAeC,KAAMC,EAAAA,EAAAA,IAAa,mBAAmBD,EAAEA,KAAIE,EAAAA,EAAAA,MAAcF,GACzE/c,GAAa,CAAC,sBACdE,GAAa,CCoCV7B,MAAM,qBDnCTwC,GAA2Bic,IAAa,KCsC1C7c,EAAAA,EAAAA,IAAsC,OAAjC5B,MAAM,sBAAoB,WDpC7B,SAAU0B,GAAOxB,EAAUgG,EAAY6B,EAAYC,EAAYC,EAAWC,GAC9E,OAAQ/B,EAAAA,EAAAA,OCsBRrG,EAAAA,EAAAA,IAkBS,UAjBPa,KAAK,SACLX,OAAKC,EAAAA,EAAAA,IAAA,CAAC,uBAAsB,CDrB1B3C,SCsBwB4C,EAAAoS,QAAQ4d,sBAAsBn2B,QAAUmG,EAAAmwB,YAAY/tB,GDrB5EgQ,SCqBgGpS,EAAAoS,UAIjG,qBAAoBpS,EAAAuxB,cAAcvxB,EAAAmwB,YAAY31B,eAAeyE,WAC7DgD,QAAK+D,EAAA,KAAAA,EAAA,GAAA9D,IAAA,KAAQkQ,QAAUpS,EAAA6R,MAAM,sBAAuB7R,EAAAmwB,eDtBpD,ECwBDzuB,EAAAA,EAAAA,IAEM,MAFNC,IAEMyE,EAAAA,EAAAA,IADDpG,EAAAuxB,cAAcvxB,EAAAmwB,YAAY31B,eAAeyE,YAAS,GAEvDqD,IACAZ,EAAAA,EAAAA,IAGO,OAFL5B,OAAKC,EAAAA,EAAAA,IAAA,CAAC,qCACEC,EAAAo0B,gBAAgBp0B,EAAAmwB,YAAY31B,eAAeyE,cDzBlD,KAAM,IACR,GAAIwC,GACT,CCdA,QAAepB,EAAAA,EAAAA,IAAgB,CAC7B8B,KAAM,qBACNiH,QAAS,CAAEgrB,gBAAe,GAAE7C,cAAaA,IACzC/tB,KAAAA,GACE,MAAO,CACL4O,QAAQ9R,EAAAA,EAAAA,IACNs1B,QACAr5B,GAGN,EACAgE,MAAO,CACL4vB,YAAa,CACX1vB,KAAMzE,OACN2E,UAAU,MChBhB,MAAM,IAA2B,OAAgB,GAAQ,CAAC,CAAC,SAAS,IAAQ,CAAC,YAAY,qBAEzF,UCPA,MACMc,GAAa,CAAC,sBACdE,GAAa,CAAC,gBAAiB,gBAAiB,eAChDW,GAAa,CAAC,aAEd,SAAUd,GAAOxB,EAAUgG,EAAY6B,EAAYC,EAAYC,EAAWC,GAC9E,OAAQ/B,EAAAA,EAAAA,OC2DRrG,EAAAA,EAAAA,IAoBM,OAnBJE,OAAKC,EAAAA,EAAAA,IAAA,CAAC,UAAS,CD1Db3C,SC2DwB4C,EAAAoS,QAAQ4d,sBAAsBn2B,QAAUmG,EAAAmwB,YAAY/tB,GD1D5EgQ,SC0DgGpS,EAAAoS,UAIjG,qBAAoBpS,EAAApD,SAAS,gBD3D7B,CC6DeoD,EAAAoS,SD3DXnM,EAAAA,EAAAA,KAAW,IC4DdrG,EAAAA,EAAAA,IAQEgC,EAAAA,GAAA,CAAAI,IAAA,IAAAH,EAAAA,EAAAA,IAPiB7B,EAAAuf,eAAVC,KD5DGvZ,EAAAA,EAAAA,OC2DZrG,EAAAA,EAAAA,IAQE,OANCoC,IAAKwd,EACN1f,OAAKC,EAAAA,EAAAA,IAAA,CAAC,gBACEyf,IACP9P,eAAWvJ,EAAAA,EAAAA,KAAAjE,GAAOlC,EAAAixB,0BAA0B/uB,EAAQsd,IAAM,UAC1DL,eAAWhZ,EAAAA,EAAAA,KAAAjE,GAAOlC,EAAAkxB,0BAA0BhvB,EAAQsd,IAAM,UAC1DH,aAASlZ,EAAAA,EAAAA,KAAAjE,GAAOlC,EAAAmxB,wBAAwBjvB,EAAQsd,IAAM,WD5DlD,KAAM,GAAI7d,OACX,OACJiG,EAAAA,EAAAA,IAAoB,IAAI,IC6D5BlG,EAAAA,EAAAA,IAAoE,OAA/D5B,MAAM,kBAAkB2T,UAAQzT,EAAAmwB,YAAYgC,iBDzD9C,KAAM,EAAG7vB,KACX,GAAIb,GACT,CCtBA,QAAepB,EAAAA,EAAAA,IAAgB,CAC7B8B,KAAM,qBACNiH,QAAS,CACPxM,SAAQ,KACRq0B,yBAAAA,CAA0BzrB,EAAqBga,GAC7Cve,KAAK4Q,MAAM,0BAA2B,CACpCrM,QACAga,SACA2Q,YAAalvB,KAAKkvB,aAEtB,EACAe,yBAAAA,CAA0B1rB,EAAqBga,GAC7Cve,KAAK4Q,MAAM,0BAA2B,CACpCrM,QACAga,SACA2Q,YAAalvB,KAAKkvB,aAEtB,EACAgB,uBAAAA,CAAwB3rB,EAAqBga,GAC3Cve,KAAK4Q,MAAM,wBAAyB,CAClCrM,QACAga,SACA2Q,YAAalvB,KAAKkvB,aAEtB,GAEF3sB,KAAAA,GACE,MAAO,CACL4O,QAAQ9R,EAAAA,EAAAA,IACNs1B,QACAr5B,GAGN,EACAuE,IAAAA,GACE,MAAO,CACLye,cAAe,CACb,OACA,WACA,MACA,YACA,QACA,eACA,SACA,eAGN,EACAhf,MAAO,CACL4vB,YAAa,CACX1vB,KAAMzE,OACN2E,UAAU,MCrDhB,MAAM,IAA2B,OAAgB,GAAQ,CAAC,CAAC,SAAS,IAAQ,CAAC,YAAY,qBAEzF,URgCA,IAAI8hB,GArCJjJ,EAAQ,MAsCR,QAAenZ,EAAAA,EAAAA,IAAgB,CAC7B8B,KAAM,cACN2P,WAAY,CAAE+jB,mBAAkB,GAAEC,mBAAkBA,IACpDtyB,KAAAA,GACE,MAAO,CACL4O,QAAQ9R,EAAAA,EAAAA,IACNs1B,QACAr5B,GAGN,EACAgE,MAAO,CACL8J,KAAM,CACJ5J,KAAMzE,OACN2E,UAAU,IAGd8Q,MAAO,CACLskB,UAAAA,CAAWC,GACT,OAAO,CACT,EACAC,cAAAA,CAAeC,GACb,OAAO,CACT,GAEFp1B,IAAAA,GACE,MAAO,CACLq1B,OAAQ,KAERH,KAAM,EAGNI,WAAY,EACZC,WAAW,EACXnW,eAAW3jB,EACX80B,uBAAmB90B,EACnB+5B,sBAAuB,CACrBC,YAAa,EACbC,cAAe,GAEjBC,yBAAqBl6B,EACrBm6B,iBAAkBrV,QAAQC,QAAQ,CAAE7gB,KAAM,SAC1CsvB,uBAAmBxzB,EAEvB,EACA+E,SAAU,KACLwb,EAAAA,GAAAA,IAAW,CACZ6Z,YAAa,mBAKf5X,GAAAA,GACE,OAAO9Z,EAAAA,EAAAA,IACT,EAEAsrB,oBAAAA,GAEE,OACEtvB,KAAKuvB,qBACLvvB,KAAK2vB,oBAAoBriB,SAAStN,KAAKuvB,qBAEhCvvB,KAAKuvB,yBAEZ,CAEJ,EACAA,mBAAAA,GACE,OAAOvvB,KAAKoJ,KAAK6lB,aAAahzB,MAC3B4P,GAAMA,EAAE1K,KAAOnB,KAAK+uB,uBAEzB,EACAA,qBAAAA,GACE,OAAO/uB,KAAKmR,QAAQ4d,sBAAsBn2B,KAC5C,EAKA+2B,mBAAAA,GACE,OAAO3vB,KAAKoJ,KAAK6lB,aAAatpB,QAAQkG,GAC7BA,EAAE6kB,WAAa1wB,KAAK+0B,MAAQlpB,EAAE8kB,QAAU3wB,KAAK+0B,MAExD,EAGAY,0BAAAA,GACE,MAAO,CAAC31B,KAAK+0B,KAAM/0B,KAAK2vB,oBAC1B,GAEF51B,MAAO,CACL,aAAc,CACZiO,OAAAA,CAAQ8qB,GACNl5B,QAAQC,IAAI,qBAAsBi5B,GAClC9yB,KAAKy1B,iBAAmBz1B,KAAK41B,cAAc9C,GAC3C9yB,KAAKy1B,iBAAiBrY,OAAOpR,IAC3BpS,QAAQoS,MAAM,6BAA8BA,GAC5ChM,KAAK8uB,kBAAoB9iB,CAAK,IAEhChM,KAAKy1B,iBAAiBvY,MAAM2Y,IAC1B71B,KAAK81B,iBAAiBD,GACtB71B,KAAK8uB,uBAAoBxzB,CAAS,GAEtC,EACAyM,WAAW,GAGb4tB,0BAAAA,EACGI,EAASC,IACTC,EAASC,IAEV,MAAMC,EAAmBn2B,KAAKo1B,WAAaW,EAAUE,EAC/CG,EAAmCJ,EAAuB/5B,MAC7D4P,IAAOqqB,EAAuB5oB,SAASzB,IAAMA,EAAE+kB,mBAE9CuF,GAAoBC,IACtBx8B,QAAQC,IACN,4BACAu8B,GAEFp2B,KAAKk1B,OAAQmB,QAEjB,EACA/G,qBAAsB,CACpBvnB,WAAW,EACXC,QAAS,SAAUknB,GACjB1N,IAAgBE,UACZwN,GAOFlvB,KAAK2hB,WAAU,KACb,MAAM2U,EAAqB/kB,SAASsQ,eAClC,eAAe7hB,KAAK8d,OAAOoR,EAAY/tB,MAEnC2gB,EAAiB9hB,KAAKsI,MACzBiuB,2BACH/U,IAAiBQ,EAAAA,GAAAA,IAAasU,EAAoBxU,EAAgB,CAChEG,UAAW,MACXC,UAAW,CACT,CACEhhB,KAAM,SACNyb,QAAS,CACPwF,OAAQ,CAAC,EAAG,OAIlB,GAGR,IAGJha,QAAS,CACPknB,qBAAoB,GACpB1zB,SAAQ,KACR20B,cAAa,GACbE,kBAAiB,OACdlU,EAAAA,GAAAA,IAAW,CACZka,YAAa,uBAEfC,aAAAA,GACE78B,QAAQC,IAAI,eACd,EAKA,mBAAM+7B,CAAc9C,GAClB,OAAQA,EAAMtzB,MACZ,IAAK,UACL,IAAK,OACH,OAAOszB,EACT,IAAK,sBAAuB,OACpB9yB,KAAKw2B,YAAY,CAAEr1B,GAAI2xB,EAAMjU,UACnC,MAAM9b,EAAM2zB,GAAAA,GAAer9B,MACzB2G,KAAK01B,YAAY,CAAEv0B,GAAI2xB,EAAMjU,WAE/B,MAAO,IACFiU,EACH6D,UAAW5zB,EAAIuY,WAAW,aAC1Bsb,aAAc7zB,EAAIuxB,KAAK,gB,EAI/B,EACAuC,QAAAA,CAAShB,GACP,OAAQA,EAAUr2B,MAChB,IAAK,UACH,OAAOq2B,EAAU5D,IACnB,IAAK,sBACH,OAAO4D,EAAUe,aACnB,QACE,MAAO,GAEb,EACAE,SAAAA,CAAUjB,GACR,OAAQA,EAAUr2B,MAChB,IAAK,UACH,MAAO,gBACT,IAAK,sBACH,OAAOq2B,EAAUc,UACnB,QACE,MAAO,GAEb,EACAb,gBAAAA,CAAiBD,GACf,IAAK71B,KAAKsI,MAAMyuB,iBAKd,YAJAn9B,QAAQgjB,KACN,4GAOJ5c,KAAKw1B,qBAAqBtU,aAC1BlhB,KAAKk1B,QAAQ8B,UAIb,MAAMC,EAAgB1lB,SAASkI,cAAc,YAC7Cwd,EAAcC,UAAUC,IAAI,WAAY,aACvCn3B,KAAKsI,MAAMyuB,iBAAoCK,YAC9CH,GAIFj3B,KAAKk1B,QAASmC,EAAAA,GAAAA,YACZJ,EACA,CACEK,UAAW,CAAC,QAAS,WACrBC,QAAS,CACP,CACEpwB,IAAKnH,KAAK62B,SAAShB,GACnBr2B,KAAMQ,KAAK82B,UAAUjB,KAGzB2B,UAAU,EACVC,WAAY,CACVC,SAAU,CACR,aACA,kBACA,qBACA,cACA,kBACA,cACA,oBAEFC,YAAa,CACXC,QAAQ,IAGZ7E,SAAU/yB,KAAKoJ,KAAK2pB,WAAa/yB,KAAKmR,OAEtC0mB,MAAO73B,KAAKoJ,KAAK2pB,WAAa/yB,KAAKmR,QAErCnR,KAAKy2B,eAEPz2B,KAAKk1B,OAAO4C,GAAG,cAAc,KAC3B,MAAM/C,EAAO/0B,KAAKk1B,OAAQ6C,cACtBhD,IACF/0B,KAAK4Q,MAAM,aAAcmkB,GACzB/0B,KAAK+0B,KAAOA,EACR/0B,KAAKo1B,YAAcp1B,KAAKk1B,OAAQ8C,WAElCh4B,KAAKm1B,WAAa3qB,KAAKjE,IAAIvG,KAAKm1B,WAAYJ,I,IAIlD/0B,KAAKk1B,OAAO4C,GAAG,kBAAkB,KAC/B93B,KAAKm1B,WAAan1B,KAAKoJ,KAAK4pB,QAC5BhzB,KAAKk1B,OAAQ6C,YAAY/3B,KAAKoJ,KAAK4pB,SAC/BhzB,KAAKoJ,KAAK2pB,WAAa/yB,KAAKmR,QAC9BnR,KAAKk1B,OAAQ+C,OAEfj4B,KAAK4Q,MAAM,iBAAkB,CAC3BtG,OAAQtK,KAAKk1B,OAAQgD,YAAc,GACnC,IAEJl4B,KAAKk1B,OAAO4C,GAAG,WAAW,KACxB93B,KAAKo1B,WAAY,CAAI,IAEvBp1B,KAAKk1B,OAAO4C,GAAG,CAAC,UAAW,UAAU,KACnC93B,KAAKo1B,WAAY,CAAK,IAGxB,MAAM+C,EAA4BA,KACI,qBAAhCn4B,KAAKoJ,KAAK6pB,kBAERjzB,KAAKk1B,OAAQ6C,cAAiB/3B,KAAKm1B,WAAa,IAClDn1B,KAAKk1B,OAAQ6C,YAAY/3B,KAAKm1B,YAGA,kCAAhCn1B,KAAKoJ,KAAK6pB,mBAGNzoB,KAAK4tB,IAAIp4B,KAAKk1B,OAAQ6C,cAAiB/3B,KAAKm1B,YAAc,IAC5Dn1B,KAAKk1B,OAAQ6C,YAAY/3B,KAAKm1B,W,EAIpCn1B,KAAKk1B,OAAO4C,GAAG,WAAW,KACnB93B,KAAKmR,QACRgnB,G,IAGJn4B,KAAKk1B,OAAO4C,GAAG,UAAU,KAClB93B,KAAKmR,QACRgnB,G,IAMJ,MAAME,EAAiBpB,EAAcqB,uBACnC,uBAEIC,EAAiBF,EAAexyB,KAAK,GACtC0yB,GAGHv4B,KAAKw1B,oBAAsB,IAAIgD,gBAAgB3e,IAC7C,MAAMqJ,EAAOljB,KAAKsI,MAAM4a,KAClBuV,EAAWvV,EAAKlV,wBAAwBrQ,EACxC+6B,EAAqBH,EAAevqB,wBAAwBrQ,EAC5DwkB,EAASuW,EAAqBD,EACpCz4B,KAAKq1B,sBAAsBE,cAAgBpT,EAC3CniB,KAAKq1B,sBAAsBC,YAAciD,EAAevtB,WAAW,IAErEhL,KAAKw1B,oBAAoBnU,QAAQkX,IAVjC3+B,QAAQoS,MAAM,2BAYlB,EACAwjB,mBAAAA,CAAoBN,GAClBlvB,KAAKowB,kBAAoBlB,EACzBlvB,KAAKk1B,OAAQmB,OACf,EACAhG,gBAAAA,GACErwB,KAAKowB,uBAAoB90B,CAC3B,EACAm0B,eAAAA,CAAgBP,GACdlvB,KAAKmR,OAAQse,gBAAgBP,EAAY/tB,GAC3C,EACA6uB,yBAAAA,CAA0BiF,GAKxB,IAAKj1B,KAAKmR,OACR,OAEF,MAAM,MAAE5M,EAAK,OAAEga,EAAM,YAAE2Q,GAAgB+F,EACvCj1B,KAAKmR,OAAO6d,kBAAkBE,EAAY/tB,IAC1CnB,KAAKif,UAAY,CACfzf,KAAM,oBACNm5B,cAAezJ,EAAY/tB,GAC3By3B,cAAe,CAACr0B,EAAM0J,QAAS1J,EAAM4J,SACrC0qB,oBAAqB,CAAC3J,EAAYvxB,EAAGuxB,EAAYrxB,GACjDi7B,qBAAsB,CAAC5J,EAAY7nB,MAAO6nB,EAAY5nB,QACtDiX,UAEDha,EAAME,OAAuBqe,kBAAkBve,EAAMwe,UACxD,EACAmN,uBAAAA,CAAwB+E,GAKtBj1B,KAAKif,eAAY3jB,EAChB25B,EAAQ1wB,MAAME,OAAuBue,sBACpCiS,EAAQ1wB,MAAMwe,UAElB,EACAkN,yBAAAA,CAA0BgF,GAKxB,MAAM,MAAE1wB,EAAK,OAAEga,EAAM,YAAE2Q,GAAgB+F,EACvC,GAC2B,sBAAzBj1B,KAAKif,WAAWzf,MAChBQ,KAAKif,UAAU0Z,gBAAkBzJ,EAAY/tB,GAC7C,CACA,MAAM8hB,EACJjjB,KAAKsI,MAAM4a,KACXlV,yBAGA6qB,qBAAsBvU,EAAUC,GAChCuU,sBAAuBtU,EAAcC,IACnCzkB,KAAKif,UACT,IAAIyF,EAAOJ,EACPK,EAAWH,EACXI,EAAOL,EACPM,EAAYJ,EAGhB,MAAMsU,EAAWx0B,EAAM0J,QAAUgV,EAAS5b,MACpCyd,EAAkBvgB,EAAM0J,QAAUjO,KAAKif,UAAU2Z,cAAc,GAC/D7T,EAAYD,EAAkB7B,EAAS5b,MAGvC2d,GADWzgB,EAAM4J,QAAU8U,EAAS3b,OAClB/C,EAAM4J,QAAUnO,KAAKif,UAAU2Z,cAAc,IAC/D3T,EAAYD,EAAkB/B,EAAS3b,OAIhC,SAAXiX,GACW,aAAXA,GACW,gBAAXA,EAEIwa,EAAWzU,EAAWE,GACxBE,EAAOJ,EAAWE,EAClBG,EAAWoU,EAAWrU,IAEtBA,EAAOJ,EAAWS,EAClBJ,EAAWH,EAAeO,GAGjB,UAAXxG,GACW,cAAXA,GACW,iBAAXA,IAEIwa,EAAWzU,GACbI,EAAOqU,EACPpU,EAAWL,EAAWyU,IAEtBrU,EAAOJ,EACPK,EAAWH,EAAeO,IAMjB,aAAXxG,GACW,QAAXA,GACW,cAAXA,EAQI0G,EAAYR,GACdG,EAAOL,EAAWE,EAClBI,EAAYI,EAAYR,IAExBG,EAAOL,EAAWU,EAClBJ,EAAYJ,EAAgBQ,GAGnB,gBAAX1G,GACW,WAAXA,GACW,iBAAXA,KAGK0G,EAAYR,GACfG,EAAOL,EAAWE,EAAgBQ,EAClCJ,GAAaI,EAAYR,IAEzBG,EAAOL,EACPM,EAAYJ,EAAgBQ,IAKhC,IAAIC,EAAiBgK,EAAY5nB,OAC/B6d,EAAgB+J,EAAY7nB,MAC5B+d,EAAY8J,EAAYvxB,EACxB0nB,EAAY6J,EAAYrxB,EACtBgnB,EAAY,MACdK,EAAiBL,EACjBQ,EAAYT,GAEVD,EAAW,MACbQ,EAAgBR,EAChBS,EAAYV,GAId,MAAMe,EACJL,EAAY,KAAQA,EAAYD,EAAgB,IAC5CO,EACJL,EAAY,IAAOA,EAAYH,EAAiB,IAC9CO,IACFL,EAAY8J,EAAYvxB,EACxBwnB,EAAgB+J,EAAY7nB,OAE1Bqe,IACFL,EAAY6J,EAAYrxB,EACxBqnB,EAAiBgK,EAAY5nB,QAG/BtH,KAAKmR,OAAQ6nB,cACX9J,EAAY/tB,GACZikB,EACAC,EACAF,EACAD,EACAllB,KAAKif,WAEPuC,IAAgB4C,Q,CAEpB,EACAwL,wBAAAA,CAAyBrrB,EAAqB2qB,GACvClvB,KAAKmR,SAGVnR,KAAKmR,OAAO6d,kBAAkBE,EAAY/tB,IAC1CnB,KAAKif,UAAY,CACfzf,KAAM,kBACNm5B,cAAezJ,EAAY/tB,GAC3By3B,cAAe,CAACr0B,EAAM0J,QAAS1J,EAAM4J,SACrC0qB,oBAAqB,CAAC3J,EAAYvxB,EAAGuxB,EAAYrxB,IAElD0G,EAAME,OAAuBqe,kBAAkBve,EAAMwe,WACxD,EACA+M,sBAAAA,CAAuBvrB,EAAqB2qB,GAC1ClvB,KAAKif,eAAY3jB,EAChBiJ,EAAME,OAAuBue,sBAAsBze,EAAMwe,UAC5D,EACA8M,wBAAAA,CAAyBtrB,EAAqB2qB,GAC5C,GAC2B,oBAAzBlvB,KAAKif,WAAWzf,MAChBQ,KAAKif,UAAU0Z,gBAAkBzJ,EAAY/tB,GAC7C,CACA,MAAM8hB,EACJjjB,KAAKsI,MAAM4a,KACXlV,wBACIirB,EAAgB10B,EAAM6e,cAEtBC,EAAW9e,EAAM0J,QAAUjO,KAAKif,UAAU2Z,cAAc,GACxDtV,EAAaD,EAAWJ,EAAS5b,MACjCkc,EAAYvjB,KAAKif,UAAU4Z,oBAAoB,GAAKvV,EACpD4V,EAAmBD,EAAcjuB,YAAciY,EAAS5b,MACxDoc,EAAO,IAAOyV,EACdxV,EAAO,IACPC,EAAmBnZ,KAAKlE,IAAIod,EAAMlZ,KAAKjE,IAAIkd,EAAMF,IAEjDK,EAAWrf,EAAM4J,QAAUnO,KAAKif,UAAU2Z,cAAc,GACxD/U,EAAaD,EAAWX,EAAS3b,OACjCwc,EAAY9jB,KAAKif,UAAU4Z,oBAAoB,GAAKhV,EACpDsV,EAAoBF,EAAchuB,aAAegY,EAAS3b,OAC1D0c,EAAO,IAAOmV,EACdlV,EAAO,GACPC,EAAmB1Z,KAAKlE,IAAI2d,EAAMzZ,KAAKjE,IAAIyd,EAAMF,IAEjD3iB,EAAKnB,KAAKif,UAAU0Z,cAC1B34B,KAAKmR,QAAQioB,gBACXj4B,EACAwiB,EACAO,EACAlkB,KAAKif,WAEPuC,IAAgB4C,Q,CAEpB,EACA+K,iCAAAA,CACED,GAEA,MAAMmK,EACJnK,EAAYwB,WAAa1wB,KAAKk1B,QAAQgD,YAAc,GAChDoB,EACJt5B,KAAKq1B,sBAAsBC,YAAc+D,EAC3C,MAAO,CACLnrB,KAAM,QAAQlO,KAAKq1B,sBAAsBE,8BACvC+D,gBAEN,EACAlK,wBAAAA,CAAyBF,GACvBlvB,KAAKmR,QAAQ6d,kBAAkBE,EAAY/tB,IAE3C,MAAMo4B,EAAmBA,KACvB,MAAMjD,EAAqB/kB,SAASsQ,eAClC,eAAe7hB,KAAK8d,OAAOoR,EAAY/tB,MAEzCm1B,EAAmBxoB,MAAM,CACvB0rB,cAAc,GACP,EAENx5B,KAAK2vB,oBAAoBriB,SAAS4hB,GAQrCqK,IANAv5B,KAAKk1B,OAAQuE,IAAI,UAAU,KAEzBz5B,KAAK2hB,UAAU4X,EAAiB,IAQpC,MAAMG,EAAQ,GACRC,EAAa35B,KAAKk1B,OAAQ6C,cAAiB7I,EAAYwB,WACzDiJ,EAAa,GAAKA,EAAaD,IACjC15B,KAAKk1B,OAAQ6C,YAAY7I,EAAYwB,UAAYgJ,EAAQ,EAE7D,GAEFE,aAAAA,GACE55B,KAAKw1B,qBAAqBtU,YAC5B,IS/nBF,MAAM,IAA2B,OAAgB,GAAQ,CAAC,CAAC,SAAS,IAAQ,CAAC,YAAY,qBAEzF,UCRA,MACM1gB,GAAa,CCkYN3B,MAAM,cDjYb6B,GAAa,CAAC,UAAW,SACzBW,GAAa,CCmaRxC,MAAM,yBDlaX4C,GAAa,CAAC,SACdC,GAAa,CC4aJ7C,MAAM,sBD3af8C,GAAa,CAAC,UAAW,gBAAiB,gBAAiB,eAC3DC,GAAa,CCobC/C,MAAM,8BDnbpBgD,GAAa,CAAC,QAAS,WACvBC,GAAa,CAAC,gBAAiB,gBAAiB,eAChDC,GAAc,CAAC,gBAAiB,gBAAiB,eACjDC,GAAc,CCwdXE,MAAA,2CDtdH,SAAU3B,GAAOxB,EAAUgG,EAAY6B,EAAYC,EAAYC,EAAWC,GAC9E,OAAQ/B,EAAAA,EAAAA,OC8WRrG,EAAAA,EAAAA,IAmHM,OAnHDoE,IAAI,OAAOlE,MAAM,gBD3WpBg7B,kBAAmB90B,EAAO,KAAOA,EAAO,GAE5C,IAAInI,ICyWuDmC,EAAA+6B,oBAAA/6B,EAAA+6B,sBAAAl9B,KDxWtD,ECyWD6D,EAAAA,EAAAA,IAgCM,OA/BJ5B,MAAM,gBACNkE,IAAI,eACH0L,cAAW1J,EAAA,KAAAA,EAAA,GDtWlB,IAAInI,ICsWgBmC,EAAAg7B,mBAAAh7B,EAAAg7B,qBAAAn9B,KDrWb,GACAoI,EAAAA,EAAAA,KAAW,ICsWZrG,EAAAA,EAAAA,IAUMgC,EAAAA,GAAA,MAAAC,EAAAA,EAAAA,IAVqC7B,EAAAi7B,WAAS,CAA1BC,EAAOv2B,MDrWvBsB,EAAAA,EAAAA,OCqWVrG,EAAAA,EAAAA,IAUM,OAVDE,MAAM,OAA4CkC,IAAK2C,GDlWvD,ECmWHjD,EAAAA,EAAAA,IAEM,MAFND,IAEM2E,EAAAA,EAAAA,IADDzB,EAAQ,IAAM,EAAI3E,EAAAm7B,qBAAqBD,GAAS,KAAJ,IAEjDx5B,EAAAA,EAAAA,IAKO,OAJL5B,OAAKC,EAAAA,EAAAA,IAAA,CAAC,YAAW,CDnWfq7B,MCoW2Bz2B,EAAK,UDlW/B,KAAM,QAET,QACHsB,EAAAA,EAAAA,KAAW,ICoWZrG,EAAAA,EAAAA,IAeUgC,EAAAA,GAAA,MAAAC,EAAAA,EAAAA,IAdc7B,EAAA4wB,qBAAfT,KDpWClqB,EAAAA,EAAAA,OCmWVrG,EAAAA,EAAAA,IAeU,UAbPoC,IAAKmuB,EAAY/tB,GAClBtC,MAAM,qBACLqD,OAAKsM,EAAAA,EAAAA,IAAEzP,EAAAq7B,uBAAuBlL,IAC9BzgB,cAAW1J,EAAA,KAAAA,EAAA,IAAAG,EAAAA,EAAAA,KAAZ,QAAiB,WAChBlE,SAAKkE,EAAAA,EAAAA,KAAAjE,IAAkBlC,EAAAs7B,mBAAmBnL,GAAwBnwB,EAAA6R,MAAK,eAAiBse,EAAYwB,UAAS,MDjW3G,CAAC,SCqWHnxB,MAAkBR,EAAApD,SAAQ,gCDlWvBuzB,YCkWmFnwB,EAAAswB,qBAAqBH,MD/VzG,KAAM,GAAIxuB,OACX,OACH,MCoWHD,EAAAA,EAAAA,IAoEM,OAnEJ5B,OAAKC,EAAAA,EAAAA,IAAA,CAAC,WAAU,gBACmC,gBADnC,KACemgB,WAAWzf,QAC1CuD,IAAI,WACH0L,cAAW1J,EAAA,KAAAA,EAAA,IAAAG,EAAAA,EAAAA,KDlWlB,IAAItI,ICkWqBmC,EAAAg7B,mBAAAh7B,EAAAg7B,qBAAAn9B,IAAiB,WACnC09B,QAAKv1B,EAAA,KAAAA,EAAA,GDhWZ,IAAInI,ICgWUmC,EAAAu7B,SAAAv7B,EAAAu7B,WAAA19B,IACP29B,cAAWx1B,EAAA,KAAAA,EAAA,IAAAG,EAAAA,EAAAA,KAAZ,QAAoB,eD/VnB,ECiWDzE,EAAAA,EAAAA,IAkDM,MAlDNY,GAkDM,GDjZH2D,EAAAA,EAAAA,KAAW,ICgWZrG,EAAAA,EAAAA,IAgDMgC,EAAAA,GAAA,MAAAC,EAAAA,EAAAA,IA/CkB7B,EAAA4wB,qBAAfT,KDhWClqB,EAAAA,EAAAA,OC+VVrG,EAAAA,EAAAA,IAgDM,OA9CHoC,IAAKmuB,EAAY/tB,GAClBtC,OAAKC,EAAAA,EAAAA,IAAA,CAAC,uBAAsB,CD/V1B3C,SCgW8B4C,EAAAgwB,wBAA0BG,EAAY/tB,MAGrEe,OAAKsM,EAAAA,EAAAA,IAAEzP,EAAAy7B,yBAAyBtL,IAChC3vB,MAAOR,EAAAswB,qBAAqBH,IDhW1B,ECkWHzuB,EAAAA,EAAAA,IAyBM,MAzBNiB,GAyBM,EAxBJjB,EAAAA,EAAAA,IAYS,UAXPjB,KAAK,SACLX,OAAKC,EAAAA,EAAAA,IAAA,CAAC,4BACEC,EAAAm0B,mBAAmBhE,KAC1BluB,SAAKkE,EAAAA,EAAAA,KAAAjE,GAAOlC,EAAAs7B,mBAAmBnL,IAAW,UAC1CzgB,cAAWxN,GAAElC,EAAA6wB,yBAAyB3uB,EAAQiuB,GAC9ChR,cAAWjd,GAAElC,EAAA8wB,yBAAyB5uB,EAAQiuB,GAC9C9Q,YAASnd,GAAElC,EAAA+wB,uBAAuB7uB,EAAQiuB,IDjWxC,ECmWHzuB,EAAAA,EAAAA,IAEO,OAFPmB,IAEOuD,EAAAA,EAAAA,IADFpG,EAAAswB,qBAAqBH,IAAW,IDlWlC,GAAIvtB,IC8WDutB,EAAYyB,QAAU5xB,EAAA07B,cD5WvBz1B,EAAAA,EAAAA,OCuWPrG,EAAAA,EAAAA,IAMU,UD5WFoC,IAAK,ECuWXvB,KAAK,SACLX,MAAM,wCACLU,MAAOR,EAAApD,SAAS,WAChBqF,QAAKC,GAAElC,EAAA6R,MAAM,oBAAqBse,EAAY/tB,KDrWxC,KAAM,EAAGU,MACZ8E,EAAAA,EAAAA,IAAoB,IAAI,MCwWhClG,EAAAA,EAAAA,IAKO,OAJL5B,MAAM,gCACL4P,cAAWxN,GAAElC,EAAA27B,8BAA8Bz5B,EAAQiuB,GACnDhR,cAAWjd,GAAElC,EAAA47B,8BAA8B15B,EAAQiuB,GACnD9Q,YAASnd,GAAElC,EAAA67B,4BAA4B35B,EAAQiuB,IDrW7C,KAAM,GAAIptB,KCuWfrB,EAAAA,EAAAA,IAKO,OAJL5B,MAAM,8BACL4P,cAAWxN,GAAElC,EAAA87B,4BAA4B55B,EAAQiuB,GACjDhR,cAAWjd,GAAElC,EAAA+7B,4BAA4B75B,EAAQiuB,GACjD9Q,YAASnd,GAAElC,EAAAg8B,0BAA0B95B,EAAQiuB,IDrW3C,KAAM,GAAIntB,KACZ,GAAIN,OACL,SCwWNhB,EAAAA,EAAAA,IAOE,OANA5B,MAAM,cACN8D,UAAU,OACTmQ,YAAS/N,EAAA,KAAAA,EAAA,GDpWlB,IAAInI,ICoWgBmC,EAAAi8B,uBAAAj8B,EAAAi8B,yBAAAp+B,IACXsF,OAAKsM,EAAAA,EAAAA,IAAA,CDnWJN,KCmWwBnP,EAAAk8B,yBDjWzB,KAAM,KACR,KCqWHx6B,EAAAA,EAAAA,IAWM,MAXNuB,IAWMmD,EAAAA,EAAAA,IAAA,CD9WA+1B,cCqWUn8B,EAAAm8B,cDpWVC,gBCoWmCp8B,EAAAo8B,gBDnWnCC,qBCmW8Dr8B,EAAAq8B,qBDlW9DC,cCkW8Ft8B,EAAAs8B,cDjW9FZ,YCiWuH17B,EAAA07B,YDhWvHxb,UCgWyJlgB,EAAAkgB,YD/VvJ,IACP,IACL;;;;;;;;;;;;;;;AE5Hc,SAAUqc,GACtB7jC,EACA8jC,GAEA,GAAI9jC,EAAQ+jC,WAAY,CACtB,MAAMC,EAAiBC,WACrB5/B,OAAO+c,iBAAiBphB,EAAQ+jC,YAAuB9wB,UAEnDixB,EAAkBD,WACtB5/B,OAAO+c,iBAAiBphB,GAASiT,UAE7BkxB,EACHD,EAAkBF,EAAkBE,EACvC,OAAOJ,EAAaK,C,CAGxB,C,0BC7BM,SAAU1B,GACd2B,EACAC,GAA4B,EAC5BC,EAAoB,KAEpB,IAAIC,EAAQ,EACVC,EAAU,EACVC,EAAU,EACVC,EAAe,EACjB,MAAON,GAAoB,KACzBG,IACAH,GAAoB,KAEtB,MAAOA,GAAoB,GACzBI,IACAJ,GAAoB,GAEtB,MAAOA,GAAoB,EACzBK,IACAL,GAAoB,EAGtB,SAASO,EAAU7e,GACjB,OAAOA,EAAE8e,eAAe,QAAS,CAC/BC,qBAAsB,EACtBC,sBAAuB,GAE3B,CANAJ,EAAe3xB,KAAKC,MAAyB,IAAnBoxB,GAO1B,MAAMW,EAAQ,GAAGJ,EAAUJ,KAASD,IAAYK,EAC9CH,KACEF,IAAYK,EAAUF,KAC1B,GAAIJ,EAAkB,CACpB,MAAMW,EAAOD,EAAME,OAAO,GAAGX,IAAYK,EAAUD,MACnD,OAAOM,C,CAEP,OAAOD,CAEX,CFTA,QAAep9B,EAAAA,EAAAA,IAAgB,CAC7B8B,KAAM,gBACNqB,KAAAA,GACE,MAAO,CACL4O,QAAQ9R,EAAAA,EAAAA,IACNs1B,IAGN,EACAr1B,MAAO,CACLy4B,YAAa,CACXv4B,KAAMmI,OACNjI,UAAU,GAEZi9B,cAAe,CACbn9B,KAAMzE,OACN2E,UAAU,GAEZ0J,KAAM,CACJ5J,KAAMzE,OACN2E,UAAU,GAEZqvB,sBAAuB,CACrBvvB,KAAMC,OACNC,UAAU,IAGdG,IAAAA,GACE,MAAO,CACLof,eAAW3jB,EACX4/B,cAAe,CAAE0B,EAAG,EAAGC,EAAG,GAC1B1B,gBAAiB,EAErB,EACA9jC,OAAAA,GAGE,MAAMwpB,EAAW,IAAIC,sBAAqB,IACxC9gB,KAAK88B,2BAEPjc,EAASQ,QAAQrhB,KAAKsI,MAAMy0B,cAG5B,MAAMC,EAAgBhkC,IACpB,MAAMikC,EAAWj9B,KAAKk9B,gBAAgBlkC,EAAG2S,IACnCwxB,EAAYn9B,KAAKk7B,cAAc0B,EAAIK,EACzCj9B,KAAKk7B,cAAc0B,EAAI58B,KAAKo9B,uBAAuBD,EAAU,EAEzDE,GAAeC,EAAAA,GAAAA,KAClB33B,QAAQpB,GAC0B,IAAzBA,EAAcg5B,SAEvBzF,GAAG,SAAS,KACX93B,KAAKif,UAAY,CAAEzf,KAAM,cAAe,IAEzCs4B,GAAG,OAAQkF,GACXlF,GAAG,OAAO,KACT93B,KAAKif,eAAY3jB,CAAS,KAE9BkiC,EAAAA,GAAAA,GAAOx9B,KAAKsI,MAAMm1B,UAAyBviC,KAAKmiC,EAClD,EACAtjC,MAAO,CAELg+B,WAAAA,CAAYA,IACNA,EAAc/3B,KAAKq7B,eAAiBtD,EAAc/3B,KAAKy6B,eACzDz6B,KAAKk7B,cAAc0B,EAAI58B,KAAKo9B,uBAAuBrF,EAAc,IAErE,GAEF13B,SAAU,CACRsvB,mBAAAA,GACE,MAAMA,EAAqC,GAC3C,IAAK,IAAI9jB,KAAK7L,KAAKoJ,KAAK6lB,aAAc,CACpC,MAAMyO,EACJ7xB,EAAE6kB,UAAY1wB,KAAKy6B,aAAe5uB,EAAE8kB,QAAU3wB,KAAKq7B,cAI/CsC,GACsB,gBAAzB39B,KAAKif,WAAWzf,MACU,qBAAzBQ,KAAKif,WAAWzf,MACS,mBAAzBQ,KAAKif,WAAWzf,OAClBQ,KAAKif,UAAU9d,KAAO0K,EAAE1K,IACtBu8B,GAAoBC,IACtBhO,EAAoBnuB,KAAKqK,E,CAG7B,OAAO8jB,CACT,EACAyL,oBAAAA,GACE,MAAMwC,EAAe,GAAM59B,KAAKk7B,cAAc2B,EAC9C,OAAO78B,KAAKm7B,gBAAkByC,CAChC,EACAvC,aAAAA,GACE,OAAOr7B,KAAKk7B,cAAc0B,CAC5B,EACAnC,WAAAA,GACE,OAAOz6B,KAAKq7B,cAAgBr7B,KAAKo7B,oBACnC,EACAH,qBAAAA,GACE,MAAO,GAAGj7B,KAAK69B,4BAA4B79B,KAAK+3B,eAClD,EACAiC,SAAAA,GACE,MAAM7kB,EAAS,GACT3D,EAAQxR,KAAKq7B,cACb3pB,EAAM1R,KAAKy6B,YACXqD,EAAkB,GACxB,IAAK,IAAIjyB,EAAI,EAAGA,EAAIsJ,EAAQtJ,IAC1BiyB,EAAMt8B,KAAKgQ,GAAUE,EAAMF,GAAS2D,EAAUtJ,GAGhD,OADAiyB,EAAMt8B,KAAKkQ,GACJosB,CACT,GAEF31B,QAAS,CACP+qB,mBAAkB,GAClB7D,qBAAoB,GACpB1zB,SAAQ,KACRkiC,2BAAAA,CAA4B3B,GAC1B,MAAM6B,EAAS7B,EAAUl8B,KAAKq7B,cAC9B,OAAQ0C,EAAS/9B,KAAKo7B,qBAAwB,GAChD,EACAhB,sBAAAA,CACElL,GAEA,MAAO,CACLhhB,KAAM,GAAGlO,KAAK69B,4BAA4B3O,EAAYwB,cAE1D,EACAsN,IAAAA,CAAKtE,EAAe3E,GACbA,IACHA,GAAQ/0B,KAAKq7B,cAAgBr7B,KAAKy6B,aAAe,GAGnD,MAAMwD,EAAiBj+B,KAAKk7B,cAAc0B,EACpCsB,EAAiBl+B,KAAKo7B,qBAGtB+C,EAAM3zB,KAAK2zB,IAAIzE,GACf0E,EAAOp+B,KAAKk7B,cAAc2B,EAAIsB,EAEpCn+B,KAAKk7B,cAAc2B,EAAIryB,KAAKjE,IAAI,KAAOiE,KAAKlE,IAAI,EAAG83B,IAMnD,MAAMC,EAAiBr+B,KAAKo7B,qBACtBkD,EACJvJ,GAASA,EAAOkJ,GAAkBC,EAAkBG,EAEtDr+B,KAAKk7B,cAAc0B,EAAI58B,KAAKo9B,uBAAuBkB,EACrD,EACAhE,OAAAA,CAAQ/1B,GACNA,EAAMgJ,iBACN,MAAMqvB,EAAI58B,KAAKu+B,kBAAkBh6B,EAAM0J,SACjCyrB,GAASn1B,EAAMi6B,OAAS,IAC9Bx+B,KAAKg+B,KAAKtE,EAAOkD,EACnB,EACAQ,sBAAAA,CAAuBR,GACrB,OAAOpyB,KAAKjE,IAAI,EAAGiE,KAAKlE,IAAItG,KAAK28B,cAAcryB,OAAQsyB,GACzD,EACA6B,UAAAA,CAAWC,GACT,MAAMjB,EAAWz9B,KAAKsI,MAAMy0B,aAC5B,OAAKU,EAIHnC,GAAsBt7B,KAAKsI,MAAMy0B,aAA6B2B,IAC9DC,IAJO,CAMX,EACA7B,sBAAAA,GACE,MAAM8B,EAAO5+B,KAAKsI,MAAMy0B,aACxB,IAAK6B,EAEH,YADAhlC,QAAQgjB,KAAK,gDAGf,MAAM7O,EAAO6wB,EAAK5wB,wBACZ6wB,EAAY7+B,KAAKy+B,WAAW1wB,EAAK1G,OACvCrH,KAAKm7B,gBAAkB0D,CACzB,EACA3E,qBAAoB,GACpBgD,eAAAA,CAAgBwB,GACd,MAAM3wB,EACJ/N,KAAKsI,MAAMy0B,aACX/uB,wBACI8wB,EAAWJ,EAAS3wB,EAAK1G,MAC/B,OAAOy3B,EAAW9+B,KAAKo7B,oBACzB,EAKAmD,iBAAAA,CAAkBtwB,GAChB,MAAMF,EACJ/N,KAAKsI,MAAMy0B,aACX/uB,wBACIrQ,EAAIsQ,EAAUF,EAAKG,KACnBqV,EAAY5lB,EAAIoQ,EAAK1G,MACrB0tB,EAAO/0B,KAAKq7B,cAAgB9X,EAAYvjB,KAAKo7B,qBAC7C2D,EAAcv0B,KAAKlE,IACvBtG,KAAK28B,cAAcryB,OACnBE,KAAKjE,IAAI,EAAGwuB,IAEd,OAAOgK,CACT,EACAvE,wBAAAA,CAAyBtL,GACvB,MAAM8P,EAAc9P,EAAYwB,UAAY1wB,KAAKq7B,cAC3C4D,EAAgBD,EAAch/B,KAAKo7B,qBAAwB,IAC3D8D,EAAYhQ,EAAYyB,QAAU3wB,KAAKq7B,cACvC8D,EAAcD,EAAYl/B,KAAKo7B,qBAAwB,IAC7D,MAAO,CACLltB,KAAM,GAAG+wB,KACT53B,MAAU83B,EAAaF,EAAhB,IAEX,EACA5E,kBAAAA,CAAmBnL,GACjBlvB,KAAK4Q,MAAM,mBAAoBse,EACjC,EACAU,wBAAAA,CAAyBrrB,EAAqB2qB,GAC5C,GAAqB,IAAjB3qB,EAAMg5B,OAGR,OAEF,MAAM6B,EAAoBlQ,EAAYyB,QAAUzB,EAAYwB,UAC5D1wB,KAAKif,UAAY,CACfzf,KAAM,cACN2B,GAAI+tB,EAAY/tB,GAChBy3B,cAAe,CAACr0B,EAAM0J,QAAS1J,EAAM4J,SACrCkxB,qBAAsBnQ,EAAYwB,UAClC4O,oBAAqBF,GAEtB76B,EAAME,OAAuBqe,kBAAkBve,EAAMwe,WACtD/iB,KAAKmR,OAAQ6d,kBAAkBE,EAAY/tB,GAC7C,EACA0uB,wBAAAA,CAAyBtrB,EAAqB2qB,GAC5C,GAC2B,gBAAzBlvB,KAAKif,WAAWzf,MAChBQ,KAAKif,UAAU9d,KAAO+tB,EAAY/tB,GAClC,CACA,MAAMo+B,EAAUh7B,EAAM0J,QAAUjO,KAAKif,UAAU2Z,cAAc,GACvD7qB,EACJ/N,KAAKsI,MAAMy0B,aACX/uB,wBACIwxB,EAAkBx/B,KAAKo7B,qBAAuBrtB,EAAK1G,MACnD41B,EAAWsC,EAAUC,EACrBtD,EAAUl8B,KAAKif,UAAUogB,qBAAuBpC,EAEhDwC,EACJz/B,KAAK28B,cAAcryB,OAAStK,KAAKif,UAAUqgB,oBACvCI,EAAiBl1B,KAAKjE,IAAI,EAAGiE,KAAKlE,IAAIm5B,EAASvD,IAC/C/6B,EAAKnB,KAAKif,UAAU9d,GAC1BnB,KAAKmR,OAAQwuB,wBACXx+B,EACAu+B,EACA1/B,KAAKif,U,CAGX,EACA6Q,sBAAAA,CAAuBvrB,EAAqB2qB,GAC1ClvB,KAAKif,eAAY3jB,EAChBiJ,EAAME,OAAuBue,sBAAsBze,EAAMwe,UAC5D,EACA2X,6BAAAA,CAA8B1hC,EAAkBk2B,GAC9ClvB,KAAKif,UAAY,CACfzf,KAAM,mBACN2B,GAAI+tB,EAAY/tB,GAChB4zB,KAAM7F,EAAYwB,WAEnB13B,EAAGyL,OAAuBqe,kBAAkB9pB,EAAG+pB,UAClD,EACA8X,2BAAAA,CAA4B7hC,EAAkBk2B,GAC5ClvB,KAAKif,UAAY,CACfzf,KAAM,iBACN2B,GAAI+tB,EAAY/tB,GAChB4zB,KAAM7F,EAAYyB,SAEnB33B,EAAGyL,OAAuBqe,kBAAkB9pB,EAAG+pB,UAClD,EACA4X,6BAAAA,CAA8B3hC,EAAkBk2B,GAC9C,GAC2B,qBAAzBlvB,KAAKif,WAAWzf,MAChBQ,KAAKif,UAAU9d,KAAO+tB,EAAY/tB,GAClC,CACA,MAAM87B,EAAWj9B,KAAKk9B,gBAAgBlkC,EAAG4mC,WACzC5/B,KAAKif,UAAU8V,MAAQkI,EACvB,MAAM4C,EAAcr1B,KAAKjE,IACvB,EACAiE,KAAKlE,IAAI4oB,EAAYyB,QAAU,EAAG3wB,KAAKif,UAAU8V,OAEnD/0B,KAAKmR,OAAQ2uB,0BACX5Q,EAAY/tB,GACZ,QACA0+B,EACA7/B,KAAKif,U,CAGX,EACA6b,2BAAAA,CAA4B9hC,EAAkBk2B,GAC5C,GAC2B,mBAAzBlvB,KAAKif,WAAWzf,MAChBQ,KAAKif,UAAU9d,KAAO+tB,EAAY/tB,GAClC,CACA,MAAM87B,EAAWj9B,KAAKk9B,gBAAgBlkC,EAAG4mC,WACzC5/B,KAAKif,UAAU8V,MAAQkI,EACvB,MAAMyC,EAAiBl1B,KAAKjE,IAC1B2oB,EAAYwB,UAAY,EACxBlmB,KAAKlE,IAAItG,KAAK28B,cAAcryB,OAAQtK,KAAKif,UAAU8V,OAErD/0B,KAAKmR,OAAQ2uB,0BACX5Q,EAAY/tB,GACZ,MACAu+B,EACA1/B,KAAKif,U,CAGX,EACA2b,2BAAAA,CAA4B5hC,EAAkBk2B,GAC5ClvB,KAAKif,eAAY3jB,EAChBtC,EAAGyL,OAAuBue,sBAAsBhqB,EAAG+pB,UACtD,EACAgY,yBAAAA,CAA0B/hC,EAAkBk2B,GAC1ClvB,KAAKif,eAAY3jB,EAChBtC,EAAGyL,OAAuBue,sBAAsBhqB,EAAG+pB,UACtD,EACAgX,iBAAAA,CAAkBt+B,GAChB,MAAMs5B,EAAO/0B,KAAKu+B,kBAAkB9iC,EAAEwS,SACtCjO,KAAK4Q,MAAM,eAAgBmkB,EAC7B,EACAiG,qBAAAA,CAAsBv/B,GACpBuE,KAAKif,UAAY,CAAEzf,KAAM,aAC3B,EACAs6B,kBAAAA,CAAmBr+B,GACjB,GAA6B,eAAzBuE,KAAKif,WAAWzf,KAAuB,CACzC/D,EAAE8R,iBACF,MAAMwnB,EAAO/0B,KAAKu+B,kBAAkB9iC,EAAEwS,SACtCjO,KAAK+/B,0BAA0BhL,E,CAEnC,EACAgL,2BAA2BC,EAAAA,EAAAA,WAAS,SAElCjL,GAEA/0B,KAAK4Q,MAAM,eAAgBmkB,EAC7B,GACA,QGjXJ,MAAM,IAA2B,OAAgB,GAAQ,CAAC,CAAC,SAAS,IAAQ,CAAC,YAAY,qBAEzF,UCPA,MACMv0B,GAAa,CCFZ3B,MAAM,mCDGP6B,GAAa,CACjBK,IAAK,ECC8BlC,MAAM,WDErCwC,GAAa,CCDHxC,MAAM,eDEhB4C,GAAa,CCEN5C,MAAM,6BDAb,SAAU0B,GAAOxB,EAAUgG,EAAY6B,EAAYC,EAAYC,EAAWC,GAC9E,MAAMk5B,GAA4BnxB,EAAAA,EAAAA,IAAkB,kBAC9CoxB,GAA2BpxB,EAAAA,EAAAA,IAAkB,iBAEnD,OAAQ9J,EAAAA,EAAAA,OCdRrG,EAAAA,EAAAA,IAyGM,MAzGN6B,GAyGM,EAxGJC,EAAAA,EAAAA,IAGK,WAAA0E,EAAAA,EAAAA,IAFApG,EAAApD,SAAS,gBAAiB,MAC5BwJ,EAAAA,EAAAA,IAAGpG,EAAAswB,qBAAqBtwB,EAAAwwB,sBAAuB,KAClD,GACYxwB,EAAAwwB,sBDYPvqB,EAAAA,EAAAA,OCZLrG,EAAAA,EAAAA,IAuDO,OAvDP+B,GAuDO,EAtDLD,EAAAA,EAAAA,IAqDW,WArDXY,GAqDW,EApDTZ,EAAAA,EAAAA,IAES,eAAA0E,EAAAA,EAAAA,IADJpG,EAAApD,SAAS,kBAAD,IAEb8E,EAAAA,EAAAA,IAgCM,MAhCNgB,GAgCM,EA/BJhB,EAAAA,EAAAA,IAWQ,eDAF0F,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,ICVlBpG,EAAApD,SAAS,UAAW,IACvB,IAAA0J,EAAAA,EAAAA,IAQE46B,EAAA,CDGIx6B,WCVK1G,EAAAohC,eDWL,sBAAuBp7B,EAAO,KAAOA,EAAO,GAAM9D,GCX7ClC,EAAAohC,eAAcl/B,GACtB,iBAAY8D,EAAA,KAAAA,EAAA,GAAGiH,GAAWjN,EAAAqhC,0BAA4Bp0B,GACvDnN,OAAKC,EAAAA,EAAAA,IAAA,CAAC,aAAY,CDYhBuhC,QCXiCthC,EAAAuhC,qBAAqBh2B,OAAM,KAG7D,eAAcvL,EAAAuhC,qBAAqBh2B,OAAS,GDWxC,KAAM,EAAG,CAAC,aAAc,QAAS,qBAErCtF,EAAAA,EAAAA,KAAW,ICVhBrG,EAAAA,EAAAA,IAMIgC,EAAAA,GAAA,MAAAC,EAAAA,EAAAA,IAJc7B,EAAAuhC,sBAATt0B,KDSKhH,EAAAA,EAAAA,OCXdrG,EAAAA,EAAAA,IAMI,KALFE,MAAM,mBAELkC,IAAKiL,IDWC7G,EAAAA,EAAAA,ICTJ6G,GAAK,MDUF,OCRRvL,EAAAA,EAAAA,IAWQ,eDDF0F,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,ICTlBpG,EAAApD,SAAS,SAAU,IACtB,IAAA0J,EAAAA,EAAAA,IAQE46B,EAAA,CDEIx6B,WCTK1G,EAAAwhC,aDUL,sBAAuBx7B,EAAO,KAAOA,EAAO,GAAM9D,GCV7ClC,EAAAwhC,aAAYt/B,GACpB,iBAAY8D,EAAA,KAAAA,EAAA,GAAGiH,GAAWjN,EAAAyhC,wBAA0Bx0B,GACrDnN,OAAKC,EAAAA,EAAAA,IAAA,CAAC,aAAY,CDWhBuhC,QCViCthC,EAAA0hC,mBAAmBn2B,OAAM,KAG3D,eAAcvL,EAAA0hC,mBAAmBn2B,OAAS,GDUtC,KAAM,EAAG,CAAC,aAAc,QAAS,uBAGvCtF,EAAAA,EAAAA,KAAW,ICThBrG,EAAAA,EAAAA,IAMIgC,EAAAA,GAAA,MAAAC,EAAAA,EAAAA,IAJc7B,EAAA0hC,oBAATz0B,KDQKhH,EAAAA,EAAAA,OCVdrG,EAAAA,EAAAA,IAMI,KALFE,MAAM,mBAELkC,IAAKiL,IDUC7G,EAAAA,EAAAA,ICRJ6G,GAAK,MDSF,OCPRvL,EAAAA,EAAAA,IAQQ,eDCFqF,EAAAA,EAAAA,KCNJrF,EAAAA,EAAAA,IAGE,SAFAjB,KAAK,WDOD,sBAAuBuF,EAAO,KAAOA,EAAO,GAAM9D,GCN7ClC,EAAAwwB,oBAAoBqB,iBAAgB3vB,IDOxC,KAAM,KAAM,CACb,CAACwF,EAAAA,GCRI1H,EAAAwwB,oBAAoBqB,qBDU3BzqB,EAAAA,EAAAA,ICTF,KACFhB,EAAAA,EAAAA,IAAGpG,EAAApD,SAAS,oBAAD,WDYbgL,EAAAA,EAAAA,IAAoB,IAAI,GCRiB,YAA7B5H,EAAAwwB,oBAAoB/vB,ODU/BwF,EAAAA,EAAAA,OCHH0B,EAAAA,EAAAA,IAOYg6B,EAAAA,GAAA,CAAA3/B,IAAA,KANVN,EAAAA,EAAAA,IAKM,cDDDuE,EAAAA,EAAAA,OCHH0B,EAAAA,EAAAA,IAGEw5B,EAAA,CAFCn/B,IAAG,GAAKhC,EAAAwwB,oBAAoBpuB,qBDI3BsE,WCHO1G,EAAAwwB,oBAAoB2B,gBDI3B,sBAAuBnsB,EAAO,KAAOA,EAAO,GAAM9D,GCJ3ClC,EAAAwwB,oBAAoB2B,gBAAejwB,IDKzC,KAAM,EAAG,CAAC,mBAEd,OCF2C,YAA7BlC,EAAAwwB,oBAAoB/vB,ODIlCwF,EAAAA,EAAAA,OCJPrG,EAAAA,EAAAA,IA2BWgC,EAAAA,GAAA,CAAAI,IAAA,MDtBFiE,EAAAA,EAAAA,OCJP0B,EAAAA,EAAAA,IAMYg6B,EAAAA,GAAA,QDDH17B,EAAAA,EAAAA,OCJP0B,EAAAA,EAAAA,KAIE6pB,EAAAA,EAAAA,IAFKxxB,EAAA4hC,kBAAkB5hC,EAAAwwB,oBAAoBh2B,eAAeyE,YAAS,CADlE+C,IAAG,GAAKhC,EAAAwwB,oBAAoBpuB,YAE5B5H,eAAgBwF,EAAAwwB,oBAAoBh2B,gBDI9B,KAAM,EAAG,CAAC,qBACZ,OCDUwF,EAAA6hC,sBAAsB7hC,EAAAwwB,oBAAoBh2B,eAAeyE,aDKjEgH,EAAAA,EAAAA,OCNXrG,EAAAA,EAAAA,IAkBWgC,EAAAA,GAAA,CAAAI,IAAA,KAbTN,EAAAA,EAAAA,IAEK,WAAA0E,EAAAA,EAAAA,IADApG,EAAApD,SAAS,aAAD,KDEFqJ,EAAAA,EAAAA,OCAX0B,EAAAA,EAAAA,IASYg6B,EAAAA,GAAA,QDRC17B,EAAAA,EAAAA,OCAX0B,EAAAA,EAAAA,KAOE6pB,EAAAA,EAAAA,IAJoBxxB,EAAAyxB,kBAAkBzxB,EAAAwwB,oBAAoBh2B,eAAeyE,YDDtE,CCDHa,MAAM,mBACLkC,IAAG,GAAKhC,EAAAwwB,oBAAoBpuB,YAI5BiI,KAAMrK,EAAAwwB,oBAAoBh2B,gBDAhB,KAAM,EAAG,CAAC,WACZ,QACF,MACHoN,EAAAA,EAAAA,IAAoB,IAAI,IAC3B,MACHA,EAAAA,EAAAA,IAAoB,IAAI,IAElC,CE1GM,SAAUpG,GAAOxB,EAAUgG,EAAY6B,EAAYC,EAAYC,EAAWC,GAC9E,OAAOjB,EAAAA,EAAAA,MAAiBd,EAAAA,EAAAA,OC4HxBrG,EAAAA,EAAAA,IAAiE,SAA1Da,KAAK,OD1HV,sBAAuBuF,EAAO,KAAOA,EAAO,GAAM9D,GC0HxBlC,EAAAmqB,UAASjoB,GAAG2W,OAAI7S,EAAA,KAAAA,EAAA,GDvH9C,IAAInI,ICuH4CmC,EAAA8hC,iBAAA9hC,EAAA8hC,mBAAAjkC,KDtH3C,KAAM,MAAO,CACd,CAACqJ,EAAAA,GCqHyBlH,EAAAmqB,YDnH9B,CCRA,QAAe9pB,EAAAA,EAAAA,IAAgB,CAC7B8B,KAAM,iBACN5B,MAAO,CACLmG,WAAY,CACVjG,KAAMmI,OACNjI,UAAU,IAGdG,IAAAA,GACE,MAAO,CACLqpB,UAAW,GAEf,EACAnvB,MAAO,CACL0L,WAAY,CACVsC,WAAW,EACXC,OAAAA,CAAQ3E,GACNrD,KAAKkpB,UAAYlpB,KAAK8gC,cAAcz9B,EACtC,GAEF09B,eAAAA,GACM/gC,KAAK+gC,2BAA2B/mC,MAClCgG,KAAK4Q,MAAM,eAAgB5Q,KAAK+gC,iBAEhC/gC,KAAK4Q,MAAM,oBAAgBtV,EAE/B,GAEF6M,QAAS,CACP04B,eAAAA,GACM7gC,KAAK+gC,2BAA2B/mC,OAElCgG,KAAKkpB,UAAYlpB,KAAK8gC,cAAc9gC,KAAKyF,YACzCzF,KAAK4Q,MAAM,oBAAgBtV,KAE3B0E,KAAK4Q,MAAM,oBAAqB5Q,KAAK+gC,iBACrC/gC,KAAK4Q,MAAM,oBAAgBtV,GAE/B,EAEAwlC,aAAAA,CAAc/L,GACZ,IAAIiH,EAAQ,EACVC,EAAU,EACVC,EAAU,EACVC,EAAe,EACjB,MAAOpH,GAAQ,KACbA,GAAQ,KACRiH,GAAS,EAEX,MAAOjH,GAAQ,GACbA,GAAQ,GACRkH,GAAW,EAEb,MAAOlH,GAAQ,EACbA,GAAQ,EACRmH,GAAW,EAGb,SAASE,EAAU7e,GACjB,OAAOA,EAAE8e,eAAe,QAAS,CAC/BC,qBAAsB,EACtBC,sBAAuB,GAE3B,CANAJ,EAAe3xB,KAAKC,MAAa,IAAPsqB,GAO1B,IAAIv3B,EAAS,GAAG4+B,EAAUJ,MAAUI,EAAUH,MAAYG,EACxDF,MACGE,EAAUD,KACf,OAAO3+B,CACT,GAEF6C,SAAU,CAKR0gC,eAAAA,GACE,MAAMC,EACJ,6CACIC,EAAoBD,EAAsBE,KAAKlhC,KAAKkpB,WAC1D,GAAI+X,EACF,OACmC,KAAjC/nB,SAAS+nB,EAAkB,IACM,GAAjC/nB,SAAS+nB,EAAkB,IAC3B/nB,SAAS+nB,EAAkB,IAC3B/nB,SAAS+nB,EAAkB,IAAM,IAQrC,MAAME,EACJ,qDACIC,EAAcD,EAAgBD,KAAKlhC,KAAKkpB,WAC9C,OAAKkY,GAAsC,IAAvBA,EAAY92B,OAW5B82B,EAAY,GAEe,KAA3BloB,SAASkoB,EAAY,IACM,GAA3BloB,SAASkoB,EAAY,IACrBloB,SAASkoB,EAAY,IAEdA,EAAY,GACa,GAA3BloB,SAASkoB,EAAY,IAAWloB,SAASkoB,EAAY,IAErDloB,SAASkoB,EAAY,IAnBrB,IAAIpnC,OACT2B,EAAAA,EAAAA,IACE,4EAmBR,KCpHJ,MAAM,IAA2B,OAAgB,GAAQ,CAAC,CAAC,SAAS,MAEpE,UHwHA,IAAeyD,EAAAA,EAAAA,IAAgB,CAC7B8B,KAAM,gCACN2P,WAAY,CAAEwwB,eAAc,GAAEvwB,cAAaA,GAAAA,GAC3CvO,KAAAA,GACE,MAAO,CACL4O,QAAQ9R,EAAAA,EAAAA,IACNs1B,IAGN,EACAr1B,MAAO,CACLiwB,oBAAqB,CACnB/vB,KAAMzE,OACN2E,UAAU,IAGdG,IAAAA,GACE,MAAO,CACLsgC,eAAgB,EAChBC,+BAA2B9kC,EAC3BilC,aAAc,EACdC,6BAAyBllC,EAE7B,EACA6M,QAAS,CACPy4B,sBAAqB,GACrBpQ,kBAAiB,GACjB70B,SAAQ,KACR0zB,qBAAoB,GACpBsR,kBAAiBA,IAEnB5mC,MAAO,CACLomC,cAAAA,CAAevnC,GAC4B,IAArCoH,KAAKsgC,qBAAqBh2B,SAE5BtK,KAAKuvB,oBAAoBmB,UAAY93B,GAEA,IAAnCoH,KAAKygC,mBAAmBn2B,SAE1BtK,KAAKuvB,oBAAoBoB,QAAU3wB,KAAKugC,aAE5C,EACA,gCAAiC,CAC/Bv4B,QAAS,SAAUpP,GACjBoH,KAAKmgC,eAAiBvnC,CACxB,EACAmP,WAAW,GAEbw4B,YAAAA,CAAa3nC,GAC4B,IAAnCoH,KAAKygC,mBAAmBn2B,SAE1BtK,KAAKuvB,oBAAoBoB,QAAU/3B,EAQM,IAArCoH,KAAKsgC,qBAAqBh2B,SAE5BtK,KAAKuvB,oBAAoBmB,UAAY1wB,KAAKmgC,gBAGhD,EACA,8BAA+B,CAC7Bn4B,QAAS,SAAUpP,GACjBoH,KAAKugC,aAAe3nC,CACtB,EACAmP,WAAW,IAGf1H,SAAU,CACRigC,oBAAAA,GACE,MAAMxlB,EAAmB,GAWzB,OAVI9a,KAAKogC,2BACPtlB,EAAOtZ,KAAKxB,KAAKogC,0BAA0Bj3B,SAEzCnJ,KAAKmgC,eAAiB,GACxBrlB,EAAOtZ,MAAK7F,EAAAA,EAAAA,IAAS,iDAEnBqE,KAAKmgC,gBAAkBngC,KAAKuvB,oBAAoBoB,SAClD7V,EAAOtZ,MAAK7F,EAAAA,EAAAA,IAAS,+CAGhBmf,CACT,EACA2lB,kBAAAA,GACE,MAAM3lB,EAAmB,GAWzB,OAVI9a,KAAKwgC,yBACP1lB,EAAOtZ,KAAKxB,KAAKwgC,wBAAwBr3B,SAEvCnJ,KAAKugC,aAAe,GACtBzlB,EAAOtZ,MAAK7F,EAAAA,EAAAA,IAAS,iDAEnBqE,KAAKugC,cAAgBvgC,KAAKuvB,oBAAoBmB,WAChD5V,EAAOtZ,MAAK7F,EAAAA,EAAAA,IAAS,+CAGhBmf,CACT,KI5NJ,MAAM,IAA2B,OAAgB,GAAQ,CAAC,CAAC,SAAS,IAAQ,CAAC,YAAY,qBAEzF,UCPA,MAAMxc,GAAU,CACdgjC,kCAAkC3lC,EAAAA,EAAAA,IAChC,4FAGF4lC,mBAAmB5lC,EAAAA,EAAAA,IACjB,+DAEF6lC,0BAA0B7lC,EAAAA,EAAAA,IACxB,+DAEF8lC,2BAA2B9lC,EAAAA,EAAAA,IACzB,4CAEF+lC,wBAAwB/lC,EAAAA,EAAAA,IACtB,2DAEFgmC,uBAAuBhmC,EAAAA,EAAAA,IAAS,2CAElC,UClBA,MACM6E,GAAa,CAAE3B,MAAO,yBACtB6B,GAAa,CAAE7B,MAAO,uBACtBwC,GAAa,CAAExC,MAAO,+BACtB4C,GAAa,CAAC,SACdC,GAAa,CAAC,UAAW,SACzBC,GAAa,CAAE9C,MAAO,kBACtB+C,GAAa,CAAC,SACdC,GAAa,CAAC,SACdC,GAAa,CAAC,SACdC,GAAc,CAAC,SA4CrB,QAA4BO,EAAAA,EAAAA,IAAiB,CAC3ChD,MAAO,CACP/F,eAAgB,CACdiG,KAAMzE,OACN2E,UAAU,IAGZ6C,KAAAA,CAAMC,GAER,MAAMlD,EAAQkD,ECgGRu1B,GAAch1B,EAAAA,EAAAA,IAAI,GAClB45B,GAAgB55B,EAAAA,EAAAA,IAAmB,CAAEuH,OAAQ,IAC7CykB,GAAwBhsB,EAAAA,EAAAA,SAAwBzH,GAChDsmC,GAAc7+B,EAAAA,EAAAA,SAClBzH,GAEIumC,GAAgB9+B,EAAAA,EAAAA,SACpBzH,GAEIwmC,GAAgC/+B,EAAAA,EAAAA,SAEpCzH,GAEIymC,EAAgD,CACpD,eACA,kBACA,kBACA,eACA,eACA,SACA,UACA,WACA,eAGFzgC,EAAAA,EAAAA,IAAQqzB,GAAmC,CACzC3F,oBACAD,wBACAU,kBACA2J,kBACAJ,gBACAtJ,oBACAiQ,0BACAG,+BAUFx+B,EAAAA,EAAAA,IAAQpK,EAAAA,EAAuB,CAC7BuC,YAAauoC,IAGf,MAAMv/B,GAAapD,EAAAA,EAAAA,IAAwBnI,EAAAA,GAE3C,SAAS8qC,EAAmC/M,GAK1C,MAAMgN,GAAgBz+B,EAAAA,EAAAA,IACpBlE,EAAM/F,gBACL2oC,IACC,MAAMC,EAAmBD,EAAUjT,aAAatrB,WAC7CkI,GAAMA,EAAE1K,KAAO4tB,EAAsBn2B,QAExC,IAA0B,IAAtBupC,EACF,MAAM,IAAInoC,MAAM,wDAElB,MAAMk1B,EAAcgT,EAAUjT,aAAakT,GAC3C,GAAyB,YAArBjT,EAAY1vB,KACd,MAAM,IAAIxF,MAAM,+CAElBk1B,EAAY31B,eAAiB07B,EAAQv7B,iBAAiB,IAGpDC,GAAY0d,EAAAA,EAAAA,SAAQ4d,EAAQt7B,UAAW,CAAC,GAG1C,CAAC,EAID,CACE6F,KAAM,2BACNm5B,cAAe5J,EAAsBn2B,MACrCe,UAAWs7B,EAAQt7B,WAEzB8I,EAAYhJ,YAAY,CACtBC,kBAAmBuoC,EACnBtoC,UAAWA,GAEf,CAEA,MAAM41B,GAAsBlvB,EAAAA,EAAAA,KAAS,IACnCf,EAAM/F,eAAe01B,aAAahzB,MAC/BizB,GAAgBA,EAAY/tB,KAAO4tB,EAAsBn2B,UAI9D,SAASo2B,EAAkBoT,GACzBrT,EAAsBn2B,MAAQwpC,CAChC,CACA,SAAS3S,EAAgBtuB,GACvB4tB,EAAsBn2B,MAAQuI,GAC9BiH,EAAAA,EAAAA,KAAS,KACP,MAAM9Q,EAAKwqC,EAA8BlpC,OAAOsY,IAChD5Z,EAAG+qC,eAAe,CAChBC,SAAU,SACVC,MAAO,SACP,GAEN,CACA,SAASC,EAAsB3iC,GAC7B88B,EAAc/jC,MAAQiH,CACxB,CACA,SAAS4iC,EAAa1N,GACpBgD,EAAYn/B,MAAQm8B,CACtB,CACA,SAAS2N,EAAe3N,GACtB6M,EAAYhpC,MAAOs8B,OAAQ6C,YAAYhD,EACzC,CACA,SAAS4N,IACPd,EAAcjpC,MAAOolC,KAAK,IAC5B,CACA,SAAS4E,IACPf,EAAcjpC,MAAOolC,MAAM,IAC7B,CACA,SAAS6E,IACPjB,EAAYhpC,MAAOs8B,OAAQ+C,MAC7B,CACA,SAAS6K,IACPlB,EAAYhpC,MAAOs8B,OAAQmB,OAC7B,CACA,SAAS0M,IACP,MAAM7T,EAAkC,CACtC1vB,KAAM,UACNyxB,EAAG,EACH9vB,IAAI6C,EAAAA,EAAAA,KACJ0sB,UAAWqH,EAAYn/B,MACvB+3B,QAASnmB,KAAKlE,IAAIq2B,EAAc/jC,MAAM0R,OAAQytB,EAAYn/B,MAAQ,IAClE+E,EAAG,GACHE,EAAG,GACHwJ,MAAO,GACPC,OAAQ,GACR4pB,iBAAiBv1B,EAAAA,EAAAA,IAAS,eAC1Bi1B,kBAAkB,GAEpBnuB,EAAYhJ,YAAY,CACtBC,mBAAmB8J,EAAAA,EAAAA,IACjBlE,EAAM/F,gBACLkK,IACCA,EAAMwrB,aAAaztB,KAAK0tB,EAAY,MAI1CH,EAAsBn2B,MAAQs2B,EAAY/tB,EAC5C,CAEA,SAAS6hC,EAAyBxjC,GAChC,GAAa,qBAATA,EACF,MAAM,IAAIxF,MAAMsE,GAAQgjC,kCAE1B,MAAMl4B,EAAO65B,GAAQzjC,GACf0vB,EAAkC,CACtC1vB,KAAM,UACN2B,IAAI6C,EAAAA,EAAAA,KACJzK,eAAgB6P,EAChBsnB,UAAWqH,EAAYn/B,MACvB+3B,QAASnmB,KAAKlE,IAAIq2B,EAAc/jC,MAAM0R,OAAQytB,EAAYn/B,MAAQ,IAClE+E,EAAG,GACHE,EAAG,GACH+yB,kBAAkB,GAEpBnuB,EAAYhJ,YAAY,CACtBC,mBAAmB8J,EAAAA,EAAAA,IACjBlE,EAAM/F,gBACLkK,IACCA,EAAMwrB,aAAaztB,KAAK0tB,EAAY,MAI1CH,EAAsBn2B,MAAQs2B,EAAY/tB,EAC5C,CACA,SAASuuB,EAAkBvuB,GACzBvH,QAAQC,IAAI,oBAAqBsH,GACjC,MAAM+tB,EAAc5vB,EAAM/F,eAAe01B,aAAahzB,MACnD4P,GAAMA,EAAE1K,KAAOA,IAElB,IAAK+tB,EACH,MAAM,IAAIl1B,MAAMsE,GAAQkjC,0BAE1B,MAAM0B,GAASvnC,EAAAA,EAAAA,IAAS,2BAA4B,CAClDuzB,YAAaG,GAAqBH,KAE9BiU,EAAYrnC,OAAOsnC,QAAQF,GACjC,IAAKC,EAEH,YADAvpC,QAAQypC,KAAK,kCAGf,MAAM3/B,EAAQpE,EAAM/F,eAAe01B,aAAatrB,WAAWkI,GAAMA,EAAE1K,KAAOA,IAC1E,IAAe,IAAXuC,EACF,MAAM,IAAI1J,MAAMsE,GAAQkjC,0BAE1B/+B,EAAYhJ,YAAY,CACtBC,mBAAmB8J,EAAAA,EAAAA,IACjBlE,EAAM/F,gBACLkK,IACCA,EAAMwrB,aAAaprB,OAAOH,EAAO,EAAE,KAI3C,CACA,SAAS01B,EACPj4B,EACAoiB,EACAO,EAGA7E,GAEAxc,EAAYhJ,YAAY,CACtBC,mBAAmB8J,EAAAA,EAAAA,IACjBlE,EAAM/F,gBACLkK,IACC,MAAMyrB,EAAczrB,EAAMwrB,aAAahzB,MAAM4P,GAAMA,EAAE1K,KAAOA,IAC5D,IAAK+tB,EACH,MAAM,IAAIl1B,MAAM,uBAAuBmH,eAEzC+tB,EAAYvxB,EAAI4lB,EAChB2L,EAAYrxB,EAAIimB,CAAS,IAG7BnqB,UAAWslB,GAEf,CACA,SAAS+Z,EACP73B,EACAxD,EACAE,EACAwJ,EACAC,EACA2X,GAEAxc,EAAYhJ,YAAY,CACtBC,mBAAmB8J,EAAAA,EAAAA,IACjBlE,EAAM/F,gBACLkK,IACC,MAAMyrB,EAAczrB,EAAMwrB,aAAahzB,MAAM4P,GAAMA,EAAE1K,KAAOA,IAC5D,IAAK+tB,EACH,MAAM,IAAIl1B,MAAM,uBAAuBmH,eAEzC,GAAyB,YAArB+tB,EAAY1vB,KACd,MAAM,IAAIxF,MAAMsE,GAAQijC,mBAE1BrS,EAAYvxB,EAAIA,EAChBuxB,EAAYrxB,EAAIA,EAChBqxB,EAAY7nB,MAAQA,EACpB6nB,EAAY5nB,OAASA,CAAM,IAG/B3N,UAAWslB,GAEf,CACA,SAAS0gB,EACPx+B,EACAuvB,EACAzR,GAEAxc,EAAYhJ,YAAY,CACtBC,mBAAmB8J,EAAAA,EAAAA,IACjBlE,EAAM/F,gBACLkK,IACC,MAAMyrB,EAAczrB,EAAMwrB,aAAahzB,MAAM4P,GAAMA,EAAE1K,KAAOA,IAC5D,IAAK+tB,EACH,MAAM,IAAIl1B,MAAM,uBAAuBmH,eAEzC,MAAM+2B,EAAWhJ,EAAYyB,QAAUzB,EAAYwB,UACnDxB,EAAYyB,QAAUD,EAAYwH,EAClChJ,EAAYwB,UAAYA,CAAS,IAGrC/2B,UAAWslB,GAEf,CAEA,SAAS6gB,EACP3+B,EACA3B,EACAu1B,EACA9V,GAEAxc,EAAYhJ,YAAY,CACtBC,mBAAmB8J,EAAAA,EAAAA,IACjBlE,EAAM/F,gBACLkK,IACC,MAAMyrB,EAAczrB,EAAMwrB,aAAahzB,MAAM4P,GAAMA,EAAE1K,KAAOA,IAC5D,IAAK+tB,EACH,MAAM,IAAIl1B,MAAM,uBAAuBmH,eAE5B,UAAT3B,EACF0vB,EAAYwB,UAAYqE,EAExB7F,EAAYyB,QAAUoE,C,IAI5Bp7B,UAAWslB,GAEf,CD3FA,MAAO,CAAClgB,EAAUgG,MACRC,EAAAA,EAAAA,OAAcrG,EAAAA,EAAAA,IAAoB,MAAO6B,GAAY,EAC3D6E,EAAAA,EAAAA,IAAai+B,GAAa,CACxB/0B,QAAS,cACTxL,IAAK6+B,EACLx4B,KAAM5G,EAAQjJ,eACdgqC,aAAcd,EACde,iBAAkBhB,EAClBnI,mBAAoBt1B,EAAO,KAAOA,EAAO,GAAM8G,GAAMmjB,EAAkBnjB,EAAE1K,MACxE,KAAM,EAAG,CAAC,UACbV,EAAAA,EAAAA,IAAoB,MAAOC,GAAY,EACrCD,EAAAA,EAAAA,IAAoB,MAAOY,GAAY,EACrCZ,EAAAA,EAAAA,IAAoB,SAAU,CAC5BjB,KAAM,SACNX,MAAO,cACPmC,QAAS+hC,EACTxjC,OACE6F,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,gCAAiC,CAChDq+B,iBAAiBr+B,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,kBAGrC,KAAM,EAAG3D,MACXuD,EAAAA,EAAAA,OAAcrG,EAAAA,EAAAA,IAAoBgC,EAAAA,GAAW,MAAMC,EAAAA,EAAAA,IAAYmhC,GAAY2B,IACnEjjC,EAAAA,EAAAA,IAAoB,SAAU,CACnCM,IAAK2iC,EACLlkC,KAAM,SACNX,OAAOC,EAAAA,EAAAA,IAAgB,CAAC,UAAUsG,EAAAA,EAAAA,IAAO+tB,GAAP/tB,CAAwBs+B,KAC1D1iC,QAAUC,GAAiB+hC,EAAyBU,GACpDnkC,OACA6F,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,gCAAiC,CAChDq+B,iBAAiBr+B,EAAAA,EAAAA,IAAOkrB,GAAPlrB,CAAsBs+B,MAGxC,KAAM,GAAIhiC,MACX,QAENjB,EAAAA,EAAAA,IAAoB,MAAOkB,GAAY,EACrClB,EAAAA,EAAAA,IAAoB,SAAU,CAC5BjB,KAAM,SACNX,MAAO,iBACPU,OAAO6F,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,cACxBpE,QAAS2hC,GACR,KAAM,EAAG/gC,KACZnB,EAAAA,EAAAA,IAAoB,SAAU,CAC5BjB,KAAM,SACNX,MAAO,kBACPU,OAAO6F,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,eACxBpE,QAAS4hC,GACR,KAAM,EAAG/gC,KACZpB,EAAAA,EAAAA,IAAoB,SAAU,CAC5BjB,KAAM,SACNX,MAAO,cACPU,OAAO6F,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,aACxBpE,QAAS6hC,GACR,KAAM,EAAG/gC,KACZrB,EAAAA,EAAAA,IAAoB,SAAU,CAC5BjB,KAAM,SACNX,MAAO,eACPU,OAAO6F,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,aACxBpE,QAAS8hC,GACR,KAAM,EAAG/gC,SAGhBsD,EAAAA,EAAAA,IAAas+B,GAAe,CAC1B9kC,MAAO,iBACP0P,QAAS,gBACTxL,IAAK8+B,EACLz4B,KAAM5G,EAAQjJ,eACdw+B,YAAaA,EAAYn/B,MACzB+jC,cAAeA,EAAc/jC,MAC7Bm2B,sBAAuBA,EAAsBn2B,MAC7C8pC,eAAgBA,EAChBrI,mBAAoBt1B,EAAO,KAAOA,EAAO,GAAM8G,GAAMmjB,EAAkBnjB,EAAE1K,KACzEyiC,oBAAqBlU,GACpB,KAAM,EAAG,CAAC,OAAQ,cAAe,gBAAiB,4BACpD1qB,EAAAA,EAAAA,OAAc0B,EAAAA,EAAAA,IAAag6B,EAAAA,GAAY,KAAM,EAC3Ct7B,EAAAA,EAAAA,IAAOmqB,KACHvqB,EAAAA,EAAAA,OAAc0B,EAAAA,EAAAA,IAAam9B,GAA+B,CACzDt1B,QAAS,gCACTxL,IAAK++B,EACLvS,qBAAqBnqB,EAAAA,EAAAA,IAAOmqB,GAC5BxuB,KAAKqE,EAAAA,EAAAA,IAAOmqB,GAAqBpuB,IAChC,KAAM,EAAG,CAAC,0BACbwF,EAAAA,EAAAA,IAAoB,IAAI,IAC3B,SAGP,IEvcA,MAAM,IAA2B,OAAgB,GAAQ,CAAC,CAAC,YAAY,qBAEvE,UCNA,MAAM2W,GAAeC,KAAMC,EAAAA,EAAAA,IAAa,mBAAmBD,EAAEA,KAAIE,EAAAA,EAAAA,MAAcF,GACzE/c,GAAa,CCmKV3B,MAAM,UDlKT6B,GAAa,CCmKP7B,MAAM,WDlKZwC,GAA2Bic,IAAa,KCwKM7c,EAAAA,EAAAA,IAAM,qBDvKpDgB,GAAa,CCqLJ5C,MAAM,kBDpLf6C,GAAa,CCkMP7C,MAAM,WDjMZ8C,GAAa,CC8MJ9C,MAAM,kBD7Mf+C,GAAa,CACjBb,IAAK,ECyNAlC,MAAM,iBDtNPgD,GAAa,CAAEd,IAAK,GACpBe,GAAa,CAAC,QACdC,GAAc,CAAEhB,IAAK,GACrBiB,GAAc,CAAC,QACfC,GAAc,CC0OXpD,MAAM,yBDzOT+P,GAAc,CC+OZ/P,MAAM,gBD9ORqT,GAA4BoL,IAAa,KCgP3C7c,EAAAA,EAAAA,IAKU,UAJRjB,KAAK,SACLoQ,SAAA,GACA1N,MAAA,iBACA,cAAY,QD/Of,MAAO,KACJiQ,GAAc,CC0PTtT,MAAM,oBDzPXuT,GAAc,CC0PPvT,MAAM,yBDzPbwT,GAAc,CAClBtR,IAAK,ECuQMlC,MAAM,UD/Pb,SAAU0B,GAAOxB,EAAUgG,EAAY6B,EAAYC,EAAYC,EAAWC,GAC9E,MAAM+8B,GAAwBh1B,EAAAA,EAAAA,IAAkB,cAC1Ci1B,GAAwBj1B,EAAAA,EAAAA,IAAkB,cAC1Ck1B,GAAyBl1B,EAAAA,EAAAA,IAAkB,eAC3CmxB,GAA4BnxB,EAAAA,EAAAA,IAAkB,kBAEpD,OAAQ9J,EAAAA,EAAAA,OAAcrG,EAAAA,EAAAA,IAAoBgC,EAAAA,GAAW,KAAM,CCoHb,SAA9B5B,EAAAxF,eAAeu5B,MAAMtzB,ODlH9BwF,EAAAA,EAAAA,OCkHPrG,EAAAA,EAAAA,IAoEWgC,EAAAA,GAAA,CAAAI,IAAA,KAnETN,EAAAA,EAAAA,IAMI,UAAA0E,EAAAA,EAAAA,IAJApG,EAAApD,SDnHE,yEACE,ICuHR8E,EAAAA,EAAAA,IA2DM,MA3DND,GA2DM,EA1DJC,EAAAA,EAAAA,IAiCO,OAjCPC,GAiCO,EAhCLD,EAAAA,EAAAA,IA+BW,kBA9BTA,EAAAA,EAAAA,IAES,eAAA0E,EAAAA,EAAAA,IADJpG,EAAApD,SAAS,kBAAD,IAEb8E,EAAAA,EAAAA,IAMQ,eD7HA0F,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,ICwHpBpG,EAAApD,SAAS,0BAA2B,IAAC,GAAA0F,IACxCgE,EAAAA,EAAAA,IAGEy+B,EAAA,CAFCxb,eAAevpB,EAAAklC,oBACfrpB,OAAQ,WDtHF,KAAM,EAAG,CAAC,sBCyHrBna,EAAAA,EAAAA,IAOQ,eD7HA0F,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,ICuHpBpG,EAAApD,SAAS,gCAAiC,IAC7C,IAAA0J,EAAAA,EAAAA,IAIE0+B,EAAA,CD1HMt+B,WCuHG1G,EAAAmlC,eDtHH,sBAAuBn/B,EAAO,KAAOA,EAAO,GAAM9D,GCsH/ClC,EAAAmlC,eAAcjjC,GACvB,cACCkjC,aAAYplC,EAAAqlC,mBDrHN,KAAM,EAAG,CAAC,aAAc,oBCwHnC3jC,EAAAA,EAAAA,IAQM,MARNgB,GAQM,EAPJhB,EAAAA,EAAAA,IAMS,UALPjB,KAAK,SACLX,MAAM,gBACLmC,QAAK+D,EAAA,KAAAA,EAAA,GDpHpB,IAAInI,ICoHkBmC,EAAAslC,oBAAAtlC,EAAAslC,sBAAAznC,MDnHDuI,EAAAA,EAAAA,ICqHJpG,EAAApD,SAAS,eAAD,UAQnB8E,EAAAA,EAAAA,IAuBO,OAvBPiB,GAuBO,EAtBLjB,EAAAA,EAAAA,IAqBW,kBApBTA,EAAAA,EAAAA,IAES,eAAA0E,EAAAA,EAAAA,IADJpG,EAAApD,SAAS,kBAAD,IAEb8E,EAAAA,EAAAA,IAOQ,eDjIA0F,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,IC2HpBpG,EAAApD,SAAS,gBAAiB,IAC7B,ID3HMmK,EAAAA,EAAAA,KC2HNrF,EAAAA,EAAAA,IAIE,SAHA5B,MAAM,oBACNW,KAAK,OD1HC,sBAAuBuF,EAAO,KAAOA,EAAO,GAAM9D,GC2H/ClC,EAAAulC,gBAAerjC,ID1HjB,KAAM,KAAM,CACb,CAACgF,EAAAA,GCyHElH,EAAAulC,sBAGb7jC,EAAAA,EAAAA,IAQM,MARNkB,GAQM,EAPJlB,EAAAA,EAAAA,IAMS,UALPjB,KAAK,SACLX,MAAM,gBACLmC,QAAK+D,EAAA,KAAAA,EAAA,GDvHpB,IAAInI,ICuHkBmC,EAAAwlC,oBAAAxlC,EAAAwlC,sBAAA3nC,MDtHDuI,EAAAA,EAAAA,ICwHJpG,EAAApD,SAAS,eAAD,YDnHd,MACHgL,EAAAA,EAAAA,IAAoB,IAAI,GCyHiC,SAA9B5H,EAAAxF,eAAeu5B,MAAMtzB,ODvH/CwF,EAAAA,EAAAA,OCuHPrG,EAAAA,EAAAA,IA6BM,MA7BNiD,GA6BM,EA5BJyD,EAAAA,EAAAA,IAKE2+B,EAAA,CAJAjhC,IAAI,cACHqG,KAAMrK,EAAAxF,eACPsF,MAAM,eACL0kC,aAAYxkC,EAAA0jC,cDtHN,KAAM,EAAG,CAAC,OAAQ,iBCwHY,YAA9B1jC,EAAAxF,eAAeu5B,MAAMtzB,ODtHnBwF,EAAAA,EAAAA,OCsHXrG,EAAAA,EAAAA,IAKI,IAAAkD,GAAA,ED1HQsE,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,ICsHxBpG,EAAApD,SAAS,oBAAqB,IACjC,IAAA8E,EAAAA,EAAAA,IAEC,KAFG+jC,KAAMzlC,EAAAxF,eAAeu5B,MAAMb,IAAKxtB,OAAO,WDnH9BU,EAAAA,EAAAA,ICoHRpG,EAAAxF,eAAeu5B,MAAMb,KAAG,EAAAnwB,OAGa,wBAA9B/C,EAAAxF,eAAeu5B,MAAMtzB,ODpHtBwF,EAAAA,EAAAA,OCoHbrG,EAAAA,EAAAA,IAUI,IAAAoD,GAAA,ED7HUoE,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,ICoH1BpG,EAAApD,SAAS,0BAA2B,IACvC,IAAA8E,EAAAA,EAAAA,IAOI,KAPA+jC,KAAMzlC,EAAA0lC,eAAe1lC,EAAAxF,eAAeu5B,MAAMjU,SAAUpa,OAAO,UDjHhD,CCkHG1F,EAAA2lC,eDhHC1/B,EAAAA,EAAAA,OCgHjBrG,EAAAA,EAAAA,IAEWgC,EAAAA,GAAA,CAAAI,IAAA,KDjHOoF,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,ICgH9BpG,EAAA2lC,aAAaxjC,MAAI,ID/GH,OACF8D,EAAAA,EAAAA,OCgHjBrG,EAAAA,EAAAA,IAEWgC,EAAAA,GAAA,CAAAI,IAAA,KDjHOoF,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,ICgH9BpG,EAAAxF,eAAeu5B,MAAMjU,SAAO,ID/Gd,MACN,EAAG7c,QAER2E,EAAAA,EAAAA,IAAoB,IAAI,ICgHpClG,EAAAA,EAAAA,IAIM,MAJNwB,GAIM,EAHJxB,EAAAA,EAAAA,IAES,UAFD5B,MAAM,eAAgBmC,QAAK+D,EAAA,KAAAA,EAAA,GD3GzC,IAAInI,IC2GuCmC,EAAA4lC,aAAA5lC,EAAA4lC,eAAA/nC,MD1G5BuI,EAAAA,EAAAA,IC2GJpG,EAAApD,SAAS,kBAAD,SDxGXgL,EAAAA,EAAAA,IAAoB,IAAI,IC4G9BlG,EAAAA,EAAAA,IAyDO,OAzDPmO,GAyDO,CAvDLsD,IAMAzR,EAAAA,EAAAA,IAgDW,kBA/CTA,EAAAA,EAAAA,IAAgD,eAAA0E,EAAAA,EAAAA,IAArCpG,EAAApD,SAAS,kBAAD,IACnB8E,EAAAA,EAAAA,IAOQ,eDvHJqF,EAAAA,EAAAA,KCiHFrF,EAAAA,EAAAA,IAIE,SAHAjB,KAAK,WDhHH,sBAAuBuF,EAAO,KAAOA,EAAO,GAAM9D,GCiH3ClC,EAAAiE,oBAAoB+vB,SAAQ9xB,GACpC8E,QAAKhB,EAAA,KAAAA,EAAA,GD/GhB,IAAInI,IC+GcmC,EAAAuE,sBAAAvE,EAAAuE,wBAAA1G,KD9GL,KAAM,KAAM,CACb,CAAC6J,EAAAA,GC4GM1H,EAAAiE,oBAAoB+vB,aD1G7B5sB,EAAAA,EAAAA,IC4GA,KACFhB,EAAAA,EAAAA,IAAGpG,EAAApD,SAAS,0BAAD,MAEb8E,EAAAA,EAAAA,IAmBM,MAnBN0R,GAmBM,EAlBJ1R,EAAAA,EAAAA,IAcM,MAdN2R,GAcM,EAbJ3R,EAAAA,EAAAA,IASQ,eDrHJ0F,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,IC6GhBpG,EAAApD,SAAS,gBAAiB,IAC7B,IAAA0J,EAAAA,EAAAA,IAME46B,EAAA,CALCphC,OAAKC,EAAAA,EAAAA,IAAA,CAAAuhC,UAAethC,EAAA6lC,0BACpB,iBAAgB7lC,EAAA6lC,wBD5Gfn/B,WC6GO1G,EAAAiE,oBAAoBgwB,QD5G3B,sBAAuBjuB,EAAO,KAAOA,EAAO,GAAM9D,GC4G3ClC,EAAAiE,oBAAoBgwB,QAAO/xB,GACnC8E,QAAKhB,EAAA,KAAAA,EAAA,GAAA9D,GAAElC,EAAAuE,qBAAqB,iBAC5B,iBAAYyB,EAAA,KAAAA,EAAA,GAAGiH,GAAWjN,EAAA6lC,wBAA0B54B,ID3GlD,KAAM,EAAG,CAAC,QAAS,eAAgB,kBC8G1CvL,EAAAA,EAAAA,IAES,UAFDjB,KAAK,SAASX,MAAM,SAAUmC,QAAK+D,EAAA,MAAAA,EAAA,IDvGrD,IAAInI,ICuGmDmC,EAAA8lC,uBAAA9lC,EAAA8lC,yBAAAjoC,MDtGxCuI,EAAAA,EAAAA,ICuGApG,EAAApD,SAAS,6BAAD,KAGWoD,EAAA6lC,0BDvGnB5/B,EAAAA,EAAAA,OCuGPrG,EAAAA,EAAAA,IAEM,MAFN0T,IAEMlN,EAAAA,EAAAA,IADDpG,EAAA6lC,yBAAuB,KDvGtBj+B,EAAAA,EAAAA,IAAoB,IAAI,MAkB1BA,EAAAA,EAAAA,IAAoB,IAAI,QAG/B,GACL,CEjNA,MAAMnG,GAAa,CCEZ3B,MAAM,mBDDP6B,GAAa,CCSiB9H,MAAM,IDRpCyI,IAA0B8E,EAAAA,EAAAA,ICSX,iBDRf1E,GAAa,CAAC,SACdC,GAAa,CCYyBkO,SAAA,IDXtCjO,IAA0BwE,EAAAA,EAAAA,ICYX,2BDVf,SAAU5F,GAAOxB,EAAUgG,EAAY6B,EAAYC,EAAYC,EAAWC,GAC9E,MAAM+9B,GAA0Bh2B,EAAAA,EAAAA,IAAkB,gBAC5Ci2B,GAAuBj2B,EAAAA,EAAAA,IAAkB,aAE/C,OAAQ9J,EAAAA,EAAAA,OCTRrG,EAAAA,EAAAA,IAmBM,MAnBN6B,GAmBM,EAlBJC,EAAAA,EAAAA,IAGQ,eDON0F,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,ICTbpG,EAAApD,SAAS,kBAAmB,IAChC,IAAA0J,EAAAA,EAAAA,IAAqEy/B,EAAA,CAAvDE,iBAAA,GAAiBC,SAAA,GDY7Bx/B,WCZ+C1G,EAAAgc,iBDa/C,sBAAuBhW,EAAO,KAAOA,EAAO,GAAM9D,GCbHlC,EAAAgc,iBAAgB9Z,IDc9D,KAAM,EAAG,CAAC,kBCZfR,EAAAA,EAAAA,IAaQ,eDEN0F,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,ICdbpG,EAAApD,SAAS,UAAW,IACxB,IDcAmK,EAAAA,EAAAA,KCdArF,EAAAA,EAAAA,IAUS,UDKP,sBAAuBsE,EAAO,KAAOA,EAAO,GAAM9D,GCfnClC,EAAAmmC,aAAYjkC,GAAGmF,SAAMrB,EAAA,KAAAA,EAAA,GDkB5C,IAAInI,IClB0CmC,EAAAomC,YAAApmC,EAAAomC,cAAAvoC,KDmBrC,EACDkJ,EAAAA,EAAAA,KCnBArF,EAAAA,EAAAA,IAES,SAFTC,GAES,EADP2E,EAAAA,EAAAA,IAAoC0/B,EAAA,MDoBlCnlC,SAAS2F,EAAAA,EAAAA,KCpBA,IAAa,CDqBpBlE,MAEF6E,EAAG,KAEJ,KAAM,CACP,CAACk/B,EAAAA,GC3BarmC,EAAAsmC,gBD6BfrgC,EAAAA,EAAAA,KAAW,IC1BZrG,EAAAA,EAAAA,IAESgC,EAAAA,GAAA,MAAAC,EAAAA,EAAAA,IAFuB7B,EAAAge,OAAK,CAArBD,EAAMpZ,MD2BZsB,EAAAA,EAAAA,OC3BVrG,EAAAA,EAAAA,IAES,UAF+BoC,IAAK2C,EAAQ9K,MAAOkkB,EAAK3b,KD8B5DgE,EAAAA,EAAAA,IC7BA2X,EAAK5b,MAAI,EAAAO,OD8BV,OACJqE,EAAAA,EAAAA,KC7BArF,EAAAA,EAAAA,IAES,SAFTiB,GAES,EADP2D,EAAAA,EAAAA,IAA8C0/B,EAAA,MD8B5CnlC,SAAS2F,EAAAA,EAAAA,KC9BA,IAAuB,CD+B9B5D,MAEFuE,EAAG,KAEJ,KAAM,CACP,CAACk/B,EAAAA,GCrC8B,IAAjBrmC,EAAAge,MAAMzS,WDuCrB,KAAM,CACP,CAACjE,EAAAA,GC/CctH,EAAAmmC,mBDmDvB,CE5DA,MAAM1kC,GAAa,CACjBO,IAAK,ECEqBnI,MAAM,IDC5B8H,IAA0ByF,EAAAA,EAAAA,ICAf,0BDCX9E,GAAa,CAAC,SACdI,GAAa,CAAC,SACdC,GAAa,CAAC,SACdC,GAAa,CAAC,SAEd,SAAUpB,GAAOxB,EAAUgG,EAAY6B,EAAYC,EAAYC,EAAWC,GAC9E,MAAMg+B,GAAuBj2B,EAAAA,EAAAA,IAAkB,aAE/C,OAAOhJ,EAAAA,EAAAA,MAAiBd,EAAAA,EAAAA,OCXxBrG,EAAAA,EAAAA,IAsBS,UDVP,sBAAuBoG,EAAO,KAAOA,EAAO,GAAM9D,GCZnClC,EAAAmmC,aAAYjkC,GAAGmF,SAAMrB,EAAA,KAAAA,EAAA,GDexC,IAAInI,ICfsCmC,EAAAumC,iBAAAvmC,EAAAumC,mBAAA1oC,KDgBrC,CCfamC,EAAAkmC,WDiBTjgC,EAAAA,EAAAA,OCjBLrG,EAAAA,EAAAA,IAES,SAFT6B,GAES,EADP6E,EAAAA,EAAAA,IAA6C0/B,EAAA,MDkBvCnlC,SAAS2F,EAAAA,EAAAA,KClBJ,IAAsB,CDmBzB7E,MAEFwF,EAAG,QAGPS,EAAAA,EAAAA,IAAoB,IAAI,GCtBK,YAAjB5H,EAAAwmC,QAAQ/lC,ODwBnBwF,EAAAA,EAAAA,OCxBLrG,EAAAA,EAAAA,IAQW,YDiBLoC,IAAK,ECzBkCykC,MAAOzmC,EAAA0mC,oBD2B7C,GACAzgC,EAAAA,EAAAA,KAAW,IC3BhBrG,EAAAA,EAAAA,IAMSgC,EAAAA,GAAA,MAAAC,EAAAA,EAAAA,IALU7B,EAAA2mC,qBAAVrpB,KD2BKrX,EAAAA,EAAAA,OC5BdrG,EAAAA,EAAAA,IAMS,UAJNoC,IAAKsb,EAAOlb,GACZvI,MAAOyjB,EAAOlb,KD4BRgE,EAAAA,EAAAA,IC1BJkX,EAAOf,WAAWpa,MAAI,EAAAO,OD2BnB,OACH,EAAGJ,MACNsF,EAAAA,EAAAA,IAAoB,IAAI,GC1BZ5H,EAAAimC,mBD4BXhgC,EAAAA,EAAAA,OC5BLrG,EAAAA,EAAAA,IAQW,YDqBLoC,IAAK,EC7BwBykC,MAAOzmC,EAAA4mC,kBD+BnC,GACA3gC,EAAAA,EAAAA,KAAW,IC/BhBrG,EAAAA,EAAAA,IAMSgC,EAAAA,GAAA,MAAAC,EAAAA,EAAAA,IALU7B,EAAAkd,mBAAVI,KD+BKrX,EAAAA,EAAAA,OChCdrG,EAAAA,EAAAA,IAMS,UAJNoC,IAAKsb,EAAOlb,GACZvI,MAAOyjB,EAAOlb,KDgCRgE,EAAAA,EAAAA,IC9BJkX,EAAOf,WAAWpa,MAAI,EAAAS,OD+BnB,OACH,EAAGD,MACNiF,EAAAA,EAAAA,IAAoB,IAAI,IAC3B,MAAO,CACR,CAACN,EAAAA,GCtDctH,EAAAmmC,eDwDnB,CCxBA,SAASU,GACP3qB,GACA,qBAAE4qB,IAEF,MAAMC,EAAmB,IAAIC,IAE7B,OAAO9qB,EAAQtV,QAAQ0W,IACrB,GAAI2pB,EAAqB3pB,GACvB,OAAQA,EAAOf,WAAW,gBACxB,IAAK,eACH,GAA8D,IAA1De,EAAOf,WAAW,gBAAgB,oBACpC,OAAO,EAET,MACF,IAAK,iBACH,GAAIuqB,EACF,OAAO,EAET,MACF,QACE,OAAO,E,IAKf,SAASG,EAAqB3pB,GAC5B,IAAI4pB,GAAU,EACd,GAAI5pB,GAAQ6pB,eAAe/pB,OAAQ,CACjC,IAAIgqB,EAAW9pB,EAAO6pB,cAAc/pB,OAAOtc,KAAKsB,GAChD,GAAI2kC,EAAiBM,IAAID,GACvBF,EAAUH,EAAiB3iC,IAAIgjC,OAC1B,CACL,IAAIhqB,EAASlB,EAAQhf,MAAMof,GAAMA,EAAEla,KAAOglC,IACtChqB,IACF8pB,EAAUI,EAA6BlqB,GACvC2pB,EAAiB1iC,IAAI+iC,EAAUF,G,EAIrC,OAAOA,CACT,CAEA,SAASI,EAA6BC,GACpC,MAA+C,iBAA3CA,EAAahrB,WAAW,kBAEjBgrB,GAAcJ,eAAe/pB,QAE/B6pB,EAAqBM,GAIhC,CACF,CAEA,QAAelnC,EAAAA,EAAAA,IAAgB,CAC7B8B,KAAM,eACN5B,MAAO,CACL1G,MAAO,CACL4G,KAAMC,OACNC,UAAU,EACVE,QAAS,IAEXolC,iBAAkB,CAAExlC,KAAM+mC,QAAS3mC,SAAS,GAC5CimC,qBAAsB,CAAErmC,KAAM+mC,QAAS3mC,SAAS,GAChDqlC,SAAU,CAAEzlC,KAAM+mC,QAAS3mC,SAAS,IAEtCC,IAAAA,GACE,MAAO,CACLqlC,aAAc,GACdO,mBAAoBzlC,KAAKrE,SAAS,qCAClCgqC,iBAAkB3lC,KAAKrE,SAAS,6BAEpC,EACA0E,SAAU,KACLwb,EAAAA,GAAAA,IAAW,CACZC,eAAgB,oBAElBypB,OAAAA,GAEE,OAAOiB,GAAAA,GAAqBC,aAC9B,EACAtrB,MAAAA,GAEE,OAAOrf,OAAOC,OAAOggB,OACvB,EACA2qB,YAAAA,GACE,MAAO,CAAElnC,KAAM,UAAW2B,GAAI,GAAGnB,KAAKulC,QAAQpkC,KAChD,EACA6a,UAAAA,GACE,MAAO,CAAExc,KAAM,QAAS2B,GAAI,GAAGnB,KAAKmb,SACtC,EACAuqB,mBAAAA,GACE,OAAOE,GACL5lC,KAAK8b,eAAe,CAClBK,OAAQnc,KAAK0mC,aACbtqB,aAAc,aACV,GACN,CACEypB,qBAAsB7lC,KAAK6lC,sBAGjC,EACA5pB,iBAAAA,GACE,IAAIA,EAAiC,GACjCC,EACFlc,KAAK8b,eAAe,CAClBK,OAAQnc,KAAKgc,WACbI,aAAc,aACV,GAOR,OANAF,EAAYvkB,SAAS0kB,IACsB,iBAArCA,EAAOf,WAAW,gBACpBW,EAAkBza,KAAK6a,E,IAIpBJ,CACT,GAEF9T,QAAS,KACJmU,EAAAA,GAAAA,IAAW,CACZC,oBAAqB,wBAGvBC,kBAAAA,CAAmBC,GAUjB,OAAOzc,KAAKuc,oBAAoBE,EAClC,EAEA6oB,eAAAA,GACEtlC,KAAK4Q,MAAM,QAAS5Q,KAAKklC,aAC3B,EAEAyB,gBAAAA,GACE,MAAMxqB,EAASnc,KAAK0mC,aACdtqB,EAAe,UACfO,EAAU,CAAE,cAAe,KAEjC,OAAO3c,KAAKwc,mBAAmB,CAAEL,SAAQC,eAAcO,WACzD,EAEAD,cAAAA,GACE,MAAMP,EAASnc,KAAKgc,WACdI,EAAe,UACfO,EAAU,CAAE,cAAe,KAEjC,OAAO3c,KAAKwc,mBAAmB,CAAEL,SAAQC,eAAcO,WACzD,EAEAiqB,qBAAAA,GACE,MAAM3rB,EAAuBjb,KAAKic,kBAAkBygB,OAClD18B,KAAK0lC,qBAGP,IAAIrpB,EAASpB,EAAQhf,MAAMogB,GAAWA,EAAOlb,KAAOnB,KAAKklC,eAE/B,KAAtBllC,KAAKklC,mBAAkC5pC,IAAX+gB,IAC9Brc,KAAKklC,aAAe,GACpBllC,KAAKslC,kBAET,GAEF,aAAMjuC,GAEJ,GADA2I,KAAKklC,aAAellC,KAAKpH,MACC,UAAtBoH,KAAKulC,QAAQ/lC,KACf,UACQQ,KAAK2mC,kB,CACX,MAAO36B,GACPpS,QAAQoS,MAAM,iCAAkCA,E,CAGpD,UACQhM,KAAK0c,gB,CACX,MAAO1Q,GACPpS,QAAQoS,MAAM,+BAAgCA,E,CAEhDhM,KAAK4mC,uBACP,EACA7sC,MAAO,CACLnB,KAAAA,GACEoH,KAAKklC,aAAellC,KAAKpH,KAC3B,KC3NJ,MAAM,IAA2B,OAAgB,GAAQ,CAAC,CAAC,SAAS,MAEpE,UHiCA,IAAewG,EAAAA,EAAAA,IAAgB,CAC7B8B,KAAM,aACN2P,WAAY,CAAEg2B,aAAYA,IAC1BvnC,MAAO,CACL1G,MAAO6G,OACPqnC,SAAU,CAAEtnC,KAAMC,OAAQG,QAAS,IACnCmnC,QAAS,CAAEvnC,KAAM+mC,QAAS3mC,SAAS,GACnConC,QAAS,CAAExnC,KAAM+mC,QAAS3mC,SAAS,GACnCqnC,QAAS,CAAEznC,KAAM+mC,QAAS3mC,SAAS,GACnCsnC,WAAY,CAAE1nC,KAAM+mC,QAAS3mC,SAAS,GACtCylC,WAAY,CAAE7lC,KAAM+mC,QAAS3mC,SAAS,IAExCC,IAAAA,GACE,MAAO,CACLqlC,aAAc,GACdnqB,iBAAkB,GAClBgC,MAAO,GAEX,EACA1c,SAAU,KACLwb,EAAAA,GAAAA,IAAW,CACZ6Z,YAAa,iBACbyR,gBAAiB,oBACjBC,iBAAkB,yBAEpBjsB,MAAAA,GACE,OAAOrf,OAAOC,OAAOggB,OACvB,GAEF5T,QAAS,CACPxM,SAAQ,SACL2gB,EAAAA,GAAAA,IAAW,CACZka,YAAa,qBACb6Q,oBAAqB,0BAEvBlC,UAAAA,GACEnlC,KAAK4Q,MACH,aACA5Q,KAAK+c,MAAM9gB,MAAM6gB,GAASA,EAAK3b,KAAOnB,KAAKklC,eAE/C,EACAoC,WAAAA,CAAYC,GACV,MAAMC,EAAc1qB,IAClB,IAAI2qB,EAAiBznC,KAAKonC,iBAAiB,CACzCjrB,OAAQW,EACRV,aAAc,iBAGhB,GACqB,OAAnBqrB,GACoD,IAApDA,EAAensB,WAAW,sBAE1B,OAAO,EAET,GACoB,KAAlBtb,KAAK8mC,UACL9mC,KAAK8mC,WAAahqB,EAAKxB,WAAW,aAElC,OAAO,EAET,GAAItb,KAAK+mC,UAAYjqB,EAAKxB,WAAW,aAAahO,SAAS,SACzD,OAAO,EAET,MAAMo6B,EAAkB,CAAC,YAAa,YAAa,cACnD,GACE1nC,KAAKgnC,UACJU,EAAgBz6B,MAAM06B,GACrB7qB,EAAKxB,WAAW,aAAahO,SAASq6B,KAGxC,OAAO,EAET,MAAMC,EAAkB,CACtB,YACA,YACA,aACA,aACA,aACA,cACA,aAEF,GACE5nC,KAAKinC,UACJW,EAAgB36B,MAAM06B,GACrB7qB,EAAKxB,WAAW,aAAahO,SAASq6B,KAGxC,OAAO,EAET,MAAME,EAAmB,CAAC,mBAC1B,QACE7nC,KAAKknC,aACJW,EAAiB56B,MAAM06B,GACtB7qB,EAAKxB,WAAW,aAAahO,SAASq6B,KAM/B,EAOb,OAAOJ,EAAU5hC,OAAO6hC,GAAY3+B,KAAKiU,IAAI,CAC3C3b,GAAI2b,EAAK3b,GACTD,KAAM4b,EAAKxB,WAAWpa,KACtBy1B,UAAW7Z,EAAKxB,WAAW,aAC3Bsb,aAAc96B,OAAOC,OAAO+rC,UAAUC,OACpC,eACA,CAAEvoC,KAAM,EAAGqf,QAAS/B,EAAK3b,GAAI6mC,UAAWlrB,EAAKxB,WAAWpa,OACxD,MAGN,EACA,oBAAM+mC,GACJ,MAAM9rB,EAAS,CAAE3c,KAAM,UAAW2B,GAAI,GAAGnB,KAAK+a,oBACxCqB,EAAe,YACfO,EAAU,CAAEurB,QAAS,eAAgB,cAAe,WACpDloC,KAAKqnC,oBAAoB,CAAElrB,SAAQC,eAAcO,YAEvD,MAAMwrB,EAAWnoC,KAAKmnC,gBAAgB,CAAEhrB,SAAQC,iBAChDpc,KAAK+c,MAAQ/c,KAAKsnC,YAAYa,EAChC,GAEF,aAAM9wC,GAEJ,GADAuC,QAAQC,IAAI,WACRmG,KAAKpH,MAAO,CACd,UACQoH,KAAKw2B,YAAY,CAAEr1B,GAAInB,KAAKpH,O,CAClC,MAAOoT,GAMP,YALApS,QAAQoS,MACN,6FAEAA,E,CAIJ,MAAMmR,EAAUnd,KAAK01B,YAAY,CAAEv0B,GAAInB,KAAKpH,QAExCukB,IACFnd,KAAK+a,iBAAmBoC,EAAQ+oB,cAAc/pB,OAAOtc,KAAKsB,GAC1DnB,KAAKklC,aAAellC,KAAKpH,OAAS,G,CAGxC,EACAmB,MAAO,CACLghB,gBAAAA,GACgC,KAA1B/a,KAAK+a,kBACP/a,KAAKioC,gBAET,EACArvC,KAAAA,CAAMyK,EAAU+kC,GACG,KAAb/kC,IACFrD,KAAK+a,iBAAmB,GACxB/a,KAAKklC,aAAe,GAExB,KIlMJ,MAAM,IAA2B,OAAgB,GAAQ,CAAC,CAAC,SAAS,MAEpE,UNUA,IAAe9lC,EAAAA,EAAAA,IAAgB,CAC7B8B,KAAM,cACN5B,MAAO,CACL/F,eAAgB,CACdiG,KAAMzE,OACN2E,UAAU,IAGd6C,KAAAA,GACE,MAAO,CACLE,YAAYpD,EAAAA,EAAAA,IAAwBnI,EAAAA,GAExC,EACA2I,IAAAA,GACE,MAAO,CACLmD,qBAAqBC,EAAAA,EAAAA,WAAUjD,KAAKzG,gBACpC+qC,gBAAiB,GACjBM,6BAAyBtpC,EACzBy8B,YAAa,EACbhd,iBAAkB,GAClB2pB,kBAAcppC,EACd4oC,eAAgB,GAEpB,EACAnqC,MAAO,CAELR,eAAgB,CACdwO,WAAW,EACXC,QAAS,WACPhI,KAAKgD,qBAAsBC,EAAAA,EAAAA,WAAUjD,KAAKzG,eAC5C,GAEF,uBAAwB,CACtBwO,WAAW,EACXC,QAASiY,eAAgBrnB,GACvB,OAAQA,EAAM4G,MACZ,IAAK,OACH,MACF,IAAK,sBACH,QACwBlE,IAAtB0E,KAAK0kC,cACL1kC,KAAK0kC,aAAavjC,KAAOvI,EAAMimB,QAC/B,OAEM7e,KAAKw2B,YAAY,CAAEr1B,GAAIvI,EAAMimB,UACnC,MAAM9b,EAAM2zB,GAAAA,GAAer9B,MACzB2G,KAAK01B,YAAY,CAAEv0B,GAAIvI,EAAMimB,WAE/B7e,KAAK0kC,aAAe,CAClBvjC,GAAIvI,EAAMimB,QACV3d,KAAM6B,EAAIuY,WAAWpa,KACrBy1B,UAAW5zB,EAAIuY,WAAW,aAC1Bsb,aAAc7zB,EAAIuxB,KAAK,gB,CAG3B,MACF,IAAK,UACHt0B,KAAKskC,gBAAkB1rC,EAAMq5B,IAEnC,IAGJ5xB,SAAU,KACLwb,EAAAA,GAAAA,IAAW,CACZ6Z,YAAa,oBAGjBvtB,QAAS,CACPs8B,eAAc,GACd9lB,YAAW,GACXhjB,SAAQ,SACL2gB,EAAAA,GAAAA,IAAW,CACZka,YAAa,uBAGflzB,oBAAAA,CAAqB3J,GACnBqG,KAAKyC,WAAYhJ,YAAY,CAC3BC,mBAAmBuJ,EAAAA,EAAAA,WAAUjD,KAAKgD,qBAClCrJ,UAAWA,GAAa,CAAC,GAE7B,EACA8oC,YAAAA,CAAa1N,GACX/0B,KAAK+3B,YAAchD,CACrB,EACA8P,qBAAAA,GACE7kC,KAAKgD,oBAAoBgwB,QAAUhzB,KAAK+3B,YACxC/3B,KAAKsD,qBAAqB,eAC5B,EACA8gC,iBAAAA,CAAkBtnB,GAChB9c,KAAK0kC,aAAe5nB,EACpB9c,KAAKkkC,eAAiBpnB,EAAK3b,EAC7B,EACAojC,kBAAAA,GACEvkC,KAAKgD,oBAAoB8vB,MAAQ,CAC/BtzB,KAAM,UACNyyB,IAAKjyB,KAAKskC,iBAEZtkC,KAAKsD,sBACP,EACA+gC,kBAAAA,GACE,IAAKrkC,KAAK0kC,aACR,MAAM,IAAI1qC,MAAM,oBAElBgG,KAAKgD,oBAAoB8vB,MAAQ,CAC/B7B,EAAG,EACHzxB,KAAM,sBACNqf,QAAS7e,KAAK0kC,aAAavjC,IAE7BnB,KAAKsD,sBACP,EACAqhC,WAAAA,GACE3kC,KAAKgD,oBAAoB8vB,MAAQ,CAC/BtzB,KAAM,QAERQ,KAAKsD,sBACP,EACA2gC,mBAAAA,CAAoBnnB,GAClB9c,KAAKgD,oBAAoB8vB,MAAQ,CAC/B7B,EAAG,EACHzxB,KAAM,sBACNqf,QAAS/B,EAAK3b,IAEhBnB,KAAKsD,uBACLtD,KAAK0kC,aAAe,CAClBvjC,GAAI2b,EAAK3b,GACTD,KAAM4b,EAAKxB,WAAWpa,KACtBy1B,UAAW7Z,EAAKxB,WAAW,aAC3Bsb,aAAc9Z,EAAKwX,KAAK,gBAE5B,GAEFzjB,WAAY,CACVwwB,eAAc,GACdhZ,WAAU,GACVib,YAAW,GACX+E,WAAUA,MOjJd,MAAM,IAA2B,OAAgB,GAAQ,CAAC,CAAC,SAAS,IAAQ,CAAC,YAAY,qBAEzF,UCNA,MACM7nC,GAAa,CAAE3B,MAAO,8BAO5B,QAA4ByD,EAAAA,EAAAA,IAAiB,CAC3ChD,MAAO,CACPkvB,SAAU,CACRhvB,KAAMzE,OACN2E,UAAU,IAGZ8Q,MAAO,CACP4T,MAAAA,CAAO6Q,GACL,OAAO,CACT,GAEA1yB,KAAAA,CAAMC,GAAS,KAAE8lC,IAEnB,MAAMhpC,EAAQkD,ECPR+lC,GAAgBxlC,EAAAA,EAAAA,KAAsBE,EAAAA,EAAAA,WAAU3D,EAAMkvB,WAS5D,SAASga,EAAe7uC,EAAqB,CAAC,GAC5C2uC,EAAK,SAAU,CACb9Z,SAAU+Z,EAAc3vC,MACxBe,aAEJ,CDeA,OC5BAI,EAAAA,EAAAA,KACE,IAAMuF,EAAMkvB,WACXA,IACC+Z,EAAc3vC,OAAQqK,EAAAA,EAAAA,WAAUurB,EAAS,GAE3C,CAAE1pB,MAAM,IDuBH,CAAC/F,EAAUgG,MACRC,EAAAA,EAAAA,OAAcrG,EAAAA,EAAAA,IAAoB,OAAQ6B,GAAY,EAC5DC,EAAAA,EAAAA,IAAoB,QAAS,KAAM,EACjCqF,EAAAA,EAAAA,KAAgBrF,EAAAA,EAAAA,IAAoB,QAAS,CAC3CjB,KAAM,WACN,sBAAuBuF,EAAO,KAAOA,EAAO,GAAM9D,GAAkBsnC,EAAc3vC,MAAM85B,QAAWzxB,GACnGmF,SAAUoiC,GACT,KAAM,KAAM,CACb,CAAC/hC,EAAAA,GAAiB8hC,EAAc3vC,MAAM85B,YAExCvsB,EAAAA,EAAAA,IAAiB,KAAMhB,EAAAA,EAAAA,IAAiBpG,EAAKpD,SAAS,uCAAwC,KAE/F4sC,EAAc3vC,MAAM85B,UAChB1tB,EAAAA,EAAAA,OAAcrG,EAAAA,EAAAA,IAAoBgC,EAAAA,GAAW,CAAEI,IAAK,GAAK,EACxDN,EAAAA,EAAAA,IAAoB,QAAS,KAAM,EACjC0F,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,IAAiBpG,EAAKpD,SAAS,iBAAmB,IAAK,IACxEmK,EAAAA,EAAAA,KAAgBrF,EAAAA,EAAAA,IAAoB,QAAS,CAC3CjB,KAAM,OACN,sBAAuBuF,EAAO,KAAOA,EAAO,GAAM9D,GAAkBsnC,EAAc3vC,MAAM+5B,aAAgB1xB,GACxG8E,QAAShB,EAAO,KAAOA,EAAO,GAAM9D,GAAiBunC,EAAe,sBACnE,KAAM,KAAM,CACb,CAACviC,EAAAA,GAAasiC,EAAc3vC,MAAM+5B,mBAGtClyB,EAAAA,EAAAA,IAAoB,QAAS,KAAM,EACjC0F,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,IAAiBpG,EAAKpD,SAAS,wBAA0B,IAAK,IAC/EmK,EAAAA,EAAAA,KAAgBrF,EAAAA,EAAAA,IAAoB,QAAS,CAC3CjB,KAAM,OACN,sBAAuBuF,EAAO,KAAOA,EAAO,GAAM9D,GAAkBsnC,EAAc3vC,MAAMg6B,mBAAsB3xB,GAC9G8E,QAAShB,EAAO,KAAOA,EAAO,GAAM9D,GAAiBunC,EAAe,4BACnE,KAAM,KAAM,CACb,CAACviC,EAAAA,GAAasiC,EAAc3vC,MAAMg6B,yBAGrC,MACHjsB,EAAAA,EAAAA,IAAoB,IAAI,KAGhC,IE/EA,MAAM,IAA2B,OAAgB,GAAQ,CAAC,CAAC,YAAY,qBAEvE,UtCUA,IAAevH,EAAAA,EAAAA,IAAgB,CAC7B8B,KAAM,yBACNqB,KAAAA,GACE,MAAO,CACLE,YAAYpD,EAAAA,EAAAA,IAAwBnI,EAAAA,GAExC,EACAiR,QAAS,CACPxM,SAAQ,KACRgzB,sBAAAA,CAAuBsG,GAIrBj1B,KAAKyC,WAAYhJ,YAAY,CAC3BC,mBAAmB8J,EAAAA,EAAAA,IAAQxD,KAAKzG,gBAAiBkK,IAC/CA,EAAMgrB,iBAAmBwG,EAAQzG,QAAQ,IAE3C70B,UAAWs7B,EAAQt7B,WAEvB,GAEF2F,MAAO,CACL/F,eAAgB,CACdiG,KAAMzE,OACN2E,UAAU,IAGdW,SAAU,CAAC,EACXwQ,WAAY,CACV43B,kBAAiB,GACjBC,YAAW,GACXC,gBAAe,GACfnjC,aAAY,EACZF,cAAaA,KuC9CjB,MAAM,IAA2B,OAAgB,GAAQ,CAAC,CAAC,SAAS,MAEpE,U,qCCJ6BzG,MAAM,e,iBAE7B4B,EAAAA,EAAAA,IAAa,qB,IACbA,EAAAA,EAAAA,IAAa,qB,IACbA,EAAAA,EAAAA,IAAa,qB,IAFbY,GACAI,GACAC,I,IAEG7C,MAAM,uB,IACJA,MAAM,qB,IAGPA,MAAM,oB,UAkBSA,MAAM,uB,UAcNA,MAAM,uB,IAmBnB4B,EAAAA,EAAAA,IAAyC,QAAnC5B,MAAM,uBAAqB,S,uFA7DhCkI,EAAA6hC,iBAAc,WAAzBjqC,EAAAA,EAAAA,IAyEM,MAzEN6B,GAyEM,EAxEJC,EAAAA,EAAAA,IAIS,UAJD5B,MAAM,mBAAoBU,MAAOwH,EAAA8hC,QAAS,gBAAc,S,UAKhEpoC,EAAAA,EAAAA,IAkEM,MAlENmB,GAkEM,EAjEJnB,EAAAA,EAAAA,IAEM,MAFNoB,IAEMsD,EAAAA,EAAAA,IADDyB,EAAArH,OAAK,IAEVkB,EAAAA,EAAAA,IA6DK,KA7DLqB,GA6DK,gBA5DHnD,EAAAA,EAAAA,IA2DKgC,EAAAA,GAAA,MAAAC,EAAAA,EAAAA,IA1DYmG,EAAA+hC,iBAARjjC,K,WADTlH,EAAAA,EAAAA,IA2DK,MAzDFoC,IAAK8E,EAAK1E,GACXtC,OAAKC,EAAAA,EAAAA,IAAA,CAAC,mBAAkB,6BACe+G,EAAK+J,a,CAGpC/J,EAAK+J,WAAQ,WADrBjR,EAAAA,EAAAA,IAcQ,SAdR+gB,EAAAA,EAAAA,IAcQ,C,MAZN,gBAAc,QACN7Z,EAAKyV,YAAU,CAGfzV,EAAKlG,OAAI,WADjB+G,EAAAA,EAAAA,IAKEqiC,EAAA,C,MAHCC,MAAOnjC,EAAKlG,KACbf,KAAK,WACLC,MAAM,yB,gCAERF,EAAAA,EAAAA,IAAgD,OAAhDoD,MAAgD,aAEhDoD,EAAAA,EAAAA,IAAGU,EAAK2/B,OAAK,SAGY,SAAd3/B,EAAKrG,OAAI,WADtBb,EAAAA,EAAAA,IAaI,KAbJ+gB,EAAAA,EAAAA,IAaI,CAAA3e,IAAA,GAXM8E,EAAKyV,YACb2tB,EAAAA,EAAAA,IAAMliC,EAAiBmiC,WAANrjC,KAAI,CAGbA,EAAKlG,OAAI,WADjB+G,EAAAA,EAAAA,IAIEqiC,EAAA,C,MAFCC,MAAOnjC,EAAKlG,KACbd,MAAM,yB,gCAERF,EAAAA,EAAAA,IAAgD,OAAhDqD,MAAgD,aAEhDmD,EAAAA,EAAAA,IAAGU,EAAK2/B,OAAK,SAGF3/B,EAAKlG,OAAI,WADtBhB,EAAAA,EAAAA,IAaQ,SAbR+gB,EAAAA,EAAAA,IAaQ,C,MAXN7gB,MAAM,gBACNoqC,EAAAA,EAAAA,IAAMliC,EAAiBmiC,WAANrjC,IAAI,CACrBzE,SAAS,MAAG,EAEZiE,EAAAA,EAAAA,IAKE0jC,GALFrpB,EAAAA,EAAAA,IAKE,CAJCspB,MAAOnjC,EAAKlG,KACZuB,KAAM2E,EAAK3E,KACZrC,MAAM,yBACEgH,EAAKyV,YAAU,mCACvB,KACFnW,EAAAA,EAAAA,IAAGU,EAAK2/B,OAAK,sBAEf7mC,EAAAA,EAAAA,IASWgC,EAAAA,GAAA,CAAAI,IAAA,IARTkB,IACAxB,EAAAA,EAAAA,IAMS,UANTif,EAAAA,EAAAA,IAMS,CALNxe,KAAM2E,EAAK3E,MACJ2E,EAAKyV,YACb2tB,EAAAA,EAAAA,IAAMliC,EAAiBmiC,WAANrjC,MAAIV,EAAAA,EAAAA,IAElBU,EAAK2/B,OAAK,GAAA52B,KAAA,Y,0BAOzBjQ,EAAAA,EAAAA,IAuBM,MAAAuT,GAAA,gBAtBJvT,EAAAA,EAAAA,IAqBWgC,EAAAA,GAAA,MAAAC,EAAAA,EAAAA,IArBcmG,EAAA+hC,iBAARjjC,K,8BAEPA,EAAK+J,WAAQ,WADrBjR,EAAAA,EAAAA,IAYQ,SAZR+gB,EAAAA,EAAAA,IAYQ,C,MAVL3e,IAAK8E,EAAK1E,GACX,gBAAc,QACN0E,EAAKyV,YAAU,EAEvBjW,EAAAA,EAAAA,IAKE0jC,EAAA,CAJCC,MAAOnjC,EAAKlG,KACZJ,MAAOsG,EAAK2/B,MACb5mC,KAAK,WACLC,MAAM,yB,6CAGVF,EAAAA,EAAAA,IAMI,KANJ+gB,EAAAA,EAAAA,IAMI,C,MANO3e,IAAK8E,EAAK1E,IAAY0E,EAAKyV,YAAY2tB,EAAAA,EAAAA,IAAMliC,EAAiBmiC,WAANrjC,KAAI,EACrER,EAAAA,EAAAA,IAIE0jC,EAAA,CAHCC,MAAOnjC,EAAKlG,KACZJ,MAAOsG,EAAK2/B,MACb3mC,MAAM,yB,0ZCzFhB,MAAMsqC,GASJC,WAAAA,CAAYC,EAAiBC,EAAwB,QAAKC,EAAAA,GAAAA,GAAA,KAAAC,KARjDC,EAAAA,GAAAA,GAAA,KAAAC,GAAoB,iBAE7BD,EAAAA,GAAAA,GAAA,KAAAE,QAAQ,IACRF,EAAAA,GAAAA,GAAA,KAAAG,GAAyB,QAEzBH,EAAAA,GAAAA,GAAA,KAAA1kC,QAAM,IACN0kC,EAAAA,GAAAA,GAAA,KAAAI,QAAS,GAGPC,GAAKH,GAAL3pC,KAAgBqpC,GAChBS,GAAKF,GAAL5pC,KAAiBspC,GAEjBQ,GAAK/kC,GAAL/E,KAAc,IAAI+lC,IAAoBgE,GAAAP,GAAAxpC,KAAKgqC,IAAa9uC,KAAlB8E,QACtC8pC,GAAKD,GAAL7pC,KAAiB,IAAI+lC,IACvB,CAEA,UAAMkE,CAAKjB,GACT,GAAIkB,GAAKnlC,GAAL/E,MAAYomC,IAAI4C,GAClB,OAAO5vC,KAAKC,MAAM6wC,GAAKnlC,GAAL/E,MAAYmD,IAAI6lC,IAGpC,GAAIkB,GAAKL,GAAL7pC,MAAeomC,IAAI4C,GACrB,OAAOkB,GAAKL,GAAL7pC,MAAemD,IAAI6lC,GAG5B,MAAMmB,EAAenB,GACnB,uBAAuBoB,KAAKpB,GAExB/W,EAAMkY,EAAYnB,GACpBA,EACA,GAAGkB,GAAKP,GAAL3pC,0BAAkCgpC,QAEnCqB,EAAU,WACd,IACE,MAAMC,QAAiBC,MAAMtY,GAC7B,IAAKqY,EAASE,GACZ,MAAM,IAAIxwC,MACR,oBAAoBswC,EAASG,UAAUH,EAASI,cAIpD,MAAM/qC,EAAmB,CACvBgrC,MACEL,EAASM,QAAQznC,IAAI,iBAAiBmK,SAAS,mBAC/C,EACFu9B,QAAS,IAGX,GAAIlrC,EAAKgrC,MAAO,CACd,IAAIG,QAAYR,EAAS73B,OACzBq4B,EAAMA,EAAI5qC,QAAQ,wBAAyB,uBAC3C4qC,EAAMA,EAAI5qC,QAAQ,0BAA2B,IAC7CP,EAAKkrC,QAAUC,C,KACV,CACL,MAAMC,QAAaT,EAASS,OAC5BprC,EAAKkrC,cAAgB,IAAIzqB,SAASC,IAChC,MAAM2qB,EAAS,IAAIC,WACnBD,EAAOzqB,OAAS,IAAMF,EAAQ2qB,EAAOngC,QACrCmgC,EAAOE,cAAcH,EAAK,G,CAM9B,OAFA/qC,KAAKlG,MAAMkvC,EAAOrpC,GAEXA,C,CACP,MAAOqM,GAEP,OADApS,QAAQoS,MAAM,qCAAqCg9B,IAASh9B,GACrD,CACL2+B,OAAO,EACPE,QAAS,G,CAEX,QACAX,GAAKL,GAAL7pC,MAAemrC,OAAOnC,E,CAEzB,EA1Ce,GA8ChB,OAFAkB,GAAKL,GAAL7pC,MAAeoD,IAAI4lC,EAAOqB,GAEnBA,CACT,CAEAvwC,KAAAA,CAAMkvC,EAAerpC,GACnBuqC,GAAKnlC,GAAL/E,MAAYoD,IAAI4lC,EAAO5vC,KAAKE,UAAUqG,IAEtCoqC,GAAAP,GAAAxpC,KAAKorC,IAAWlwC,KAAhB8E,OAAoBqrC,QAClBnB,GAAKR,GAAL1pC,MACA5G,KAAKE,UAAU,IAAI4wC,GAAKnlC,GAAL/E,QAEvB,EAqBD,SAAAorC,KAlBG,MAAuB,QAAnBlB,GAAKN,GAAL5pC,MACK,KAEiB,YAAnBkqC,GAAKN,GAAL5pC,MAA+BsrC,eAAiBC,YACzD,CAAC,SAAAvB,KAGC,MAAMwB,EAASzB,GAAAP,GAAAxpC,KAAKorC,IAAWlwC,KAAhB8E,OAAoByrC,QAAQvB,GAAKR,GAAL1pC,OAC3C,IAAKwrC,EACH,MAAO,GAGT,IACE,OAAOpyC,KAAKC,MAAMmyC,E,CAClB,MACA,MAAO,E,CAEX,CAGF,MAAME,GAAgB,IAAIvC,GAAWrtC,OAAOC,OAAO4M,WAAY,WAE/D,UCtHA,MAAMnI,GAAa,CACjBO,IAAK,EACLlC,MAAO,2BAEH6B,GAAa,CAAEK,IAAK,GA0B1B,QAA4BuB,EAAAA,EAAAA,IAAiB,CAC3ChD,MAAO,CACLqsC,SAAU,KACVzqC,KAAM,KACNtC,KAAM,CAAEgB,QAAS,aACjBopC,MAAO,KACP3+B,KAAM,CAAEzK,QAAS,MACjBg4B,OAAQ,CAAEp4B,KAAM+mC,QAAS3mC,SAAS,GAClC6S,KAAM,MAERlQ,KAAAA,CAAMC,GAER,MAAMlD,EAAQkD,ECJRmoC,GAAQ5nC,EAAAA,EAAAA,KAAI,GACZ8nC,GAAU9nC,EAAAA,EAAAA,IAAI,IAEd6oC,GAAQC,EAAAA,EAAAA,MACRC,GAAYzrC,EAAAA,EAAAA,KAAS,KAAM,CAC/BsrC,SAAUrsC,EAAMqsC,SAChB9sC,MAAOktC,EAASnzC,MAChBiyC,QAASA,EAAQjyC,MACjB+xC,MAAOA,EAAM/xC,MACbsJ,MAAO8pC,EAAcpzC,UAEjBqzC,GAAW5rC,EAAAA,EAAAA,KAAS,KAAM,IAC3BurC,KACAE,EAAUlzC,UAGTmzC,GAAW1rC,EAAAA,EAAAA,KAAS,IAAM,CAC9B,cACAf,EAAMs4B,OAAS,qBAAuB,GACtC,aAAat4B,EAAMV,OACnB,cAAcstC,EAAUtzC,WAGpBozC,GAAgB3rC,EAAAA,EAAAA,KAAS,IAC7Bf,EAAM+K,KAAO,CAAEhD,MAAO,GAAG/H,EAAM+K,SAAU/C,OAAQ,GAAGhI,EAAM+K,UAAa,CAAC,IAGpE6hC,GAAY7rC,EAAAA,EAAAA,KAAS,KACzB,MAAM8pC,EAAenB,GACnB,oBAAoBoB,KAAKpB,GAC3B,OAAOmB,EAAY7qC,EAAM0pC,OACrB1pC,EAAM0pC,MAAM9uC,MAAM,KAAKmB,OAAO6E,QAAQ,OAAQ,KAAO,GACrDZ,EAAM0pC,KAAK,KAGjBjvC,EAAAA,EAAAA,KACE,IAAMuF,EAAM0pC,QACZ/oB,UACE,MAAMtgB,QAAyBwsC,GAAWlC,KAAKjB,GAC/C2B,EAAM/xC,MAAQ+G,EAAKgrC,MACnBE,EAAQjyC,MAAQ+G,EAAKkrC,OAAO,GAE9B,CAAE9iC,WAAW,IAGf,MAAMqkC,GAAchtC,EAAAA,EAAAA,IAAgB,CAClCE,MAAO,CACLqrC,MAAOpE,QACPsE,QAASprC,OACTksC,SAAUlsC,OACVssC,SAAUtsC,OACVusC,cAAejxC,QAEjBwH,KAAAA,CAAMjD,GAAO,MAAEssC,IACb,MAAMS,EAAY,CAChBxtC,MAAOS,EAAMysC,SACbntC,KAAMU,EAAMqsC,SACZzpC,MAAO5C,EAAM0sC,iBACVJ,GAGL,MAAO,IACLtsC,EAAMqrC,OACFlpB,EAAAA,EAAAA,GAAE,MAAO,CACPjP,UAAWlT,EAAMurC,WACdwB,KAEL5qB,EAAAA,EAAAA,GAAE,MAAO,CACPta,IAAK7H,EAAMurC,WACRwB,GAEb,IDWF,MAAO,CAACttC,EAAUgG,IACRvC,EAAQtB,OACX8D,EAAAA,EAAAA,OAAcrG,EAAAA,EAAAA,IAAoB,QAAS6B,GAAY,EACtDC,EAAAA,EAAAA,IAAoB,SAASif,EAAAA,EAAAA,IAAY,CACvClgB,KAAM,SACN2f,OAAQ,KACP/Z,EAAAA,EAAAA,IAAOwmC,IAAS,KAAM,KACzBvmC,EAAAA,EAAAA,KAAaD,EAAAA,EAAAA,IAAOgnC,IAAcE,EAAAA,EAAAA,KAAgBC,EAAAA,EAAAA,KAAoBnnC,EAAAA,EAAAA,IAAO0mC,KAAc,KAAM,IAChGtpC,EAAQiQ,OACJzN,EAAAA,EAAAA,OAAcrG,EAAAA,EAAAA,IAAoB,OAAQ+B,IAAYyE,EAAAA,EAAAA,IAAiB3C,EAAQiQ,MAAO,KACvF9L,EAAAA,EAAAA,IAAoB,IAAI,QAE7B3B,EAAAA,EAAAA,OAAc0B,EAAAA,EAAAA,KAAatB,EAAAA,EAAAA,IAAOgnC,IAAcE,EAAAA,EAAAA,KAAgB5sB,EAAAA,EAAAA,IAAY,CAAE3e,IAAK,IAAKqE,EAAAA,EAAAA,IAAO6mC,KAAa,KAAM,IAEzH,IEtIA,MAAM,GAAc,GAEpB,UJsGA,IACE/qC,KAAM,qBACN2P,WAAY,CAAE27B,WAAUA,IACxBltC,MAAO,CACLmtC,MAAOphC,MACPqhC,WAAY,CACV9sC,QAAS,MAEX2lC,QAAS,CACP/lC,KAAMC,OACNG,QAAS,IAEXL,MAAO,CACLC,KAAMC,OACNG,UACE,OAAOjE,EAAAA,EAAAA,IAAS,WAClB,IAGJkE,IAAAA,GACE,MAAO,CACL8sC,MAAM,EAEV,EACAxkC,QAAS,CACP+gC,UAAAA,CAAWrjC,GACT,IAAI+mC,EAAS,CAAC,EAQd,OAPI/mC,EAAKyiC,OACPsE,EAAO9jB,MAASrtB,IACdA,EAAE8R,iBACFvN,KAAK4Q,MAAMi8B,MAAM7sC,KAAM,CAAC6F,EAAKyiC,MAAM5L,OAAO72B,EAAKinC,eAAiB,KAChE9sC,KAAK+sC,OAAO,GAGTH,CACT,EACAG,KAAAA,GACEjxC,OAAOC,OAAOixC,WAAWC,UAC3B,GAEF5sC,SAAU,CACRyoC,eAAAA,GACE,OAAO9oC,KAAKysC,MAAM5jC,KAAKhD,IACrBA,EAAKrG,KAAOqG,EAAKrG,MAAQ,OACzBqG,EAAKyV,WAAazV,EAAKyV,YAAc,CAAC,EAEpB,SAAdzV,EAAKrG,OACPqG,EAAKyV,WAAWkpB,KAAO3+B,EAAKosB,KAAO,KAG9BpsB,IAEX,EACA+iC,cAAAA,GACE,MAAM8D,EAAa1sC,KAAK0sC,YAAc,EAEtC,OAAmB,IAAfA,KAGe,IAAfA,GAGG/kC,OAAOuR,SAASwzB,IAAe1sC,KAAKysC,MAAMniC,OACnD,EACAu+B,OAAAA,GACE,OAAO7oC,KAAKulC,QACRvlC,KAAKhD,oBAAoBgD,KAAKrE,SAAS,2BAA4B,CACjE4D,MAAOS,KAAKT,MACZgmC,QAASvlC,KAAKulC,UAEhBvlC,KAAKT,KACX,IK7KJ,MAAM,IAA2B,OAAgB,GAAQ,CAAC,CAAC,SAAS,MAEpE,UCJA,MAAM+d,GAAeC,KAAMC,EAAAA,EAAAA,IAAa,mBAAmBD,EAAEA,KAAIE,EAAAA,EAAAA,MAAcF,GACzE/c,GAAa,CAAC,kBACdE,GAAa,CAAE7B,MAAO,0BACtBwC,IAA0B8E,EAAAA,EAAAA,IAAiB,MAC3C1E,GAAa,CAAE5C,MAAO,mBACtB6C,GAAa,CAAEX,IAAK,GACpBY,IAA0BwE,EAAAA,EAAAA,IAAiB,OAC3CvE,GAAa,CAAE/C,MAAO,aACtBgD,GAA2Byb,IAAa,KAAmB7c,EAAAA,EAAAA,IAAoB,OAAQ,KAAM,MAAO,KACpGqB,IAA0BqE,EAAAA,EAAAA,IAAiB,MAC3CpE,GAAc,CAAElD,MAAO,qCACvBmD,GAAc,CAAC,aACfC,GAAc,CAClBlB,IAAK,EACLlC,MAAO,sBAEH+P,GAAc,CAAE/P,MAAO,yBACvBqT,GAAc,CAAErT,MAAO,2BACvBsT,GAAc,CAAC,WACfC,GAAc,CAAC,eACfC,GAAc,CAAC,YAuBrB,QAA4B/P,EAAAA,EAAAA,IAAiB,CAC3ChD,MAAO,CACP4tC,KAAM,CACJ1tC,KAAMzE,OACN2E,UAAU,GAEZytC,SAAU,CACR3tC,KAAMzE,OACN2E,UAAU,IAGZ8Q,MAAO,CACP48B,cAAAA,CAAenY,GACb,OAAO,CACT,EACAoY,gBAAAA,CAAiBH,GACf,OAAO,CACT,EACAI,UAAAA,CAAWC,GACT,OAAO,CACT,EACAC,aAAAA,CAAcrsC,GACZ,OAAO,CACT,EACAssC,mBAAAA,CAAoBP,GAClB,OAAO,CACT,EACAQ,sBAAAA,CAAuBC,GACrB,OAAO,CACT,GAEAprC,KAAAA,CAAMC,GAAS,KAAE8lC,IAEnB,MAAMhpC,EAAQkD,ECgMRorC,GAAmBvtC,EAAAA,EAAAA,KAAS,IAChCwtC,GAAAA,EAAUC,SAASxuC,EAAM4tC,MAAM5xB,WAAWyY,SAAU,CAClDga,aAAc,CAAEC,MAAM,OAI1B,SAASC,EAAS9sC,GAChB,OAAOrH,GAAAA,GAAMo0C,QAAQ,cAAc,CAAE/sC,MACvC,CACA,MAAMgtC,GAAa9tC,EAAAA,EAAAA,KAA2B,IAC5C4tC,EAAS3uC,EAAM4tC,MAAM5xB,WAAW4Y,cAE5Bka,GAA0B/tC,EAAAA,EAAAA,KAC9B,IAAM8tC,EAAWv1C,OAAO0iB,aAAa,oBAGvC,SAAS+yB,EAAQC,GACf,MAAMC,EAAWD,GAAMhzB,aAAa,YACpC,OAAIizB,EACKzyC,OAAOC,OAAO+rC,UAAUC,OAAO,uBAAwB,CAAEwG,aAEzD,EAEX,CAEA,MAAMC,GAAgBnuC,EAAAA,EAAAA,KAAiB,IAC9BguC,EAAQF,EAAWv1C,SAG5B,SAAS61C,EAAkBd,GACzB,OACEM,EAASN,EAAQryB,WAAW4Y,aAAa5Y,WAAW,oBACpD3f,EAAAA,EAAAA,IAAS,YAEb,CAEA,MAAM+yC,GAAqB3rC,EAAAA,EAAAA,IAAY,IACjC4rC,GAA4B5rC,EAAAA,EAAAA,MAC5B6rC,GAAe7rC,EAAAA,EAAAA,KAAI,GACzB,SAAS8rC,IACPD,EAAah2C,OAAQ,GACrBwP,EAAAA,EAAAA,KAAS,KACP,MAAM0mC,EAAUH,EAA0B/1C,MAGpCm2C,EAAmB,IACpBx9B,SAASy9B,iBAAiB,mCAC7BrpC,QAAQlO,GAAYA,EAAQw3C,SAASH,KACvCC,EAAiBp3C,SAASwkB,GAAWA,EAAO+a,UAAUhd,OAAO,eAC7D40B,EAAQhhC,OAAO,GAEnB,CACAmS,eAAeivB,IACb,UACQC,EAAc,CAClB7zB,WAAY,CACVmZ,QAASn1B,EAAM4tC,KAAK5xB,WAAWna,GAC/B4yB,SAAU2a,EAAmB91C,SAGjC81C,EAAmB91C,MAAQ,E,CAC3B,MAAOoT,GACPlQ,OAAOC,OAAOqzC,OAAOpjC,OACnBrQ,EAAAA,EAAAA,IAAS,mDACT,CAACvC,KAAKE,UAAU0S,EAAO,KAAM,KAE/BpS,QAAQoS,MAAMA,E,CAElB,CACAiU,eAAekvB,EAAcjC,GAC3B,aAAapzC,GAAAA,GAAMu1C,SACjB,8CACAnC,EAEJ,CAEA,MAAMoC,GAAkBvsC,EAAAA,EAAAA,MAClBwsC,GAAmBlvC,EAAAA,EAAAA,KACvB,SAAgC/E,IAA1Bg0C,EAAgB12C,QAExB,SAAS42C,EAAoB7B,GAC3B2B,EAAgB12C,MAAQ+0C,EAAQryB,WAAWna,GAC3CutC,EAAmB91C,MAAQ+0C,EAAQryB,WAAWyY,SAC9C4a,EAA0B/1C,MAAOkV,OACnC,CACA,SAAS2hC,IACPH,EAAgB12C,WAAQ0C,EACxBozC,EAAmB91C,MAAQ,EAC7B,CACAqnB,eAAeyvB,IACb,IACE,IAAKJ,EAAgB12C,MACnB,MAAM,IAAIoB,OACR2B,EAAAA,EAAAA,IAAS,8DAGPg0C,EAAc,CAClBxuC,GAAImuC,EAAgB12C,MACpB0iB,WAAY,CACVyY,SAAU2a,EAAmB91C,SAGjC02C,EAAgB12C,WAAQ0C,EACxBozC,EAAmB91C,MAAQ,E,CAC3B,MAAOoT,GACPlQ,OAAOC,OAAOqzC,OAAOpjC,OACnBrQ,EAAAA,EAAAA,IAAS,mDACT,CAACvC,KAAKE,UAAU0S,EAAO,KAAM,KAE/BpS,QAAQoS,MAAMA,E,CAElB,CAEAiU,eAAe0vB,EAAchC,GAC3B,aAAa7zC,GAAAA,GAAMu1C,SACjB,8CACA1B,EAEJ,CAEA,SAASiC,IACP,MAAMC,EAAmB,CACvBC,UAAW,IACXtK,OAAO7pC,EAAAA,EAAAA,IAAS,WAChBgE,KAAM,QACN2oC,KAAM,cAEFyH,EAAyB,CAC7BD,UAAW,IACXtK,OAAO7pC,EAAAA,EAAAA,IAAS,cAChBgE,KAAM,OACN2oC,KAAM,oBAER,MAAO,IACDhpC,EAAM4tC,KAAK5Y,KAAKC,YAAYjB,UAAY,CAACuc,GAAoB,MAC7DvwC,EAAM4tC,KAAK5Y,KAAKC,YAAYlB,QAAU,CAAC0c,GAA0B,GACrE,CACED,UAAW,IACXtK,OAAO7pC,EAAAA,EAAAA,IAAS,gBAChBgE,KAAM,UACN2oC,KAAM,uBAER,CACEwH,UAAW,IACXtwC,KAAM,OACNgmC,OAAO7pC,EAAAA,EAAAA,IAAS,uBAChBgE,KAAM,QACNsyB,IAAKuc,EAAc51C,OAGzB,CAEA,SAASo3C,EAAuBrC,GAC9B,MAAMsC,EAAe,CACnBH,UAAW,IACXtK,OAAO7pC,EAAAA,EAAAA,IAAS,WAChBgE,KAAM,QACN2oC,KAAM,iBAEF4H,EAAqB,CACzBJ,UAAW,IACXtK,OAAO7pC,EAAAA,EAAAA,IAAS,cAChBgE,KAAM,OACN2oC,KAAM,uBAER,MAAO,IACDqF,EAAQrZ,KAAKC,YAAYjB,UAAY,CAAC2c,GAAgB,MACtDtC,EAAQrZ,KAAKC,YAAYlB,QAAU,CAAC6c,GAAsB,GAC9D,CACEJ,UAAW,IACXtwC,KAAM,OACNgmC,OAAO7pC,EAAAA,EAAAA,IAAS,uBAChBgE,KAAM,QACNsyB,IAAKoc,EAAQJ,EAASN,EAAQryB,WAAW4Y,cAG/C,CACA,SAASoZ,EAAWnsC,GAClBmnC,EAAK,aAAcnnC,EACrB,CACA,SAASksC,EAAiBH,GACxB5E,EAAK,mBAAoB4E,EAC3B,CACA,SAASM,EAAcrsC,GACrBmnC,EAAK,gBAAiBnnC,EACxB,CAEA,SAASgvC,EAAiBpb,GACxBuT,EAAK,iBAAkBvT,EACzB,CD1LA,MAAO,CAACh2B,EAAUgG,MACRC,EAAAA,EAAAA,OAAcrG,EAAAA,EAAAA,IAAoB,MAAO,CAC/CE,MAAO,iBACP,iBAAkB2D,EAAQ0qC,KAAK5xB,WAAW0Y,WACzC,EACDvzB,EAAAA,EAAAA,IAAoB,KAAMC,GAAY,CACpCW,IACAZ,EAAAA,EAAAA,IAAoB,OAAQgB,GAAY,EACtChB,EAAAA,EAAAA,IAAoB,IAAK,CACvB+jC,KAAM,IACNxjC,QAAS+D,EAAO,KAAOA,EAAO,IAAKG,EAAAA,EAAAA,KAAgBjE,GAAiBkvC,EAAiB3tC,EAAQ0qC,KAAK5xB,WAAWqY,aAAc,CAAC,eAC3HxuB,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAO80B,GAAP90B,CAA6B5C,EAAQ0qC,KAAK5xB,WAAWqY,YAAY,EAAO,MAAO,GAClGnxB,EAAQ0qC,KAAK5xB,WAAWuY,WACpB7uB,EAAAA,EAAAA,OAAcrG,EAAAA,EAAAA,IAAoB,OAAQ+C,GAAY,CACrDC,IACAlB,EAAAA,EAAAA,IAAoB,IAAK,CACvB+jC,KAAM,IACNxjC,QAAS+D,EAAO,KAAOA,EAAO,IAAKG,EAAAA,EAAAA,KAAgBjE,GAAiBkvC,EAAiB3tC,EAAQ0qC,KAAK5xB,WAAWuY,WAAY,CAAC,eACzH1uB,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAO80B,GAAP90B,CAA6B5C,EAAQ0qC,KAAK5xB,WAAWuY,UAAU,EAAO,MAAO,OAEnGltB,EAAAA,EAAAA,IAAoB,IAAI,MAE9BlG,EAAAA,EAAAA,IAAoB,OAAQmB,IAAYuD,EAAAA,EAAAA,IAAiB3C,EAAQ0qC,KAAK5xB,WAAW0Y,WAAY,GAC7FnyB,IACApB,EAAAA,EAAAA,IAAoB,IAAK,CACvB+jC,KAAM,IACNxjC,QAAS+D,EAAO,KAAOA,EAAO,IAAKG,EAAAA,EAAAA,KAAgBjE,GAAiBlC,EAAK6R,MAAM,sBAAuBpO,EAAQ0qC,OAAQ,CAAC,cACtH,KAAM/nC,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOgpC,IAA2B,GAC5DtsC,IACAuD,EAAAA,EAAAA,IAAa+qC,GAAkB,CAC7B7wC,OAAO6F,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,YACxBqnC,MAAOmD,IACPlD,YAAY,EACZ7tC,MAAO,6BACPwxC,aAActrC,EAAO,KAAOA,EAAO,GAAM9D,GAAiBqsC,EAAW9qC,EAAQ0qC,KAAK5xB,WAAWna,KAC7FmvC,mBAAoBvrC,EAAO,KAAOA,EAAO,GAAM9D,GAAiBosC,EAAiB7qC,EAAQ0qC,OACzFqD,sBAAuB1B,GACtB,KAAM,EAAG,CAAC,QAAS,aAExBpuC,EAAAA,EAAAA,IAAoB,MAAOsB,GAAa,EACtCtB,EAAAA,EAAAA,IAAoB,IAAK,CACvB5B,MAAO,0BACP2T,WAAWpN,EAAAA,EAAAA,IAAOwoC,IACjB,KAAM,EAAG5rC,IACX4sC,EAAah2C,OAAS4J,EAAQ2qC,SAAS7iC,OAAS,IAC5CtF,EAAAA,EAAAA,OAAcrG,EAAAA,EAAAA,IAAoB,UAAWsD,GAAa,EACzDxB,EAAAA,EAAAA,IAAoB,OAAQ,CAC1B5B,MAAO,UACPoG,SAAUF,EAAO,KAAOA,EAAO,IAAKG,EAAAA,EAAAA,KAAe,QAAU,CAAC,cAC7D,EACDzE,EAAAA,EAAAA,IAAoB,WAAYmO,GAAa,EAC3CnO,EAAAA,EAAAA,IAAoB,SAAU,KAAM,CACjC+B,EAAQ2qC,SAAS7iC,OAAS,IACtBtF,EAAAA,EAAAA,OAAcrG,EAAAA,EAAAA,IAAoBgC,EAAAA,GAAW,CAAEI,IAAK,GAAK,EACxDoF,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOpI,EAAAA,GAAPoI,EACtCA,EAAAA,EAAAA,IAAOtI,EAAAA,GAAPsI,CACE,kCACA,mCACA5C,EAAQ2qC,SAAS7iC,QAEnB,CAAEkmC,iBAAkBhuC,EAAQ2qC,SAAS7iC,UACnC,IACG,OACFtF,EAAAA,EAAAA,OAAcrG,EAAAA,EAAAA,IAAoBgC,EAAAA,GAAW,CAAEI,IAAK,GAAK,EACxDoF,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,iBAAkB,IACpE,QAET3E,EAAAA,EAAAA,IAAoB,MAAOyR,GAAa,GACrClN,EAAAA,EAAAA,KAAW,IAAOrG,EAAAA,EAAAA,IAAoBgC,EAAAA,GAAW,MAAMC,EAAAA,EAAAA,IAAY4B,EAAQ2qC,UAAWQ,KAC7E3oC,EAAAA,EAAAA,OAAcrG,EAAAA,EAAAA,IAAoB,IAAK,CAC7CE,MAAO,oBACPkC,IAAK4sC,EAAQryB,WAAWna,IACvB,EACDV,EAAAA,EAAAA,IAAoB,IAAK,CACvB5B,MAAO,2BACP2lC,KAAM,IACNxjC,SAASkE,EAAAA,EAAAA,KAAgBjE,GAAiBlC,EAAK6R,MAAM,yBAA0B+8B,IAAW,CAAC,aAC1F,KAAMxoC,EAAAA,EAAAA,IAAiBspC,EAAkBd,IAAW,EAAGx7B,KAC1DhM,EAAAA,EAAAA,IAAiB,KAAMhB,EAAAA,EAAAA,IAAiBwoC,EAAQryB,WAAWyY,UAAY,IAAK,GAC3Eic,EAAuBrC,GAASrjC,OAAS,IACrCtF,EAAAA,EAAAA,OAAc0B,EAAAA,EAAAA,IAAa0pC,GAAkB,CAC5CrvC,IAAK,EACLxB,OAAO6F,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,YACxBqnC,MAAOuD,EAAuBrC,GAC9BjB,YAAY,EACZ7tC,MAAO,gCACP4xC,gBAAkBxvC,GAAiBusC,EAAcG,EAAQryB,WAAWna,IACpEuvC,sBAAwBzvC,GAAiBuuC,EAAoB7B,IAC5D,KAAM,EAAG,CAAC,QAAS,QAAS,kBAAmB,4BAClDhnC,EAAAA,EAAAA,IAAoB,IAAI,QAE5B,SAENlG,EAAAA,EAAAA,IAAoB,MAAO,KAAM,EAC/BA,EAAAA,EAAAA,IAAoB,OAAQ,CAC1B5B,MAAO,iBACPoG,SAAUF,EAAO,KAAOA,EAAO,IAAKG,EAAAA,EAAAA,KAAgBjE,IACtDmE,EAAAA,EAAAA,IAAOmqC,GAAoBG,IAAwBR,KAClD,CAAC,cACC,EACDppC,EAAAA,EAAAA,KAAgBrF,EAAAA,EAAAA,IAAoB,QAAS,CAC3CjB,KAAM,OACNwG,aAAaZ,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,+BAC9B,sBAAuBL,EAAO,KAAOA,EAAO,GAAM9D,GAAkBytC,EAAoB91C,MAAQqI,GAChGsN,QAAS,4BACTxL,IAAK4rC,GACJ,KAAM,EAAGv8B,IAAc,CACxB,CAACnM,EAAAA,GAAayoC,EAAmB91C,UAElCwM,EAAAA,EAAAA,IAAOmqC,KACHvqC,EAAAA,EAAAA,OAAcrG,EAAAA,EAAAA,IAAoB,SAAU,CAC3CoC,IAAK,EACLvB,KAAM,SACNX,MAAO,8CACPmC,QAASyuC,IACRtqC,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,iBAAkB,KACvDuB,EAAAA,EAAAA,IAAoB,IAAI,IAC5BlG,EAAAA,EAAAA,IAAoB,SAAU,CAC5B5B,MAAO,oCACPW,KAAM,SACNoQ,SAAqD,IAA3C8+B,EAAmB91C,MAAM6d,OAAOnM,SACzCnF,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOmqC,IACvBnqC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,kBACjBA,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,eAAgB,EAAGiN,KACvC,SAGN,QAEL1L,EAAAA,EAAAA,IAAoB,IAAI,MAE7B,EAAGnG,IAER,IEhZA,MAAM,IAA2B,OAAgB,GAAQ,CAAC,CAAC,YAAY,qBAEvE,U,WCNA,MAAM8c,GAAeC,KAAMC,EAAAA,EAAAA,IAAa,mBAAmBD,EAAEA,KAAIE,EAAAA,EAAAA,MAAcF,GACzE/c,GAAa,CACjBO,IAAK,EACLlC,MAAO,kBAEH6B,GAAa,CAAE7B,MAAO,yBACtBwC,GAAa,CAAExC,MAAO,uBACtB4C,GAAa,CAAC,WACdC,GAAa,CAAC,WACdC,GAA2B2b,IAAa,KAAmB7c,EAAAA,EAAAA,IAAoB,SAAU,CAAE7H,MAAO,QAAU,QAAS,KACrHgJ,GAA2B0b,IAAa,KAAmB7c,EAAAA,EAAAA,IAAoB,SAAU,CAAE7H,MAAO,SAAW,SAAU,KACvHiJ,GAA2Byb,IAAa,KAAmB7c,EAAAA,EAAAA,IAAoB,SAAU,CAAE7H,MAAO,SAAW,SAAU,KACvHkJ,GAA2Bwb,IAAa,KAAmB7c,EAAAA,EAAAA,IAAoB,SAAU,CAAE7H,MAAO,QAAU,QAAS,KACrHmJ,GAAc,CAClBJ,GACAC,GACAC,GACAC,IAEIE,GAAc,CAAC,YACfC,GAAc,CAAEpD,MAAO,+BACvB+P,GAAc,CAAC,QACfsD,GAAc,CAAErT,MAAO,0BACvBsT,GAAc,CAAEtT,MAAO,cACvBuT,GAAc,CAAC,eACfC,GAAc,CAAC,SACfgU,GAA4B/I,IAAa,KAAmB7c,EAAAA,EAAAA,IAAoB,SAAU,CAAE5B,MAAO,qBAAuB,MAAO,KACjIynB,GAAc,CAAEznB,MAAO,iCACvB0nB,GAAc,CAAE1nB,MAAO,mBAqC7B,QAA4ByD,EAAAA,EAAAA,IAAiB,CAC3ChD,MAAO,CACP8J,KAAM,CACJ5J,KAAMzE,OACN2E,UAAU,IAGZ6C,KAAAA,CAAMC,GAER,MAAMlD,EAAQkD,ECvCRE,EAAQ5G,OAAOC,OAAO6G,gBAAgBC,iBAEtC++B,GAAc7+B,EAAAA,EAAAA,SAClBzH,GAGF,SAASq1C,EAAqB5b,GAC5B6b,EAAU7b,EACZ,CAEA,SAAS8b,EAAmB11B,GAC1B,MAAMmzB,EAAOwC,EAAY31B,GACzB,IAAKmzB,EACH,MAAM,IAAIt0C,MAAM,wBAA0BmhB,GAE5C41B,EAAYn4C,MAAQ,IAAM01C,EAAKhzB,WAAWizB,QAC5C,CACA,SAASyC,EAAiB9D,GACxB2D,EAAmB3D,EAAK5xB,WAAW4Y,WACrC,CACA,SAAS+c,EAAoBtD,GAC3BkD,EAAmBlD,EAAQryB,WAAW4Y,WACxC,CACAjU,eAAeutB,EAAcrsC,GAC3B,MAAM+hC,GAASvnC,EAAAA,EAAAA,IAAS,qBAClBwnC,EAAYrnC,OAAOsnC,QAAQF,GACjC,GAAKC,EAIL,UACQrpC,GAAAA,GAAMu1C,SAAS,8CAA+C,CAClEluC,OAEFrF,OAAOC,OAAOqzC,OAAO/5B,SAAQ1Z,EAAAA,EAAAA,IAAS,iC,CACtC,MAAOqQ,GACPlQ,OAAOC,OAAOqzC,OAAOpjC,OACnBrQ,EAAAA,EAAAA,IAAS,+CACT,CAACvC,KAAKE,UAAU0S,EAAO,KAAM,KAE/BpS,QAAQoS,MAAMA,E,MAbdpS,QAAQypC,KAAK,iCAejB,CAEA,MAAM6N,GAAenuC,EAAAA,EAAAA,MACrB,SAASsqC,EAAiBH,GACxB,GAC6B,KAA3BiE,EAAiBv4C,YACQ0C,IAAzB81C,EAAex4C,YACQ0C,IAAvB+1C,EAAaz4C,MACb,CACA,MAAMuqC,EAAYC,SAChBznC,EAAAA,EAAAA,IAAS,kDAEX,IAAKwnC,EACH,M,CAGJ+N,EAAat4C,MAAQs0C,EAAK5xB,WAAWna,GACrCgwC,EAAiBv4C,MAAQs0C,EAAK5xB,WAAWyY,SACzCud,EAAc14C,MAAQs0C,EAAK5xB,WAAW0Y,UACtCod,EAAex4C,MAAQs0C,EAAK5xB,WAAWqY,WACvC0d,EAAaz4C,MAAQs0C,EAAK5xB,WAAWuY,eAAYv4B,GAEjD8M,EAAAA,EAAAA,KAAS,KAEP,MAAM4I,EAAYugC,EAAwB34C,MAAOsY,IAC3CC,EAASrV,OAAOC,OAAOkV,QAAQG,UAAUJ,GAC/CG,EAAQqgC,QAASC,KAAK3jC,QAEtBqD,EAAQG,MAAMM,QAAQC,IACpBA,EAAO6/B,aACL7/B,EAAO8/B,iBAAiBxgC,EAAQG,MAAMC,SAASqgC,UAAY,OAC5D,GACD,GAEN,CAEA,SAASC,IACP,GAC6B,KAA3BV,EAAiBv4C,YACQ0C,IAAzB81C,EAAex4C,YACQ0C,IAAvB+1C,EAAaz4C,MACb,CACA,MAAMuqC,EAAYC,SAChBznC,EAAAA,EAAAA,IAAS,kDAEX,IAAKwnC,EACH,M,CAGJ+N,EAAat4C,WAAQ0C,EACrB61C,EAAiBv4C,MAAQ,GACzB04C,EAAc14C,MAAQ,OACtBw4C,EAAex4C,WAAQ0C,EACvB+1C,EAAaz4C,WAAQ0C,CACvB,CAEA2kB,eAAeqtB,EAAWnsC,GACxB,MAAM+hC,GAASvnC,EAAAA,EAAAA,IAAS,gBAClBwnC,EAAYrnC,OAAOsnC,QAAQF,GACjC,GAAKC,EAIL,UACQrpC,GAAAA,GAAMu1C,SAAS,2CAA4C,CAC/DluC,OAEFrF,OAAOC,OAAOqzC,OAAO/5B,SAAQ1Z,EAAAA,EAAAA,IAAS,4B,CACtC,MAAOqQ,GACPlQ,OAAOC,OAAOqzC,OAAOpjC,OACnBrQ,EAAAA,EAAAA,IAAS,0CACT,CAACvC,KAAKE,UAAU0S,EAAO,KAAM,KAE/BpS,QAAQoS,MAAMA,E,MAbdpS,QAAQypC,KAAK,iCAejB,CAEA,SAASuN,EAAU7b,GACjB6M,EAAYhpC,MAAOs8B,OAAQ6C,YAAYhD,EACzC,CAEA,MAAMgD,GAAch1B,EAAAA,EAAAA,IAAI,GACxB,SAAS0/B,EAAa1N,GACpBgD,EAAYn/B,MAAQm8B,CACtB,CAEA,MAAMqc,GAAiBruC,EAAAA,EAAAA,MACvB,SAAS+uC,IACHV,EAAex4C,MACjBg4C,EAAUQ,EAAex4C,OAEzBw4C,EAAex4C,MAAQm/B,EAAYn/B,KAEvC,CACA,SAASm5C,IACPX,EAAex4C,WAAQ0C,CACzB,CAEA,MAAM+1C,GAAetuC,EAAAA,EAAAA,MACrB,SAASivC,IACHX,EAAaz4C,MACfg4C,EAAUS,EAAaz4C,OAEvBy4C,EAAaz4C,MAAQm/B,EAAYn/B,KAErC,CACA,SAASq5C,IACPZ,EAAaz4C,WAAQ0C,CACvB,CAEA,SAAS42C,IACPp4C,GAAAA,GAAMu1C,SAAS,iBAAkB,CAAEluC,GAAIrF,OAAOC,OAAOggB,SACvD,CAEA,MAAMo2B,GAAiBpvC,EAAAA,EAAAA,MACvB,SAASqvC,IACP,IAAK35C,GAAAA,GAAgB45C,iBACnB,MAAM,IAAIr4C,MAAM,gDAERF,GAAAA,GACPu1C,SAAS,8CAA+C,CACvD1pC,OAAQ,CACN8tB,SAAUh7B,GAAAA,GAAgB45C,iBAAiBlxC,GAC3CuyB,WAAYj7B,GAAAA,GAAgB45C,iBAAiB7yC,MAE/Cmd,QAAS,CACPurB,QAAS,8BACT,gBAAiB,6BAGpBhrB,MAAMrS,GAAWjR,QAAQC,IAAI,oCAAqCgR,KAClEuS,OAAOpR,IACNmmC,EAAev5C,MAAQoT,EACvBpS,QAAQoS,MAAM,QAASA,EAAM,GAInC,CACA,MAAMsmC,GAAWjyC,EAAAA,EAAAA,KACf,IAAMvG,GAAAA,GAAMo0C,QAAQ,2CAGhBqE,GAAmBlyC,EAAAA,EAAAA,KAAsB,KAC7C,MAAMya,EAAyC,GACzC03B,EAA4B,GAClC,IAAK,IAAIC,KAAUH,EAAS15C,MAAO,CACjC,MAAM85C,EAASze,GAAmB0e,UAAUF,GACxCC,EAAOr9B,QACTm9B,EAAUhxC,KAAKkxC,EAAO7yC,MAEtBib,EAAOtZ,KAAKkxC,E,CAGhB,MAAO,CAACF,EAAW13B,EAAO,IAEtB83B,GAAcvyC,EAAAA,EAAAA,KAAyB,IAAMkyC,EAAiB35C,MAAM,KACpEi6C,GAAexyC,EAAAA,EAAAA,KACnB,IAAMkyC,EAAiB35C,MAAM,KAIzBk6C,GAAyBzyC,EAAAA,EAAAA,KAAyB,IAC/CuyC,EAAYh6C,MAChB+M,QAAQunC,GAAS6F,EAAkB7F,EAAM6D,EAAYn4C,SACrDo6C,UAAS,CAACjqC,EAAGC,IAAMD,EAAEuS,WAAWqY,WAAa3qB,EAAEsS,WAAWqY,eAI/D,SAASof,EAAkB7F,EAAoB+F,GAC7C,GAAKA,EAEE,CACL,MAAMC,EAASpC,EAAY5D,EAAK5xB,WAAW4Y,YACrCif,EAAQ,CACZjG,EAAK5xB,WAAWyY,SAChBmZ,EAAK5xB,WAAW0Y,UAChBkf,GAAQ53B,WAAWizB,UAAY,GAC/B2E,GAAQ53B,WAAW,mBAAqB,IAEpC83B,EAAiBC,EAAaJ,GAC9B9F,EAAWmG,EAAgBpG,GACjC,OACEiG,EAAMlmC,MAAMwF,GAAS4gC,EAAa5gC,GAAMnF,SAAS8lC,MACjDjG,EAASlgC,MAAM0gC,GAAY4F,EAAqB5F,EAASyF,I,CAb3D,OAAO,CAgBX,CACA,SAASG,EACP5F,EACAyF,GAEA,MAAMF,EAASpC,EAAYnD,EAAQryB,WAAW4Y,YACxCif,EAAQ,CACZxF,EAAQryB,WAAWyY,SACnBmf,GAAQ53B,WAAWizB,UAAY,GAC/B2E,GAAQ53B,WAAW,mBAAqB,IAE1C,OAAO63B,EAAMlmC,MAAMwF,GAAS4gC,EAAa5gC,GAAMnF,SAAS8lC,IAC1D,CAEA,SAASC,EAAaG,GACpB,OAAOA,EACJvzC,cACAwzC,WAAW,6BAA8B,IACzCh9B,MACL,CAEA,MAAMi9B,GAAiBrzC,EAAAA,EAAAA,KAA4B,IAC1CvG,GAAAA,GAAMo0C,QAAQ,4CAA4CyF,SAC9DC,IACC,MAAMC,EAAgBnf,GAAsBie,UAAUiB,GACtD,OAAIC,EAAcx+B,QACTw+B,EAAch0C,KAEd,E,MAKTi0C,GAAkBzzC,EAAAA,EAAAA,KAAoB,IACnCvG,GAAAA,GAAMo0C,QAAQ,4CAA4CyF,SAC9DC,IACC,MAAMC,EAAgBnf,GAAsBie,UAAUiB,GACtD,OAAKC,EAAcx+B,QAGV,GAFA,CAAEu+B,SAAQ5nC,MAAO6nC,EAAc7nC,M,MAkB9C,SAASsnC,EAAgBpG,GACvB,OAAOwG,EAAe96C,MAAM+M,QACzBgoC,GAAYA,EAAQryB,WAAWmZ,UAAYyY,EAAK5xB,WAAWna,IAEhE,EAfApH,EAAAA,EAAAA,KACE,IAAM+5C,EAAgBl7C,QACtB,KACuC,IAAjCk7C,EAAgBl7C,MAAM0R,SAG1B1Q,QAAQoS,MAAM,GAAG8nC,EAAgBl7C,wCACjCgB,QAAQoS,MAAM8nC,EAAgBl7C,OAAM,IAUxC,MAAMm7C,GAAkB1zC,EAAAA,EAAAA,KAAmB,KACzC,MAAM2zC,EAAcpB,EAAYh6C,MAAMiQ,KAAKqkC,GAClCA,EAAK5xB,WAAW4Y,aAEnB+f,EAAiBP,EAAe96C,MACnC+M,QAAQgoC,GACPiF,EAAYh6C,MAAMqU,MACfigC,GAASA,EAAK5xB,WAAWna,KAAOwsC,EAAQryB,WAAWmZ,YAGvD5rB,KAAK8kC,GAAYA,EAAQryB,WAAW4Y,aAEvC,MAAO,IAAI,IAAIhK,IAAI8pB,EAAYtX,OAAOuX,IAAiB,IAGzD,SAASC,EAAa/yC,GACpB,MAAMmtC,EAAOwC,EAAY3vC,GACzB,OAAImtC,EACKxyC,OAAOC,OAAO+rC,UAAUC,OAAO,uBAAwB,CAC5DwG,SAAUD,EAAKhzB,WAAWizB,WAGrB,EAEX,CACA,SAASuC,EAAY3vC,GACnB,OAAOrH,GAAAA,GAAMo0C,QAAQ,cAAc,CAAE/sC,MACvC,EAEA2I,EAAAA,EAAAA,KAAU,KACRsoC,IACAF,GAAiB,IAGnB,MAAMnB,GAAchuC,EAAAA,EAAAA,IAAY,IAC1BouC,GAAmBpuC,EAAAA,EAAAA,IAAY,IAC/BwuC,GAA0BxuC,EAAAA,EAAAA,MAG1BuuC,GAAgBvuC,EAAAA,EAAAA,IAAsB,QACtCoxC,GAAkBpxC,EAAAA,EAAAA,MACxB,SAASqxC,IACPrD,EAAYn4C,MAAQ,EACtB,CAEAqnB,eAAeo0B,EAAWnH,GACxB,aAAapzC,GAAAA,GAAMu1C,SAAS,2CAA4CnC,EAC1E,CACAjtB,eAAeq0B,EAAWpH,GACxB,aAAapzC,GAAAA,GAAMu1C,SAAS,2CAA4CnC,EAC1E,CACA,SAASqH,IAEP,GADA36C,QAAQC,IAAI,kBACPyF,EAAM8J,KACT,MAAM,IAAIpP,MAAM,qBAElB,IAAKvB,GAAAA,GAAgB45C,iBACnB,MAAM,IAAIr4C,MAAM,gDAElB,MAAMw6C,EAAMH,EAAW,CACrB/4B,WAAY,CACVyY,SAAUod,EAAiBv4C,MAC3Bo7B,UAAWsd,EAAc14C,MACzB+6B,WAAYyd,EAAex4C,OAAS,EACpCi7B,SAAUwd,EAAaz4C,OAAS,KAChC66B,SAAUh7B,GAAAA,GAAgB45C,iBAAiBlxC,GAC3CuyB,WAAYj7B,GAAAA,GAAgB45C,iBAAiB7yC,QAG9C0d,MAAMrS,IACLjR,QAAQC,IAAI,wBAAyBgR,GACrCsmC,EAAiBv4C,MAAQ,GACzBw4C,EAAex4C,WAAQ0C,EACvB+1C,EAAaz4C,WAAQ0C,EACrB64C,EAAgBv7C,WAAQ0C,CAAS,IAElC8hB,OAAOpR,IACNpS,QAAQoS,MAAM,QAASA,GACvBmoC,EAAgBv7C,MAAQoT,EACxBlQ,OAAOC,OAAOqzC,OAAOpjC,OACnBrQ,EAAAA,EAAAA,IAAS,0CACT,CAACvC,KAAKE,UAAU0S,EAAO,KAAM,IAC9B,IAEL,OAAOwoC,CACT,CAEA,SAASC,IAEP,GADA76C,QAAQC,IAAI,kBACPyF,EAAM8J,KACT,MAAM,IAAIpP,MAAM,qBAElB,IAAKvB,GAAAA,GAAgB45C,iBACnB,MAAM,IAAIr4C,MAAM,gDAElB,QAA2BsB,IAAvB41C,EAAat4C,MACf,MAAM,IAAIoB,MAAM,6BAElB,MAAMw6C,EAAMF,EAAW,CACrBnzC,GAAI+vC,EAAat4C,MACjB0iB,WAAY,CACVyY,SAAUod,EAAiBv4C,MAC3Bo7B,UAAWsd,EAAc14C,MACzB+6B,WAAYyd,EAAex4C,OAAS,EACpCi7B,SAAUwd,EAAaz4C,OAAS,QAGjCskB,MAAMrS,IACLjR,QAAQC,IAAI,wBAAyBgR,GACrCqmC,EAAat4C,WAAQ0C,EACrB61C,EAAiBv4C,MAAQ,GACzBw4C,EAAex4C,WAAQ0C,EACvB+1C,EAAaz4C,WAAQ0C,EACrB64C,EAAgBv7C,WAAQ0C,CAAS,IAElC8hB,OAAOpR,IACNpS,QAAQoS,MAAM,QAASA,GACvBmoC,EAAgBv7C,MAAQoT,EACxBlQ,OAAOC,OAAOqzC,OAAOpjC,OACnBrQ,EAAAA,EAAAA,IAAS,2CACT,CAACvC,KAAKE,UAAU0S,EAAO,KAAM,IAC9B,IAEL,OAAOwoC,CACT,CD4CA,MAAO,CAACz1C,EAAUgG,IACRvC,EAAQ4G,KAAKqlB,iBAAiBiE,UACjC1tB,EAAAA,EAAAA,OAAcrG,EAAAA,EAAAA,IAAoB,MAAO6B,GAAY,EACpDC,EAAAA,EAAAA,IAAoB,MAAOC,GAAY,EACrC2E,EAAAA,EAAAA,IAAai+B,GAAa,CACxBC,aAAcd,EACdr5B,KAAM5G,EAAQ4G,KACdmF,QAAS,cACTxL,IAAK6+B,GACJ,KAAM,EAAG,CAAC,UACbnhC,EAAAA,EAAAA,IAAoB,MAAOY,GAAY,EACrCZ,EAAAA,EAAAA,IAAoB,SAAU,CAC5B5B,MAAO,yBACPmC,QAAS8wC,GACR,CACAV,EAAex4C,QACXoM,EAAAA,EAAAA,OAAcrG,EAAAA,EAAAA,IAAoBgC,EAAAA,GAAW,CAAEI,IAAK,GAAK,EACxDoF,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAO80B,GAAP90B,CAA6BgsC,EAAex4C,OAAO,EAAO,MAAQ,IAAK,IACzG6H,EAAAA,EAAAA,IAAoB,SAAU,CAC5B5B,MAAO,sBACPmC,SAASkE,EAAAA,EAAAA,IAAe6sC,EAAgB,CAAC,UACxC,KAAM,EAAGtwC,KACX,OACFuD,EAAAA,EAAAA,OAAcrG,EAAAA,EAAAA,IAAoBgC,EAAAA,GAAW,CAAEI,IAAK,GAAK,EACxDoF,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,UAAW,IAC7D,QAET3E,EAAAA,EAAAA,IAAoB,SAAU,CAC5B5B,MAAO,yBACPmC,QAASgxC,GACR,CACAX,EAAaz4C,QACToM,EAAAA,EAAAA,OAAcrG,EAAAA,EAAAA,IAAoBgC,EAAAA,GAAW,CAAEI,IAAK,GAAK,EACxDoF,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAO80B,GAAP90B,CAA6BisC,EAAaz4C,OAAO,EAAO,MAAQ,IAAK,IACvG6H,EAAAA,EAAAA,IAAoB,SAAU,CAC5B5B,MAAO,sBACPmC,SAASkE,EAAAA,EAAAA,IAAe+sC,EAAc,CAAC,UACtC,KAAM,EAAGvwC,KACX,OACFsD,EAAAA,EAAAA,OAAcrG,EAAAA,EAAAA,IAAoBgC,EAAAA,GAAW,CAAEI,IAAK,GAAK,EACxDoF,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,QAAS,IAC3D,QAETU,EAAAA,EAAAA,KAAgBrF,EAAAA,EAAAA,IAAoB,SAAU,CAC5C5B,MAAO,kBACP,sBAAuBkG,EAAO,KAAOA,EAAO,GAAM9D,GAAkBqwC,EAAe14C,MAAQqI,IAC1Fc,GAAa,KAAM,CACpB,CAACsE,EAAAA,GAAeirC,EAAc14C,YAGlCyM,EAAAA,EAAAA,IAAayL,GAAAA,EAAe,CAC1B4jC,kBAAmB,GACnBjvC,WAAY0rC,EAAiBv4C,MAC7B,sBAAuBmM,EAAO,KAAOA,EAAO,GAAM9D,GAAkBkwC,EAAkBv4C,MAAQqI,GAC9FsN,QAAS,0BACTxL,IAAKwuC,GACJ,KAAM,EAAG,CAAC,oBACWj2C,IAAvB41C,EAAat4C,QACToM,EAAAA,EAAAA,OAAcrG,EAAAA,EAAAA,IAAoB,SAAU,CAC3CoC,IAAK,EACLC,QAAS6wC,EACTryC,KAAM,SACNX,MAAO,WACNsG,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,iBAAkB,KACvDuB,EAAAA,EAAAA,IAAoB,IAAI,IAC5BlG,EAAAA,EAAAA,IAAoB,SAAU,CAC5BO,QAAS+D,EAAO,KAAOA,EAAO,GAAM9D,QACf3F,IAAvB41C,EAAat4C,MAAsB67C,IAAqBF,KAEtD11C,MAAO,SACP+Q,SAAmD,IAAzCuhC,EAAiBv4C,MAAM6d,OAAOnM,SACvCnF,EAAAA,EAAAA,SAAwC7J,IAAvB41C,EAAat4C,OAC7BwM,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,iBACjBA,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,oBAAqB,EAAGpD,IAC5CmyC,EAAgBv7C,QACZoM,EAAAA,EAAAA,OAAc0B,EAAAA,EAAAA,IAAaiuC,GAAAA,EAAc,CACxC5zC,IAAK,EACLmB,MAAO,CAAC,aAAa,SACrB8J,OACN5G,EAAAA,EAAAA,IAAO1C,GACH,IAAG0C,EAAAA,EAAAA,IAAO9G,IAASqjC,gCAAgCvoC,KAAKE,UACtD66C,EAAgBv7C,MAChB,KACA,MAEFwM,EAAAA,EAAAA,IAAO9G,IAASqjC,uBAEb,KAAM,EAAG,CAAC,YACbh7B,EAAAA,EAAAA,IAAoB,IAAI,IAC5BlG,EAAAA,EAAAA,IAAoB,MAAOwB,GAAa,GACrC+C,EAAAA,EAAAA,KAAW,IAAOrG,EAAAA,EAAAA,IAAoBgC,EAAAA,GAAW,MAAMC,EAAAA,EAAAA,KAAYwE,EAAAA,EAAAA,IAAO2uC,IAAmB5yC,KACpF6D,EAAAA,EAAAA,OAAcrG,EAAAA,EAAAA,IAAoB,IAAK,CAC7CoC,IAAKI,EACLqjC,KAAM0P,EAAa/yC,KAClBgE,EAAAA,EAAAA,IAAiB2rC,EAAY3vC,IAAKma,WAAW,mBAAoB,EAAG1M,OACrE,WAGRnO,EAAAA,EAAAA,IAAoB,MAAOyR,GAAa,EACtCzR,EAAAA,EAAAA,IAAoB,MAAO0R,GAAa,EACtCrM,EAAAA,EAAAA,KAAgBrF,EAAAA,EAAAA,IAAoB,QAAS,CAC3CjB,KAAM,OACNZ,KAAM,YACNoH,aAAaZ,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,SAC9B,sBAAuBL,EAAO,KAAOA,EAAO,GAAM9D,GAAkB8vC,EAAan4C,MAAQqI,IACxF,KAAM,EAAGmR,IAAc,CACxB,CAACnM,EAAAA,GAAa8qC,EAAYn4C,SAEL,KAAtBm4C,EAAYn4C,QACRoM,EAAAA,EAAAA,OAAcrG,EAAAA,EAAAA,IAAoB,SAAU,CAC3CoC,IAAK,EACLlC,MAAO,2BACPU,OAAO6F,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,sBACxBpE,QAASozC,GACR,KAAM,EAAG/hC,MACZ1L,EAAAA,EAAAA,IAAoB,IAAI,GAC5B0f,MAEF5lB,EAAAA,EAAAA,IAAoB,UAAW6lB,GAAa,EAC1C7lB,EAAAA,EAAAA,IAAoB,KAAM,MAAM0E,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,iBAAkB,IACpF3E,EAAAA,EAAAA,IAAoB,IAAK,MAAM0E,EAAAA,EAAAA,IAAiB3C,EAAQ4G,KAAKqlB,iBAAiBkE,cAAe,IAC7FlyB,EAAAA,EAAAA,IAAoB,KAAM,MAAM0E,EAAAA,EAAAA,KAAiBC,EAAAA,EAAAA,IAAOzJ,EAAAA,GAAPyJ,CAAiB,wBAAyB,IAC3F3E,EAAAA,EAAAA,IAAoB,IAAK,MAAM0E,EAAAA,EAAAA,IAAiB3C,EAAQ4G,KAAKqlB,iBAAiBmE,oBAAqB,MAErGnyB,EAAAA,EAAAA,IAAoB,UAAW8lB,GAAa,GACzCvhB,EAAAA,EAAAA,KAAW,IAAOrG,EAAAA,EAAAA,IAAoBgC,EAAAA,GAAW,MAAMC,EAAAA,EAAAA,KAAYwE,EAAAA,EAAAA,IAAO0tC,IAAyB,CAAC5F,EAAMxpC,MACjGsB,EAAAA,EAAAA,OAAc0B,EAAAA,EAAAA,IAAakuC,GAAuB,CACxD7zC,IAAKmsC,EAAK5xB,WAAWna,GACrB+rC,KAAMA,EACNC,SAAUmG,EAAgBpG,GAC1BiD,iBAAkBQ,EAClBL,mBAAoBjD,EACpBgD,aAAc/C,EACdmD,gBAAiBjD,EACjBqH,sBAAuB7D,EACvB8D,yBAA0B7D,EAC1BpyC,OAAOC,EAAAA,EAAAA,IAAgB,CACzBi2C,IAAKrxC,EAAQ,IAAM,KAEhB,KAAM,EAAG,CAAC,OAAQ,WAAY,aAC/B,OAGAiD,EAAAA,EAAAA,IAAoB,IAAI,KAE7BwrC,EAAev5C,QACXoM,EAAAA,EAAAA,OAAc0B,EAAAA,EAAAA,IAAaiuC,GAAAA,EAAc,CACxC5zC,IAAK,EACLiL,OACN5G,EAAAA,EAAAA,IAAO1C,GACH,IAAG0C,EAAAA,EAAAA,IAAO9G,IAASojC,iCAAiCtoC,KAAKE,UACvD64C,EAAev5C,MACf,KACA,MAEFwM,EAAAA,EAAAA,IAAO9G,IAASojC,wBAEb,KAAM,EAAG,CAAC,YACb/6B,EAAAA,EAAAA,IAAoB,IAAI,IAC3BvB,EAAAA,EAAAA,IAAOytC,GAAcvoC,OAAS,IAC1BtF,EAAAA,EAAAA,OAAc0B,EAAAA,EAAAA,IAAaiuC,GAAAA,EAAc,CACxC5zC,IAAK,EACLiL,MAAO,IAAG5G,EAAAA,EAAAA,IAAOytC,GAAcvoC,sCAC9B,KAAM,EAAG,CAAC,YACb3D,EAAAA,EAAAA,IAAoB,IAAI,IAC3BvB,EAAAA,EAAAA,IAAO0uC,GAAiBxpC,OAAS,IAC7BtF,EAAAA,EAAAA,OAAc0B,EAAAA,EAAAA,IAAaiuC,GAAAA,EAAc,CACxC5zC,IAAK,EACLiL,MAAO,IAAG5G,EAAAA,EAAAA,IAAO0uC,GAAiBxpC,yCACjC,KAAM,EAAG,CAAC,YACb3D,EAAAA,EAAAA,IAAoB,IAAI,UAG/B3B,EAAAA,EAAAA,OAAc0B,EAAAA,EAAAA,IAAa48B,GAAa,CACvCviC,IAAK,EACLwiC,aAAcd,EACdr5B,KAAM5G,EAAQ4G,KACdmF,QAAS,cACTxL,IAAK6+B,GACJ,KAAM,EAAG,CAAC,SAEnB,IE/pBA,MAAM,IAA2B,OAAgB,GAAQ,CAAC,CAAC,YAAY,qBAEvE,UCNA,MAAMphC,GAAa,CCDZ3B,MAAM,eDEP6B,GAAa,CCDT7B,MAAM,WDEVwC,GAAa,CCENxC,MAAM,qBDDb4C,GAAa,CAAC,gBACdC,GAAa,CCkBH7C,MAAM,yBDjBhB8C,GAAa,CCuCH9C,MAAM,yBDtChB+C,GAAa,CAAC,YACdC,GAAa,CAAC,YAEd,SAAUtB,GAAOxB,EAAUgG,EAAY6B,EAAYC,EAAYC,EAAWC,GAC9E,MAAM8H,GAA4BC,EAAAA,EAAAA,IAAkB,kBAC9CC,GAA6BD,EAAAA,EAAAA,IAAkB,mBAErD,OAAQ9J,EAAAA,EAAAA,OCdRrG,EAAAA,EAAAA,IA6FM,MA7FN6B,GA6FM,EA5FJC,EAAAA,EAAAA,IA2FO,OA3FPC,GA2FO,EA1FLD,EAAAA,EAAAA,IAmBW,kBAlBTA,EAAAA,EAAAA,IAAiD,eAAA0E,EAAAA,EAAAA,IAAtCpG,EAAApD,SAAS,mBAAD,IAEnB8E,EAAAA,EAAAA,IAMM,MANNY,GAMM,EALJZ,EAAAA,EAAAA,IAES,UAFAO,QAAK+D,EAAA,KAAAA,EAAA,GDgBxB,IAAInI,IChBsBmC,EAAAi2C,aAAAj2C,EAAAi2C,eAAAp4C,IAAaiC,MAAM,mBAAmBW,KAAK,WDmBxD2F,EAAAA,EAAAA,IClBEpG,EAAApD,SAAS,6BAAD,IAGb8E,EAAAA,EAAAA,IAAiE,OAA5D5B,MAAM,uBAAwB,eAAcE,EAAAkQ,cDmB9C,KAAM,EAAGxN,OChBd4D,EAAAA,EAAAA,IAOEwJ,EAAA,CANCpJ,WAAY1G,EAAAiE,oBAAoBkM,SAChC,sBAAmBnQ,EAAAoQ,eACpBpM,IAAI,UACJ,uBACA,2BACA,yBDmBC,KAAM,EAAG,CAAC,aAAc,2BCf7BtC,EAAAA,EAAAA,IAoBW,WApBXiB,GAoBW,EAnBTjB,EAAAA,EAAAA,IAAgD,eAAA0E,EAAAA,EAAAA,IAArCpG,EAAApD,SAAS,kBAAD,IAEnB8E,EAAAA,EAAAA,IAOQ,eDUNqF,EAAAA,EAAAA,KChBArF,EAAAA,EAAAA,IAIE,SDaA,sBAAuBsE,EAAO,KAAOA,EAAO,GAAM9D,GChBzClC,EAAAiE,oBAAoBwM,aAAYvO,GACxCmF,SAAMrB,EAAA,KAAAA,EAAA,GDkBnB,IAAInI,IClBiBmC,EAAAuE,sBAAAvE,EAAAuE,wBAAA1G,IACT4C,KAAK,YDmBJ,KAAM,KAAM,CACb,CAACiH,EAAAA,GCtBQ1H,EAAAiE,oBAAoBwM,iBDwB/BrJ,EAAAA,EAAAA,ICrBE,KACFhB,EAAAA,EAAAA,IAAGpG,EAAApD,SAAS,8BAAD,MAGb8E,EAAAA,EAAAA,IAOQ,eDaNqF,EAAAA,EAAAA,KCnBArF,EAAAA,EAAAA,IAIE,SDgBA,sBAAuBsE,EAAO,KAAOA,EAAO,GAAM9D,GCnBzClC,EAAAiE,oBAAoByM,qBAAoBxO,GAChDmF,SAAMrB,EAAA,KAAAA,EAAA,GDqBnB,IAAInI,ICrBiBmC,EAAAuE,sBAAAvE,EAAAuE,wBAAA1G,IACT4C,KAAK,YDsBJ,KAAM,KAAM,CACb,CAACiH,EAAAA,GCzBQ1H,EAAAiE,oBAAoByM,yBD2B/BtJ,EAAAA,EAAAA,ICxBE,KACFhB,EAAAA,EAAAA,IAAGpG,EAAApD,SAAS,+BAAD,QAIf8E,EAAAA,EAAAA,IAuCW,WAvCXkB,GAuCW,EAtCTlB,EAAAA,EAAAA,IAAiD,eAAA0E,EAAAA,EAAAA,IAAtCpG,EAAApD,SAAS,mBAAD,IAEnB8E,EAAAA,EAAAA,IAOQ,eDeN0F,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,ICrBdpG,EAAApD,SAAS,gCAAiC,IAC7C,IDqBAmK,EAAAA,EAAAA,KCrBArF,EAAAA,EAAAA,IAIE,SDkBA,sBAAuBsE,EAAO,KAAOA,EAAO,GAAM9D,GCrBzClC,EAAAiE,oBAAoB1E,QAAQC,YAAW0C,GAC/C8E,QAAKhB,EAAA,KAAAA,EAAA,GAAA9D,GAAElC,EAAAuE,qBAAqB,uCAC7B9D,KAAK,QDsBJ,KAAM,KAAM,CACb,CAACyG,EAAAA,GCzBQlH,EAAAiE,oBAAoB1E,QAAQC,kBAMzCkC,EAAAA,EAAAA,IAUQ,SATL5B,OAAKC,EAAAA,EAAAA,IAAA,qBAAyBC,EAAAiE,oBAAoBwM,gBDuBlD,EACDrJ,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,ICtBdpG,EAAApD,SAAS,iCAAkC,IAC9C,IDsBAmK,EAAAA,EAAAA,KCtBArF,EAAAA,EAAAA,IAKE,SDkBA,sBAAuBsE,EAAO,KAAOA,EAAO,GAAM9D,GCtBzClC,EAAAiE,oBAAoB1E,QAAQE,YAAWyC,GAC/C8E,QAAKhB,EAAA,KAAAA,EAAA,GAAA9D,GAAElC,EAAAuE,qBAAqB,uCAC5BsM,UAAW7Q,EAAAiE,oBAAoBwM,aAChChQ,KAAK,QDuBJ,KAAM,GAAIoC,IAAa,CACxB,CAACqE,EAAAA,GC3BQlH,EAAAiE,oBAAoB1E,QAAQE,gBD6BtC,ICtBHiC,EAAAA,EAAAA,IAcQ,SAbL5B,OAAKC,EAAAA,EAAAA,IAAA,CDwBJ,oBCxByCC,EAAAiE,oBAAoByM,wBD0B9D,EACDtJ,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,ICvBdpG,EAAApD,SAAS,8BAA+B,IAC3C,IDuBAmK,EAAAA,EAAAA,KCvBArF,EAAAA,EAAAA,IAOE,SDiBA,sBAAuBsE,EAAO,KAAOA,EAAO,GAAM9D,GCvBzClC,EAAAiE,oBAAoB1E,QAAQG,gBAAewC,GACnD8E,QAAKhB,EAAA,MAAAA,EAAA,IAAA9D,GAAiBlC,EAAAuE,qBAAoB,2CAG1CsM,UAAW7Q,EAAAiE,oBAAoByM,qBAChCjQ,KAAK,QDwBJ,KAAM,GAAIqC,IAAa,CACxB,CAACoE,EAAAA,GC9BQlH,EAAAiE,oBAAoB1E,QAAQG,oBDgCtC,MCtBL4G,EAAAA,EAAAA,IAKE0J,EAAA,CAJClH,SAAU9I,EAAAiE,oBAAoB6E,SAC9B,iBAAgB9I,EAAAiE,oBAAoB1E,QAAQI,cAC5C,oBAAiBK,EAAA+Q,eACjB,yBAAuB/Q,EAAAgR,qBDyBvB,KAAM,EAAG,CAAC,WAAY,iBAAkB,oBAAqB,8BAGtE,CCRA,QAAe3Q,EAAAA,EAAAA,IAAgB,CAC7B8B,KAAM,qBACNqB,KAAAA,GACE,MAAO,CACLE,YAAYpD,EAAAA,EAAAA,IAAwBnI,EAAAA,GAExC,EACA2Z,WAAY,CAAEE,eAAc,GAAED,cAAaA,GAAAA,GAC3CxR,MAAO,CACL/F,eAAgB,CACdiG,KAAMzE,OACN2E,UAAU,IAGdG,IAAAA,GACE,MAAO,CACLmD,qBAAqBC,EAAAA,EAAAA,WAAUjD,KAAKzG,gBAExC,EACAQ,MAAO,CAELR,eAAgB,CACdwO,WAAW,EACXC,QAAS,WACPhI,KAAKgD,qBAAsBC,EAAAA,EAAAA,WAAUjD,KAAKzG,eAC5C,IAGJ4O,QAAS,CACPxM,SAAQ,KAKRq5C,WAAAA,GACE,MAAMhkC,EAAahR,KAAKsI,MAAM2I,SAAiBC,IACzCC,EAASrV,OAAOC,OAAOkV,QAAQG,UAAUJ,GAC/C,IAAKG,EAEH,MADAvX,QAAQoS,MAAM,kCAAmCmF,GAC3C,IAAInX,MAAM,6CAElB,MAAMqX,EAAYF,EAAOG,MAAMC,SAASF,UAClCG,EAAQH,EAAUI,mBAClBC,EAAML,EAAUM,kBACtB,IAAKH,IAAUE,EAEb,MADA9X,QAAQoS,MAAM,oBAAqBwF,EAAO,mBAAoBE,GACxD,IAAI1X,MAAM,qCAElBmX,EAAOG,MAAMM,QAAQC,IACnBA,EAAOC,WAAW,IAAKJ,GACvBG,EAAOC,WAAW,IAAKN,EAAM,GAEjC,EAEA/I,UAAAA,CAAWC,GACT,OACE5M,OAAOC,OAAO4M,WAAa,qBAAuBD,EAAW,MAEjE,EAEAyG,cAAAA,CAAetP,GAEbG,KAAKyC,WAAYhJ,YAAY,CAC3BC,mBAAmB8J,EAAAA,EAAAA,IACjBxD,KAAKgD,qBACJS,IACCA,EAAMyL,SAAWrP,CAAI,IAGzBlG,UAAW,2BAEf,EAEA2J,oBAAAA,CAAqB3J,GAEnBqG,KAAKyC,WAAYhJ,YAAY,CAC3BC,mBAAmBuJ,EAAAA,EAAAA,WAAUjD,KAAKgD,qBAClCrJ,UAAWA,GAAa,CAAC,GAE7B,EAEAmW,cAAAA,CAAeiC,GACb/R,KAAKyC,WAAYhJ,YAAY,CAC3BC,mBAAmB8J,EAAAA,EAAAA,IACjBxD,KAAKgD,qBACJgP,IACCA,EAAUnK,SAAWkK,CAAe,IAGxCpY,UAAW,2BAEf,EAEAoW,mBAAAA,CAAoBkC,GAClBjS,KAAKyC,WAAYhJ,YAAY,CAC3BC,mBAAmB8J,EAAAA,EAAAA,IACjBxD,KAAKgD,qBACJgP,IACCA,EAAU1T,QAAQI,cAAgBuT,CAAoB,IAG1DtY,UAAW,wCAEf,GAGF0G,SAAU,CACR4O,YAAAA,GACE,OAAOtT,EAAAA,EAAAA,IACL,mLAEJ,KCzNJ,MAAM,IAA2B,OAAgB,GAAQ,CAAC,CAAC,SAAS,MAEpE,UCLA,MACM6E,GAAa,CCFZ3B,MAAM,eDGP6B,GAAa,CCFV7B,MAAM,uBDGTwC,GAAa,CAAC,eAAgB,UAAW,YAAa,UAAW,aACjEI,GAAa,CAAC,eAAgB,UAAW,YAAa,UAAW,aACjEC,GAAa,CAAC,aACdC,GAAa,CAAEZ,IAAK,GACpBa,GAAa,CACjBb,IAAK,EC0B2ClC,MAAM,SDvBlDgD,GAAa,CC4BVhD,MAAM,iCD3BTiD,GAAa,CCoCRjD,MAAM,gBDnCXkD,GAAc,CAAC,eACfC,GAAc,CAAC,eACfC,GAAc,CAAC,eACf2M,GAAc,CAAE7N,IAAK,GACrBmR,IAA2B/L,EAAAA,EAAAA,IC0DX,mBDzDhBgM,IAA2BhM,EAAAA,EAAAA,IC2DC,eD1D5BiM,IAA2BjM,EAAAA,EAAAA,IC4DG,qBD3D9BkM,IAA2BlM,EAAAA,EAAAA,IC6DG,sBD3D9B,SAAU5F,GAAOxB,EAAUgG,EAAY6B,EAAYC,EAAYC,EAAWC,GAC9E,MAAMkuC,GAA8BnmC,EAAAA,EAAAA,IAAkB,oBAEtD,OAAQ9J,EAAAA,EAAAA,OC1BRrG,EAAAA,EAAAA,IAsFM,MAtFN6B,GAsFM,EArFJC,EAAAA,EAAAA,IAoCM,MApCNC,GAoCM,GDTHsE,EAAAA,EAAAA,KAAW,IC1BZrG,EAAAA,EAAAA,IAkCWgC,EAAAA,GAAA,MAAAC,EAAAA,EAAAA,IAlCiB7B,EAAAwT,gBAAX9a,KD2BPuN,EAAAA,EAAAA,OAAcrG,EAAAA,EAAAA,IAAoBgC,EAAAA,GAAW,CACnDI,IC5B8CtJ,EAAQ8F,MD6BrD,CC3BsB,aAAjB9F,EAAQ+H,OD6BTwF,EAAAA,EAAAA,OC9BPrG,EAAAA,EAAAA,IAUQ,QDqBAoC,IAAK,EC7BXK,SAAS,IACTxC,KAAK,SACJ,eAAcG,EAAAm2C,SAASz9C,GACvBuJ,QAAKC,GAAElC,EAAAkF,YAAYxM,GACnBiX,UAAOzN,GAAElC,EAAAo2C,cAAcl0C,EAAQxJ,GAC/BogB,QAAK5W,GAAElC,EAAAq2C,YAAYn0C,EAAQxJ,GAC3BoH,OAAKC,EAAAA,EAAAA,IAAA,YAAeC,EAAAs2C,aAAa59C,KAClC+a,UAAQ/a,EAAQgb,MD+BT,KAAM,GAAIpR,KC3BW,SAAjB5J,EAAQ+H,OD6BZwF,EAAAA,EAAAA,OC9BTrG,EAAAA,EAAAA,IAUQ,QDqBEoC,IAAK,EC7BbK,SAAS,IACTxC,KAAK,SACJ,eAAcG,EAAAm2C,SAASz9C,GACvBuJ,QAAKC,GAAElC,EAAAkF,YAAYxM,GACnBiX,UAAOzN,GAAElC,EAAAo2C,cAAcl0C,EAAQxJ,GAC/BogB,QAAK5W,GAAElC,EAAAq2C,YAAYn0C,EAAQxJ,GAC3BoH,OAAKC,EAAAA,EAAAA,IAAA,YAAeC,EAAAs2C,aAAa59C,KAClC+a,UAAQ/a,EAAQgb,MD+BP,KAAM,GAAIhR,KC3BS,gBAAjBhK,EAAQ+H,OD6BVwF,EAAAA,EAAAA,OC9BXrG,EAAAA,EAAAA,IAGQ,QD4BIoC,IAAK,EC7BfyR,UAAQ/a,EAAQgb,MD+BL,KAAM,EAAG/Q,KC5BU,eAAjBjK,EAAQ+H,OD8BVwF,EAAAA,EAAAA,OC9BbrG,EAAAA,EAAAA,IAAgD,KAAAgD,KAGf,UAAjBlK,EAAQ+H,OD6BTwF,EAAAA,EAAAA,OC7BfrG,EAAAA,EAAAA,IAA+D,MAA/DiD,GAAwD,OD8B1C+E,EAAAA,EAAAA,IAAoB,IAAI,IACnC,OACD,SC3BNlG,EAAAA,EAAAA,IAkCM,MAlCNoB,GAkCM,CAhCI9C,EAAA6U,cD6BH5O,EAAAA,EAAAA,OC9BL0B,EAAAA,EAAAA,IAMEuuC,EAAA,CDyBIl0C,IAAK,EC7BR,kBAAiBhC,EAAA6L,MACjB,aAAY7L,EAAA4L,SACZ9C,SAAU9I,EAAAqK,KAAKvB,SACf,iBAAgB9I,EAAAL,eD+BZ,KAAM,EAAG,CAAC,kBAAmB,aAAc,WAAY,qBAC1DiI,EAAAA,EAAAA,IAAoB,IAAI,IC7B5BlG,EAAAA,EAAAA,IAwBM,MAxBNqB,GAwBM,CAtBI/C,EAAA+L,kBD8BH9F,EAAAA,EAAAA,OC/BLrG,EAAAA,EAAAA,IAME,UD0BIoC,IAAK,EACLyG,aC/BJrC,EAAAA,EAAAA,IAAiCpG,EAAAqK,KAApB9K,QAAQC,aACpByC,QAAK+D,EAAA,KAAAA,EAAA,GDiChB,IAAInI,ICjCcmC,EAAAmM,cAAAnM,EAAAmM,gBAAAtO,IACR4C,KAAK,SACLX,MAAM,iBDkCD,KAAM,EAAGkD,MACZ4E,EAAAA,EAAAA,IAAoB,IAAI,GC/BpB5H,EAAAgV,sBDiCH/O,EAAAA,EAAAA,OClCLrG,EAAAA,EAAAA,IAME,UD6BIoC,IAAK,EACLyG,aClCJrC,EAAAA,EAAAA,IAAqCpG,EAAAqK,KAAxB9K,QAAQG,iBACpBuC,QAAK+D,EAAA,KAAAA,EAAA,GDoChB,IAAInI,ICpCcmC,EAAAqM,sBAAArM,EAAAqM,wBAAAxO,IACR4C,KAAK,SACLX,MAAM,iBDqCD,KAAM,EAAGmD,MACZ2E,EAAAA,EAAAA,IAAoB,IAAI,GClCpB5H,EAAAkV,kBDoCHjP,EAAAA,EAAAA,OCrCLrG,EAAAA,EAAAA,IAME,UDgCIoC,IAAK,EACLyG,aCrCJrC,EAAAA,EAAAA,IAAiCpG,EAAAqK,KAApB9K,QAAQE,aACpBwC,QAAK+D,EAAA,KAAAA,EAAA,GDuChB,IAAInI,ICvCcmC,EAAAoM,cAAApM,EAAAoM,gBAAAvO,IACR4C,KAAK,SACLX,MAAM,iBDwCD,KAAM,EAAGoD,MACZ0E,EAAAA,EAAAA,IAAoB,IAAI,OCpCrB5H,EAAA2D,QDwCNsC,EAAAA,EAAAA,OCxCLrG,EAAAA,EAAAA,IASM,MAAAiQ,GAAA,CDgCAsD,ICvCJzR,EAAAA,EAAAA,IAA4B,YAAA0E,EAAAA,EAAAA,IAApBpG,EAAAu2C,aAAW,GDyCfnjC,ICvCJ1R,EAAAA,EAAAA,IAA8B,YAAA0E,EAAAA,EAAAA,IAAtBpG,EAAAqK,KAAK8F,UAAQ,GDyCjBkD,ICvCJ3R,EAAAA,EAAAA,IAA8B,YAAA0E,EAAAA,EAAAA,IAAtBpG,EAAAoX,eAAa,GDyCjB9D,ICvCJ5R,EAAAA,EAAAA,IAA+B,YAAA0E,EAAAA,EAAAA,IAAvBpG,EAAAwT,gBAAc,OD0CpB5L,EAAAA,EAAAA,IAAoB,IAAI,IAEhC,CCDA,QAAevH,EAAAA,EAAAA,IAAgB,CAC7B8B,KAAM,qBACN5B,MAAO,CACL8J,KAAM,CACJ5J,KAAMzE,OACN2E,UAAU,IAGdmR,WAAY,CACVlC,gBAAeA,IAEjB9O,IAAAA,GACE,MAAO,CACLy1C,YAAa,IAAIprB,IACjBtW,aAAa,EACbjK,eAAe,EACfjH,OAAO,EAEX,EACAyF,QAAS,CACP+C,YAAAA,GACElL,KAAK4T,aAAc,CACrB,EAEAxI,oBAAAA,GACEpL,KAAK2J,eAAgB,CACvB,EAEAwB,YAAAA,GACEnL,KAAK4T,aAAc,EACnB5T,KAAK2J,eAAgB,EACrB3J,KAAKs1C,YAAYC,OACnB,EAEAtxC,WAAAA,CAAYL,GACN5D,KAAK4T,cAEL5T,KAAKk1C,SAAStxC,GAChB5D,KAAKs1C,YAAYnK,OAAOvnC,GAExB5D,KAAKs1C,YAAYne,IAAIvzB,GAEzB,EAKAuxC,aAAAA,CAAc5wC,EAAsBX,GAIf,UAAfW,EAAMixC,KACRjxC,EAAMgJ,iBAGgB,UAAfhJ,EAAMixC,MAAmC,WAAfjxC,EAAMixC,OACvCjxC,EAAMgJ,iBACNvN,KAAKiE,YAAYL,GAErB,EAKAwxC,WAAAA,CAAY7wC,EAAsBX,GACb,UAAfW,EAAMixC,OACRjxC,EAAMgJ,iBACNvN,KAAKiE,YAAYL,GAErB,EAEAyxC,YAAAA,CAAazxC,GACX,OAAI5D,KAAK4T,YAEH5T,KAAKk1C,SAAStxC,GACK,aAAdA,EAAKpE,KACR,iBACA,mBAGCQ,KAAK2J,eAA+B,aAAd/F,EAAKpE,KAC9B,WACA,uBAICQ,KAAKk1C,SAAStxC,GAAQ,cAAgB,aAC/C,EAEAsxC,QAAAA,CAAStxC,GACP,OAAO5D,KAAKs1C,YAAYlP,IAAIxiC,EAC9B,EAEA6xC,YAAAA,CAAahjC,GAEX,OAAOA,EAAKvS,QAAQ,UAAW,IAAIA,QAAQ,UAAW,IACxD,GAEFG,SAAU,CACR8V,aAAAA,GAEE,MAAMC,EAAgBpW,KAAKy1C,aAAaz1C,KAAKoJ,KAAK8F,UAI5CwmC,EAAmBt/B,EAAclc,MAAM,gBAIvCy7C,EAAaD,EAAiB/B,SAASiC,GACvC,cAAcxL,KAAKwL,GAEdA,EAGAA,EAAK17C,MAAM,kCAAkCyL,OAAO4gC,WAK/D,OAAOoP,CACT,EAEApjC,cAAAA,GACE,IAAIA,EAAwC,GA0C5C,OAxCAvS,KAAKmW,cAAcxe,SAASk+C,IAC1B,GAAI,cAAczL,KAAKyL,GAAkB,CAGvC,MAAMhL,EAAUgL,EAAgB31C,QAAQ,MAAO,IAE/CqS,EAAe/Q,KAAK,CAClBhC,KAAM,WACNjC,MAAM8Y,EAAAA,EAAAA,KACN5D,KAAMo4B,G,KAEC,QAAQT,KAAKyL,GAEtBtjC,EAAe/Q,KAAK,CAClBhC,KAAM,QACNjC,MAAM8Y,EAAAA,EAAAA,OAEC,eAAe+zB,KAAKyL,GAE7BtjC,EAAe/Q,KAAK,CAClBhC,KAAM,aACNjC,MAAM8Y,EAAAA,EAAAA,OAEC,eAAe+zB,KAAKyL,GAE7BtjC,EAAe/Q,KAAK,CAClBhC,KAAM,cACNjC,MAAM8Y,EAAAA,EAAAA,KACN5D,KAAMojC,IAIRtjC,EAAe/Q,KAAK,CAClBhC,KAAM,OACNjC,MAAM8Y,EAAAA,EAAAA,KACN5D,KAAMojC,G,IAKLtjC,CACT,EAEAzH,eAAAA,GACE,OAAQ9K,KAAK4T,WACf,EAEAK,eAAAA,GACE,OACEjU,KAAKoJ,KAAKoG,cAAgBxP,KAAK4T,cAAgB5T,KAAKkX,oBAExD,EAEAnD,mBAAAA,GACE,OACE/T,KAAKoJ,KAAKqG,sBACVzP,KAAK4T,cACJ5T,KAAK2J,gBACL3J,KAAKkX,oBAEV,EAEAtM,KAAAA,GACE,IAAIA,EAAQ,EAEZ,IAAK,MAAMnT,KAAWuI,KAAKs1C,YACJ,aAAjB79C,EAAQ+H,KACVoL,IAEAA,IAMJ,OAFIA,EAAQ,IAAGA,EAAQ,GAEhBA,CACT,EAEAD,QAAAA,GACE,IAAIA,EAAW,EAEf,IAAK,MAAMlT,KAAWuI,KAAKuS,eACJ,aAAjB9a,EAAQ+H,MACVmL,IAIJ,OAAOA,CACT,EAEAjM,aAAAA,GACE,IAAIA,EAAgBsB,KAAKoJ,KAAK9K,QAAQI,cAAcwB,QAClD,WACAF,KAAK4K,MAAM/R,YAKb,OAFA6F,EAAgBA,EAAcwB,QAAQ,SAAUF,KAAK2K,SAAS9R,YAEvD6F,CACT,EAEAwY,oBAAAA,GACE,OAAOlX,KAAK4K,QAAU5K,KAAK2K,QAC7B,KC9VJ,MAAM,IAA2B,OAAgB,GAAQ,CAAC,CAAC,SAAS,IAAQ,CAAC,YAAY,qBAEzF,UCPA,MACMnK,GAAa,CCFZ3B,MAAM,eDGP6B,GAAa,CCFT7B,MAAM,WDGVwC,GAAa,CCFHxC,MAAM,iBDGhB4C,GAAa,CCAN5C,MAAM,cDCb6C,GAAa,CAAC,WACdC,GAAa,CAAC,eACdC,GAAa,CAAC,UAAW,cACzBC,GAAa,CAAC,OACdC,GAAa,CACjBf,IAAK,EC6BGlC,MAAM,sBD1BVkD,GAAc,CAClBhB,IAAK,ECiCkBlC,MAAM,gCD9BzBmD,GAAc,CCqCJnD,MAAM,yBDpChBoD,GAAc,CAClBlB,IAAK,EC+DKlC,MAAM,uCD5DZ+P,GAAc,CCiFJ/P,MAAM,yBDhFhBqT,GAAc,CAAC,YACfC,GAAc,CC+FJtT,MAAM,yBD7FhB,SAAU0B,GAAOxB,EAAUgG,EAAY6B,EAAYC,EAAYC,EAAWC,GAC9E,MAAM+uC,GAA8BhnC,EAAAA,EAAAA,IAAkB,oBAChD4O,GAAuB5O,EAAAA,EAAAA,IAAkB,aACzCg1B,GAAwBh1B,EAAAA,EAAAA,IAAkB,cAEhD,OAAQ9J,EAAAA,EAAAA,OChCRrG,EAAAA,EAAAA,IAuIM,MAvIN6B,GAuIM,EAtIJC,EAAAA,EAAAA,IAqIO,OArIPC,GAqIO,EApILD,EAAAA,EAAAA,IAmDW,WAnDXY,GAmDW,EAlDTZ,EAAAA,EAAAA,IAAyC,eAAA0E,EAAAA,EAAAA,IAA9BpG,EAAApD,SAAS,WAAD,IAEnB8E,EAAAA,EAAAA,IA+BM,MA/BNgB,GA+BM,GDCHuD,EAAAA,EAAAA,KAAW,IC/BZrG,EAAAA,EAAAA,IAqBMgC,EAAAA,GAAA,MAAAC,EAAAA,EAAAA,IApBoB7B,EAAAiE,oBAAoB+yC,OAAK,CAAzCC,EAAMtyC,MD+BNsB,EAAAA,EAAAA,OChCVrG,EAAAA,EAAAA,IAqBM,OAnBHoC,IAAKi1C,EAAKz4C,KACVsB,OAAKC,EAAAA,EAAAA,IAAA,CDgCJ,mBAAmB,EACnB,gBCjC8E4E,IAAU3E,EAAAk3C,oBAIzFj1C,QAAKC,GAAElC,EAAAm3C,WAAWxyC,IDgChB,EC9BHjD,EAAAA,EAAAA,IAAmE,ODgC/D+G,aChCCrC,EAAAA,EAAAA,IAAmCpG,EAAAo3C,cAAbzyC,EAAOsyC,IAAOn3C,MAAM,mBDkC1C,KAAM,EAAG8C,KC9BdlB,EAAAA,EAAAA,IAOS,UANPjB,KAAK,SACLX,MAAM,wCACLmC,SAAKkE,EAAAA,EAAAA,KAAAjE,GAAOlC,EAAAq3C,WAAW1yC,IAAK,UAC5B,aAAY3E,EAAAlC,UAAU,wBAAyB,kBDgC7C,EC9BH4D,EAAAA,EAAAA,IAAyC,OAAnC0G,IAAKpI,EAAA0J,WAAW,SAAUlB,IAAI,IDkC/B,KAAM,EAAG1F,KACX,EAAGD,KACL,GAAIF,OACL,OCjCJjB,EAAAA,EAAAA,IAMS,UALPjB,KAAK,SACLX,MAAM,6BACLmC,QAAK+D,EAAA,KAAAA,EAAA,GDoClB,IAAInI,ICpCgBmC,EAAAs3C,SAAAt3C,EAAAs3C,WAAAz5C,MDqCPuI,EAAAA,EAAAA,ICnCEpG,EAAApD,SAAS,qBAAD,KAKPoD,EAAAiE,oBAAoB+yC,MAAMh3C,EAAAk3C,qBDiC7BjxC,EAAAA,EAAAA,OClCLrG,EAAAA,EAAAA,IAQM,MARNmD,GAQM,EAJJuD,EAAAA,EAAAA,IAGEywC,EAAA,CAFCE,KAAMj3C,EAAAiE,oBAAoB+yC,MAAMh3C,EAAAk3C,mBAChC,gBAAal3C,EAAAu3C,YDgCT,KAAM,EAAG,CAAC,OAAQ,uBAEtBtxC,EAAAA,EAAAA,OC9BLrG,EAAAA,EAAAA,IAIW,WAJXoD,GAIW,EAHTtB,EAAAA,EAAAA,IAES,eAAA0E,EAAAA,EAAAA,IADJpG,EAAApD,SAAS,2BAAD,SAKjB8E,EAAAA,EAAAA,IA+CW,WA/CXuB,GA+CW,EA9CTvB,EAAAA,EAAAA,IAAgD,eAAA0E,EAAAA,EAAAA,IAArCpG,EAAApD,SAAS,kBAAD,IAEnB8E,EAAAA,EAAAA,IAOQ,eDoBNqF,EAAAA,EAAAA,KC1BArF,EAAAA,EAAAA,IAIE,SDuBA,sBAAuBsE,EAAO,KAAOA,EAAO,GAAM9D,GC1BzClC,EAAAiE,oBAAoBwM,aAAYvO,GACxCmF,SAAMrB,EAAA,KAAAA,EAAA,GD4BnB,IAAInI,IC5BiBmC,EAAAuE,sBAAAvE,EAAAuE,wBAAA1G,IACT4C,KAAK,YD6BJ,KAAM,KAAM,CACb,CAACiH,EAAAA,GChCQ1H,EAAAiE,oBAAoBwM,iBDkC/BrJ,EAAAA,EAAAA,IC/BE,KACFhB,EAAAA,EAAAA,IAAGpG,EAAApD,SAAS,8BAAD,MAGb8E,EAAAA,EAAAA,IAOQ,eDuBNqF,EAAAA,EAAAA,KC7BArF,EAAAA,EAAAA,IAIE,SD0BA,sBAAuBsE,EAAO,KAAOA,EAAO,GAAM9D,GC7BzClC,EAAAiE,oBAAoBuzC,aAAYt1C,GACxCmF,SAAMrB,EAAA,KAAAA,EAAA,GD+BnB,IAAInI,IC/BiBmC,EAAAuE,sBAAAvE,EAAAuE,wBAAA1G,IACT4C,KAAK,YDgCJ,KAAM,KAAM,CACb,CAACiH,EAAAA,GCnCQ1H,EAAAiE,oBAAoBuzC,iBDqC/BpwC,EAAAA,EAAAA,IClCE,KACFhB,EAAAA,EAAAA,IAAGpG,EAAApD,SAAS,0CAAD,MAGb8E,EAAAA,EAAAA,IAyBQ,eDQN0F,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,IChCbpG,EAAApD,SAAS,cAAe,IAC5B,GACuBoD,EAAAiE,oBAAoBwzC,UAA0Bz3C,EAAAiE,oBAAoBwzC,SAAS33B,UDmC7F7Z,EAAAA,EAAAA,OCpCLrG,EAAAA,EAAAA,IAoBO,OApBPsD,GAoBO,EAbLoD,EAAAA,EAAAA,IAIEqY,EAAA,CAHCvW,IAAKpI,EAAA4f,YAAY5f,EAAAiE,oBAAoBwzC,SAAS33B,SAC9CtX,IAAKxI,EAAAiE,oBAAoBwzC,SAAS13B,QACnCjgB,MAAM,kBD+BD,KAAM,EAAG,CAAC,MAAO,SC5BxB4B,EAAAA,EAAAA,IAMS,UALNO,QAAK+D,EAAA,KAAAA,EAAA,GD+BpB,IAAInI,IC/BkBmC,EAAA03C,qBAAA13C,EAAA03C,uBAAA75C,IACR4C,KAAK,SACLX,MAAM,wCDgCDsG,EAAAA,EAAAA,IC9BFpG,EAAApD,SAAS,iBAAD,QDgCVqJ,EAAAA,EAAAA,OC5BL0B,EAAAA,EAAAA,IAA8Do9B,EAAA,CD6BxD/iC,IAAK,EC7BSunB,eAAevpB,EAAA23C,yBD+B5B,KAAM,EAAG,CAAC,yBC3BrBj2C,EAAAA,EAAAA,IAcW,WAdXmO,GAcW,EAbTnO,EAAAA,EAAAA,IAAiD,eAAA0E,EAAAA,EAAAA,IAAtCpG,EAAApD,SAAS,mBAAD,IAEnB8E,EAAAA,EAAAA,IAUQ,SATL5B,OAAKC,EAAAA,EAAAA,IAAA,qBAAyBC,EAAAiE,oBAAoBwM,gBD8BlD,EACDrJ,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,IC7BdpG,EAAApD,SAAS,iCAAkC,IAC9C,ID6BAmK,EAAAA,EAAAA,KC7BArF,EAAAA,EAAAA,IAKE,SDyBA,sBAAuBsE,EAAO,KAAOA,EAAO,GAAM9D,GC7BzClC,EAAAiE,oBAAoB1E,QAAQE,YAAWyC,GAC/C8E,QAAKhB,EAAA,KAAAA,EAAA,GAAA9D,GAAElC,EAAAuE,qBAAqB,uCAC5BsM,UAAW7Q,EAAAiE,oBAAoBwM,aAChChQ,KAAK,QD8BJ,KAAM,GAAI0S,IAAc,CACzB,CAACjM,EAAAA,GClCQlH,EAAAiE,oBAAoB1E,QAAQE,gBDoCtC,MC5BLiC,EAAAA,EAAAA,IAaW,WAbX0R,GAaW,EAZT1R,EAAAA,EAAAA,IAA2C,eAAA0E,EAAAA,EAAAA,IAAhCpG,EAAApD,SAAS,aAAD,IAEnB8E,EAAAA,EAAAA,IASQ,eDqBN0F,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,IC7BdpG,EAAApD,SAAS,wBAAyB,IACrC,ID6BAmK,EAAAA,EAAAA,KC7BArF,EAAAA,EAAAA,IAME,SDwBA,sBAAuBsE,EAAO,KAAOA,EAAO,GAAM9D,GC7BzClC,EAAAiE,oBAAoB1E,QAAQI,cAAauC,GACjD8E,QAAKhB,EAAA,KAAAA,EAAA,GAAA9D,GAAiBlC,EAAAuE,qBAAoB,yCAG3C9D,KAAK,QD8BJ,KAAM,KAAM,CACb,CAACyG,EAAAA,GCnCQlH,EAAAiE,oBAAoB1E,QAAQI,wBDyCjD,CEtKA,MACM8B,GAAa,CCFP3B,MAAM,sBDGZ6B,GAAa,CACjBK,IAAK,ECEDlC,MAAM,+BDCNwC,GAAa,CCCRxC,MAAM,8BDAX4C,GAAa,CCYNS,MAAA,0BDXPR,GAAa,CAAC,SACdC,GAAa,CACjBZ,IAAK,EC0BCI,GAAG,cACHtC,MAAM,+BDvBR+C,GAAa,CCyBN/C,MAAM,8BDxBbgD,GAAa,CCuCJK,MAAA,0BDtCTJ,GAAa,CAAC,SAEd,SAAUvB,GAAOxB,EAAUgG,EAAY6B,EAAYC,EAAYC,EAAWC,GAC9E,MAAM4vC,GAA+B7nC,EAAAA,EAAAA,IAAkB,qBACjDg1B,GAAwBh1B,EAAAA,EAAAA,IAAkB,cAEhD,OAAQ9J,EAAAA,EAAAA,OCvBRrG,EAAAA,EAAAA,IA4EW,WA5EX6B,GA4EW,EA3ETC,EAAAA,EAAAA,IAAwC,eAAA0E,EAAAA,EAAAA,IAA7BpG,EAAApD,SAAS,UAAD,IAEnB8E,EAAAA,EAAAA,IAAmE,cAAA0E,EAAAA,EAAAA,IAAzDpG,EAAApD,SAASoD,EAAAi3C,KAAKY,OAAS,cAAgB,SAAnB,GAEF,UAApB73C,EAAAi3C,KAAKa,MAAMr3C,MAAoBT,EAAAi3C,KAAKa,MAAMh4B,UDsB7C7Z,EAAAA,EAAAA,OCvBLrG,EAAAA,EAAAA,IAyBM,MAzBN+B,GAyBM,EArBJD,EAAAA,EAAAA,IAEM,MAFNY,GAEM,EADJgE,EAAAA,EAAAA,IAA2CsxC,EAAA,CAAvBl/C,QAASsH,EAAAi3C,KAAKa,ODsB3B,KAAM,EAAG,CAAC,eCnBnBp2C,EAAAA,EAAAA,IAMS,UALPjB,KAAK,SACJwB,QAAK+D,EAAA,KAAAA,EAAA,GAAA9D,GAAElC,EAAA+3C,mBAAmB,UAC3Bj4C,MAAM,+BDsBDsG,EAAAA,EAAAA,ICpBFpG,EAAApD,SAAS,iBAAD,IAGb8E,EAAAA,EAAAA,IAQQ,QARRgB,GAQQ,EDWF0E,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,IClBjBpG,EAAApD,SAAS,qBAAsB,IACnC,IAAA8E,EAAAA,EAAAA,IAKE,SAJAjB,KAAK,OACJ5G,MAAOmG,EAAAi3C,KAAKa,MAAM/3B,QAClB/Y,QAAKhB,EAAA,KAAAA,EAAA,GAAA9D,GAAElC,EAAAg4C,eAAe91C,EAAQ,UAC/BpC,MAAM,iBDmBD,KAAM,GAAI6C,WAGhBsD,EAAAA,EAAAA,OClBL0B,EAAAA,EAAAA,IAAqEo9B,EAAA,CDmB/D/iC,IAAK,ECnBSunB,eAAavjB,EAAA,KAAAA,EAAA,GAAA9D,GAAElC,EAAAi4C,cAAc/1C,EAAQ,aAEzClC,EAAAi3C,KAAKY,SDqBhB5xC,EAAAA,EAAAA,OCrBLrG,EAAAA,EAAAA,IAkCWgC,EAAAA,GAAA,CAAAI,IAAA,KAjCTN,EAAAA,EAAAA,IAA6C,cAAA0E,EAAAA,EAAAA,IAAnCpG,EAAApD,SAAS,iBAAD,GAGW,UAArBoD,EAAAi3C,KAAKY,OAAOp3C,MAAoBT,EAAAi3C,KAAKY,OAAO/3B,UDoB3C7Z,EAAAA,EAAAA,OCrBTrG,EAAAA,EAAAA,IA6BM,MA7BNgD,GA6BM,EAxBJlB,EAAAA,EAAAA,IAKM,MALNmB,GAKM,EAJJyD,EAAAA,EAAAA,IAGEsxC,EAAA,CAFCl/C,QAASsH,EAAAi3C,KAAKY,OACf/3C,MAAM,sBDkBG,KAAM,EAAG,CAAC,eCdvB4B,EAAAA,EAAAA,IAMS,UALPjB,KAAK,SACJwB,QAAK+D,EAAA,KAAAA,EAAA,GAAA9D,GAAElC,EAAA+3C,mBAAmB,WAC3Bj4C,MAAM,+BDiBGsG,EAAAA,EAAAA,ICfNpG,EAAApD,SAAS,iBAAD,IAGb8E,EAAAA,EAAAA,IAQQ,QARRoB,GAQQ,EDMEsE,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,ICbrBpG,EAAApD,SAAS,qBAAsB,IACnC,IAAA8E,EAAAA,EAAAA,IAKE,SAJAjB,KAAK,OACJ5G,MAAOmG,EAAAi3C,KAAKY,OAAO93B,QACnB/Y,QAAKhB,EAAA,KAAAA,EAAA,GAAA9D,GAAElC,EAAAg4C,eAAe91C,EAAQ,WAC/BpC,MAAM,iBDcG,KAAM,GAAIiD,WAGhBkD,EAAAA,EAAAA,OCbT0B,EAAAA,EAAAA,IAAsEo9B,EAAA,CDc5D/iC,IAAK,ECdKunB,eAAavjB,EAAA,KAAAA,EAAA,GAAA9D,GAAElC,EAAAi4C,cAAc/1C,EAAQ,eDiBpD,KCbMlC,EAAAi3C,KAAKa,MAAMh4B,UDejB7Z,EAAAA,EAAAA,OChBPrG,EAAAA,EAAAA,IAOS,UDUDoC,IAAK,ECfXvB,KAAK,SACJwB,QAAK+D,EAAA,KAAAA,EAAA,GDkBZ,IAAInI,IClBUmC,EAAAk4C,gBAAAl4C,EAAAk4C,kBAAAr6C,IACRiC,MAAM,4BDmBCsG,EAAAA,EAAAA,ICjBJpG,EAAApD,SAAS,4BAAD,KDkBPgL,EAAAA,EAAAA,IAAoB,IAAI,IAElC,CE7FA,MACMnG,GAAa,CCFX3B,MAAM,sBDGR6B,GAAa,CACjBK,IAAK,ECHmClC,MAAM,yBDM1CwC,GAAa,CACjBN,IAAK,ECAYlC,MAAM,6BDGnB4C,GAAa,CACjBV,IAAK,ECFuClC,MAAM,gBDM9C,SAAU0B,GAAOxB,EAAUgG,EAAY6B,EAAYC,EAAYC,EAAWC,GAC9E,MAAM2W,GAAuB5O,EAAAA,EAAAA,IAAkB,aACzC9H,GAA0BC,EAAAA,EAAAA,IAAkB,gBAElD,OAAOnB,EAAAA,EAAAA,MAAiBd,EAAAA,EAAAA,OCpBxBrG,EAAAA,EAAAA,IAaO,OAbP6B,GAaO,CAZwB,UAAjBzB,EAAAtH,QAAQ+H,ODqBfwF,EAAAA,EAAAA,OCrBLrG,EAAAA,EAAAA,IAQO,OARP+B,GAQO,CANG3B,EAAAtH,QAAQonB,UDqBP7Z,EAAAA,EAAAA,OCtBT0B,EAAAA,EAAAA,IAKEgX,EAAA,CDkBQ3c,IAAK,ECrBZoG,IAAKpI,EAAA4f,YAAY5f,EAAAtH,QAAQonB,SACzBtX,IAAKxI,EAAAtH,QAAQqnB,QACdjgB,MAAM,iBDuBG,KAAM,EAAG,CAAC,MAAO,WACnBmG,EAAAA,EAAAA,OCtBTrG,EAAAA,EAAAA,IAAiD,OAAjD0C,QAEgC,SAAjBtC,EAAAtH,QAAQ+H,ODuBlBwF,EAAAA,EAAAA,OCvBPrG,EAAAA,EAAAA,IAEO,OAFP8C,GAEO,EADLhB,EAAAA,EAAAA,IAAoC,aAAA0E,EAAAA,EAAAA,IAA1BpG,EAAAtH,QAAQozC,SAAO,ODyBrBlkC,EAAAA,EAAAA,IAAoB,IAAI,MAC3B,CACH,CAACK,IAEL,CChBA,QAAe5H,EAAAA,EAAAA,IAAgB,CAC7B8B,KAAM,oBACN2P,WAAY,CAAE0Q,UAASA,IACvBjiB,MAAO,CACL7H,QAAS,CACP+H,KAAMzE,OACN2E,UAAU,IAGdyI,QAAS,CAAEwW,YAAWA,MC3BxB,MAAM,IAA2B,OAAgB,GAAQ,CAAC,CAAC,SAAS,IAAQ,CAAC,YAAY,qBAEzF,UHgFA,IAAevf,EAAAA,EAAAA,IAAgB,CAC7B8B,KAAM,mBACN2P,WAAY,CAAEqmC,kBAAiB,GAAE7uB,WAAUA,IAC3C/oB,MAAO,CACL02C,KAAM,CACJx2C,KAAMzE,OACN2E,UAAU,IAGdyI,QAAS,CACPxM,SAAQ,KACRq7C,aAAAA,CAAcl6B,EAAerlB,GAE3BuI,KAAK4Q,MAAM,cAAe,IACrB5Q,KAAKg2C,KACR,CAACv+C,GAAU,IACNuI,KAAKg2C,KAAKv+C,GACbonB,QAAS/B,EAAK3b,KAGpB,EACA41C,cAAAA,CAAexyC,EAAmB9M,GAChC,MAAMqnB,EAAWva,EAAME,OAA4B7L,MACnDoH,KAAK4Q,MACH,cACA,IACK5Q,KAAKg2C,KACR,CAACv+C,GAAU,IACNuI,KAAKg2C,KAAKv+C,GACbqnB,YAGJ9e,KAAKg2C,KAAKv+C,IAAU8F,KAAO,WAE/B,EACA05C,cAAAA,GACEj3C,KAAK4Q,MAAM,cAAe,IACrB5Q,KAAKg2C,KACRY,OAAQ,CACNr5C,MAAMyG,EAAAA,EAAAA,KACNxE,KAAM,QACNqf,QAAS,GACTC,QAAS,KAGf,EACAg4B,kBAAAA,CAAmBr/C,GACD,UAAZA,EACFuI,KAAK4Q,MAAM,cAAe,IACrB5Q,KAAKg2C,KACRa,MAAO,IACF72C,KAAKg2C,KAAKa,MACbh4B,QAAS,MAIb7e,KAAK4Q,MAAM,cAAe,IACrB5Q,KAAKg2C,KACRY,YAAQt7C,GAGd,KI/IJ,MAAM,IAA2B,OAAgB,GAAQ,CAAC,CAAC,SAAS,IAAQ,CAAC,YAAY,qBAEzF,UNuPA,IAAe8D,EAAAA,EAAAA,IAAgB,CAC7B8B,KAAM,eACNqB,KAAAA,GACE,MAAO,CACLE,YAAYpD,EAAAA,EAAAA,IAAwBnI,EAAAA,GAExC,EACA2Z,WAAY,CAAE0Q,UAAS,GAAE41B,iBAAgB,GAAE9uB,WAAUA,IACrD/oB,MAAO,CACL/F,eAAgB,CACdiG,KAAMzE,OACN2E,UAAU,IAGdG,IAAAA,GACE,MAAO,CACLo2C,mBAAoB,EACpBjzC,qBAAqBC,EAAAA,EAAAA,WAAUjD,KAAKzG,gBAExC,EACAQ,MAAO,CAELR,eAAgB,CACdwO,WAAW,EACXC,QAAS,WACPhI,KAAKgD,qBAAsBC,EAAAA,EAAAA,WAAUjD,KAAKzG,eAC5C,IAGJ69C,WAAAA,GACMp3C,KAAKzG,eAAew8C,MAAMzrC,OAAS,IACrCtK,KAAKi2C,kBAAoB,EAE7B,EACA9tC,QAAS,CACPwW,YAAW,GACXhjB,SAAQ,KACRkB,UAAS,KACTyG,oBAAAA,CAAqB3J,GAEnBqG,KAAKyC,WAAYhJ,YAAY,CAC3BC,mBAAmBuJ,EAAAA,EAAAA,WAAUjD,KAAKgD,qBAClCrJ,UAAWA,GAAa,CAAC,GAE7B,EACA8O,UAAAA,CAAWC,GACT,OACE5M,OAAOC,OAAO4M,WAAa,qBAAuBD,EAAW,MAEjE,EACAwtC,UAAAA,CAAWxyC,GACT1D,KAAKi2C,kBAAoBvyC,CAC3B,EACAyyC,aAAAA,CAAczyC,EAAesyC,GAC3B,IAAIvjC,EAAO/O,EAAQ,EAAI,KAevB,OAdA+O,IAAQ9W,EAAAA,EAAAA,IAAS,QAcV8W,CACT,EACA4jC,OAAAA,GACEr2C,KAAKgD,qBAAsBQ,EAAAA,EAAAA,IAAQxD,KAAKgD,qBAAsBS,IAC5DA,EAAMsyC,MAAMv0C,KAAK,CACfjE,MAAMyG,EAAAA,EAAAA,KACN6yC,MAAO,CACLt5C,MAAMyG,EAAAA,EAAAA,KACNxE,KAAM,QACNqf,QAAS,GACTC,QAAS,KAEX,IAEJ9e,KAAKyC,WAAYhJ,YAAY,CAC3BC,kBAAmBsG,KAAKgD,oBACxBrJ,UAAW,CAAC,IAGdqG,KAAKi2C,kBAAoBj2C,KAAKgD,oBAAoB+yC,MAAMzrC,OAAS,CACnE,EACA8rC,UAAAA,CAAW1yC,GACT1D,KAAKgD,qBAAsBQ,EAAAA,EAAAA,IAAQxD,KAAKgD,qBAAsBS,IAC5DA,EAAMsyC,MAAMlyC,OAAOH,EAAO,EAAE,IAG9B1D,KAAKsD,uBAGDI,GAAS1D,KAAKi2C,oBAChBj2C,KAAKi2C,kBAAoBj2C,KAAKi2C,kBAAoB,EAEtD,EACAK,UAAAA,CAAWe,EAAyB19C,GAClCqG,KAAKgD,qBAAsBQ,EAAAA,EAAAA,IAAQxD,KAAKgD,qBAAsBS,IAC5DA,EAAMsyC,MAAM/1C,KAAKi2C,mBAAqBoB,CAAW,IAEnDr3C,KAAKsD,qBAAqB3J,EAC5B,EACA+8C,uBAAAA,CAAwB55B,GACtB,MAAMpjB,GAAoB8J,EAAAA,EAAAA,IAAQxD,KAAKgD,qBAAsBS,IAC3DA,EAAM+yC,SAAW,CACfj5C,MAAMyG,EAAAA,EAAAA,KACNxE,KAAM,QACNqf,QAAS/B,EAAK3b,GACd2d,QAAS,GACV,IAEH9e,KAAKyC,WAAYhJ,YAAY,CAC3BC,kBAAmBA,EACnBC,UAAW,CAAC,GAEhB,EACA88C,mBAAAA,GACE,MAAM/8C,GAAoB8J,EAAAA,EAAAA,IAAQxD,KAAKgD,qBAAsBS,IAC3DA,EAAM+yC,cAAWl7C,CAAS,IAE5B0E,KAAKyC,WAAYhJ,YAAY,CAC3BC,kBAAmBA,EACnBC,UAAW,CAAC,GAEhB,KO3XJ,MAAM,IAA2B,OAAgB,GAAQ,CAAC,CAAC,SAAS,IAAQ,CAAC,YAAY,qBAEzF,UCPA,MACM6G,GAAa,CCFZ3B,MAAM,eDGP6B,GAAa,CACjBK,IAAK,ECeDmB,MAAA,iIDZAb,GAAa,CAAC,eACdI,GAAa,CAAC,eACdC,GAAa,CAAC,eACdC,GAAa,CAAC,eACdC,GAAa,CAAC,eACdC,GAAa,CAAC,eACdC,GAAa,CACjBf,IAAK,ECkDuBlC,MAAM,kBD/C9BkD,GAAc,CCoDXlD,MAAM,gBDnDTmD,GAAc,CAAC,eAEf,SAAUzB,GAAOxB,EAAUgG,EAAY6B,EAAYC,EAAYC,EAAWC,GAC9E,MAAMuwC,GAA8BxoC,EAAAA,EAAAA,IAAkB,oBAEtD,OAAQ9J,EAAAA,EAAAA,OCvBRrG,EAAAA,EAAAA,IA8EM,MA9EN6B,GA8EM,EA7EJC,EAAAA,EAAAA,IAcM,OAbJ5B,MAAM,cACLqD,OAAKsM,EAAAA,EAAAA,IAAA,CDwBJ+oC,oBCxBqCx4C,EAAAw4C,oBDyBrCC,iBCzBoFz4C,EAAAy4C,oBD2BrF,GACAxyC,EAAAA,EAAAA,KAAW,ICvBZrG,EAAAA,EAAAA,IAMWgC,EAAAA,GAAA,MAAAC,EAAAA,EAAAA,IAAA,KANmBm1C,OAAbC,KDwBPhxC,EAAAA,EAAAA,OCvBR0B,EAAAA,EAAAA,IAIE4wC,EAAA,CDoBAv2C,ICzBuCi1C,EAAK70C,GAE3C60C,KAAMA,EACNQ,SAAUz3C,EAAAqK,KAAKotC,SACfx1C,QAAKC,GAAElC,EAAA04C,YAAYzB,IDyBnB,KAAM,EAAG,CAAC,OAAQ,WAAY,eAC/B,OACH,GCrBKj3C,EAAA24C,aDuBH1yC,EAAAA,EAAAA,OCxBLrG,EAAAA,EAAAA,IAkDM,MAlDN+B,GAkDM,EAvCJD,EAAAA,EAAAA,IAUM,aATJA,EAAAA,EAAAA,IAA8D,QAAxD5B,MAAM,qBDgBN2I,aChB2BrC,EAAAA,EAAAA,IAA0BpG,EAAApD,SAAT,WDiB3C,KAAM,EAAG0F,KChBhBZ,EAAAA,EAAAA,IAOE,QDWI+G,aCjBJrC,EAAAA,EAAAA,IDkBE,IClBqCpG,EAAApD,SAAQ,sBDoB3Co5B,KAAM/0B,KCpBuF4qB,MAAM/xB,eDuBlG,KAAM,EAAG4I,OCdlBhB,EAAAA,EAAAA,IAMM,aALJA,EAAAA,EAAAA,IAGE,QAFA5B,MAAM,qBDiBF2I,aChBJrC,EAAAA,EAAAA,IAAuCpG,EAAApD,SAAtB,wBDiBZ,KAAM,EAAG+F,KCfhBjB,EAAAA,EAAAA,IAAqD,QDiB/C+G,aCjBArC,EAAAA,EAAAA,IAA4C,SAAzBwyC,cAAc9+C,aDkBhC,KAAM,EAAG8I,OCflBlB,EAAAA,EAAAA,IAcM,aAbJA,EAAAA,EAAAA,IAGE,QAFA5B,MAAM,qBDkBF2I,aCjBJrC,EAAAA,EAAAA,IAAuCpG,EAAApD,SAAtB,wBDkBZ,KAAM,EAAGiG,KChBhBnB,EAAAA,EAAAA,IAQE,QDUI+G,aCjBJrC,EAAAA,EAAAA,IDkBE,IClBqCpG,EAAApD,SAAQ,wDDoB3Ci8C,oBAAqB53C,KCpByH43C,oBAAoB/+C,WDqBlKg/C,mBAAoB73C,KCrBiM63C,mBAAmBh/C,eDwBvO,KAAM,EAAGgJ,MCdP9C,EAAA6U,cDiBF5O,EAAAA,EAAAA,OCjBTrG,EAAAA,EAAAA,IAEM,MAFNmD,IAEMqD,EAAAA,EAAAA,IAAA,KADIzG,eAAa,KDiBfiI,EAAAA,EAAAA,IAAoB,IAAI,OAE9BA,EAAAA,EAAAA,IAAoB,IAAI,ICf5BlG,EAAAA,EAAAA,IAQM,MARNsB,GAQM,CANIhD,EAAAkV,kBDgBHjP,EAAAA,EAAAA,OCjBLrG,EAAAA,EAAAA,IAME,UDYIoC,IAAK,EACLyG,aCjBJrC,EAAAA,EAAAA,IAAsC,KAAzBiE,KAAK9K,QAAQE,aACzBwC,QAAK+D,EAAA,KAAAA,EAAA,GDmBd,IAAInI,ICnBYmC,EAAAsZ,iBAAAtZ,EAAAsZ,mBAAAzb,IACR4C,KAAK,SACLX,MAAM,iBDoBD,KAAM,EAAGmD,MACZ2E,EAAAA,EAAAA,IAAoB,IAAI,MAGlC,C,4hTEhGA,MACMnG,GAAa,CCKT3B,MAAM,oBDJV6B,GAAa,CAAC,OAEd,SAAUH,GAAOxB,EAAUgG,EAAY6B,EAAYC,EAAYC,EAAWC,GAC9E,MAAM4vC,GAA+B7nC,EAAAA,EAAAA,IAAkB,qBACjDgpC,GAAwBhpC,EAAAA,EAAAA,IAAkB,cAC1C9H,GAA0BC,EAAAA,EAAAA,IAAkB,gBAElD,OAAOnB,EAAAA,EAAAA,MAAiBd,EAAAA,EAAAA,OCZxBrG,EAAAA,EAAAA,IAuBS,UAtBPa,KAAK,SACLX,OAAKC,EAAAA,EAAAA,IAAA,CAAC,wBAAuB,CAAAi5C,QACVh5C,EAAAi3C,KAAK+B,YDYvB,ECTDt3C,EAAAA,EAAAA,IAEO,QAFD5B,OAAKC,EAAAA,EAAAA,IAAA,CAAC,oBAAmB,eAA0BC,EAAAi3C,KAAKgC,WDY3D,ECXD3yC,EAAAA,EAAAA,IAAqCsxC,EAAA,CAAjBl/C,QAASsH,EAAAi3C,MAAI,qBDahC,ICXHv1C,EAAAA,EAAAA,IAaO,OAbPD,GAaO,CAXGzB,EAAAy3C,WDYHxxC,EAAAA,EAAAA,OCbL0B,EAAAA,EAAAA,IAKEoxC,EAAA,CDSI/2C,IAAK,ECZRoG,IAAKpI,EAAA4f,YAAY5f,EAAAy3C,SAAS33B,SAC1BtX,IAAKxI,EAAAy3C,SAAS13B,QACfjgB,MAAM,0BDcD,KAAM,EAAG,CAAC,MAAO,WACnBmG,EAAAA,EAAAA,OCbLrG,EAAAA,EAAAA,IAKE,ODSIoC,IAAK,ECZToG,IAAAC,GACCG,IAAKxI,EAAApD,SAAS,iCACfkD,MAAM,0BDcD,KAAM,EAAG6B,QAEjB,IAAK,CACN,CAACsG,IAEL,CCJA,QAAe5H,EAAAA,EAAAA,IAAgB,CAC7B8B,KAAM,mBACN2P,WAAY,CAAEqmC,kBAAiB,GAAE31B,UAASA,IAC1CjiB,MAAO,CACL02C,KAAM,CACJx2C,KAAMzE,OACN2E,UAAU,GAEZ82C,SAAU,CACRh3C,KAAMzE,OACN2E,UAAU,IAGdW,SAAU,CAAC,EACX8H,QAAS,CAAExM,SAAQ,KAAEgjB,YAAWA,MC3ClC,MAAM,IAA2B,OAAgB,GAAQ,CAAC,CAAC,SAAS,IAAQ,CAAC,YAAY,qBAEzF,UH8FA,IAAevf,EAAAA,EAAAA,IAAgB,CAC7B8B,KAAM,eACN2P,WAAY,CAAEonC,iBAAgBA,IAC9BznC,MAAO,CAAC,iBACRlR,MAAO,CACL8J,KAAM,CACJ5J,KAAMzE,OACN2E,UAAU,IAGdG,IAAAA,GACE,MAAO,CACLk2C,MAAO,GACPmC,wBAAoB58C,EACpB68C,oCAAgC78C,EAChCq8C,cAAe,EAEf/sB,MAAO,EACPO,cAAc,EACdC,cAAe,KAEnB,EACAjjB,QAAS,CACPxM,SAAQ,KAER87C,WAAAA,CAAYzB,GAEV,IAAIA,EAAK+B,QAWT,GATA/B,EAAK+B,SAAU,EAGV/3C,KAAKmrB,cACRnrB,KAAK2rB,aAGP3rB,KAAK23C,gBAEA33C,KAAKk4C,mBAOH,CAEL,GAAIlC,EAAKoC,iBAAmBp4C,KAAKm4C,+BAAgC,CAG/DnC,EAAKgC,QAAS,EACd,MAAMK,EAAYr4C,KAAKs4C,YAAYt4C,KAAKk4C,oBACxCG,EAAUL,QAAS,C,CAGrBh4C,KAAKk4C,wBAAqB58C,EAC1B0E,KAAKm4C,oCAAiC78C,C,MAftC0E,KAAKu4C,4BAA4BvC,EAAKz4C,MAEtCyC,KAAKk4C,mBAAqBlC,EAAKz4C,KAC/ByC,KAAKm4C,+BAAiCnC,EAAKoC,cAc/C,EAEAzsB,UAAAA,GACE3rB,KAAKmrB,cAAe,EAGpBnrB,KAAKorB,cAAgBQ,aAAY,KAC/B5rB,KAAK4qB,OAAO,GACX,IACL,EAEAiB,SAAAA,GAE6B,OAAvB7rB,KAAKorB,gBACPU,cAAc9rB,KAAKorB,eACnBprB,KAAKorB,cAAgB,MAGvBprB,KAAKmrB,cAAe,CACtB,EAEAotB,2BAAAA,CAA4BC,GAC1B,IAAK,MAAMxC,KAAQh2C,KAAK+1C,MACjBC,EAAKgC,QAAUhC,EAAKz4C,OAASi7C,IAChCxC,EAAK+B,SAAU,EAGrB,EAEA1/B,eAAAA,GACErY,KAAK23C,cAAgB,EACrB33C,KAAK4qB,MAAQ,EACb5qB,KAAKk4C,wBAAqB58C,EAC1B0E,KAAKy4C,aACLz4C,KAAK04C,cACP,EAEAD,UAAAA,GAEE,IAAK,MAAMzC,KAAQh2C,KAAK+1C,MACtBC,EAAK+B,SAAU,EACf/B,EAAKgC,QAAS,CAElB,EAEAU,YAAAA,GAGE14C,KAAK+1C,MAAQ/1C,KAAK+1C,MACfltC,KAAKmtC,IAAI,CAAQA,OAAMltC,KAAM0B,KAAKoM,aAClC9N,MAAK,CAAC6vC,EAAOC,IAAUD,EAAM7vC,KAAO8vC,EAAM9vC,OAC1CD,KAAI,EAAGmtC,UAAWA,GACvB,EAEAsC,WAAAA,CAAYO,GACV,MAAM7C,EAAOh2C,KAAK+1C,MAAM95C,MAAM+5C,GAASA,EAAKz4C,OAASs7C,IACrD,IAAK7C,EACH,MAAM,IAAIh8C,MAAM,oCAAsC6+C,GAExD,OAAO7C,CACT,EAEA8C,UAAAA,CACErhD,EACA2gD,GAEA,MAAO,CACL76C,KAAM9F,EAAQ8F,KACdiC,KAAM/H,EAAQ+H,KACdqf,QAA0B,SAAjBpnB,EAAQ+H,KAAkB/H,EAAQonB,aAAUvjB,EACrDwjB,QAA0B,SAAjBrnB,EAAQ+H,KAAkB/H,EAAQqnB,aAAUxjB,EACrDuvC,QAA0B,SAAjBpzC,EAAQ+H,KAAkB/H,EAAQozC,aAAUvvC,EACrDy8C,SAAS,EACTC,QAAQ,EACRI,iBAEJ,GAGF/3C,SAAU,CACRw3C,kBAAAA,GACE,OAAO73C,KAAKoJ,KAAK2sC,MAAMzrC,MACzB,EAEAotC,UAAAA,GACE,IAAK,MAAM1B,KAAQh2C,KAAKoJ,KAAK2sC,MAC3B,IACuB,UAApBC,EAAKa,MAAMr3C,MAAwC,UAApBw2C,EAAKa,MAAMr3C,OAC3Cw2C,EAAKa,MAAMh4B,QAEX,OAAO,EAGX,OAAO,CACT,EAEA+4B,mBAAAA,GACE,IAAImB,EAAsB,EAC1B,IAAK,MAAM/C,KAAQh2C,KAAK+1C,MAClBC,EAAKgC,QAAQe,IAEnB,OAAOA,EAAsB,CAC/B,EAEAC,UAAAA,GACE,OACEh5C,KAAK63C,mBAAqB,GAC1B73C,KAAK43C,sBAAwB53C,KAAK63C,kBAEtC,EAEAjkC,WAAAA,GACE,OAAO5T,KAAKg5C,UACd,EAEA/kC,eAAAA,GACE,OAAOjU,KAAKg5C,UACd,EAEAt6C,aAAAA,GACE,OAAOsB,KAAKoJ,KAAK9K,QAAQI,aAC3B,EAEA64C,mBAAAA,GACE,GAAIv3C,KAAKoJ,KAAKmtC,aAAc,CAC1B,MAAM0C,EAAUzuC,KAAK0uC,KAAK1uC,KAAK2uC,KAAKn5C,KAAK+1C,MAAMzrC,SAC/C,MAAO,UAAU2uC,S,CAEjB,MAAO,sCAEX,EAEAzB,gBAAAA,GACE,GAAIx3C,KAAKoJ,KAAKmtC,aAAc,CAC1B,MAAMnqB,EAAO5hB,KAAK0uC,KAChBl5C,KAAK+1C,MAAMzrC,OAASE,KAAK0uC,KAAK1uC,KAAK2uC,KAAKn5C,KAAK+1C,MAAMzrC,UAErD,MAAO,UAAU8hB,S,CAEjB,MAAO,MAEX,GAEFryB,MAAO,CACLqP,KAAM,CACJpB,OAAAA,GACEpO,QAAQC,IAAI,yBACZmG,KAAKk4C,wBAAqB58C,EAC1B0E,KAAK23C,cAAgB,EAGrB33C,KAAK+1C,MAAQ/1C,KAAKoJ,KAAK2sC,MAAMpC,SAASqC,IACpC,GAAKA,EAAKY,OAQH,CAEL,MAAMyB,EAAYr4C,KAAK84C,WAAW9C,EAAKa,MAAOb,EAAKz4C,MAC7C67C,EAAap5C,KAAK84C,WAAW9C,EAAKY,OAAQZ,EAAKz4C,MACrD,MAAO,CAAC86C,EAAWe,E,CAZH,CAEhB,MAAMC,EAAWr5C,KAAK84C,WAAW9C,EAAKa,MAAOb,EAAKz4C,MAC5C+7C,EAAYt5C,KAAK84C,WACrB,IAAK9C,EAAKa,MAAOt5C,MAAMyG,EAAAA,EAAAA,MACvBgyC,EAAKz4C,MAEP,MAAO,CAAC87C,EAAUC,E,KAUtBt5C,KAAK04C,cACP,EACA3wC,WAAW,GAEbixC,UAAAA,CAAW31C,GACLA,GACFrD,KAAK6rB,WAET,KI3UJ,MAAM,IAA2B,OAAgB,GAAQ,CAAC,CAAC,SAAS,IAAQ,CAAC,YAAY,qBAEzF,UCPA,MACMrrB,GAAa,CCFZ3B,MAAM,eDGP6B,GAAa,CCFT7B,MAAM,WDGVwC,GAAa,CCFHxC,MAAM,kBDGhB4C,GAAa,CCAN5C,MAAM,kBDCb6C,GAAa,CACjBX,IAAK,ECiB+BlC,MAAM,iBDdtC8C,GAAa,CC6BJ9C,MAAM,gCD5Bf+C,GAAa,CAAC,eACdC,GAAa,CCsCHhD,MAAM,yBDrChBiD,GAAa,CC2DHjD,MAAM,yBD1DhBkD,GAAc,CAAC,YACfC,GAAc,CAAC,YAEf,SAAUzB,GAAOxB,EAAUgG,EAAY6B,EAAYC,EAAYC,EAAWC,GAC9E,MAAMwyC,GAA+BzqC,EAAAA,EAAAA,IAAkB,qBACjD0qC,GAA+B1qC,EAAAA,EAAAA,IAAkB,qBACjD2qC,GAA4B3qC,EAAAA,EAAAA,IAAkB,kBAEpD,OAAQ9J,EAAAA,EAAAA,OCtBRrG,EAAAA,EAAAA,IAwHM,MAxHN6B,GAwHM,EAvHJC,EAAAA,EAAAA,IAsHO,OAtHPC,GAsHO,EArHLD,EAAAA,EAAAA,IA8CW,WA9CXY,GA8CW,EA7CTZ,EAAAA,EAAAA,IAA0C,eAAA0E,EAAAA,EAAAA,IAA/BpG,EAAApD,SAAS,YAAD,IAEnB8E,EAAAA,EAAAA,IAiBM,MAjBNgB,GAiBM,GDKHuD,EAAAA,EAAAA,KAAW,ICrBZrG,EAAAA,EAAAA,IAQEgC,EAAAA,GAAA,MAAAC,EAAAA,EAAAA,IAPwB7B,EAAAiE,oBAAoB02C,OAAK,CAAzCC,EAAMj2C,MDqBNsB,EAAAA,EAAAA,OCtBV0B,EAAAA,EAAAA,IAQE6yC,EAAA,CANCx4C,IAAK44C,EAAKp8C,KACVsB,OAAKC,EAAAA,EAAAA,IAAA,CDsBJ3C,SCtBgCuH,IAAU3E,EAAA66C,oBAG3CD,KAAM56C,EAAAiE,oBAAoB02C,MAAMh2C,GAChC1C,QAAKC,GAAElC,EAAA86C,YAAYn2C,IDsBjB,KAAM,EAAG,CAAC,QAAS,OAAQ,eAC5B,OCpBJjD,EAAAA,EAAAA,IAKE,UAJAjB,KAAK,SACLX,MAAM,kBACLmC,QAAK+D,EAAA,KAAAA,EAAA,GAAA9D,GAAElC,EAAA+6C,kBACP53C,OAAKsM,EAAAA,EAAAA,IAAEzP,EAAAg7C,+BDsBP,KAAM,KClBKh7C,EAAAi7C,eDqBXh1C,EAAAA,EAAAA,OCrBLrG,EAAAA,EAAAA,IAuBW,WAvBX+C,GAuBW,EAtBTjB,EAAAA,EAAAA,IAAuC,eAAA0E,EAAAA,EAAAA,IAA5BpG,EAAApD,SAAS,SAAD,IAEnB0J,EAAAA,EAAAA,IAIEm0C,EAAA,CAHCj6C,MAAOR,EAAApD,SAAS,WAChB,qBAAoBoD,EAAAi7C,aAAaC,iBACjCC,iBAAiBn7C,EAAAo7C,0BDqBb,KAAM,EAAG,CAAC,QAAS,qBAAsB,sBClBhD90C,EAAAA,EAAAA,IAIEm0C,EAAA,CAHCj6C,MAAOR,EAAApD,SAAS,WAChB,qBAAoBoD,EAAAi7C,aAAaI,cACjCF,iBAAiBn7C,EAAAs7C,uBDoBb,KAAM,EAAG,CAAC,QAAS,qBAAsB,sBCjBhD55C,EAAAA,EAAAA,IAOM,MAPNkB,GAOM,EANJlB,EAAAA,EAAAA,IAKE,UAJAjB,KAAK,SACJwB,QAAK+D,EAAA,KAAAA,EAAA,GAAA9D,GAAElC,EAAAu7C,kBAAkBv7C,EAAA66C,oBDmBtBpyC,aClBJrC,EAAAA,EAAAA,IAAiCpG,EAAApD,SAAhB,iBACjBkD,MAAM,mCDmBD,KAAM,EAAG+C,UAGhB+E,EAAAA,EAAAA,IAAoB,IAAI,MChB9BlG,EAAAA,EAAAA,IAoBW,WApBXoB,GAoBW,EAnBTpB,EAAAA,EAAAA,IAAgD,eAAA0E,EAAAA,EAAAA,IAArCpG,EAAApD,SAAS,kBAAD,IAEnB8E,EAAAA,EAAAA,IAOQ,eDWNqF,EAAAA,EAAAA,KCjBArF,EAAAA,EAAAA,IAIE,SDcA,sBAAuBsE,EAAO,KAAOA,EAAO,GAAM9D,GCjBzClC,EAAAiE,oBAAoBwM,aAAYvO,GACxCmF,SAAMrB,EAAA,KAAAA,EAAA,GDmBnB,IAAInI,ICnBiBmC,EAAAuE,sBAAAvE,EAAAuE,wBAAA1G,IACT4C,KAAK,YDoBJ,KAAM,KAAM,CACb,CAACiH,EAAAA,GCvBQ1H,EAAAiE,oBAAoBwM,iBDyB/BrJ,EAAAA,EAAAA,ICtBE,KACFhB,EAAAA,EAAAA,IAAGpG,EAAApD,SAAS,8BAAD,MAGb8E,EAAAA,EAAAA,IAOQ,eDcNqF,EAAAA,EAAAA,KCpBArF,EAAAA,EAAAA,IAIE,SDiBA,sBAAuBsE,EAAO,KAAOA,EAAO,GAAM9D,GCpBzClC,EAAAiE,oBAAoByM,qBAAoBxO,GAChDmF,SAAMrB,EAAA,KAAAA,EAAA,GDsBnB,IAAInI,ICtBiBmC,EAAAuE,sBAAAvE,EAAAuE,wBAAA1G,IACT4C,KAAK,YDuBJ,KAAM,KAAM,CACb,CAACiH,EAAAA,GC1BQ1H,EAAAiE,oBAAoByM,yBD4B/BtJ,EAAAA,EAAAA,ICzBE,KACFhB,EAAAA,EAAAA,IAAGpG,EAAApD,SAAS,+BAAD,QAIf8E,EAAAA,EAAAA,IAuCW,WAvCXqB,GAuCW,EAtCTrB,EAAAA,EAAAA,IAAiD,eAAA0E,EAAAA,EAAAA,IAAtCpG,EAAApD,SAAS,mBAAD,IAEnB8E,EAAAA,EAAAA,IAOQ,eDgBN0F,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,ICtBdpG,EAAApD,SAAS,gCAAiC,IAC7C,IDsBAmK,EAAAA,EAAAA,KCtBArF,EAAAA,EAAAA,IAIE,SDmBA,sBAAuBsE,EAAO,KAAOA,EAAO,GAAM9D,GCtBzClC,EAAAiE,oBAAoB1E,QAAQC,YAAW0C,GAC/C8E,QAAKhB,EAAA,KAAAA,EAAA,GAAA9D,GAAElC,EAAAuE,qBAAqB,uCAC7B9D,KAAK,QDuBJ,KAAM,KAAM,CACb,CAACyG,EAAAA,GC1BQlH,EAAAiE,oBAAoB1E,QAAQC,kBAMzCkC,EAAAA,EAAAA,IAUQ,SATL5B,OAAKC,EAAAA,EAAAA,IAAA,qBAAyBC,EAAAiE,oBAAoBwM,gBDwBlD,EACDrJ,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,ICvBdpG,EAAApD,SAAS,iCAAkC,IAC9C,IDuBAmK,EAAAA,EAAAA,KCvBArF,EAAAA,EAAAA,IAKE,SDmBA,sBAAuBsE,EAAO,KAAOA,EAAO,GAAM9D,GCvBzClC,EAAAiE,oBAAoB1E,QAAQE,YAAWyC,GAC/C8E,QAAKhB,EAAA,KAAAA,EAAA,GAAA9D,GAAElC,EAAAuE,qBAAqB,uCAC5BsM,UAAW7Q,EAAAiE,oBAAoBwM,aAChChQ,KAAK,QDwBJ,KAAM,GAAIuC,IAAc,CACzB,CAACkE,EAAAA,GC5BQlH,EAAAiE,oBAAoB1E,QAAQE,gBD8BtC,ICvBHiC,EAAAA,EAAAA,IAcQ,SAbL5B,OAAKC,EAAAA,EAAAA,IAAA,CDyBJ,oBCzByCC,EAAAiE,oBAAoByM,wBD2B9D,EACDtJ,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,ICxBdpG,EAAApD,SAAS,8BAA+B,IAC3C,IDwBAmK,EAAAA,EAAAA,KCxBArF,EAAAA,EAAAA,IAOE,SDkBA,sBAAuBsE,EAAO,MAAQA,EAAO,IAAO9D,GCxB3ClC,EAAAiE,oBAAoB1E,QAAQG,gBAAewC,GACnD8E,QAAKhB,EAAA,MAAAA,EAAA,IAAA9D,GAAiBlC,EAAAuE,qBAAoB,2CAG1CsM,UAAW7Q,EAAAiE,oBAAoByM,qBAChCjQ,KAAK,QDyBJ,KAAM,GAAIwC,IAAc,CACzB,CAACiE,EAAAA,GC/BQlH,EAAAiE,oBAAoB1E,QAAQG,oBDiCtC,MCvBL4G,EAAAA,EAAAA,IAKEo0C,EAAA,CAJC5xC,SAAU9I,EAAAiE,oBAAoB6E,SAC9B,iBAAgB9I,EAAAiE,oBAAoB1E,QAAQI,cAC5C,oBAAiBK,EAAA+Q,eACjB,yBAAuB/Q,EAAAgR,qBD0BvB,KAAM,EAAG,CAAC,WAAY,iBAAkB,oBAAqB,8BAGtE,CEjJA,MACMvP,GAAa,CCFThB,KAAK,SAASX,MAAM,uBDMxB6B,GAAa,CCLT7B,MAAM,gBDMVwC,GAAa,CCATxC,MAAM,gBDEV,SAAU0B,GAAOxB,EAAUgG,EAAY6B,EAAYC,EAAYC,EAAWC,GAC9E,MAAM4vC,GAA+B7nC,EAAAA,EAAAA,IAAkB,qBAEvD,OAAQ9J,EAAAA,EAAAA,OCZRrG,EAAAA,EAAAA,IAaS,SAbT6B,GAaS,EAZPC,EAAAA,EAAAA,IAKO,OALPC,GAKO,CAHG3B,EAAA46C,KAAKM,mBDYRj1C,EAAAA,EAAAA,OCbL0B,EAAAA,EAAAA,IAGEiwC,EAAA,CDWI51C,IAAK,ECZRtJ,QAASsH,EAAA46C,KAAKM,kBDcV,KAAM,EAAG,CAAC,cACbtzC,EAAAA,EAAAA,IAAoB,IAAI,MCZ9BlG,EAAAA,EAAAA,IAKO,OALPY,GAKO,CAHGtC,EAAA46C,KAAKS,gBDcRp1C,EAAAA,EAAAA,OCfL0B,EAAAA,EAAAA,IAGEiwC,EAAA,CDaI51C,IAAK,ECdRtJ,QAASsH,EAAA46C,KAAKS,eDgBV,KAAM,EAAG,CAAC,cACbzzC,EAAAA,EAAAA,IAAoB,IAAI,MAGlC,CCRA,QAAevH,EAAAA,EAAAA,IAAgB,CAC7B8B,KAAM,oBACN2P,WAAY,CAAEqmC,kBAAiBA,IAC/B53C,MAAO,CACLq6C,KAAM,CACJn6C,KAAMzE,OACN2E,UAAU,IAGdyI,QAAS,CACPxM,SAAQA,EAAAA,MC1BZ,MAAM,IAA2B,OAAgB,GAAQ,CAAC,CAAC,SAAS,IAAQ,CAAC,YAAY,qBAEzF,UCPA,MACM6E,GAAa,CCFP3B,MAAM,uBDGZ6B,GAAa,CACjBK,IAAK,ECaDlC,MAAM,gCDVNwC,GAAa,CCaNxC,MAAM,8BDZb4C,GAAa,CAAC,eACdC,GAAa,CACjBX,IAAK,ECoBWlC,MAAM,uBDjBlB8C,GAAa,CCqBNO,MAAA,0BDpBPN,GAAa,CAAC,SACdC,GAAa,CAAEd,IAAK,GACpBe,GAAa,CC8BNI,MAAA,0BD7BPH,GAAc,CAAC,SAEf,SAAUxB,GAAOxB,EAAUgG,EAAY6B,EAAYC,EAAYC,EAAWC,GAC9E,MAAM4vC,GAA+B7nC,EAAAA,EAAAA,IAAkB,qBACjDg1B,GAAwBh1B,EAAAA,EAAAA,IAAkB,cAEhD,OAAQ9J,EAAAA,EAAAA,OCvBRrG,EAAAA,EAAAA,IAwDW,WAxDX6B,GAwDW,EAvDTC,EAAAA,EAAAA,IAA4B,eAAA0E,EAAAA,EAAAA,IAAjBpG,EAAAQ,OAAK,GAekB,SAA1BR,EAAAw7C,kBAAkB/6C,ODUrBwF,EAAAA,EAAAA,OCXLrG,EAAAA,EAAAA,IA4BM,MA5BN+B,GA4BM,CAxBY3B,EAAAw7C,kBAAkB17B,UDSzB7Z,EAAAA,EAAAA,OCTTrG,EAAAA,EAAAA,IAUWgC,EAAAA,GAAA,CAAAI,IAAA,KATTN,EAAAA,EAAAA,IAEM,MAFNY,GAEM,EADJgE,EAAAA,EAAAA,IAAkDsxC,EAAA,CAA9Bl/C,QAASsH,EAAAw7C,mBAAiB,uBAEhD95C,EAAAA,EAAAA,IAKE,UAJAjB,KAAK,SACJwB,QAAK+D,EAAA,KAAAA,EAAA,GAAA9D,GAAElC,EAAAy7C,sBDUAhzC,aCTRrC,EAAAA,EAAAA,IAAiCpG,EAAApD,SAAhB,iBACjBkD,MAAM,2CDUG,KAAM,EAAG4C,KACX,OACFuD,EAAAA,EAAAA,OCTTrG,EAAAA,EAAAA,IAEM,MAFN+C,GAEM,EADJ2D,EAAAA,EAAAA,IAAqDy+B,EAAA,CAAxCxb,eAAavjB,EAAA,KAAAA,EAAA,GAAA9D,GAAElC,EAAAi4C,cAAc/1C,UAG5CR,EAAAA,EAAAA,IAQQ,QARRkB,GAQQ,EDGFwE,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,ICVlBpG,EAAApD,SAAS,qBAAsB,IAClC,IAAA8E,EAAAA,EAAAA,IAKE,SAJAjB,KAAK,OACJ5G,MAAOmG,EAAAw7C,kBAAkBz7B,QACzB/Y,QAAKhB,EAAA,KAAAA,EAAA,GAAA9D,GAAElC,EAAAg4C,eAAe91C,IACvBpC,MAAM,8BDWD,KAAM,GAAI+C,SCNqB,QAA1B7C,EAAAw7C,kBAAkB/6C,ODU3BwF,EAAAA,EAAAA,OCVPrG,EAAAA,EAAAA,IAUM,MAAAkD,GAAA,EATJpB,EAAAA,EAAAA,IAQQ,QARRqB,GAQQ,EDGAqE,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,ICVpBpG,EAAApD,SAAS,WAAY,IACxB,IAAA8E,EAAAA,EAAAA,IAKE,YAJAjB,KAAK,OACJ5G,MAAOmG,EAAAw7C,kBAAkB1P,QACzB9kC,QAAKhB,EAAA,KAAAA,EAAA,GAAA9D,GAAElC,EAAA07C,eAAex5C,IACvBpC,MAAM,8BDWC,KAAM,GAAIkD,UAGjB4E,EAAAA,EAAAA,IAAoB,IAAI,IAElC,CCIA,QAAevH,EAAAA,EAAAA,IAAgB,CAC7B8B,KAAM,oBACN2P,WAAY,CAAEwX,WAAU,GAAE6uB,kBAAiBA,IAC3C53C,MAAO,CACLC,MAAO,CACLC,KAAMC,OACNC,UAAU,GAEZ66C,kBAAmB,CACjB/6C,KAAMzE,OACN2E,UAAU,IAGd8Q,MAAO,CACLkqC,cAAAA,CAAezlB,GAIb,OAAO,CACT,GAEFp1B,IAAAA,GACE,MAAO,CAAC,CACV,EACAsI,QAAS,CACPxM,SAAQ,KACRg/C,oCAAAA,CACEn7C,GAEA,OAAQA,GACN,IAAK,QACH,MAAO,CACLjC,MAAMyG,EAAAA,EAAAA,KACNxE,KAAMA,EACNqf,QAAS,GACTC,QAAS,IAEb,IAAK,QACH,MAAO,CACLvhB,MAAMyG,EAAAA,EAAAA,KACNxE,KAAMA,EACNqf,QAAS,GACTC,QAAS,IAEb,IAAK,OACH,MAAO,CACLvhB,MAAMyG,EAAAA,EAAAA,KACNxE,KAAMA,EACNqrC,QAAS,IAEb,QACE,MAAM,IAAI7wC,OACR2B,EAAAA,EAAAA,IAAS,sCAAwC6D,GAGzD,EACAo7C,YAAAA,CAAar2C,GACX,MAAME,EAASF,EAAME,OACfo2C,EAAep2C,EAAO7L,MAC5BoH,KAAK4Q,MAAM,iBAAkB,CAC3BkqC,eAAgB96C,KAAK26C,qCAAqCE,IAE9D,EACAL,kBAAAA,GACEx6C,KAAK4Q,MAAM,iBAAkB,CAC3BkqC,eAAgB,IACV96C,KAAKu6C,kBACT17B,QAAS,KAGf,EACAm4B,aAAAA,CAAcl6B,GACZ,MAAMg+B,EAAiB,IAAK96C,KAAKu6C,kBAAmB17B,QAAS/B,EAAK3b,IAClEnB,KAAK4Q,MAAM,iBAAkB,CAAEkqC,kBACjC,EACA/D,cAAAA,CAAexyC,GACb,MAAME,EAASF,EAAME,OACfs2C,EAAat2C,EAAO7L,MACpBkiD,EAAiB,IAAK96C,KAAKu6C,kBAAmBz7B,QAASi8B,GAC7D/6C,KAAK4Q,MAAM,iBAAkB,CAC3BkqC,iBACAnhD,UAAW,CAAEqhD,MAAO,UAAWz9C,KAAMyC,KAAKu6C,kBAAkBh9C,OAEhE,EACAk9C,cAAAA,CAAel2C,GACb,MAAME,EAASF,EAAME,OACfw2C,EAAax2C,EAAO7L,MACpBkiD,EAAiB,IAAK96C,KAAKu6C,kBAAmB1P,QAASoQ,GAC7Dj7C,KAAK4Q,MAAM,iBAAkB,CAC3BkqC,iBACAnhD,UAAW,CAAEqhD,MAAO,UAAWz9C,KAAMyC,KAAKu6C,kBAAkBh9C,OAEhE,GAEF8C,SAAU,CAAC,IChKb,MAAM,IAA2B,OAAgB,GAAQ,CAAC,CAAC,SAAS,IAAQ,CAAC,YAAY,qBAEzF,UNwIA,IAAejB,EAAAA,EAAAA,IAAgB,CAC7B8B,KAAM,gBACNqB,KAAAA,GACE,MAAO,CACLE,YAAYpD,EAAAA,EAAAA,IAAwBnI,EAAAA,GAExC,EACA2Z,WAAY,CACVqqC,kBAAiB,GACjBC,kBAAiB,GACjBpqC,eAAcA,IAEhBzR,MAAO,CACL/F,eAAgB,CACdiG,KAAMzE,OACN2E,UAAU,IAGdG,IAAAA,GACE,MAAO,CACLmD,qBAAqBC,EAAAA,EAAAA,WAAUjD,KAAKzG,gBACpCqgD,mBAAoB,EAExB,EACA7/C,MAAO,CAELR,eAAgB,CACdwO,WAAW,EACXC,QAAS,WACPhI,KAAKgD,qBAAsBC,EAAAA,EAAAA,WAAUjD,KAAKzG,eAC5C,IAGJ69C,WAAAA,GACMp3C,KAAKzG,eAAemgD,MAAMpvC,OAAS,IACrCtK,KAAK45C,kBAAoB,EAE7B,EACAzxC,QAAS,CACPwW,YAAW,GAEXhjB,SAAQ,KAER8M,UAAAA,CAAWC,GACT,OACE5M,OAAOC,OAAO4M,WAAa,qBAAuBD,EAAW,MAEjE,EAEApF,oBAAAA,CAAqB3J,GAEnBqG,KAAKyC,WAAYhJ,YAAY,CAC3BC,mBAAmBuJ,EAAAA,EAAAA,WAAUjD,KAAKgD,qBAClCrJ,UAAWA,GAAa,CAAC,GAE7B,EAEAkgD,WAAAA,CAAYn2C,GACV1D,KAAK45C,kBAAoBl2C,CAC3B,EAEAo2C,cAAAA,GACE95C,KAAKgD,qBAAsBQ,EAAAA,EAAAA,IAAQxD,KAAKgD,qBAAsBS,IAC5DA,EAAMi2C,MAAMl4C,KAAK,CACfjE,MAAMyG,EAAAA,EAAAA,KACNi2C,iBAAkB,CAChB18C,MAAMyG,EAAAA,EAAAA,KACNxE,KAAM,QACNqf,QAAS,GACTC,QAAS,IAEXs7B,cAAe,CACb78C,MAAMyG,EAAAA,EAAAA,KACNxE,KAAM,QACNqf,QAAS,GACTC,QAAS,KAEX,IAGJ9e,KAAKsD,uBAGLtD,KAAK45C,kBAAoB55C,KAAKgD,oBAAoB02C,MAAMpvC,OAAS,CACnE,EAEAgwC,iBAAAA,CAAkB52C,GAChB1D,KAAKgD,qBAAsBQ,EAAAA,EAAAA,IAAQxD,KAAKgD,qBAAsBS,IAC5DA,EAAMi2C,MAAM71C,OAAOH,EAAO,EAAE,IAG9B1D,KAAKsD,uBAGyC,IAA1CtD,KAAKgD,oBAAoB02C,MAAMpvC,OACjCtK,KAAK45C,mBAAqB,EACjBl2C,GAAS1D,KAAK45C,oBACvB55C,KAAK45C,kBAAoBpvC,KAAKjE,IAAI,EAAGvG,KAAK45C,kBAAoB,GAElE,EAEAO,wBAAAA,CAAyBllB,GAIvBj1B,KAAKgD,qBAAsBQ,EAAAA,EAAAA,IAAQxD,KAAKgD,qBAAsBS,IAC5DA,EAAMi2C,MAAM15C,KAAK45C,mBAAmBK,iBAClChlB,EAAQ6lB,cAAc,IAG1B96C,KAAKsD,qBAAqB2xB,EAAQt7B,UACpC,EAEA0gD,qBAAAA,CAAsBplB,GAIpBj1B,KAAKgD,qBAAsBQ,EAAAA,EAAAA,IAAQxD,KAAKgD,qBAAsBS,IAC5DA,EAAMi2C,MAAM15C,KAAK45C,mBAAmBQ,cAClCnlB,EAAQ6lB,cAAc,IAG1B96C,KAAKsD,qBAAqB2xB,EAAQt7B,UACpC,EAEAmW,cAAAA,CAAeiC,GACb/R,KAAKyC,WAAYhJ,YAAY,CAC3BC,mBAAmB8J,EAAAA,EAAAA,IACjBxD,KAAKgD,qBACJgP,IACCA,EAAUnK,SAAWkK,CAAe,IAGxCpY,UAAW,2BAEf,EAEAoW,mBAAAA,CAAoBkC,GAClBjS,KAAKyC,WAAYhJ,YAAY,CAC3BC,mBAAmB8J,EAAAA,EAAAA,IACjBxD,KAAKgD,qBACJgP,IACCA,EAAU1T,QAAQI,cAAgBuT,CAAoB,IAG1DtY,UAAW,wCAEf,GAEF0G,SAAU,CACRqC,MAAOA,IAAM5G,OAAOC,OAAO6G,gBAAgBC,iBAE3Cm3C,YAAAA,GACE,OAAOh6C,KAAKgD,oBAAoB02C,MAAM15C,KAAK45C,kBAC7C,EAEAG,4BAAAA,GACE,MAAO,CACLqB,gBAAiB,OAAOp7C,KAAKyI,WAAW,UAE5C,KO1SJ,MAAM,IAA2B,OAAgB,GAAQ,CAAC,CAAC,SAAS,IAAQ,CAAC,YAAY,qBAEzF,UCPA,MACMjI,GAAa,CCFZ3B,MAAM,eDGP6B,GAAa,CCFV7B,MAAM,mBDGTwC,GAAa,CAAC,YAAa,cAAe,WAC1CI,GAAa,CC8BR5C,MAAM,wBD7BX6C,GAAa,CCwDV7C,MAAM,iCDvDT8C,GAAa,CCgER9C,MAAM,gBD/DX+C,GAAa,CAAC,eACdC,GAAa,CAAC,eACdC,GAAa,CAAC,eAEd,SAAUvB,GAAOxB,EAAUgG,EAAY6B,EAAYC,EAAYC,EAAWC,GAC9E,MAAM4vC,GAA+B7nC,EAAAA,EAAAA,IAAkB,qBACjDusC,GAAwCvsC,EAAAA,EAAAA,IAAkB,8BAC1DwD,GAA6BxD,EAAAA,EAAAA,IAAkB,mBAErD,OAAQ9J,EAAAA,EAAAA,OCjBRrG,EAAAA,EAAAA,IAiGM,MAjGN6B,GAiGM,EAhGJC,EAAAA,EAAAA,IA2DM,MA3DNC,GA2DM,EA1DJD,EAAAA,EAAAA,IA+BM,OA9BJ5B,MAAM,0BACN8D,UAAU,QACTuQ,WAAQnO,EAAA,KAAAA,EAAA,IAAAG,EAAAA,EAAAA,KAAT,QAAiB,cAChBkO,YAASrO,EAAA,KAAAA,EAAA,IAAAG,EAAAA,EAAAA,KAAV,QAAkB,cACjB8N,OAAIjO,EAAA,KAAAA,EAAA,GAAA9D,GAAElC,EAAAu8C,4BAA4Br6C,KDkBlC,GACA+D,EAAAA,EAAAA,KAAW,ICjBZrG,EAAAA,EAAAA,IAuBSgC,EAAAA,GAAA,MAAAC,EAAAA,EAAAA,IArBsB7B,EAAAw8C,mBAAtBC,KDgBCx2C,EAAAA,EAAAA,OClBVrG,EAAAA,EAAAA,IAuBS,UAtBPa,KAAK,SAEJuB,IAAKy6C,EACL74C,WAAyB5D,EAAA08C,uBAAuBD,KAAwBz8C,EAAA6U,YAGxEd,YAAS7R,GAAElC,EAAA28C,iBAAiBz6C,EAAQu6C,GACpCG,UAAO52C,EAAA,KAAAA,EAAA,GAAA9D,GAAElC,EAAA68C,kBACT56C,QAAKC,GAAElC,EAAA88C,wBAAwBL,GAChC38C,OAAKC,EAAAA,EAAAA,IAAA,CAAC,mBAAkB,CDkBtB8Q,SCjB4C7Q,EAAA08C,uBAAuBD,IAAqCz8C,EAAA+8C,mBAAqBN,EDoB7HO,UCpBwKh9C,EAAA6U,YDqBxKzX,SCrB2M4C,EAAAi9C,0BAA4BR,MDuBtO,ECfHn2C,EAAAA,EAAAA,IAGEsxC,EAAA,CAFCl/C,QAASsH,EAAA8iB,eAAe25B,GDiBvBxjC,SAAS,EChBXjV,IAAI,mBDkBD,KAAM,EAAG,CAAC,aACZ,GAAI1B,OACL,OACH,KChBHZ,EAAAA,EAAAA,IAwBM,MAxBNgB,GAwBM,GDNHuD,EAAAA,EAAAA,KAAW,ICjBZrG,EAAAA,EAAAA,IAsBEgC,EAAAA,GAAA,MAAAC,EAAAA,EAAAA,IArBe7B,EAAAqK,KAAKswC,OAAbC,KDiBC30C,EAAAA,EAAAA,OClBV0B,EAAAA,EAAAA,IAsBE20C,EAAA,CApBCx8C,OAAKC,EAAAA,EAAAA,IAAA,CDkBJm9C,UClB6Cl9C,EAAAm9C,2BAA2BjhD,eAAgC0+C,EAAKS,cAAc78C,QAAuCwB,EAAA+8C,kBAAoB/8C,EAAAi9C,2BAOvL,kBAA8Bj9C,EAAAo9C,4BAA4BxC,EAAKS,cAAc78C,MAG7E,eAAcwB,EAAA8iB,eAAe83B,EAAKS,cAAc78C,MAChD6+C,UAAWr9C,EAAAiW,gBAAgB2kC,EAAKS,cAAc78C,MAC9C8+C,WAAYt9C,EAAA6U,YACZ7S,IAAK44C,EAAKp8C,KACVyV,OAAI/R,GAAElC,EAAAu9C,sBAAsBr7C,EAAQ04C,EAAKS,cAAc78C,MACvDuV,YAAS7R,GAAElC,EAAAw9C,uBAAuBt7C,EAAQ04C,EAAKS,cAAc78C,MAC7Do+C,UAAO52C,EAAA,KAAAA,EAAA,GAAA9D,GAAElC,EAAAy9C,wBACTtpC,WAAQnO,EAAA,KAAAA,EAAA,IAAAG,EAAAA,EAAAA,KAAT,QAAiB,cAChBkO,YAASrO,EAAA,KAAAA,EAAA,IAAAG,EAAAA,EAAAA,KAAV,QAAkB,cACjBlE,QAAKC,GAAElC,EAAA09C,qBAAqB9C,EAAKS,cAAc78C,ODkB7C,KAAM,EAAG,CAAC,QAAS,kBAAmB,eAAgB,YAAa,aAAc,SAAU,cAAe,eAC3G,WCdRkD,EAAAA,EAAAA,IAkCM,MAlCNiB,GAkCM,CAhCI3C,EAAA6U,cDiBH5O,EAAAA,EAAAA,OClBL0B,EAAAA,EAAAA,IAME4L,EAAA,CDaIvR,IAAK,ECjBR2G,eAAgB3I,EAAA8U,eAChBjM,UAAW7I,EAAA6I,UACXlJ,cAAeK,EAAAL,cACfmJ,SAAU9I,EAAAqK,KAAKvB,UDmBX,KAAM,EAAG,CAAC,iBAAkB,YAAa,gBAAiB,eAC7DlB,EAAAA,EAAAA,IAAoB,IAAI,ICjB5BlG,EAAAA,EAAAA,IAwBM,MAxBNkB,GAwBM,CAtBI5C,EAAA+L,kBDkBH9F,EAAAA,EAAAA,OCnBLrG,EAAAA,EAAAA,IAME,UDcIoC,IAAK,EACLyG,aCnBJrC,EAAAA,EAAAA,IAAiCpG,EAAAqK,KAApB9K,QAAQC,aACpByC,QAAK+D,EAAA,KAAAA,EAAA,GAAA9D,GAAElC,EAAAmM,gBACR1L,KAAK,SACLX,MAAM,iBDoBD,KAAM,EAAG+C,MACZ+E,EAAAA,EAAAA,IAAoB,IAAI,GCjBpB5H,EAAAgV,sBDmBH/O,EAAAA,EAAAA,OCpBLrG,EAAAA,EAAAA,IAME,UDeIoC,IAAK,EACLyG,aCpBJrC,EAAAA,EAAAA,IAAqCpG,EAAAqK,KAAxB9K,QAAQG,iBACpBuC,QAAK+D,EAAA,KAAAA,EAAA,GAAA9D,GAAElC,EAAAqZ,uBACR5Y,KAAK,SACLX,MAAM,iBDqBD,KAAM,EAAGgD,MACZ8E,EAAAA,EAAAA,IAAoB,IAAI,GClBpB5H,EAAAkV,kBDoBHjP,EAAAA,EAAAA,OCrBLrG,EAAAA,EAAAA,IAME,UDgBIoC,IAAK,EACLyG,aCrBJrC,EAAAA,EAAAA,IAAiCpG,EAAAqK,KAApB9K,QAAQE,aACpBwC,QAAK+D,EAAA,KAAAA,EAAA,GAAA9D,GAAElC,EAAAsZ,mBACR7Y,KAAK,SACLX,MAAM,iBDsBD,KAAM,EAAGiD,MACZ6E,EAAAA,EAAAA,IAAoB,IAAI,QAIpC,CEvHA,MACMnG,GAAa,CCUR3B,MAAM,wBDTX6B,GAAa,CAAC,aAEd,SAAUH,GAAOxB,EAAUgG,EAAY6B,EAAYC,EAAYC,EAAWC,GAC9E,MAAM4vC,GAA+B7nC,EAAAA,EAAAA,IAAkB,qBAEvD,OAAQ9J,EAAAA,EAAAA,OCRRrG,EAAAA,EAAAA,IAoCS,UAnCPa,KAAK,SACLX,OAAKC,EAAAA,EAAAA,IAAA,CAAC,cAAa,CDSjB,eAAgBkB,KCRmB08C,eDSnC,aAAc18C,KCT8D08C,eDU5Er9B,QAASrf,KCVuGo8C,UDWhHpzB,WAAYhpB,KCXsIo8C,UDYlJC,WAAYr8C,KCZwKq8C,eDcrL,CACAr8C,KCPoB08C,iBDQhB13C,EAAAA,EAAAA,OCRLrG,EAAAA,EAAAA,IAuBWgC,EAAAA,GAAA,CAAAI,IAAA,KAtBTN,EAAAA,EAAAA,IAUM,MAVND,GAUM,EATJ6E,EAAAA,EAAAA,IAQEsxC,EAAA,CAPCl/C,QAASsH,EAAA49C,YACV99C,OAAKC,EAAAA,EAAAA,IAAA,CAAC,QAAO,CDSXugB,QAASrf,KCRyBo8C,UDSlCpzB,WAAYhpB,KCT8Do8C,UDU1EC,WAAYr8C,KCVsGq8C,eDY/G,KAAM,EAAG,CAAC,UAAW,aCL9B57C,EAAAA,EAAAA,IAUM,OAVD5B,MAAM,wBAAyB8D,WAAS,KAAQ05C,YDU9C,ECTLh3C,EAAAA,EAAAA,IAQEsxC,EAAA,CAPCl/C,QAASsH,EAAA29C,eACV79C,OAAKC,EAAAA,EAAAA,IAAA,CAAC,QAAO,CDWXugB,QAASrf,KCVyBo8C,UDWlCpzB,WAAYhpB,KCX8Do8C,UDY1EC,WAAYr8C,KCZsGq8C,eDc/G,KAAM,EAAG,CAAC,UAAW,WACvB,EAAG37C,KACL,OACFsE,EAAAA,EAAAA,OCTL0B,EAAAA,EAAAA,IAAmDiwC,EAAA,CDU7C51C,IAAK,ECVgBtJ,QAASsH,EAAA49C,aDY7B,KAAM,EAAG,CAAC,cAChB,EACL,CCJA,QAAev9C,EAAAA,EAAAA,IAAgB,CAC7B8B,KAAM,cACN2P,WAAY,CAAEqmC,kBAAiBA,IAC/B53C,MAAO,CACLo9C,eAAgB,CACdl9C,KAAMzE,OACN2E,UAAU,GAEZi9C,YAAa,CACXn9C,KAAMzE,OACN2E,UAAU,GAEZ08C,UAAW,CACT58C,KAAM+mC,QACN7mC,UAAU,GAEZ28C,WAAY,CACV78C,KAAM+mC,QACN7mC,UAAU,IAGdW,SAAU,CAAC,EACX8H,QAAS,CAAEwW,YAAWA,MC7DxB,MAAM,IAA2B,OAAgB,GAAQ,CAAC,CAAC,SAAS,IAAQ,CAAC,YAAY,qBAEzF,UHyGA,IAAevf,EAAAA,EAAAA,IAAgB,CAC7B8B,KAAM,gBACN2P,WAAY,CACVqmC,kBAAiB,GACjB0F,2BAA0B,GAC1BjuC,gBAAeA,IAEjBrP,MAAO,CACL8J,KAAM,CACJ5J,KAAMzE,OACN2E,UAAU,IAGd8Q,MAAO,CAAC,iBACR3Q,IAAAA,GACE,MAAO,CACLm8C,6BAAyB1gD,EACzBwgD,sBAAkBxgD,EAIlB4gD,2BAA4B,CAAC,EAC7BtoC,aAAa,EACbjK,eAAe,EACfkzC,cAAe,KAEnB,EACA10C,QAAS,CACPwW,YAAW,GAEX3J,eAAAA,CAAgB8nC,GACd,MAAM5zB,EAAYlpB,KAAKk8C,2BAA2BY,GAClD,IAAK5zB,EACH,OAAO,EAST,MAAMywB,EAAO35C,KAAKoJ,KAAKswC,MAAMz9C,MAC1B09C,GAASA,EAAKS,cAAc78C,OAASu/C,IAExC,IAAKnD,EACH,MAAM,IAAI3/C,MACR,kDACE8iD,EACA,YAGN,OAAOnD,EAAKM,iBAAiB18C,OAAS2rB,CACxC,EAEAizB,2BAAAA,CACEW,GAEA,MAAMhB,EAAmB97C,KAAKk8C,2BAA2BY,GACzD,OAAIhB,EACK97C,KAAK6hB,eAAei6B,QAE3B,CAEJ,EAEAJ,gBAAAA,CAAiBlmC,EAAsBD,GAYhCvV,KAAKy7C,uBAAuBlmC,KAC/B3b,QAAQC,IAAI,oBAAqB0b,GACjCvV,KAAKg8C,wBAA0BzmC,EAC/BvV,KAAK87C,iBAAmBvmC,EAExBC,EAAUE,aAAcC,WAAa,OACrCH,EAAUE,aAAcE,cAAgB,OAE5C,EAEAgmC,cAAAA,GACE57C,KAAKg8C,6BAA0B1gD,EAC/B0E,KAAK87C,sBAAmBxgD,CAC1B,EAEAihD,sBAAAA,CAAuB/mC,EAAsBunC,GAC3CvnC,EAAUE,aAAcC,WAAa,OACrCH,EAAUE,aAAcE,cAAgB,OAGxCJ,EAAUE,aAAcsnC,QAAQ,WAAYD,GAG5C,MAAME,EACJj9C,KAAKk8C,2BAA2Ba,GAC9BE,IACFj9C,KAAKg8C,wBAA0BiB,EAE/BrjD,QAAQC,IACN,oBACAmG,KAAKg8C,wBACL,sBACAe,GAGN,EAEAP,oBAAAA,GACEx8C,KAAKg8C,6BAA0B1gD,EAC/B0E,KAAK87C,sBAAmBxgD,CAC1B,EAEAghD,qBAAAA,CAAsB/3C,EAAkBw4C,GACtC,IAAK/8C,KAAKg8C,wBACR,OAKF,MAAMkB,EAAgB34C,EAAMmR,cAAcynC,QAAQ,YAC9CD,UACKl9C,KAAKk8C,2BAA2BgB,GAGzCl9C,KAAKk8C,2BAA2Ba,GAC9B/8C,KAAKg8C,wBAEPpiD,QAAQC,IACN,mBACAmG,KAAKg8C,wBACL,aACAe,GAGF/8C,KAAKg8C,6BAA0B1gD,EAC/B0E,KAAK87C,sBAAmBxgD,CAC1B,EAEAumB,cAAAA,CAAetM,GACb,MAAM9d,EAAUuI,KAAKo9C,aAAa7nC,GAClC,IAAK9d,EACH,MAAM,IAAIuC,MAAM,uCAAyCub,GAE3D,OAAO9d,CACT,EAEAglD,oBAAAA,CAAqBM,GAInB,GAHAnjD,QAAQC,IAAI,4BAA6BkjD,GAGrC/8C,KAAK4T,YAAa,OAItB,MAAMypC,EAAgBr9C,KAAKk8C,2BAA2Ba,GAClDM,UACKr9C,KAAKk8C,2BAA2Ba,GAGrC/8C,KAAKg8C,0BACPh8C,KAAKk8C,2BAA2Ba,GAC9B/8C,KAAKg8C,wBACPh8C,KAAKg8C,6BAA0B1gD,EAEnC,EAMAmgD,sBAAAA,CAAuBD,GACrB,OAAOzgD,OAAOc,OAAOmE,KAAKk8C,4BAA4B5uC,SACpDkuC,EAEJ,EAEAK,uBAAAA,CAAwBtmC,GACjBvV,KAAKy7C,uBAAuBlmC,IAAevV,KAAK4T,cACnDha,QAAQC,IAAI,sBAAuB0b,GACnCvV,KAAKg8C,wBAA0BzmC,EAEnC,EAEA+lC,2BAAAA,CAA4B/2C,GAC1B,IAAKvE,KAAKg8C,wBACR,OAKF,MAAMkB,EAAgB34C,EAAMmR,cAAcynC,QAAQ,YAC9CD,UACKl9C,KAAKk8C,2BAA2BgB,GAGzCtjD,QAAQC,IAAI,oBAAqBmG,KAAKg8C,yBAGtCh8C,KAAKg8C,6BAA0B1gD,CACjC,EAEA4P,YAAAA,GACElL,KAAK4T,aAAc,EACnB5T,KAAK68C,cAAgB78C,KAAK6T,cAC5B,EAEAuE,mBAAAA,GACEpY,KAAK2J,eAAgB,EAGrB3J,KAAKoJ,KAAKswC,MAAM/hD,SAASgiD,IACvB35C,KAAKk8C,2BAA2BvC,EAAKS,cAAc78C,MACjDo8C,EAAKM,iBAAiB18C,IAAI,GAEhC,EAEA8a,eAAAA,GACErY,KAAK4T,aAAc,EACnB5T,KAAK2J,eAAgB,EACrB3J,KAAKk8C,2BAA6B,CAAC,EACnCl8C,KAAK68C,cAAgB,IACvB,GAEFx8C,SAAU,CACRk7C,iBAAAA,GAGE,OAAOv7C,KAAKoJ,KAAKswC,MACd7wC,KAAK8wC,IAAI,CAAQA,KAAMA,EAAM7wC,KAAM0B,KAAKoM,aACxC9N,MAAK,CAACw0C,EAAOC,IAAUD,EAAMx0C,KAAOy0C,EAAMz0C,OAC1CD,KAAI,EAAG8wC,UAAWA,EAAKM,iBAAiB18C,MAC7C,EAEA6/C,YAAAA,GACE,MAAMA,EAA0D,CAAC,EACjE,IAAK,MAAMzD,KAAQ35C,KAAKoJ,KAAKswC,MAC3B0D,EAAazD,EAAKM,iBAAiB18C,MAAQo8C,EAAKM,iBAChDmD,EAAazD,EAAKS,cAAc78C,MAAQo8C,EAAKS,cAE/C,OAAOgD,CACT,EAEAvpC,cAAAA,GAEE,GAAI7T,KAAK2J,eAAwC,OAAvB3J,KAAK68C,cAC7B,OAAO78C,KAAK68C,cAGd,IAAIhpC,EAAiB,EACrB,IAAK,MAAM8lC,KAAQ35C,KAAKoJ,KAAKswC,MACvB15C,KAAKgV,gBAAgB2kC,EAAKS,cAAc78C,OAAOsW,IAErD,OAAOA,CACT,EAEAjM,SAAAA,GACE,OAAO5H,KAAKoJ,KAAKswC,MAAMpvC,MACzB,EAEA5L,aAAAA,GACE,IAAIA,EAAgBsB,KAAKoJ,KAAK9K,QAAQI,cAAcwB,QAClD,WACAF,KAAK6T,eAAehb,YAQtB,OALA6F,EAAgBA,EAAcwB,QAC5B,SACAF,KAAK4H,UAAU/O,YAGV6F,CACT,EAEAoM,eAAAA,GACE,OAAQ9K,KAAK4T,WACf,EAEAK,eAAAA,GACE,OACEjU,KAAKoJ,KAAKoG,cAAgBxP,KAAK4T,cAAgB5T,KAAKkX,oBAExD,EAEAnD,mBAAAA,GACE,OACE/T,KAAKoJ,KAAKqG,sBACVzP,KAAK4T,cACJ5T,KAAK2J,gBACL3J,KAAKkX,oBAEV,EAEAA,oBAAAA,GACE,OAAOlX,KAAK6T,iBAAmB7T,KAAK4H,SACtC,KIzZJ,MAAM,IAA2B,OAAgB,GAAQ,CAAC,CAAC,SAAS,IAAQ,CAAC,YAAY,qBAEzF,UCPA,MACMpH,GAAa,CCFZ3B,MAAM,eDGP6B,GAAa,CCFT7B,MAAM,WDGVwC,GAAa,CCgBDxC,MAAM,gBDflB4C,GAAa,CAAC,QAAS,aAAc,WACrCC,GAAa,CAAC,OACdC,GAAa,CC0BJ9C,MAAM,cDzBf+C,GAAa,CAAC,UAAW,WACzBC,GAAa,CAAC,sBAAuB,WACrCC,GAAa,CCqCCjD,MAAM,kCDpCpBkD,GAAc,CAAC,sBAAuB,WACtCC,GAAc,CAAC,sBAAuB,WACtCC,GAAc,CAAC,sBAAuB,WACtC2M,GAAc,CCsFJ/P,MAAM,yBDrFhBqT,GAAc,CC6HJrT,MAAM,yBD5HhBsT,GAAc,CAAC,YACfC,GAAc,CAAC,YAEf,SAAU7R,GAAOxB,EAAUgG,EAAY6B,EAAYC,EAAYC,EAAWC,GAC9E,MAAM8H,GAA4BC,EAAAA,EAAAA,IAAkB,kBAC9CC,GAA6BD,EAAAA,EAAAA,IAAkB,mBAErD,OAAQ9J,EAAAA,EAAAA,OCvBRrG,EAAAA,EAAAA,IA4LM,MA5LN6B,GA4LM,EA3LJC,EAAAA,EAAAA,IA0LO,OA1LPC,GA0LO,EAzLLD,EAAAA,EAAAA,IAgGW,kBA/FTA,EAAAA,EAAAA,IAA2C,eAAA0E,EAAAA,EAAAA,IAAhCpG,EAAApD,SAAS,aAAD,IAEnB8E,EAAAA,EAAAA,IAQQ,eAPN4E,EAAAA,EAAAA,IAMEwJ,EAAA,CALCpJ,WAAY1G,EAAAxF,eAAeikD,SAC3B,sBAAmBz+C,EAAA0+C,eACpB,uBACA,2BACA,yBDuBC,KAAM,EAAG,CAAC,aAAc,4BAE5Bz4C,EAAAA,EAAAA,KAAW,ICrBZrG,EAAAA,EAAAA,IA8EWgC,EAAAA,GAAA,MAAAC,EAAAA,EAAAA,IA7Ea7B,EAAAiE,oBAAoBiT,SAAO,CAAzC5B,EAAQxI,MDqBR7G,EAAAA,EAAAA,OCtBVrG,EAAAA,EAAAA,IA8EW,YA5ERoC,IAAKsT,EAAO9W,KACbsB,MAAM,gCDsBH,ECpBH4B,EAAAA,EAAAA,IAWS,SAXTY,GAWS,EDWL8E,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,ICrBhBkP,EAAO5B,MAAO,IACjB,IAAAhS,EAAAA,EAAAA,IAQS,UAPNlB,MAAOR,EAAApD,SAAS,mBAChB,aAAYoD,EAAApD,SAAS,mBACrBqF,QAAKC,GAAElC,EAAA2+C,aAAa7xC,GACrBrM,KAAK,SACLX,MAAM,oBDsBH,ECpBH4B,EAAAA,EAAAA,IAAyC,OAAnC0G,IAAKpI,EAAA0J,WAAW,SAAUlB,IAAI,IDwB/B,KAAM,EAAG7F,KACX,EAAGD,OCrBVhB,EAAAA,EAAAA,IAYM,MAZNkB,GAYM,EAXJlB,EAAAA,EAAAA,IAIE,SAHC2e,QAASrgB,EAAAxF,eAAe0c,QAAQpK,GAAGwT,QACnCtZ,QAAK9E,GAAElC,EAAA4+C,qBAAqB18C,EAAQ4K,GACrCrM,KAAK,YDwBF,KAAM,GAAIoC,KACbkE,EAAAA,EAAAA,KCtBFrF,EAAAA,EAAAA,IAIE,SDmBE,sBAAwBQ,GCtBjBlC,EAAAiE,oBAAoBiT,QAAQpK,GAAG4G,KAAIxR,EAC3C8E,QAAK9E,GAAElC,EAAAuE,qBAAqB,0BAA0BuI,WACvDrM,KAAK,QDuBF,KAAM,GAAIqC,IAAa,CACxB,CAACoE,EAAAA,GC1BMlH,EAAAiE,oBAAoBiT,QAAQpK,GAAG4G,WAM5ChS,EAAAA,EAAAA,IA6CW,WA7CXqB,GA6CW,EA5CTrB,EAAAA,EAAAA,IAAuD,eAAA0E,EAAAA,EAAAA,IAA5CpG,EAAApD,SAAS,yBAAD,IAEnB8E,EAAAA,EAAAA,IAWQ,eAVNA,EAAAA,EAAAA,IAAuC,aAAA0E,EAAAA,EAAAA,IAA9BpG,EAAApD,SAAS,aAAD,IDuBfmK,EAAAA,EAAAA,KCtBFrF,EAAAA,EAAAA,IAQE,SDeE,sBAAwBQ,GCtBjBlC,EAAAiE,oBAAoBiT,QAAQpK,GAAGvN,QAAQb,KAAIwD,EACnD8E,QAAK9E,GAAqBlC,EAAAuE,qBDwBvB,0BCxB2FuI,mBAK/FrM,KAAK,QDuBF,KAAM,GAAIuC,IAAc,CACzB,CAACkE,EAAAA,GC9BMlH,EAAAiE,oBAAoBiT,QAAQpK,GAAGvN,QAAQb,WAUpDgD,EAAAA,EAAAA,IAaQ,eAZNA,EAAAA,EAAAA,IAAyD,aAAA0E,EAAAA,EAAAA,IAAhDpG,EAAApD,SAAS,+BAAD,IDwBfmK,EAAAA,EAAAA,KCvBFrF,EAAAA,EAAAA,IAUE,SDcE,sBAAwBQ,GCvBElC,EAAAiE,oBAAoBiT,QAAQpK,GAAGvN,QAAQs/C,iBDyB/D38C,ECtBH8E,QAAK9E,GAAqBlC,EAAAuE,qBDyBvB,0BCzB2FuI,+BAK/FrM,KAAK,QDwBF,KAAM,GAAIwC,IAAc,CACzB,CAACiE,EAAAA,GCjCyBlH,EAAAiE,oBAAoBiT,QAAQpK,GAAGvN,QAAQs/C,uBAYvEn9C,EAAAA,EAAAA,IAaQ,eAZNA,EAAAA,EAAAA,IAA+D,aAAA0E,EAAAA,EAAAA,IAAtDpG,EAAApD,SAAS,qCAAD,ID2BfmK,EAAAA,EAAAA,KC1BFrF,EAAAA,EAAAA,IAUE,SDiBE,sBAAwBQ,GC1BElC,EAAAiE,oBAAoBiT,QAAQpK,GAAGvN,QAAQu/C,oBD4B/D58C,ECzBH8E,QAAK9E,GAAqBlC,EAAAuE,qBD4BvB,0BC5B2FuI,kCAK/FrM,KAAK,QD2BF,KAAM,GAAIyC,IAAc,CACzB,CAACgE,EAAAA,GCpCyBlH,EAAAiE,oBAAoBiT,QAAQpK,GAAGvN,QAAQu/C,gCD2CvE,OC7BJp9C,EAAAA,EAAAA,IAES,UAFAO,QAAK+D,EAAA,KAAAA,EAAA,GDiCtB,IAAInI,ICjCoBmC,EAAA++C,WAAA/+C,EAAA++C,aAAAlhD,IAAW4C,KAAK,SAASX,MAAM,WDoC5CsG,EAAAA,EAAAA,ICnCEpG,EAAApD,SAAS,iBAAD,MAIf8E,EAAAA,EAAAA,IAsCW,WAtCXmO,GAsCW,EArCTnO,EAAAA,EAAAA,IAAgD,eAAA0E,EAAAA,EAAAA,IAArCpG,EAAApD,SAAS,kBAAD,IAEnB8E,EAAAA,EAAAA,IAOQ,eD0BNqF,EAAAA,EAAAA,KChCArF,EAAAA,EAAAA,IAIE,SD6BA,sBAAuBsE,EAAO,KAAOA,EAAO,GAAM9D,GChCzClC,EAAAiE,oBAAoB+6C,kBAAiB98C,GAC7CmF,SAAMrB,EAAA,KAAAA,EAAA,GDkCnB,IAAInI,IClCiBmC,EAAAuE,sBAAAvE,EAAAuE,wBAAA1G,IACT4C,KAAK,YDmCJ,KAAM,KAAM,CACb,CAACiH,EAAAA,GCtCQ1H,EAAAiE,oBAAoB+6C,sBDwC/B53C,EAAAA,EAAAA,ICrCE,KACFhB,EAAAA,EAAAA,IAAGpG,EAAApD,SAAS,6BAAD,MAGb8E,EAAAA,EAAAA,IAOQ,eD6BNqF,EAAAA,EAAAA,KCnCArF,EAAAA,EAAAA,IAIE,SDgCA,sBAAuBsE,EAAO,KAAOA,EAAO,GAAM9D,GCnCzClC,EAAAiE,oBAAoBg7C,YAAW/8C,GACvCmF,SAAMrB,EAAA,KAAAA,EAAA,GDqCnB,IAAInI,ICrCiBmC,EAAAuE,sBAAAvE,EAAAuE,wBAAA1G,IACT4C,KAAK,YDsCJ,KAAM,KAAM,CACb,CAACiH,EAAAA,GCzCQ1H,EAAAiE,oBAAoBg7C,gBD2C/B73C,EAAAA,EAAAA,ICxCE,KACFhB,EAAAA,EAAAA,IAAGpG,EAAApD,SAAS,iDAAD,MAGb8E,EAAAA,EAAAA,IAOQ,eDgCNqF,EAAAA,EAAAA,KCtCArF,EAAAA,EAAAA,IAIE,SDmCA,sBAAuBsE,EAAO,KAAOA,EAAO,GAAM9D,GCtCzClC,EAAAiE,oBAAoBwM,aAAYvO,GACxCmF,SAAMrB,EAAA,KAAAA,EAAA,GDwCnB,IAAInI,ICxCiBmC,EAAAuE,sBAAAvE,EAAAuE,wBAAA1G,IACT4C,KAAK,YDyCJ,KAAM,KAAM,CACb,CAACiH,EAAAA,GC5CQ1H,EAAAiE,oBAAoBwM,iBD8C/BrJ,EAAAA,EAAAA,IC3CE,KACFhB,EAAAA,EAAAA,IAAGpG,EAAApD,SAAS,8BAAD,MAGb8E,EAAAA,EAAAA,IAOQ,eDmCNqF,EAAAA,EAAAA,KCzCArF,EAAAA,EAAAA,IAIE,SDsCA,sBAAuBsE,EAAO,KAAOA,EAAO,GAAM9D,GCzCzClC,EAAAiE,oBAAoByM,qBAAoBxO,GAChDmF,SAAMrB,EAAA,KAAAA,EAAA,GD2CnB,IAAInI,IC3CiBmC,EAAAuE,sBAAAvE,EAAAuE,wBAAA1G,IACT4C,KAAK,YD4CJ,KAAM,KAAM,CACb,CAACiH,EAAAA,GC/CQ1H,EAAAiE,oBAAoByM,yBDiD/BtJ,EAAAA,EAAAA,IC9CE,KACFhB,EAAAA,EAAAA,IAAGpG,EAAApD,SAAS,+BAAD,QAIf8E,EAAAA,EAAAA,IAuCW,WAvCXyR,GAuCW,EAtCTzR,EAAAA,EAAAA,IAAiD,eAAA0E,EAAAA,EAAAA,IAAtCpG,EAAApD,SAAS,mBAAD,IAEnB8E,EAAAA,EAAAA,IAOQ,eDqCN0F,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,IC3CdpG,EAAApD,SAAS,gCAAiC,IAC7C,ID2CAmK,EAAAA,EAAAA,KC3CArF,EAAAA,EAAAA,IAIE,SDwCA,sBAAuBsE,EAAO,KAAOA,EAAO,GAAM9D,GC3CzClC,EAAAiE,oBAAoB1E,QAAQC,YAAW0C,GAC/C8E,QAAKhB,EAAA,MAAAA,EAAA,IAAA9D,GAAElC,EAAAuE,qBAAqB,uCAC7B9D,KAAK,QD4CJ,KAAM,KAAM,CACb,CAACyG,EAAAA,GC/CQlH,EAAAiE,oBAAoB1E,QAAQC,kBAMzCkC,EAAAA,EAAAA,IAUQ,SATL5B,OAAKC,EAAAA,EAAAA,IAAA,qBAAyBC,EAAAiE,oBAAoBwM,gBD6ClD,EACDrJ,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,IC5CdpG,EAAApD,SAAS,iCAAkC,IAC9C,ID4CAmK,EAAAA,EAAAA,KC5CArF,EAAAA,EAAAA,IAKE,SDwCA,sBAAuBsE,EAAO,MAAQA,EAAO,IAAO9D,GC5C3ClC,EAAAiE,oBAAoB1E,QAAQE,YAAWyC,GAC/C8E,QAAKhB,EAAA,MAAAA,EAAA,IAAA9D,GAAElC,EAAAuE,qBAAqB,uCAC5BsM,UAAW7Q,EAAAiE,oBAAoBwM,aAChChQ,KAAK,QD6CJ,KAAM,GAAI2S,IAAc,CACzB,CAAClM,EAAAA,GCjDQlH,EAAAiE,oBAAoB1E,QAAQE,gBDmDtC,IC5CHiC,EAAAA,EAAAA,IAcQ,SAbL5B,OAAKC,EAAAA,EAAAA,IAAA,CD8CJ,oBC9CyCC,EAAAiE,oBAAoByM,wBDgD9D,EACDtJ,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,IC7CdpG,EAAApD,SAAS,8BAA+B,IAC3C,ID6CAmK,EAAAA,EAAAA,KC7CArF,EAAAA,EAAAA,IAOE,SDuCA,sBAAuBsE,EAAO,MAAQA,EAAO,IAAO9D,GC7C3ClC,EAAAiE,oBAAoB1E,QAAQG,gBAAewC,GACnD8E,QAAKhB,EAAA,MAAAA,EAAA,IAAA9D,GAAiBlC,EAAAuE,qBAAoB,2CAG1CsM,UAAW7Q,EAAAiE,oBAAoByM,qBAChCjQ,KAAK,QD8CJ,KAAM,GAAI4S,IAAc,CACzB,CAACnM,EAAAA,GCpDQlH,EAAAiE,oBAAoB1E,QAAQG,oBDsDtC,MC5CL4G,EAAAA,EAAAA,IAKE0J,EAAA,CAJClH,SAAU9I,EAAAiE,oBAAoB6E,SAC9B,iBAAgB9I,EAAAiE,oBAAoB1E,QAAQI,cAC5C,oBAAiBK,EAAA+Q,eACjB,yBAAuB/Q,EAAAgR,qBD+CvB,KAAM,EAAG,CAAC,WAAY,iBAAkB,oBAAqB,8BAGtE,CC7BA,QAAe3Q,EAAAA,EAAAA,IAAgB,CAC7B8B,KAAM,iBACNqB,KAAAA,GACE,MAAO,CACLE,YAAYpD,EAAAA,EAAAA,IAAwBnI,EAAAA,GAExC,EACA2Z,WAAY,CAAEE,eAAc,GAAED,cAAaA,GAAAA,GAC3CxR,MAAO,CACL/F,eAAgB,CACdiG,KAAMzE,OACN2E,UAAU,IAGdG,IAAAA,GACE,MAAO,CAQLmD,qBAAqBC,EAAAA,EAAAA,WAAUjD,KAAKzG,gBAExC,EACAQ,MAAO,CAELR,eAAgB,CACdwO,WAAW,EACXC,QAAS,WACPhI,KAAKgD,qBAAsBC,EAAAA,EAAAA,WAAUjD,KAAKzG,eAC5C,IAGJ4O,QAAS,CACPxM,SAAQ,KAORgiD,oBAAAA,CAAqB3kD,EAAgBilD,GACnC,MAAMrlD,EAASI,EAAGyL,OAA4B2a,QAC9Cpf,KAAKyC,WAAYhJ,YAAY,CAC3BC,mBAAmB8J,EAAAA,EAAAA,IACjBxD,KAAKzG,gBACJkK,IACCA,EAAMwS,QAAQgoC,GAAa5+B,QAAUzmB,CAAK,IAG9Ce,UAAW,CAAC,GAEhB,EACA8jD,cAAAA,CAAe59C,GAEbG,KAAKyC,WAAYhJ,YAAY,CAC3BC,mBAAmB8J,EAAAA,EAAAA,IACjBxD,KAAKzG,gBACJkK,IACCA,EAAM+5C,SAAW39C,CAAI,IAGzBlG,UAAW,2BAWf,EAEA2J,oBAAAA,CAAqB3J,GAEnBqG,KAAKyC,WAAYhJ,YAAY,CAC3BC,mBAAmBuJ,EAAAA,EAAAA,WAAUjD,KAAKgD,qBAClCrJ,UAAWA,GAAa,CAAC,GAE7B,EAEAmkD,SAAAA,GACE99C,KAAKyC,WAAYhJ,YAAY,CAC3BC,mBAAmB8J,EAAAA,EAAAA,IACjBxD,KAAKzG,gBACJkK,IACCA,EAAMwS,QAAQzU,KAAK,CACjBjE,MAAMyG,EAAAA,EAAAA,KACNyO,KAAMzS,KAAKrE,SAAS,gBACpB0jB,SAAS,EACT/gB,QAAS,CACPb,KAAM,GACNmgD,iBAAkB,GAClBC,oBAAqB,KAEvB,KAIV,EAEAH,YAAAA,CAAaQ,GACXl+C,KAAKyC,WAAYhJ,YAAY,CAC3BC,mBAAmB8J,EAAAA,EAAAA,IACjBxD,KAAKzG,gBACJkK,IACCA,EAAMwS,QAAQpS,OAAOq6C,EAAqB,EAAE,IAGhDvkD,UAAW,CAAC,GAEhB,EAEA8O,UAAAA,CAAWC,GACT,OACE5M,OAAOC,OAAO4M,WAAa,qBAAuBD,EAAW,MAEjE,EAEAoH,cAAAA,CAAeiC,EAA6BpY,GAC1CqG,KAAKyC,WAAYhJ,YAAY,CAC3BC,mBAAmB8J,EAAAA,EAAAA,IACjBxD,KAAKzG,gBACJyY,IACCA,EAAUnK,SAAWkK,CAAe,IAGxCpY,UAAWA,GAEf,EAEAoW,mBAAAA,CAAoBkC,GAClBjS,KAAKyC,WAAYhJ,YAAY,CAC3BC,mBAAmB8J,EAAAA,EAAAA,IACjBxD,KAAKzG,gBACJyY,IACCA,EAAU1T,QAAQI,cAAgBuT,CAAoB,IAG1DtY,UAAW,wCAEf,KCzVJ,MAAM,IAA2B,OAAgB,GAAQ,CAAC,CAAC,SAAS,IAAQ,CAAC,YAAY,qBAEzF,UCPA,MACM6G,GAAa,CCFZ3B,MAAM,eDGP6B,GAAa,CAAC,aACdW,GAAa,CAAC,QAAS,sBAAuB,YAC9CI,GAAa,CAAC,gBACdC,GAAa,CACjBX,IAAK,ECgCOlC,MAAM,mBD7Bd8C,GAAa,CACjBZ,IAAK,ECsCOlC,MAAM,mBDnCd+C,GAAa,CAAC,QAAS,YACvBC,GAAa,CAAC,gBACdC,GAAa,CACjBf,IAAK,EC6DOlC,MAAM,mBD1DdkD,GAAc,CAClBhB,IAAK,ECkEOlC,MAAM,mBD/DdmD,GAAc,CCwEXnD,MAAM,iCDvEToD,GAAc,CCgFTpD,MAAM,gBD/EX+P,GAAc,CAAC,eACfsD,GAAc,CAAC,eACfC,GAAc,CAAC,eAEf,SAAU5R,GAAOxB,EAAUgG,EAAY6B,EAAYC,EAAYC,EAAWC,GAC9E,MAAMuL,GAA6BxD,EAAAA,EAAAA,IAAkB,mBAErD,OAAQ9J,EAAAA,EAAAA,OCjCRrG,EAAAA,EAAAA,IAmIM,MAnIN6B,GAmIM,EAlIJC,EAAAA,EAAAA,IA6FM,aA5FJA,EAAAA,EAAAA,IAAmC,OAA9B+R,UAA2B,KAAdpJ,KAAKo0C,UDmCpB,KAAM,EAAG98C,IClCI3B,EAAAqK,KAAK20C,oBDoChB/4C,EAAAA,EAAAA,KAAW,ICnCdrG,EAAAA,EAAAA,IAkDWgC,EAAAA,GAAA,CAAAI,IAAA,IAAAH,EAAAA,EAAAA,IAlDgB7B,EAAAkX,SAAV5B,KDoCLrP,EAAAA,EAAAA,OAAcrG,EAAAA,EAAAA,IAAoBgC,EAAAA,GAAW,CACnDI,ICrCoCsT,EAAO9W,MDsC1C,ECrCLkD,EAAAA,EAAAA,IA2BQ,SA3BA5B,OAAKC,EAAAA,EAAAA,IAAEC,EAAAo/C,eAAe9pC,KDwCvB,EACDvO,EAAAA,EAAAA,KCxCJrF,EAAAA,EAAAA,IAME,SALAjB,KAAK,WACLX,MAAM,kBACLjG,MAAOyb,EAAO5B,KDyCX,sBAAwBxR,GCxCnBlC,EAAAq/C,gBAAgB/pC,EAAO5B,MAAIxR,EACnC2O,SAAU7Q,EAAAs/C,aDyCN,KAAM,EAAGh9C,IAAa,CACvB,CAACoF,EAAAA,GC3CI1H,EAAAq/C,gBAAgB/pC,EAAO5B,UD6C9BtM,EAAAA,EAAAA,IC3CF,KACFhB,EAAAA,EAAAA,IAAGkP,EAAO5B,MAAI,GAeN4B,EAAO/V,QAAQb,OAASsB,EAAAs/C,cD6BvBr5C,EAAAA,EAAAA,OC9BTrG,EAAAA,EAAAA,IAIE,QD2BQoC,IAAK,EC7BblC,MAAM,sCACL,eAAcwV,EAAO/V,QAAQb,MD+BrB,KAAM,EAAGgE,MACZkF,EAAAA,EAAAA,IAAoB,IAAI,IAC3B,GC7BS5H,EAAAs/C,cD+BPr5C,EAAAA,EAAAA,OC/BTrG,EAAAA,EAAAA,IAmBWgC,EAAAA,GAAA,CAAAI,IAAA,IAjBgBsT,EAAO/V,QAAQs/C,kBAAoB7+C,EAAAq/C,gBAAgB/pC,EAAO5B,QDiCtEzN,EAAAA,EAAAA,OClCbrG,EAAAA,EAAAA,IAOM,MAPN+C,IAOMyD,EAAAA,EAAAA,IADDkP,EAAO/V,QAAQs/C,kBAAgB,IAINvpC,EAAO/V,QAAQu/C,sBAAwC9+C,EAAAq/C,gBAAgB/pC,EAAO5B,QD6B7FzN,EAAAA,EAAAA,OC9BfrG,EAAAA,EAAAA,IAQM,MARNgD,IAQMwD,EAAAA,EAAAA,IADDkP,EAAO/V,QAAQu/C,qBAAmB,KDwBzBl3C,EAAAA,EAAAA,IAAoB,IAAI,IAC7B,MACHA,EAAAA,EAAAA,IAAoB,IAAI,IAC3B,OACD,QACH3B,EAAAA,EAAAA,KAAW,ICtBdrG,EAAAA,EAAAA,IAkCWgC,EAAAA,GAAA,CAAAI,IAAA,IAAAH,EAAAA,EAAAA,IAlCqB7B,EAAAkX,SAAO,CAArB5B,EAAQxI,MDuBd7G,EAAAA,EAAAA,OAAcrG,EAAAA,EAAAA,IAAoBgC,EAAAA,GAAW,CAAEI,ICvBZ8K,GAAC,EAC9CpL,EAAAA,EAAAA,IAcQ,SAdA5B,OAAKC,EAAAA,EAAAA,IAAEC,EAAAo/C,eAAe9pC,KDyBvB,EACDvO,EAAAA,EAAAA,KCzBJrF,EAAAA,EAAAA,IAME,SALAjB,KAAK,QACLX,MAAM,qBACLjG,MAAOyb,ED0BJ,sBAAuBtP,EAAO,KAAOA,EAAO,GAAM9D,GCzB7ClC,EAAAu/C,eAAcr9C,GACtB2O,SAAU7Q,EAAAs/C,aD0BN,KAAM,EAAGz8C,IAAa,CACvB,CAAC28C,EAAAA,GC5BIx/C,EAAAu/C,mBD8BPn4C,EAAAA,EAAAA,IC5BF,KACFhB,EAAAA,EAAAA,IAAGkP,EAAO5B,MAAO,IACjB,GACQ4B,EAAO/V,QAAQb,OAASsB,EAAAs/C,cD2BvBr5C,EAAAA,EAAAA,OC5BTrG,EAAAA,EAAAA,IAIE,QDyBQoC,IAAK,EC3BblC,MAAM,sCACL,eAAcwV,EAAO/V,QAAQb,MD6BrB,KAAM,EAAGoE,MACZ8E,EAAAA,EAAAA,IAAoB,IAAI,IAC3B,GC3BS5H,EAAAs/C,cD6BPr5C,EAAAA,EAAAA,OC7BTrG,EAAAA,EAAAA,IAgBWgC,EAAAA,GAAA,CAAAI,IAAA,IAdDsT,EAAO/V,QAAQs/C,kBAAoB7+C,EAAAu/C,gBAAkBjqC,ID6BhDrP,EAAAA,EAAAA,OC9BbrG,EAAAA,EAAAA,IAKM,MALNmD,IAKMqD,EAAAA,EAAAA,IADDkP,EAAO/V,QAAQs/C,kBAAgB,IAINvpC,EAAO/V,QAAQu/C,qBAAuB9+C,EAAAu/C,iBAAmBjqC,ID0BxErP,EAAAA,EAAAA,OC3BfrG,EAAAA,EAAAA,IAOM,MAPNoD,IAOMoD,EAAAA,EAAAA,IADDkP,EAAO/V,QAAQu/C,qBAAmB,KDsBzBl3C,EAAAA,EAAAA,IAAoB,IAAI,IAC7B,MACHA,EAAAA,EAAAA,IAAoB,IAAI,IAC3B,OACD,SCnBVlG,EAAAA,EAAAA,IAkCM,MAlCNuB,GAkCM,CAhCIjD,EAAAs/C,cDqBHr5C,EAAAA,EAAAA,OCtBL0B,EAAAA,EAAAA,IAME4L,EAAA,CDiBIvR,IAAK,ECrBR,kBAAiBhC,EAAAoW,OACjB,aAAYpW,EAAA6I,UACZ,iBAAgB7I,EAAAL,cAChBmJ,SAAU9I,EAAAqK,KAAKvB,UDuBX,KAAM,EAAG,CAAC,kBAAmB,aAAc,iBAAkB,eAChElB,EAAAA,EAAAA,IAAoB,IAAI,ICrB5BlG,EAAAA,EAAAA,IAwBM,MAxBNwB,GAwBM,CAtBIlD,EAAA+L,kBDsBH9F,EAAAA,EAAAA,OCvBLrG,EAAAA,EAAAA,IAME,UDkBIoC,IAAK,EACLyG,aCvBJrC,EAAAA,EAAAA,IAAsC,KAAzBiE,KAAK9K,QAAQC,aACzByC,QAAK+D,EAAA,KAAAA,EAAA,GDyBhB,IAAInI,ICzBcmC,EAAA+U,oBAAA/U,EAAA+U,sBAAAlX,IACR4C,KAAK,SACLX,MAAM,iBD0BD,KAAM,EAAG+P,MACZjI,EAAAA,EAAAA,IAAoB,IAAI,GCvBpB5H,EAAAkV,kBDyBHjP,EAAAA,EAAAA,OC1BLrG,EAAAA,EAAAA,IAME,UDqBIoC,IAAK,EACLyG,aC1BJrC,EAAAA,EAAAA,IAAsC,KAAzBiE,KAAK9K,QAAQE,aACzBwC,QAAK+D,EAAA,KAAAA,EAAA,GD4BhB,IAAInI,IC5BcmC,EAAAmV,oBAAAnV,EAAAmV,sBAAAtX,IACR4C,KAAK,SACLX,MAAM,iBD6BD,KAAM,EAAGqT,MACZvL,EAAAA,EAAAA,IAAoB,IAAI,GC1BpB5H,EAAAgV,sBD4BH/O,EAAAA,EAAAA,OC7BLrG,EAAAA,EAAAA,IAME,UDwBIoC,IAAK,EACLyG,aC7BJrC,EAAAA,EAAAA,IAA0C,KAA7BiE,KAAK9K,QAAQG,iBACzBuC,QAAK+D,EAAA,KAAAA,EAAA,GD+BhB,IAAInI,IC/BcmC,EAAAy/C,4BAAAz/C,EAAAy/C,8BAAA5hD,IACR4C,KAAK,SACLX,MAAM,iBDgCD,KAAM,EAAGsT,MACZxL,EAAAA,EAAAA,IAAoB,IAAI,QAIpC,CCxBA,QAAevH,EAAAA,EAAAA,IAAgB,CAC7B8B,KAAM,iBACN5B,MAAO,CACL8J,KAAM,CACJ5J,KAAMzE,OACN2E,UAAU,IAGdmR,WAAY,CAAElC,gBAAeA,IAC7B9O,IAAAA,GACE,MAAO,CACLu+C,gBAAiB,CAAC,EAClBE,eAAgB,CAAC,EACjBD,aAAa,EACb10C,eAAe,EAEnB,EACAxB,QAAS,CACPxM,SAAQ,KAERmY,kBAAAA,GACE9T,KAAKq+C,aAAc,CACrB,EAEAnqC,kBAAAA,GACElU,KAAKq+C,aAAc,EACnBr+C,KAAK2J,eAAgB,EACrB3J,KAAKo+C,gBAAkB,CAAC,EACxBp+C,KAAKs+C,oBAAiBhjD,CACxB,EAEAkjD,0BAAAA,GACEx+C,KAAK2J,eAAgB,CACvB,EAEAw0C,cAAAA,CAAe9pC,GACb,OAAIrU,KAAK2J,eACH0K,EAAOgL,QAAgB,iBAGzBrf,KAAKq+C,YACHr+C,KAAKoJ,KAAK20C,kBACR/9C,KAAKo+C,gBAAgB/pC,EAAO5B,MAC1B4B,EAAOgL,QACF,iBAEA,mBAGF,mBAGLrf,KAAKs+C,iBAAmBjqC,EACtBA,EAAOgL,QACF,iBAEA,mBAGF,mBAIJ,oBAEX,GAEFhf,SAAU,CACR4V,OAAAA,GACE,OAAIjW,KAAKoJ,KAAK40C,YACLh+C,KAAKoJ,KAAK6M,QACdpN,KAAKwL,IAAM,CAAQA,OAAQA,EAAQvL,KAAM0B,KAAKoM,aAC9C9N,MAAK,CAAC21C,EAASC,IAAYD,EAAQ31C,KAAO41C,EAAQ51C,OAClDD,KAAI,EAAGwL,YAAaA,IAEhBrU,KAAKoJ,KAAK6M,OAErB,EAEArO,SAAAA,GACE,GAAI5H,KAAKoJ,KAAK20C,kBAAmB,CAC/B,IAAIn2C,EAAY,EAMhB,OALA5H,KAAKoJ,KAAK6M,QAAQte,SAAS0c,IACrBA,EAAOgL,SACTzX,G,IAGGA,C,CAEP,OAAO,CAEX,EAEAuN,MAAAA,GACE,GAAInV,KAAKoJ,KAAK20C,kBAAmB,CAC/B,IAAI5oC,EAAS,EAeb,OAbAnV,KAAKoJ,KAAK6M,QAAQte,SAAS0c,IACrBrU,KAAKo+C,gBAAgB/pC,EAAO5B,QAC1B4B,EAAOgL,QACTlK,IAEAA,I,IAMFA,EAAS,IAAGA,EAAS,GAElBA,C,CAEP,OAAOnV,KAAKs+C,gBAAkBt+C,KAAKs+C,eAAej/B,QAAU,EAAI,CAEpE,EAEAs/B,gBAAAA,GACE,OAAO3+C,KAAKmV,SAAWnV,KAAK4H,SAC9B,EAEAkD,eAAAA,GACE,OAAQ9K,KAAKq+C,WACf,EAEApqC,eAAAA,GACE,OACEjU,KAAKoJ,KAAKoG,cAAgBxP,KAAKq+C,cAAgBr+C,KAAK2+C,gBAExD,EAEA5qC,mBAAAA,GACE,OACE/T,KAAKoJ,KAAKqG,sBACVzP,KAAKq+C,cACJr+C,KAAK2J,gBACL3J,KAAK2+C,gBAEV,EAEAjgD,aAAAA,GACE,IAAKsB,KAAKoJ,KAAK9K,QAAQI,cAAe,MAAO,GAE7C,IAAIA,EAAgBsB,KAAKoJ,KAAK9K,QAAQI,cAAcwB,QAClD,WACAF,KAAKmV,OAAOtc,YAQd,OALA6F,EAAgBA,EAAcwB,QAC5B,SACAF,KAAK4H,UAAU/O,YAGV6F,CACT,KC/RJ,MAAM,IAA2B,OAAgB,GAAQ,CAAC,CAAC,SAAS,IAAQ,CAAC,YAAY,qBAEzF,UCPA,MACM8B,GAAa,CCFZ3B,MAAM,eDGP6B,GAAa,CCFT7B,MAAM,WDGVwC,GAAa,CCFHxC,MAAM,qBDGhB4C,GAAa,CCAN5C,MAAM,cDCb6C,GAAa,CAAC,WACdC,GAAa,CAAC,eACdC,GAAa,CAAC,UAAW,cACzBC,GAAa,CAAC,OACdC,GAAa,CACjBf,IAAK,ECiCkBlC,MAAM,gCD9BzBkD,GAAc,CCqCJlD,MAAM,yBDpChBmD,GAAc,CCmEJnD,MAAM,yBDlEhBoD,GAAc,CAAC,YACf2M,GAAc,CAAC,YACfsD,GAAc,CAAC,YAEf,SAAU3R,GAAOxB,EAAUgG,EAAY6B,EAAYC,EAAYC,EAAWC,GAC9E,MAAM63C,GAAkC9vC,EAAAA,EAAAA,IAAkB,wBACpD2qC,GAA4B3qC,EAAAA,EAAAA,IAAkB,kBAEpD,OAAQ9J,EAAAA,EAAAA,OCxBRrG,EAAAA,EAAAA,IA8IM,MA9IN6B,GA8IM,EA7IJC,EAAAA,EAAAA,IA4IO,OA5IPC,GA4IO,EA3ILD,EAAAA,EAAAA,IA+CW,WA/CXY,GA+CW,EA9CTZ,EAAAA,EAAAA,IAA6C,eAAA0E,EAAAA,EAAAA,IAAlCpG,EAAApD,SAAS,eAAD,IAEnB8E,EAAAA,EAAAA,IA+BM,MA/BNgB,GA+BM,GDPHuD,EAAAA,EAAAA,KAAW,ICvBZrG,EAAAA,EAAAA,IAqBMgC,EAAAA,GAAA,MAAAC,EAAAA,EAAAA,IApBoB7B,EAAAiE,oBAAoB+yC,OAAK,CAAzCC,EAAMtyC,MDuBNsB,EAAAA,EAAAA,OCxBVrG,EAAAA,EAAAA,IAqBM,OAnBHoC,IAAKi1C,EAAKz4C,KACVsB,OAAKC,EAAAA,EAAAA,IAAA,CDwBJ,mBAAmB,EACnB,gBCzB8E4E,IAAU3E,EAAAk3C,oBAIzFj1C,QAAKC,GAAElC,EAAAm3C,WAAWxyC,IDwBhB,ECtBHjD,EAAAA,EAAAA,IAAmE,ODwB/D+G,aCxBCrC,EAAAA,EAAAA,IAAmCpG,EAAAo3C,cAAbzyC,EAAOsyC,IAAOn3C,MAAM,mBD0B1C,KAAM,EAAG8C,KCtBdlB,EAAAA,EAAAA,IAOS,UANPjB,KAAK,SACLX,MAAM,qBACLmC,SAAKkE,EAAAA,EAAAA,KAAAjE,GAAOlC,EAAAq3C,WAAW1yC,IAAK,UAC5B,aAAY3E,EAAApD,SAAS,kBDwBnB,ECtBH8E,EAAAA,EAAAA,IAAyC,OAAnC0G,IAAKpI,EAAA0J,WAAW,SAAUlB,IAAI,ID0B/B,KAAM,EAAG1F,KACX,EAAGD,KACL,GAAIF,OACL,OCzBJjB,EAAAA,EAAAA,IAMS,UALPjB,KAAK,SACLX,MAAM,6BACLmC,QAAK+D,EAAA,KAAAA,EAAA,GD4BlB,IAAInI,IC5BgBmC,EAAAs3C,SAAAt3C,EAAAs3C,WAAAz5C,MD6BPuI,EAAAA,EAAAA,IC3BEpG,EAAApD,SAAS,qBAAD,KAKPoD,EAAAiE,oBAAoB+yC,MAAMh3C,EAAAk3C,qBDyB7BjxC,EAAAA,EAAAA,OC1BL0B,EAAAA,EAAAA,IAIEk4C,EAAA,CDuBI79C,IAAK,ECzBRi1C,KAAMj3C,EAAAiE,oBAAoB+yC,MAAMh3C,EAAAk3C,mBAChC,aAAYl3C,EAAAk3C,mBD2BR,KAAM,EAAG,CAAC,OAAQ,kBACpBjxC,EAAAA,EAAAA,OCzBLrG,EAAAA,EAAAA,IAIW,WAJXmD,GAIW,EAHTrB,EAAAA,EAAAA,IAES,eAAA0E,EAAAA,EAAAA,IADJpG,EAAApD,SAAS,2BAAD,SAKjB8E,EAAAA,EAAAA,IA6BW,WA7BXsB,GA6BW,EA5BTtB,EAAAA,EAAAA,IAAgD,eAAA0E,EAAAA,EAAAA,IAArCpG,EAAApD,SAAS,kBAAD,IAEnB8E,EAAAA,EAAAA,IAOQ,eDeNqF,EAAAA,EAAAA,KCrBArF,EAAAA,EAAAA,IAIE,SDkBA,sBAAuBsE,EAAO,KAAOA,EAAO,GAAM9D,GCrBzClC,EAAAiE,oBAAoBwM,aAAYvO,GACxCmF,SAAMrB,EAAA,KAAAA,EAAA,GDuBnB,IAAInI,ICvBiBmC,EAAAuE,sBAAAvE,EAAAuE,wBAAA1G,IACT4C,KAAK,YDwBJ,KAAM,KAAM,CACb,CAACiH,EAAAA,GC3BQ1H,EAAAiE,oBAAoBwM,iBD6B/BrJ,EAAAA,EAAAA,IC1BE,KACFhB,EAAAA,EAAAA,IAAGpG,EAAApD,SAAS,8BAAD,MAGb8E,EAAAA,EAAAA,IAOQ,eDkBNqF,EAAAA,EAAAA,KCxBArF,EAAAA,EAAAA,IAIE,SDqBA,sBAAuBsE,EAAO,KAAOA,EAAO,GAAM9D,GCxBzClC,EAAAiE,oBAAoB67C,cAAa59C,GACzCmF,SAAMrB,EAAA,KAAAA,EAAA,GD0BnB,IAAInI,IC1BiBmC,EAAAuE,sBAAAvE,EAAAuE,wBAAA1G,IACT4C,KAAK,YD2BJ,KAAM,KAAM,CACb,CAACiH,EAAAA,GC9BQ1H,EAAAiE,oBAAoB67C,kBDgC/B14C,EAAAA,EAAAA,IC7BE,KACFhB,EAAAA,EAAAA,IAAGpG,EAAApD,SAAS,kDAAD,MAGb8E,EAAAA,EAAAA,IAOQ,eDqBNqF,EAAAA,EAAAA,KC3BArF,EAAAA,EAAAA,IAIE,SDwBA,sBAAuBsE,EAAO,KAAOA,EAAO,GAAM9D,GC3BzClC,EAAAiE,oBAAoByM,qBAAoBxO,GAChDmF,SAAMrB,EAAA,KAAAA,EAAA,GD6BnB,IAAInI,IC7BiBmC,EAAAuE,sBAAAvE,EAAAuE,wBAAA1G,IACT4C,KAAK,YD8BJ,KAAM,KAAM,CACb,CAACiH,EAAAA,GCjCQ1H,EAAAiE,oBAAoByM,yBDmC/BtJ,EAAAA,EAAAA,IChCE,KACFhB,EAAAA,EAAAA,IAAGpG,EAAApD,SAAS,+BAAD,QAIf8E,EAAAA,EAAAA,IAmDW,WAnDXuB,GAmDW,EAlDTvB,EAAAA,EAAAA,IAAiD,eAAA0E,EAAAA,EAAAA,IAAtCpG,EAAApD,SAAS,mBAAD,IAEnB8E,EAAAA,EAAAA,IAOQ,eDuBN0F,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,IC7BdpG,EAAApD,SAAS,gCAAiC,IAC7C,ID6BAmK,EAAAA,EAAAA,KC7BArF,EAAAA,EAAAA,IAIE,SD0BA,sBAAuBsE,EAAO,KAAOA,EAAO,GAAM9D,GC7BzClC,EAAAiE,oBAAoB1E,QAAQC,YAAW0C,GAC/C8E,QAAKhB,EAAA,KAAAA,EAAA,GAAA9D,GAAElC,EAAAuE,qBAAqB,uCAC7B9D,KAAK,QD8BJ,KAAM,KAAM,CACb,CAACyG,EAAAA,GCjCQlH,EAAAiE,oBAAoB1E,QAAQC,kBAMzCkC,EAAAA,EAAAA,IAUQ,SATL5B,OAAKC,EAAAA,EAAAA,IAAA,qBAAyBC,EAAAiE,oBAAoBwM,gBD+BlD,EACDrJ,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,IC9BdpG,EAAApD,SAAS,iCAAkC,IAC9C,ID8BAmK,EAAAA,EAAAA,KC9BArF,EAAAA,EAAAA,IAKE,SD0BA,sBAAuBsE,EAAO,KAAOA,EAAO,GAAM9D,GC9BzClC,EAAAiE,oBAAoB1E,QAAQE,YAAWyC,GAC/C8E,QAAKhB,EAAA,MAAAA,EAAA,IAAA9D,GAAElC,EAAAuE,qBAAqB,uCAC5BsM,UAAW7Q,EAAAiE,oBAAoBwM,aAChChQ,KAAK,QD+BJ,KAAM,GAAIyC,IAAc,CACzB,CAACgE,EAAAA,GCnCQlH,EAAAiE,oBAAoB1E,QAAQE,gBDqCtC,IC9BHiC,EAAAA,EAAAA,IAUQ,SATL5B,OAAKC,EAAAA,EAAAA,IAAA,qBAAyBC,EAAAiE,oBAAoB67C,iBDgClD,EACD14C,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,IC/BdpG,EAAApD,SAAS,gCAAiC,IAC7C,ID+BAmK,EAAAA,EAAAA,KC/BArF,EAAAA,EAAAA,IAKE,SD2BA,sBAAuBsE,EAAO,MAAQA,EAAO,IAAO9D,GC/B3ClC,EAAAiE,oBAAoB1E,QAAQwgD,aAAY79C,GAChD8E,QAAKhB,EAAA,MAAAA,EAAA,IAAA9D,GAAElC,EAAAuE,qBAAqB,wCAC5BsM,UAAW7Q,EAAAiE,oBAAoB67C,cAChCr/C,KAAK,QDgCJ,KAAM,GAAIoP,IAAc,CACzB,CAAC3I,EAAAA,GCpCQlH,EAAAiE,oBAAoB1E,QAAQwgD,iBDsCtC,IC/BHr+C,EAAAA,EAAAA,IAcQ,SAbL5B,OAAKC,EAAAA,EAAAA,IAAA,CDiCJ,oBCjCyCC,EAAAiE,oBAAoByM,wBDmC9D,EACDtJ,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,IChCdpG,EAAApD,SAAS,8BAA+B,IAC3C,IDgCAmK,EAAAA,EAAAA,KChCArF,EAAAA,EAAAA,IAOE,SD0BA,sBAAuBsE,EAAO,MAAQA,EAAO,IAAO9D,GChC3ClC,EAAAiE,oBAAoB1E,QAAQG,gBAAewC,GACnD8E,QAAKhB,EAAA,MAAAA,EAAA,IAAA9D,GAAiBlC,EAAAuE,qBAAoB,2CAG1CsM,UAAW7Q,EAAAiE,oBAAoByM,qBAChCjQ,KAAK,QDiCJ,KAAM,GAAI0S,IAAc,CACzB,CAACjM,EAAAA,GCvCQlH,EAAAiE,oBAAoB1E,QAAQG,oBDyCtC,MC/BL4G,EAAAA,EAAAA,IAKEo0C,EAAA,CAJC5xC,SAAU9I,EAAAiE,oBAAoB6E,SAC9B,iBAAgB9I,EAAAiE,oBAAoB1E,QAAQI,cAC5C,oBAAiBK,EAAA+Q,eACjB,yBAAuB/Q,EAAAgR,qBDkCvB,KAAM,EAAG,CAAC,WAAY,iBAAkB,oBAAqB,8BAGtE,CE/KA,MACMvP,GAAa,CCFP3B,MAAM,0BDGZ6B,GAAa,CACjBK,IAAK,ECEDlC,MAAM,wBDCNwC,GAAa,CCCRxC,MAAM,8BDAX4C,GAAa,CCYNS,MAAA,0BDXPR,GAAa,CAAC,SAEd,SAAUnB,GAAOxB,EAAUgG,EAAY6B,EAAYC,EAAYC,EAAWC,GAC9E,MAAM4vC,GAA+B7nC,EAAAA,EAAAA,IAAkB,qBACjDg1B,GAAwBh1B,EAAAA,EAAAA,IAAkB,cAEhD,OAAQ9J,EAAAA,EAAAA,OCfRrG,EAAAA,EAAAA,IAgCW,WAhCX6B,GAgCW,EA/BTC,EAAAA,EAAAA,IAAwC,eAAA0E,EAAAA,EAAAA,IAA7BpG,EAAApD,SAAS,UAAD,IAEnB8E,EAAAA,EAAAA,IAAqC,cAAA0E,EAAAA,EAAAA,IAA3BpG,EAAApD,SAAS,SAAD,GAEG,SAAboD,EAAAi3C,KAAKx2C,MAAmBT,EAAAi3C,KAAKn3B,UDchC7Z,EAAAA,EAAAA,OCfLrG,EAAAA,EAAAA,IAyBM,MAzBN+B,GAyBM,EArBJD,EAAAA,EAAAA,IAEM,MAFNY,GAEM,EADJgE,EAAAA,EAAAA,IAAqCsxC,EAAA,CAAjBl/C,QAASsH,EAAAi3C,MAAI,uBAGnCv1C,EAAAA,EAAAA,IAMS,UALPjB,KAAK,SACJwB,QAAK+D,EAAA,KAAAA,EAAA,GDad,IAAInI,ICbYmC,EAAA+3C,oBAAA/3C,EAAA+3C,sBAAAl6C,IACRiC,MAAM,+BDcDsG,EAAAA,EAAAA,ICZFpG,EAAApD,SAAS,iBAAD,IAGb8E,EAAAA,EAAAA,IAQQ,QARRgB,GAQQ,EDGF0E,EAAAA,EAAAA,KAAiBhB,EAAAA,EAAAA,ICVlBpG,EAAApD,SAAS,qBAAsB,IAClC,IAAA8E,EAAAA,EAAAA,IAKE,SAJAjB,KAAK,OACJ5G,MAAOmG,EAAAi3C,KAAKl3B,QACZ/Y,QAAKhB,EAAA,KAAAA,EAAA,GDYhB,IAAInI,ICZcmC,EAAAg4C,gBAAAh4C,EAAAg4C,kBAAAn6C,IACRiC,MAAM,iBDaD,KAAM,GAAI6C,WAGhBsD,EAAAA,EAAAA,OCXL0B,EAAAA,EAAAA,IAAoDo9B,EAAA,CDY9C/iC,IAAK,ECZSunB,eAAevpB,EAAAi4C,eDc5B,KAAM,EAAG,CAAC,qBAErB,CCSA,QAAe53C,EAAAA,EAAAA,IAAgB,CAC7B8B,KAAM,uBACN2P,WAAY,CAAEqmC,kBAAiB,GAAE7uB,WAAUA,IAC3C9lB,KAAAA,GACE,MAAO,CACLE,YAAYpD,EAAAA,EAAAA,IAAwBnI,EAAAA,GAExC,EACAoI,MAAO,CACL02C,KAAM,CACJx2C,KAAMzE,OACN2E,UAAU,GAEZq/C,UAAW,CACTv/C,KAAMmI,OACNjI,UAAU,IAGdG,IAAAA,GACE,MAAO,CACL6C,OAAO,EAEX,EACAyF,QAAS,CACPwW,YAAW,GACXhjB,SAAQ,KACRq7C,aAAAA,CAAcl6B,GACZ,MAAMpjB,GAAoB8J,EAAAA,EAAAA,IAAQxD,KAAKzG,gBAAiBkK,IACb,UAArCA,EAAMsyC,MAAM/1C,KAAK++C,WAAWv/C,OAC7BiE,EAAMsyC,MAAM/1C,KAAK++C,WAAgClgC,QAAU/B,EAAK3b,G,IAGrEnB,KAAKyC,WAAYhJ,YAAY,CAC3BC,oBACAC,UAAW,CAAC,GAEhB,EACAo9C,cAAAA,CAAe/9C,GACb,MAAMJ,EAASI,EAAGyL,OAA4B7L,MACxCc,GAAoB8J,EAAAA,EAAAA,IAAQxD,KAAKzG,gBAAiBkK,IACb,UAArCA,EAAMsyC,MAAM/1C,KAAK++C,WAAWv/C,OAC7BiE,EAAMsyC,MAAM/1C,KAAK++C,WAAgCjgC,QAAUlmB,E,IAGhEoH,KAAKyC,WAAYhJ,YAAY,CAC3BC,oBACAC,UAAW,CAAE6F,KAAM,uBAEvB,EACAs3C,kBAAAA,GACE,MAAMp9C,GAAoB8J,EAAAA,EAAAA,IAAQxD,KAAKzG,gBAAiBkK,IACb,UAArCA,EAAMsyC,MAAM/1C,KAAK++C,WAAWv/C,OAC7BiE,EAAMsyC,MAAM/1C,KAAK++C,WAAgClgC,QAAU,G,IAIhE7e,KAAKyC,WAAYhJ,YAAY,CAC3BC,kBAAmBA,EACnBC,UAAW,CAAC,GAEhB,EACAihD,YAAAA,CAAar2C,GACX,MAAME,EAASF,EAAME,OACfo2C,EAAep2C,EAAO7L,MACtBc,GAAoB8J,EAAAA,EAAAA,IAAQxD,KAAKzG,gBAAiBkK,IACtDA,EAAMsyC,MAAM/1C,KAAK++C,WAAWv/C,KAAOq7C,CAAY,IAGjD76C,KAAKyC,WAAYhJ,YAAY,CAC3BC,kBAAmBA,EACnBC,UAAW,CAAC,GAEhB,EACAghD,oCAAAA,CACEn7C,GAEA,OAAQA,GACN,IAAK,QACH,MAAO,CACLjC,MAAMyG,EAAAA,EAAAA,KACNxE,KAAMA,EACNqf,QAAS,GACTC,QAAS,IAEb,IAAK,QACH,MAAO,CACLvhB,MAAMyG,EAAAA,EAAAA,KACNxE,KAAMA,EACNqf,QAAS,GACTC,QAAS,IAEb,IAAK,OACH,MAAO,CACLvhB,MAAMyG,EAAAA,EAAAA,KACNxE,KAAMA,EACNqrC,QAAS,IAEb,QACE,MAAM,IAAI7wC,OACR2B,EAAAA,EAAAA,IAAS,sCAAwC6D,GAGzD,GAEFa,SAAU,CACR9G,eAAgBA,IAAMd,GAAAA,GAAgBc,kBC3J1C,MAAM,IAA2B,OAAgB,GAAQ,CAAC,CAAC,SAAS,IAAQ,CAAC,YAAY,qBAEzF,UH2JA,IAAe6F,EAAAA,EAAAA,IAAgB,CAC7B8B,KAAM,mBACN2P,WAAY,CAAEmuC,qBAAoB,GAAEjuC,eAAcA,IAClDxO,KAAAA,GACE,MAAO,CACLE,YAAYpD,EAAAA,EAAAA,IAAwBnI,EAAAA,GAExC,EACAoI,MAAO,CACL/F,eAAgB,CACdiG,KAAMzE,OACN2E,UAAU,IAGdG,IAAAA,GACE,MAAO,CACLo2C,mBAAoB,EACpBjzC,qBAAqBC,EAAAA,EAAAA,WAAUjD,KAAKzG,gBAExC,EACAQ,MAAO,CAELR,eAAgB,CACdwO,WAAW,EACXC,QAAS,WACPhI,KAAKgD,qBAAsBC,EAAAA,EAAAA,WAAUjD,KAAKzG,eAC5C,IAGJ69C,WAAAA,GACMp3C,KAAKgD,oBAAoB+yC,MAAMzrC,OAAS,IAC1CtK,KAAKi2C,kBAAoB,EAE7B,EACA9tC,QAAS,CACPxM,SAAQ,KAER8M,UAAAA,CAAWC,GACT,OACE5M,OAAOC,OAAO4M,WAAa,qBAAuBD,EAAW,MAEjE,EAEApF,oBAAAA,CAAqB3J,GAEnBqG,KAAKyC,WAAYhJ,YAAY,CAC3BC,mBAAmBuJ,EAAAA,EAAAA,WAAUjD,KAAKgD,qBAClCrJ,UAAWA,GAAa,CAAC,GAE7B,EAEAu8C,UAAAA,CAAWxyC,GACT1D,KAAKi2C,kBAAoBvyC,CAC3B,EAEA2yC,OAAAA,GACEr2C,KAAKgD,qBAAsBQ,EAAAA,EAAAA,IAAQxD,KAAKgD,qBAAsBS,IAC5DA,EAAMsyC,MAAMv0C,KAAK,CACfhC,KAAM,QACNjC,MAAMyG,EAAAA,EAAAA,KACN6a,QAAS,GACTC,QAAS,IACT,IAGJ9e,KAAKsD,uBAGLtD,KAAKi2C,kBAAoBj2C,KAAKgD,oBAAoB+yC,MAAMzrC,OAAS,CACnE,EAEA8rC,UAAAA,CAAW1yC,GACT1D,KAAKgD,qBAAsBQ,EAAAA,EAAAA,IAAQxD,KAAKgD,qBAAsBS,IAC5DA,EAAMsyC,MAAMlyC,OAAOH,EAAO,EAAE,IAG9B1D,KAAKsD,uBAGDI,GAAS1D,KAAKi2C,oBAChBj2C,KAAKi2C,kBAAoBj2C,KAAKi2C,kBAAoB,EAEtD,EAEAE,aAAAA,CAAczyC,EAAesyC,GAC3B,IAAIvjC,EAAO/O,EAAQ,EAAI,KAOvB,MALkB,UAAdsyC,EAAKx2C,MAAoC,IAAhBw2C,EAAKl3B,QAChCrM,GAAQujC,EAAKl3B,QAEbrM,IAAQ9W,EAAAA,EAAAA,IAAS,QAEZ8W,CACT,EAEA3C,cAAAA,CAAeiC,GACb/R,KAAKyC,WAAYhJ,YAAY,CAC3BC,mBAAmB8J,EAAAA,EAAAA,IACjBxD,KAAKgD,qBACJgP,IACCA,EAAUnK,SAAWkK,CAAe,IAGxCpY,UAAW,2BAEf,EAEAoW,mBAAAA,CAAoBkC,GAClBjS,KAAKyC,WAAYhJ,YAAY,CAC3BC,mBAAmB8J,EAAAA,EAAAA,IACjBxD,KAAKgD,qBACJgP,IACCA,EAAU1T,QAAQI,cAAgBuT,CAAoB,IAG1DtY,UAAW,wCAEf,KIlRJ,MAAM,IAA2B,OAAgB,GAAQ,CAAC,CAAC,SAAS,IAAQ,CAAC,YAAY,qBAEzF,UCPA,MACM6G,GAAa,CCFZ3B,MAAM,eDGP6B,GAAa,CCFV7B,MAAM,WAAWogD,SAAS,MDM7B59C,GAAa,CAAC,aAAc,YAAa,cAAe,SAAU,YAAa,aAAc,UAAW,aACxGI,GAAa,CCeL5C,MAAM,iBDdd6C,GAAa,CCwBV7C,MAAM,iCDvBT8C,GAAa,CCgCR9C,MAAM,gBD/BX+C,GAAa,CAAC,eACdC,GAAa,CAAC,eACdC,GAAa,CAAC,eACdC,GAAc,CAAC,eACfC,GAAc,CC+Dd,YAAU,SACV,cAAY,OACZE,MAAA,kED3DA,SAAU3B,GAAOxB,EAAUgG,EAAY6B,EAAYC,EAAYC,EAAWC,GAC9E,MAAM4vC,GAA+B7nC,EAAAA,EAAAA,IAAkB,qBACjDwD,GAA6BxD,EAAAA,EAAAA,IAAkB,mBAErD,OAAQ9J,EAAAA,EAAAA,OCzBRrG,EAAAA,EAAAA,IAoFM,MApFN6B,GAoFM,EAnFJC,EAAAA,EAAAA,IA8BM,MA9BNC,GA8BM,GDJHsE,EAAAA,EAAAA,KAAW,ICzBZrG,EAAAA,EAAAA,IA4BSgC,EAAAA,GAAA,MAAAC,EAAAA,EAAAA,IA1BiB7B,EAAAg3C,OAAK,CAArBC,EAAMtyC,MDwBNsB,EAAAA,EAAAA,OC1BVrG,EAAAA,EAAAA,IA4BS,UA3BPa,KAAK,SAEJ,aAAYT,EAAAmgD,aAAalJ,EAAMtyC,GAC/B3C,IAAKi1C,EAAKz4C,KD0BTya,SAAS,ECzBVjV,IAAG,QAAYW,EAChB7E,OAAKC,EAAAA,EAAAA,IAAA,CAAC,OAAM,CD2BVqgD,QC1B2BpgD,EAAAqgD,qBAAuBpJ,ED2BlDpmC,SC3B4E7Q,EAAAsgD,iBD4B5EhgC,QC5BiHtgB,EAAAsgD,kBAAoBtgD,EAAAugD,wBAAwBtJ,GD6B7JhtB,UC7ByLjqB,EAAAsgD,mBAAqBtgD,EAAAugD,wBAAwBtJ,MAMvOrzC,WAAY5D,EAAAsgD,iBACZvsC,YAAYvO,GAAUxF,EAAAwgD,cAAcvJ,EAAMzxC,GAC1Ci7C,OAAIv+C,GAAElC,EAAAygD,OAAOxJ,GACb2F,UAAO16C,GAAElC,EAAA0gD,YAAYzJ,GACrB9iC,WAAQjS,GAAElC,EAAA2gD,WAAW1J,GACrBh1C,QAAKC,GAAElC,EAAA04C,YAAYzB,GACnBtnC,UAAUnK,GAAUxF,EAAA2P,UAAUsnC,EAAMzxC,ID0BlC,ECxBH9D,EAAAA,EAAAA,IAEO,OAFPgB,GAEO,EADL4D,EAAAA,EAAAA,IAAqCsxC,EAAA,CAAjBl/C,QAASu+C,GAAI,uBAGnCv1C,EAAAA,EAAAA,IAEO,QAFD5B,MAAM,oBAAqBqU,WAAQnO,EAAA,KAAAA,EAAA,IAAAG,EAAAA,EAAAA,KAAT,QAAiB,cAAEkO,YAASrO,EAAA,KAAAA,EAAA,IAAAG,EAAAA,EAAAA,KAAV,QAAkB,gBD4B/DC,EAAAA,EAAAA,IC3BA6wC,EAAKl3B,SAAO,KD4Bd,GAAIzd,OACL,SCxBNZ,EAAAA,EAAAA,IA0CM,MA1CNiB,GA0CM,CAxCI3C,EAAAsgD,mBAAqBtgD,EAAA4gD,qBD0BxB36C,EAAAA,EAAAA,OC3BL0B,EAAAA,EAAAA,IAME4L,EAAA,CDsBIvR,IAAK,EC1BR2G,eAAgB3I,EAAA8U,eAChBjM,UAAW7I,EAAA6I,UACXlJ,cAAeK,EAAAL,cACfmJ,SAAU9I,EAAAqK,KAAKvB,UD4BX,KAAM,EAAG,CAAC,iBAAkB,YAAa,gBAAiB,eAC7DlB,EAAAA,EAAAA,IAAoB,IAAI,IC1B5BlG,EAAAA,EAAAA,IAgCM,MAhCNkB,GAgCM,CA9BI5C,EAAA+L,kBD2BH9F,EAAAA,EAAAA,OC5BLrG,EAAAA,EAAAA,IAME,UDuBIoC,IAAK,EACLyG,aC5BJrC,EAAAA,EAAAA,IAAiCpG,EAAAqK,KAApB9K,QAAQC,aACpByC,QAAK+D,EAAA,KAAAA,EAAA,GD8BhB,IAAInI,IC9BcmC,EAAA+U,oBAAA/U,EAAA+U,sBAAAlX,IACR4C,KAAK,SACLX,MAAM,iBD+BD,KAAM,EAAG+C,MACZ+E,EAAAA,EAAAA,IAAoB,IAAI,GC5BpB5H,EAAAkV,kBD8BHjP,EAAAA,EAAAA,OC/BLrG,EAAAA,EAAAA,IAME,UD0BIoC,IAAK,EACLyG,aC/BJrC,EAAAA,EAAAA,IAAiCpG,EAAAqK,KAApB9K,QAAQE,aACpBwC,QAAK+D,EAAA,KAAAA,EAAA,GDiChB,IAAInI,ICjCcmC,EAAAmV,oBAAAnV,EAAAmV,sBAAAtX,IACR4C,KAAK,SACLX,MAAM,iBDkCD,KAAM,EAAGgD,MACZ8E,EAAAA,EAAAA,IAAoB,IAAI,GC/BpB5H,EAAA6gD,mBDiCH56C,EAAAA,EAAAA,OClCLrG,EAAAA,EAAAA,IAME,UD6BIoC,IAAK,EACLyG,aClCJrC,EAAAA,EAAAA,IAAkCpG,EAAAqK,KAArB9K,QAAQwgD,cACpB99C,QAAK+D,EAAA,KAAAA,EAAA,GDoChB,IAAInI,ICpCcmC,EAAA8gD,qBAAA9gD,EAAA8gD,uBAAAjjD,IACR4C,KAAK,SACLX,MAAM,iBDqCD,KAAM,EAAGiD,MACZ6E,EAAAA,EAAAA,IAAoB,IAAI,GClCpB5H,EAAAgV,sBDoCH/O,EAAAA,EAAAA,OCrCLrG,EAAAA,EAAAA,IAME,UDgCIoC,IAAK,EACLyG,aCrCJrC,EAAAA,EAAAA,IAAqCpG,EAAAqK,KAAxB9K,QAAQG,iBACpBuC,QAAK+D,EAAA,KAAAA,EAAA,GDuChB,IAAInI,ICvCcmC,EAAAiV,wBAAAjV,EAAAiV,0BAAApX,IACR4C,KAAK,SACLX,MAAM,iBDwCD,KAAM,EAAGkD,MACZ4E,EAAAA,EAAAA,IAAoB,IAAI,QCpChClG,EAAAA,EAAAA,IAMM,MANNuB,IAMMmD,EAAAA,EAAAA,IADDpG,EAAA+gD,0BAAwB,IDoCjC,CClBA,QAAe1gD,EAAAA,EAAAA,IAAgB,CAC7B8B,KAAM,mBAEN2P,WAAY,CACVqmC,kBAAiB,GACjBvoC,gBAAeA,IAGjBrP,MAAO,CACL8J,KAAM,CACJ5J,KAAMzE,OACN2E,UAAU,IAId8Q,MAAO,CAAC,iBAER3Q,IAAAA,GACE,MAAO,CACLk2C,MAAO,GACPqJ,wBAAoB9jD,EACpB+jD,kBAAkB,EAClBM,oBAAoB,EACpBG,yBAA0B,GAE9B,EAEA33C,QAAS,CACPwW,YAAW,GAEXhjB,SAAQ,KAER4jD,aAAAA,CAAcvJ,EAAmCzxC,GAC/C3K,QAAQC,IAAI,wBAAyBm8C,EAAKz4C,MAC1CyC,KAAKo/C,mBAAqBpJ,CAC5B,EAEAwJ,MAAAA,CAAOxJ,GACLp8C,QAAQC,IAAI,gBAAiBm8C,EAAKz4C,KACpC,EAEAkiD,WAAAA,CAAYzJ,GACVp8C,QAAQC,IAAI,sBAAuBm8C,EAAKz4C,MACxCyC,KAAKo/C,wBAAqB9jD,CAC5B,EAEAokD,UAAAA,CAAW1J,GACT,GAAIh2C,KAAKo/C,oBAAsBp/C,KAAKo/C,oBAAsBpJ,EAAM,CAC9D,MAAM+J,EAAY//C,KAAK+1C,MAAMt7B,QAAQza,KAAKo/C,oBACpCY,EAAUhgD,KAAK+1C,MAAMt7B,QAAQu7B,GAEnCp8C,QAAQC,IACN,gBACAmG,KAAKo/C,oBAAoB7hD,KACzB,IACAwiD,EACA,gBACA/J,EAAKz4C,KACL,IACAyiD,EACA,KAGFhgD,KAAKigD,YAAYF,EAAWC,E,CAEhC,EAEAvI,WAAAA,CAAYzB,GACV,IAAIh2C,KAAK2/C,qBAAsB3/C,KAAKq/C,iBAEpC,GAAIr/C,KAAKo/C,mBAAoB,CAC3B,MAAMW,EAAY//C,KAAK+1C,MAAMt7B,QAAQza,KAAKo/C,oBACpCY,EAAUhgD,KAAK+1C,MAAMt7B,QAAQu7B,GACnCh2C,KAAKigD,YAAYF,EAAWC,GAC5BhgD,KAAKo/C,wBAAqB9jD,C,MAE1B0E,KAAKo/C,mBAAqBpJ,CAE9B,EAEAtnC,SAAAA,CAAUsnC,EAAmCzxC,GAC3C,GAAIvE,KAAKq/C,kBAAoBr/C,KAAK2/C,mBAAoB,OAEtD,MAAMO,EAAyBlgD,KAAK+1C,MAAMt7B,QAAQu7B,GAC5CmK,EAA0BngD,KAAKo/C,mBACjCp/C,KAAK+1C,MAAMt7B,QAAQza,KAAKo/C,qBACvB,EAEL,OAAQ76C,EAAMxD,KACZ,IAAK,QACL,IAAK,IACHwD,EAAMgJ,iBAEFvN,KAAKo/C,oBAAsBp/C,KAAKo/C,qBAAuBpJ,GAEzDh2C,KAAKigD,YAAYE,EAAyBD,GAC1ClgD,KAAK8/C,yBAA2B9/C,KAAKrE,SACnC,4BAECuE,QAAQ,KAAMF,KAAKo/C,mBAAmB7hD,MACtC2C,QAAQ,KAAMT,OAAOygD,EAAyB,IAEjDlgD,KAAKo/C,wBAAqB9jD,EAC1B0E,KAAKogD,UAAUF,KAGflgD,KAAKo/C,mBAAqBp/C,KAAKo/C,wBAC3B9jD,EACA06C,EACJh2C,KAAK8/C,yBAA2B9/C,KAAKo/C,mBACjC,YAAYpJ,EAAKz4C,oBACf2iD,EAAyB,gBAE3B,sBAEN,MAEF,IAAK,SACHlgD,KAAKo/C,wBAAqB9jD,EAC1B0E,KAAK8/C,yBAA2B,sBAChC,MAEN,EAEAM,SAAAA,CAAUrB,GAER/+C,KAAK2hB,WAAU,KACb,MAAM0+B,EAAYrgD,KAAKsI,MACrB,QAAQy2C,KAENsB,GAAaA,EAAU,IAEzBA,EAAU,GAAGvyC,O,GAGnB,EAEAoxC,YAAAA,CAAalJ,EAAmCtyC,GAC9C,OAAK1D,KAAKq/C,iBAGD,GAAGrJ,EAAKz4C,oBAAoBmG,EAAQ,QACzC1D,KAAKs/C,wBAAwBtJ,GAAQ,UAAY,gBAH5C,GAAGA,EAAKz4C,oBAAoBmG,EAAQ,GAM/C,EAEAu8C,WAAAA,CAAYF,EAAmBC,GAC7B,IAAIvoD,EAAUuI,KAAK+1C,MAAMgK,GACzB//C,KAAK+1C,MAAMlyC,OAAOk8C,EAAW,GAC7B//C,KAAK+1C,MAAMlyC,OAAOm8C,EAAS,EAAGvoD,EAChC,EAEA6nD,uBAAAA,CAAwBtJ,GACtB,MAAMtyC,EAAQ1D,KAAK+1C,MAAMpyC,WACtB28C,GAAgBA,EAAY/iD,OAASy4C,EAAKz4C,OAE7C,OAAkB,IAAXmG,GAAgB1D,KAAKoJ,KAAK2sC,MAAMryC,GAAOnG,OAASy4C,EAAKz4C,IAC9D,EAEAuW,kBAAAA,GACE9T,KAAKq/C,kBAAmB,EACxBr/C,KAAK8/C,yBAA2B9/C,KAAKtB,aACvC,EAEAsV,sBAAAA,GACEhU,KAAK2/C,oBAAqB,EAC1B3/C,KAAKy4C,YACP,EAEAoH,mBAAAA,GACE7/C,KAAKq/C,kBAAmB,CAC1B,EAEAnrC,kBAAAA,GACElU,KAAKq/C,kBAAmB,EACxBr/C,KAAK2/C,oBAAqB,EAC1B3/C,KAAK04C,cACP,EAEAA,YAAAA,GAGE14C,KAAK+1C,MAAQ/1C,KAAK+1C,MACfltC,KAAKmtC,IAAI,CAAQA,KAAMA,EAAMltC,KAAM0B,KAAKoM,aACxC9N,MAAK,CAAC6vC,EAAOC,IAAUD,EAAM7vC,KAAO8vC,EAAM9vC,OAC1CD,KAAI,EAAGmtC,UAAWA,GACvB,EAEAyC,UAAAA,GACEz4C,KAAK+1C,MAAQ/1C,KAAKoJ,KAAK2sC,KACzB,GAGF11C,SAAU,CACRyK,eAAAA,GACE,OAAQ9K,KAAKq/C,gBACf,EAEAprC,eAAAA,GACE,OAAOjU,KAAKoJ,KAAKoG,cAAgBxP,KAAKq/C,gBACxC,EAEAO,gBAAAA,GACE,OACE5/C,KAAKoJ,KAAKy1C,eACV7+C,KAAKq/C,mBACJr/C,KAAK2/C,qBACL3/C,KAAKkX,oBAEV,EAEAnD,mBAAAA,GACE,OACE/T,KAAKoJ,KAAKqG,sBACVzP,KAAKq/C,mBACJr/C,KAAK2/C,qBACL3/C,KAAKkX,oBAEV,EAEArD,cAAAA,GACE,IAAIA,EAAiB,EACrB,IAAK,IAAIhI,EAAI,EAAGA,EAAI7L,KAAKoJ,KAAK2sC,MAAMzrC,OAAQuB,IACtC7L,KAAKoJ,KAAK2sC,MAAMlqC,GAAGtO,OAASyC,KAAK+1C,MAAMlqC,GAAGtO,MAC5CsW,IAGJ,OAAOA,CACT,EAEAjM,SAAAA,GACE,OAAO5H,KAAKoJ,KAAK2sC,MAAMzrC,MACzB,EAEA4M,oBAAAA,GACE,OAAOlX,KAAK6T,iBAAmB7T,KAAK4H,SACtC,EAEAlJ,aAAAA,GACE,IAAIA,EAAgBsB,KAAKoJ,KAAK9K,QAAQI,cAAcwB,QAClD,WACAF,KAAK6T,eAAehb,YAQtB,OALA6F,EAAgBA,EAAcwB,QAC5B,SACAF,KAAK4H,UAAU/O,YAGV6F,CACT,GAGF3E,MAAO,CACLqP,KAAM,CACJpB,OAAAA,GACEpO,QAAQC,IAAI,yBACZmG,KAAK+1C,MAAQ,IAAI/1C,KAAKoJ,KAAK2sC,OAC3B/1C,KAAK04C,cACP,EACA3wC,WAAW,MCnWjB,MAAM,IAA2B,OAAgB,GAAQ,CAAC,CAAC,SAAS,IAAQ,CAAC,YAAY,qBAEzF,UCPA,MAAMw4C,GAAgBpjD,EAAAA,EAAEG,OAAO,CAC7BkC,KAAMrC,EAAAA,EAAEc,QAAQ,UAGLuiD,GAAkBrjD,EAAAA,EAAEG,OAAO,CACtCC,KAAMJ,EAAAA,EAAEK,SACRgC,KAAMrC,EAAAA,EAAEc,QAAQ,SAChB4gB,QAAS1hB,EAAAA,EAAEK,SACXshB,QAAS3hB,EAAAA,EAAEK,WAIAijD,GAActjD,EAAAA,EAAEi0B,MAAM,CAACmvB,GAAeC,KAGtCE,GAAiBvjD,EAAAA,EAAEG,OAAO,CACrC2L,WAAY9L,EAAAA,EAAES,SACduL,QAAShM,EAAAA,EAAEK,WChBPmjD,GAAyBxjD,EAAAA,EAAEG,OAAO,CACtCC,KAAMJ,EAAAA,EAAEK,SACRgC,KAAMrC,EAAAA,EAAEc,QAAQ,aAChBN,EAAGR,EAAAA,EAAES,SACLC,EAAGV,EAAAA,EAAES,SACLyJ,MAAOlK,EAAAA,EAAES,SACT0J,OAAQnK,EAAAA,EAAES,SACVyhB,QAASliB,EAAAA,EAAEkB,UAAUuB,SAAQ,GAC7BiI,SAAU1K,EAAAA,EAAEK,SAASoC,QAAQ,MAIzBghD,GAAuBzjD,EAAAA,EAAEG,OAAO,CACpCC,KAAMJ,EAAAA,EAAEK,SACRgC,KAAMrC,EAAAA,EAAEc,QAAQ,WAChBN,EAAGR,EAAAA,EAAES,SACLC,EAAGV,EAAAA,EAAES,SACLyJ,MAAOlK,EAAAA,EAAES,SACT0J,OAAQnK,EAAAA,EAAES,SACVyhB,QAASliB,EAAAA,EAAEkB,UAAUuB,SAAQ,GAC7BiI,SAAU1K,EAAAA,EAAEK,SAASoC,QAAQ,MAIlBihD,GAAgB1jD,EAAAA,EAAEi0B,MAAM,CACnCuvB,GACAC,KAKWE,GAA4B3jD,EAAAA,EAAEG,OAAO,CAChDU,UAAWb,EAAAA,EAAEc,QAAQ,mBACrB2gB,MAAO6hC,GACP9iC,SAAUxgB,EAAAA,EAAEgB,MAAM0iD,IAClBh6B,cAAe1pB,EAAAA,EAAES,SAASgC,QAAQ,GAClC+mB,eAAgBxpB,EAAAA,EAAES,SAASgC,QAAQ,GACnCtB,QAASnB,EAAAA,EAAEG,OAAO,CAChBkB,YAAarB,EAAAA,EAAEK,SACfkB,cAAevB,EAAAA,EAAEK,SACjB+qB,+BAAgCprB,EAAAA,EAAEK,SAASoC,QAAQ,IACnD4oB,iCAAkCrrB,EAAAA,EAC/BK,SACAoC,QAAQ,8CAEbiI,SAAU1K,EAAAA,EAAEgB,MAAMuiD,MCfd,SAAU/hC,GAAYoiC,GAC1B,MAAe,KAAXA,EACK,GAEFjlD,OAAOC,OAAO+rC,UAAUC,OAAO,eAAgB,CACpDlpB,QAASkiC,GAEb,CAKM,SAAUtc,GAAesc,GAC7B,OAAOjlD,OAAOC,OAAO+rC,UAAUC,OAAO,6BAA6BgZ,IACrE,CAGA,MAAMC,GAAqB7jD,EAAAA,EAAEG,OAAO,CAClCC,KAAMJ,EAAAA,EAAEK,SACRgC,KAAMrC,EAAAA,EAAEc,QAAQ,SAChB4gB,QAAS1hB,EAAAA,EAAEK,SACXshB,QAAS3hB,EAAAA,EAAEK,WAIPyjD,GAAoB9jD,EAAAA,EAAEG,OAAO,CACjCC,KAAMJ,EAAAA,EAAEK,SACRgC,KAAMrC,EAAAA,EAAEc,QAAQ,QAChB4sC,QAAS1tC,EAAAA,EAAEK,WAGA0jD,GAA0B/jD,EAAAA,EAAEi0B,MAAM,CAC7CovB,GACAQ,GACAC,KAOWE,GAAyBhkD,EAAAA,EAAEG,OAAO,CAC7CU,UAAWb,EAAAA,EAAEc,QAAQ,gBACrBiR,SAAU/R,EAAAA,EAAEK,SACZ6R,YAAalS,EAAAA,EAAEK,SAASqzB,WAAWjxB,QAAQ,IAC3C4P,aAAcrS,EAAAA,EAAEkB,UAChBoR,qBAAsBtS,EAAAA,EAAEkB,UACxBiR,gBAAiBnS,EAAAA,EAAEkB,UACnBsR,kCAAmCxS,EAAAA,EAAEkB,UACrCkR,gBAAiBpS,EAAAA,EAAEkB,UACnBC,QAASnB,EAAAA,EAAEG,OAAO,CAChBiB,YAAapB,EAAAA,EAAEK,SACfgB,YAAarB,EAAAA,EAAEK,SACfiB,gBAAiBtB,EAAAA,EAAEK,SACnBqS,uBAAwB1S,EAAAA,EAAEK,SAC1BkB,cAAevB,EAAAA,EAAEK,WAEnBqK,SAAU1K,EAAAA,EAAEgB,MAAMuiD,MAIPU,GAAyBjkD,EAAAA,EAAEG,OAAO,CAC7CU,UAAWb,EAAAA,EAAEc,QAAQ,gBACrBC,MAAOf,EAAAA,EAAEK,SACT6M,KAAMlN,EAAAA,EAAES,SAASizB,WAAWjxB,QAAQ,IACpCmqB,SAAU5sB,EAAAA,EAAEK,SACZ2sB,aAAchtB,EAAAA,EAAEkB,UAAUuB,SAAQ,GAClCwqB,WAAYjtB,EAAAA,EACTG,OAAO,CACNigB,EAAGpgB,EAAAA,EAAEkB,UACLksB,GAAIptB,EAAAA,EAAEkB,UACN5C,EAAG0B,EAAAA,EAAEkB,UACLmsB,GAAIrtB,EAAAA,EAAEkB,UACNisB,EAAGntB,EAAAA,EAAEkB,UACLqsB,GAAIvtB,EAAAA,EAAEkB,UACNgsB,EAAGltB,EAAAA,EAAEkB,UACLosB,GAAIttB,EAAAA,EAAEkB,YAEPwyB,WACHvyB,QAASnB,EAAAA,EAAEG,OAAO,CAChBiB,YAAapB,EAAAA,EAAEK,SAASoC,QAAQ,IAChCpB,YAAarB,EAAAA,EAAEK,SACfiB,gBAAiBtB,EAAAA,EAAEK,SACnBkB,cAAevB,EAAAA,EAAEK,SACjBmtB,cAAextB,EAAAA,EAAEK,SAASoC,QAAQ,UAClCgrB,MAAOztB,EAAAA,EAAEK,aAKA6jD,GAA4BlkD,EAAAA,EAAEG,OAAO,CAChDU,UAAWb,EAAAA,EAAEc,QAAQ,mBACrBiR,SAAU/R,EAAAA,EAAEK,SACZgS,aAAcrS,EAAAA,EAAEkB,UAChBoR,qBAAsBtS,EAAAA,EAAEkB,UACxBiZ,cAAena,EAAAA,EAAEkB,UACjBmZ,YAAara,EAAAA,EAAEkB,UACfsR,kCAAmCxS,EAAAA,EAAEkB,UACrCkZ,YAAapa,EAAAA,EAAEkB,UACfC,QAASnB,EAAAA,EAAEG,OAAO,CAChBiB,YAAapB,EAAAA,EAAEK,SACfgB,YAAarB,EAAAA,EAAEK,SACfiB,gBAAiBtB,EAAAA,EAAEK,SACnBqS,uBAAwB1S,EAAAA,EAAEK,SAC1BkB,cAAevB,EAAAA,EAAEK,WAEnBqK,SAAU1K,EAAAA,EAAEgB,MAAMuiD,MAIPY,GAAyBnkD,EAAAA,EAAEG,OAAO,CAC7CU,UAAWb,EAAAA,EAAEc,QAAQ,gBACrBiR,SAAU/R,EAAAA,EAAEK,SACZgS,aAAcrS,EAAAA,EAAEkB,UAChBoR,qBAAsBtS,EAAAA,EAAEkB,UACxBC,QAASnB,EAAAA,EAAEG,OAAO,CAChBiB,YAAapB,EAAAA,EAAEK,SACfgB,YAAarB,EAAAA,EAAEK,SACfiB,gBAAiBtB,EAAAA,EAAEK,SACnBkB,cAAevB,EAAAA,EAAEK,WAEnBqK,SAAU1K,EAAAA,EAAEgB,MAAMuiD,IAAgB9gD,SAAQ,IAAM2hD,SAIrCC,GAAmBrkD,EAAAA,EAAEG,OAAO,CACvCC,KAAMJ,EAAAA,EAAEK,SACRq5C,MAAOqK,GACPtK,OAAQsK,GAAwBrwB,aAIrB4wB,GAAmBtkD,EAAAA,EAAEG,OAAO,CACvCU,UAAWb,EAAAA,EAAEc,QAAQ,UACrB83C,MAAO54C,EAAAA,EAAEgB,MAAMqjD,IACfjL,aAAcp5C,EAAAA,EAAEkB,UAChBm4C,SAAUgK,GAAgB3vB,WAC1BrhB,aAAcrS,EAAAA,EAAEkB,UAChBC,QAASnB,EAAAA,EAAEG,OAAO,CAChBkB,YAAarB,EAAAA,EAAEK,SACfkB,cAAevB,EAAAA,EAAEK,aAKRkkD,GAAavkD,EAAAA,EAAEG,OAAO,CACjCC,KAAMJ,EAAAA,EAAEK,SACRy8C,iBAAkBiH,GAClB9G,cAAe8G,KAIJS,GAAoBxkD,EAAAA,EAAEG,OAAO,CACxCU,UAAWb,EAAAA,EAAEc,QAAQ,WACrBy7C,MAAOv8C,EAAAA,EAAEgB,MAAMujD,IACflyC,aAAcrS,EAAAA,EAAEkB,UAAUwyB,WAAWjxB,SAAQ,GAC7C6P,qBAAsBtS,EAAAA,EAAEkB,UAAUwyB,WAAWjxB,SAAQ,GACrDtB,QAASnB,EAAAA,EAAEG,OAAO,CAChBiB,YAAapB,EAAAA,EAAEK,SACfgB,YAAarB,EAAAA,EAAEK,SACfiB,gBAAiBtB,EAAAA,EAAEK,SACnBkB,cAAevB,EAAAA,EAAEK,WAEnBqK,SAAU1K,EAAAA,EAAEgB,MAAMuiD,MAIPkB,GAAuBzkD,EAAAA,EAAEG,OAAO,CAC3CC,KAAMJ,EAAAA,EAAEK,SAASqzB,WAAWjxB,SAAQoE,EAAAA,EAAAA,MACpCyO,KAAMtV,EAAAA,EAAEK,SACR6hB,QAASliB,EAAAA,EAAEkB,UACXC,QAASnB,EAAAA,EAAEG,OAAO,CAChBG,KAAMN,EAAAA,EAAEK,SACRogD,iBAAkBzgD,EAAAA,EAAEK,SACpBqgD,oBAAqB1gD,EAAAA,EAAEK,aAKdqkD,GAAqB1kD,EAAAA,EAAEG,OAAO,CACzCU,UAAWb,EAAAA,EAAEc,QAAQ,YACrBu/C,SAAUrgD,EAAAA,EAAEK,SACZyY,QAAS9Y,EAAAA,EAAEgB,MAAMyjD,IACjB7D,kBAAmB5gD,EAAAA,EAAEkB,UACrBmR,aAAcrS,EAAAA,EAAEkB,UAChB2/C,YAAa7gD,EAAAA,EAAEkB,UACfoR,qBAAsBtS,EAAAA,EAAEkB,UACxBC,QAASnB,EAAAA,EAAEG,OAAO,CAChBiB,YAAapB,EAAAA,EAAEK,SACfgB,YAAarB,EAAAA,EAAEK,SACfiB,gBAAiBtB,EAAAA,EAAEK,SACnBkB,cAAevB,EAAAA,EAAEK,SAASqzB,aAE5BhpB,SAAU1K,EAAAA,EAAEgB,MAAMuiD,IAAgB9gD,SAAQ,IAAM2hD,SAIrCO,GAAuB3kD,EAAAA,EAAEG,OAAO,CAC3CU,UAAWb,EAAAA,EAAEc,QAAQ,cACrB83C,MAAO54C,EAAAA,EAAEgB,MAAM+iD,IACf1xC,aAAcrS,EAAAA,EAAEkB,UAAUwyB,WAAWjxB,SAAQ,GAC7Ci/C,cAAe1hD,EAAAA,EAAEkB,UAAUwyB,WAAWjxB,SAAQ,GAC9C6P,qBAAsBtS,EAAAA,EAAEkB,UAAUwyB,WAAWjxB,SAAQ,GACrDtB,QAASnB,EAAAA,EAAEG,OAAO,CAChBiB,YAAapB,EAAAA,EAAEK,SACfgB,YAAarB,EAAAA,EAAEK,SACfshD,aAAc3hD,EAAAA,EAAEK,SAASqzB,WAAWjxB,SAAQjE,EAAAA,EAAAA,IAAS,eACrD8C,gBAAiBtB,EAAAA,EAAEK,SACnBkB,cAAevB,EAAAA,EAAEK,WAEnBqK,SAAU1K,EAAAA,EAAEgB,MAAMuiD,MAIPqB,GAAuB5kD,EAAAA,EAAE6kD,mBAAmB,YAAa,CACpEjkD,EACAojD,GACAE,GACAP,GACAM,GACAvuB,GACAyuB,GACAG,GACAE,GACAE,GACAC,KAUWlwB,GAA4Cz0B,EAAAA,EAAE6kD,mBACzD,YACA,CACEjkD,EACAojD,GACAE,GACAP,GACAM,GACAE,GACAG,GACAE,GACAE,GACAC,KASSG,GAAiB9kD,EAAAA,EAAEi0B,MAAM,CACpCrzB,EAAoBirC,MAAMhrC,UAC1BmjD,GAAuBnY,MAAMhrC,UAC7BqjD,GAA0BrY,MAAMhrC,UAChC8iD,GAA0B9X,MAAMhrC,UAChCojD,GAAuBpY,MAAMhrC,UAC7B60B,GAA2BmW,MAAMhrC,UACjCsjD,GAAuBtY,MAAMhrC,UAC7ByjD,GAAiBzY,MAAMhrC,UACvB2jD,GAAkB3Y,MAAMhrC,UACxB6jD,GAAmB7Y,MAAMhrC,UACzB8jD,GAAqB9Y,MAAMhrC,YAG7B,SAASujD,KACP,MAAO,CACL,CAAEt4C,WAAY,EAAGE,QAAS,iCAC1B,CAAEF,WAAY,GAAIE,QAAS,QAC3B,CAAEF,WAAY,GAAIE,QAAS,aAC3B,CAAEF,WAAY,IAAKE,QAAS,YAEhC,CAEM,SAAU85B,GAAQzjC,GACtB,OAAQA,GACN,IAAK,YACH,MAAO,CACLxB,UAAW,YACXE,MAAO,CACL,CACEX,MAAMyG,EAAAA,EAAAA,KACNvG,KAAM,kCACNC,SAAU,SACVC,EAAG,EACHE,EAAG,EACHC,UAAW,UAEb,CACEP,MAAMyG,EAAAA,EAAAA,KACNvG,KAAM,kCACNC,SAAU,SACVC,EAAG,EACHE,EAAG,EACHC,UAAW,QAEb,CACEP,MAAMyG,EAAAA,EAAAA,KACNvG,KAAM,qCACNC,SAAU,UACVC,EAAG,EACHE,EAAG,EACHC,UAAW,UAEb,CACEP,MAAMyG,EAAAA,EAAAA,KACNvG,KAAM,yBACNC,SAAU,QACVC,EAAG,EACHE,EAAG,EACHC,UAAW,UAEb,CACEP,MAAMyG,EAAAA,EAAAA,KACNvG,KAAM,YACNC,SAAU,UACVC,EAAG,EACHE,EAAG,EACHC,UAAW,SAGfM,iBAAiB,EACjBE,QAAS,CACPC,YAAa,aACbC,YAAa,mBACbC,gBAAiB,oBACjBC,cAAe,mDAGrB,IAAK,eACH,MAAO,CACLV,UAAW,eACXkR,SAAU,2CACVG,YAAa,GACbG,cAAc,EACdC,sBAAsB,EACtBH,iBAAiB,EACjBK,mCAAmC,EACnCJ,iBAAiB,EACjBjR,QAAS,CACPC,YAAa,uBACbC,YAAa,mBACbC,gBAAiB,oBACjBoR,uBACE,8DACFnR,cAAe,kDAEjBmJ,SAAU05C,MAEd,IAAK,mBACH,MAAO,CACLvjD,UAAW,mBACXixB,aAAc,GACd6D,MAAO,CACLtzB,KAAM,QAERuzB,UAAU,EACVC,QAAS,EACTC,kBAAmB,eACnBxE,iBAAkB,CAChBiE,SAAS,EACTC,cAAch3B,EAAAA,EAAAA,IAAS,gBACvBi3B,oBAAoBj3B,EAAAA,EAAAA,IAAS,yBAGnC,IAAK,kBACH,MAAO,CACLqC,UAAW,kBACXkR,SAAU,kCACVM,cAAc,EACdC,sBAAsB,EACtB6H,eAAe,EACfE,aAAa,EACb7H,mCAAmC,EACnC4H,aAAa,EACbjZ,QAAS,CACPC,YAAa,uBACbC,YAAa,mBACbC,gBAAiB,oBACjBoR,uBACE,8DACFnR,cAAe,kDAEjBmJ,SAAU05C,MAEd,IAAK,kBACH,MAAO,CACLvjD,UAAW,kBACX4gB,MAAO,CACLpf,KAAM,QAERme,SAAU,GACVkJ,cAAe,EACfF,eAAgB,EAChBroB,QAAS,CACPE,YAAa,mBACbE,cAAe,yCACf6pB,+BAAgC,yBAChCC,iCACE,4CAEJ3gB,SAAU05C,MAEd,IAAK,eACH,MAAO,CACLvjD,UAAW,eACXE,MAAO,wBACPmM,KAAM,GACN0f,SAAU,6BACVI,cAAc,EACdC,WAAY,CACV7M,GAAG,EACHgN,IAAI,EACJ9uB,GAAG,EACH+uB,IAAI,EACJF,GAAG,EACHI,IAAI,EACJL,GAAG,EACHI,IAAI,GAENnsB,QAAS,CACPC,YAAa,aACbC,YAAa,mBACbC,gBAAiB,oBACjBC,cAAe,uCACfisB,cAAe,SACfC,MAAO,UAGb,IAAK,eACH,MAAO,CACL5sB,UAAW,eACXkR,SACE,8EACFM,cAAc,EACdC,sBAAsB,EACtBnR,QAAS,CACPC,YAAa,uBACbC,YAAa,mBACbC,gBAAiB,oBACjBC,cAAe,mDAEjBmJ,SAAU05C,MAEd,IAAK,SACH,MAAO,CACLvjD,UAAW,SACX+3C,MAAO,CACL,CACEx4C,MAAMyG,EAAAA,EAAAA,KACN6yC,MAAO,CACLr3C,KAAM,QACNjC,MAAMyG,EAAAA,EAAAA,KACN6a,QAAS,GACTC,QAAS,MAIftP,cAAc,EACd+mC,cAAc,EACdj4C,QAAS,CACPE,YAAa,mBACbE,cAAe,iBAGrB,IAAK,UACH,MAAO,CACLV,UAAW,UACX07C,MAAO,CACL,CACEn8C,MAAMyG,EAAAA,EAAAA,KACNi2C,iBAAkB,CAChB18C,MAAMyG,EAAAA,EAAAA,KACNxE,KAAM,QACNqf,QAAS,GACTC,QAAS,IAEXs7B,cAAe,CACb78C,MAAMyG,EAAAA,EAAAA,KACNxE,KAAM,QACNqf,QAAS,GACTC,QAAS,MAIftP,cAAc,EACdC,sBAAsB,EACtBnR,QAAS,CACPC,YAAa,uBACbC,YAAa,mBACbC,gBAAiB,oBACjBC,cAAe,mDAEjBmJ,SAAU05C,MAEd,IAAK,WACH,MAAO,CACLvjD,UAAW,WACXw/C,SACE,mEACFvnC,QAAS,CACP,CACE1Y,MAAMyG,EAAAA,EAAAA,KACNyO,KAAM,aACN4M,SAAS,EACT/gB,QAAS,CACPb,KAAM,GACNmgD,iBAAkB,GAClBC,oBAAqB,KAGzB,CACEtgD,MAAMyG,EAAAA,EAAAA,KACNyO,KAAM,gBACN4M,SAAS,EACT/gB,QAAS,CACPb,KAAM,GACNmgD,iBAAkB,GAClBC,oBAAqB,KAGzB,CACEtgD,MAAMyG,EAAAA,EAAAA,KACNyO,KAAM,YACN4M,SAAS,EACT/gB,QAAS,CACPb,KAAM,GACNmgD,iBAAkB,GAClBC,oBAAqB,KAGzB,CACEtgD,MAAMyG,EAAAA,EAAAA,KACNyO,KAAM,SACN4M,SAAS,EACT/gB,QAAS,CACPb,KAAM,GACNmgD,iBAAkB,GAClBC,oBAAqB,MAI3BE,mBAAmB,EACnBvuC,cAAc,EACdwuC,aAAa,EACbvuC,sBAAsB,EACtBnR,QAAS,CACPC,YAAa,uBACbC,YAAa,mBACbC,gBAAiB,oBACjBC,cAAe,mBAEjBmJ,SAAU05C,MAEd,IAAK,aACH,MAAO,CACLvjD,UAAW,aACX+3C,MAAO,CACL,CACEv2C,KAAM,QACNjC,MAAMyG,EAAAA,EAAAA,KACN6a,QAAS,GACTC,QAAS,KAGbtP,cAAc,EACdqvC,eAAe,EACfpvC,sBAAsB,EACtBnR,QAAS,CACPC,YAAa,yBACbC,YAAa,mBACbsgD,aAAc,aACdrgD,gBAAiB,oBACjBC,cAAe,mDAEjBmJ,SAAU05C,MAEd,QACE,MAAM,IAAIvnD,MAAM,uBAAyBwF,GAE/C,CAEM,SAAUgxB,GAAkBhxB,GAChC,OAAQA,GACN,IAAK,YACH,OAAO0iD,GACT,IAAK,eACH,OAAOC,GACT,IAAK,mBACH,OAAOC,GACT,IAAK,kBACH,OAAOC,GACT,IAAK,kBACH,OAAOC,GACT,IAAK,eACH,OAAOC,GACT,IAAK,eACH,OAAOC,GACT,IAAK,SACH,OAAOC,GACT,IAAK,UACH,OAAOC,GACT,IAAK,WACH,OAAOC,GACT,IAAK,aACH,OAAOC,GACT,QACE,MAAM,IAAI5oD,MAAM,4BAA8BwF,GAEpD,CAEM,SAAUmhC,GAAkBnhC,GAChC,OAAQA,GACN,IAAK,YACH,OAAOqjD,EACT,IAAK,eACH,OAAOC,GACT,IAAK,mBACH,OAAOC,GACT,IAAK,kBACH,OAAOC,GACT,IAAK,kBACH,OAAOC,GACT,IAAK,eACH,OAAOC,GACT,IAAK,eACH,OAAOC,GACT,IAAK,SACH,OAAOC,GACT,IAAK,UACH,OAAOC,GACT,IAAK,WACH,OAAOC,GACT,IAAK,aACH,OAAOC,GACT,QACE,MAAM,IAAIvpD,MAAM,4BAA8BwF,GAEpD,CAEM,SAAU8wB,GAAc9wB,GAC5B,OAAQA,GACN,IAAK,YACH,OAAO7D,EAAAA,EAAAA,IAAS,aAClB,IAAK,eACH,OAAOA,EAAAA,EAAAA,IAAS,kBAClB,IAAK,mBACH,OAAOA,EAAAA,EAAAA,IAAS,qBAClB,IAAK,kBACH,OAAOA,EAAAA,EAAAA,IAAS,sBAClB,IAAK,kBACH,OAAOA,EAAAA,EAAAA,IAAS,qBAClB,IAAK,eACH,OAAOA,EAAAA,EAAAA,IAAS,kBAClB,IAAK,eACH,OAAOA,EAAAA,EAAAA,IAAS,kBAClB,IAAK,SACH,OAAOA,EAAAA,EAAAA,IAAS,UAClB,IAAK,UACH,OAAOA,EAAAA,EAAAA,IAAS,WAClB,IAAK,WACH,OAAOA,EAAAA,EAAAA,IAAS,YAClB,IAAK,aACH,OAAOA,EAAAA,EAAAA,IAAS,cAEtB,CAMM,SAAUilC,GACdphC,GAEA,OAAQA,GACN,IAAK,mBACH,OAAO,EACT,QACE,OAAO,EAEb,CAEM,SAAU2zB,GAAgB3zB,GAC9B,OAAQA,GACN,IAAK,eACH,MAAO,OACT,IAAK,mBACH,MAAO,aACT,IAAK,kBACH,MAAO,cACT,IAAK,eACH,MAAO,OACT,IAAK,eACH,MAAO,OACT,IAAK,SACH,MAAO,OACT,IAAK,UACH,MAAO,OACT,IAAK,WACH,MAAO,WACT,IAAK,aACH,MAAO,UAEX,MAAO,UACT,C,4LCnuBO,MAAMgkD,EAAaC,EAAAA,EAAMC,OAAO,CACrCC,QAAS7nD,OAAOC,OAAO+rC,UAAUC,OAAO,iBAAkB,CAAC,GAAG,GAC9D6C,QAAS,CACP,eAAgB,8BAQb3qB,eAAejD,GAAW,KAC/BF,EAAI,SACJG,EAAQ,OACRZ,IAMA,MAAMunC,EAAS9mC,GAAMopB,gBAAgB,iBAAiBrmC,MAAMsB,IAAM,KAC5D0iD,EAAW,IAAIC,SACrBD,EAAS9pC,OAAO,OAAQkD,EAAUH,EAAKxB,WAAWpa,MAC9C0iD,GACFC,EAAS9pC,OAAO,UAAW6pC,GAE7B,MAAM3xB,EAAM,WAAW5V,EAAOlb,eACxB4iD,QAAgBP,EAAWtW,KAAKjb,EAAK4xB,EAAU,CACnDjZ,QAAS,CACP,eAAgB,yBAGdN,QAAiBkZ,EAAWrgD,IAAI4gD,EAAQnZ,QAAQoZ,UAChDnkD,EAAOyqC,EAASzqC,KAAKA,KAC3B,OAAO62B,EAAer9B,MAAMwG,EAC9B,CAKOogB,eAAe/E,GAAW,OAC/BC,IAIA,MAAM8W,EAAM,SAAS9W,YAGfmvB,QAAiBkZ,EAAWrgD,IAAI8uB,EAAK,CACzC2Y,QAAS,CACP,eAAgB,8BAKpB,OAAON,EAASzqC,KAAKA,IACvB,CAKOogB,eAAevE,GAAa,OACjCP,EAAM,KACNja,EAAI,eACJya,EAAc,WACdC,IAQA,MAAMqW,EAAM,SAAS9W,YAGf8Z,EAAU,CACdp1B,KAAM,CACJL,KAAM,UACN8b,WAAY,CACV,cAAeM,EACf1a,KAAMA,GAERglC,cAAe,CACb/pB,OAAQ,CACNtc,KAAM,CACJL,KAAM,UACN2B,GAAIwa,OAQR2uB,QAAiBkZ,EAAWtW,KAAKjb,EAAKgD,EAAS,CACnD2V,QAAS,CACP,eAAgB,8BAKpB,OAAON,EAASzqC,KAAKA,IACvB,CAKO,MAAM62B,EAAiBv5B,EAAAA,EAAEG,OAAO,CACrCkC,KAAMrC,EAAAA,EAAEc,QAAQ,aAChBkD,GAAIhE,EAAAA,EAAEK,SACN8d,WAAYne,EAAAA,EAAEG,OAAO,CACnB4D,KAAM/D,EAAAA,EAAEK,SACR22B,OAAQh3B,EAAAA,EAAEK,SACV62B,OAAQl3B,EAAAA,EAAEK,SACVymD,YAAa9mD,EAAAA,EAAEK,SACf0mD,UAAW/mD,EAAAA,EAAES,SACbumD,SAAUhnD,EAAAA,EAAES,SACZ,kBAAmBT,EAAAA,EAAEkB,UACrB,cAAelB,EAAAA,EAAEkB,UACjB,cAAelB,EAAAA,EAAEkB,UACjB,cAAelB,EAAAA,EAAEkB,UACjB,YAAalB,EAAAA,EAAEK,WAEjB4mD,MAAOjnD,EAAAA,EAAEG,OAAO,CACd+mD,KAAMlnD,EAAAA,EAAEK,WAEV82B,KAAMn3B,EAAAA,EAAEG,OAAO,CACb,eAAgBH,EAAAA,EAAEK,WAIpB0oC,cAAe/oC,EAAAA,EAAEmnD,W,6IC1HZrkC,eAAeskC,EACpBhrD,EACAirD,EACAC,EACAC,EACAC,GAEA,MAAM1yB,EAAMn2B,OAAOC,OAAO6G,gBAAgBgiD,UACpCC,EAAQ/oD,OAAOC,OAAO+oD,WACtBjB,EAAW,IAAIC,SAEfiB,EAAuBhD,EAAAA,GAAqB1oD,MAAME,GASxD,OARAsqD,EAAS9pC,OAAO,kBAAmB3gB,KAAKE,UAAUyrD,IAClDlB,EAAS9pC,OAAO,YAAa2qC,GAC7Bb,EAAS9pC,OAAO,OAAQyqC,GACxBX,EAAS9pC,OAAO,WAAY0qC,GACxBE,GACFd,EAAS9pC,OAAO,WAAY4qC,GAE9Bd,EAAS9pC,OAAO8qC,EAAM3jD,KAAM2jD,EAAMjsD,OAC3B2xC,MAAMtY,EAAK,CAChB+yB,OAAQ,OACRC,KAAMpB,IACL3mC,MAAMotB,IACP,IAAKA,EAASE,GACZ,MAAM,IAAIxwC,MAAMswC,EAASI,YAI3B,OAAOJ,EAAS4a,MAAmC,GAEvD,CAiBOjlC,eAAe/K,EACpBC,EACAE,GAGA,MAAM4c,EAAMn2B,OAAOC,OAAO6G,gBAAgBuiD,mBACpCtB,EAAW,IAAIC,SACfe,EAAQ/oD,OAAOC,OAAO+oD,WAS5B,OARAjB,EAAS9pC,OAAO8qC,EAAM3jD,KAAM2jD,EAAMjsD,OAElCmC,OAAO8e,QAAQ1E,GAAQxd,SAAQ,EAAEuJ,EAAM0J,MACrCi5C,EAAS9pC,OAAO,mBAAmB7Y,KAAS0J,EAAM/R,WAAW,IAE3Dwc,GACFwuC,EAAS9pC,OAAO,mBAAoB,QAE/BwwB,MAAMtY,EAAK,CAChB+yB,OAAQ,OACRC,KAAMpB,IACL3mC,MAAMotB,IACP,IAAKA,EAASE,GACZ,MAAM,IAAIxwC,MAAMswC,EAASI,W,GAG/B,CAEO,MAAMvY,EAA4Bh1B,EAAAA,EAAEG,OAAO,CAChD4D,KAAM/D,EAAAA,EAAEK,SACRgC,KAAMrC,EAAAA,EAAEK,SACRy0B,IAAK90B,EAAAA,EAAEK,U,wiBC9CT,SAAS4nD,EAAMC,GACb,OAAO,IAAIjlC,SAASgG,GAAMle,WAAWke,EAAGi/B,IAC1C,EA/BAC,EAAAA,EAAAA,KAAc,GAkCP,IAAMC,EAAN,cAA+BC,EAAAA,GAAUpc,WAAAA,IAAAxsC,GAAA,SAAAA,IAAA6oD,EAAAA,EAAAA,GAAA,kBACrB,CAAEhb,OAAQ,WAASgb,EAAAA,EAAAA,GAAA,mBACpB,KAAEA,EAAAA,EAAAA,GAAA,sBACC,KAAEA,EAAAA,EAAAA,GAAA,4BACe,KAAEA,EAAAA,EAAAA,GAAA,wBACnB,KAAEA,EAAAA,EAAAA,GAAA,sBACJ,KAAEA,EAAAA,EAAAA,GAAA,kBACN,KAAEA,EAAAA,EAAAA,GAAA,gBACJ,KAAEA,EAAAA,EAAAA,GAAA,wBACuB,OAAIA,EAAAA,EAAAA,GAAA,qBACf,CAC/B,CACElsD,gBAAgB0pC,EAAAA,EAAAA,IAAQ,mBACxBtpC,UAAW,CAAC,MAEf8rD,EAAAA,EAAAA,GAAA,qBACe,EAAC,CAEjB,kBAAIlsD,GACF,OAAOyG,KAAK0lD,cAAc1lD,KAAK2lD,eAAepsD,cAChD,CAEA,qBAAIqsD,GACF,QACGvuC,EAAAA,EAAAA,SAAQrX,KAAKzG,eAAgByG,KAAK6lD,uBACnC7lD,KAAK8lD,mBAAqB9lD,KAAKwkD,YAC/BxkD,KAAK+lD,iBAAmB/lD,KAAKgmD,QAEjC,CAEA,WAAIC,GACF,OAAOjmD,KAAK2lD,cAAgB,CAC9B,CAEA,WAAIO,GACF,OAAOlmD,KAAK2lD,cAAgB3lD,KAAK0lD,cAAcp7C,OAAS,CAC1D,CAGA67C,IAAAA,GACE,GAAInmD,KAAK2lD,cAAgB,EAAG,CAC1B,MAAMS,EAAepmD,KAAK0lD,cAAc1lD,KAAK2lD,eAC7C3lD,KAAK2lD,gBAML,MAAMU,EAAgB90C,SAASy9B,iBAC7B,wBAAwBoX,EAAazsD,eAEvC,GAAI0sD,EAAc/7C,OAAS,EAAG,CAC5B,MAAMwkC,EAAUuX,EAAcxgD,KAAK,GAG7BkpC,EAAmB,IACpBx9B,SAASy9B,iBAAiB,mCAC7BrpC,QAAQlO,GAAYA,EAAQw3C,SAASH,KACvCC,EAAiBp3C,SAASwkB,GACxBA,EAAO+a,UAAUhd,OAAO,eAE1B40B,EAAQhhC,O,EAGd,CAGAw4C,IAAAA,GACE,GAAItmD,KAAK2lD,cAAgB3lD,KAAK0lD,cAAcp7C,OAAS,EAAG,CACtDtK,KAAK2lD,gBACL,MAAMY,EAAYvmD,KAAK0lD,cAAc1lD,KAAK2lD,eAGpCU,EAAgB90C,SAASy9B,iBAC7B,wBAAwBuX,EAAU5sD,eAEpC,GAAI0sD,EAAc/7C,OAAS,EAAG,CAC5B,MAAMwkC,EAAUuX,EAAcxgD,KAAK,GAC7BkpC,EAAmB,IACpBx9B,SAASy9B,iBAAiB,mCAC7BrpC,QAAQlO,GAAYA,EAAQw3C,SAASH,KACvCC,EAAiBp3C,SAASwkB,GACxBA,EAAO+a,UAAUhd,OAAO,eAE1B40B,EAAQhhC,O,EAGd,CAIA04C,oBAAAA,CAAqBvxB,GAInBr7B,QAAQypC,KAAK,yBAA0BpO,GACvCj1B,KAAK6lD,qBAAuB5wB,EAAQv5B,UACpCsE,KAAK0lD,cAAgB,CACnB,CAAEnsD,eAAgByG,KAAK6lD,qBAAsBlsD,UAAW,CAAC,IAE3DqG,KAAKqyC,iBAAmB,CACtB7yC,KAAM,YACN2B,GAAI8zB,EAAQwxB,kBAAkBlkB,MAAMphC,GAExC,CAKAulD,uBAAAA,GAGE,GACE5qD,OAAOC,OAAO6G,gBAAgB+jD,OAAOC,cACpCC,EAAAA,EAAAA,SAAQ/qD,OAAOC,OAAO6G,gBAAgB+jD,OAAOC,YAC9C,CACA,IACE5mD,KAAK6lD,qBAAuB9D,EAAAA,GAAqB1oD,MAC/CyC,OAAOC,OAAO6G,gBAAgB+jD,OAAOC,W,CAEvC,MAAOnrD,GACP,MAAM+f,GAAehgB,EAAAA,EAAAA,GACnBC,EACAK,OAAOC,OAAO6G,gBAAgB+jD,OAAOC,YAOvC,MALAhtD,QAAQoS,MAAMwP,EAAc/f,GAC5B7B,QAAQoS,MACN,cACAlQ,OAAOC,OAAO6G,gBAAgB+jD,OAAOC,YAEjC,IAAI5sD,MAAMwhB,EAAc,CAAEsrC,MAAOrrD,G,CAEzCuE,KAAK0lD,cAAgB,CACnB,CAAEnsD,eAAgByG,KAAK6lD,qBAAsBlsD,UAAW,CAAC,G,CAG7DqG,KAAK8lD,iBAAmBhqD,OAAOC,OAAO6G,gBAAgB+jD,OAAOzlD,KAC7DlB,KAAK+lD,eAAiBjqD,OAAOC,OAAO6G,gBAAgBojD,SACpDhmD,KAAKwkD,WAAa1oD,OAAOC,OAAO6G,gBAAgB+jD,OAAOzlD,KACvDlB,KAAKgmD,SAAWlqD,OAAOC,OAAO6G,gBAAgBojD,SAC9ChmD,KAAKqyC,iBAAmB,CACtB7yC,KAAM,oBACN2B,GAAIrF,OAAOC,OAAO6G,gBAAgB+jD,OAAOjC,UAE7C,CAGAqC,aAAAA,GACE/mD,KAAKgnD,WAAa,CAAEvc,OAAQ,SAC9B,CAGAwc,WAAAA,CAAYhyB,GACVj1B,KAAKgnD,WAAa,CAAEvc,OAAQ,SAC5BzqC,KAAK6lD,qBAAuB5wB,EAAQ17B,eACpCyG,KAAK8lD,iBAAmB7wB,EAAQuvB,WAChCxkD,KAAK+lD,eAAiB9wB,EAAQ+wB,QAChC,CAGAkB,WAAAA,CAAYl7C,GACVhM,KAAKgnD,WAAa,CAAEvc,OAAQ,QAASz+B,SACrChM,KAAKmnD,eAAe3lD,KAClB,sEAEF5H,QAAQC,IAAImS,EACd,CAGM,cAAAu4C,GACJ,GAA+B,WAA3BvkD,KAAKgnD,WAAWvc,OAApB,CAGAzqC,KAAKulC,QAAQ6hB,OAAO,iBACpB,IACE,MAAMC,QAAmB9C,EAAAA,EAAAA,IACvBvkD,KAAKzG,eACLyG,KAAKwkD,WACLxkD,KAAKgmD,SACLlqD,OAAOC,OAAO6G,gBAAgB+jD,OAAOjC,UACrC5oD,OAAOC,OAAO6G,gBAAgB+hD,gBAE1BS,EAAM,KACZplD,KAAKulC,QAAQ6hB,OAAO,cAAeC,E,CACnC,MAAOr7C,GACPhM,KAAKulC,QAAQ6hB,OAAO,cAAe,CAAEp7C,S,EAEzC,CAaAvS,WAAAA,CAAYw7B,GAILA,EAAQt7B,YACXs7B,EAAQt7B,UAAY,CAAC,GAEvB,MAAM2tD,EAAuBtnD,KAAK0lD,cAAc1lD,KAAK2lD,eACrD,IACEtuC,EAAAA,EAAAA,SAAQiwC,EAAqB/tD,eAAgB07B,EAAQv7B,mBAErD,OAEF,MAAM6tD,IACHlwC,EAAAA,EAAAA,SAAQ4d,EAAQt7B,UAAW,CAAC,KAC7B0d,EAAAA,EAAAA,SAAQ4d,EAAQt7B,UAAW2tD,EAAqB3tD,WAC9C4tD,GAEFD,EAAqB/tD,eAAiB07B,EAAQv7B,kBAC9CsG,KAAK0lD,cAAgB1lD,KAAK0lD,cAAc8B,MAAM,EAAGxnD,KAAK2lD,cAAgB,KAGtE3lD,KAAK0lD,cAAgB1lD,KAAK0lD,cACvB8B,MAAM,EAAGxnD,KAAK2lD,cAAgB,GAC9BjpB,OAAO,CACN,CACEnjC,eAAgB07B,EAAQv7B,kBACxBC,UAAWs7B,EAAQt7B,aAGzBqG,KAAK2lD,eAAiB,EAE1B,CAGA8B,aAAAA,CAAcvmD,GACZlB,KAAKwkD,WAAatjD,CACpB,CAGAwmD,WAAAA,CAAY9uD,GACVoH,KAAKgmD,SAAWptD,CAClB,GA3MA+uD,EAAA,CADCC,EAAAA,IAAQ,yBA6BTD,EAAA,CADCC,EAAAA,IAAQ,yBAyBTD,EAAA,CADCC,EAAAA,IAAQ,yCAmBTD,EAAA,CADCC,EAAAA,IAAQ,4CAuCTD,EAAA,CADCC,EAAAA,IAAQ,kCAMTD,EAAA,CADCC,EAAAA,IAAQ,gCASTD,EAAA,CADCC,EAAAA,IAAQ,gCAUHD,EAAA,CADLE,EAAAA,IAAM,6BAgCPF,EAAA,CADCC,EAAAA,IAAQ,gCAoCTD,EAAA,CADCC,EAAAA,IAAQ,kCAMTD,EAAA,CADCC,EAAAA,IAAQ,gCA/OErC,EAAgBoC,EAAA,EAD5BG,EAAAA,EAAAA,IAAO,CAAE5mD,KAAM,gBACHqkD,G,4UC5CN,IAAMwC,EAAN,cAAoCvC,EAAAA,GAAUpc,WAAAA,IAAAxsC,GAAA,SAAAA,IAAA6oD,EAAAA,EAAAA,GAAA,qBAC3B,IAAKA,EAAAA,EAAAA,GAAA,qBACJ,CACvBtkD,GAAI,GACJ3B,KAAM,IACP,CAMDwoD,eAAAA,CAAgBC,GACdjoD,KAAKkoD,aAAeD,CACtB,CAGAE,SAAAA,GACEvuD,QAAQC,IAAI,qDAKZ,MAAMN,EAAiBH,KAAKC,MAC1BD,KAAKE,UAAUb,EAAgBc,iBAEjCuC,OAAOqgB,OAAOisC,YAAY,CACxB5oD,KAAM,sBACNjG,kBAEJ,CAGA8uD,aAAAA,GACEzuD,QAAQC,IAAI,yDAIZiC,OAAOqgB,OAAOisC,YAAY,CACxB5oD,KAAM,gCAEV,CAGA8oD,UAAAA,CAAW/iB,GACTvlC,KAAKymC,cAAgBlB,CACvB,GAlCAoiB,EAAA,CADCC,EAAAA,IAAQ,oCAMTD,EAAA,CADCC,EAAAA,IAAQ,8BAiBTD,EAAA,CADCC,EAAAA,IAAQ,kCAYTD,EAAA,CADCC,EAAAA,IAAQ,+BA1CEG,EAAqBJ,EAAA,EADjCG,EAAAA,EAAAA,IAAO,CAAE5mD,KAAM,qBACH6mD,G,4UCFN,IAAMQ,EAAN,cAAiC/C,EAAAA,GAAUpc,WAAAA,IAAAxsC,GAAA,SAAAA,IAAA6oD,EAAAA,EAAAA,GAAA,aACZ,KAAEA,EAAAA,EAAAA,GAAA,cAC7B,IAACA,EAAAA,EAAAA,GAAA,qBACM,IAACA,EAAAA,EAAAA,GAAA,aACT,EAAC,CAIT+C,UAAAA,CAAWzE,GACT/jD,KAAKyoD,MAAMjnD,KAAKuiD,EAClB,CAIA2E,eAAAA,GACE1oD,KAAK2oD,QACP,CAGAC,eAAAA,GACE5oD,KAAK2oD,QACP,CAIM,kBAAAE,GACJ,GAAI7oD,KAAK2oD,QAAU3oD,KAAK8oD,cAItB,YAHAlvD,QAAQ8I,MACN,iCAAiC1C,KAAK8oD,oCAAoC9oD,KAAK2oD,yBAAyB3oD,KAAKyoD,MAAMn+C,UAKvH,GAA0B,IAAtBtK,KAAKyoD,MAAMn+C,OAEb,YADA1Q,QAAQ8I,MAAM,oCAAoC1C,KAAK2oD,UAIzD,MAAM5E,EAAU/jD,KAAKyoD,MAAMM,QAC3B,GAAIhF,EAAS,CACX/jD,KAAKulC,QAAQ6hB,OAAO,mBAEpB,UACQrD,G,CACN,QACA/jD,KAAKulC,QAAQ6hB,OAAO,mBAEhBpnD,KAAKgpD,aACD,IAAI5oC,SAASC,GAAYnY,WAAWmY,EAASrgB,KAAKgpD,eAGpDhpD,KAAK6oD,c,EAGjB,CAIM,aAAA7oC,CAAQ+jC,GACZ/jD,KAAKulC,QAAQ6hB,OAAO,aAAcrD,SAC5B/jD,KAAK6oD,cACb,GArDAlB,EAAA,CADCC,EAAAA,IAAQ,+BAOTD,EAAA,CADCC,EAAAA,IAAQ,oCAMTD,EAAA,CADCC,EAAAA,IAAQ,oCAOHD,EAAA,CADLE,EAAAA,IAAM,iCAkCDF,EAAA,CADLE,EAAAA,IAAM,4BAzDIU,EAAkBZ,EAAA,EAD9BG,EAAAA,EAAAA,IAAO,CAAE5mD,KAAM,kBACHqnD,G,aCFb,SAASU,EAAkBC,GACzB,OAAOnuD,OAAOic,KAAKkyC,GAChBrgD,KAAKg0B,GAAM,UAAUA,MAAMssB,mBAAmBD,EAAIrsB,QAClD/jC,KAAK,IACV,CAEA,MAAMswD,EAAkBA,CAACC,EAAgB,CAAC,IACxCtuD,OAAOic,KAAKqyC,GACT1jD,QAAQk3B,GAAkC,qBAArBwsB,EAAcxsB,KACnCh0B,KAAKg0B,GAAM,GAAGA,KAAKssB,mBAAmBE,EAAcxsB,QACpD/jC,KAAK,KAEJwwD,EAAqBA,EAAGntC,SAAQC,mBACpC,MAAMmtC,EAAW,GAAGptC,EAAO3c,QAAQ2c,EAAOhb,MAAMib,IAEhD,OACED,EAAO+pB,eACPnrC,OAAOic,KAAKmF,EAAO+pB,eAAe54B,SAAS8O,GAEpCD,EAAO+pB,cAAc9pB,GAAcgoC,OAAOoF,SAAWD,EAEvDA,CAAQ,EAGXE,EAAenf,GAAaA,EAASzqC,KAErC6pD,EAAwB19C,IAC5B,MAAIA,GAASA,EAAMs+B,SACXt+B,EAAMs+B,SAENt+B,CACR,EAGF,MAAM29C,EACJvgB,WAAAA,EAAY,KAAEloC,EAAI,WAAEsiD,IAClBxjD,KAAKkB,KAAOA,EACZlB,KAAK4pD,IAAMpG,CACb,CAEAqG,GAAAA,EAAI,QAAEltC,EAAU,CAAC,GAAM,CAAC,GACtB,IAAIsV,EAQJ,OANItV,EAAQsV,MACPA,OAAQtV,GAEXsV,EAAM,GAAGjyB,KAAKkB,QAAQkoD,EAAgBzsC,KAGjC3c,KAAK4pD,IAAIzmD,IAAI8uB,GAAK/U,KAAKusC,GAAarsC,MAAMssC,EACnD,CAEAztD,IAAAA,EAAK,GAAEkF,EAAE,QAAEwb,GAAY,CAAC,GACtB,MAAMsV,EAAM,GAAGjyB,KAAKkB,QAAQC,KAAMioD,EAAgBzsC,KAElD,OAAO3c,KAAK4pD,IAAIzmD,IAAI8uB,GAAK/U,KAAKusC,GAAarsC,MAAMssC,EACnD,CAEAI,KAAAA,EAAM,OAAEnkD,EAAM,QAAEgX,GAAY,CAAC,GAC3B,MAAMotC,EAAcd,EAAkBtjD,GACtC,OAAO3F,KAAK4pD,IACTzmD,IAAI,GAAGnD,KAAKkB,QAAQ6oD,KAAeX,EAAgBzsC,MACnDO,KAAKusC,GACLrsC,MAAMssC,EACX,CAEAF,OAAAA,EAAQ,OAAErtC,EAAM,aAAEC,EAAepc,KAAKkB,KAAI,QAAEyb,IAC1C,MAAM0sB,EAAUigB,EAAmB,CAAEntC,SAAQC,iBACvC6V,EAAM,GAAGoX,KAAW+f,EAAgBzsC,KAC1C,OAAO3c,KAAK4pD,IAAIzmD,IAAI8uB,GAAK/U,KAAKusC,GAAarsC,MAAMssC,EACnD,CAEAhG,MAAAA,CAAOsG,GACL,MAAMpW,EAAS74C,OAAOkvD,OAAO,CAAC,EAAGD,EAAe,CAAExqD,KAAMQ,KAAKkB,OACvDgpD,EAAc,CAAErqD,KAAM+zC,GAC5B,OAAO5zC,KAAK4pD,IACT1c,KAAK,GAAGltC,KAAKkB,OAAQgpD,GACrBhtC,KAAKusC,GACLrsC,MAAMssC,EACX,CAEAS,aAAAA,CAAcH,GACZ,MAAMpW,EAAS74C,OAAOkvD,OAAO,CAAC,EAAGD,EAAe,CAAExqD,KAAMQ,KAAKkB,OACvDgpD,EAAc,CAAErqD,KAAM+zC,GAC5B,OAAO5zC,KAAK4pD,IACT1c,KAAK,GAAGltC,KAAKkB,OAAQgpD,GACrBhtC,KAAKusC,GACLrsC,MAAMssC,EACX,CAEAU,mBAAAA,CAAoBjuC,EAAQC,EAAciuC,GAExC,MAAMH,EAAc,CAAErqD,KAAMwqD,GAC5B,OAAOrqD,KAAK4pD,IACTU,MACC,GAAGnuC,EAAO3c,QAAQ2c,EAAOhb,oBAAoBib,IAC7C8tC,GAEDhtC,KAAKusC,GACLrsC,MAAMssC,EACX,CAEAa,mBAAAA,CAAoBpuC,EAAQC,EAAciuC,GAExC,MAAMH,EAAc,CAAErqD,KAAMwqD,GAC5B,OAAOrqD,KAAK4pD,IACT1c,KACC,GAAG/wB,EAAO3c,QAAQ2c,EAAOhb,oBAAoBib,IAC7C8tC,GAEDhtC,KAAKusC,GACLrsC,MAAMssC,EACX,CAEAc,mBAAAA,CAAoBruC,EAAQC,EAAciuC,GAExC,MAAMH,EAAc,CAAErqD,KAAMwqD,GAC5B,OAAOrqD,KAAK4pD,IACTze,OACC,GAAGhvB,EAAO3c,QAAQ2c,EAAOhb,oBAAoBib,IAC7C8tC,GAEDhtC,KAAKusC,GACLrsC,MAAMssC,EACX,CAEAtlC,MAAAA,CAAOwvB,GAEL,MAAMsW,EAAc,CAAErqD,KAAM+zC,GAC5B,OAAO5zC,KAAK4pD,IACTU,MAAM,GAAGtqD,KAAKkB,QAAQ0yC,EAAOzyC,KAAM+oD,GACnChtC,KAAKusC,GACLrsC,MAAMssC,EACX,CAEAve,QAAO,GAAEhqC,IACP,OAAOnB,KAAK4pD,IAAIze,OAAO,GAAGnrC,KAAKkB,QAAQC,KAAMic,MAAMssC,EACrD,EAGF,QCzIA,MAAMe,EAAiB,UACjBC,EAAiB,UACjBC,EAAe,QACfC,EAAiB,UAEjBC,EAAeR,GAAaS,IAChC,MAAMC,EAAiBV,EAAQpuD,MAAMmqB,GAAMA,EAAEjlB,KAAO2pD,EAAU3pD,KAC1D4pD,EACFhwD,OAAOkvD,OAAOc,EAAgBD,GAE9BT,EAAQ7oD,KAAKspD,EACf,EAGIE,EAAyBC,GACxBA,EAIE,CACLzrD,KAAMyrD,EAASzrD,KACf2B,GAAI8pD,EAAS9pD,IALN8pD,EASLC,EAAuB9uC,IAC3B,MAAMvc,EAAOwL,MAAMw7C,QAAQzqC,EAAavc,MACpCuc,EAAavc,KAAK,GAClBuc,EAAavc,KAEjB,OAAOA,GAAQA,EAAKL,IAAI,EAGpB2rD,EAAgBA,EAAG9b,YAAYxkC,KACnC,GAAIA,EAAOugD,SAAU,CAEnBvgD,EAAOugD,SAASzzD,SAAS0zD,IACvB,MAAMC,EAAS,GAAGD,EAAc7rD,mBAChC6vC,EAASic,EAAQD,EAAe,CAAEnoC,MAAM,GAAO,IAIjD,IAAIqoC,EAAa,IAAI1gD,EAAOugD,UAE1BG,EADElgD,MAAMw7C,QAAQh8C,EAAOhL,MACV,IAAI0rD,KAAe1gD,EAAOhL,MAE1B,IAAI0rD,EAAY1gD,EAAOhL,MAGtC0rD,EAAW5zD,SAAS6zD,IACdA,EAActlB,eAChBnrC,OAAOic,KAAKw0C,EAActlB,eAAevuC,SAAS8zD,IAChD,MAAMrvC,EAAeovC,EAActlB,cAAculB,GACjD,IAAKrvC,EAAavc,MAAqC,IAA7Buc,EAAavc,KAAKyK,OAC1C,OAGF,MAAM9K,EAAO0rD,EAAoB9uC,GACjC,IAAIsvC,EACArgD,MAAMw7C,QAAQzqC,EAAavc,MAC7B6rD,EAAatvC,EAAavc,KAAKgJ,KAC5BwiD,GAAkBA,EAAclqD,OAGhCA,GAAIuqD,GAAetvC,EAAavc,MAErC,MAAM8c,EAAU,CACd+uC,aACAjvC,OAAQ,CACNN,OAAQ6uC,EAAsBQ,GAC9BpvC,aAAcqvC,IAGZH,EAAS,GAAG9rD,iBAClB6vC,EAASic,EAAQ3uC,EAAS,CAAEuG,MAAM,GAAO,GAE7C,GAEJ,GAGIyoC,EAAWC,GAAcxhB,GAC7BrvC,OAAOic,KAAK40C,GAAUz0C,OAAOpW,IAAQsW,EAAAA,EAAAA,SAAQu0C,EAAS7qD,GAAMqpC,EAAKrpC,MAE7D8qD,EAAezE,GAAY0E,IAG/B,MAFA1E,EAAO,aAAcuD,GACrBvD,EAAO,cAAe0E,GAChBA,CAAa,EAGfC,EAAeA,KAAA,CACnB1B,QAAS,GACTb,QAAS,GACTwC,SAAU,GACVC,KAAM,GACNjgD,MAAO,KACPy+B,OAAQggB,EACRrG,MAAO,CAAC,EACR8H,YAAa,KACbC,SAAU,OAGNC,EAAiBA,EAAGlrD,KAAMmrD,EAAc7I,iBAC5C,MAAM8I,EAAS,IAAIC,EAAe,CAAErrD,KAAMmrD,EAAc7I,eAElDgJ,EAAwB/vC,IAC5B,MAAM,OAAEN,EAAM,aAAEC,EAAeiwC,GAAiB5vC,EAC1CgwC,EAA2BzB,EAAsB7uC,GAEvD,MAAO,CACLA,OAAQswC,EACRrwC,eACD,EAGH,MAAO,CACLswC,YAAY,EAEZzE,MAAO8D,EAEPY,UAAW,CACTC,oBAAqBA,CAAC3E,EAAOoC,KAC3BpC,EAAMoC,QAAUA,CAAO,EAGzBwC,oBAAqBA,CAAC5E,EAAOuB,KAC3BvB,EAAMuB,QAAUA,CAAO,EAGzBsD,WAAYA,CAAC7E,EAAOxd,KAClBwd,EAAMxd,OAASA,CAAM,EAGvBsiB,aAAcA,CAAC9E,EAAO6C,KACpB,MAAM,QAAET,GAAYpC,EAEpB4C,EAAYR,EAAZQ,CAAqBC,EAAU,EAGjCkC,cAAeA,CAAC/E,EAAOgF,KACrB,MAAM,QAAE5C,GAAYpC,EAEpBgF,EAAWt1D,QAAQkzD,EAAYR,GAAS,EAG1C6C,WAAYA,CAACjF,EAAOoC,KAClBpC,EAAMgE,KAAO5B,EAAQxhD,KAAI,EAAG1H,QAASA,GAAG,EAG1CgsD,WAAYA,CAAClF,EAAO3zB,KAClB2zB,EAAMkE,SAAW73B,CAAI,EAGvB84B,YAAaA,CAACnF,EAAOj8C,KACnBi8C,EAAMj8C,MAAQA,CAAK,EAGrBqhD,cAAeA,CAACpF,GAASyD,aAAYjvC,SAAQ6wC,gBAAe,MAC1D,MAAM,QAAE9D,GAAYvB,EACdsF,EAAoBf,EAAqB/vC,GACzCsuC,EAAiBvB,EAAQvtD,KAAK0vD,EAAQ4B,IAC5C,GAAIxC,EACF,GAAIuC,EACFvC,EAAeW,WAAaA,MACvB,CACL,MAAM8B,EAAM,IAAItjC,IAAI,IAAI6gC,EAAeW,cAAeA,IACtDX,EAAeW,WAAa,IAAI8B,EAClC,MAEAhE,EAAQhoD,KAAKzG,OAAOkvD,OAAO,CAAEyB,cAAc6B,GAC7C,EAGFE,eAAgBA,CAACxF,GAASyF,aAAYjxC,aACpC,MAAM,SAAEuvC,GAAa/D,EAEf8C,EAAiBiB,EAAS/vD,KAAK0vD,EAAQlvC,IACzCsuC,EACFA,EAAe2C,WAAaA,EAE5B1B,EAASxqD,KAAKzG,OAAOkvD,OAAO,CAAEyD,cAAcjxC,GAC9C,EAGFkxC,mBAAoBA,CAAC1F,EAAOrU,KAC1BqU,EAAMiE,YAActY,CAAM,EAG5Bga,cAAeA,CAAC3F,EAAOrU,KACrBqU,EAAMoC,QAAUpC,EAAMoC,QAAQ1kD,QAAQygB,GAAMA,EAAEjlB,KAAOyyC,EAAOzyC,IAAG,EAGjE0sD,UAAWA,CAAC5F,EAAO7D,KACjB6D,EAAM7D,MAAQA,GAAS,CAAC,CAAC,EAG3B0J,YAAc7F,IACZltD,OAAOkvD,OAAOhC,EAAO8D,IAAe,GAIxCgC,QAAS,CACPC,OAAAA,EAAQ,OAAE5G,EAAM,SAAE/X,IAAY,QAAE1yB,GAAY,CAAC,GAE3C,OADAyqC,EAAO,aAAcsD,GACd4B,EACJzC,IAAI,CAAEltC,YACNO,MAAMrS,IACLu8C,EAAO,aAAcwD,GACrBxD,EAAO,sBAAuBv8C,EAAOhL,MACrCunD,EAAO,aAAcv8C,EAAOypB,MAC5B62B,EAAc,CAAE/D,SAAQ/X,YAAYxkC,EAAO,IAE5CuS,MAAMyuC,EAAYzE,GACvB,EAEA6G,QAAAA,EAAS,OAAE7G,EAAM,SAAE/X,IAAY,GAAEluC,EAAE,QAAEwb,IAEnC,OADAyqC,EAAO,aAAcsD,GACd4B,EACJrwD,KAAK,CAAEkF,KAAIwb,YACXO,MAAMgxC,IACL9G,EAAO,aAAcwD,GACrBxD,EAAO,eAAgB8G,EAAQruD,MAC/BunD,EAAO,aAAc8G,EAAQ55B,MAC7B62B,EAAc,CAAE/D,SAAQ/X,YAAY6e,EAAQ,IAE7C9wC,MAAMyuC,EAAYzE,GACvB,EAEA+G,SAAAA,EAAU,OAAE/G,EAAM,SAAE/X,GAAY5yB,GAC9B,MAAM,OAAE9W,EAAM,QAAEgX,GAAYF,EAE5B,OADA2qC,EAAO,aAAcsD,GACd4B,EACJxC,MAAM,CAAEnkD,SAAQgX,YAChBO,MAAMgxC,IACL9G,EAAO,aAAcwD,GACrB,MAAMe,EAAUuC,EAAQruD,KAClB6tD,EAAa/B,EAAQ9iD,KAAK+qC,GAAWA,EAAOzyC,KAClDimD,EAAO,gBAAiBuE,GACxBvE,EAAO,iBAAkB,CAAE3qC,SAAQixC,eACnCtG,EAAO,aAAc8G,EAAQ55B,MAC7B62B,EAAc,CAAE/D,SAAQ/X,YAAY6e,EAAQ,IAE7C9wC,MAAMyuC,EAAYzE,GACvB,EAEAgH,QAAAA,EAAS,OAAEhH,EAAM,SAAE/X,IAAY,QAAE1yB,IAE/B,OADAyqC,EAAO,aAAcsD,GACd4B,EACJzC,IAAI,CAAEltC,YACNO,MAAMotB,IACL8c,EAAO,aAAcwD,GACrBxD,EAAO,gBAAiB9c,EAASzqC,MACjCunD,EAAO,aAAc9c,EAASzqC,MAC9BunD,EAAO,aAAc9c,EAAShW,MAC9B8yB,EAAO,YAAa9c,EAAS8Z,OAC7B+G,EAAc,CAAE/D,SAAQ/X,YAAY/E,EAAS,IAE9CltB,MAAMyuC,EAAYzE,GACvB,EAEAiH,YAAAA,EAAa,OAAEjH,EAAM,MAAEa,EAAK,SAAE5Y,IAC5B,MAAM1yB,EAAU,CACdsV,IAAKg2B,EAAM7D,MAAMkK,MAEnB,OAAOhC,EAAOzC,IAAI,CAAEltC,YAAWO,MAAMotB,IACnC8c,EAAO,gBAAiB9c,EAASzqC,MACjCunD,EAAO,aAAc9c,EAASzqC,MAC9BunD,EAAO,YAAa9c,EAAS8Z,OAC7BgD,EAAO,aAAc9c,EAAShW,MAC9B62B,EAAc,CAAE/D,SAAQ/X,YAAY/E,EAAS,GAEjD,EAEAikB,gBAAAA,EAAiB,OAAEnH,EAAM,MAAEa,EAAK,SAAE5Y,IAChC,MAAM1yB,EAAU,CACdsV,IAAKg2B,EAAM7D,MAAMoK,MAEnB,OAAOlC,EAAOzC,IAAI,CAAEltC,YAAWO,MAAMotB,IACnC8c,EAAO,gBAAiB9c,EAASzqC,MACjCunD,EAAO,aAAc9c,EAASzqC,MAC9BunD,EAAO,YAAa9c,EAAS8Z,OAC7BgD,EAAO,aAAc9c,EAAShW,MAC9B62B,EAAc,CAAE/D,SAAQ/X,YAAY/E,EAAS,GAEjD,EAEAmkB,WAAAA,EAAY,OAAErH,EAAM,SAAE/X,GAAY5yB,GAChC,MAAM,OACJN,EAAM,aACNC,EAAeiwC,EAAY,QAC3B1vC,EAAO,aACP2wC,GAAe,GACb7wC,EACJ2qC,EAAO,aAAcsD,GACrB,MAAMgE,EAAgB,IACjBjyC,EACHL,gBAEF,OAAOkwC,EACJ9C,QAAQ,CAAErtC,SAAQC,eAAcO,YAChCO,MAAMgxC,IAEL,GADA9G,EAAO,aAAcwD,GACjBv/C,MAAMw7C,QAAQqH,EAAQruD,MAAO,CAC/B,MAAM8uD,EAAiBT,EAAQruD,KACzB6rD,EAAaiD,EAAe9lD,KAAK+qC,GAAWA,EAAOzyC,KACzDimD,EAAO,gBAAiBuH,GACxBvH,EAAO,gBAAiB,CACtB3qC,OAAQiyC,EACRhD,aACA4B,gBAEJ,KAAO,CACL,MAAM1Z,EAASsa,EAAQruD,KACjB6rD,EAAa9X,EAAOzyC,GAC1BimD,EAAO,gBAAiB,CAACxT,IACzBwT,EAAO,gBAAiB,CAAE3qC,OAAQiyC,EAAehD,cACnD,CACAtE,EAAO,aAAc8G,EAAQ55B,MAC7B62B,EAAc,CAAE/D,SAAQ/X,YAAY6e,EAAQ,IAE7C9wC,MAAMyuC,EAAYzE,GACvB,EAEA1D,MAAAA,EAAO,OAAE0D,GAAUwH,GACjB,OAAOtC,EAAO5I,OAAOkL,GAAY1xC,MAAMrS,IACrCu8C,EAAO,eAAgBv8C,EAAOhL,MAC9BunD,EAAO,qBAAsBv8C,EAAOhL,KAAK,GAE7C,EAEAukB,MAAAA,EAAO,OAAEgjC,EAAM,SAAE/X,EAAQ,QAAEnB,GAAW0F,GACpC,OAAO0Y,EAAOloC,OAAOwvB,GAAQ12B,MAAK,EAAGrd,KAAMirD,MACzC,MAAM+D,EAAY3gB,EAAQ4gB,KAAK,CAAE3tD,GAAIyyC,EAAOzyC,KAG5C,GAAI0tD,GAAaA,EAAU3oB,cACzB,IAAK,MAAMnlB,KAAShmB,OAAO8e,QAAQg1C,EAAU3oB,eAAgB,CAC3D,MAAO9pB,EAAc2yC,GAAUhuC,EACzBvhB,EAAO0rD,EAAoB6D,GAC3BL,EAAgB,CACpBtyC,eACAD,OAAQ6uC,EAAsB6D,IAMnB,OAATrvD,QAA0BlE,IAATkE,GAIrB6vC,EACE,GAAG7vC,iBACH,CACEid,OAAQiyC,EACRhD,WAAY,MAEd,CAAExoC,MAAM,GAEZ,CAOF,GAHAkkC,EAAO,eAAgB0D,GAGnBA,EAAU5kB,cACZ,IAAK,MAAM9pB,KAAgBrhB,OAAOic,KAAK8zC,EAAU5kB,eAAgB,CAC/D,MAAM8oB,EAAqBlE,EAAU5kB,cAAc9pB,IAC7C,KAAEvc,GAASmvD,EACXC,EACJ5jD,MAAMw7C,QAAQhnD,IAAS0mC,QAAQ1mC,EAAKyK,QAChC4kD,EAAW3oB,QAAQ1mC,GAAQA,EAAKL,MAAQK,EAAKsB,IAEnD,GAAI8tD,GAAmBC,EAAU,CAC/B,MAAMR,EAAgB,CACpBvyC,OAAQ6uC,EAAsBF,GAC9B1uC,gBAEI5c,EAAO0rD,EAAoB8D,GACjC,IAAItD,EAEFA,EADErgD,MAAMw7C,QAAQhnD,GACHA,EAAKgJ,KAAK+qC,GAAWA,EAAOzyC,KAE5BtB,EAAKsB,GAEpBkuC,EACE,GAAG7vC,iBACH,CACEid,OAAQiyC,EACRhD,cAEF,CAAExoC,MAAM,GAEZ,CACF,CACF,GAEJ,EAEAioB,QAAO,OAAEic,GAAUxT,GACjB,OAAO0Y,EAAOnhB,OAAOyI,GAAQ12B,MAAK,KAChCkqC,EAAO,gBAAiBxT,EAAO,GAEnC,EAEAiX,WAAAA,EAAY,OAAEzD,GAAUxT,GACtBwT,EAAO,eAAgBxT,EACzB,EAEAub,YAAAA,EAAa,OAAE/H,IAAU,WAAEsE,EAAU,OAAEjvC,IACrC2qC,EAAO,gBAAiB,CACtBsE,aACAjvC,UAEJ,EAEA2yC,YAAAA,EAAa,OAAEhI,GAAUxT,GACvBwT,EAAO,gBAAiBxT,EAC1B,EAEAyb,UAAAA,EAAW,OAAEjI,IACXA,EAAO,cACT,EAEAkI,UAAAA,EAAW,QAAEphB,GAAWzxB,GACtB,MAAM,OAAEN,EAAM,aAAEC,EAAeiwC,EAAY,KAAExsD,GAAS4c,EAChD8yC,EAAerhB,EAAQsb,QAAQ/sC,GAAQ5T,KAAKnO,GAAMA,EAAEyG,KACpDw4B,EAAa95B,EAAK8F,QAAQhI,IAAO4xD,EAAajiD,SAAS3P,KACvD0sD,EAAU1wB,EAAW9wB,KAAK1H,IACvB,CAAE3B,KAAM4c,EAAcjb,SAE/B,OAAOmrD,EAAO/B,oBAAoBpuC,EAAQC,EAAciuC,EAC1D,EAEAmF,UAAAA,EAAW,OAAEpI,GAAU3qC,GACrB,MAAM,OAAEN,EAAM,aAAEC,EAAeiwC,EAAY,KAAExsD,GAAS4c,EACtD,OAAO6vC,EACJlC,oBAAoBjuC,EAAQC,EAAcvc,GAC1Cqd,MAAK,KACJ,IAAIwuC,EAEFA,EADErgD,MAAMw7C,QAAQhnD,GACHA,EAAKgJ,KAAK+qC,GAAWA,EAAOzyC,KACvB,OAATtB,EACI,KAEAA,EAAKsB,GAEpBimD,EAAO,gBAAiB,CACtB3qC,OAAQ,CAAEN,SAAQC,gBAClBsvC,cACA,GAER,EAEA+D,aAAAA,EAAc,OAAErI,GAAU3qC,GACxB,MAAM,OAAEN,EAAM,aAAEC,EAAeiwC,EAAY,KAAExsD,GAAS4c,EAEtD,IAAIivC,EADJY,EAAO9B,oBAAoBruC,EAAQC,EAAcvc,GAG/C6rD,EADErgD,MAAMw7C,QAAQhnD,GACHA,EAAKgJ,KAAK+qC,GAAWA,EAAOzyC,KAE5BtB,EAAKsB,GAEpBimD,EAAO,iBAAkB,CACvB3qC,OAAQ,CAAEN,SAAQC,gBAClBsvC,cAEJ,EAEAgE,gBAAAA,EAAiB,OAAEtI,GAAU3qC,GAC3B,MAAM,OAAEN,EAAM,aAAEC,EAAeiwC,GAAiB5vC,EAChD6vC,EAAOlC,oBAAoBjuC,EAAQC,EAAc,IACjDgrC,EAAO,iBAAkB,CACvB3qC,OAAQ,CAAEN,SAAQC,gBAClBsvC,WAAY,IAEhB,GAGFxd,QAAS,CACPyhB,UAAY1H,GAAUA,EAAMxd,SAAWigB,EACvCkF,QAAU3H,GAAUA,EAAMxd,SAAWkgB,EACrC3+C,MAAQi8C,GAAUA,EAAMj8C,MACxB6jD,YAAc5H,KAAYA,EAAM7D,MAAMoK,KACtCsB,QAAU7H,KAAYA,EAAM7D,MAAMkK,KAClCzE,IAAM5B,GAAUA,EAAMoC,QACtB6B,YAAcjE,GAAUA,EAAMiE,YAC9B4C,KACG7G,GACD,EAAG9mD,QACD8mD,EAAMoC,QAAQpuD,MAAMmqB,GAAMA,EAAEjlB,IAAMA,IACtCgrD,SAAWlE,GAAUA,EAAMkE,SAC3BF,KAAOhE,GACLA,EAAMgE,KAAKpjD,KAAK1H,GACd8mD,EAAMoC,QAAQpuD,MAAM23C,GAAWA,EAAOzyC,KAAOA,MAEjD2oD,MAAQ7B,GAAWxrC,IACjB,MAAMsE,EAAQknC,EAAM+D,SAAS/vD,KAAK0vD,EAAQlvC,IAE1C,IAAKsE,EACH,MAAO,GAGT,MAAMysC,EAAMzsC,EAAM2sC,WAClB,OAAOF,EAAI3kD,KAAK1H,GACd8mD,EAAMoC,QAAQpuD,MAAM23C,GAAWA,EAAOzyC,KAAOA,KAC9C,EAEHqoD,QAAUvB,GAAWxrC,IACnB,MAAM8wC,EAAoBf,EAAqB/vC,GACzC+sC,EAAUvB,EAAMuB,QAAQvtD,KAAK0vD,EAAQ4B,IAE3C,GAAK/D,EAEE,IAAIn+C,MAAMw7C,QAAQ2C,EAAQkC,YAAa,CAC5C,MAAM8B,EAAMhE,EAAQkC,WACpB,OAAO8B,EACJ3kD,KAAK1H,GAAO8mD,EAAMoC,QAAQpuD,MAAM23C,GAAWA,EAAOzyC,KAAOA,MACzDwE,QAAQiuC,QAAsBt4C,IAAXs4C,GACxB,CAAO,CACL,MAAMzyC,EAAKqoD,EAAQkC,WACnB,OAAOzD,EAAMoC,QAAQpuD,MAAM23C,GAAWzyC,IAAOyyC,EAAOzyC,IACtD,EATE,OAAO,IAST,GAGL,EAGG4uD,EAAqBA,EAAGC,QAAOxM,gBACnCwM,EAAMp1D,QACJ,CAACq1D,EAAK/uD,IACJnG,OAAOkvD,OAAO,CAAE,CAAC/oD,GAAOkrD,EAAe,CAAElrD,OAAMsiD,gBAAiByM,IAClE,CAAC,GCjhBQn2D,GAAQo2D,EAAAA,EAAAA,IAAY,CAC/BC,QAAS,CACP1tD,WAAY8iD,EACZ6K,gBAAiBrI,EACjBsI,aAAc9H,KAEXwH,EAAmB,CACpBC,MAAO,CACL,UACA,qBACA,oBACA,4BACA,4BACA,wBACA,wBACA,uBACA,0BACA,iCACA,yCACA,yCACA,2BACA,yBACA,mBACA,uBACA,8BACA,6BACA,mBACA,QACA,YACA,UACA,YACA,gBACA,QACA,aACA,wBACA,YACA,cACA,YACA,eACA,kBACA,oBACA,oCACA,wCAEFxM,WAAUA,EAAAA,QAMH/qD,GAAkB63D,EAAAA,EAAAA,IAAU/K,EAAkBzrD,GAC9C0sC,GAAuB8pB,EAAAA,EAAAA,IAAUvI,EAAuBjuD,GACxDimB,GAAoBuwC,EAAAA,EAAAA,IAAU/H,EAAoBzuD,E,4FC1D/D,MACM0G,EAAa,CCaZ3B,MAAM,iBDXP,SAAU0B,EAAOxB,EAAUgG,EAAY6B,EAAYC,EAAYC,EAAWC,GAC9E,OAAQ/B,EAAAA,EAAAA,OCURrG,EAAAA,EAAAA,IAGM,MAHN6B,EAGM,EAFJC,EAAAA,EAAAA,IAAuD,UAAA0E,EAAAA,EAAAA,IAAjDpG,EAAApD,SAAS,mCAAD,IACd8E,EAAAA,EAAAA,IAAkB,UAAA0E,EAAAA,EAAAA,IAAZpG,EAAAiN,OAAK,IDRf,C,cCNA,GAAe5M,EAAAA,EAAAA,IAAgB,CAC7B8B,KAAM,eACNiH,QAAS,CAAExM,SAAQA,EAAAA,IACnB2D,MAAO,CACL0M,MAAO,CACLtM,UAAU,M,UCFhB,MAAMY,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,GAAQ,CAAC,YAAY,qBAEzF,O,kFCPA,MAAMC,EAAa,CAAC,SAEd,SAAUD,EAAOxB,EAAUgG,EAAY6B,EAAYC,EAAYC,EAAWC,GAC9E,OAAQ/B,EAAAA,EAAAA,OCJRrG,EAAAA,EAAAA,IAKE,YAJC/F,MAAOmG,EAAA0G,WACR1C,IAAI,iBACJlE,MAAM,iBACLkH,QAAKhB,EAAA,KAAAA,EAAA,GAAA9D,GAAElC,EAAAwxD,YAAYtvD,EAAOwD,OAAO7L,SDKjC,KAAM,GAAI4H,EACf,CCEA,OAAepB,EAAAA,EAAAA,IAAgB,CAC7B8B,KAAM,iBACN5B,MAAO,CACLmG,WAAYhG,OACZ+wD,gBAAiB,CACfhxD,KAAM+mC,QACN7mC,UAAU,EACVE,SAAS,GAEX6wD,mBAAoB,CAClBjxD,KAAM+mC,QACN7mC,UAAU,EACVE,SAAS,GAEX8wD,kBAAmB,CACjBlxD,KAAM+mC,QACN7mC,UAAU,EACVE,SAAS,GAEX80C,kBAAmB,CACjBl1C,KAAM+mC,QACN7mC,UAAU,EACVE,SAAS,IAGbC,IAAAA,GACE,MAAO,CACL8wD,gBAAgB,EAEpB,EACAt5D,OAAAA,GACE,IAAIu5D,EAAU5wD,KAAK6wD,UACdD,IACH5wD,KAAK2wD,gBAAiB,EAE1B,EACA52D,MAAO,CACL0L,UAAAA,CAAW7M,GACT,IAAKoH,KAAK2wD,eAAgB,CAExB,MAAMG,EAAkB9wD,KAAKsI,MAC1ByoD,eACGC,EAAWl1D,OAAOC,OAAOkV,QAAQG,UAAU0/C,GAC3CG,EAAcjxD,KAAKkxD,0BACrBD,IAAgBr4D,GAClBo4D,EAASnxD,KAAKuD,IAAIxK,E,CAGxB,GAEFuP,QAAS,CACP0oD,OAAAA,GACE,MAAMC,EAAkB9wD,KAAKsI,MAAMyoD,eAsCnC,OAnCAD,EAAgBvwC,OAAUhc,IACxB3K,QAAQypC,KAAK,QACb,IAAI2tB,EAAWl1D,OAAOC,OAAOkV,QAAQG,UAAU0/C,GAmB/C,GAlBAE,EAAS1/C,MAAMC,SAASumB,GAAG,eAAe,KACxC,IAAIj4B,EAAOG,KAAKkxD,0BAChBlxD,KAAK4Q,MAAM,oBAAqB/Q,EAAK,IAEvCmxD,EAASxf,QAAQC,KAAKlgC,SAASumB,GAC7B,SACA,CAACq5B,EAAKtxD,KACAG,KAAKwwD,kBAIPQ,EAASI,QAAQ,cACjBvxD,EAAK0N,iBACL4jD,EAAIE,O,GAGR,CAAEC,SAAU,SAEVtxD,KAAK0wD,kBAAmB,CAO1B,MAAMa,EAAaP,EAASQ,QAAQruD,IAAI,cACvCouD,EAAiDE,WAAY,C,GAKlE31D,OAAOC,OAAOkV,QAAQ/Q,QAAQ4wD,IACvB,CACT,EACAP,WAAAA,CAAY33D,GACNoH,KAAK2wD,gBACP3wD,KAAK4Q,MAAM,oBAAqBhY,EAEpC,EACAs4D,uBAAAA,GACE,MAAMJ,EAAkB9wD,KAAKsI,MAAMyoD,eACnC,IAAIC,EAAWl1D,OAAOC,OAAOkV,QAAQG,UAAU0/C,GAC3CjxD,EAAOmxD,EAAS7T,UAkBpB,OAjBIn9C,KAAKywD,qBAKP5wD,EAAOA,EAAKK,QAAQ,WAAY,MAAMA,QAAQ,aAAc,OAE1DF,KAAK00C,oBAMF54C,OAAOC,OAAOkV,QAAQygD,cAAc7xD,KACvCA,EAAO/D,OAAOC,OAAOkV,QAAQ0gD,WAAW9xD,KAGrCA,CACT,K,UC/HJ,MAAMS,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,KAEpE,O","sources":["webpack://vue101/./src/components/taskEditorState.ts","webpack://vue101/./src/directives/vDisableDrag.ts","webpack://vue101/./src/directives/vModelUndoable.ts","webpack://vue101/./src/functions.ts","webpack://vue101/./src/language/gettext.ts","webpack://vue101/./src/models/CrosswordTask.ts","webpack://vue101/./src/components/studip/TabComponent.vue","webpack://vue101/./src/components/studip/TabComponent.vue?882f","webpack://vue101/./src/components/studip/TabsComponent.vue","webpack://vue101/./src/components/studip/TabsComponent.vue?ab44","webpack://vue101/./src/components/crossword/CrosswordEditor.vue?dc47","webpack://vue101/./src/components/crossword/CrosswordEditor.vue","webpack://vue101/./src/components/crossword/CrosswordEditor.vue?42c6","webpack://vue101/./src/components/FeedbackElement.vue?81fd","webpack://vue101/./src/components/FeedbackElement.vue","webpack://vue101/./src/components/FeedbackElement.vue?7265","webpack://vue101/./src/components/crossword/CrosswordViewer.vue?6386","webpack://vue101/./src/components/crossword/CrosswordViewer.vue","webpack://vue101/./src/components/crossword/CrosswordViewer.vue?34b4","webpack://vue101/./src/components/DragTheWordsEditor.vue?59e9","webpack://vue101/./src/components/DragTheWordsEditor.vue","webpack://vue101/./src/components/FeedbackEditor.vue?05fc","webpack://vue101/./src/components/FeedbackEditor.vue","webpack://vue101/./src/components/FeedbackEditor.vue?a35b","webpack://vue101/./src/components/DragTheWordsEditor.vue?d6b5","webpack://vue101/./src/components/DragTheWordsViewer.vue?4cee","webpack://vue101/./src/components/DragTheWordsViewer.vue","webpack://vue101/./src/components/DragTheWordsViewer.vue?7545","webpack://vue101/./src/components/FillInTheBlanksEditor.vue?3da7","webpack://vue101/./src/components/FillInTheBlanksEditor.vue","webpack://vue101/./src/components/FillInTheBlanksEditor.vue?4671","webpack://vue101/./src/components/FillInTheBlanksViewer.vue?a1d7","webpack://vue101/./src/components/FillInTheBlanksViewer.vue","webpack://vue101/./src/components/FillInTheBlanksViewer.vue?31ca","webpack://vue101/./src/components/FileUpload.vue?453e","webpack://vue101/./src/components/FileUpload.vue","webpack://vue101/./src/components/FileUpload.vue?4ef7","webpack://vue101/./src/components/findTheHotspots/findTheHotspotsEditorState.ts","webpack://vue101/./src/components/findTheHotspots/ImageWithHotspots.vue?bcce","webpack://vue101/./src/components/findTheHotspots/ImageWithHotspots.vue","webpack://vue101/./src/components/LazyImage.vue?de09","webpack://vue101/./src/components/LazyImage.vue","webpack://vue101/./src/components/LazyImage.vue?fe3e","webpack://vue101/./src/components/findTheHotspots/findTheHotspotsViewerState.ts","webpack://vue101/./src/components/findTheHotspots/ImageWithHotspots.vue?cd94","webpack://vue101/./src/components/findTheHotspots/FindTheHotspotsEditor.vue?833a","webpack://vue101/./src/components/findTheHotspots/FindTheHotspotsEditor.vue","webpack://vue101/./src/components/findTheHotspots/FindTheHotspotsEditor.vue?6f1e","webpack://vue101/./src/components/findTheHotspots/FindTheHotspotsViewer.vue?dcb4","webpack://vue101/./src/components/findTheHotspots/FindTheHotspotsViewer.vue","webpack://vue101/./src/components/findTheHotspots/FindTheHotspotsViewer.vue?3676","webpack://vue101/./src/components/findTheWords/FindTheWordsEditor.vue?de09","webpack://vue101/./src/components/findTheWords/FindTheWordsEditor.vue","webpack://vue101/./src/components/findTheWords/FindTheWordsEditor.vue?8deb","webpack://vue101/./src/components/findTheWords/FindTheWordsViewer.vue?3d4a","webpack://vue101/./src/components/findTheWords/FindTheWordsViewer.vue","webpack://vue101/./src/components/findTheWords/FindTheWordsViewer.vue?c796","webpack://vue101/./src/components/interactiveVideo/editor/InteractiveVideoEditor.vue?46e7","webpack://vue101/./src/components/interactiveVideo/editor/InteractiveVideoEditor.vue","webpack://vue101/./src/components/interactiveVideo/VideoPlayer.vue?6ce4","webpack://vue101/./src/components/interactiveVideo/VideoPlayer.vue","webpack://vue101/./src/models/InteractiveVideoTask.ts","webpack://vue101/./src/components/interactiveVideo/editor/interactiveVideoEditorState.ts","webpack://vue101/./src/components/interactiveVideo/interactions/LmbTaskInteraction.vue?5012","webpack://vue101/./src/components/interactiveVideo/interactions/LmbTaskInteraction.vue","webpack://vue101/./src/components/interactiveVideo/interactions/LmbTaskInteraction.vue?99f3","webpack://vue101/./src/components/interactiveVideo/interactions/OverlayInteraction.vue?dbc8","webpack://vue101/./src/components/interactiveVideo/interactions/OverlayInteraction.vue","webpack://vue101/./src/components/interactiveVideo/interactions/OverlayInteraction.vue?9826","webpack://vue101/./src/components/interactiveVideo/VideoPlayer.vue?8a11","webpack://vue101/./src/components/interactiveVideo/editor/VideoTimeline.vue?1844","webpack://vue101/./src/components/interactiveVideo/editor/VideoTimeline.vue","webpack://vue101/./src/components/interactiveVideo/getEmValueFromElement.ts","webpack://vue101/./src/components/interactiveVideo/formatVideoTimestamp.ts","webpack://vue101/./src/components/interactiveVideo/editor/VideoTimeline.vue?2b71","webpack://vue101/./src/components/interactiveVideo/editor/SelectedInteractionProperties.vue?4bdc","webpack://vue101/./src/components/interactiveVideo/editor/SelectedInteractionProperties.vue","webpack://vue101/./src/components/interactiveVideo/VideoTimeInput.vue?05c3","webpack://vue101/./src/components/interactiveVideo/VideoTimeInput.vue","webpack://vue101/./src/components/interactiveVideo/VideoTimeInput.vue?f86d","webpack://vue101/./src/components/interactiveVideo/editor/SelectedInteractionProperties.vue?adb9","webpack://vue101/./src/components/interactiveVideo/strings.ts","webpack://vue101/./src/components/interactiveVideo/editor/AddInteractions.vue?551d","webpack://vue101/./src/components/interactiveVideo/editor/AddInteractions.vue","webpack://vue101/./src/components/interactiveVideo/editor/AddInteractions.vue?ec21","webpack://vue101/./src/components/interactiveVideo/editor/SelectVideo.vue?fd09","webpack://vue101/./src/components/interactiveVideo/editor/SelectVideo.vue","webpack://vue101/./src/components/studip/FilePicker.vue?bcb9","webpack://vue101/./src/components/studip/FilePicker.vue","webpack://vue101/./src/components/studip/FolderPicker.vue?b195","webpack://vue101/./src/components/studip/FolderPicker.vue","webpack://vue101/./src/components/studip/FolderPicker.vue?baff","webpack://vue101/./src/components/studip/FilePicker.vue?5164","webpack://vue101/./src/components/interactiveVideo/editor/SelectVideo.vue?613a","webpack://vue101/./src/components/interactiveVideo/editor/ConfigureTravisGo.vue?fbe3","webpack://vue101/./src/components/interactiveVideo/editor/ConfigureTravisGo.vue","webpack://vue101/./src/components/interactiveVideo/editor/ConfigureTravisGo.vue?5760","webpack://vue101/./src/components/interactiveVideo/editor/InteractiveVideoEditor.vue?920a","webpack://vue101/./src/components/studip/StudipActionMenu.vue","webpack://vue101/./src/components/studip/icon-loader.ts","webpack://vue101/./src/components/studip/StudipIcon.vue?769e","webpack://vue101/./src/components/studip/StudipIcon.vue","webpack://vue101/./src/components/studip/StudipIcon.vue?4cae","webpack://vue101/./src/components/studip/StudipActionMenu.vue?06b6","webpack://vue101/./src/components/interactiveVideo/viewer/TravisGoPost.vue?e5eb","webpack://vue101/./src/components/interactiveVideo/viewer/TravisGoPost.vue","webpack://vue101/./src/components/interactiveVideo/viewer/TravisGoPost.vue?91ef","webpack://vue101/./src/components/interactiveVideo/viewer/InteractiveVideoViewer.vue?7e9f","webpack://vue101/./src/components/interactiveVideo/viewer/InteractiveVideoViewer.vue","webpack://vue101/./src/components/interactiveVideo/viewer/InteractiveVideoViewer.vue?535b","webpack://vue101/./src/components/MarkTheWordsEditor.vue?7ca2","webpack://vue101/./src/components/MarkTheWordsEditor.vue","webpack://vue101/./src/components/MarkTheWordsEditor.vue?31d0","webpack://vue101/./src/components/MarkTheWordsViewer.vue?81e2","webpack://vue101/./src/components/MarkTheWordsViewer.vue","webpack://vue101/./src/components/MarkTheWordsViewer.vue?af90","webpack://vue101/./src/components/MemoryEditor.vue?6baf","webpack://vue101/./src/components/MemoryEditor.vue","webpack://vue101/./src/components/MemoryEditorCard.vue?9ca2","webpack://vue101/./src/components/MemoryEditorCard.vue","webpack://vue101/./src/components/MultimediaElement.vue?3699","webpack://vue101/./src/components/MultimediaElement.vue","webpack://vue101/./src/components/MultimediaElement.vue?dd2e","webpack://vue101/./src/components/MemoryEditorCard.vue?cd13","webpack://vue101/./src/components/MemoryEditor.vue?bbee","webpack://vue101/./src/components/MemoryViewer.vue?c255","webpack://vue101/./src/components/MemoryViewer.vue","webpack://vue101/./src/components/MemoryViewerCard.vue?5285","webpack://vue101/./src/components/MemoryViewerCard.vue","webpack://vue101/./src/components/MemoryViewerCard.vue?65cb","webpack://vue101/./src/components/MemoryViewer.vue?449d","webpack://vue101/./src/components/PairingEditor.vue?9abc","webpack://vue101/./src/components/PairingEditor.vue","webpack://vue101/./src/components/PairingEditorPair.vue?e64b","webpack://vue101/./src/components/PairingEditorPair.vue","webpack://vue101/./src/components/PairingEditorPair.vue?1bf9","webpack://vue101/./src/components/PairingEditorCard.vue?e23e","webpack://vue101/./src/components/PairingEditorCard.vue","webpack://vue101/./src/components/PairingEditorCard.vue?906a","webpack://vue101/./src/components/PairingEditor.vue?7dbb","webpack://vue101/./src/components/PairingViewer.vue?96ff","webpack://vue101/./src/components/PairingViewer.vue","webpack://vue101/./src/components/PairingViewerTargetElement.vue?ed87","webpack://vue101/./src/components/PairingViewerTargetElement.vue","webpack://vue101/./src/components/PairingViewerTargetElement.vue?b150","webpack://vue101/./src/components/PairingViewer.vue?f97c","webpack://vue101/./src/components/QuestionEditor.vue?5276","webpack://vue101/./src/components/QuestionEditor.vue","webpack://vue101/./src/components/QuestionEditor.vue?bd0e","webpack://vue101/./src/components/QuestionViewer.vue?58ef","webpack://vue101/./src/components/QuestionViewer.vue","webpack://vue101/./src/components/QuestionViewer.vue?4bca","webpack://vue101/./src/components/SequencingEditor.vue?08b3","webpack://vue101/./src/components/SequencingEditor.vue","webpack://vue101/./src/components/SequencingEditorCard.vue?f528","webpack://vue101/./src/components/SequencingEditorCard.vue","webpack://vue101/./src/components/SequencingEditorCard.vue?6b21","webpack://vue101/./src/components/SequencingEditor.vue?61f6","webpack://vue101/./src/components/SequencingViewer.vue?041e","webpack://vue101/./src/components/SequencingViewer.vue","webpack://vue101/./src/components/SequencingViewer.vue?951c","webpack://vue101/./src/models/common.ts","webpack://vue101/./src/models/FindTheHotspotsTask.ts","webpack://vue101/./src/models/TaskDefinition.ts","webpack://vue101/./src/routes/jsonApi.ts","webpack://vue101/./src/routes/lernmodule.ts","webpack://vue101/./src/store/modules/taskEditor.ts","webpack://vue101/./src/store/modules/coursewareBlock.ts","webpack://vue101/./src/store/modules/requestQueue.ts","webpack://vue101/./src/reststate-vuex/reststate-client.js","webpack://vue101/./src/reststate-vuex/reststate-vuex.js","webpack://vue101/./src/store/index.ts","webpack://vue101/./src/components/ErrorMessage.vue?97ff","webpack://vue101/./src/components/ErrorMessage.vue","webpack://vue101/./src/components/ErrorMessage.vue?5a16","webpack://vue101/./src/components/StudipWysiwyg.vue?6745","webpack://vue101/./src/components/StudipWysiwyg.vue","webpack://vue101/./src/components/StudipWysiwyg.vue?3716"],"sourcesContent":["import { taskEditorStore } from '@/store';\nimport { InjectionKey } from 'vue';\n\nexport const taskEditorStateSymbol = Symbol(\n  'Task editor injected dependencies'\n) as InjectionKey<TaskEditorState>;\n\nexport interface TaskEditorState {\n  performEdit: typeof taskEditorStore.performEdit;\n}\n","import { Directive } from 'vue';\n\nexport const disableDrag: Directive = {\n  mounted(el: HTMLElement) {\n    // Set the parent element to non-draggable\n    el.setAttribute('draggable', 'false');\n\n    // Function to recursively disable dragging for all child elements\n    const setDraggableFalse = (element: HTMLElement) => {\n      element.setAttribute('draggable', 'false');\n      element.childNodes.forEach((child) => {\n        if (child instanceof HTMLElement) {\n          setDraggableFalse(child);\n        }\n      });\n    };\n\n    setDraggableFalse(el);\n  },\n} as const;\n","import { store, taskEditorStore } from '@/store';\nimport { Directive, DirectiveBinding } from 'vue';\n\n/**\n * This is a custom directive that you can use like v-model in the Lernmodul-Editor.\n * Like v-model, it is a two-way binding, but rather than directly modifying\n * 'taskDefinition', it saves changes into the undo-redo stack by calling\n * 'taskEditorStore.performEdit'.\n * It also sets an attribute 'data-undo-focus-id' on the element.\n * This attribute is used during the 'undo' and 'redo' operations.\n * The input elements whose contents are modified by 'undo' or 'redo' will\n * automatically be focus()ed and brought into view.\n * TODO: Can I get better stack traces when errors are thrown inside of\n *   directive hooks?  Right now, they do not show what line of the .vue file\n *   caused the errors to be thrown.\n */\nexport const modelUndoable: Directive = {\n  mounted(\n    el: HTMLElement,\n    binding: DirectiveBinding<unknown>,\n    vnode,\n    prevVnode\n  ) {\n    const validEl = validateElement(el);\n    validEl.setAttribute('data-undo-focus-id', parsePath(binding).join('.'));\n\n    el.addEventListener('input', (ev: Event) => {\n      const splitPath = parsePath(binding);\n      const [firstPathEl, ...restOfPath] = splitPath;\n      const value = vnode.el.value;\n      const newState = JSON.parse(\n        JSON.stringify(taskEditorStore.taskDefinition)\n      );\n      setValueAtPath(newState, restOfPath, value);\n      taskEditorStore.performEdit({\n        newTaskDefinition: newState,\n        undoBatch: splitPath.join('.'),\n      });\n      console.log(el, binding, vnode, prevVnode, ev, splitPath, value);\n    });\n\n    function setElValueFromStore() {\n      const splitPath = parsePath(binding);\n      const storeValue = getValueAtPath(taskEditorStore, splitPath);\n      const validatedStoreValue = validateBoundValue(storeValue);\n      validEl.value = validatedStoreValue.toString();\n    }\n    store.watch(\n      () => {\n        const splitPath = parsePath(binding);\n        return getValueAtPath(taskEditorStore, splitPath);\n      },\n      () => setElValueFromStore()\n    );\n    setElValueFromStore();\n  },\n} as const;\n\n/**\n * Make sure that the binding supplied by the user is a valid one.\n * It should be a path to a field of 'taskEditorStore.taskDefinition',\n * e.g. 'taskDefinition.task_type'.\n * @param binding - See https://vuejs.org/guide/reusability/custom-directives.html#directive-hooks\n */\nfunction parsePath(binding: DirectiveBinding<unknown>): Array<string> {\n  if (typeof binding.value !== 'string') {\n    throw new Error(bindingMustBeStringError + binding.value);\n  }\n  const splitPath = binding.value.split('.');\n  const firstPathEl = splitPath[0];\n  if (firstPathEl !== 'taskDefinition') {\n    throw new Error(bindingMustUseTaskDefinitionError + binding.value);\n  }\n  return splitPath;\n}\n\nfunction validateElement(\n  el: HTMLElement\n): HTMLInputElement | HTMLTextAreaElement | HTMLSelectElement {\n  if (\n    el instanceof HTMLInputElement ||\n    el instanceof HTMLTextAreaElement ||\n    el instanceof HTMLSelectElement\n  ) {\n    return el;\n  }\n  throw new Error(invalidElementTypeError);\n}\n\nfunction validateBoundValue(val: unknown): string | number | boolean {\n  if (\n    typeof val !== 'string' &&\n    typeof val !== 'number' &&\n    typeof val !== 'boolean'\n  ) {\n    throw new Error(boundValueMustBePrimitiveError + typeof val);\n  }\n  return val;\n}\n\nfunction getValueAtPath(o: object, path: Array<string>): unknown {\n  return path.reduce((accumulator: any, pathComponent: string) => {\n    if (!Object.prototype.hasOwnProperty.call(accumulator, pathComponent)) {\n      throw new Error(invalidPathError + path.join('.'));\n    }\n    return accumulator[pathComponent];\n  }, o);\n}\n\nfunction setValueAtPath(o: object, splitPath: Array<string>, value: any) {\n  const [lastPathComponent, ...restOfPath] = [splitPath.pop(), ...splitPath];\n  if (lastPathComponent === undefined) {\n    throw new Error('Path has no last element');\n  }\n  const targetObject = restOfPath.reduce(\n    (accumulator: Record<string, any>, pathComponent: string) =>\n      accumulator[pathComponent],\n    o\n  );\n  targetObject[lastPathComponent] = value;\n}\n\n// TODO translate these strings in Weblate.\nconst bindingMustBeStringError =\n  'The value supplied to v-model-undoable must be a string. ' +\n  'Example: <select v-model-undoable=\"\\'taskDefinition.task_type\\'\">\\n' +\n  'You supplied the following value: ';\n\nconst bindingMustUseTaskDefinitionError =\n  'The string supplied to v-model-undoable must be a path which begins with ' +\n  '\"taskDefinition\", and the path must be wrapped in two sets of quotes. \\n' +\n  'Example usage: <select v-model-undoable=\"\\'taskDefinition.task_type\\'\">\\n' +\n  'You supplied the following string: ';\n\nconst boundValueMustBePrimitiveError =\n  'The value bound with v-model-undoable must be a string, number or boolean.  ' +\n  'Other datatypes are not currently supported.  The value found is of type ';\n\nconst invalidPathError =\n  'No field was found in the store under the given path.  Did you make a ' +\n  'typo?  Path: ';\n\nconst invalidElementTypeError =\n  'v-model-undoable can only be used on <input>, <textarea> and <select> elements';\n","import { $gettext } from '@/language/gettext';\n\nexport function formatInvalidTaskDefinitionErrorMessage(\n  e: unknown,\n  task_json: unknown\n): string {\n  return (\n    $gettext(\n      'Diese Aufgabe konnte nicht geladen werden. ' +\n        'Beim Einlesen von task_json ist ein Fehler aufgetreten. Fehler: '\n    ) +\n    '\\n' +\n    e +\n    '\\n' +\n    'task_json: ' +\n    JSON.stringify(task_json, null, 2)\n  );\n}\n","import { createGettext } from 'vue3-gettext';\nimport translations from '@/language/translations.json';\nimport { memoize } from 'lodash';\n\nconst selectedLanguage = Object.values(window.STUDIP.INSTALLED_LANGUAGES).find(\n  (lang) => lang.selected\n);\nconst gettextPlugin = createGettext({\n  availableLanguages: {\n    en: 'English',\n    de: 'Deutsch',\n  },\n  defaultLanguage: selectedLanguage?.path ?? 'de',\n  translations: translations,\n});\n\n// Cache gettext results.\n// This fixes the problem we had where the error 'No translations found for de' was\n// being printed excessively often (sometimes 1000s of times per second) during\n// certain UI interactions, e.g. when dragging interactions around on top of\n// the video in the Interactive Video Editor.\nconst $gettext = memoize(gettextPlugin.$gettext, (...args) =>\n  JSON.stringify(args)\n);\n\nconst $pgettext = memoize(gettextPlugin.$pgettext, (...args) =>\n  JSON.stringify(args)\n);\n\nconst $npgettext = memoize(gettextPlugin.$npgettext, (...args) =>\n  JSON.stringify(args)\n);\n\nconst $ngettext = memoize(gettextPlugin.$ngettext, (...args) =>\n  JSON.stringify(args)\n);\n\nconst $gettextInterpolate = memoize(gettextPlugin.interpolate, (...args) =>\n  JSON.stringify(args)\n);\n\nexport {\n  gettextPlugin,\n  $gettext,\n  $pgettext,\n  $npgettext,\n  $ngettext,\n  $gettextInterpolate,\n};\n","import { z } from 'zod';\n\nexport const Direction = z.enum(['across', 'down']);\n\nconst wordSchema = z.object({\n  uuid: z.string(),\n  hint: z.string(),\n  solution: z.string(),\n  x: z.number(),\n  y: z.number(),\n  direction: Direction,\n});\nexport type Word = z.infer<typeof wordSchema>;\n\nexport const crosswordTaskSchema = z.object({\n  task_type: z.literal('Crossword'),\n  words: z.array(wordSchema),\n  colorEmptyCells: z.boolean(),\n  strings: z.object({\n    checkButton: z.string(),\n    retryButton: z.string(),\n    solutionsButton: z.string(),\n    resultMessage: z.string(),\n  }),\n});\nexport type CrosswordTask = z.infer<typeof crosswordTaskSchema>;\n","<!-- Adapted from https://zerotomastery.io/blog/tab-component-design-with-vue/ -->\n<template>\n  <div\n    role=\"tabpanel\"\n    class=\"cw-tab cw-tabs-content\"\n    :class=\"{ 'cw-tab-active': isActive }\"\n    v-show=\"isActive\"\n    :aria-labelledby=\"buttonSelector\"\n  >\n    <slot />\n  </div>\n</template>\n\n<script>\nimport { defineComponent } from 'vue';\nexport default defineComponent({\n  inject: ['activeTabHash', 'addTab'],\n  props: {\n    title: {\n      type: String,\n      required: true,\n    },\n    icon: {\n      type: String,\n      required: false,\n      default: '',\n    },\n  },\n  data() {\n    return { hash: '', isActive: false };\n  },\n  created() {\n    this.hash = '#' + this.title.toLowerCase().replace(/ /g, '-');\n\n    this.addTab({\n      title: this.title,\n      hash: this.hash,\n      icon: this.icon,\n    });\n  },\n  watch: {\n    activeTabHash() {\n      this.isActive = this.activeTabHash === this.hash;\n    },\n  },\n  computed: {\n    buttonSelector() {\n      return '#' + this.hash;\n    },\n  },\n});\n</script>\n","import { render } from \"./TabComponent.vue?vue&type=template&id=802e3ad4\"\nimport script from \"./TabComponent.vue?vue&type=script&lang=js\"\nexport * from \"./TabComponent.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<!-- Adapted from https://zerotomastery.io/blog/tab-component-design-with-vue/ -->\n<template>\n  <div class=\"tabs cw-tabs\">\n    <div role=\"tablist\" class=\"tab-buttons cw-tabs-nav\">\n      <button\n        v-for=\"tab in tabs\"\n        :key=\"tab.title\"\n        @click=\"activeTabHash = tab.hash\"\n        :class=\"{\n          'is-active': tab.hash === activeTabHash,\n          [`cw-tabs-nav-icon-text-${tab.icon}`]:\n            tab.icon !== '' && tab.name !== '',\n          [`cw-tabs-nav-icon-solo-${tab.icon}`]:\n            tab.icon !== '' && tab.name === '',\n        }\"\n        :aria-selected=\"tab.hash === activeTabHash\"\n        :aria-controls=\"tab.hash\"\n        :id=\"'#' + tab.hash\"\n        :tabindex=\"0\"\n      >\n        {{ tab.title }}\n      </button>\n    </div>\n    <slot />\n  </div>\n</template>\n\n<script>\nimport { computed, defineComponent } from 'vue';\n\nexport default defineComponent({\n  data() {\n    return {\n      activeTabHash: '',\n      tabs: [],\n    };\n  },\n  provide() {\n    return {\n      addTab: (tab) => {\n        const count = this.tabs.push(tab);\n\n        if (count === 1) {\n          this.activeTabHash = tab.hash;\n        }\n      },\n      activeTabHash: computed(() => this.activeTabHash),\n    };\n  },\n});\n</script>\n","import { render } from \"./TabsComponent.vue?vue&type=template&id=7fa19dae\"\nimport script from \"./TabsComponent.vue?vue&type=script&lang=js\"\nexport * from \"./TabsComponent.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { unref as _unref, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, vModelText as _vModelText, withDirectives as _withDirectives, normalizeClass as _normalizeClass, isRef as _isRef, withCtx as _withCtx, createVNode as _createVNode, vModelSelect as _vModelSelect, createTextVNode as _createTextVNode, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, vModelCheckbox as _vModelCheckbox, createBlock as _createBlock, withModifiers as _withModifiers, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-39cea382\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"stud5p-task\" }\nconst _hoisted_2 = { class: \"word-list-and-word-details-container\" }\nconst _hoisted_3 = { class: \"word-list-container\" }\nconst _hoisted_4 = [\"onClick\"]\nconst _hoisted_5 = [\"onUpdate:modelValue\", \"onInput\", \"placeholder\"]\nconst _hoisted_6 = [\"onUpdate:modelValue\", \"onInput\", \"placeholder\"]\nconst _hoisted_7 = [\"onClick\", \"title\"]\nconst _hoisted_8 = { class: \"word-details\" }\nconst _hoisted_9 = { value: \"across\" }\nconst _hoisted_10 = { value: \"down\" }\nconst _hoisted_11 = { key: 1 }\nconst _hoisted_12 = {\n  key: 0,\n  style: { flexBasis: '50%', flexGrow: 0, flexShrink: 0 }\n}\n\nimport { inject, PropType, ref, watch, computed } from 'vue';\nimport {\n  TaskEditorState,\n  taskEditorStateSymbol,\n} from '@/components/taskEditorState';\nimport { CrosswordTask, Word, Direction } from '@/models/CrosswordTask';\nimport { cloneDeep } from 'lodash';\nimport { $gettext } from '@/language/gettext';\nimport TabComponent from '@/components/studip/TabComponent.vue';\nimport TabsComponent from '@/components/studip/TabsComponent.vue';\nimport produce from 'immer';\nimport { v4 } from 'uuid';\nimport draggable from 'vuedraggable';\n\n\nexport default /*#__PURE__*/_defineComponent({\n  props: {\n  taskDefinition: {\n    type: Object as PropType<CrosswordTask>,\n    required: true,\n  },\n},\n  setup(__props) {\n\nconst props = __props\n\nconst taskEditor = inject<TaskEditorState>(taskEditorStateSymbol);\n\n\n\nconst components = {\n  TabComponent,\n  TabsComponent,\n  draggable,\n};\n\nconst debug = window.STUDIP.LernmoduleVueJS.LERNMODULE_DEBUG;\n\n// State\nconst selectedWord = ref<Word>();\nconst modelTaskDefinition = ref<CrosswordTask>(cloneDeep(props.taskDefinition));\n\n// Computed properties\nconst wordList = computed({\n  get() {\n    return modelTaskDefinition.value.words;\n  },\n  set(newValue) {\n    modelTaskDefinition.value.words = newValue;\n    updateTaskDefinition();\n  },\n});\n\n// Watchers\nwatch(\n  () => props.taskDefinition,\n  (newTaskDefinition, oldTaskDefinition) => {\n    modelTaskDefinition.value = cloneDeep(newTaskDefinition);\n  },\n  { deep: true }\n);\n\nfunction updateTaskDefinition(undoBatch?: unknown): void {\n  // Synchronize state modelTaskDefinition -> taskDefinition.\n  console.log('update task definition');\n  taskEditor!.performEdit({\n    newTaskDefinition: cloneDeep(modelTaskDefinition.value),\n    undoBatch: undoBatch ?? {},\n  });\n}\n\nfunction deleteWord(uuid: string): void {\n  modelTaskDefinition.value = produce(modelTaskDefinition.value, (draft) => {\n    const index = draft.words.findIndex((word) => word.uuid === uuid);\n    if (index === -1) {\n      throw new Error('No word with id ' + uuid + ' found.');\n    }\n    draft.words.splice(index, 1);\n  });\n\n  updateTaskDefinition();\n}\n\nfunction addWord(): void {\n  const newWord: Word = {\n    uuid: v4(),\n    hint: '',\n    solution: '',\n    direction: 'across',\n    x: 0,\n    y: 0,\n  };\n  modelTaskDefinition.value = produce(modelTaskDefinition.value, (draft) => {\n    draft.words.push(newWord);\n  });\n  updateTaskDefinition();\n}\n\nfunction onClickWord(uuid: string): void {\n  selectedWord.value = modelTaskDefinition.value.words.find(\n    (word) => word.uuid === uuid\n  );\n}\n\nfunction onInputHint(uuid: string, hint: string): void {\n  modelTaskDefinition.value = produce(modelTaskDefinition.value, (draft) => {\n    const index = draft.words.findIndex((word) => word.uuid === uuid);\n    if (index === -1) {\n      throw new Error('No word with id ' + uuid + ' found.');\n    }\n    draft.words[index].hint = hint;\n  });\n\n  updateTaskDefinition('hint');\n}\n\nfunction onInputSolution(uuid: string, solution: string): void {\n  modelTaskDefinition.value = produce(modelTaskDefinition.value, (draft) => {\n    const index = draft.words.findIndex((word) => word.uuid === uuid);\n    if (index === -1) {\n      throw new Error('No word with id ' + uuid + ' found.');\n    }\n    draft.words[index].solution = solution;\n  });\n\n  updateTaskDefinition('solution');\n}\n\nfunction onInputXCoordinate(uuid: string, x: number): void {\n  modelTaskDefinition.value = produce(modelTaskDefinition.value, (draft) => {\n    const index = draft.words.findIndex((word) => word.uuid === uuid);\n    if (index === -1) {\n      throw new Error('No word with id ' + uuid + ' found.');\n    }\n    draft.words[index].x = x;\n  });\n\n  updateTaskDefinition('x-coordinate');\n}\n\nfunction onInputYCoordinate(uuid: string, y: number): void {\n  modelTaskDefinition.value = produce(modelTaskDefinition.value, (draft) => {\n    const index = draft.words.findIndex((word) => word.uuid === uuid);\n    if (index === -1) {\n      throw new Error('No word with id ' + uuid + ' found.');\n    }\n    draft.words[index].y = y;\n  });\n\n  updateTaskDefinition('y-coordinate');\n}\n\nfunction onChangeDirection(uuid: string, event: Event) {\n  const selectedDirection = (event.target as HTMLSelectElement).value;\n  console.log(selectedDirection);\n  modelTaskDefinition.value = produce(modelTaskDefinition.value, (draft) => {\n    const index = draft.words.findIndex((word) => word.uuid === uuid);\n    if (index === -1) {\n      throw new Error('No word with id ' + uuid + ' found.');\n    }\n    if (selectedDirection === 'across') {\n      draft.words[index].direction = Direction.Enum.across;\n    } else if (selectedDirection === 'down') {\n      draft.words[index].direction = Direction.Enum.down;\n    }\n  });\n\n  updateTaskDefinition('direction');\n}\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createElementVNode(\"form\", {\n      class: \"default\",\n      onSubmit: _cache[17] || (_cache[17] = _withModifiers(() => {}, [\"prevent\"]))\n    }, [\n      _createElementVNode(\"fieldset\", null, [\n        _createElementVNode(\"legend\", null, _toDisplayString(_unref($gettext)('Crossword')), 1),\n        _createVNode(TabsComponent, null, {\n          default: _withCtx(() => [\n            _createVNode(TabComponent, {\n              title: _unref($gettext)('Wrter eingeben'),\n              icon: \"content\",\n              class: \"tab-component\"\n            }, {\n              default: _withCtx(() => [\n                _createElementVNode(\"div\", _hoisted_2, [\n                  _createElementVNode(\"div\", _hoisted_3, [\n                    _createVNode(_unref(draggable), {\n                      modelValue: _unref(wordList),\n                      \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => (_isRef(wordList) ? (wordList).value = $event : null)),\n                      \"item-key\": \"uuid\",\n                      class: \"word-list\",\n                      filter: 'input,button',\n                      preventOnFilter: false\n                    }, {\n                      item: _withCtx(({ element }) => [\n                        _createElementVNode(\"div\", {\n                          class: _normalizeClass([\"word\", {\n                        'selected-word': selectedWord.value?.uuid === element.uuid,\n                      }]),\n                          onClick: ($event: any) => (onClickWord(element.uuid))\n                        }, [\n                          _withDirectives(_createElementVNode(\"input\", {\n                            type: \"text\",\n                            \"onUpdate:modelValue\": ($event: any) => ((element.hint) = $event),\n                            onInput: ($event: any) => (onInputHint(element.uuid, element.hint)),\n                            placeholder: _unref($gettext)('Hinweis')\n                          }, null, 40, _hoisted_5), [\n                            [_vModelText, element.hint]\n                          ]),\n                          _withDirectives(_createElementVNode(\"input\", {\n                            type: \"text\",\n                            \"onUpdate:modelValue\": ($event: any) => ((element.solution) = $event),\n                            onInput: ($event: any) => (onInputSolution(element.uuid, element.solution)),\n                            placeholder: _unref($gettext)('Lsung')\n                          }, null, 40, _hoisted_6), [\n                            [_vModelText, element.solution]\n                          ]),\n                          _createElementVNode(\"button\", {\n                            type: \"button\",\n                            class: \"small-button trash\",\n                            onClick: ($event: any) => (deleteWord(element.uuid)),\n                            title: _unref($gettext)('Dieses Wort lschen')\n                          }, null, 8, _hoisted_7)\n                        ], 10, _hoisted_4)\n                      ]),\n                      _: 1\n                    }, 8, [\"modelValue\"]),\n                    _createElementVNode(\"button\", {\n                      type: \"button\",\n                      class: \"button\",\n                      onClick: addWord\n                    }, _toDisplayString(_unref($gettext)('Neues Wort hinzufgen')), 1)\n                  ]),\n                  _createElementVNode(\"div\", _hoisted_8, [\n                    _createElementVNode(\"fieldset\", null, [\n                      _createElementVNode(\"legend\", null, _toDisplayString(_unref($gettext)('Wort bearbeiten')), 1),\n                      (selectedWord.value)\n                        ? (_openBlock(), _createElementBlock(_Fragment, { key: 0 }, [\n                            _createElementVNode(\"label\", null, [\n                              _createTextVNode(_toDisplayString(_unref($gettext)('Richtung')) + \" \", 1),\n                              _withDirectives(_createElementVNode(\"select\", {\n                                \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event: any) => ((selectedWord.value.direction) = $event)),\n                                onChange: _cache[2] || (_cache[2] = ($event: any) => (onChangeDirection(selectedWord.value.uuid, $event)))\n                              }, [\n                                _createElementVNode(\"option\", _hoisted_9, _toDisplayString(_unref($gettext)('Waagerecht')), 1),\n                                _createElementVNode(\"option\", _hoisted_10, _toDisplayString(_unref($gettext)('Senkrecht')), 1)\n                              ], 544), [\n                                [_vModelSelect, selectedWord.value.direction]\n                              ])\n                            ]),\n                            _createElementVNode(\"label\", null, [\n                              _createTextVNode(_toDisplayString(_unref($gettext)('Spalte')) + \" \", 1),\n                              _withDirectives(_createElementVNode(\"input\", {\n                                type: \"number\",\n                                \"onUpdate:modelValue\": _cache[3] || (_cache[3] = ($event: any) => ((selectedWord.value.x) = $event)),\n                                min: \"0\",\n                                max: \"100\",\n                                step: \"1\",\n                                onInput: _cache[4] || (_cache[4] = ($event: any) => (\n                          onInputXCoordinate(selectedWord.value.uuid, selectedWord.value.x)\n                        )),\n                                placeholder: 'x'\n                              }, null, 544), [\n                                [\n                                  _vModelText,\n                                  selectedWord.value.x,\n                                  void 0,\n                                  { number: true }\n                                ]\n                              ])\n                            ]),\n                            _createElementVNode(\"label\", null, [\n                              _createTextVNode(_toDisplayString(_unref($gettext)('Reihe')) + \" \", 1),\n                              _withDirectives(_createElementVNode(\"input\", {\n                                type: \"number\",\n                                \"onUpdate:modelValue\": _cache[5] || (_cache[5] = ($event: any) => ((selectedWord.value.y) = $event)),\n                                min: \"0\",\n                                max: \"100\",\n                                step: \"1\",\n                                onInput: _cache[6] || (_cache[6] = ($event: any) => (\n                          onInputYCoordinate(selectedWord.value.uuid, selectedWord.value.y)\n                        )),\n                                placeholder: 'y'\n                              }, null, 544), [\n                                [\n                                  _vModelText,\n                                  selectedWord.value.y,\n                                  void 0,\n                                  { number: true }\n                                ]\n                              ])\n                            ])\n                          ], 64))\n                        : (_openBlock(), _createElementBlock(\"p\", _hoisted_11, _toDisplayString(_unref($gettext)(\n                          'Bitte whlen Sie ein Wort aus, um es zu bearbeiten.'\n                        )), 1))\n                    ])\n                  ])\n                ])\n              ]),\n              _: 1\n            }, 8, [\"title\"]),\n            _createVNode(TabComponent, {\n              title: _unref($gettext)('Einstellungen'),\n              icon: \"settings\",\n              class: \"tab-component\"\n            }, {\n              default: _withCtx(() => [\n                _createElementVNode(\"label\", null, [\n                  _createTextVNode(_toDisplayString(_unref($gettext)('Leere Felder einfrben:')) + \" \", 1),\n                  _withDirectives(_createElementVNode(\"input\", {\n                    \"onUpdate:modelValue\": _cache[7] || (_cache[7] = ($event: any) => ((modelTaskDefinition.value.colorEmptyCells) = $event)),\n                    onChange: _cache[8] || (_cache[8] = ($event: any) => (updateTaskDefinition('taskDefinition.colorEmptyCells'))),\n                    type: \"checkbox\"\n                  }, null, 544), [\n                    [_vModelCheckbox, modelTaskDefinition.value.colorEmptyCells]\n                  ])\n                ])\n              ]),\n              _: 1\n            }, 8, [\"title\"]),\n            _createVNode(TabComponent, {\n              title: _unref($gettext)('Beschriftungen'),\n              icon: \"\",\n              class: \"tab-component\"\n            }, {\n              default: _withCtx(() => [\n                _createElementVNode(\"label\", null, [\n                  _createTextVNode(_toDisplayString(_unref($gettext)('Text fr berprfen-Button:')) + \" \", 1),\n                  _withDirectives(_createElementVNode(\"input\", {\n                    \"onUpdate:modelValue\": _cache[9] || (_cache[9] = ($event: any) => ((modelTaskDefinition.value.strings.checkButton) = $event)),\n                    onInput: _cache[10] || (_cache[10] = ($event: any) => (\n                  updateTaskDefinition('taskDefinition.strings.checkButton')\n                )),\n                    type: \"text\"\n                  }, null, 544), [\n                    [_vModelText, modelTaskDefinition.value.strings.checkButton]\n                  ])\n                ]),\n                _createElementVNode(\"label\", null, [\n                  _createTextVNode(_toDisplayString(_unref($gettext)('Text fr Wiederholen-Button:')) + \" \", 1),\n                  _withDirectives(_createElementVNode(\"input\", {\n                    \"onUpdate:modelValue\": _cache[11] || (_cache[11] = ($event: any) => ((modelTaskDefinition.value.strings.retryButton) = $event)),\n                    onInput: _cache[12] || (_cache[12] = ($event: any) => (\n                  updateTaskDefinition('taskDefinition.strings.retryButton')\n                )),\n                    type: \"text\"\n                  }, null, 544), [\n                    [_vModelText, modelTaskDefinition.value.strings.retryButton]\n                  ])\n                ]),\n                _createElementVNode(\"label\", null, [\n                  _createTextVNode(_toDisplayString(_unref($gettext)('Text fr Lsungen-Button:')) + \" \", 1),\n                  _withDirectives(_createElementVNode(\"input\", {\n                    \"onUpdate:modelValue\": _cache[13] || (_cache[13] = ($event: any) => ((modelTaskDefinition.value.strings.solutionsButton) = $event)),\n                    onInput: _cache[14] || (_cache[14] = ($event: any) => (\n                  updateTaskDefinition('taskDefinition.strings.solutionsButton')\n                )),\n                    type: \"text\"\n                  }, null, 544), [\n                    [_vModelText, modelTaskDefinition.value.strings.solutionsButton]\n                  ])\n                ])\n              ]),\n              _: 1\n            }, 8, [\"title\"]),\n            _createVNode(TabComponent, {\n              title: _unref($gettext)('Feedback'),\n              class: \"tab-component\"\n            }, {\n              default: _withCtx(() => [\n                _createElementVNode(\"label\", null, [\n                  _createTextVNode(_toDisplayString(_unref($gettext)(\n                  'Ergebnismitteilung (mgliche Variablen :correct und :total):'\n                )) + \" \", 1),\n                  _withDirectives(_createElementVNode(\"input\", {\n                    \"onUpdate:modelValue\": _cache[15] || (_cache[15] = ($event: any) => ((modelTaskDefinition.value.strings.resultMessage) = $event)),\n                    onInput: _cache[16] || (_cache[16] = ($event: any) => (\n                  updateTaskDefinition('taskDefinition.strings.resultMessage')\n                )),\n                    type: \"text\"\n                  }, null, 544), [\n                    [_vModelText, modelTaskDefinition.value.strings.resultMessage]\n                  ])\n                ])\n              ]),\n              _: 1\n            }, 8, [\"title\"]),\n            (_unref(debug))\n              ? (_openBlock(), _createBlock(TabComponent, {\n                  key: 0,\n                  title: 'Task Definition (debug)',\n                  icon: \"visibility-visible\"\n                }, {\n                  default: _withCtx(() => [\n                    (_unref(debug) && true)\n                      ? (_openBlock(), _createElementBlock(\"pre\", _hoisted_12, _toDisplayString({\n                  taskDefinition: __props.taskDefinition,\n                }), 1))\n                      : _createCommentVNode(\"\", true)\n                  ]),\n                  _: 1\n                }, 8, [\"title\"]))\n              : _createCommentVNode(\"\", true)\n          ]),\n          _: 1\n        })\n      ])\n    ], 32)\n  ]))\n}\n}\n\n})","<template>\n  <div class=\"stud5p-task\">\n    <form class=\"default\" @submit.prevent>\n      <fieldset>\n        <legend>{{ $gettext('Crossword') }}</legend>\n\n        <TabsComponent>\n          <TabComponent\n            :title=\"$gettext('Wrter eingeben')\"\n            icon=\"content\"\n            class=\"tab-component\"\n          >\n            <div class=\"word-list-and-word-details-container\">\n              <div class=\"word-list-container\">\n                <draggable\n                  v-model=\"wordList\"\n                  item-key=\"uuid\"\n                  class=\"word-list\"\n                  :filter=\"'input,button'\"\n                  :preventOnFilter=\"false\"\n                >\n                  <template #item=\"{ element }\">\n                    <div\n                      class=\"word\"\n                      @click=\"onClickWord(element.uuid)\"\n                      :class=\"{\n                        'selected-word': selectedWord?.uuid === element.uuid,\n                      }\"\n                    >\n                      <input\n                        type=\"text\"\n                        v-model=\"element.hint\"\n                        @input=\"onInputHint(element.uuid, element.hint)\"\n                        :placeholder=\"$gettext('Hinweis')\"\n                      />\n                      <input\n                        type=\"text\"\n                        v-model=\"element.solution\"\n                        @input=\"onInputSolution(element.uuid, element.solution)\"\n                        :placeholder=\"$gettext('Lsung')\"\n                      />\n                      <button\n                        type=\"button\"\n                        class=\"small-button trash\"\n                        @click=\"deleteWord(element.uuid)\"\n                        :title=\"$gettext('Dieses Wort lschen')\"\n                      />\n                    </div>\n                  </template>\n                </draggable>\n\n                <button type=\"button\" class=\"button\" @click=\"addWord\">\n                  {{ $gettext('Neues Wort hinzufgen') }}\n                </button>\n              </div>\n              <div class=\"word-details\">\n                <fieldset>\n                  <legend>{{ $gettext('Wort bearbeiten') }}</legend>\n\n                  <template v-if=\"selectedWord\">\n                    <label>\n                      {{ $gettext('Richtung') }}\n                      <select\n                        v-model=\"selectedWord.direction\"\n                        @change=\"onChangeDirection(selectedWord.uuid, $event)\"\n                      >\n                        <option value=\"across\">\n                          {{ $gettext('Waagerecht') }}\n                        </option>\n                        <option value=\"down\">\n                          {{ $gettext('Senkrecht') }}\n                        </option>\n                      </select>\n                    </label>\n                    <label>\n                      {{ $gettext('Spalte') }}\n                      <input\n                        type=\"number\"\n                        v-model.number=\"selectedWord.x\"\n                        min=\"0\"\n                        max=\"100\"\n                        step=\"1\"\n                        @input=\"\n                          onInputXCoordinate(selectedWord.uuid, selectedWord.x)\n                        \"\n                        :placeholder=\"'x'\"\n                      />\n                    </label>\n                    <label>\n                      {{ $gettext('Reihe') }}\n                      <input\n                        type=\"number\"\n                        v-model.number=\"selectedWord.y\"\n                        min=\"0\"\n                        max=\"100\"\n                        step=\"1\"\n                        @input=\"\n                          onInputYCoordinate(selectedWord.uuid, selectedWord.y)\n                        \"\n                        :placeholder=\"'y'\"\n                      />\n                    </label>\n                  </template>\n                  <template v-else>\n                    <p>\n                      {{\n                        $gettext(\n                          'Bitte whlen Sie ein Wort aus, um es zu bearbeiten.'\n                        )\n                      }}\n                    </p>\n                  </template>\n                </fieldset>\n              </div>\n            </div>\n          </TabComponent>\n          <TabComponent\n            :title=\"$gettext('Einstellungen')\"\n            icon=\"settings\"\n            class=\"tab-component\"\n          >\n            <label>\n              {{ $gettext('Leere Felder einfrben:') }}\n              <input\n                v-model=\"modelTaskDefinition.colorEmptyCells\"\n                @change=\"updateTaskDefinition('taskDefinition.colorEmptyCells')\"\n                type=\"checkbox\"\n              />\n            </label>\n          </TabComponent>\n          <TabComponent\n            :title=\"$gettext('Beschriftungen')\"\n            icon=\"\"\n            class=\"tab-component\"\n          >\n            <label>\n              {{ $gettext('Text fr berprfen-Button:') }}\n              <input\n                v-model=\"modelTaskDefinition.strings.checkButton\"\n                @input=\"\n                  updateTaskDefinition('taskDefinition.strings.checkButton')\n                \"\n                type=\"text\"\n              />\n            </label>\n\n            <label>\n              {{ $gettext('Text fr Wiederholen-Button:') }}\n              <input\n                v-model=\"modelTaskDefinition.strings.retryButton\"\n                @input=\"\n                  updateTaskDefinition('taskDefinition.strings.retryButton')\n                \"\n                type=\"text\"\n              />\n            </label>\n\n            <label>\n              {{ $gettext('Text fr Lsungen-Button:') }}\n              <input\n                v-model=\"modelTaskDefinition.strings.solutionsButton\"\n                @input=\"\n                  updateTaskDefinition('taskDefinition.strings.solutionsButton')\n                \"\n                type=\"text\"\n              />\n            </label>\n          </TabComponent>\n          <TabComponent :title=\"$gettext('Feedback')\" class=\"tab-component\">\n            <label>\n              {{\n                $gettext(\n                  'Ergebnismitteilung (mgliche Variablen :correct und :total):'\n                )\n              }}\n              <input\n                v-model=\"modelTaskDefinition.strings.resultMessage\"\n                @input=\"\n                  updateTaskDefinition('taskDefinition.strings.resultMessage')\n                \"\n                type=\"text\"\n              />\n            </label>\n          </TabComponent>\n          <TabComponent\n            v-if=\"debug\"\n            :title=\"'Task Definition (debug)'\"\n            icon=\"visibility-visible\"\n          >\n            <pre\n              v-if=\"debug && true\"\n              :style=\"{ flexBasis: '50%', flexGrow: 0, flexShrink: 0 }\"\n              >{{\n                {\n                  taskDefinition,\n                }\n              }}</pre\n            >\n          </TabComponent>\n        </TabsComponent>\n      </fieldset>\n    </form>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { inject, PropType, ref, defineProps, watch, computed } from 'vue';\nimport {\n  TaskEditorState,\n  taskEditorStateSymbol,\n} from '@/components/taskEditorState';\nimport { CrosswordTask, Word, Direction } from '@/models/CrosswordTask';\nimport { cloneDeep } from 'lodash';\nimport { $gettext } from '@/language/gettext';\nimport TabComponent from '@/components/studip/TabComponent.vue';\nimport TabsComponent from '@/components/studip/TabsComponent.vue';\nimport produce from 'immer';\nimport { v4 } from 'uuid';\nimport draggable from 'vuedraggable';\n\nconst taskEditor = inject<TaskEditorState>(taskEditorStateSymbol);\n\nconst props = defineProps({\n  taskDefinition: {\n    type: Object as PropType<CrosswordTask>,\n    required: true,\n  },\n});\n\nconst components = {\n  TabComponent,\n  TabsComponent,\n  draggable,\n};\n\nconst debug = window.STUDIP.LernmoduleVueJS.LERNMODULE_DEBUG;\n\n// State\nconst selectedWord = ref<Word>();\nconst modelTaskDefinition = ref<CrosswordTask>(cloneDeep(props.taskDefinition));\n\n// Computed properties\nconst wordList = computed({\n  get() {\n    return modelTaskDefinition.value.words;\n  },\n  set(newValue) {\n    modelTaskDefinition.value.words = newValue;\n    updateTaskDefinition();\n  },\n});\n\n// Watchers\nwatch(\n  () => props.taskDefinition,\n  (newTaskDefinition, oldTaskDefinition) => {\n    modelTaskDefinition.value = cloneDeep(newTaskDefinition);\n  },\n  { deep: true }\n);\n\nfunction updateTaskDefinition(undoBatch?: unknown): void {\n  // Synchronize state modelTaskDefinition -> taskDefinition.\n  console.log('update task definition');\n  taskEditor!.performEdit({\n    newTaskDefinition: cloneDeep(modelTaskDefinition.value),\n    undoBatch: undoBatch ?? {},\n  });\n}\n\nfunction deleteWord(uuid: string): void {\n  modelTaskDefinition.value = produce(modelTaskDefinition.value, (draft) => {\n    const index = draft.words.findIndex((word) => word.uuid === uuid);\n    if (index === -1) {\n      throw new Error('No word with id ' + uuid + ' found.');\n    }\n    draft.words.splice(index, 1);\n  });\n\n  updateTaskDefinition();\n}\n\nfunction addWord(): void {\n  const newWord: Word = {\n    uuid: v4(),\n    hint: '',\n    solution: '',\n    direction: 'across',\n    x: 0,\n    y: 0,\n  };\n  modelTaskDefinition.value = produce(modelTaskDefinition.value, (draft) => {\n    draft.words.push(newWord);\n  });\n  updateTaskDefinition();\n}\n\nfunction onClickWord(uuid: string): void {\n  selectedWord.value = modelTaskDefinition.value.words.find(\n    (word) => word.uuid === uuid\n  );\n}\n\nfunction onInputHint(uuid: string, hint: string): void {\n  modelTaskDefinition.value = produce(modelTaskDefinition.value, (draft) => {\n    const index = draft.words.findIndex((word) => word.uuid === uuid);\n    if (index === -1) {\n      throw new Error('No word with id ' + uuid + ' found.');\n    }\n    draft.words[index].hint = hint;\n  });\n\n  updateTaskDefinition('hint');\n}\n\nfunction onInputSolution(uuid: string, solution: string): void {\n  modelTaskDefinition.value = produce(modelTaskDefinition.value, (draft) => {\n    const index = draft.words.findIndex((word) => word.uuid === uuid);\n    if (index === -1) {\n      throw new Error('No word with id ' + uuid + ' found.');\n    }\n    draft.words[index].solution = solution;\n  });\n\n  updateTaskDefinition('solution');\n}\n\nfunction onInputXCoordinate(uuid: string, x: number): void {\n  modelTaskDefinition.value = produce(modelTaskDefinition.value, (draft) => {\n    const index = draft.words.findIndex((word) => word.uuid === uuid);\n    if (index === -1) {\n      throw new Error('No word with id ' + uuid + ' found.');\n    }\n    draft.words[index].x = x;\n  });\n\n  updateTaskDefinition('x-coordinate');\n}\n\nfunction onInputYCoordinate(uuid: string, y: number): void {\n  modelTaskDefinition.value = produce(modelTaskDefinition.value, (draft) => {\n    const index = draft.words.findIndex((word) => word.uuid === uuid);\n    if (index === -1) {\n      throw new Error('No word with id ' + uuid + ' found.');\n    }\n    draft.words[index].y = y;\n  });\n\n  updateTaskDefinition('y-coordinate');\n}\n\nfunction onChangeDirection(uuid: string, event: Event) {\n  const selectedDirection = (event.target as HTMLSelectElement).value;\n  console.log(selectedDirection);\n  modelTaskDefinition.value = produce(modelTaskDefinition.value, (draft) => {\n    const index = draft.words.findIndex((word) => word.uuid === uuid);\n    if (index === -1) {\n      throw new Error('No word with id ' + uuid + ' found.');\n    }\n    if (selectedDirection === 'across') {\n      draft.words[index].direction = Direction.Enum.across;\n    } else if (selectedDirection === 'down') {\n      draft.words[index].direction = Direction.Enum.down;\n    }\n  });\n\n  updateTaskDefinition('direction');\n}\n</script>\n\n<style scoped>\n.tab-component {\n  padding: 0.5em;\n}\n\n.word-list-and-word-details-container {\n  display: flex;\n  justify-content: space-between;\n}\n\n.word-list-container {\n}\n\n.word-list {\n  display: flex;\n  flex-direction: column;\n  gap: 0.5em;\n}\n\n.word {\n  display: flex;\n  gap: 1em;\n  padding: 1em;\n  align-items: center;\n  cursor: grab;\n  border: 1px solid #ccc;\n}\n\n.selected-word {\n  background: rgba(140, 180, 255, 0.13);\n}\n\n.word-details {\n  width: 400px;\n}\n</style>\n","import script from \"./CrosswordEditor.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./CrosswordEditor.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./CrosswordEditor.vue?vue&type=style&index=0&id=39cea382&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-39cea382\"]])\n\nexport default __exports__","import { createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, resolveDirective as _resolveDirective, withDirectives as _withDirectives, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\nimport _imports_0 from '../assets/star.png'\n\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-7585ad83\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"feedback-container\" }\nconst _hoisted_2 = { class: \"meter-container\" }\nconst _hoisted_3 = { class: \"meter-background\" }\nconst _hoisted_4 = {\n  class: \"meter-bar\",\n  ref: \"meterBar\"\n}\nconst _hoisted_5 = [\"alt\"]\nconst _hoisted_6 = [\"textContent\"]\nconst _hoisted_7 = [\"textContent\"]\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _directive_disable_drag = _resolveDirective(\"disable-drag\")!\n\n  return _withDirectives((_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createElementVNode(\"div\", _hoisted_2, [\n      _createElementVNode(\"div\", _hoisted_3, [\n        _createElementVNode(\"div\", _hoisted_4, null, 512),\n        (_ctx.starVisible)\n          ? (_openBlock(), _createElementBlock(\"img\", {\n              key: 0,\n              class: \"star-symbol\",\n              src: _imports_0,\n              width: \"38\",\n              height: \"38\",\n              alt: \n            _ctx.$gettext(\n              'Ein goldener Stern, der den Abschluss der Aufgabe mit perfekter Leistung anzeigt'\n            )\n          \n            }, null, 8, _hoisted_5))\n          : _createCommentVNode(\"\", true)\n      ]),\n      (_ctx.resultMessage)\n        ? (_openBlock(), _createElementBlock(\"div\", {\n            key: 0,\n            class: \"result-text\",\n            textContent: _toDisplayString(_ctx.resultMessage)\n          }, null, 8, _hoisted_6))\n        : _createCommentVNode(\"\", true)\n    ]),\n    (_ctx.feedbackMessage)\n      ? (_openBlock(), _createElementBlock(\"div\", {\n          key: 0,\n          class: \"feedback-text\",\n          textContent: _toDisplayString(_ctx.feedbackMessage)\n        }, null, 8, _hoisted_7))\n      : _createCommentVNode(\"\", true)\n  ])), [\n    [_directive_disable_drag]\n  ])\n}","<template>\n  <div class=\"feedback-container\" v-disable-drag>\n    <div class=\"meter-container\">\n      <div class=\"meter-background\">\n        <div class=\"meter-bar\" ref=\"meterBar\" />\n        <img\n          v-if=\"starVisible\"\n          class=\"star-symbol\"\n          src=\"../assets/star.png\"\n          width=\"38\"\n          height=\"38\"\n          :alt=\"\n            $gettext(\n              'Ein goldener Stern, der den Abschluss der Aufgabe mit perfekter Leistung anzeigt'\n            )\n          \"\n        />\n      </div>\n      <div v-if=\"resultMessage\" class=\"result-text\" v-text=\"resultMessage\" />\n    </div>\n    <div\n      v-if=\"feedbackMessage\"\n      class=\"feedback-text\"\n      v-text=\"feedbackMessage\"\n    />\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, nextTick, PropType } from 'vue';\nimport { Feedback } from '@/models/common';\nimport { round } from 'lodash';\n\nexport default defineComponent({\n  name: 'FeedbackElement',\n  props: {\n    achievedPoints: Number,\n    maxPoints: Number,\n    resultMessage: String,\n    feedback: Object as PropType<Feedback[]>,\n  },\n  data() {\n    return {\n      starVisible: false,\n    };\n  },\n  mounted() {\n    this.adjustBarWidth();\n  },\n  watch: {\n    achievedPoints: {\n      immediate: true,\n      handler: function (): void {\n        this.adjustBarWidth();\n        if (this.achievedMaxPoints) {\n          // Show the star after the meter filled up\n          setTimeout(() => {\n            this.starVisible = true;\n          }, 350);\n        } else {\n          this.starVisible = false;\n        }\n      },\n    },\n  },\n  methods: {\n    async adjustBarWidth() {\n      // Wait for the next DOM update cycle\n      await nextTick();\n\n      const meterBar = this.$refs.meterBar as HTMLElement;\n      if (meterBar) {\n        // Trigger a reflow to ensure the width change is animated\n        meterBar.offsetHeight;\n\n        meterBar.style.width = `${this.percentageCorrect}%`;\n      }\n    },\n\n    urlForIcon(iconName: string) {\n      return (\n        window.STUDIP.ASSETS_URL + 'images/icons/blue/' + iconName + '.svg'\n      );\n    },\n  },\n  computed: {\n    feedbackSortedByScore(): Feedback[] {\n      if (this.feedback) {\n        return this.feedback\n          .map((value) => value)\n          .sort((a, b) => b.percentage - a.percentage);\n      }\n      return [];\n    },\n\n    feedbackMessage(): string | undefined {\n      if (\n        typeof this.achievedPoints === 'undefined' ||\n        typeof this.maxPoints === 'undefined'\n      ) {\n        return undefined;\n      }\n\n      const percentageCorrect = round(\n        (this.achievedPoints / this.maxPoints) * 100\n      );\n\n      for (const feedback of this.feedbackSortedByScore) {\n        if (percentageCorrect >= feedback.percentage) {\n          return feedback.message;\n        }\n      }\n\n      return undefined;\n    },\n\n    percentageCorrect(): number {\n      if (this.achievedPoints && this.maxPoints)\n        return round((this.achievedPoints / this.maxPoints) * 100);\n      else return 0;\n    },\n\n    achievedMaxPoints(): boolean {\n      return this.achievedPoints === this.maxPoints;\n    },\n  },\n});\n</script>\n\n<style scoped>\n.feedback-container {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  gap: 0.75em;\n}\n\n.meter-container {\n  display: flex;\n  flex-direction: row;\n  flex-wrap: nowrap;\n  justify-content: flex-start;\n  align-items: center;\n  gap: 1.5em;\n  border: 1px solid rgba(0, 0, 0, 0.08);\n  border-radius: 2em;\n  padding: 6px 12px 6px 12px;\n}\n\n.meter-background {\n  flex-shrink: 0;\n  background: #e0e0e0;\n  border: 1px solid #ccc;\n  border-radius: 5px;\n  width: 140px;\n  height: 16px;\n  margin-top: 0.5em;\n  margin-bottom: 0.5em;\n  position: relative;\n}\n\n.meter-bar {\n  height: 100%;\n  background: linear-gradient(to right, #34a86e, #2b8c5c);\n  width: 0; /* Initial width is 0% */\n  transition: width 0.5s ease; /* Smooth fade-in */\n}\n\n.star-symbol {\n  position: absolute;\n  right: -23px;\n  top: -14px;\n  animation: pulse 0.5s ease-in-out 0s 1;\n}\n\n@keyframes pulse {\n  0% {\n    transform: scale(0.85);\n  }\n  50% {\n    transform: scale(1.15);\n  }\n  100% {\n    transform: scale(1);\n  }\n}\n\n.result-text {\n  min-width: 0;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n  overflow: hidden;\n  font-size: 1em;\n  font-weight: bold;\n  color: #000;\n}\n\n.feedback-text {\n  font-size: 1.25em;\n  font-weight: bold;\n  color: #1a73d9;\n}\n</style>\n","import { render } from \"./FeedbackElement.vue?vue&type=template&id=7585ad83&scoped=true&ts=true\"\nimport script from \"./FeedbackElement.vue?vue&type=script&lang=ts\"\nexport * from \"./FeedbackElement.vue?vue&type=script&lang=ts\"\n\nimport \"./FeedbackElement.vue?vue&type=style&index=0&id=7585ad83&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-7585ad83\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { withModifiers as _withModifiers, normalizeStyle as _normalizeStyle, createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, createCommentVNode as _createCommentVNode, unref as _unref, createBlock as _createBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-04ae3bd4\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"stud5p-task\" }\nconst _hoisted_2 = {\n  key: 0,\n  class: \"canvas-and-hints-list-container\"\n}\nconst _hoisted_3 = [\"width\", \"height\"]\nconst _hoisted_4 = { class: \"hint-list\" }\nconst _hoisted_5 = [\"onClick\"]\nconst _hoisted_6 = { key: 1 }\nconst _hoisted_7 = { class: \"feedback-and-button-container\" }\nconst _hoisted_8 = { class: \"feedback-container\" }\nconst _hoisted_9 = { class: \"button-panel\" }\nconst _hoisted_10 = [\"textContent\"]\nconst _hoisted_11 = [\"textContent\"]\nconst _hoisted_12 = [\"textContent\"]\n\nimport {\n  computed,\n  onBeforeUnmount,\n  onMounted,\n  PropType,\n  ref,\n  watch,\n} from 'vue';\nimport { CrosswordTask, Word } from '@/models/CrosswordTask';\nimport { $gettext } from '@/language/gettext';\nimport FeedbackElement from '@/components/FeedbackElement.vue';\n\ntype Cell = { x: number; y: number; letter: string };\ntype Path = Cell[];\ntype PlacedWord = Word & { path: Path };\n\n// Props\n\nexport default /*#__PURE__*/_defineComponent({\n  props: {\n  task: {\n    type: Object as PropType<CrosswordTask>,\n    required: true,\n  },\n},\n  setup(__props) {\n\nconst props = __props\n\nconst debug = window.STUDIP.LernmoduleVueJS.LERNMODULE_DEBUG;\n\n// Types\n\n\n// Refs\nconst canvasWrapperRef = ref<HTMLElement | null>(null);\nconst canvasRef = ref<HTMLCanvasElement | null>(null);\n\n// State\nconst selectedCell = ref<Cell>();\nconst selectedWord = ref<PlacedWord>();\nconst solutionGrid = ref<string[][]>([]);\nconst userInputGrid = ref<string[][]>([]);\nconst taskSubmitted = ref<boolean>(false);\nconst showSolutions = ref<boolean>(false);\nconst placedWords = ref<PlacedWord[]>([]);\nconst canvasSize = ref(0);\n\n// Lifecycle Hooks\n\nonMounted(() => {\n  initializeGrids();\n  updateCanvasSize();\n  drawGrid();\n  window.addEventListener('resize', updateCanvasSize);\n});\nonBeforeUnmount(() => {\n  window.removeEventListener('resize', updateCanvasSize);\n});\n\n// Computed properties\nconst gridSize = computed(() => {\n  let size = 0;\n\n  words.value.forEach((word) => {\n    if (word.direction === 'across') {\n      if (word.x + word.solution.length > size) {\n        size = word.x + word.solution.length;\n      }\n    } else if (word.direction === 'down') {\n      if (word.y + word.solution.length > size) {\n        size = word.y + word.solution.length;\n      }\n    }\n  });\n\n  if (debug) console.log('Grid size is', size, 'x', size);\n\n  return size;\n});\n\nconst cellSize = computed(() =>\n  gridSize.value > 0 ? Math.floor(canvasSize.value / gridSize.value) : 0\n);\n\nconst fontSize = computed(() =>\n  cellSize.value > 0 ? Math.floor(cellSize.value / 2) : 0\n);\n\nconst words = computed(() => {\n  if (props.task?.words) {\n    return props.task.words;\n  }\n  return [];\n});\n\nconst maxScore = computed(() => {\n  let maxScore = 0;\n  for (let x = 0; x < gridSize.value; x++) {\n    for (let y = 0; y < gridSize.value; y++) {\n      if (solutionGrid.value[x][y]) {\n        maxScore++;\n      }\n    }\n  }\n  return maxScore;\n});\n\nconst score = computed(() => {\n  let score = 0;\n  for (let x = 0; x < gridSize.value; x++) {\n    for (let y = 0; y < gridSize.value; y++) {\n      if (\n        solutionGrid.value[x][y] &&\n        userInputGrid.value[x][y] === solutionGrid.value[x][y]\n      ) {\n        score++;\n      }\n    }\n  }\n  return score;\n});\n\nconst resultMessage = computed(() => {\n  let result = props.task.strings.resultMessage.replace(\n    ':correct',\n    score.value.toString()\n  );\n  result = result.replace(':total', maxScore.value.toString());\n\n  return result;\n});\n\nconst showCheckButton = computed(() => {\n  return !taskSubmitted.value;\n});\n\n// Watchers\nwatch(\n  () => props.task,\n  () => {\n    initializeGrids();\n    if (canvasRef.value) {\n      if (canvasRef.value.getContext('2d')) {\n        canvasRef.value\n          ?.getContext('2d')\n          ?.clearRect(0, 0, canvasRef.value.width, canvasRef.value.height);\n      }\n    }\n    drawGrid();\n  },\n  { deep: true }\n);\n\nwatch(\n  () => userInputGrid.value,\n  () => {\n    drawGrid();\n  },\n  { deep: true }\n);\n\nwatch(\n  () => selectedCell.value,\n  () => {\n    drawGrid();\n    if (debug) {\n      console.log(\n        'selected cell:',\n        selectedCell.value?.x,\n        selectedCell.value?.y\n      );\n    }\n  },\n  { deep: true }\n);\n\nwatch(\n  () => selectedWord.value,\n  () => {\n    drawGrid();\n    if (debug) {\n      console.log('selected word:', selectedWord.value?.solution);\n    }\n  },\n  { deep: true }\n);\n\n// Functions\nfunction updateCanvasSize() {\n  const wrapper = canvasWrapperRef.value;\n  if (!wrapper) return;\n  canvasSize.value = Math.floor(\n    Math.min(wrapper.clientWidth, wrapper.clientHeight)\n  );\n}\n\nfunction onClickCheck(): void {\n  taskSubmitted.value = true;\n  selectedCell.value = undefined;\n  selectedWord.value = undefined;\n}\n\nfunction onClickRetry(): void {\n  taskSubmitted.value = false;\n  showSolutions.value = false;\n  selectedCell.value = undefined;\n  initializeGrids();\n  drawGrid();\n}\n\nfunction onClickShowSolutions(): void {\n  showSolutions.value = true;\n  selectedCell.value = undefined;\n  selectedWord.value = undefined;\n  drawGrid();\n}\n\nfunction initializeGrids() {\n  selectedWord.value = undefined;\n  selectedCell.value = undefined;\n\n  solutionGrid.value = Array.from({ length: gridSize.value }, () =>\n    Array.from({ length: gridSize.value }, () => '')\n  );\n\n  userInputGrid.value = Array.from({ length: gridSize.value }, () =>\n    Array.from({ length: gridSize.value }, () => '')\n  );\n\n  // Create a path for each word based on it's starting coordinates and direction\n  placedWords.value = words.value.map((word) => ({\n    ...word,\n    path: createWordPath(word),\n  }));\n\n  // Place each word in the solution grid\n  for (const word of placedWords.value) {\n    for (const cell of word.path) {\n      solutionGrid.value[cell.x][cell.y] = cell.letter;\n    }\n  }\n}\n\n/**\n * Creates a path (set of coordinates) based on the starting coordinates and direction of the word\n *\n * @param word\n */\nfunction createWordPath(word: Word): Path {\n  let path = [];\n\n  const directionalDeltas = {\n    across: { dx: 1, dy: 0 },\n    down: { dx: 0, dy: 1 },\n  };\n  const { dx, dy } =\n    directionalDeltas[word.direction as keyof typeof directionalDeltas];\n\n  const length = word.solution.length;\n\n  for (let i = 0; i < length; i++) {\n    const x = word.x + dx * i;\n    const y = word.y + dy * i;\n    path.push({ x: x, y: y, letter: word.solution[i].toUpperCase() });\n  }\n\n  return path;\n}\n\nfunction drawGrid() {\n  const canvas = canvasRef.value;\n  if (!canvas) {\n    console.error('No Canvas');\n    return;\n  }\n  const ctx = canvas.getContext('2d');\n  if (!ctx) {\n    return;\n  }\n\n  ctx.clearRect(0, 0, canvas.width, canvas.height);\n\n  // Highlight the selected word\n  selectedWord.value?.path.forEach((cell) => {\n    fillCell(cell, 'rgba(140, 180, 255, 0.13)');\n  });\n\n  // Highlight the selected cell\n  if (selectedCell.value) {\n    fillCell(selectedCell.value, 'rgba(140, 180, 255, 0.34)');\n  }\n\n  for (let x = 0; x < gridSize.value; x++) {\n    for (let y = 0; y < gridSize.value; y++) {\n      // Draw the grid lines around letters of the solution grid\n      if (solutionGrid.value[x][y]) {\n        ctx.strokeStyle = 'gainsboro';\n        ctx.strokeRect(\n          x * cellSize.value,\n          y * cellSize.value,\n          cellSize.value,\n          cellSize.value\n        );\n      } else if (props.task?.colorEmptyCells) {\n        ctx.fillStyle = 'rgba(129,129,129,0.1)';\n        ctx.fillRect(\n          x * cellSize.value,\n          y * cellSize.value,\n          cellSize.value,\n          cellSize.value\n        );\n      }\n\n      // If the task is submitted, color the cells depending on if they're correct or incorrect\n      if (\n        taskSubmitted.value &&\n        !showSolutions.value &&\n        userInputGrid.value[x][y]\n      ) {\n        if (userInputGrid.value[x][y] === solutionGrid.value[x][y]) {\n          ctx.fillStyle = '#9dd8bb';\n          ctx.fillRect(\n            x * cellSize.value,\n            y * cellSize.value,\n            cellSize.value,\n            cellSize.value\n          );\n        } else {\n          ctx.fillStyle = '#f7d0d0';\n          ctx.fillRect(\n            x * cellSize.value,\n            y * cellSize.value,\n            cellSize.value,\n            cellSize.value\n          );\n        }\n      }\n\n      // Draw the solutions or the user input\n      ctx.font = 'bold ' + fontSize.value + 'px calibri';\n      ctx.textAlign = 'center';\n      ctx.textBaseline = 'middle';\n\n      if (showSolutions.value) {\n        ctx.fillStyle = '#404040';\n        ctx.fillText(\n          solutionGrid.value[x][y],\n          x * cellSize.value + cellSize.value / 2,\n          y * cellSize.value + cellSize.value / 2\n        );\n      } else {\n        ctx.fillStyle = '#404040';\n        ctx.fillText(\n          userInputGrid.value[x][y],\n          x * cellSize.value + cellSize.value / 2,\n          y * cellSize.value + cellSize.value / 2\n        );\n      }\n    }\n  }\n}\n\nfunction onPointerDownCanvas(event: PointerEvent) {\n  if (taskSubmitted.value) return;\n\n  // Find the coordinates of the cell under the cursor\n  const cellCoordinates = getCellCoordinatesUnderCursor(event);\n  if (!cellCoordinates) return;\n\n  // Select it if it's part of the solution grid\n  if (solutionGrid.value[cellCoordinates.x][cellCoordinates.y] !== '') {\n    selectedCell.value = {\n      x: cellCoordinates.x,\n      y: cellCoordinates.y,\n      letter: solutionGrid.value[cellCoordinates.x][cellCoordinates.y],\n    };\n  } else {\n    selectedCell.value = undefined;\n    selectedWord.value = undefined;\n  }\n\n  // Find and set the selected word based on the selected cell\n  if (\n    selectedCell.value &&\n    selectedCell.value.x !== undefined &&\n    selectedCell.value.y !== undefined\n  ) {\n    const selectableWords = placedWords.value.filter((word) => {\n      return word.path.some(\n        (cell) =>\n          cell.x === selectedCell.value!.x && cell.y === selectedCell.value!.y\n      );\n    });\n\n    if (selectableWords) {\n      if (selectableWords.length === 1) {\n        selectedWord.value = selectableWords[0];\n      } else if (selectableWords.length === 2) {\n        if (selectedWord.value === selectableWords[0]) {\n          selectedWord.value = selectableWords[1];\n        } else {\n          selectedWord.value = selectableWords[0];\n        }\n      }\n    }\n  }\n}\n\nfunction onKeyDownCanvas(event: KeyboardEvent) {\n  if (taskSubmitted.value) {\n    return;\n  }\n\n  if (selectedCell.value) {\n    // Check if the key is a letter and place it in the grid\n    if (event.key.match(/^[a-zA-Z]$/)) {\n      userInputGrid.value[selectedCell.value.x][selectedCell.value.y] =\n        event.key.toUpperCase();\n\n      // Jump to the next cell in the selected word or the next word if it was the last cell\n      if (selectedWord.value) {\n        const indexOfCellInWord = selectedWord.value.path.findIndex((cell) => {\n          return (\n            cell.x === selectedCell.value!.x && cell.y === selectedCell.value!.y\n          );\n        });\n        if (indexOfCellInWord < selectedWord.value.path.length - 1) {\n          selectedCell.value = selectedWord.value.path[indexOfCellInWord + 1];\n        } else if (indexOfCellInWord === selectedWord.value.path.length - 1) {\n          const currentWordIndex = placedWords.value.findIndex((word) => {\n            return word.uuid == selectedWord.value?.uuid;\n          });\n          if (currentWordIndex < placedWords.value.length - 1) {\n            selectedWord.value = placedWords.value[currentWordIndex + 1];\n            selectedCell.value = selectedWord.value.path[0];\n          }\n        }\n      }\n    } else if (event.key === 'Backspace') {\n      userInputGrid.value[selectedCell.value.x][selectedCell.value.y] = '';\n\n      // Jump to the previous cell in the word\n      if (selectedWord.value) {\n        const indexOfCellInWord = selectedWord.value.path.findIndex((cell) => {\n          return (\n            cell.x === selectedCell.value!.x && cell.y === selectedCell.value!.y\n          );\n        });\n        if (indexOfCellInWord > 0) {\n          selectedCell.value = selectedWord.value.path[indexOfCellInWord - 1];\n        }\n      }\n    } else if (event.key === 'Delete') {\n      userInputGrid.value[selectedCell.value.x][selectedCell.value.y] = '';\n\n      // Jump to the next cell in the selected word\n      if (selectedWord.value) {\n        const indexOfCellInWord = selectedWord.value.path.findIndex((cell) => {\n          return (\n            cell.x === selectedCell.value!.x && cell.y === selectedCell.value!.y\n          );\n        });\n        if (indexOfCellInWord < selectedWord.value.path.length - 1) {\n          selectedCell.value = selectedWord.value.path[indexOfCellInWord + 1];\n        }\n      }\n    } else if (\n      ['ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight'].includes(event.key)\n    ) {\n      event.preventDefault(); // don't scroll up or down with arrow keys while canvas is focussed\n      if (selectedWord.value) {\n        const indexOfCellInWord = selectedWord.value.path.findIndex((cell) => {\n          return (\n            cell.x === selectedCell.value!.x && cell.y === selectedCell.value!.y\n          );\n        });\n        if (selectedWord.value.direction === 'across') {\n          if (event.key === 'ArrowLeft') {\n            // select previous cell in across word\n            if (indexOfCellInWord > 0) {\n              selectedCell.value =\n                selectedWord.value.path[indexOfCellInWord - 1];\n            } else if (indexOfCellInWord === 0) {\n              selectedCell.value =\n                selectedWord.value.path[selectedWord.value.path.length - 1];\n            }\n          } else if (event.key === 'ArrowRight') {\n            // select next cell in across word\n            if (indexOfCellInWord < selectedWord.value.path.length - 1) {\n              selectedCell.value =\n                selectedWord.value.path[indexOfCellInWord + 1];\n            } else if (\n              indexOfCellInWord ===\n              selectedWord.value.path.length - 1\n            ) {\n              selectedCell.value = selectedWord.value.path[0];\n            }\n          } else if (event.key === 'ArrowUp') {\n            // if there is an occupied cell above the currently selected cell, select that one and select the corresponding word\n            const wordAbove = placedWords.value.find((word) => {\n              return word.path.some((cell) => {\n                return (\n                  cell.x === selectedCell.value!.x &&\n                  cell.y === selectedCell.value!.y - 1\n                );\n              });\n            });\n            if (wordAbove) {\n              selectedWord.value = wordAbove;\n              selectedCell.value = wordAbove.path.find((cell) => {\n                return (\n                  cell.x === selectedCell.value!.x &&\n                  cell.y === selectedCell.value!.y - 1\n                );\n              });\n            }\n          } else if (event.key === 'ArrowDown') {\n            // if there is an occupied cell below the currently selected cell, select that one and select the corresponding word\n            const wordBelow = placedWords.value.find((word) => {\n              return word.path.some((cell) => {\n                return (\n                  cell.x === selectedCell.value!.x &&\n                  cell.y === selectedCell.value!.y + 1\n                );\n              });\n            });\n            if (wordBelow) {\n              selectedWord.value = wordBelow;\n              selectedCell.value = wordBelow.path.find((cell) => {\n                return (\n                  cell.x === selectedCell.value!.x &&\n                  cell.y === selectedCell.value!.y + 1\n                );\n              });\n            }\n          }\n        } else if (selectedWord.value.direction === 'down') {\n          if (event.key === 'ArrowUp') {\n            // select previous cell in down word\n            if (indexOfCellInWord > 0) {\n              selectedCell.value =\n                selectedWord.value.path[indexOfCellInWord - 1];\n            } else if (indexOfCellInWord === 0) {\n              selectedCell.value =\n                selectedWord.value.path[selectedWord.value.path.length - 1];\n            }\n          } else if (event.key === 'ArrowDown') {\n            // select next cell in down word\n            if (indexOfCellInWord < selectedWord.value.path.length - 1) {\n              selectedCell.value =\n                selectedWord.value.path[indexOfCellInWord + 1];\n            } else if (\n              indexOfCellInWord ===\n              selectedWord.value.path.length - 1\n            ) {\n              selectedCell.value = selectedWord.value.path[0];\n            }\n          } else if (event.key === 'ArrowLeft') {\n            // if there is an occupied cell left of the currently selected cell, select that one and select the corresponding word\n            const wordToTheLeft = placedWords.value.find((word) => {\n              return word.path.some((cell) => {\n                return (\n                  cell.x === selectedCell.value!.x - 1 &&\n                  cell.y === selectedCell.value!.y\n                );\n              });\n            });\n            if (wordToTheLeft) {\n              selectedWord.value = wordToTheLeft;\n              selectedCell.value = wordToTheLeft.path.find((cell) => {\n                return (\n                  cell.x === selectedCell.value!.x - 1 &&\n                  cell.y === selectedCell.value!.y\n                );\n              });\n            }\n          } else if (event.key === 'ArrowRight') {\n            // if there is an occupied cell right of the currently selected cell, select that one and select the corresponding word\n            const wordToTheRight = placedWords.value.find((word) => {\n              return word.path.some((cell) => {\n                return (\n                  cell.x === selectedCell.value!.x + 1 &&\n                  cell.y === selectedCell.value!.y\n                );\n              });\n            });\n            if (wordToTheRight) {\n              selectedWord.value = wordToTheRight;\n              selectedCell.value = wordToTheRight.path.find((cell) => {\n                return (\n                  cell.x === selectedCell.value!.x + 1 &&\n                  cell.y === selectedCell.value!.y\n                );\n              });\n            }\n          }\n        }\n      }\n    } else if (event.key === 'Tab') {\n      event.preventDefault();\n\n      const currentWordIndex = placedWords.value.findIndex((word) => {\n        return word === selectedWord.value;\n      });\n\n      if (event.shiftKey) {\n        if (currentWordIndex > 0) {\n          selectedWord.value = placedWords.value[currentWordIndex - 1];\n        } else {\n          selectedWord.value = placedWords.value[placedWords.value.length - 1];\n        }\n      } else {\n        if (currentWordIndex < placedWords.value.length - 1) {\n          selectedWord.value = placedWords.value[currentWordIndex + 1];\n        } else {\n          selectedWord.value = placedWords.value[0];\n        }\n      }\n\n      selectedCell.value = selectedWord.value?.path[0];\n    }\n  } else {\n    // If we currently don't have any word and cell selected, pressing tab or an arrow key selects the first cell of the first word\n    if (\n      ['ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight', 'Tab'].includes(\n        event.key\n      )\n    ) {\n      event.preventDefault(); // don't scroll up or down with arrow keys while canvas is focussed\n      selectedWord.value = placedWords.value[0];\n      selectedCell.value = selectedWord.value.path[0];\n    }\n  }\n}\n\nfunction onClickHint(word: Word) {\n  if (debug) console.log('Clicked on hint:', word.hint);\n\n  if (taskSubmitted.value) return;\n\n  selectedWord.value = placedWords.value.find(\n    (value) => value.uuid === word.uuid\n  );\n  selectedCell.value = selectedWord.value?.path[0];\n\n  canvasRef.value?.focus();\n}\n\nfunction getCellCoordinatesUnderCursor(event: PointerEvent):\n  | {\n      x: number;\n      y: number;\n    }\n  | undefined {\n  if (!canvasRef.value) return;\n\n  const rect = canvasRef.value.getBoundingClientRect();\n  const x = event.clientX - rect.left;\n  const y = event.clientY - rect.top;\n  const cellX = Math.max(\n    0,\n    Math.min(Math.floor(x / cellSize.value), gridSize.value - 1)\n  );\n  const cellY = Math.max(\n    0,\n    Math.min(Math.floor(y / cellSize.value), gridSize.value - 1)\n  );\n\n  return { x: cellX, y: cellY };\n}\n\nfunction fillCell(cell: Cell, fillStyle: string) {\n  if (\n    cell.x < 0 ||\n    cell.x > gridSize.value - 1 ||\n    cell.y < 0 ||\n    cell.y > gridSize.value - 1\n  ) {\n    return;\n  }\n\n  if (!canvasRef.value) return;\n  const ctx = canvasRef.value.getContext('2d');\n\n  if (ctx) {\n    ctx.fillStyle = fillStyle;\n    ctx.fillRect(\n      cell.x * cellSize.value,\n      cell.y * cellSize.value,\n      cellSize.value,\n      cellSize.value\n    );\n  }\n}\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    (props.task?.words.length > 0)\n      ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n          _createElementVNode(\"div\", {\n            ref_key: \"canvasWrapperRef\",\n            ref: canvasWrapperRef,\n            class: \"canvas-wrapper\"\n          }, [\n            _createElementVNode(\"canvas\", {\n              ref_key: \"canvasRef\",\n              ref: canvasRef,\n              tabindex: \"0\",\n              width: canvasSize.value,\n              height: canvasSize.value,\n              style: _normalizeStyle({ width: canvasSize.value + 'px', height: canvasSize.value + 'px' }),\n              onPointerdown: _cache[0] || (_cache[0] = _withModifiers(($event: any) => (onPointerDownCanvas($event)), [\"stop\"])),\n              onKeydown: _cache[1] || (_cache[1] = _withModifiers(($event: any) => (onKeyDownCanvas($event)), [\"stop\"])),\n              class: \"canvas\"\n            }, null, 44, _hoisted_3)\n          ], 512),\n          _createElementVNode(\"div\", _hoisted_4, [\n            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(props.task?.words, (word) => {\n              return (_openBlock(), _createElementBlock(\"div\", {\n                key: word.uuid,\n                onClick: ($event: any) => (onClickHint(word)),\n                class: _normalizeClass([\"hint\", { 'selected-hint': selectedWord.value?.uuid === word.uuid }])\n              }, _toDisplayString(word.hint), 11, _hoisted_5))\n            }), 128))\n          ])\n        ]))\n      : (_openBlock(), _createElementBlock(\"div\", _hoisted_6, _toDisplayString(_unref($gettext)('Fgen Sie Wrter hinzu um ein Kreuzwortrtsel zu erstellen.')), 1)),\n    _createElementVNode(\"div\", _hoisted_7, [\n      _createElementVNode(\"div\", _hoisted_8, [\n        (taskSubmitted.value)\n          ? (_openBlock(), _createBlock(FeedbackElement, {\n              key: 0,\n              achievedPoints: _unref(score),\n              maxPoints: _unref(maxScore),\n              \"result-message\": _unref(resultMessage)\n            }, null, 8, [\"achievedPoints\", \"maxPoints\", \"result-message\"]))\n          : _createCommentVNode(\"\", true)\n      ]),\n      _createElementVNode(\"div\", _hoisted_9, [\n        (_unref(showCheckButton))\n          ? (_openBlock(), _createElementBlock(\"button\", {\n              key: 0,\n              textContent: _toDisplayString(__props.task.strings.checkButton),\n              onClick: onClickCheck,\n              type: \"button\",\n              class: \"stud5p-button\"\n            }, null, 8, _hoisted_10))\n          : _createCommentVNode(\"\", true),\n        (taskSubmitted.value)\n          ? (_openBlock(), _createElementBlock(\"button\", {\n              key: 1,\n              textContent: _toDisplayString(__props.task.strings.retryButton),\n              onClick: onClickRetry,\n              type: \"button\",\n              class: \"stud5p-button\"\n            }, null, 8, _hoisted_11))\n          : _createCommentVNode(\"\", true),\n        (taskSubmitted.value && !showSolutions.value)\n          ? (_openBlock(), _createElementBlock(\"button\", {\n              key: 2,\n              textContent: _toDisplayString(__props.task.strings.solutionsButton),\n              onClick: onClickShowSolutions,\n              type: \"button\",\n              class: \"stud5p-button\"\n            }, null, 8, _hoisted_12))\n          : _createCommentVNode(\"\", true)\n      ])\n    ])\n  ]))\n}\n}\n\n})","<template>\n  <div class=\"stud5p-task\">\n    <template v-if=\"props.task?.words.length > 0\">\n      <div class=\"canvas-and-hints-list-container\">\n        <div ref=\"canvasWrapperRef\" class=\"canvas-wrapper\">\n          <!-- tabindex=\"0\" is needed to make the canvas focusable and the keydown listener to work -->\n          <canvas\n            ref=\"canvasRef\"\n            tabindex=\"0\"\n            :width=\"canvasSize\"\n            :height=\"canvasSize\"\n            :style=\"{ width: canvasSize + 'px', height: canvasSize + 'px' }\"\n            @pointerdown.stop=\"onPointerDownCanvas($event)\"\n            @keydown.stop=\"onKeyDownCanvas($event)\"\n            class=\"canvas\"\n          />\n        </div>\n        <div class=\"hint-list\">\n          <div\n            v-for=\"word in props.task?.words\"\n            :key=\"word.uuid\"\n            @click=\"onClickHint(word)\"\n            class=\"hint\"\n            :class=\"{ 'selected-hint': selectedWord?.uuid === word.uuid }\"\n          >\n            {{ word.hint }}\n          </div>\n        </div>\n      </div>\n    </template>\n    <div v-else>\n      {{\n        $gettext('Fgen Sie Wrter hinzu um ein Kreuzwortrtsel zu erstellen.')\n      }}\n    </div>\n    <div class=\"feedback-and-button-container\">\n      <div class=\"feedback-container\">\n        <FeedbackElement\n          v-if=\"taskSubmitted\"\n          :achievedPoints=\"score\"\n          :maxPoints=\"maxScore\"\n          :result-message=\"resultMessage\"\n        />\n      </div>\n      <div class=\"button-panel\">\n        <button\n          v-if=\"showCheckButton\"\n          v-text=\"task.strings.checkButton\"\n          @click=\"onClickCheck\"\n          type=\"button\"\n          class=\"stud5p-button\"\n        />\n\n        <button\n          v-if=\"taskSubmitted\"\n          v-text=\"task.strings.retryButton\"\n          @click=\"onClickRetry\"\n          type=\"button\"\n          class=\"stud5p-button\"\n        />\n\n        <button\n          v-if=\"taskSubmitted && !showSolutions\"\n          v-text=\"task.strings.solutionsButton\"\n          @click=\"onClickShowSolutions\"\n          type=\"button\"\n          class=\"stud5p-button\"\n        />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport {\n  computed,\n  defineProps,\n  onBeforeUnmount,\n  onMounted,\n  PropType,\n  ref,\n  watch,\n} from 'vue';\nimport { CrosswordTask, Word } from '@/models/CrosswordTask';\nimport { $gettext } from '@/language/gettext';\nimport FeedbackElement from '@/components/FeedbackElement.vue';\n\nconst debug = window.STUDIP.LernmoduleVueJS.LERNMODULE_DEBUG;\n\n// Types\ntype Cell = { x: number; y: number; letter: string };\ntype Path = Cell[];\ntype PlacedWord = Word & { path: Path };\n\n// Props\nconst props = defineProps({\n  task: {\n    type: Object as PropType<CrosswordTask>,\n    required: true,\n  },\n});\n\n// Refs\nconst canvasWrapperRef = ref<HTMLElement | null>(null);\nconst canvasRef = ref<HTMLCanvasElement | null>(null);\n\n// State\nconst selectedCell = ref<Cell>();\nconst selectedWord = ref<PlacedWord>();\nconst solutionGrid = ref<string[][]>([]);\nconst userInputGrid = ref<string[][]>([]);\nconst taskSubmitted = ref<boolean>(false);\nconst showSolutions = ref<boolean>(false);\nconst placedWords = ref<PlacedWord[]>([]);\nconst canvasSize = ref(0);\n\n// Lifecycle Hooks\n\nonMounted(() => {\n  initializeGrids();\n  updateCanvasSize();\n  drawGrid();\n  window.addEventListener('resize', updateCanvasSize);\n});\nonBeforeUnmount(() => {\n  window.removeEventListener('resize', updateCanvasSize);\n});\n\n// Computed properties\nconst gridSize = computed(() => {\n  let size = 0;\n\n  words.value.forEach((word) => {\n    if (word.direction === 'across') {\n      if (word.x + word.solution.length > size) {\n        size = word.x + word.solution.length;\n      }\n    } else if (word.direction === 'down') {\n      if (word.y + word.solution.length > size) {\n        size = word.y + word.solution.length;\n      }\n    }\n  });\n\n  if (debug) console.log('Grid size is', size, 'x', size);\n\n  return size;\n});\n\nconst cellSize = computed(() =>\n  gridSize.value > 0 ? Math.floor(canvasSize.value / gridSize.value) : 0\n);\n\nconst fontSize = computed(() =>\n  cellSize.value > 0 ? Math.floor(cellSize.value / 2) : 0\n);\n\nconst words = computed(() => {\n  if (props.task?.words) {\n    return props.task.words;\n  }\n  return [];\n});\n\nconst maxScore = computed(() => {\n  let maxScore = 0;\n  for (let x = 0; x < gridSize.value; x++) {\n    for (let y = 0; y < gridSize.value; y++) {\n      if (solutionGrid.value[x][y]) {\n        maxScore++;\n      }\n    }\n  }\n  return maxScore;\n});\n\nconst score = computed(() => {\n  let score = 0;\n  for (let x = 0; x < gridSize.value; x++) {\n    for (let y = 0; y < gridSize.value; y++) {\n      if (\n        solutionGrid.value[x][y] &&\n        userInputGrid.value[x][y] === solutionGrid.value[x][y]\n      ) {\n        score++;\n      }\n    }\n  }\n  return score;\n});\n\nconst resultMessage = computed(() => {\n  let result = props.task.strings.resultMessage.replace(\n    ':correct',\n    score.value.toString()\n  );\n  result = result.replace(':total', maxScore.value.toString());\n\n  return result;\n});\n\nconst showCheckButton = computed(() => {\n  return !taskSubmitted.value;\n});\n\n// Watchers\nwatch(\n  () => props.task,\n  () => {\n    initializeGrids();\n    if (canvasRef.value) {\n      if (canvasRef.value.getContext('2d')) {\n        canvasRef.value\n          ?.getContext('2d')\n          ?.clearRect(0, 0, canvasRef.value.width, canvasRef.value.height);\n      }\n    }\n    drawGrid();\n  },\n  { deep: true }\n);\n\nwatch(\n  () => userInputGrid.value,\n  () => {\n    drawGrid();\n  },\n  { deep: true }\n);\n\nwatch(\n  () => selectedCell.value,\n  () => {\n    drawGrid();\n    if (debug) {\n      console.log(\n        'selected cell:',\n        selectedCell.value?.x,\n        selectedCell.value?.y\n      );\n    }\n  },\n  { deep: true }\n);\n\nwatch(\n  () => selectedWord.value,\n  () => {\n    drawGrid();\n    if (debug) {\n      console.log('selected word:', selectedWord.value?.solution);\n    }\n  },\n  { deep: true }\n);\n\n// Functions\nfunction updateCanvasSize() {\n  const wrapper = canvasWrapperRef.value;\n  if (!wrapper) return;\n  canvasSize.value = Math.floor(\n    Math.min(wrapper.clientWidth, wrapper.clientHeight)\n  );\n}\n\nfunction onClickCheck(): void {\n  taskSubmitted.value = true;\n  selectedCell.value = undefined;\n  selectedWord.value = undefined;\n}\n\nfunction onClickRetry(): void {\n  taskSubmitted.value = false;\n  showSolutions.value = false;\n  selectedCell.value = undefined;\n  initializeGrids();\n  drawGrid();\n}\n\nfunction onClickShowSolutions(): void {\n  showSolutions.value = true;\n  selectedCell.value = undefined;\n  selectedWord.value = undefined;\n  drawGrid();\n}\n\nfunction initializeGrids() {\n  selectedWord.value = undefined;\n  selectedCell.value = undefined;\n\n  solutionGrid.value = Array.from({ length: gridSize.value }, () =>\n    Array.from({ length: gridSize.value }, () => '')\n  );\n\n  userInputGrid.value = Array.from({ length: gridSize.value }, () =>\n    Array.from({ length: gridSize.value }, () => '')\n  );\n\n  // Create a path for each word based on it's starting coordinates and direction\n  placedWords.value = words.value.map((word) => ({\n    ...word,\n    path: createWordPath(word),\n  }));\n\n  // Place each word in the solution grid\n  for (const word of placedWords.value) {\n    for (const cell of word.path) {\n      solutionGrid.value[cell.x][cell.y] = cell.letter;\n    }\n  }\n}\n\n/**\n * Creates a path (set of coordinates) based on the starting coordinates and direction of the word\n *\n * @param word\n */\nfunction createWordPath(word: Word): Path {\n  let path = [];\n\n  const directionalDeltas = {\n    across: { dx: 1, dy: 0 },\n    down: { dx: 0, dy: 1 },\n  };\n  const { dx, dy } =\n    directionalDeltas[word.direction as keyof typeof directionalDeltas];\n\n  const length = word.solution.length;\n\n  for (let i = 0; i < length; i++) {\n    const x = word.x + dx * i;\n    const y = word.y + dy * i;\n    path.push({ x: x, y: y, letter: word.solution[i].toUpperCase() });\n  }\n\n  return path;\n}\n\nfunction drawGrid() {\n  const canvas = canvasRef.value;\n  if (!canvas) {\n    console.error('No Canvas');\n    return;\n  }\n  const ctx = canvas.getContext('2d');\n  if (!ctx) {\n    return;\n  }\n\n  ctx.clearRect(0, 0, canvas.width, canvas.height);\n\n  // Highlight the selected word\n  selectedWord.value?.path.forEach((cell) => {\n    fillCell(cell, 'rgba(140, 180, 255, 0.13)');\n  });\n\n  // Highlight the selected cell\n  if (selectedCell.value) {\n    fillCell(selectedCell.value, 'rgba(140, 180, 255, 0.34)');\n  }\n\n  for (let x = 0; x < gridSize.value; x++) {\n    for (let y = 0; y < gridSize.value; y++) {\n      // Draw the grid lines around letters of the solution grid\n      if (solutionGrid.value[x][y]) {\n        ctx.strokeStyle = 'gainsboro';\n        ctx.strokeRect(\n          x * cellSize.value,\n          y * cellSize.value,\n          cellSize.value,\n          cellSize.value\n        );\n      } else if (props.task?.colorEmptyCells) {\n        ctx.fillStyle = 'rgba(129,129,129,0.1)';\n        ctx.fillRect(\n          x * cellSize.value,\n          y * cellSize.value,\n          cellSize.value,\n          cellSize.value\n        );\n      }\n\n      // If the task is submitted, color the cells depending on if they're correct or incorrect\n      if (\n        taskSubmitted.value &&\n        !showSolutions.value &&\n        userInputGrid.value[x][y]\n      ) {\n        if (userInputGrid.value[x][y] === solutionGrid.value[x][y]) {\n          ctx.fillStyle = '#9dd8bb';\n          ctx.fillRect(\n            x * cellSize.value,\n            y * cellSize.value,\n            cellSize.value,\n            cellSize.value\n          );\n        } else {\n          ctx.fillStyle = '#f7d0d0';\n          ctx.fillRect(\n            x * cellSize.value,\n            y * cellSize.value,\n            cellSize.value,\n            cellSize.value\n          );\n        }\n      }\n\n      // Draw the solutions or the user input\n      ctx.font = 'bold ' + fontSize.value + 'px calibri';\n      ctx.textAlign = 'center';\n      ctx.textBaseline = 'middle';\n\n      if (showSolutions.value) {\n        ctx.fillStyle = '#404040';\n        ctx.fillText(\n          solutionGrid.value[x][y],\n          x * cellSize.value + cellSize.value / 2,\n          y * cellSize.value + cellSize.value / 2\n        );\n      } else {\n        ctx.fillStyle = '#404040';\n        ctx.fillText(\n          userInputGrid.value[x][y],\n          x * cellSize.value + cellSize.value / 2,\n          y * cellSize.value + cellSize.value / 2\n        );\n      }\n    }\n  }\n}\n\nfunction onPointerDownCanvas(event: PointerEvent) {\n  if (taskSubmitted.value) return;\n\n  // Find the coordinates of the cell under the cursor\n  const cellCoordinates = getCellCoordinatesUnderCursor(event);\n  if (!cellCoordinates) return;\n\n  // Select it if it's part of the solution grid\n  if (solutionGrid.value[cellCoordinates.x][cellCoordinates.y] !== '') {\n    selectedCell.value = {\n      x: cellCoordinates.x,\n      y: cellCoordinates.y,\n      letter: solutionGrid.value[cellCoordinates.x][cellCoordinates.y],\n    };\n  } else {\n    selectedCell.value = undefined;\n    selectedWord.value = undefined;\n  }\n\n  // Find and set the selected word based on the selected cell\n  if (\n    selectedCell.value &&\n    selectedCell.value.x !== undefined &&\n    selectedCell.value.y !== undefined\n  ) {\n    const selectableWords = placedWords.value.filter((word) => {\n      return word.path.some(\n        (cell) =>\n          cell.x === selectedCell.value!.x && cell.y === selectedCell.value!.y\n      );\n    });\n\n    if (selectableWords) {\n      if (selectableWords.length === 1) {\n        selectedWord.value = selectableWords[0];\n      } else if (selectableWords.length === 2) {\n        if (selectedWord.value === selectableWords[0]) {\n          selectedWord.value = selectableWords[1];\n        } else {\n          selectedWord.value = selectableWords[0];\n        }\n      }\n    }\n  }\n}\n\nfunction onKeyDownCanvas(event: KeyboardEvent) {\n  if (taskSubmitted.value) {\n    return;\n  }\n\n  if (selectedCell.value) {\n    // Check if the key is a letter and place it in the grid\n    if (event.key.match(/^[a-zA-Z]$/)) {\n      userInputGrid.value[selectedCell.value.x][selectedCell.value.y] =\n        event.key.toUpperCase();\n\n      // Jump to the next cell in the selected word or the next word if it was the last cell\n      if (selectedWord.value) {\n        const indexOfCellInWord = selectedWord.value.path.findIndex((cell) => {\n          return (\n            cell.x === selectedCell.value!.x && cell.y === selectedCell.value!.y\n          );\n        });\n        if (indexOfCellInWord < selectedWord.value.path.length - 1) {\n          selectedCell.value = selectedWord.value.path[indexOfCellInWord + 1];\n        } else if (indexOfCellInWord === selectedWord.value.path.length - 1) {\n          const currentWordIndex = placedWords.value.findIndex((word) => {\n            return word.uuid == selectedWord.value?.uuid;\n          });\n          if (currentWordIndex < placedWords.value.length - 1) {\n            selectedWord.value = placedWords.value[currentWordIndex + 1];\n            selectedCell.value = selectedWord.value.path[0];\n          }\n        }\n      }\n    } else if (event.key === 'Backspace') {\n      userInputGrid.value[selectedCell.value.x][selectedCell.value.y] = '';\n\n      // Jump to the previous cell in the word\n      if (selectedWord.value) {\n        const indexOfCellInWord = selectedWord.value.path.findIndex((cell) => {\n          return (\n            cell.x === selectedCell.value!.x && cell.y === selectedCell.value!.y\n          );\n        });\n        if (indexOfCellInWord > 0) {\n          selectedCell.value = selectedWord.value.path[indexOfCellInWord - 1];\n        }\n      }\n    } else if (event.key === 'Delete') {\n      userInputGrid.value[selectedCell.value.x][selectedCell.value.y] = '';\n\n      // Jump to the next cell in the selected word\n      if (selectedWord.value) {\n        const indexOfCellInWord = selectedWord.value.path.findIndex((cell) => {\n          return (\n            cell.x === selectedCell.value!.x && cell.y === selectedCell.value!.y\n          );\n        });\n        if (indexOfCellInWord < selectedWord.value.path.length - 1) {\n          selectedCell.value = selectedWord.value.path[indexOfCellInWord + 1];\n        }\n      }\n    } else if (\n      ['ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight'].includes(event.key)\n    ) {\n      event.preventDefault(); // don't scroll up or down with arrow keys while canvas is focussed\n      if (selectedWord.value) {\n        const indexOfCellInWord = selectedWord.value.path.findIndex((cell) => {\n          return (\n            cell.x === selectedCell.value!.x && cell.y === selectedCell.value!.y\n          );\n        });\n        if (selectedWord.value.direction === 'across') {\n          if (event.key === 'ArrowLeft') {\n            // select previous cell in across word\n            if (indexOfCellInWord > 0) {\n              selectedCell.value =\n                selectedWord.value.path[indexOfCellInWord - 1];\n            } else if (indexOfCellInWord === 0) {\n              selectedCell.value =\n                selectedWord.value.path[selectedWord.value.path.length - 1];\n            }\n          } else if (event.key === 'ArrowRight') {\n            // select next cell in across word\n            if (indexOfCellInWord < selectedWord.value.path.length - 1) {\n              selectedCell.value =\n                selectedWord.value.path[indexOfCellInWord + 1];\n            } else if (\n              indexOfCellInWord ===\n              selectedWord.value.path.length - 1\n            ) {\n              selectedCell.value = selectedWord.value.path[0];\n            }\n          } else if (event.key === 'ArrowUp') {\n            // if there is an occupied cell above the currently selected cell, select that one and select the corresponding word\n            const wordAbove = placedWords.value.find((word) => {\n              return word.path.some((cell) => {\n                return (\n                  cell.x === selectedCell.value!.x &&\n                  cell.y === selectedCell.value!.y - 1\n                );\n              });\n            });\n            if (wordAbove) {\n              selectedWord.value = wordAbove;\n              selectedCell.value = wordAbove.path.find((cell) => {\n                return (\n                  cell.x === selectedCell.value!.x &&\n                  cell.y === selectedCell.value!.y - 1\n                );\n              });\n            }\n          } else if (event.key === 'ArrowDown') {\n            // if there is an occupied cell below the currently selected cell, select that one and select the corresponding word\n            const wordBelow = placedWords.value.find((word) => {\n              return word.path.some((cell) => {\n                return (\n                  cell.x === selectedCell.value!.x &&\n                  cell.y === selectedCell.value!.y + 1\n                );\n              });\n            });\n            if (wordBelow) {\n              selectedWord.value = wordBelow;\n              selectedCell.value = wordBelow.path.find((cell) => {\n                return (\n                  cell.x === selectedCell.value!.x &&\n                  cell.y === selectedCell.value!.y + 1\n                );\n              });\n            }\n          }\n        } else if (selectedWord.value.direction === 'down') {\n          if (event.key === 'ArrowUp') {\n            // select previous cell in down word\n            if (indexOfCellInWord > 0) {\n              selectedCell.value =\n                selectedWord.value.path[indexOfCellInWord - 1];\n            } else if (indexOfCellInWord === 0) {\n              selectedCell.value =\n                selectedWord.value.path[selectedWord.value.path.length - 1];\n            }\n          } else if (event.key === 'ArrowDown') {\n            // select next cell in down word\n            if (indexOfCellInWord < selectedWord.value.path.length - 1) {\n              selectedCell.value =\n                selectedWord.value.path[indexOfCellInWord + 1];\n            } else if (\n              indexOfCellInWord ===\n              selectedWord.value.path.length - 1\n            ) {\n              selectedCell.value = selectedWord.value.path[0];\n            }\n          } else if (event.key === 'ArrowLeft') {\n            // if there is an occupied cell left of the currently selected cell, select that one and select the corresponding word\n            const wordToTheLeft = placedWords.value.find((word) => {\n              return word.path.some((cell) => {\n                return (\n                  cell.x === selectedCell.value!.x - 1 &&\n                  cell.y === selectedCell.value!.y\n                );\n              });\n            });\n            if (wordToTheLeft) {\n              selectedWord.value = wordToTheLeft;\n              selectedCell.value = wordToTheLeft.path.find((cell) => {\n                return (\n                  cell.x === selectedCell.value!.x - 1 &&\n                  cell.y === selectedCell.value!.y\n                );\n              });\n            }\n          } else if (event.key === 'ArrowRight') {\n            // if there is an occupied cell right of the currently selected cell, select that one and select the corresponding word\n            const wordToTheRight = placedWords.value.find((word) => {\n              return word.path.some((cell) => {\n                return (\n                  cell.x === selectedCell.value!.x + 1 &&\n                  cell.y === selectedCell.value!.y\n                );\n              });\n            });\n            if (wordToTheRight) {\n              selectedWord.value = wordToTheRight;\n              selectedCell.value = wordToTheRight.path.find((cell) => {\n                return (\n                  cell.x === selectedCell.value!.x + 1 &&\n                  cell.y === selectedCell.value!.y\n                );\n              });\n            }\n          }\n        }\n      }\n    } else if (event.key === 'Tab') {\n      event.preventDefault();\n\n      const currentWordIndex = placedWords.value.findIndex((word) => {\n        return word === selectedWord.value;\n      });\n\n      if (event.shiftKey) {\n        if (currentWordIndex > 0) {\n          selectedWord.value = placedWords.value[currentWordIndex - 1];\n        } else {\n          selectedWord.value = placedWords.value[placedWords.value.length - 1];\n        }\n      } else {\n        if (currentWordIndex < placedWords.value.length - 1) {\n          selectedWord.value = placedWords.value[currentWordIndex + 1];\n        } else {\n          selectedWord.value = placedWords.value[0];\n        }\n      }\n\n      selectedCell.value = selectedWord.value?.path[0];\n    }\n  } else {\n    // If we currently don't have any word and cell selected, pressing tab or an arrow key selects the first cell of the first word\n    if (\n      ['ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight', 'Tab'].includes(\n        event.key\n      )\n    ) {\n      event.preventDefault(); // don't scroll up or down with arrow keys while canvas is focussed\n      selectedWord.value = placedWords.value[0];\n      selectedCell.value = selectedWord.value.path[0];\n    }\n  }\n}\n\nfunction onClickHint(word: Word) {\n  if (debug) console.log('Clicked on hint:', word.hint);\n\n  if (taskSubmitted.value) return;\n\n  selectedWord.value = placedWords.value.find(\n    (value) => value.uuid === word.uuid\n  );\n  selectedCell.value = selectedWord.value?.path[0];\n\n  canvasRef.value?.focus();\n}\n\nfunction getCellCoordinatesUnderCursor(event: PointerEvent):\n  | {\n      x: number;\n      y: number;\n    }\n  | undefined {\n  if (!canvasRef.value) return;\n\n  const rect = canvasRef.value.getBoundingClientRect();\n  const x = event.clientX - rect.left;\n  const y = event.clientY - rect.top;\n  const cellX = Math.max(\n    0,\n    Math.min(Math.floor(x / cellSize.value), gridSize.value - 1)\n  );\n  const cellY = Math.max(\n    0,\n    Math.min(Math.floor(y / cellSize.value), gridSize.value - 1)\n  );\n\n  return { x: cellX, y: cellY };\n}\n\nfunction fillCell(cell: Cell, fillStyle: string) {\n  if (\n    cell.x < 0 ||\n    cell.x > gridSize.value - 1 ||\n    cell.y < 0 ||\n    cell.y > gridSize.value - 1\n  ) {\n    return;\n  }\n\n  if (!canvasRef.value) return;\n  const ctx = canvasRef.value.getContext('2d');\n\n  if (ctx) {\n    ctx.fillStyle = fillStyle;\n    ctx.fillRect(\n      cell.x * cellSize.value,\n      cell.y * cellSize.value,\n      cellSize.value,\n      cellSize.value\n    );\n  }\n}\n</script>\n\n<style scoped>\n.canvas-and-hints-list-container {\n  height: 60dvh;\n  display: flex;\n  flex-direction: row;\n  align-items: stretch; /** makes children match containers height **/\n}\n\n.canvas-wrapper {\n  flex: 1 1 auto;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  min-width: 0;\n  min-height: 0;\n}\n\n.canvas {\n  border: 1px solid #ddd;\n  outline: none;\n}\n\n.hint-list {\n  flex: 0 0 clamp(16rem, 20vw, 28rem);\n  display: flex;\n  flex-direction: column;\n  gap: 0.75em;\n  background: #f5f5f5;\n  padding-left: 0.5em;\n  border: 1px solid #ccc;\n  overflow: scroll;\n}\n\n.hint {\n  cursor: default;\n}\n\n.selected-hint {\n  background: rgba(140, 180, 255, 0.13);\n}\n</style>\n","import script from \"./CrosswordViewer.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./CrosswordViewer.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./CrosswordViewer.vue?vue&type=style&index=0&id=04ae3bd4&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-04ae3bd4\"]])\n\nexport default __exports__","import { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, vModelText as _vModelText, withDirectives as _withDirectives, createTextVNode as _createTextVNode, vModelCheckbox as _vModelCheckbox, normalizeClass as _normalizeClass, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nconst _hoisted_1 = { class: \"stud5p-task\" }\nconst _hoisted_2 = { class: \"default\" }\nconst _hoisted_3 = { class: \"h5pEditorTopPanel\" }\nconst _hoisted_4 = [\"data-tooltip\"]\nconst _hoisted_5 = { style: {\"margin-top\":\"1.5ex\"} }\nconst _hoisted_6 = [\"data-tooltip\"]\nconst _hoisted_7 = { class: \"collapsable collapsed\" }\nconst _hoisted_8 = [\"disabled\"]\nconst _hoisted_9 = { class: \"collapsable collapsed\" }\nconst _hoisted_10 = [\"disabled\"]\nconst _hoisted_11 = [\"disabled\"]\nconst _hoisted_12 = [\"disabled\"]\nconst _hoisted_13 = [\"disabled\"]\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_studip_wysiwyg = _resolveComponent(\"studip-wysiwyg\")!\n  const _component_feedback_editor = _resolveComponent(\"feedback-editor\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createElementVNode(\"form\", _hoisted_2, [\n      _createElementVNode(\"fieldset\", null, [\n        _createElementVNode(\"legend\", null, _toDisplayString(_ctx.$gettext('Drag the Words')), 1),\n        _createElementVNode(\"div\", _hoisted_3, [\n          _createElementVNode(\"button\", {\n            onClick: _cache[0] || (_cache[0] = \n//@ts-ignore\n(...args) => (_ctx.addBlank && _ctx.addBlank(...args))),\n            class: \"button add-blank\",\n            type: \"button\"\n          }, _toDisplayString(_ctx.$gettext('Lcke hinzufgen')), 1),\n          _createElementVNode(\"div\", {\n            class: \"tooltip tooltip-icon\",\n            \"data-tooltip\": _ctx.instructions\n          }, null, 8, _hoisted_4)\n        ]),\n        _createVNode(_component_studip_wysiwyg, {\n          modelValue: _ctx.modelTaskDefinition.template,\n          \"onUpdate:modelValue\": _ctx.onEditTemplate,\n          ref: \"wysiwyg\",\n          \"force-soft-breaks\": \"\",\n          \"remove-wrapping-p-tag\": \"\",\n          \"disable-autoformat\": \"\"\n        }, null, 8, [\"modelValue\", \"onUpdate:modelValue\"]),\n        _createElementVNode(\"label\", _hoisted_5, [\n          _createTextVNode(_toDisplayString(_ctx.$gettext('Irrefhrende Antworten')) + \" \", 1),\n          _createElementVNode(\"span\", {\n            class: \"tooltip tooltip-icon\",\n            \"data-tooltip\": _ctx.distratorInstructions\n          }, null, 8, _hoisted_6),\n          _withDirectives(_createElementVNode(\"input\", {\n            \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event: any) => ((_ctx.modelTaskDefinition.distractors) = $event)),\n            onInput: _cache[2] || (_cache[2] = ($event: any) => (_ctx.updateTaskDefinition('taskDefinition.distractors'))),\n            type: \"text\"\n          }, null, 544), [\n            [_vModelText, _ctx.modelTaskDefinition.distractors]\n          ])\n        ])\n      ]),\n      _createElementVNode(\"fieldset\", _hoisted_7, [\n        _createElementVNode(\"legend\", null, _toDisplayString(_ctx.$gettext('Einstellungen')), 1),\n        _createElementVNode(\"label\", null, [\n          _withDirectives(_createElementVNode(\"input\", {\n            \"onUpdate:modelValue\": _cache[3] || (_cache[3] = ($event: any) => ((_ctx.modelTaskDefinition.instantFeedback) = $event)),\n            onChange: _cache[4] || (_cache[4] = \n//@ts-ignore\n(...args) => (_ctx.updateTaskDefinition && _ctx.updateTaskDefinition(...args))),\n            type: \"checkbox\"\n          }, null, 544), [\n            [_vModelCheckbox, _ctx.modelTaskDefinition.instantFeedback]\n          ]),\n          _createTextVNode(\" \" + _toDisplayString(_ctx.$gettext('Lcken automatisch prfen')), 1)\n        ]),\n        _createElementVNode(\"label\", null, [\n          _withDirectives(_createElementVNode(\"input\", {\n            \"onUpdate:modelValue\": _cache[5] || (_cache[5] = ($event: any) => ((_ctx.modelTaskDefinition.alphabeticOrder) = $event)),\n            onChange: _cache[6] || (_cache[6] = \n//@ts-ignore\n(...args) => (_ctx.updateTaskDefinition && _ctx.updateTaskDefinition(...args))),\n            type: \"checkbox\"\n          }, null, 544), [\n            [_vModelCheckbox, _ctx.modelTaskDefinition.alphabeticOrder]\n          ]),\n          _createTextVNode(\" \" + _toDisplayString(_ctx.$gettext('Antworten alphabetisch sortieren')), 1)\n        ]),\n        _createElementVNode(\"label\", null, [\n          _withDirectives(_createElementVNode(\"input\", {\n            \"onUpdate:modelValue\": _cache[7] || (_cache[7] = ($event: any) => ((_ctx.modelTaskDefinition.retryAllowed) = $event)),\n            onChange: _cache[8] || (_cache[8] = \n//@ts-ignore\n(...args) => (_ctx.updateTaskDefinition && _ctx.updateTaskDefinition(...args))),\n            type: \"checkbox\"\n          }, null, 544), [\n            [_vModelCheckbox, _ctx.modelTaskDefinition.retryAllowed]\n          ]),\n          _createTextVNode(\" \" + _toDisplayString(_ctx.$gettext('Mehrere Versuche erlauben')), 1)\n        ]),\n        _createElementVNode(\"label\", null, [\n          _withDirectives(_createElementVNode(\"input\", {\n            \"onUpdate:modelValue\": _cache[9] || (_cache[9] = ($event: any) => ((_ctx.modelTaskDefinition.showSolutionsAllowed) = $event)),\n            onChange: _cache[10] || (_cache[10] = \n//@ts-ignore\n(...args) => (_ctx.updateShowSolutionsAllowed && _ctx.updateShowSolutionsAllowed(...args))),\n            type: \"checkbox\"\n          }, null, 544), [\n            [_vModelCheckbox, _ctx.modelTaskDefinition.showSolutionsAllowed]\n          ]),\n          _createTextVNode(\" \" + _toDisplayString(_ctx.$gettext('Lsungen anzeigen erlauben')), 1)\n        ]),\n        _createElementVNode(\"label\", {\n          class: _normalizeClass({\n            'setting-disabled': !_ctx.modelTaskDefinition.showSolutionsAllowed,\n          })\n        }, [\n          _withDirectives(_createElementVNode(\"input\", {\n            \"onUpdate:modelValue\": _cache[11] || (_cache[11] = ($event: any) => ((_ctx.modelTaskDefinition.allBlanksMustBeFilledForSolutions) = $event)),\n            onChange: _cache[12] || (_cache[12] = \n//@ts-ignore\n(...args) => (_ctx.updateShowSolutionsAllowed && _ctx.updateShowSolutionsAllowed(...args))),\n            disabled: !_ctx.modelTaskDefinition.showSolutionsAllowed,\n            type: \"checkbox\"\n          }, null, 40, _hoisted_8), [\n            [_vModelCheckbox, _ctx.modelTaskDefinition.allBlanksMustBeFilledForSolutions]\n          ]),\n          _createTextVNode(\" \" + _toDisplayString(_ctx.$gettext('Lsungen nur anzeigen, wenn alle Lcken ausgefllt sind')), 1)\n        ], 2)\n      ]),\n      _createElementVNode(\"fieldset\", _hoisted_9, [\n        _createElementVNode(\"legend\", null, _toDisplayString(_ctx.$gettext('Beschriftungen')), 1),\n        _createElementVNode(\"label\", {\n          class: _normalizeClass({ 'setting-disabled': _ctx.modelTaskDefinition.instantFeedback })\n        }, [\n          _createTextVNode(_toDisplayString(_ctx.$gettext('Text fr berprfen-Button:')) + \" \", 1),\n          _withDirectives(_createElementVNode(\"input\", {\n            \"onUpdate:modelValue\": _cache[13] || (_cache[13] = ($event: any) => ((_ctx.modelTaskDefinition.strings.checkButton) = $event)),\n            onInput: _cache[14] || (_cache[14] = ($event: any) => (_ctx.updateTaskDefinition('taskDefinition.strings.checkButton'))),\n            disabled: _ctx.modelTaskDefinition.instantFeedback,\n            type: \"text\"\n          }, null, 40, _hoisted_10), [\n            [_vModelText, _ctx.modelTaskDefinition.strings.checkButton]\n          ])\n        ], 2),\n        _createElementVNode(\"label\", {\n          class: _normalizeClass({ 'setting-disabled': !_ctx.modelTaskDefinition.retryAllowed })\n        }, [\n          _createTextVNode(_toDisplayString(_ctx.$gettext('Text fr Wiederholen-Button:')) + \" \", 1),\n          _withDirectives(_createElementVNode(\"input\", {\n            \"onUpdate:modelValue\": _cache[15] || (_cache[15] = ($event: any) => ((_ctx.modelTaskDefinition.strings.retryButton) = $event)),\n            onInput: _cache[16] || (_cache[16] = ($event: any) => (_ctx.updateTaskDefinition('taskDefinition.strings.retryButton'))),\n            disabled: !_ctx.modelTaskDefinition.retryAllowed,\n            type: \"text\"\n          }, null, 40, _hoisted_11), [\n            [_vModelText, _ctx.modelTaskDefinition.strings.retryButton]\n          ])\n        ], 2),\n        _createElementVNode(\"label\", {\n          class: _normalizeClass({\n            'setting-disabled': !_ctx.modelTaskDefinition.showSolutionsAllowed,\n          })\n        }, [\n          _createTextVNode(_toDisplayString(_ctx.$gettext('Text fr Lsungen-Button:')) + \" \", 1),\n          _withDirectives(_createElementVNode(\"input\", {\n            \"onUpdate:modelValue\": _cache[17] || (_cache[17] = ($event: any) => ((_ctx.modelTaskDefinition.strings.solutionsButton) = $event)),\n            onInput: _cache[18] || (_cache[18] = ($event: any) => (\n              _ctx.updateTaskDefinition('taskDefinition.strings.solutionsButton')\n            )),\n            disabled: !_ctx.modelTaskDefinition.showSolutionsAllowed,\n            type: \"text\"\n          }, null, 40, _hoisted_12), [\n            [_vModelText, _ctx.modelTaskDefinition.strings.solutionsButton]\n          ])\n        ], 2),\n        _createElementVNode(\"label\", {\n          class: _normalizeClass({\n            'setting-disabled':\n              !_ctx.modelTaskDefinition.showSolutionsAllowed ||\n              !_ctx.modelTaskDefinition.allBlanksMustBeFilledForSolutions,\n          })\n        }, [\n          _createTextVNode(_toDisplayString(_ctx.$gettext('Hinweis, wenn nicht alle Lcken ausgefllt sind:')) + \" \", 1),\n          _withDirectives(_createElementVNode(\"input\", {\n            \"onUpdate:modelValue\": _cache[19] || (_cache[19] = ($event: any) => ((_ctx.modelTaskDefinition.strings.fillInAllBlanksMessage) = $event)),\n            onInput: _cache[20] || (_cache[20] = ($event: any) => (\n              _ctx.updateTaskDefinition(\n                'taskDefinition.strings.fillInAllBlanksMessage'\n              )\n            )),\n            disabled: \n              !_ctx.modelTaskDefinition.showSolutionsAllowed ||\n              !_ctx.modelTaskDefinition.allBlanksMustBeFilledForSolutions\n            ,\n            type: \"text\"\n          }, null, 40, _hoisted_13), [\n            [_vModelText, _ctx.modelTaskDefinition.strings.fillInAllBlanksMessage]\n          ])\n        ], 2)\n      ]),\n      _createVNode(_component_feedback_editor, {\n        feedback: _ctx.modelTaskDefinition.feedback,\n        \"result-message\": _ctx.modelTaskDefinition.strings.resultMessage,\n        \"onUpdate:feedback\": _ctx.updateFeedback,\n        \"onUpdate:resultMessage\": _ctx.updateResultMessage\n      }, null, 8, [\"feedback\", \"result-message\", \"onUpdate:feedback\", \"onUpdate:resultMessage\"])\n    ])\n  ]))\n}","<template>\n  <div class=\"stud5p-task\">\n    <form class=\"default\">\n      <fieldset>\n        <legend>{{ $gettext('Drag the Words') }}</legend>\n\n        <div class=\"h5pEditorTopPanel\">\n          <button @click=\"addBlank\" class=\"button add-blank\" type=\"button\">\n            {{ $gettext('Lcke hinzufgen') }}\n          </button>\n          <div class=\"tooltip tooltip-icon\" :data-tooltip=\"instructions\" />\n        </div>\n\n        <studip-wysiwyg\n          :modelValue=\"modelTaskDefinition.template\"\n          @update:modelValue=\"onEditTemplate\"\n          ref=\"wysiwyg\"\n          force-soft-breaks\n          remove-wrapping-p-tag\n          disable-autoformat\n        />\n\n        <label style=\"margin-top: 1.5ex\">\n          {{ $gettext('Irrefhrende Antworten') }}\n          <span\n            class=\"tooltip tooltip-icon\"\n            :data-tooltip=\"distratorInstructions\"\n          />\n          <input\n            v-model=\"modelTaskDefinition.distractors\"\n            @input=\"updateTaskDefinition('taskDefinition.distractors')\"\n            type=\"text\"\n          />\n        </label>\n      </fieldset>\n\n      <fieldset class=\"collapsable collapsed\">\n        <legend>{{ $gettext('Einstellungen') }}</legend>\n\n        <label>\n          <input\n            v-model=\"modelTaskDefinition.instantFeedback\"\n            @change=\"updateTaskDefinition\"\n            type=\"checkbox\"\n          />\n          {{ $gettext('Lcken automatisch prfen') }}\n        </label>\n\n        <label>\n          <input\n            v-model=\"modelTaskDefinition.alphabeticOrder\"\n            @change=\"updateTaskDefinition\"\n            type=\"checkbox\"\n          />\n          {{ $gettext('Antworten alphabetisch sortieren') }}\n        </label>\n\n        <label>\n          <input\n            v-model=\"modelTaskDefinition.retryAllowed\"\n            @change=\"updateTaskDefinition\"\n            type=\"checkbox\"\n          />\n          {{ $gettext('Mehrere Versuche erlauben') }}\n        </label>\n\n        <label>\n          <input\n            v-model=\"modelTaskDefinition.showSolutionsAllowed\"\n            @change=\"updateShowSolutionsAllowed\"\n            type=\"checkbox\"\n          />\n          {{ $gettext('Lsungen anzeigen erlauben') }}\n        </label>\n\n        <label\n          :class=\"{\n            'setting-disabled': !modelTaskDefinition.showSolutionsAllowed,\n          }\"\n        >\n          <input\n            v-model=\"modelTaskDefinition.allBlanksMustBeFilledForSolutions\"\n            @change=\"updateShowSolutionsAllowed\"\n            :disabled=\"!modelTaskDefinition.showSolutionsAllowed\"\n            type=\"checkbox\"\n          />\n          {{\n            $gettext('Lsungen nur anzeigen, wenn alle Lcken ausgefllt sind')\n          }}\n        </label>\n      </fieldset>\n\n      <fieldset class=\"collapsable collapsed\">\n        <legend>{{ $gettext('Beschriftungen') }}</legend>\n\n        <label\n          :class=\"{ 'setting-disabled': modelTaskDefinition.instantFeedback }\"\n        >\n          {{ $gettext('Text fr berprfen-Button:') }}\n          <input\n            v-model=\"modelTaskDefinition.strings.checkButton\"\n            @input=\"updateTaskDefinition('taskDefinition.strings.checkButton')\"\n            :disabled=\"modelTaskDefinition.instantFeedback\"\n            type=\"text\"\n          />\n        </label>\n\n        <label\n          :class=\"{ 'setting-disabled': !modelTaskDefinition.retryAllowed }\"\n        >\n          {{ $gettext('Text fr Wiederholen-Button:') }}\n          <input\n            v-model=\"modelTaskDefinition.strings.retryButton\"\n            @input=\"updateTaskDefinition('taskDefinition.strings.retryButton')\"\n            :disabled=\"!modelTaskDefinition.retryAllowed\"\n            type=\"text\"\n          />\n        </label>\n\n        <label\n          :class=\"{\n            'setting-disabled': !modelTaskDefinition.showSolutionsAllowed,\n          }\"\n        >\n          {{ $gettext('Text fr Lsungen-Button:') }}\n          <input\n            v-model=\"modelTaskDefinition.strings.solutionsButton\"\n            @input=\"\n              updateTaskDefinition('taskDefinition.strings.solutionsButton')\n            \"\n            :disabled=\"!modelTaskDefinition.showSolutionsAllowed\"\n            type=\"text\"\n          />\n        </label>\n\n        <label\n          :class=\"{\n            'setting-disabled':\n              !modelTaskDefinition.showSolutionsAllowed ||\n              !modelTaskDefinition.allBlanksMustBeFilledForSolutions,\n          }\"\n        >\n          {{ $gettext('Hinweis, wenn nicht alle Lcken ausgefllt sind:') }}\n          <input\n            v-model=\"modelTaskDefinition.strings.fillInAllBlanksMessage\"\n            @input=\"\n              updateTaskDefinition(\n                'taskDefinition.strings.fillInAllBlanksMessage'\n              )\n            \"\n            :disabled=\"\n              !modelTaskDefinition.showSolutionsAllowed ||\n              !modelTaskDefinition.allBlanksMustBeFilledForSolutions\n            \"\n            type=\"text\"\n          />\n        </label>\n      </fieldset>\n\n      <feedback-editor\n        :feedback=\"modelTaskDefinition.feedback\"\n        :result-message=\"modelTaskDefinition.strings.resultMessage\"\n        @update:feedback=\"updateFeedback\"\n        @update:result-message=\"updateResultMessage\"\n      />\n    </form>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, inject, PropType } from 'vue';\nimport { DragTheWordsTask } from '@/models/TaskDefinition';\nimport { Feedback } from '@/models/common';\nimport { $gettext } from '@/language/gettext';\nimport StudipWysiwyg from '@/components/StudipWysiwyg.vue';\nimport produce from 'immer';\nimport FeedbackEditor from '@/components/FeedbackEditor.vue';\nimport {\n  TaskEditorState,\n  taskEditorStateSymbol,\n} from '@/components/taskEditorState';\nimport { cloneDeep } from 'lodash';\n\nexport default defineComponent({\n  name: 'DragTheWordsEditor',\n  setup() {\n    return {\n      taskEditor: inject<TaskEditorState>(taskEditorStateSymbol),\n    };\n  },\n  components: { StudipWysiwyg, FeedbackEditor },\n  props: {\n    taskDefinition: {\n      type: Object as PropType<DragTheWordsTask>,\n      required: true,\n    },\n  },\n  data() {\n    return {\n      modelTaskDefinition: cloneDeep(this.taskDefinition),\n    };\n  },\n  watch: {\n    // Synchronize state taskDefinition -> modelTaskDefinition.\n    taskDefinition: {\n      immediate: true,\n      handler: function (): void {\n        this.modelTaskDefinition = cloneDeep(this.taskDefinition);\n      },\n    },\n  },\n  computed: {\n    instructions(): string {\n      return $gettext(\n        'Um eine Lcke zu erstellen, setzen Sie ein Sternchen (*) vor und hinter das korrekte Wort oder markieren Sie das Wort und klicken Sie auf den Button Lcke hinzufgen. Sie knnen auch einen Tooltip hinzufgen, indem Sie einen Doppelpunkt (:) vor den Tooltip-Text schreiben.'\n      );\n    },\n\n    distratorInstructions(): string {\n      return $gettext(\n        'Geben Sie falsche Antworten als Distraktoren ein. Verwenden Sie das gleiche Sternchen (*)-Schema wie im Text.'\n      );\n    },\n  },\n  methods: {\n    $gettext,\n\n    /**\n     * Surround the selected text with two asterisks\n     */\n    addBlank() {\n      const wysiwygEl = (this.$refs.wysiwyg as any)?.$el;\n      const editor = window.STUDIP.wysiwyg.getEditor(wysiwygEl);\n      if (!editor) {\n        console.error('getEditor(wysiwygEl) returned: ', editor);\n        throw new Error('Could not get reference to wysiwyg editor');\n      }\n      const selection = editor.model.document.selection;\n      const start = selection.getFirstPosition();\n      const end = selection.getLastPosition();\n      if (!start || !end) {\n        console.error('selection start: ', start, ' selection end: ', end);\n        throw new Error('Could not get selection in editor');\n      }\n      editor.model.change((writer) => {\n        writer.insertText('*', end);\n        writer.insertText('*', start);\n      });\n    },\n\n    onEditTemplate(data: string): void {\n      // Copy new data from wysiwyg editor into task definition\n      this.taskEditor!.performEdit({\n        newTaskDefinition: produce(\n          this.modelTaskDefinition,\n          (task: DragTheWordsTask) => {\n            task.template = data;\n          }\n        ),\n        undoBatch: 'taskDefinition.template',\n      });\n    },\n\n    updateTaskDefinition(undoBatch?: unknown) {\n      // Synchronize state modelTaskDefinition -> taskDefinition.\n      this.taskEditor!.performEdit({\n        newTaskDefinition: cloneDeep(this.modelTaskDefinition),\n        undoBatch: undoBatch ?? {},\n      });\n    },\n\n    updateShowSolutionsAllowed() {\n      if (!this.modelTaskDefinition.showSolutionsAllowed) {\n        this.modelTaskDefinition.allBlanksMustBeFilledForSolutions = false;\n      }\n      this.updateTaskDefinition();\n    },\n\n    updateFeedback(updatedFeedback: Feedback[]) {\n      this.taskEditor!.performEdit({\n        newTaskDefinition: produce(\n          this.modelTaskDefinition,\n          (taskDraft: DragTheWordsTask) => {\n            taskDraft.feedback = updatedFeedback;\n          }\n        ),\n        undoBatch: 'taskDefinition.feedback',\n      });\n    },\n\n    updateResultMessage(updatedResultMessage: string) {\n      this.taskEditor!.performEdit({\n        newTaskDefinition: produce(\n          this.modelTaskDefinition,\n          (taskDraft: DragTheWordsTask) => {\n            taskDraft.strings.resultMessage = updatedResultMessage;\n          }\n        ),\n        undoBatch: 'taskDefinition.strings.resultMessage',\n      });\n    },\n\n    urlForIcon(iconName: string) {\n      return (\n        window.STUDIP.ASSETS_URL + 'images/icons/blue/' + iconName + '.svg'\n      );\n    },\n  },\n});\n</script>\n\n<style scoped></style>\n","import { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, vModelText as _vModelText, withDirectives as _withDirectives, createTextVNode as _createTextVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-85a4403a\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"collapsable collapsed\" }\nconst _hoisted_2 = { key: 0 }\nconst _hoisted_3 = { for: \"feedback-container\" }\nconst _hoisted_4 = {\n  id: \"feedback-container\",\n  class: \"feedback-container\"\n}\nconst _hoisted_5 = { class: \"feedback-percentages-child\" }\nconst _hoisted_6 = [\"onUpdate:modelValue\", \"onInput\"]\nconst _hoisted_7 = { class: \"feedback-messages-child\" }\nconst _hoisted_8 = [\"onUpdate:modelValue\", \"onInput\"]\nconst _hoisted_9 = [\"title\", \"onClick\"]\nconst _hoisted_10 = [\"src\", \"alt\"]\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  return (_openBlock(), _createElementBlock(\"fieldset\", _hoisted_1, [\n    _createElementVNode(\"legend\", null, _toDisplayString(_ctx.$gettext('Feedback')), 1),\n    (_ctx.localResultMessage)\n      ? (_openBlock(), _createElementBlock(\"label\", _hoisted_2, [\n          _createTextVNode(_toDisplayString(_ctx.$gettext('Ergebnismitteilung (mgliche Variablen :correct und :total):')) + \" \", 1),\n          _withDirectives(_createElementVNode(\"input\", {\n            type: \"text\",\n            \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((_ctx.localResultMessage) = $event)),\n            onInput: _cache[1] || (_cache[1] = \n//@ts-ignore\n(...args) => (_ctx.emitUpdatedResultMessage && _ctx.emitUpdatedResultMessage(...args)))\n          }, null, 544), [\n            [_vModelText, _ctx.localResultMessage]\n          ])\n        ]))\n      : _createCommentVNode(\"\", true),\n    _createElementVNode(\"label\", _hoisted_3, _toDisplayString(_ctx.$gettext('Benutzerdefiniertes Feedback fr beliebige Punktebereiche:')), 1),\n    _createElementVNode(\"div\", _hoisted_4, [\n      _createElementVNode(\"div\", _hoisted_5, [\n        _createElementVNode(\"label\", null, _toDisplayString(_ctx.$gettext('Ab Prozent')), 1),\n        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.feedbackList, (feedback, i) => {\n          return _withDirectives((_openBlock(), _createElementBlock(\"input\", {\n            key: i,\n            type: \"number\",\n            min: \"0\",\n            max: \"100\",\n            \"onUpdate:modelValue\": ($event: any) => ((_ctx.feedbackList[i].percentage) = $event),\n            onInput: ($event: any) => (_ctx.emitUpdatedFeedback(`feedbackList[${i}].percentage`))\n          }, null, 40, _hoisted_6)), [\n            [_vModelText, _ctx.feedbackList[i].percentage]\n          ])\n        }), 128))\n      ]),\n      _createElementVNode(\"div\", _hoisted_7, [\n        _createElementVNode(\"label\", null, _toDisplayString(_ctx.$gettext('Mitteilung')), 1),\n        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.feedbackList, (feedback, i) => {\n          return (_openBlock(), _createElementBlock(\"div\", {\n            class: \"feedback-messages-child-subdivision\",\n            key: i\n          }, [\n            _withDirectives(_createElementVNode(\"input\", {\n              type: \"text\",\n              \"onUpdate:modelValue\": ($event: any) => ((_ctx.feedbackList[i].message) = $event),\n              onInput: ($event: any) => (_ctx.emitUpdatedFeedback(`feedbackList[${i}].message`))\n            }, null, 40, _hoisted_8), [\n              [_vModelText, _ctx.feedbackList[i].message]\n            ]),\n            _createElementVNode(\"button\", {\n              type: \"button\",\n              title: _ctx.titleForDeleteButtonForFeedback(feedback),\n              class: \"remove-feedback-button\",\n              onClick: ($event: any) => (_ctx.removeFeedback(feedback))\n            }, [\n              _createElementVNode(\"img\", {\n                src: _ctx.urlForIcon('trash'),\n                alt: \n                _ctx.$gettext(\n                  'Trash can icon in a button used to delete a feedback interval'\n                )\n              ,\n                width: \"16\",\n                height: \"16\"\n              }, null, 8, _hoisted_10)\n            ], 8, _hoisted_9)\n          ]))\n        }), 128))\n      ])\n    ]),\n    _createElementVNode(\"button\", {\n      type: \"button\",\n      class: \"button\",\n      onClick: _cache[2] || (_cache[2] = \n//@ts-ignore\n(...args) => (_ctx.addFeedback && _ctx.addFeedback(...args)))\n    }, _toDisplayString(_ctx.$gettext('Neuer Bereich')), 1)\n  ]))\n}","<template>\n  <fieldset class=\"collapsable collapsed\">\n    <legend>{{ $gettext('Feedback') }}</legend>\n\n    <label v-if=\"localResultMessage\">\n      {{\n        $gettext('Ergebnismitteilung (mgliche Variablen :correct und :total):')\n      }}\n      <input\n        type=\"text\"\n        v-model=\"localResultMessage\"\n        @input=\"emitUpdatedResultMessage\"\n      />\n    </label>\n\n    <label for=\"feedback-container\"\n      >{{\n        $gettext('Benutzerdefiniertes Feedback fr beliebige Punktebereiche:')\n      }}\n    </label>\n    <div id=\"feedback-container\" class=\"feedback-container\">\n      <div class=\"feedback-percentages-child\">\n        <label>\n          {{ $gettext('Ab Prozent') }}\n        </label>\n        <template v-for=\"(feedback, i) in feedbackList\" :key=\"i\">\n          <input\n            type=\"number\"\n            min=\"0\"\n            max=\"100\"\n            v-model=\"feedbackList[i].percentage\"\n            @input=\"emitUpdatedFeedback(`feedbackList[${i}].percentage`)\"\n          />\n        </template>\n      </div>\n\n      <div class=\"feedback-messages-child\">\n        <label>\n          {{ $gettext('Mitteilung') }}\n        </label>\n        <div\n          class=\"feedback-messages-child-subdivision\"\n          v-for=\"(feedback, i) in feedbackList\"\n          :key=\"i\"\n        >\n          <input\n            type=\"text\"\n            v-model=\"feedbackList[i].message\"\n            @input=\"emitUpdatedFeedback(`feedbackList[${i}].message`)\"\n          />\n          <button\n            type=\"button\"\n            :title=\"titleForDeleteButtonForFeedback(feedback)\"\n            class=\"remove-feedback-button\"\n            @click=\"removeFeedback(feedback)\"\n          >\n            <img\n              :src=\"urlForIcon('trash')\"\n              :alt=\"\n                $gettext(\n                  'Trash can icon in a button used to delete a feedback interval'\n                )\n              \"\n              width=\"16\"\n              height=\"16\"\n            />\n          </button>\n        </div>\n      </div>\n    </div>\n\n    <button type=\"button\" class=\"button\" @click=\"addFeedback\">\n      {{ $gettext('Neuer Bereich') }}\n    </button>\n  </fieldset>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, PropType } from 'vue';\nimport { $gettext } from '@/language/gettext';\nimport { Feedback } from '@/models/common';\nimport { cloneDeep } from 'lodash';\n\nexport default defineComponent({\n  name: 'FeedbackEditor',\n\n  props: {\n    feedback: {\n      type: Array as PropType<Feedback[]>,\n      required: true,\n    },\n    resultMessage: {\n      type: String,\n      required: false,\n    },\n  },\n  emits: {\n    ['update:feedback'](feedbacks: Feedback[], undoBatch?: unknown): boolean {\n      return true;\n    },\n    ['update:result-message'](message: string): boolean {\n      // This function is a 'validator'.\n      // See https://vuejs.org/guide/components/events.html#events-validation\n      // We don't need to perform validation here, but we have to define SOME\n      // kind of function in order to use this syntax that lets us provide\n      // types for our events.\n      return true;\n    },\n  },\n  data() {\n    return {\n      feedbackList: cloneDeep(this.feedback), // Local copy of the feedback to edit\n      localResultMessage: this.resultMessage || '', // Local copy of the result message\n    };\n  },\n  watch: {\n    // Synchronize state props -> local copies.\n    feedback: {\n      immediate: true,\n      handler: function (): void {\n        this.feedbackList = cloneDeep(this.feedback);\n      },\n    },\n    resultMessage: {\n      immediate: true,\n      handler: function (): void {\n        this.localResultMessage = this.resultMessage || '';\n      },\n    },\n  },\n  methods: {\n    $gettext,\n\n    titleForDeleteButtonForFeedback(feedback: Feedback): string {\n      return this.$gettext(\n        'Entferne den Feedback-Bereich, der ab %{ percentage }% anfngt.',\n        { percentage: feedback.percentage.toString() }\n      );\n    },\n\n    addFeedback() {\n      const newFeedback = {\n        percentage: 25, // Default value, you can adjust it\n        message: 'Feedback',\n      };\n      this.feedbackList.push(newFeedback);\n      this.emitUpdatedFeedback();\n    },\n\n    removeFeedback(feedbackToRemove: Feedback) {\n      this.feedbackList = this.feedbackList.filter(\n        (feedback) => feedback !== feedbackToRemove\n      );\n      this.emitUpdatedFeedback();\n    },\n\n    emitUpdatedFeedback(undoBatch: unknown = {}) {\n      this.$emit('update:feedback', cloneDeep(this.feedbackList), undoBatch);\n    },\n\n    emitUpdatedResultMessage() {\n      this.$emit('update:result-message', this.localResultMessage);\n    },\n\n    urlForIcon(iconName: string) {\n      return (\n        window.STUDIP.ASSETS_URL + 'images/icons/blue/' + iconName + '.svg'\n      );\n    },\n  },\n});\n</script>\n\n<style scoped>\n.feedback-container {\n  display: flex;\n  gap: 0.5em;\n  justify-content: flex-start;\n  align-items: center;\n  max-width: 48em;\n}\n\n.feedback-percentages-child {\n  flex: 0 100px;\n  display: flex;\n  flex-direction: column;\n}\n\n.feedback-messages-child {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n}\n\n.feedback-messages-child-subdivision {\n  display: flex;\n  align-items: center;\n  gap: 0.5em;\n}\n\n.remove-feedback-button {\n  display: flex;\n  align-items: center;\n  height: 28px;\n}\n</style>\n","import { render } from \"./FeedbackEditor.vue?vue&type=template&id=85a4403a&scoped=true&ts=true\"\nimport script from \"./FeedbackEditor.vue?vue&type=script&lang=ts\"\nexport * from \"./FeedbackEditor.vue?vue&type=script&lang=ts\"\n\nimport \"./FeedbackEditor.vue?vue&type=style&index=0&id=85a4403a&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-85a4403a\"]])\n\nexport default __exports__","import { render } from \"./DragTheWordsEditor.vue?vue&type=template&id=4a3ed2e8&ts=true\"\nimport script from \"./DragTheWordsEditor.vue?vue&type=script&lang=ts\"\nexport * from \"./DragTheWordsEditor.vue?vue&type=script&lang=ts\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, withModifiers as _withModifiers, normalizeClass as _normalizeClass, createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, createBlock as _createBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-501f9f22\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"stud5p-task\" }\nconst _hoisted_2 = { class: \"text-and-answers-container\" }\nconst _hoisted_3 = { class: \"text-and-feedback-container\" }\nconst _hoisted_4 = { class: \"drag-the-words-text\" }\nconst _hoisted_5 = [\"innerHTML\"]\nconst _hoisted_6 = [\"title\", \"draggable\", \"onDragstart\", \"onDrop\", \"onClick\"]\nconst _hoisted_7 = [\"onDrop\", \"onClick\"]\nconst _hoisted_8 = { key: 2 }\nconst _hoisted_9 = [\"data-tooltip\"]\nconst _hoisted_10 = {\n  key: 3,\n  class: \"stud5p-solution\"\n}\nconst _hoisted_11 = { class: \"feedback-and-button-container\" }\nconst _hoisted_12 = [\"textContent\"]\nconst _hoisted_13 = { class: \"button-panel\" }\nconst _hoisted_14 = [\"textContent\"]\nconst _hoisted_15 = [\"textContent\"]\nconst _hoisted_16 = [\"textContent\"]\nconst _hoisted_17 = [\"draggable\", \"onDragstart\", \"onClick\"]\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_FeedbackElement = _resolveComponent(\"FeedbackElement\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createElementVNode(\"div\", _hoisted_2, [\n      _createElementVNode(\"div\", _hoisted_3, [\n        _createElementVNode(\"div\", _hoisted_4, [\n          (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.parsedTemplate, (element) => {\n            return (_openBlock(), _createElementBlock(_Fragment, {\n              key: element.uuid\n            }, [\n              (element.type === 'staticText')\n                ? (_openBlock(), _createElementBlock(\"span\", {\n                    key: 0,\n                    class: \"static-text\",\n                    innerHTML: element.text\n                  }, null, 8, _hoisted_5))\n                : (element.type === 'blank')\n                  ? (_openBlock(), _createElementBlock(_Fragment, { key: 1 }, [\n                      (_ctx.userInputs[element.uuid])\n                        ? (_openBlock(), _createElementBlock(\"span\", {\n                            key: 0,\n                            class: _normalizeClass([\"blank filled\", _ctx.classForFilledBlank(element)]),\n                            title: _ctx.getAnswerById(_ctx.userInputs[element.uuid])?.text,\n                            draggable: _ctx.editable,\n                            onDragstart: ($event: any) => (\n                  _ctx.startDragUsedAnswer($event, element, _ctx.userInputs[element.uuid])\n                ),\n                            onDrop: ($event: any) => (_ctx.onDropBlank($event, element)),\n                            onDragover: _cache[0] || (_cache[0] = _withModifiers(() => {}, [\"prevent\"])),\n                            onClick: ($event: any) => (_ctx.onClickFilledBlank(element))\n                          }, _toDisplayString(_ctx.getAnswerById(_ctx.userInputs[element.uuid])?.text), 43, _hoisted_6))\n                        : (_openBlock(), _createElementBlock(\"span\", {\n                            key: 1,\n                            class: \"blank\",\n                            onDrop: ($event: any) => (_ctx.onDropBlank($event, element)),\n                            onDragenter: _cache[1] || (_cache[1] = ($event: any) => (_ctx.onDragEnter($event))),\n                            onDragleave: _cache[2] || (_cache[2] = ($event: any) => (_ctx.onDragLeave($event))),\n                            onDragover: _cache[3] || (_cache[3] = _withModifiers(() => {}, [\"prevent\"])),\n                            onClick: ($event: any) => (_ctx.onClickBlank(element))\n                          }, \"  \", 40, _hoisted_7)),\n                      (element.hint)\n                        ? (_openBlock(), _createElementBlock(\"label\", _hoisted_8, [\n                            _createElementVNode(\"span\", {\n                              class: \"tooltip tooltip-icon\",\n                              \"data-tooltip\": element.hint\n                            }, null, 8, _hoisted_9)\n                          ]))\n                        : _createCommentVNode(\"\", true),\n                      (_ctx.showSolutions && !_ctx.submittedAnswerIsCorrect(element))\n                        ? (_openBlock(), _createElementBlock(\"span\", _hoisted_10, _toDisplayString(element.solution), 1))\n                        : _createCommentVNode(\"\", true)\n                    ], 64))\n                  : _createCommentVNode(\"\", true)\n            ], 64))\n          }), 128))\n        ]),\n        _createElementVNode(\"div\", _hoisted_11, [\n          (_ctx.showFillInAllTheBlanksMessage)\n            ? (_openBlock(), _createElementBlock(\"div\", {\n                key: 0,\n                class: \"stud5p-message\",\n                textContent: _toDisplayString(_ctx.fillInAllTheBlanksMessage)\n              }, null, 8, _hoisted_12))\n            : _createCommentVNode(\"\", true),\n          (_ctx.showResults)\n            ? (_openBlock(), _createBlock(_component_FeedbackElement, {\n                key: 1,\n                \"achieved-points\": _ctx.correctAnswers,\n                \"max-points\": _ctx.maxPoints,\n                feedback: _ctx.task.feedback,\n                \"result-message\": _ctx.resultMessage\n              }, null, 8, [\"achieved-points\", \"max-points\", \"feedback\", \"result-message\"]))\n            : _createCommentVNode(\"\", true),\n          _createElementVNode(\"div\", _hoisted_13, [\n            (_ctx.showCheckButton)\n              ? (_openBlock(), _createElementBlock(\"button\", {\n                  key: 0,\n                  textContent: _toDisplayString(_ctx.task.strings.checkButton),\n                  onClick: _cache[4] || (_cache[4] = \n//@ts-ignore\n(...args) => (_ctx.onClickCheckButton && _ctx.onClickCheckButton(...args))),\n                  type: \"button\",\n                  class: \"stud5p-button\"\n                }, null, 8, _hoisted_14))\n              : _createCommentVNode(\"\", true),\n            (_ctx.showSolutionsButton)\n              ? (_openBlock(), _createElementBlock(\"button\", {\n                  key: 1,\n                  textContent: _toDisplayString(_ctx.task.strings.solutionsButton),\n                  onClick: _cache[5] || (_cache[5] = \n//@ts-ignore\n(...args) => (_ctx.onClickSolutionsButton && _ctx.onClickSolutionsButton(...args))),\n                  type: \"button\",\n                  class: \"stud5p-button\"\n                }, null, 8, _hoisted_15))\n              : _createCommentVNode(\"\", true),\n            (_ctx.showRetryButton)\n              ? (_openBlock(), _createElementBlock(\"button\", {\n                  key: 2,\n                  textContent: _toDisplayString(_ctx.task.strings.retryButton),\n                  onClick: _cache[6] || (_cache[6] = \n//@ts-ignore\n(...args) => (_ctx.onClickRetryButton && _ctx.onClickRetryButton(...args))),\n                  type: \"button\",\n                  class: \"stud5p-button\"\n                }, null, 8, _hoisted_16))\n              : _createCommentVNode(\"\", true)\n          ])\n        ])\n      ]),\n      _createElementVNode(\"div\", {\n        class: \"unused-answers-list\",\n        onDrop: _cache[7] || (_cache[7] = ($event: any) => (_ctx.onDropUnusedAnswers($event))),\n        onDragover: _cache[8] || (_cache[8] = _withModifiers(() => {}, [\"prevent\"]))\n      }, [\n        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.unusedAnswers, (answer) => {\n          return (_openBlock(), _createElementBlock(\"span\", {\n            key: answer.uuid,\n            class: _normalizeClass([\"unused-answer\", {\n            disabled: !this.editable,\n            selected: answer.uuid === this.clickedAnswerId,\n          }]),\n            draggable: _ctx.editable,\n            onDragstart: ($event: any) => (_ctx.startDragUnusedAnswer($event, answer)),\n            onClick: ($event: any) => (_ctx.onClickUnusedAnswer(answer))\n          }, _toDisplayString(answer.text), 43, _hoisted_17))\n        }), 128))\n      ], 32)\n    ])\n  ]))\n}","<template>\n  <div class=\"stud5p-task\">\n    <!-- Main container for text and answers -->\n    <div class=\"text-and-answers-container\">\n      <!-- Render the text and blank elements from parsedTemplate -->\n      <div class=\"text-and-feedback-container\">\n        <div class=\"drag-the-words-text\">\n          <template v-for=\"element in parsedTemplate\" :key=\"element.uuid\">\n            <!-- Static text elements -->\n            <span\n              v-if=\"element.type === 'staticText'\"\n              class=\"static-text\"\n              v-html=\"element.text\"\n            />\n\n            <!-- Blanks -->\n            <template v-else-if=\"element.type === 'blank'\">\n              <!-- Filled blank -->\n              <span\n                v-if=\"userInputs[element.uuid]\"\n                class=\"blank filled\"\n                :title=\"getAnswerById(userInputs[element.uuid])?.text\"\n                :class=\"classForFilledBlank(element)\"\n                :draggable=\"editable\"\n                @dragstart=\"\n                  startDragUsedAnswer($event, element, userInputs[element.uuid])\n                \"\n                @drop=\"onDropBlank($event, element)\"\n                @dragover.prevent\n                @click=\"onClickFilledBlank(element)\"\n              >\n                {{ getAnswerById(userInputs[element.uuid])?.text }}\n              </span>\n\n              <!-- Empty blank -->\n              <span\n                v-else\n                class=\"blank\"\n                @drop=\"onDropBlank($event, element)\"\n                @dragenter=\"onDragEnter($event)\"\n                @dragleave=\"onDragLeave($event)\"\n                @dragover.prevent\n                @click=\"onClickBlank(element)\"\n              >\n                &#8203;\n              </span>\n\n              <!-- Hint tooltip -->\n              <label v-if=\"element.hint\">\n                <span\n                  class=\"tooltip tooltip-icon\"\n                  :data-tooltip=\"element.hint\"\n                />\n              </label>\n\n              <!-- Show solution if incorrect and solutions are revealed -->\n              <span\n                v-if=\"showSolutions && !submittedAnswerIsCorrect(element)\"\n                class=\"stud5p-solution\"\n              >\n                {{ element.solution }}\n              </span>\n            </template>\n          </template>\n        </div>\n\n        <!-- Feedback and button section -->\n        <div class=\"feedback-and-button-container\">\n          <!-- Message prompting user to fill in all blanks before they can show solutions-->\n          <div\n            v-if=\"showFillInAllTheBlanksMessage\"\n            class=\"stud5p-message\"\n            v-text=\"fillInAllTheBlanksMessage\"\n          />\n\n          <!-- Feedback element displaying points and feedback -->\n          <FeedbackElement\n            v-if=\"showResults\"\n            :achieved-points=\"correctAnswers\"\n            :max-points=\"maxPoints\"\n            :feedback=\"task.feedback\"\n            :result-message=\"resultMessage\"\n          />\n\n          <div class=\"button-panel\">\n            <button\n              v-if=\"showCheckButton\"\n              v-text=\"task.strings.checkButton\"\n              @click=\"onClickCheckButton\"\n              type=\"button\"\n              class=\"stud5p-button\"\n            />\n\n            <button\n              v-if=\"showSolutionsButton\"\n              v-text=\"task.strings.solutionsButton\"\n              @click=\"onClickSolutionsButton\"\n              type=\"button\"\n              class=\"stud5p-button\"\n            />\n\n            <button\n              v-if=\"showRetryButton\"\n              v-text=\"task.strings.retryButton\"\n              @click=\"onClickRetryButton\"\n              type=\"button\"\n              class=\"stud5p-button\"\n            />\n          </div>\n        </div>\n      </div>\n\n      <!-- Container for unused answers (draggable answers) -->\n      <div\n        class=\"unused-answers-list\"\n        @drop=\"onDropUnusedAnswers($event)\"\n        @dragover.prevent\n      >\n        <span\n          v-for=\"answer in unusedAnswers\"\n          :key=\"answer.uuid\"\n          class=\"unused-answer\"\n          :class=\"{\n            disabled: !this.editable,\n            selected: answer.uuid === this.clickedAnswerId,\n          }\"\n          :draggable=\"editable\"\n          @dragstart=\"startDragUnusedAnswer($event, answer)\"\n          @click=\"onClickUnusedAnswer(answer)\"\n        >\n          {{ answer.text }}\n        </span>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, PropType } from 'vue';\nimport { DragTheWordsTask } from '@/models/TaskDefinition';\nimport { v4 as uuidv4 } from 'uuid';\nimport { isEqual } from 'lodash';\nimport { $gettext } from '@/language/gettext';\nimport FeedbackElement from '@/components/FeedbackElement.vue';\n\ntype DragTheWordsElement = Blank | StaticText;\n\ninterface Blank {\n  type: 'blank';\n  uuid: Uuid;\n  solution: string;\n  hint: string;\n}\n\ninterface Answer {\n  uuid: Uuid;\n  text: string;\n}\n\ntype StaticText = {\n  type: 'staticText';\n  uuid: Uuid;\n  text: string;\n};\n\ntype Uuid = string;\n\nexport default defineComponent({\n  name: 'DragTheWordsViewer',\n  components: { FeedbackElement },\n  props: {\n    task: {\n      type: Object as PropType<DragTheWordsTask>,\n      required: true,\n    },\n  },\n  data() {\n    return {\n      // Map from Blank IDs to Answer IDs\n      userInputs: {} as Record<Uuid, Uuid>,\n      submittedAnswers: null as Record<Uuid, Uuid> | null,\n      userWantsToSeeSolutions: false,\n      draggedAnswerId: undefined as Uuid | undefined,\n      draggedSourceId: undefined as Uuid | undefined,\n      clickedAnswerId: undefined as Uuid | undefined,\n      editable: true as Boolean,\n    };\n  },\n  methods: {\n    $gettext,\n\n    submittedAnswerIsCorrect(blank: Blank): boolean {\n      const submittedAnswerId = this.submittedAnswers?.[blank.uuid];\n      if (!submittedAnswerId) return false;\n\n      const submittedAnswer = this.getAnswerById(submittedAnswerId)?.text;\n      if (!submittedAnswer) return false;\n\n      return this.isAnswerCorrect(submittedAnswer, blank.solution);\n    },\n\n    isAnswerCorrect(userAnswer: string, solution: string): boolean {\n      return userAnswer === solution;\n    },\n\n    updateAttempt() {\n      // Tell the server which blanks were filled out correctly.\n      const points = {} as Record<string, number>;\n      this.blanks.forEach((blank, index) => {\n        // TODO Consider what the key should be. This is a bit ugly.\n        // The key is shown directly in the 'assessment' UI.\n        // Maybe we should change how that works?\n        points[`${index} - ${blank.solution}`] = this.submittedAnswerIsCorrect(\n          blank\n        )\n          ? 1\n          : 0;\n      });\n      this.$emit('updateAttempt', {\n        points,\n        // The attempt is marked as successful if all answers were correct.\n        success: this.correctAnswers === this.blanks.length,\n      });\n    },\n\n    getElement(elementId: Uuid): DragTheWordsElement {\n      const el = this.parsedTemplate.find((el) => el.uuid === elementId);\n      if (!el) {\n        throw new Error(\n          'The given element does not exist in parsedTemplate: ' + elementId\n        );\n      }\n      return el;\n    },\n\n    startDragUsedAnswer(\n      dragEvent: DragEvent,\n      blank: Blank,\n      answerId: Uuid\n    ): void {\n      if (!this.editable) return;\n      if (dragEvent.dataTransfer) {\n        dragEvent.dataTransfer.dropEffect = 'move';\n        dragEvent.dataTransfer.effectAllowed = 'move';\n      }\n      const answer = this.getAnswerById(answerId);\n      console.log('Dragging answer: ', answer, 'From blank: ', blank);\n\n      for (const property in this.userInputs) {\n        console.log(property);\n      }\n\n      this.draggedAnswerId = answerId;\n    },\n\n    startDragUnusedAnswer(dragEvent: DragEvent, answer: Answer): void {\n      if (dragEvent.dataTransfer) {\n        dragEvent.dataTransfer.dropEffect = 'move';\n        dragEvent.dataTransfer.effectAllowed = 'move';\n\n        console.log('Dragging answer: ', answer);\n        this.draggedAnswerId = answer.uuid;\n      }\n    },\n\n    onDropBlank(dragEvent: DragEvent, blank: Blank): void {\n      if (!this.draggedAnswerId) {\n        throw new Error('Dragged answer id is undefined');\n      }\n\n      console.log('Dropped answer :', this.draggedAnswer, 'on blank: ', blank);\n\n      // Remove the dropped answer from the blank, if any, where it has been dragged from\n      const previousBlank = this.blanks.find(\n        (blank) => this.userInputs[blank.uuid] === this.draggedAnswerId\n      );\n\n      if (previousBlank) {\n        delete this.userInputs[previousBlank.uuid];\n      }\n\n      // Set the answer for the blank where the answer was dropped\n      this.userInputs[blank.uuid] = this.draggedAnswerId;\n\n      this.draggedAnswerId = undefined;\n    },\n\n    onDropUnusedAnswers(ev: DragEvent): void {\n      ev.preventDefault(); // Indicate that dropping is al\n      if (!this.draggedAnswer) {\n        throw new Error('draggedAnswer is undefined');\n      }\n      // Remove the dropped answer from the blank, if any, where it has been dragged from\n      const blank = this.blanks.find(\n        (blank) => this.userInputs[blank.uuid] === this.draggedAnswerId\n      );\n      if (blank) {\n        delete this.userInputs[blank.uuid];\n      }\n    },\n\n    onDragEnter(event: DragEvent) {\n      const target = event.target as HTMLElement | null;\n      if (target) {\n        target.style.backgroundColor = '#80b4ed';\n      }\n    },\n\n    onDragLeave(event: DragEvent) {\n      const target = event.target as HTMLElement | null;\n      if (target) {\n        target.style.backgroundColor = '';\n      }\n    },\n\n    onClickCheckButton() {\n      // Save a copy of the user's inputs.\n      this.submittedAnswers = { ...this.userInputs };\n      this.editable = false;\n    },\n\n    onClickSolutionsButton() {\n      this.userWantsToSeeSolutions = true;\n    },\n\n    onClickRetryButton() {\n      this.userWantsToSeeSolutions = false;\n      this.userInputs = {};\n      this.submittedAnswers = null;\n      this.editable = true;\n    },\n\n    classForFilledBlank(blank: Blank) {\n      if (!this.submittedAnswers && !this.task.instantFeedback) {\n        return '';\n      }\n\n      if (this.task.instantFeedback) {\n        this.submittedAnswers = { ...this.userInputs };\n      }\n\n      if (this.userInputs?.[blank.uuid]) {\n        if (this.submittedAnswerIsCorrect(blank)) {\n          return 'correct disabled';\n        } else {\n          return 'incorrect disabled';\n        }\n      } else {\n        return '';\n      }\n    },\n\n    getAnswerById(id: Uuid): Answer | undefined {\n      return this.answers.find((answer) => answer.uuid === id);\n    },\n\n    onClickUnusedAnswer(answer: Answer): void {\n      console.log('Clicked answer:', answer);\n      if (this.editable) this.clickedAnswerId = answer.uuid;\n    },\n\n    onClickBlank(blank: Blank): void {\n      console.log('Clicked blank:', blank);\n      if (!this.clickedAnswerId) return;\n      this.userInputs[blank.uuid] = this.clickedAnswerId;\n      this.clickedAnswerId = undefined;\n    },\n\n    onClickFilledBlank(blank: Blank): void {\n      console.log('Clicked filled blank:', blank);\n      if (!this.editable) return;\n\n      if (blank) {\n        delete this.userInputs[blank.uuid];\n      }\n    },\n\n    removePTags(text: string) {\n      // Remove all opening and closing <p> tags\n      return text.replace(/<\\/?p>/g, '');\n    },\n  },\n  computed: {\n    splitTemplate(): string[] {\n      const cleanTemplate = this.removePTags(this.task.template);\n      // Returns an array where the even indexes are the static text portions,\n      // and the odd indexes are the blanks.\n      return cleanTemplate.split(/\\*([^*]*)\\*/);\n    },\n\n    parsedTemplate(): DragTheWordsElement[] {\n      return this.splitTemplate.map((value, index) => {\n        if (index % 2 === 0) {\n          return { type: 'staticText', text: value, uuid: uuidv4() };\n        } else {\n          let splitString = value.split(':');\n          let solution = splitString[0];\n          let hint = splitString[1];\n          return {\n            type: 'blank',\n            solution: solution,\n            hint: hint,\n            uuid: uuidv4(),\n          };\n        }\n      });\n    },\n\n    parsedDistractors(): string[] {\n      // Extract distractors from the input\n      const distractors = (this.task.distractors.match(/\\*(.*?)\\*/g) || []) // Handle cases with no matches\n        .map((distractor) => distractor.replace(/\\*/g, '').trim());\n\n      return distractors;\n    },\n\n    blanks(): Blank[] {\n      return this.parsedTemplate.filter(\n        (word) => word.type === 'blank'\n      ) as Blank[];\n    },\n\n    answers(): Answer[] {\n      const correctAnswers = this.blanks.map((blank) => ({\n        uuid: uuidv4(),\n        text: blank.solution,\n      }));\n\n      const distractorAnswers = this.parsedDistractors.map((distractor) => ({\n        uuid: uuidv4(),\n        text: distractor,\n      }));\n\n      return [...correctAnswers, ...distractorAnswers];\n    },\n\n    draggedAnswer(): Answer | undefined {\n      if (!this.draggedAnswerId) {\n        return undefined;\n      } else {\n        return this.getAnswerById(this.draggedAnswerId);\n      }\n    },\n\n    randomizedAnswers(): Answer[] {\n      // https://stackoverflow.com/a/46545530\n      return this.answers\n        .map((value) => ({ value, sort: Math.random() }))\n        .sort((a, b) => a.sort - b.sort)\n        .map(({ value }) => value);\n    },\n\n    sortedAnswers(): Answer[] {\n      // https://stackoverflow.com/a/45544166\n      return this.answers\n        .map((value) => value)\n        .sort((a, b) => a.text.localeCompare(b.text));\n    },\n\n    blanksFilled(): number {\n      if (!this.submittedAnswers) {\n        return 0;\n      } else {\n        return Object.keys(this.submittedAnswers).length;\n      }\n    },\n\n    allBlanksAreFilled(): boolean {\n      return this.blanksFilled == this.blanks.length;\n    },\n\n    correctAnswers(): number {\n      return this.blanks.filter((blank) => this.submittedAnswerIsCorrect(blank))\n        .length;\n    },\n\n    allAnswersAreCorrect(): boolean {\n      return this.blanks.every((blank) => this.submittedAnswerIsCorrect(blank));\n    },\n\n    maxPoints(): number {\n      return this.blanks.length;\n    },\n\n    unusedAnswers(): Answer[] {\n      if (this.task.alphabeticOrder) {\n        return this.sortedAnswers.filter(\n          (answer) => !Object.values(this.userInputs).includes(answer.uuid)\n        );\n      } else {\n        return this.randomizedAnswers.filter(\n          (answer) => !Object.values(this.userInputs).includes(answer.uuid)\n        );\n      }\n    },\n\n    inputHasChanged(): boolean {\n      return !isEqual(this.submittedAnswers, this.userInputs);\n    },\n\n    showCheckButton(): boolean {\n      return (\n        (this.submittedAnswers === null || this.inputHasChanged) &&\n        !this.task.instantFeedback\n      );\n    },\n\n    showSolutionsButton(): boolean {\n      return (\n        this.task.showSolutionsAllowed &&\n        !this.showSolutions &&\n        this.showResults &&\n        !this.allAnswersAreCorrect\n      );\n    },\n\n    showRetryButton(): boolean {\n      return (\n        this.task.retryAllowed &&\n        this.showResults &&\n        !this.allAnswersAreCorrect &&\n        this.submittedAnswers !== null\n      );\n    },\n\n    showSolutions(): boolean {\n      return (\n        this.userWantsToSeeSolutions &&\n        (this.allBlanksAreFilled ||\n          !this.task.allBlanksMustBeFilledForSolutions)\n      );\n    },\n\n    showFillInAllTheBlanksMessage(): boolean {\n      return (\n        this.task.allBlanksMustBeFilledForSolutions &&\n        this.userWantsToSeeSolutions &&\n        !this.allBlanksAreFilled &&\n        !this.inputHasChanged\n      );\n    },\n\n    showResults(): boolean {\n      return (\n        !(this.submittedAnswers === null) &&\n        !this.showFillInAllTheBlanksMessage &&\n        (!this.task.instantFeedback || this.allBlanksAreFilled) &&\n        !this.inputHasChanged\n      );\n    },\n\n    resultMessage(): string {\n      let resultMessage = this.task.strings.resultMessage.replace(\n        ':correct',\n        this.correctAnswers.toString()\n      );\n\n      resultMessage = resultMessage.replace(\n        ':total',\n        this.blanks.length.toString()\n      );\n\n      return resultMessage;\n    },\n\n    fillInAllTheBlanksMessage(): string {\n      return this.task.strings.fillInAllBlanksMessage\n        ? this.task.strings.fillInAllBlanksMessage\n        : $gettext(\n            'Alle Lcken mssen ausgefllt sein, um Lsungen anzuzeigen'\n          );\n    },\n  },\n});\n</script>\n\n<style scoped>\n.static-text {\n  display: inline;\n  vertical-align: middle;\n\n  background: #ffffff;\n  color: #000000;\n}\n\n.blank {\n  display: inline-block;\n  min-width: 9em;\n  max-width: 9em;\n  vertical-align: middle;\n\n  overflow: hidden;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n\n  background: #cee0f4;\n  color: #1a4473;\n  text-align: center;\n\n  border: 1px solid #a9c3d0;\n  border-radius: 0.25em;\n  padding: 0 0.25em 0 0.25em;\n\n  line-height: 1.25em;\n}\n\n.filled {\n  cursor: grabbing;\n}\n\n.filled:not(.disabled):hover {\n  border: 1px solid rgb(212, 190, 216);\n  color: #663366;\n  background: #edd6e9;\n}\n\n.correct {\n  background: #9dd8bb;\n  border: 1px solid #9dd8bb;\n  color: #255c41;\n}\n\n.incorrect {\n  background-color: #f7d0d0;\n  border: 1px solid #f7d0d0;\n  color: #b71c1c;\n  text-decoration: line-through;\n}\n\nspan.item:empty:before {\n  content: '\\200b';\n}\n\n.unused-answers-list {\n  min-width: 12em;\n  padding-top: 0.5em;\n  padding-bottom: 0.5em;\n\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  gap: 0.75em;\n\n  border: 1px solid #eee;\n  border-radius: 5px;\n}\n\n.unused-answer {\n  display: inline-block;\n  min-width: 9em;\n  max-width: 9em;\n\n  overflow-wrap: break-word;\n\n  background: #ddd;\n  box-shadow: 0 0 0.3em rgba(0, 0, 0, 0.2);\n  text-align: center;\n\n  border: 1px solid #c6c6c6;\n  border-radius: 0.25em;\n  padding: 0 0.25em 0 0.25em;\n\n  line-height: 1.25em;\n\n  cursor: grabbing;\n}\n\n.unused-answer:not(.disabled):hover {\n  border: 0.1em solid rgb(212, 190, 216);\n  color: #663366;\n  background: #edd6e9;\n}\n\n.disabled {\n  cursor: default;\n}\n\n.selected:not(.disabled) {\n  border: 0.1em solid rgb(212, 190, 216);\n  color: #663366;\n  background: #edd6e9;\n}\n\n.text-and-feedback-container {\n  flex-grow: 1;\n  display: flex;\n  flex-direction: column;\n}\n\n.drag-the-words-text {\n  flex-grow: 0;\n}\n\n.text-and-answers-container {\n  display: flex;\n  gap: 1em;\n}\n</style>\n","import { render } from \"./DragTheWordsViewer.vue?vue&type=template&id=501f9f22&scoped=true&ts=true\"\nimport script from \"./DragTheWordsViewer.vue?vue&type=script&lang=ts\"\nexport * from \"./DragTheWordsViewer.vue?vue&type=script&lang=ts\"\n\nimport \"./DragTheWordsViewer.vue?vue&type=style&index=0&id=501f9f22&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-501f9f22\"]])\n\nexport default __exports__","import { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, vModelCheckbox as _vModelCheckbox, withDirectives as _withDirectives, createTextVNode as _createTextVNode, normalizeClass as _normalizeClass, vModelText as _vModelText, openBlock as _openBlock, createElementBlock as _createElementBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-7715379e\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"stud5p-task\" }\nconst _hoisted_2 = { class: \"default\" }\nconst _hoisted_3 = { class: \"fill-in-the-blanks-editor-top-panel\" }\nconst _hoisted_4 = [\"data-tooltip\"]\nconst _hoisted_5 = { class: \"collapsable collapsed\" }\nconst _hoisted_6 = [\"disabled\"]\nconst _hoisted_7 = { class: \"collapsable collapsed\" }\nconst _hoisted_8 = [\"disabled\"]\nconst _hoisted_9 = [\"disabled\"]\nconst _hoisted_10 = [\"disabled\"]\nconst _hoisted_11 = [\"disabled\"]\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_studip_wysiwyg = _resolveComponent(\"studip-wysiwyg\")!\n  const _component_feedback_editor = _resolveComponent(\"feedback-editor\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createElementVNode(\"form\", _hoisted_2, [\n      _createElementVNode(\"fieldset\", null, [\n        _createElementVNode(\"legend\", null, _toDisplayString(_ctx.$gettext('Fill in the Blanks')), 1),\n        _createElementVNode(\"div\", _hoisted_3, [\n          _createElementVNode(\"button\", {\n            onClick: _cache[0] || (_cache[0] = \n//@ts-ignore\n(...args) => (_ctx.addBlank && _ctx.addBlank(...args))),\n            class: \"button add-blank\",\n            type: \"button\"\n          }, _toDisplayString(_ctx.$gettext('Lcke hinzufgen')), 1),\n          _createElementVNode(\"div\", {\n            class: \"tooltip tooltip-icon\",\n            \"data-tooltip\": _ctx.instructions\n          }, null, 8, _hoisted_4)\n        ]),\n        _createVNode(_component_studip_wysiwyg, {\n          modelValue: _ctx.modelTaskDefinition.template,\n          \"onUpdate:modelValue\": _ctx.onEditTemplate,\n          ref: \"wysiwyg\",\n          \"force-soft-breaks\": \"\",\n          \"remove-wrapping-p-tag\": \"\",\n          \"disable-autoformat\": \"\"\n        }, null, 8, [\"modelValue\", \"onUpdate:modelValue\"])\n      ]),\n      _createElementVNode(\"fieldset\", _hoisted_5, [\n        _createElementVNode(\"legend\", null, _toDisplayString(_ctx.$gettext('Einstellungen')), 1),\n        _createElementVNode(\"label\", null, [\n          _withDirectives(_createElementVNode(\"input\", {\n            \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event: any) => ((_ctx.modelTaskDefinition.caseSensitive) = $event)),\n            onChange: _cache[2] || (_cache[2] = \n//@ts-ignore\n(...args) => (_ctx.updateTaskDefinition && _ctx.updateTaskDefinition(...args))),\n            type: \"checkbox\"\n          }, null, 544), [\n            [_vModelCheckbox, _ctx.modelTaskDefinition.caseSensitive]\n          ]),\n          _createTextVNode(\" \" + _toDisplayString(_ctx.$gettext('Gro- und Kleinschreibung beachten')), 1)\n        ]),\n        _createElementVNode(\"label\", null, [\n          _withDirectives(_createElementVNode(\"input\", {\n            \"onUpdate:modelValue\": _cache[3] || (_cache[3] = ($event: any) => ((_ctx.modelTaskDefinition.acceptTypos) = $event)),\n            onChange: _cache[4] || (_cache[4] = \n//@ts-ignore\n(...args) => (_ctx.updateTaskDefinition && _ctx.updateTaskDefinition(...args))),\n            type: \"checkbox\"\n          }, null, 544), [\n            [_vModelCheckbox, _ctx.modelTaskDefinition.acceptTypos]\n          ]),\n          _createTextVNode(\" \" + _toDisplayString(_ctx.$gettext('Rechtschreib- und Tippfehler ignorieren')), 1)\n        ]),\n        _createElementVNode(\"label\", null, [\n          _withDirectives(_createElementVNode(\"input\", {\n            \"onUpdate:modelValue\": _cache[5] || (_cache[5] = ($event: any) => ((_ctx.modelTaskDefinition.autoCorrect) = $event)),\n            onChange: _cache[6] || (_cache[6] = \n//@ts-ignore\n(...args) => (_ctx.updateTaskDefinition && _ctx.updateTaskDefinition(...args))),\n            type: \"checkbox\"\n          }, null, 544), [\n            [_vModelCheckbox, _ctx.modelTaskDefinition.autoCorrect]\n          ]),\n          _createTextVNode(\" \" + _toDisplayString(_ctx.$gettext('Lcken automatisch prfen')), 1)\n        ]),\n        _createElementVNode(\"label\", null, [\n          _withDirectives(_createElementVNode(\"input\", {\n            \"onUpdate:modelValue\": _cache[7] || (_cache[7] = ($event: any) => ((_ctx.modelTaskDefinition.retryAllowed) = $event)),\n            onChange: _cache[8] || (_cache[8] = \n//@ts-ignore\n(...args) => (_ctx.updateTaskDefinition && _ctx.updateTaskDefinition(...args))),\n            type: \"checkbox\"\n          }, null, 544), [\n            [_vModelCheckbox, _ctx.modelTaskDefinition.retryAllowed]\n          ]),\n          _createTextVNode(\" \" + _toDisplayString(_ctx.$gettext('Mehrere Versuche erlauben')), 1)\n        ]),\n        _createElementVNode(\"label\", null, [\n          _withDirectives(_createElementVNode(\"input\", {\n            \"onUpdate:modelValue\": _cache[9] || (_cache[9] = ($event: any) => ((_ctx.modelTaskDefinition.showSolutionsAllowed) = $event)),\n            onChange: _cache[10] || (_cache[10] = \n//@ts-ignore\n(...args) => (_ctx.updateShowSolutionsAllowed && _ctx.updateShowSolutionsAllowed(...args))),\n            type: \"checkbox\"\n          }, null, 544), [\n            [_vModelCheckbox, _ctx.modelTaskDefinition.showSolutionsAllowed]\n          ]),\n          _createTextVNode(\" \" + _toDisplayString(_ctx.$gettext('Lsungen anzeigen erlauben')), 1)\n        ]),\n        _createElementVNode(\"label\", {\n          class: _normalizeClass({\n            'setting-disabled': !_ctx.modelTaskDefinition.showSolutionsAllowed,\n          })\n        }, [\n          _withDirectives(_createElementVNode(\"input\", {\n            \"onUpdate:modelValue\": _cache[11] || (_cache[11] = ($event: any) => ((_ctx.modelTaskDefinition.allBlanksMustBeFilledForSolutions) = $event)),\n            onChange: _cache[12] || (_cache[12] = \n//@ts-ignore\n(...args) => (_ctx.updateTaskDefinition && _ctx.updateTaskDefinition(...args))),\n            disabled: !_ctx.modelTaskDefinition.showSolutionsAllowed,\n            type: \"checkbox\"\n          }, null, 40, _hoisted_6), [\n            [_vModelCheckbox, _ctx.modelTaskDefinition.allBlanksMustBeFilledForSolutions]\n          ]),\n          _createTextVNode(\" \" + _toDisplayString(_ctx.$gettext('Lsungen nur anzeigen, wenn alle Lcken ausgefllt sind')), 1)\n        ], 2)\n      ]),\n      _createElementVNode(\"fieldset\", _hoisted_7, [\n        _createElementVNode(\"legend\", null, _toDisplayString(_ctx.$gettext('Beschriftungen')), 1),\n        _createElementVNode(\"label\", {\n          class: _normalizeClass({ 'setting-disabled': _ctx.modelTaskDefinition.autoCorrect })\n        }, [\n          _createTextVNode(_toDisplayString(_ctx.$gettext('Text fr berprfen-Button:')) + \" \", 1),\n          _withDirectives(_createElementVNode(\"input\", {\n            \"onUpdate:modelValue\": _cache[13] || (_cache[13] = ($event: any) => ((_ctx.modelTaskDefinition.strings.checkButton) = $event)),\n            onInput: _cache[14] || (_cache[14] = ($event: any) => (_ctx.updateTaskDefinition('taskDefinition.strings.checkButton'))),\n            disabled: _ctx.modelTaskDefinition.autoCorrect,\n            type: \"text\"\n          }, null, 40, _hoisted_8), [\n            [_vModelText, _ctx.modelTaskDefinition.strings.checkButton]\n          ])\n        ], 2),\n        _createElementVNode(\"label\", {\n          class: _normalizeClass({ 'setting-disabled': !_ctx.modelTaskDefinition.retryAllowed })\n        }, [\n          _createTextVNode(_toDisplayString(_ctx.$gettext('Text fr Wiederholen-Button:')) + \" \", 1),\n          _withDirectives(_createElementVNode(\"input\", {\n            \"onUpdate:modelValue\": _cache[15] || (_cache[15] = ($event: any) => ((_ctx.modelTaskDefinition.strings.retryButton) = $event)),\n            onInput: _cache[16] || (_cache[16] = ($event: any) => (_ctx.updateTaskDefinition('taskDefinition.strings.retryButton'))),\n            disabled: !_ctx.modelTaskDefinition.retryAllowed,\n            type: \"text\"\n          }, null, 40, _hoisted_9), [\n            [_vModelText, _ctx.modelTaskDefinition.strings.retryButton]\n          ])\n        ], 2),\n        _createElementVNode(\"label\", {\n          class: _normalizeClass({\n            'setting-disabled': !_ctx.modelTaskDefinition.showSolutionsAllowed,\n          })\n        }, [\n          _createTextVNode(_toDisplayString(_ctx.$gettext('Text fr Lsungen-Button:')) + \" \", 1),\n          _withDirectives(_createElementVNode(\"input\", {\n            \"onUpdate:modelValue\": _cache[17] || (_cache[17] = ($event: any) => ((_ctx.modelTaskDefinition.strings.solutionsButton) = $event)),\n            onInput: _cache[18] || (_cache[18] = ($event: any) => (\n              _ctx.updateTaskDefinition('taskDefinition.strings.solutionsButton')\n            )),\n            disabled: !_ctx.modelTaskDefinition.showSolutionsAllowed,\n            type: \"text\"\n          }, null, 40, _hoisted_10), [\n            [_vModelText, _ctx.modelTaskDefinition.strings.solutionsButton]\n          ])\n        ], 2),\n        _createElementVNode(\"label\", {\n          class: _normalizeClass({\n            'setting-disabled':\n              !_ctx.modelTaskDefinition.showSolutionsAllowed ||\n              !_ctx.modelTaskDefinition.allBlanksMustBeFilledForSolutions,\n          })\n        }, [\n          _createTextVNode(_toDisplayString(_ctx.$gettext('Hinweis, wenn nicht alle Lcken ausgefllt sind:')) + \" \", 1),\n          _withDirectives(_createElementVNode(\"input\", {\n            \"onUpdate:modelValue\": _cache[19] || (_cache[19] = ($event: any) => ((_ctx.modelTaskDefinition.strings.fillInAllBlanksMessage) = $event)),\n            onInput: _cache[20] || (_cache[20] = ($event: any) => (\n              _ctx.updateTaskDefinition(\n                'taskDefinition.strings.fillInAllBlanksMessage'\n              )\n            )),\n            disabled: \n              !_ctx.modelTaskDefinition.showSolutionsAllowed ||\n              !_ctx.modelTaskDefinition.allBlanksMustBeFilledForSolutions\n            ,\n            type: \"text\"\n          }, null, 40, _hoisted_11), [\n            [_vModelText, _ctx.modelTaskDefinition.strings.fillInAllBlanksMessage]\n          ])\n        ], 2)\n      ]),\n      _createVNode(_component_feedback_editor, {\n        feedback: _ctx.modelTaskDefinition.feedback,\n        \"result-message\": _ctx.modelTaskDefinition.strings.resultMessage,\n        \"onUpdate:feedback\": _ctx.updateFeedback,\n        \"onUpdate:resultMessage\": _ctx.updateResultMessage\n      }, null, 8, [\"feedback\", \"result-message\", \"onUpdate:feedback\", \"onUpdate:resultMessage\"])\n    ])\n  ]))\n}","<template>\n  <div class=\"stud5p-task\">\n    <form class=\"default\">\n      <fieldset>\n        <legend>{{ $gettext('Fill in the Blanks') }}</legend>\n\n        <div class=\"fill-in-the-blanks-editor-top-panel\">\n          <button @click=\"addBlank\" class=\"button add-blank\" type=\"button\">\n            {{ $gettext('Lcke hinzufgen') }}\n          </button>\n          <div class=\"tooltip tooltip-icon\" :data-tooltip=\"instructions\" />\n        </div>\n\n        <studip-wysiwyg\n          :modelValue=\"modelTaskDefinition.template\"\n          @update:modelValue=\"onEditTemplate\"\n          ref=\"wysiwyg\"\n          force-soft-breaks\n          remove-wrapping-p-tag\n          disable-autoformat\n        />\n      </fieldset>\n\n      <fieldset class=\"collapsable collapsed\">\n        <legend>{{ $gettext('Einstellungen') }}</legend>\n\n        <label>\n          <input\n            v-model=\"modelTaskDefinition.caseSensitive\"\n            @change=\"updateTaskDefinition\"\n            type=\"checkbox\"\n          />\n          {{ $gettext('Gro- und Kleinschreibung beachten') }}\n        </label>\n\n        <label>\n          <input\n            v-model=\"modelTaskDefinition.acceptTypos\"\n            @change=\"updateTaskDefinition\"\n            type=\"checkbox\"\n          />\n          {{ $gettext('Rechtschreib- und Tippfehler ignorieren') }}\n        </label>\n\n        <label>\n          <input\n            v-model=\"modelTaskDefinition.autoCorrect\"\n            @change=\"updateTaskDefinition\"\n            type=\"checkbox\"\n          />\n          {{ $gettext('Lcken automatisch prfen') }}\n        </label>\n\n        <label>\n          <input\n            v-model=\"modelTaskDefinition.retryAllowed\"\n            @change=\"updateTaskDefinition\"\n            type=\"checkbox\"\n          />\n          {{ $gettext('Mehrere Versuche erlauben') }}\n        </label>\n\n        <label>\n          <input\n            v-model=\"modelTaskDefinition.showSolutionsAllowed\"\n            @change=\"updateShowSolutionsAllowed\"\n            type=\"checkbox\"\n          />\n          {{ $gettext('Lsungen anzeigen erlauben') }}\n        </label>\n\n        <label\n          :class=\"{\n            'setting-disabled': !modelTaskDefinition.showSolutionsAllowed,\n          }\"\n        >\n          <input\n            v-model=\"modelTaskDefinition.allBlanksMustBeFilledForSolutions\"\n            @change=\"updateTaskDefinition\"\n            :disabled=\"!modelTaskDefinition.showSolutionsAllowed\"\n            type=\"checkbox\"\n          />\n          {{\n            $gettext('Lsungen nur anzeigen, wenn alle Lcken ausgefllt sind')\n          }}\n        </label>\n      </fieldset>\n\n      <fieldset class=\"collapsable collapsed\">\n        <legend>{{ $gettext('Beschriftungen') }}</legend>\n\n        <label :class=\"{ 'setting-disabled': modelTaskDefinition.autoCorrect }\">\n          {{ $gettext('Text fr berprfen-Button:') }}\n          <input\n            v-model=\"modelTaskDefinition.strings.checkButton\"\n            @input=\"updateTaskDefinition('taskDefinition.strings.checkButton')\"\n            :disabled=\"modelTaskDefinition.autoCorrect\"\n            type=\"text\"\n          />\n        </label>\n\n        <label\n          :class=\"{ 'setting-disabled': !modelTaskDefinition.retryAllowed }\"\n        >\n          {{ $gettext('Text fr Wiederholen-Button:') }}\n          <input\n            v-model=\"modelTaskDefinition.strings.retryButton\"\n            @input=\"updateTaskDefinition('taskDefinition.strings.retryButton')\"\n            :disabled=\"!modelTaskDefinition.retryAllowed\"\n            type=\"text\"\n          />\n        </label>\n\n        <label\n          :class=\"{\n            'setting-disabled': !modelTaskDefinition.showSolutionsAllowed,\n          }\"\n        >\n          {{ $gettext('Text fr Lsungen-Button:') }}\n          <input\n            v-model=\"modelTaskDefinition.strings.solutionsButton\"\n            @input=\"\n              updateTaskDefinition('taskDefinition.strings.solutionsButton')\n            \"\n            :disabled=\"!modelTaskDefinition.showSolutionsAllowed\"\n            type=\"text\"\n          />\n        </label>\n\n        <label\n          :class=\"{\n            'setting-disabled':\n              !modelTaskDefinition.showSolutionsAllowed ||\n              !modelTaskDefinition.allBlanksMustBeFilledForSolutions,\n          }\"\n        >\n          {{ $gettext('Hinweis, wenn nicht alle Lcken ausgefllt sind:') }}\n          <input\n            v-model=\"modelTaskDefinition.strings.fillInAllBlanksMessage\"\n            @input=\"\n              updateTaskDefinition(\n                'taskDefinition.strings.fillInAllBlanksMessage'\n              )\n            \"\n            :disabled=\"\n              !modelTaskDefinition.showSolutionsAllowed ||\n              !modelTaskDefinition.allBlanksMustBeFilledForSolutions\n            \"\n            type=\"text\"\n          />\n        </label>\n      </fieldset>\n\n      <feedback-editor\n        :feedback=\"modelTaskDefinition.feedback\"\n        :result-message=\"modelTaskDefinition.strings.resultMessage\"\n        @update:feedback=\"updateFeedback\"\n        @update:result-message=\"updateResultMessage\"\n      />\n    </form>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, inject, PropType } from 'vue';\nimport { FillInTheBlanksTask } from '@/models/TaskDefinition';\nimport { Feedback } from '@/models/common';\nimport StudipWysiwyg from '@/components/StudipWysiwyg.vue';\nimport FeedbackEditor from '@/components/FeedbackEditor.vue';\nimport { $gettext } from '@/language/gettext';\nimport produce from 'immer';\nimport {\n  TaskEditorState,\n  taskEditorStateSymbol,\n} from '@/components/taskEditorState';\nimport { cloneDeep } from 'lodash';\n\nexport default defineComponent({\n  name: 'FillInTheBlanksEditor',\n  setup() {\n    return {\n      taskEditor: inject<TaskEditorState>(taskEditorStateSymbol),\n    };\n  },\n  components: { StudipWysiwyg, FeedbackEditor },\n  props: {\n    taskDefinition: {\n      type: Object as PropType<FillInTheBlanksTask>,\n      required: true,\n    },\n  },\n  data() {\n    return {\n      modelTaskDefinition: cloneDeep(this.taskDefinition),\n    };\n  },\n  watch: {\n    // Synchronize state taskDefinition -> modelTaskDefinition.\n    taskDefinition: {\n      immediate: true,\n      handler: function (): void {\n        this.modelTaskDefinition = cloneDeep(this.taskDefinition);\n      },\n    },\n  },\n  computed: {\n    instructions(): string {\n      return $gettext(\n        'Um eine Lcke zu erstellen, setzen Sie ein Sternchen (*) vor und hinter das korrekte Wort oder markieren Sie das Wort und klicken Sie auf den Button Lcke hinzufgen. Sie knnen auch einen Tooltip hinzufgen, indem Sie einen Doppelpunkt (:) vor den Tooltip-Text schreiben.'\n      );\n    },\n  },\n  methods: {\n    $gettext,\n\n    /**\n     * Surround the selected text with two asterisks\n     */\n    addBlank() {\n      const wysiwygEl = (this.$refs.wysiwyg as any)?.$el;\n      const editor = window.STUDIP.wysiwyg.getEditor(wysiwygEl);\n      if (!editor) {\n        console.error('getEditor(wysiwygEl) returned: ', editor);\n        throw new Error('Could not get reference to wysiwyg editor');\n      }\n      const selection = editor.model.document.selection;\n      const start = selection.getFirstPosition();\n      const end = selection.getLastPosition();\n      if (!start || !end) {\n        console.error('selection start: ', start, ' selection end: ', end);\n        throw new Error('Could not get selection in editor');\n      }\n      editor.model.change((writer) => {\n        writer.insertText('*', end);\n        writer.insertText('*', start);\n      });\n    },\n\n    onEditTemplate(data: string): void {\n      // Copy new data from wysiwyg editor into task definition\n      this.taskEditor!.performEdit({\n        newTaskDefinition: produce(\n          this.modelTaskDefinition,\n          (draft: FillInTheBlanksTask) => {\n            draft.template = data;\n          }\n        ),\n        undoBatch: 'taskDefinition.template',\n      });\n    },\n\n    updateTaskDefinition(undoBatch?: unknown) {\n      // Synchronize state modelTaskDefinition -> taskDefinition.\n      console.log('update task definition');\n      this.taskEditor!.performEdit({\n        newTaskDefinition: cloneDeep(this.modelTaskDefinition),\n        undoBatch: undoBatch ?? {},\n      });\n    },\n\n    updateShowSolutionsAllowed() {\n      if (!this.modelTaskDefinition.showSolutionsAllowed) {\n        this.modelTaskDefinition.allBlanksMustBeFilledForSolutions = false;\n      }\n      this.updateTaskDefinition();\n    },\n\n    updateFeedback(updatedFeedback: Feedback[]) {\n      this.taskEditor!.performEdit({\n        newTaskDefinition: produce(\n          this.modelTaskDefinition,\n          (taskDraft: FillInTheBlanksTask) => {\n            taskDraft.feedback = updatedFeedback;\n          }\n        ),\n        undoBatch: 'taskDefinition.feedback',\n      });\n    },\n\n    updateResultMessage(updatedResultMessage: string) {\n      this.taskEditor!.performEdit({\n        newTaskDefinition: produce(\n          this.modelTaskDefinition,\n          (taskDraft: FillInTheBlanksTask) => {\n            taskDraft.strings.resultMessage = updatedResultMessage;\n          }\n        ),\n        undoBatch: 'taskDefinition.strings.resultMessage',\n      });\n    },\n\n    urlForIcon(iconName: string) {\n      return (\n        window.STUDIP.ASSETS_URL + 'images/icons/blue/' + iconName + '.svg'\n      );\n    },\n  },\n});\n</script>\n\n<style scoped>\n.fill-in-the-blanks-editor-top-panel {\n  display: flex;\n  justify-content: flex-start;\n  align-items: center;\n}\n</style>\n","import { render } from \"./FillInTheBlanksEditor.vue?vue&type=template&id=7715379e&scoped=true&ts=true\"\nimport script from \"./FillInTheBlanksEditor.vue?vue&type=script&lang=ts\"\nexport * from \"./FillInTheBlanksEditor.vue?vue&type=script&lang=ts\"\n\nimport \"./FillInTheBlanksEditor.vue?vue&type=style&index=0&id=7715379e&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-7715379e\"]])\n\nexport default __exports__","import { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, vModelText as _vModelText, withKeys as _withKeys, normalizeClass as _normalizeClass, createElementVNode as _createElementVNode, withDirectives as _withDirectives, toDisplayString as _toDisplayString, resolveComponent as _resolveComponent, createBlock as _createBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-991d4d3e\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = {\n  class: \"stud5p-task\",\n  ref: \"wrapperElement\"\n}\nconst _hoisted_2 = { class: \"fill-in-the-blanks-text\" }\nconst _hoisted_3 = [\"innerHTML\"]\nconst _hoisted_4 = [\"onUpdate:modelValue\", \"readonly\", \"disabled\"]\nconst _hoisted_5 = { key: 0 }\nconst _hoisted_6 = [\"data-tooltip\"]\nconst _hoisted_7 = {\n  key: 1,\n  class: \"stud5p-solution\"\n}\nconst _hoisted_8 = { class: \"feedback-and-button-container\" }\nconst _hoisted_9 = [\"textContent\"]\nconst _hoisted_10 = { class: \"button-panel\" }\nconst _hoisted_11 = [\"textContent\"]\nconst _hoisted_12 = [\"textContent\"]\nconst _hoisted_13 = [\"textContent\"]\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_FeedbackElement = _resolveComponent(\"FeedbackElement\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createElementVNode(\"div\", _hoisted_2, [\n      (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.parsedTemplate, (element) => {\n        return (_openBlock(), _createElementBlock(_Fragment, {\n          key: element.uuid\n        }, [\n          (element.type === 'staticText')\n            ? (_openBlock(), _createElementBlock(\"span\", {\n                key: 0,\n                innerHTML: element.text\n              }, null, 8, _hoisted_3))\n            : (element.type === 'blank')\n              ? (_openBlock(), _createElementBlock(_Fragment, { key: 1 }, [\n                  _withDirectives(_createElementVNode(\"input\", {\n                    type: \"text\",\n                    \"onUpdate:modelValue\": ($event: any) => ((_ctx.userInputs[element.uuid]) = $event),\n                    readonly: !_ctx.editable,\n                    disabled: !_ctx.editable,\n                    class: _normalizeClass([\n              'blank',\n              { autocorrect: _ctx.task.autoCorrect },\n              _ctx.classForInput(element),\n            ]),\n                    onBlur: _cache[0] || (_cache[0] = \n//@ts-ignore\n(...args) => (_ctx.onBlur && _ctx.onBlur(...args))),\n                    onKeyup: _cache[1] || (_cache[1] = _withKeys(($event: any) => (_ctx.onEnter($event)), [\"enter\"])),\n                    onInput: _cache[2] || (_cache[2] = \n//@ts-ignore\n(...args) => (_ctx.onInput && _ctx.onInput(...args))),\n                    ref_for: true,\n                    ref: \"blanks\"\n                  }, null, 42, _hoisted_4), [\n                    [_vModelText, _ctx.userInputs[element.uuid]]\n                  ]),\n                  (element.hint)\n                    ? (_openBlock(), _createElementBlock(\"label\", _hoisted_5, [\n                        _createElementVNode(\"span\", {\n                          class: \"tooltip tooltip-icon\",\n                          \"data-tooltip\": element.hint\n                        }, null, 8, _hoisted_6)\n                      ]))\n                    : _createCommentVNode(\"\", true),\n                  (\n              _ctx.showSolutions &&\n              !_ctx.showFillInAllTheBlanksMessage &&\n              !_ctx.submittedAnswerIsCorrect(element)\n            )\n                    ? (_openBlock(), _createElementBlock(\"span\", _hoisted_7, _toDisplayString(element.solutions[0]), 1))\n                    : _createCommentVNode(\"\", true)\n                ], 64))\n              : _createCommentVNode(\"\", true)\n        ], 64))\n      }), 128))\n    ]),\n    _createElementVNode(\"div\", _hoisted_8, [\n      (_ctx.showFillInAllTheBlanksMessage)\n        ? (_openBlock(), _createElementBlock(\"div\", {\n            key: 0,\n            class: \"stud5p-message\",\n            textContent: _toDisplayString(_ctx.fillInAllTheBlanksMessage)\n          }, null, 8, _hoisted_9))\n        : _createCommentVNode(\"\", true),\n      (_ctx.showResults)\n        ? (_openBlock(), _createBlock(_component_FeedbackElement, {\n            key: 1,\n            achievedPoints: _ctx.correctAnswers,\n            maxPoints: _ctx.maxPoints,\n            feedback: _ctx.task.feedback,\n            resultMessage: _ctx.resultMessage\n          }, null, 8, [\"achievedPoints\", \"maxPoints\", \"feedback\", \"resultMessage\"]))\n        : _createCommentVNode(\"\", true),\n      _createElementVNode(\"div\", _hoisted_10, [\n        (_ctx.showCheckButton)\n          ? (_openBlock(), _createElementBlock(\"button\", {\n              key: 0,\n              textContent: _toDisplayString(_ctx.task.strings.checkButton),\n              onClick: _cache[3] || (_cache[3] = ($event: any) => (_ctx.onClickCheck(false))),\n              type: \"button\",\n              class: \"stud5p-button\",\n              ref: \"checkButton\"\n            }, null, 8, _hoisted_11))\n          : _createCommentVNode(\"\", true),\n        (_ctx.showExtraButtons)\n          ? (_openBlock(), _createElementBlock(_Fragment, { key: 1 }, [\n              (_ctx.showSolutionButton)\n                ? (_openBlock(), _createElementBlock(\"button\", {\n                    key: 0,\n                    textContent: _toDisplayString(_ctx.task.strings.solutionsButton),\n                    onClick: _cache[4] || (_cache[4] = \n//@ts-ignore\n(...args) => (_ctx.onClickShowSolution && _ctx.onClickShowSolution(...args))),\n                    type: \"button\",\n                    class: \"stud5p-button\"\n                  }, null, 8, _hoisted_12))\n                : _createCommentVNode(\"\", true),\n              (_ctx.showRetryButton)\n                ? (_openBlock(), _createElementBlock(\"button\", {\n                    key: 1,\n                    textContent: _toDisplayString(_ctx.task.strings.retryButton),\n                    onClick: _cache[5] || (_cache[5] = \n//@ts-ignore\n(...args) => (_ctx.onClickTryAgain && _ctx.onClickTryAgain(...args))),\n                    type: \"button\",\n                    class: \"stud5p-button\"\n                  }, null, 8, _hoisted_13))\n                : _createCommentVNode(\"\", true)\n            ], 64))\n          : _createCommentVNode(\"\", true)\n      ])\n    ])\n  ], 512))\n}","<template>\n  <div class=\"stud5p-task\" ref=\"wrapperElement\">\n    <div class=\"fill-in-the-blanks-text\">\n      <template v-for=\"element in parsedTemplate\" :key=\"element.uuid\">\n        <span v-if=\"element.type === 'staticText'\" v-html=\"element.text\" />\n\n        <template v-else-if=\"element.type === 'blank'\">\n          <input\n            type=\"text\"\n            v-model=\"userInputs[element.uuid]\"\n            :readonly=\"!editable\"\n            :disabled=\"!editable\"\n            :class=\"[\n              'blank',\n              { autocorrect: task.autoCorrect },\n              classForInput(element),\n            ]\"\n            @blur=\"onBlur\"\n            @keyup.enter=\"onEnter($event)\"\n            @input=\"onInput\"\n            ref=\"blanks\"\n          />\n\n          <label v-if=\"element.hint\">\n            <span class=\"tooltip tooltip-icon\" :data-tooltip=\"element.hint\" />\n          </label>\n\n          <span\n            v-if=\"\n              showSolutions &&\n              !showFillInAllTheBlanksMessage &&\n              !submittedAnswerIsCorrect(element)\n            \"\n            class=\"stud5p-solution\"\n          >\n            {{ element.solutions[0] }}\n          </span>\n        </template>\n      </template>\n    </div>\n\n    <!-- Feedback and button section -->\n    <div class=\"feedback-and-button-container\">\n      <div\n        v-if=\"showFillInAllTheBlanksMessage\"\n        class=\"stud5p-message\"\n        v-text=\"fillInAllTheBlanksMessage\"\n      />\n\n      <FeedbackElement\n        v-if=\"showResults\"\n        :achievedPoints=\"correctAnswers\"\n        :maxPoints=\"maxPoints\"\n        :feedback=\"task.feedback\"\n        :resultMessage=\"resultMessage\"\n      />\n\n      <div class=\"button-panel\">\n        <button\n          v-if=\"showCheckButton\"\n          v-text=\"task.strings.checkButton\"\n          @click=\"onClickCheck(false)\"\n          type=\"button\"\n          class=\"stud5p-button\"\n          ref=\"checkButton\"\n        />\n\n        <template v-if=\"showExtraButtons\">\n          <button\n            v-if=\"showSolutionButton\"\n            v-text=\"task.strings.solutionsButton\"\n            @click=\"onClickShowSolution\"\n            type=\"button\"\n            class=\"stud5p-button\"\n          />\n\n          <button\n            v-if=\"showRetryButton\"\n            v-text=\"task.strings.retryButton\"\n            @click=\"onClickTryAgain\"\n            type=\"button\"\n            class=\"stud5p-button\"\n          />\n        </template>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, PropType } from 'vue';\nimport { FillInTheBlanksTask } from '@/models/TaskDefinition';\nimport { Feedback } from '@/models/common';\nimport { v4 as uuidv4 } from 'uuid';\nimport { isEqual } from 'lodash';\nimport { $gettext } from '@/language/gettext';\nimport FeedbackElement from '@/components/FeedbackElement.vue';\n\ntype FillInTheBlanksElement = Blank | StaticText;\n\ntype Blank = {\n  type: 'blank';\n  uuid: Uuid;\n  solutions: string[];\n  hint: string;\n};\n\ntype StaticText = {\n  type: 'staticText';\n  uuid: Uuid;\n  text: string;\n};\n\ntype Uuid = string;\n\nconst dljs = require('damerau-levenshtein-js');\n\nexport default defineComponent({\n  name: 'FillInTheBlanksViewer',\n\n  components: {\n    FeedbackElement,\n  },\n\n  props: {\n    task: {\n      type: Object as PropType<FillInTheBlanksTask>,\n      required: true,\n    },\n  },\n\n  data() {\n    return {\n      userInputs: {} as Record<Uuid, string>,\n      submittedAnswers: null as Record<Uuid, string> | null,\n      showSolutions: false,\n      editable: true,\n    };\n  },\n\n  methods: {\n    $gettext,\n\n    submittedAnswerIsCorrect(element: FillInTheBlanksElement): boolean {\n      const blank = element as Blank;\n\n      const submittedAnswer = this.submittedAnswers?.[blank.uuid];\n      if (!submittedAnswer) {\n        return false;\n      } else {\n        return blank.solutions.some((solution) =>\n          this.isAnswerCorrect(submittedAnswer, solution)\n        );\n      }\n    },\n\n    isAnswerCorrect(userAnswer: string, solution: string): boolean {\n      if (this.task.caseSensitive) {\n        if (this.task.acceptTypos) {\n          return this.isAnswerCorrectWithTypo(userAnswer, solution);\n        } else {\n          return userAnswer === solution;\n        }\n      } else {\n        // TODO: Was ist, wenn das in einem Sprachkurs mit einer nichtlateinischen Schrift verwendet wird? :D\n        if (this.task.acceptTypos) {\n          return this.isAnswerCorrectWithTypo(\n            userAnswer.toLowerCase(),\n            solution.toLowerCase()\n          );\n        } else {\n          return userAnswer.toLowerCase() === solution.toLowerCase();\n        }\n      }\n    },\n\n    isAnswerCorrectWithTypo(userAnswer: string, solution: string): boolean {\n      if (userAnswer === solution) return true;\n\n      // Calculate the Damerau-Levenshtein distance between the answer and the solution\n      const distance = dljs.distance(userAnswer, solution);\n\n      // If the word is between 4 and 9 characters, a distance of 1 will be accepted\n      // If the word is more than 9 characters long, a distance of 2 will be accepted\n      return (\n        (userAnswer.length > 3 && distance <= 1) ||\n        (userAnswer.length > 9 && distance <= 2)\n      );\n    },\n\n    updateAttempt() {\n      // Tell the server which blanks were filled out correctly.\n      const points = {} as Record<string, number>;\n      this.blanks.forEach((blank, index) => {\n        // TODO Consider what the key should be. This is a bit ugly.\n        // The key is shown directly in the 'assessment' UI.\n        // Maybe we should change how that works?\n        points[`${index} - ${blank.solutions[0]}`] =\n          this.submittedAnswerIsCorrect(blank) ? 1 : 0;\n      });\n      this.$emit('updateAttempt', {\n        points,\n        // The attempt is marked as successful if all answers were correct.\n        success: this.correctAnswers === this.blanks.length,\n      });\n    },\n\n    /**\n     * Adapted from the H5P source code, MIT License\n     * https://github.com/h5p/h5p-blanks/blob/e9bf6862211c082a5724d9873496e66c489d23f7/js/blanks.js#L401\n     * TODO: Put the license in the appropriate place\n     */\n    autoGrowTextField(input: HTMLInputElement) {\n      // Do not set text field size when separate lines is enabled\n      // if (this.params.behaviour.separateLines) {\n      //   return;\n      // }\n      const computedStyles = window.getComputedStyle(input, null);\n      const computedFontSize = computedStyles.getPropertyValue('font-size');\n      const computedFontFamily = computedStyles.getPropertyValue('font-family');\n      const computedPadding = computedStyles.getPropertyValue('padding');\n      const fontSize = parseInt(computedFontSize, 10);\n      const minEm = 6;\n      const minPx = fontSize * minEm;\n      const rightPadEm = 3.25;\n      const rightPadPx = fontSize * rightPadEm;\n      const static_min_pad = 0.5 * fontSize;\n\n      setTimeout(() => {\n        const tmp = document.createElement('div');\n        tmp.textContent = input.value;\n        const tmpStyles = {\n          position: 'absolute',\n          'white-space': 'nowrap',\n          'font-size': computedFontSize,\n          'font-family': computedFontFamily,\n          padding: computedPadding,\n          width: 'initial',\n        };\n        for (const [key, value] of Object.entries(tmpStyles)) {\n          tmp.style[key as any] = value;\n        }\n        input.parentElement!.append(tmp);\n        const width = tmp.clientWidth;\n        const parentWidth = (this.$refs.wrapperElement as HTMLDivElement)\n          .clientWidth;\n        tmp.remove();\n        if (width <= minPx) {\n          // Apply min width\n          input.style.width = (minPx + static_min_pad).toString() + 'px';\n        } else if (width + rightPadPx >= parentWidth) {\n          // Apply max width of parent\n          input.style.width = (parentWidth - rightPadPx).toString() + 'px';\n        } else {\n          // Apply width that wraps input\n          input.style.width = (width + static_min_pad).toString() + 'px';\n        }\n      }, 1);\n    },\n\n    onClickCheck(taskEditableAfterCheck: boolean) {\n      // Save a copy of the user's inputs.\n      this.submittedAnswers = { ...this.userInputs };\n      this.updateAttempt();\n      this.editable = taskEditableAfterCheck;\n    },\n\n    onClickShowSolution() {\n      this.showSolutions = true;\n    },\n\n    onClickTryAgain() {\n      this.resetTask();\n      this.resetBlankWidths();\n    },\n\n    resetTask() {\n      this.showSolutions = false;\n      this.userInputs = {};\n      this.submittedAnswers = null;\n      this.editable = true;\n    },\n\n    resetBlankWidths() {\n      (this.$refs.blanks as HTMLInputElement[]).forEach(\n        (input: HTMLInputElement) => {\n          this.autoGrowTextField(input);\n        }\n      );\n    },\n\n    onBlur() {\n      this.handleFilledBlank();\n    },\n\n    onEnter(event: KeyboardEvent) {\n      this.handleFilledBlank();\n      this.focusNextBlank(event.target as HTMLInputElement);\n    },\n\n    handleFilledBlank() {\n      this.showSolutions = false;\n      if (this.task.autoCorrect) {\n        this.onClickCheck(true);\n      }\n    },\n\n    focusNextBlank(blank: HTMLInputElement) {\n      const blanks = this.$refs.blanks as HTMLInputElement[];\n\n      // Find the index of the current input in the blanks array\n      const currentIndex = blanks.indexOf(blank);\n\n      // Move to the next input if available\n      if (currentIndex !== -1 && currentIndex < blanks.length - 1) {\n        const nextInput = blanks[currentIndex + 1];\n        nextInput.focus();\n      } else {\n        // This is the last blank, jump to the check button if it is there\n        if (this.showCheckButton) {\n          (this.$refs.checkButton as HTMLInputElement).focus();\n        }\n      }\n    },\n\n    onInput(event: Event) {\n      this.autoGrowTextField(event.target as HTMLInputElement);\n    },\n\n    classForInput(blank: FillInTheBlanksElement) {\n      if (!this.submittedAnswers) {\n        return '';\n      }\n\n      if (this.submittedAnswers?.[blank.uuid] != undefined) {\n        if (this.submittedAnswerIsCorrect(blank)) {\n          return 'correct';\n        } else {\n          return 'incorrect';\n        }\n      } else {\n        if (this.task.autoCorrect) {\n          return 'autocorrect';\n        } else {\n          return 'autocorrect incorrect';\n        }\n      }\n    },\n\n    urlForIcon(iconName: string) {\n      return (\n        window.STUDIP.ASSETS_URL + 'images/icons/blue/' + iconName + '.svg'\n      );\n    },\n\n    removePTags(text: string) {\n      // Remove all opening and closing <p> tags\n      return text.replace(/<\\/?p>/g, '');\n    },\n  },\n\n  computed: {\n    splitTemplate(): string[] {\n      const cleanTemplate = this.removePTags(this.task.template);\n\n      // Returns an array where the even indexes are the static text portions,\n      // and the odd indexes are the blanks.\n      return cleanTemplate.split(/\\*([^*]+)\\*/);\n    },\n\n    parsedTemplate(): FillInTheBlanksElement[] {\n      return this.splitTemplate.map((value, index) => {\n        if (index % 2 === 0) {\n          return { type: 'staticText', text: value, uuid: uuidv4() };\n        } else {\n          let splitString = value.split(':');\n          let solutions = splitString[0].split('/');\n          let hint = splitString[1];\n          return {\n            type: 'blank',\n            solutions: solutions,\n            hint: hint,\n            uuid: uuidv4(),\n          };\n        }\n      });\n    },\n\n    blanks(): Blank[] {\n      return this.parsedTemplate.filter(\n        (word) => word.type === 'blank'\n      ) as Blank[];\n    },\n\n    blanksFilled(): number {\n      if (!this.submittedAnswers) {\n        return 0;\n      } else {\n        return Object.keys(this.submittedAnswers).length;\n      }\n    },\n\n    allBlanksAreFilled(): boolean {\n      return this.blanksFilled == this.blanks.length;\n    },\n\n    correctAnswers(): number {\n      return this.blanks.filter((blank) => this.submittedAnswerIsCorrect(blank))\n        .length;\n    },\n\n    allAnswersAreCorrect(): boolean {\n      return this.blanks.every((blank) => this.submittedAnswerIsCorrect(blank));\n    },\n\n    maxPoints(): number {\n      return this.blanks.length;\n    },\n\n    inputHasChanged(): boolean {\n      return !isEqual(this.submittedAnswers, this.userInputs);\n    },\n\n    showExtraButtons(): boolean {\n      if (this.task.autoCorrect) {\n        if (this.allBlanksAreFilled) {\n          return (\n            this.submittedAnswers !== null &&\n            !this.inputHasChanged &&\n            !this.allAnswersAreCorrect\n          );\n        } else {\n          return false;\n        }\n      } else {\n        return (\n          this.submittedAnswers !== null &&\n          !this.inputHasChanged &&\n          !this.allAnswersAreCorrect\n        );\n      }\n    },\n\n    showCheckButton(): boolean {\n      return (\n        (this.submittedAnswers === null || this.inputHasChanged) &&\n        !this.task.autoCorrect\n      );\n    },\n\n    showSolutionButton(): boolean {\n      return (\n        this.task.showSolutionsAllowed &&\n        this.showResults &&\n        !this.showSolutions\n      );\n    },\n\n    showRetryButton(): boolean {\n      return this.task.retryAllowed && this.submittedAnswers !== null;\n    },\n\n    showFillInAllTheBlanksMessage(): boolean {\n      return (\n        this.task.allBlanksMustBeFilledForSolutions &&\n        this.showSolutions &&\n        !this.allBlanksAreFilled &&\n        !this.inputHasChanged\n      );\n    },\n\n    showResults(): boolean {\n      return (\n        !(this.submittedAnswers === null) &&\n        !this.showFillInAllTheBlanksMessage &&\n        (!this.task.autoCorrect || this.allBlanksAreFilled) &&\n        !this.inputHasChanged\n      );\n    },\n\n    resultMessage(): string {\n      let resultMessage = this.task.strings.resultMessage.replace(\n        ':correct',\n        this.correctAnswers.toString()\n      );\n\n      resultMessage = resultMessage.replace(\n        ':total',\n        this.blanks.length.toString()\n      );\n\n      return resultMessage;\n    },\n\n    feedbackSortedByScore(): Feedback[] {\n      return this.task.feedback\n        .map((value) => value)\n        .sort((a, b) => b.percentage - a.percentage);\n    },\n\n    fillInAllTheBlanksMessage(): string {\n      return this.task.strings.fillInAllBlanksMessage\n        ? this.task.strings.fillInAllBlanksMessage\n        : $gettext(\n            'Alle Lcken mssen ausgefllt sein, um Lsungen anzuzeigen'\n          );\n    },\n  },\n});\n</script>\n\n<style scoped>\ninput[type='text'] {\n  height: 1em;\n}\n\n.fill-in-the-blanks-text {\n  word-break: break-word;\n}\n\n.correct {\n  background: #9dd8bb;\n  border: 1px solid #9dd8bb;\n  color: #255c41;\n}\n\n.incorrect {\n  background-color: #f7d0d0;\n  border: 1px solid #f7d0d0;\n  color: #b71c1c;\n  text-decoration: line-through;\n}\n\n.blank {\n  border-radius: 0.25em;\n  border: 1px solid #a0a0a0;\n  /* top, right, bottom, left */\n  padding: 0.1875em 0 0.1875em 0.5em;\n  text-overflow: ellipsis;\n  overflow: hidden;\n  white-space: nowrap;\n  /* Calculated to be the minPx number spit out by autoGrowTextField */\n  width: 104px;\n}\n\n.blank.autocorrect:focus {\n  background: unset;\n  color: unset;\n  text-decoration: unset;\n  border: 1px solid #a0a0a0;\n}\n</style>\n","import { render } from \"./FillInTheBlanksViewer.vue?vue&type=template&id=991d4d3e&scoped=true&ts=true\"\nimport script from \"./FillInTheBlanksViewer.vue?vue&type=script&lang=ts\"\nexport * from \"./FillInTheBlanksViewer.vue?vue&type=script&lang=ts\"\n\nimport \"./FillInTheBlanksViewer.vue?vue&type=style&index=0&id=991d4d3e&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-991d4d3e\"]])\n\nexport default __exports__","import { toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment } from \"vue\"\n\nconst _hoisted_1 = { key: 0 }\nconst _hoisted_2 = { key: 1 }\nconst _hoisted_3 = [\"accept\"]\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  return (_ctx.uploadRequestPromise)\n    ? (_openBlock(), _createElementBlock(\"span\", _hoisted_1, _toDisplayString(_ctx.$gettext('Datei wird hochgeladen')), 1))\n    : (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n        _createElementVNode(\"input\", {\n          ref: \"fileInput\",\n          type: \"file\",\n          accept: _ctx.accept,\n          onChange: _cache[0] || (_cache[0] = \n//@ts-ignore\n(...args) => (_ctx.onInputChange && _ctx.onInputChange(...args)))\n        }, null, 40, _hoisted_3),\n        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.errors, (error) => {\n          return (_openBlock(), _createElementBlock(\"p\", {\n            class: \"validation-error\",\n            key: error\n          }, _toDisplayString(error), 1))\n        }), 128))\n      ]))\n}","<template>\n  <span v-if=\"uploadRequestPromise\">{{\n    $gettext('Datei wird hochgeladen')\n  }}</span>\n  <div v-else>\n    <input\n      ref=\"fileInput\"\n      type=\"file\"\n      :accept=\"accept\"\n      @change=\"onInputChange\"\n    />\n    <p class=\"validation-error\" v-for=\"error in errors\" :key=\"error\">\n      {{ error }}\n    </p>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from 'vue';\nimport { $gettext } from '@/language/gettext';\nimport { mapActions, mapGetters } from 'vuex';\nimport {\n  createFile,\n  createFolder,\n  getFolders,\n  FileRef,\n  FolderRef,\n} from '@/routes/jsonApi';\n\nexport default defineComponent({\n  name: 'FileUpload',\n  emits: ['fileUploaded'],\n  props: {\n    // The 'accept' property passed to the <input type=\"file\"> element.  Default: 'image/*'\n    accept: {\n      type: String,\n      required: false,\n      default: 'image/*',\n    },\n  },\n  data() {\n    return {\n      // Wenn dieser Promise vorhanden ist, heit das, dass eine HTTP-Anfrage\n      // unterwegs ist.\n      uploadRequestPromise: undefined as Promise<unknown> | undefined,\n      selectedFolderId: undefined as string | undefined,\n      errors: [] as string[],\n      uploadFolderName: 'Lernmodule Uploads',\n    };\n  },\n  async mounted() {\n    const folders = await getFolders({ userId: this.userId });\n\n    const lernmoduleUploads = folders.find(\n      (f) => f.attributes.name === this.uploadFolderName\n    );\n\n    if (lernmoduleUploads) {\n      console.log('Found', this.uploadFolderName, 'folder.');\n      this.selectedFolderId = lernmoduleUploads.id;\n    } else {\n      console.log(\n        'Folder',\n        this.uploadFolderName,\n        \"not found. Trying to create it under the user's root folder.\"\n      );\n      try {\n        const rootFolder = folders.find(\n          (f) => f.attributes['folder-type'] === 'RootFolder'\n        );\n\n        if (!rootFolder) {\n          const errorMessage = $gettext(\n            'Das Stammverzeichnis des Benutzers konnte nicht gefunden werden. ' +\n              'Es knnen keine Dateien hochgeladen werden.'\n          );\n          this.errors.push(errorMessage);\n          console.error(errorMessage);\n          return;\n        }\n\n        if (rootFolder) {\n          console.log(\n            'Found user root folder',\n            rootFolder.attributes.name,\n            '(' + rootFolder.attributes['folder-type'] + ')'\n          );\n        }\n\n        const newFolder = await createFolder({\n          userId: this.userId,\n          name: this.uploadFolderName,\n          parentFolderId: rootFolder.id, // Use the root folder ID\n          folderType: 'PublicFolder',\n        });\n\n        if (newFolder) {\n          console.log(\n            'Created folder',\n            newFolder.attributes.name,\n            'in folder',\n            rootFolder.attributes.name\n          );\n        }\n\n        this.selectedFolderId = newFolder.id;\n      } catch (error) {\n        const errorMessage = $gettext(\n          'Das Verzeichnis' +\n            this.uploadFolderName +\n            'konnte nicht erstellt werden. ' +\n            'Es knnen keine Dateien hochgeladen werden.'\n        );\n        this.errors.push(errorMessage);\n        console.error(errorMessage, error);\n      }\n    }\n  },\n  computed: {\n    ...mapGetters({\n      relatedFolders: 'folders/related',\n    }),\n    userId(): string {\n      // Replaces the vuex getter 'userId'\n      return window.STUDIP.USER_ID;\n    },\n    userObject() {\n      return { type: 'users', id: `${this.userId}` };\n    },\n    loadedUserFolders() {\n      let loadedUserFolders: FolderRef[] = [];\n      let userFolders: FolderRef[] =\n        this.relatedFolders({\n          parent: this.userObject,\n          relationship: 'folders',\n        }) ?? [];\n      userFolders.forEach((folder: FolderRef) => {\n        if (folder.attributes['folder-type'] === 'PublicFolder') {\n          loadedUserFolders.push(folder);\n        }\n      });\n\n      return loadedUserFolders;\n    },\n  },\n  methods: {\n    $gettext,\n    ...mapActions({\n      _loadRelatedFolders: 'folders/loadRelated',\n    }),\n    // Typed shim for vuex action 'folders/loadRelated'\n    loadRelatedFolders(params: {\n      parent: {\n        type: string;\n        id: string;\n      };\n      relationship: string;\n      options: {\n        'page[limit]': number;\n      };\n    }): Promise<unknown> {\n      return this._loadRelatedFolders(params);\n    },\n    async getUserFolders() {\n      const parent = this.userObject;\n      const relationship = 'folders';\n      const options = { 'page[limit]': 10000 };\n      return await this.loadRelatedFolders({ parent, relationship, options });\n    },\n    onInputChange(event: Event): void {\n      if (this.uploadRequestPromise) {\n        console.warn(\n          'FileUpload: onInputChange fired while uploadRequestPromise is already defined.'\n        );\n        return;\n      }\n      const input = this.$refs.fileInput as HTMLInputElement;\n      const file = input.files?.item(0);\n      if (!file) {\n        console.warn(\n          'FileUpload: onInputChange fired, but input.files[] is empty.'\n        );\n        return;\n      }\n      if (!this.selectedFolderId) {\n        const error = $gettext(\n          'Kein Ordner ist ausgewhlt. Die Datei kann nicht hochgeladen werden.'\n        );\n        console.error(error);\n        this.errors.push(error);\n        return;\n      }\n      this.errors = [];\n      this.uploadRequestPromise = createFile({\n        file: {\n          attributes: {\n            name: file.name,\n          },\n        },\n        fileData: file,\n        folder: { id: this.selectedFolderId },\n      })\n        .then((fileRef: FileRef) => {\n          this.$emit('fileUploaded', fileRef);\n          this.uploadRequestPromise = undefined;\n          this.errors = [];\n        })\n        .catch((error) => {\n          /*\n           TODO #23 Check for common errors and translate them so they are\n             understandable for users. E.g. AxiosError 413 (File too large).\n          */\n          console.error(error);\n          this.errors.push(error);\n          this.uploadRequestPromise = undefined;\n        });\n    },\n  },\n});\n</script>\n\n<style scoped></style>\n","import { render } from \"./FileUpload.vue?vue&type=template&id=234bd1d4&ts=true\"\nimport script from \"./FileUpload.vue?vue&type=script&lang=ts\"\nexport * from \"./FileUpload.vue?vue&type=script&lang=ts\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { InjectionKey, Ref } from 'vue';\nimport { Hotspot } from '@/models/FindTheHotspotsTask';\n\n/**\n * In the Find The Hotspots Editor, we use provide/inject to pass data to many\n * different components at once without prop drilling.\n * There is a little bit of ceremony required to have the passed data be statically typed.\n * https://vuejs.org/guide/typescript/composition-api.html#typing-provide-inject\n */\nexport const findTheHotspotsEditorStateSymbol = Symbol(\n  'Find The Hotspots Editor state'\n) as InjectionKey<FindTheHotspotsEditorState>;\n\nexport interface FindTheHotspotsEditorState {\n  // Some of this stuff was copied over from interactiveVideoEditorState.\n  // We will adapt it together to work for Find The Hotspots.\n  selectedHotspotId: Ref<string | undefined>;\n  selectHotspot(id: string | undefined): void;\n  deleteSelectedHotspot(): void;\n  changeHotspotCorrectness(correct: boolean): void;\n  setHotspotFeedback(feedback: string): void;\n  dragHotspot(\n    dragId: string,\n    hotspotId: string,\n    xFraction: number,\n    yFraction: number\n  ): void;\n  resizeHotspot(\n    dragId: string,\n    hotspotId: string,\n    x: number,\n    y: number,\n    width: number,\n    height: number\n  ): void;\n  // editInteraction(id: string): void;\n  // dragInteractionTimeline(id: string, startTime: number): void;\n}\n","import { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, withModifiers as _withModifiers, normalizeClass as _normalizeClass, createCommentVNode as _createCommentVNode, normalizeStyle as _normalizeStyle, resolveComponent as _resolveComponent, createVNode as _createVNode, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-4179f505\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = {\n  class: \"image-and-hotspots-container\",\n  ref: \"root\"\n}\nconst _hoisted_2 = [\"id\", \"onClick\", \"onPointerdown\", \"onPointermove\", \"onPointerup\"]\nconst _hoisted_3 = [\"onPointerdown\", \"onPointermove\", \"onPointerup\"]\nconst _hoisted_4 = {\n  key: 0,\n  style: { flexBasis: '50%', flexGrow: 0, flexShrink: 0 }\n}\nconst _hoisted_5 = {\n  key: 1,\n  style: { flexBasis: '50%', flexGrow: 0, flexShrink: 0 }\n}\nconst _hoisted_6 = { style: {\"display\":\"flex\",\"margin-bottom\":\"0\",\"align-items\":\"flex-start\"} }\nconst _hoisted_7 = { style: {\"display\":\"flex\",\"margin-bottom\":\"0\",\"align-items\":\"center\"} }\nconst _hoisted_8 = [\"checked\"]\nconst _hoisted_9 = [\"title\"]\nconst _hoisted_10 = [\"value\", \"title\"]\nconst _hoisted_11 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"arrow\",\n  \"data-popper-arrow\": \"\"\n}, null, -1))\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_LazyImage = _resolveComponent(\"LazyImage\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", {\n    class: _normalizeClass([\"image-and-hotspots-container-wrapper\", {\n      debug: _ctx.debug,\n    }]),\n    ref: \"wrapper\"\n  }, [\n    _createElementVNode(\"div\", _hoisted_1, [\n      (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.hotspots, (hotspot) => {\n        return (_openBlock(), _createElementBlock(\"button\", {\n          key: hotspot.uuid,\n          type: \"button\",\n          class: _normalizeClass([\"hotspot\", {\n          'invisible-hotspot': !_ctx.editor,\n          selected: _ctx.editor?.selectedHotspotId.value === hotspot.uuid,\n        }]),\n          id: `hotspot-${_ctx.uid}-${hotspot.uuid}`,\n          style: _normalizeStyle(_ctx.getHotspotStyle(hotspot)),\n          onClick: ($event: any) => (_ctx.onClickHotspot($event, hotspot)),\n          onPointerdown: ($event: any) => (_ctx.onPointerdownHotspot($event, hotspot)),\n          onPointermove: ($event: any) => (_ctx.onPointermoveHotspot($event, hotspot)),\n          onPointerup: ($event: any) => (_ctx.onPointerupHotspot($event, hotspot))\n        }, [\n          (_ctx.editor)\n            ? (_openBlock(true), _createElementBlock(_Fragment, { key: 0 }, _renderList(_ctx.resizeHandles, (handle) => {\n                return (_openBlock(), _createElementBlock(\"div\", {\n                  key: handle,\n                  class: _normalizeClass([\"resize-handle\", handle]),\n                  onPointerdown: _withModifiers(($event: any) => (\n              _ctx.onPointerdownResizeHandle($event, handle, hotspot)\n            ), [\"stop\"]),\n                  onPointermove: _withModifiers(($event: any) => (\n              _ctx.onPointermoveResizeHandle($event, handle, hotspot)\n            ), [\"stop\"]),\n                  onPointerup: _withModifiers(($event: any) => (_ctx.onPointerupResizeHandle($event, handle, hotspot)), [\"stop\"])\n                }, null, 42, _hoisted_3))\n              }), 128))\n            : _createCommentVNode(\"\", true)\n        ], 46, _hoisted_2))\n      }), 128)),\n      _createVNode(_component_LazyImage, {\n        src: _ctx.fileIdToUrl(_ctx.image.file_id),\n        alt: _ctx.image.altText,\n        onClick: _ctx.onClickBackground,\n        class: \"hotspots-image\"\n      }, null, 8, [\"src\", \"alt\", \"onClick\"])\n    ], 512),\n    (_ctx.debug && _ctx.editor)\n      ? (_openBlock(), _createElementBlock(\"pre\", _hoisted_4, _toDisplayString({ selectedHotspot: _ctx.selectedHotspot, dragState: _ctx.dragState }), 1))\n      : _createCommentVNode(\"\", true),\n    (_ctx.debug && _ctx.viewer)\n      ? (_openBlock(), _createElementBlock(\"pre\", _hoisted_5, _toDisplayString({ selectedHotspot: _ctx.selectedHotspot, dragState: _ctx.dragState }), 1))\n      : _createCommentVNode(\"\", true),\n    (_ctx.editor)\n      ? (_openBlock(), _createElementBlock(\"div\", {\n          key: 2,\n          ref: \"selectedHotspotTooltip\",\n          class: _normalizeClass([\"selected-hotspot-tooltip\", {\n        hidden: !_ctx.selectedHotspot,\n      }])\n        }, [\n          _createElementVNode(\"div\", _hoisted_6, [\n            _createElementVNode(\"label\", _hoisted_7, [\n              _createElementVNode(\"input\", {\n                checked: _ctx.selectedHotspot?.correct,\n                type: \"checkbox\",\n                onChange: _cache[0] || (_cache[0] = ($event: any) => (_ctx.editor!.changeHotspotCorrectness($event.target.checked)))\n              }, null, 40, _hoisted_8),\n              _createTextVNode(\" \" + _toDisplayString(_ctx.$gettext('Korrekt')), 1)\n            ]),\n            _createElementVNode(\"button\", {\n              type: \"button\",\n              class: \"small-button trash\",\n              style: {\"margin-left\":\"auto\"},\n              onClick: _cache[1] || (_cache[1] = ($event: any) => (_ctx.editor!.deleteSelectedHotspot())),\n              title: _ctx.$gettext('Diesen Hotspot lschen')\n            }, null, 8, _hoisted_9)\n          ]),\n          _createElementVNode(\"label\", null, [\n            _createTextVNode(_toDisplayString(_ctx.$gettext('Feedback:')) + \" \", 1),\n            _createElementVNode(\"input\", {\n              value: (_ctx.selectedHotspot as Hotspot)?.feedback,\n              onInput: _cache[2] || (_cache[2] = ($event: any) => (_ctx.editor!.setHotspotFeedback($event.target.value))),\n              type: \"text\",\n              title: _ctx.$gettext('Feedback bei Klick auf diesen Hotspot')\n            }, null, 40, _hoisted_10)\n          ]),\n          _hoisted_11\n        ], 2))\n      : _createCommentVNode(\"\", true)\n  ], 2))\n}","<template>\n  <div\n    class=\"image-and-hotspots-container-wrapper\"\n    :class=\"{\n      debug: debug,\n    }\"\n    ref=\"wrapper\"\n  >\n    <div class=\"image-and-hotspots-container\" ref=\"root\">\n      <!--  In the editor, hotspots are visible. In the viewer, they should be\n      invisible. We can tell whether we are in the editor or the viewer based\n      on whether the value of the injected field 'editor' is defined. -->\n      <button\n        v-for=\"hotspot in hotspots\"\n        :key=\"hotspot.uuid\"\n        type=\"button\"\n        class=\"hotspot\"\n        :class=\"{\n          'invisible-hotspot': !editor,\n          selected: editor?.selectedHotspotId.value === hotspot.uuid,\n        }\"\n        :id=\"`hotspot-${uid}-${hotspot.uuid}`\"\n        :style=\"getHotspotStyle(hotspot)\"\n        @click=\"onClickHotspot($event, hotspot)\"\n        @pointerdown=\"onPointerdownHotspot($event, hotspot)\"\n        @pointermove=\"onPointermoveHotspot($event, hotspot)\"\n        @pointerup=\"onPointerupHotspot($event, hotspot)\"\n      >\n        <template v-if=\"editor\">\n          <div\n            v-for=\"handle in resizeHandles\"\n            :key=\"handle\"\n            class=\"resize-handle\"\n            :class=\"handle\"\n            @pointerdown.stop=\"\n              onPointerdownResizeHandle($event, handle, hotspot)\n            \"\n            @pointermove.stop=\"\n              onPointermoveResizeHandle($event, handle, hotspot)\n            \"\n            @pointerup.stop=\"onPointerupResizeHandle($event, handle, hotspot)\"\n          />\n        </template>\n      </button>\n      <LazyImage\n        :src=\"fileIdToUrl(image.file_id)\"\n        :alt=\"image.altText\"\n        @click=\"onClickBackground\"\n        class=\"hotspots-image\"\n      />\n    </div>\n    <pre\n      v-if=\"debug && editor\"\n      :style=\"{ flexBasis: '50%', flexGrow: 0, flexShrink: 0 }\"\n      >{{ { selectedHotspot, dragState } }}</pre\n    >\n    <pre\n      v-if=\"debug && viewer\"\n      :style=\"{ flexBasis: '50%', flexGrow: 0, flexShrink: 0 }\"\n      >{{ { selectedHotspot, dragState } }}</pre\n    >\n    <div\n      ref=\"selectedHotspotTooltip\"\n      v-if=\"editor\"\n      class=\"selected-hotspot-tooltip\"\n      :class=\"{\n        hidden: !selectedHotspot,\n      }\"\n    >\n      <div style=\"display: flex; margin-bottom: 0; align-items: flex-start\">\n        <label style=\"display: flex; margin-bottom: 0; align-items: center\">\n          <input\n            :checked=\"selectedHotspot?.correct\"\n            type=\"checkbox\"\n            @change=\"editor!.changeHotspotCorrectness($event.target.checked)\"\n          />\n          {{ $gettext('Korrekt') }}\n        </label>\n        <button\n          type=\"button\"\n          class=\"small-button trash\"\n          style=\"margin-left: auto\"\n          @click=\"editor!.deleteSelectedHotspot()\"\n          :title=\"$gettext('Diesen Hotspot lschen')\"\n        />\n      </div>\n      <label>\n        {{ $gettext('Feedback:') }}\n        <input\n          :value=\"(selectedHotspot as Hotspot)?.feedback\"\n          @input=\"editor!.setHotspotFeedback($event.target.value)\"\n          type=\"text\"\n          :title=\"$gettext('Feedback bei Klick auf diesen Hotspot')\"\n        />\n      </label>\n      <div class=\"arrow\" data-popper-arrow></div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, inject, PropType } from 'vue';\nimport LazyImage from '@/components/LazyImage.vue';\nimport { Hotspot } from '@/models/FindTheHotspotsTask';\nimport { fileIdToUrl } from '@/models/TaskDefinition';\nimport { ImageFileElement } from '@/models/common';\nimport {\n  FindTheHotspotsEditorState,\n  findTheHotspotsEditorStateSymbol,\n} from '@/components/findTheHotspots/findTheHotspotsEditorState';\nimport {\n  FindTheHotspotsViewerState,\n  findTheHotspotsViewerStateSymbol,\n} from '@/components/findTheHotspots/findTheHotspotsViewerState';\nimport { createPopper, Instance } from '@popperjs/core';\nimport { v4 } from 'uuid';\nimport { ResizeHandle } from '@/models/InteractiveVideoTask';\nimport { $gettext } from '@/language/gettext';\n\ntype DragState =\n  | {\n      type: 'dragHotspot';\n      dragId: string;\n      hotspotId: string;\n      pointerStartPos: [number, number]; // clientX, clientY\n      hotspotStartPos: [number, number]; // fraction x, fraction y\n    }\n  | {\n      type: 'resizeHotspot';\n      dragId: string;\n      hotspotId: string;\n      pointerStartPos: [number, number]; // clientX, clientY\n      hotspotStartPos: [number, number]; // fraction x, fraction y\n      hotspotStartSize: [number, number]; // fraction x, fraction y\n      handle: string;\n    }\n  | undefined;\n\nexport default defineComponent({\n  name: 'ImageWithHotspots',\n  components: { LazyImage },\n  setup() {\n    return {\n      editor: inject<FindTheHotspotsEditorState | undefined>(\n        findTheHotspotsEditorStateSymbol,\n        // Supply a default value to suppress the vue warning about missing\n        // injection in the viewer:\n        // [Vue warn]: injection \"Symbol(Find The Hotspots Editor state)\" not found.\n        undefined\n      ),\n      viewer: inject<FindTheHotspotsViewerState | undefined>(\n        findTheHotspotsViewerStateSymbol,\n        // Supply a default value to suppress the vue warning about missing\n        // injection in the viewer:\n        // [Vue warn]: injection \"Symbol(Find The Hotspots Viewer state)\" not found.\n        undefined\n      ),\n    };\n  },\n  props: {\n    hotspots: {\n      type: Object as PropType<Hotspot[]>,\n      required: true,\n    },\n    image: {\n      type: Object as PropType<ImageFileElement>,\n      required: true,\n    },\n  },\n  data() {\n    return {\n      popperInstance: undefined as Instance | undefined,\n      dragState: undefined as DragState,\n    };\n  },\n  computed: {\n    debug(): boolean {\n      return window.STUDIP.LernmoduleVueJS.LERNMODULE_DEBUG && false;\n    },\n    // A unique ID for this instance of ImageWithHotspots, so that we can refer\n    // to elements inside of it by ID when there are multiple instances\n    // (e.g. viewer and editor) on the same page.\n    uid(): string {\n      return v4();\n    },\n    selectedHotspot(): Hotspot | undefined {\n      return this.hotspots.find(\n        (h) => h.uuid === this.editor?.selectedHotspotId.value\n      );\n    },\n    resizeHandles() {\n      return [\n        'left',\n        'top-left',\n        'top',\n        'top-right',\n        'right',\n        'bottom-right',\n        'bottom',\n        'bottom-left',\n      ] as const;\n    },\n  },\n  watch: {\n    selectedHotspot: {\n      immediate: true,\n      handler: function (hotspot: Hotspot | undefined) {\n        this.popperInstance?.destroy();\n        if (hotspot) {\n          // Run on next tick, because we need to wait for the hotspotElement\n          // to be rendered by Vue, in case it isn't yet visible at the moment this\n          // watcher is triggered.\n          // For example, if the user deletes the currently selected hotspot\n          // and then clicks undo, the hotspotElement will not be visible until\n          // the next reactivity \"tick\" has elapsed.\n          this.$nextTick(() => {\n            const hotspotElement = document.getElementById(\n              `hotspot-${this.uid}-${hotspot.uuid}`\n            ) as HTMLElement;\n            const tooltipElement = this.$refs\n              .selectedHotspotTooltip as HTMLElement;\n            this.popperInstance = createPopper(hotspotElement, tooltipElement, {\n              placement: 'top',\n              modifiers: [\n                {\n                  name: 'offset',\n                  options: {\n                    offset: [0, 14],\n                  },\n                },\n              ],\n            });\n          });\n        }\n      },\n    },\n  },\n  methods: {\n    $gettext,\n    fileIdToUrl,\n    onClickBackground(event: PointerEvent) {\n      if (this.editor) {\n        this.editor?.selectHotspot(undefined);\n      } else if (this.viewer) {\n        // Get the click coordinates relative to the wrapper element\n        const wrapperRect = (\n          this.$refs.wrapper as HTMLElement\n        ).getBoundingClientRect();\n\n        let clickX = event.clientX - wrapperRect.left;\n        let clickY = event.clientY - wrapperRect.top;\n\n        this.viewer.clickBackground(clickX, clickY);\n      }\n    },\n    onClickHotspot(event: PointerEvent, hotspot: Hotspot) {\n      console.log('onClickHotspot', hotspot);\n\n      if (this.editor) {\n        this.editor?.selectHotspot(hotspot.uuid);\n      } else if (this.viewer) {\n        // Get the click coordinates relative to the wrapper element\n        const wrapperRect = (\n          this.$refs.wrapper as HTMLElement\n        ).getBoundingClientRect();\n\n        let clickX = event.clientX - wrapperRect.left;\n        let clickY = event.clientY - wrapperRect.top;\n\n        this.viewer.clickHotspot(hotspot.uuid, clickX, clickY);\n      }\n    },\n    onPointerdownHotspot(event: PointerEvent, hotspot: Hotspot) {\n      console.log('onPointerDownHotspot');\n      if (!this.editor) {\n        return;\n      }\n      this.editor.selectHotspot(hotspot.uuid);\n      this.dragState = {\n        type: 'dragHotspot',\n        hotspotId: hotspot.uuid,\n        dragId: v4(),\n        pointerStartPos: [event.clientX, event.clientY],\n        hotspotStartPos: [hotspot.x, hotspot.y],\n      };\n      (event.target as HTMLElement).setPointerCapture(event.pointerId);\n    },\n    onPointerupHotspot(event: PointerEvent, hotspot: Hotspot) {\n      console.log('onPointerUpHotspot');\n      this.dragState = undefined;\n      (event.target as HTMLElement).releasePointerCapture(event.pointerId);\n    },\n    onPointermoveHotspot(event: PointerEvent, hotspot: Hotspot) {\n      if (\n        this.dragState?.type === 'dragHotspot' &&\n        this.dragState.hotspotId === hotspot.uuid\n      ) {\n        const rootRect = (\n          this.$refs.root as HTMLElement\n        ).getBoundingClientRect();\n        const hotspotEl = event.currentTarget as HTMLElement;\n\n        const clientDx = event.clientX - this.dragState.pointerStartPos[0];\n        const dxFraction = clientDx / rootRect.width;\n        const xFraction = this.dragState.hotspotStartPos[0] + dxFraction;\n        const hotspotWidth = hotspotEl.clientWidth / rootRect.width;\n        const minX = 0.05 - hotspotWidth;\n        const maxX = 0.95;\n        const clampedXFraction = Math.min(maxX, Math.max(minX, xFraction));\n\n        const clientDy = event.clientY - this.dragState.pointerStartPos[1];\n        const dyFraction = clientDy / rootRect.height;\n        const yFraction = this.dragState.hotspotStartPos[1] + dyFraction;\n        const hotspotHeight = hotspotEl.clientHeight / rootRect.height;\n        const minY = 0.05 - hotspotHeight;\n        const maxY = 0.95;\n        const clampedYFraction = Math.min(maxY, Math.max(minY, yFraction));\n\n        const id = this.dragState.hotspotId;\n        this.editor?.dragHotspot(\n          this.dragState.dragId,\n          id,\n          clampedXFraction,\n          clampedYFraction\n        );\n        this.popperInstance?.update();\n      }\n    },\n    onPointerdownResizeHandle(\n      event: PointerEvent,\n      handle: ResizeHandle,\n      hotspot: Hotspot\n    ) {\n      console.log('onPointerDownResizeHandle');\n      if (!this.editor) {\n        return;\n      }\n      this.editor.selectHotspot(hotspot.uuid);\n      this.dragState = {\n        type: 'resizeHotspot',\n        dragId: v4(),\n        hotspotId: hotspot.uuid,\n        pointerStartPos: [event.clientX, event.clientY],\n        hotspotStartPos: [hotspot.x, hotspot.y],\n        hotspotStartSize: [hotspot.width, hotspot.height],\n        handle,\n      };\n      (event.target as HTMLElement).setPointerCapture(event.pointerId);\n    },\n    onPointerupResizeHandle(\n      event: PointerEvent,\n      handle: ResizeHandle,\n      hotspot: Hotspot\n    ) {\n      console.log('onPointerUpResizeHandle');\n      this.dragState = undefined;\n      (event.target as HTMLElement).releasePointerCapture(event.pointerId);\n    },\n    onPointermoveResizeHandle(\n      event: PointerEvent,\n      handle: ResizeHandle,\n      hotspot: Hotspot\n    ) {\n      if (\n        this.dragState?.type === 'resizeHotspot' &&\n        this.dragState.hotspotId === hotspot.uuid\n      ) {\n        const rootRect = (\n          this.$refs.root as HTMLElement\n        ).getBoundingClientRect();\n        const {\n          hotspotStartPos: [xInitial, yInitial],\n          hotspotStartSize: [widthInitial, heightInitial],\n        } = this.dragState;\n        let newX = xInitial;\n        let newWidth = widthInitial;\n        let newY = yInitial;\n        let newHeight = heightInitial;\n\n        // Convert pointer movement in pixels to fractions of root rect width/height\n        const dxPointerPixels =\n          event.clientX - this.dragState.pointerStartPos[0];\n        const dxPointer = dxPointerPixels / rootRect.width;\n\n        const dyPointerPixels =\n          event.clientY - this.dragState.pointerStartPos[1];\n        const dyPointer = dyPointerPixels / rootRect.height;\n\n        // Horizontal resizing\n        if (\n          handle === 'left' ||\n          handle === 'top-left' ||\n          handle === 'bottom-left'\n        ) {\n          if (dxPointer > widthInitial) {\n            newX = xInitial + widthInitial;\n            newWidth = dxPointer - widthInitial;\n          } else {\n            newX = xInitial + dxPointer;\n            newWidth = widthInitial - dxPointer;\n          }\n        } else if (\n          handle === 'right' ||\n          handle === 'top-right' ||\n          handle === 'bottom-right'\n        ) {\n          if (-dxPointer > widthInitial) {\n            newX = xInitial + widthInitial + dxPointer;\n            newWidth = -dxPointer - widthInitial;\n          } else {\n            newX = xInitial;\n            newWidth = widthInitial + dxPointer;\n          }\n        }\n\n        // Vertical resizing\n        if (\n          handle === 'top-left' ||\n          handle === 'top' ||\n          handle === 'top-right'\n        ) {\n          if (dyPointer > heightInitial) {\n            newY = yInitial + heightInitial;\n            newHeight = dyPointer - heightInitial;\n          } else {\n            newY = yInitial + dyPointer;\n            newHeight = heightInitial - dyPointer;\n          }\n        } else if (\n          handle === 'bottom-left' ||\n          handle === 'bottom' ||\n          handle === 'bottom-right'\n        ) {\n          if (-dyPointer > heightInitial) {\n            newY = yInitial + heightInitial + dyPointer;\n            newHeight = -dyPointer - heightInitial;\n          } else {\n            newY = yInitial;\n            newHeight = heightInitial + dyPointer;\n          }\n        }\n\n        // Prevent shrinking the hotspot below a minimum size\n        let filteredHeight = hotspot.height,\n          filteredWidth = hotspot.width,\n          filteredX = hotspot.x,\n          filteredY = hotspot.y;\n        const newHeightPixels = newHeight * rootRect.height;\n        const newWidthPixels = newWidth * rootRect.width;\n        const minPixelDimension = 20;\n        if (newHeightPixels > minPixelDimension) {\n          filteredHeight = newHeight;\n          filteredY = newY;\n        }\n        if (newWidthPixels > minPixelDimension) {\n          filteredWidth = newWidth;\n          filteredX = newX;\n        }\n\n        // Prevent moving the hotspot completely off screen\n        const isOffscreenX =\n          filteredX > 0.95 || filteredX + filteredWidth < 0.05;\n        const isOffscreenY =\n          filteredY > 0.95 || filteredY + filteredHeight < 0.05;\n        if (isOffscreenX) {\n          filteredX = hotspot.x;\n          filteredWidth = hotspot.width;\n        }\n        if (isOffscreenY) {\n          filteredY = hotspot.y;\n          filteredHeight = hotspot.height;\n        }\n\n        this.editor!.resizeHotspot(\n          this.dragState.dragId,\n          hotspot.uuid,\n          filteredX,\n          filteredY,\n          filteredWidth,\n          filteredHeight\n        );\n        this.popperInstance?.update();\n      }\n    },\n    getHotspotStyle(hotspot: Hotspot): Partial<CSSStyleDeclaration> {\n      if (hotspot.type === 'rectangle') {\n        return {\n          left: `${hotspot.x * 100}%`,\n          top: `${hotspot.y * 100}%`,\n          width: `${hotspot.width * 100}%`,\n          height: `${hotspot.height * 100}%`,\n        };\n      } else {\n        return {\n          left: `${hotspot.x * 100}%`,\n          top: `${hotspot.y * 100}%`,\n          width: `${hotspot.width * 100}%`,\n          height: `${hotspot.height * 100}%`,\n          borderRadius: '50%',\n        };\n      }\n    },\n  },\n});\n</script>\n\n<style scoped lang=\"scss\">\n.image-and-hotspots-container-wrapper {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n\n  &.debug {\n    align-items: flex-start;\n    justify-content: flex-start;\n  }\n}\n\n.image-and-hotspots-container {\n  display: flex;\n  position: relative;\n  overflow: hidden;\n  max-height: 400px;\n}\n\n.hotspots-image {\n  user-select: none;\n  max-height: 400px;\n  width: 100%;\n}\n\n$hotspotBorderWidth: 2px;\n\nbutton.hotspot {\n  /* CSS Reset for button styles */\n  padding: 0;\n  //border: none;\n  font: inherit;\n  color: inherit;\n  //background-color: transparent;\n  cursor: pointer;\n  box-sizing: border-box;\n\n  position: absolute;\n  border: $hotspotBorderWidth dashed rgba(0, 0, 0, 0.7);\n  background-color: rgba(255, 255, 255, 0.5);\n\n  // This class isn't called 'invisible' or 'hidden', because there are Stud.IP\n  // CSS classes with those names that set display: none;\n  &.invisible-hotspot {\n    opacity: 0;\n    cursor: unset;\n    border: unset;\n    background: unset;\n    // Ensure that keyboard-only users are able to see the hotspot, if any,\n    // that they have focused with the keyboard.  (Accessibility standards)\n    &:focus {\n      opacity: unset;\n    }\n\n    &.correct {\n      color: #255c41;\n      background-image: radial-gradient(\n        circle at center,\n        rgba(157, 216, 187, 0.3) 0,\n        transparent 80%\n      );\n      background-size: 100% 100%;\n      background-position: center;\n    }\n\n    &.incorrect {\n      color: #b71c1c;\n      background-image: radial-gradient(\n        circle at center,\n        rgba(247, 208, 208, 0.3) 0,\n        transparent 80%\n      );\n      background-size: 100% 100%;\n      background-position: center;\n    }\n  }\n\n  &.selected {\n    border-color: #0a78d1;\n  }\n\n  &.selected .resize-handle {\n    $size: 12px;\n    position: absolute;\n    background: white;\n    border: 1px solid #0a78d1;\n    width: $size;\n    height: $size;\n    box-sizing: border-box;\n\n    &.top-left {\n      cursor: nwse-resize;\n      top: calc(0% - $size / 2 - $hotspotBorderWidth / 2);\n      left: calc(0% - $size / 2 - $hotspotBorderWidth / 2);\n    }\n\n    &.top {\n      cursor: ns-resize;\n      top: calc(0% - $size / 2 - $hotspotBorderWidth / 2);\n      left: calc(50% - $size / 2);\n    }\n\n    &.top-right {\n      cursor: nesw-resize;\n      top: calc(0% - $size / 2 - $hotspotBorderWidth / 2);\n      right: calc(0% - $size / 2 - $hotspotBorderWidth / 2);\n    }\n\n    &.right {\n      cursor: ew-resize;\n      top: calc(50% - $size / 2);\n      right: calc(0% - $size / 2 - $hotspotBorderWidth / 2);\n    }\n\n    &.bottom-right {\n      cursor: nwse-resize;\n      bottom: calc(0% - $size / 2 - $hotspotBorderWidth / 2);\n      right: calc(0% - $size / 2 - $hotspotBorderWidth / 2);\n    }\n\n    &.bottom {\n      cursor: ns-resize;\n      bottom: calc(0% - $size / 2 - $hotspotBorderWidth / 2);\n      left: calc(50% - $size / 2);\n    }\n\n    &.bottom-left {\n      cursor: nesw-resize;\n      bottom: calc(0% - $size / 2 - $hotspotBorderWidth / 2);\n      left: calc(0% - $size / 2 - $hotspotBorderWidth / 2);\n    }\n\n    &.left {\n      cursor: ew-resize;\n      top: calc(50% - $size / 2);\n      left: calc(0% - $size / 2 - $hotspotBorderWidth / 2);\n    }\n  }\n}\n\n.selected-hotspot-tooltip {\n  &.hidden {\n    display: none;\n  }\n  position: absolute;\n  display: flex;\n  flex-direction: column;\n  gap: 0.5em;\n  background: white;\n  color: black;\n  border-radius: 12px;\n  border: #0a78d1 2px solid;\n  padding: 8px;\n  > .arrow,\n  > .arrow::before {\n    position: absolute;\n    width: 8px;\n    height: 8px;\n    background: inherit;\n  }\n\n  > .arrow {\n    visibility: hidden;\n  }\n\n  > .arrow::before {\n    visibility: visible;\n    content: '';\n    transform: translateX(-$hotspotBorderWidth) rotate(45deg);\n  }\n\n  &[data-popper-placement^='top'] > .arrow {\n    bottom: -5px;\n  }\n\n  &[data-popper-placement^='bottom'] > .arrow {\n    top: -7px;\n  }\n\n  &[data-popper-placement^='left'] > .arrow {\n    right: -4px;\n  }\n\n  &[data-popper-placement^='right'] > .arrow {\n    left: -4px;\n  }\n\n  &[data-popper-placement^='top'] > .arrow:before {\n    border-bottom: #0a78d1 2px solid;\n    border-right: #0a78d1 2px solid;\n  }\n\n  &[data-popper-placement^='bottom'] > .arrow:before {\n    border-top: #0a78d1 2px solid;\n    border-left: #0a78d1 2px solid;\n  }\n}\n</style>\n","import { mergeProps as _mergeProps, resolveDirective as _resolveDirective, withDirectives as _withDirectives, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-35ea3852\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = [\"src\", \"alt\"]\nconst _hoisted_2 = {\n  key: 1,\n  class: \"placeholder\"\n}\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _directive_disable_drag = _resolveDirective(\"disable-drag\")!\n\n  return (_ctx.isLoaded)\n    ? _withDirectives((_openBlock(), _createElementBlock(\"img\", _mergeProps({\n        key: 0,\n        src: _ctx.src,\n        alt: _ctx.alt,\n        onLoad: _cache[0] || (_cache[0] = \n//@ts-ignore\n(...args) => (_ctx.onLoad && _ctx.onLoad(...args))),\n        onError: _cache[1] || (_cache[1] = \n//@ts-ignore\n(...args) => (_ctx.onError && _ctx.onError(...args))),\n        class: \"lazy-image\"\n      }, _ctx.$attrs), null, 16, _hoisted_1)), [\n        [_directive_disable_drag]\n      ])\n    : (_openBlock(), _createElementBlock(\"span\", _hoisted_2))\n}","<template>\n  <img\n    v-if=\"isLoaded\"\n    :src=\"src\"\n    :alt=\"alt\"\n    @load=\"onLoad\"\n    @error=\"onError\"\n    class=\"lazy-image\"\n    v-bind=\"$attrs\"\n    v-disable-drag\n  />\n  <span v-else class=\"placeholder\" />\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from 'vue';\nimport { requestQueueStore } from '@/store';\n\nexport default defineComponent({\n  name: 'LazyImage',\n\n  props: {\n    src: { type: String, required: true },\n    alt: { type: String, default: '' },\n  },\n  watch: {\n    src: function () {\n      // Here we load the image unconditionally when 'src' changes.\n      // You could try to use the observer to ensure that it is only loaded\n      // when the image intersects the viewport.\n      // But because this watcher will only run in the editor, I consider it\n      // unlikely that there will be issues loading the image unconditionally\n      // in the watcher.\n      this.enqueueImageLoad();\n    },\n  },\n  data() {\n    return {\n      isLoaded: false, // Tracks if the image has been successfully loaded\n    };\n  },\n  methods: {\n    onLoad() {\n      console.log(`Image loaded: ${this.src}`);\n    },\n\n    onError() {\n      console.error(`Failed to load image: ${this.src}`);\n    },\n\n    enqueueImageLoad() {\n      requestQueueStore.enqueue(async () => {\n        try {\n          // Simulate an image load request\n          const img = new Image();\n          img.src = this.src;\n\n          await new Promise<void>((resolve, reject) => {\n            img.onload = () => {\n              resolve();\n            };\n            img.onerror = () =>\n              reject(new Error(`Failed to load image: ${this.src}`));\n          });\n\n          this.isLoaded = true;\n        } catch (error) {\n          console.error(error);\n        }\n      });\n    },\n  },\n  computed: {\n    useLazyLoading(): boolean {\n      return window.STUDIP.LernmoduleVueJS.LERNMODULE_LAZYLOADING;\n    },\n  },\n  mounted() {\n    if (!this.useLazyLoading) {\n      // Directly load the image\n      this.enqueueImageLoad();\n      return;\n    } else {\n      // Load image lazily when half a viewport away\n      const halfViewportHeight = `${window.innerHeight / 2}px`; // Calculate half of viewport height\n\n      const observer = new IntersectionObserver(\n        ([entry]) => {\n          if (entry.isIntersecting) {\n            this.enqueueImageLoad();\n            observer.unobserve(entry.target); // Stop observing\n            observer.disconnect(); // Clean up the observer\n          }\n        },\n        {\n          rootMargin: halfViewportHeight, // Use half of the viewport height as the margin\n          threshold: 0.01, // Trigger when a small portion intersects\n        }\n      );\n\n      observer.observe(this.$el as HTMLElement);\n    }\n  },\n});\n</script>\n\n<style scoped>\n.lazy-image {\n  box-sizing: border-box;\n  height: 100%;\n  width: 100%;\n  padding: 0;\n  margin: 0;\n  object-fit: contain;\n}\n\n.placeholder {\n  height: 100%;\n  width: 100%;\n  box-shadow: inset 0 2px 74px 0 #cbd5de;\n}\n</style>\n","import { render } from \"./LazyImage.vue?vue&type=template&id=35ea3852&scoped=true&ts=true\"\nimport script from \"./LazyImage.vue?vue&type=script&lang=ts\"\nexport * from \"./LazyImage.vue?vue&type=script&lang=ts\"\n\nimport \"./LazyImage.vue?vue&type=style&index=0&id=35ea3852&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-35ea3852\"]])\n\nexport default __exports__","import { InjectionKey, Ref } from 'vue';\n\n/**\n * In the Find The Hotspots Viewer, we use provide/inject to pass data to many\n * different components at once without prop drilling.\n * There is a little bit of ceremony required to have the passed data be statically typed.\n * https://vuejs.org/guide/typescript/composition-api.html#typing-provide-inject\n */\nexport const findTheHotspotsViewerStateSymbol = Symbol(\n  'Find The Hotspots Viewer state'\n) as InjectionKey<FindTheHotspotsViewerState>;\n\nexport interface FindTheHotspotsViewerState {\n  clickHotspot(id: string | undefined, x: number, y: number): void;\n  clickBackground(x: number, y: number): void;\n}\n","import { render } from \"./ImageWithHotspots.vue?vue&type=template&id=4179f505&scoped=true&ts=true\"\nimport script from \"./ImageWithHotspots.vue?vue&type=script&lang=ts\"\nexport * from \"./ImageWithHotspots.vue?vue&type=script&lang=ts\"\n\nimport \"./ImageWithHotspots.vue?vue&type=style&index=0&id=4179f505&scoped=true&lang=scss\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-4179f505\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { unref as _unref, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createVNode as _createVNode, createCommentVNode as _createCommentVNode, createTextVNode as _createTextVNode, vModelCheckbox as _vModelCheckbox, withDirectives as _withDirectives, vModelText as _vModelText, normalizeClass as _normalizeClass, Fragment as _Fragment, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-46a54772\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"stud5p-task\" }\nconst _hoisted_2 = { class: \"default\" }\nconst _hoisted_3 = {\n  key: 0,\n  class: \"find-the-hotspots-editor\"\n}\nconst _hoisted_4 = { class: \"button-bar\" }\nconst _hoisted_5 = [\"title\"]\nconst _hoisted_6 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"svg\", {\n  width: \"20\",\n  height: \"20\",\n  viewBox: \"0 0 32 32\",\n  xmlns: \"http://www.w3.org/2000/svg\"\n}, [\n  /*#__PURE__*/_createElementVNode(\"rect\", {\n    x: \"1\",\n    y: \"1\",\n    width: \"30\",\n    height: \"30\",\n    fill: \"none\",\n    stroke: \"currentColor\",\n    \"stroke-width\": \"2px\",\n    rx: \"2\"\n  })\n], -1))\nconst _hoisted_7 = [\n  _hoisted_6\n]\nconst _hoisted_8 = [\"title\"]\nconst _hoisted_9 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"svg\", {\n  width: \"20\",\n  height: \"20\",\n  viewBox: \"0 0 32 32\",\n  xmlns: \"http://www.w3.org/2000/svg\"\n}, [\n  /*#__PURE__*/_createElementVNode(\"circle\", {\n    cx: \"16\",\n    cy: \"16\",\n    r: \"15\",\n    fill: \"none\",\n    stroke: \"currentColor\",\n    \"stroke-width\": \"2px\"\n  })\n], -1))\nconst _hoisted_10 = [\n  _hoisted_9\n]\nconst _hoisted_11 = { key: 1 }\nconst _hoisted_12 = { class: \"collapsable collapsed\" }\nconst _hoisted_13 = { style: {\"margin-bottom\":\"0\",\"width\":\"fit-content\"} }\nconst _hoisted_14 = { style: {\"display\":\"flex\",\"align-items\":\"center\",\"gap\":\"0.25em\"} }\nconst _hoisted_15 = [\"disabled\", \"max\"]\nconst _hoisted_16 = { style: {\"width\":\"fit-content\"} }\nconst _hoisted_17 = { style: {\"display\":\"flex\",\"align-items\":\"center\",\"gap\":\"0.25em\"} }\nconst _hoisted_18 = [\"disabled\", \"min\"]\nconst _hoisted_19 = { key: 1 }\nconst _hoisted_20 = { class: \"collapsable collapsed\" }\nconst _hoisted_21 = { class: \"collapsable collapsed\" }\nconst _hoisted_22 = {\n  key: 0,\n  style: { flexBasis: '50%', flexGrow: 0, flexShrink: 0 }\n}\n\nimport {\n  inject,\n  PropType,\n  provide,\n  ref,\n  watch,\n  computed,\n} from 'vue';\nimport FileUpload from '@/components/FileUpload.vue';\nimport produce from 'immer';\nimport { v4 } from 'uuid';\nimport { FileRef } from '@/routes/jsonApi';\nimport {\n  TaskEditorState,\n  taskEditorStateSymbol,\n} from '@/components/taskEditorState';\nimport { FindTheHotspotsTask, Hotspot } from '@/models/FindTheHotspotsTask';\nimport { findTheHotspotsEditorStateSymbol } from '@/components/findTheHotspots/findTheHotspotsEditorState';\nimport ImageWithHotspots from '@/components/findTheHotspots/ImageWithHotspots.vue';\nimport { cloneDeep } from 'lodash';\nimport { $gettext } from '@/language/gettext';\n\n\nexport default /*#__PURE__*/_defineComponent({\n  props: {\n  taskDefinition: {\n    type: Object as PropType<FindTheHotspotsTask>,\n    required: true,\n  },\n},\n  setup(__props) {\n\nconst props = __props\n\nconst taskEditor = inject<TaskEditorState>(taskEditorStateSymbol);\n\n\n\nconst debug = window.STUDIP.LernmoduleVueJS.LERNMODULE_DEBUG;\n\n// State\nconst modelTaskDefinition = ref<FindTheHotspotsTask>(\n  cloneDeep(props.taskDefinition)\n);\nconst selectedHotspotId = ref<string | undefined>(undefined);\nconst limitHotspotsToFind = ref<boolean>(false);\nconst hotspotsToFind = ref<number | null>(null);\nconst limitClicks = ref<boolean>(false);\nconst allowedClicks = ref<number | null>(null);\nconst imageWithHotspotsRef = ref<\n  InstanceType<typeof ImageWithHotspots> | undefined\n>();\n\nprovide(findTheHotspotsEditorStateSymbol, {\n  selectedHotspotId,\n  selectHotspot,\n  deleteSelectedHotspot,\n  changeHotspotCorrectness,\n  setHotspotFeedback,\n  dragHotspot,\n  resizeHotspot,\n});\n\n// Computed properties\nconst numberOfCorrectHotspots = computed(\n  () =>\n    modelTaskDefinition.value.hotspots.filter((hotspot) => hotspot.correct)\n      .length\n);\n\nconst numberOfHotspotsToFind = computed(\n  () => modelTaskDefinition.value.hotspotsToFind\n);\n\nconst numberOfClicksAllowed = computed(\n  () => modelTaskDefinition.value.allowedClicks\n);\n\n// Watchers\nwatch(\n  () => props.taskDefinition,\n  (newTaskDefinition, oldTaskDefinition) => {\n    modelTaskDefinition.value = cloneDeep(newTaskDefinition);\n  },\n  { deep: true }\n);\n\nwatch(numberOfCorrectHotspots, (newValue) => {\n  // Reset settings if numberOfCorrectHotspots changes\n  limitHotspotsToFind.value = false;\n  limitClicks.value = false;\n  updateHotspotsToFindInTaskDefinition();\n});\n\nfunction updateTaskDefinition(undoBatch?: unknown): void {\n  // Synchronize state modelTaskDefinition -> taskDefinition.\n  console.log('update task definition');\n  taskEditor!.performEdit({\n    newTaskDefinition: cloneDeep(modelTaskDefinition.value),\n    undoBatch: undoBatch ?? {},\n  });\n}\n\nfunction updateAllowedClicksInTaskDefinition(): void {\n  if (!limitClicks.value) {\n    // If the setting is not checked we set the allowedClicks value to 0 which means unlimited clicks\n    allowedClicks.value = null;\n    modelTaskDefinition.value = produce(modelTaskDefinition.value, (draft) => {\n      draft.allowedClicks = 0;\n    });\n  } else {\n    // If the setting is checked we need to make sure we set a valid value for the limit\n    if (\n      allowedClicks.value &&\n      allowedClicks.value >=\n        (numberOfHotspotsToFind.value\n          ? numberOfHotspotsToFind.value\n          : numberOfCorrectHotspots.value)\n    ) {\n      // We already have a valid value, set it in the taskDefinition\n      modelTaskDefinition.value = produce(\n        modelTaskDefinition.value,\n        (draft) => {\n          draft.allowedClicks = allowedClicks.value as number;\n        }\n      );\n    } else {\n      // The value in allowedClicks is not valid, make it valid\n      allowedClicks.value = Math.max(\n        numberOfHotspotsToFind.value\n          ? numberOfHotspotsToFind.value\n          : numberOfCorrectHotspots.value,\n        1\n      );\n      modelTaskDefinition.value = produce(\n        modelTaskDefinition.value,\n        (draft) => {\n          draft.allowedClicks = allowedClicks.value as number;\n        }\n      );\n    }\n  }\n\n  updateTaskDefinition();\n}\n\nfunction updateHotspotsToFindInTaskDefinition(): void {\n  if (!limitHotspotsToFind.value) {\n    // If the setting is not checked we set the hotspotsToFind value to 0 which means all\n    hotspotsToFind.value = null;\n    modelTaskDefinition.value = produce(modelTaskDefinition.value, (draft) => {\n      draft.hotspotsToFind = 0;\n    });\n  } else {\n    // If the setting is checked we need to make sure we set a valid value for the limit\n    if (\n      hotspotsToFind.value &&\n      hotspotsToFind.value <= numberOfCorrectHotspots.value\n    ) {\n      // We already have a valid value, let's set it in the taskDefinition\n      modelTaskDefinition.value = produce(\n        modelTaskDefinition.value,\n        (draft) => {\n          draft.hotspotsToFind = hotspotsToFind.value\n            ? hotspotsToFind.value\n            : numberOfCorrectHotspots.value;\n        }\n      );\n    } else {\n      // The value in hotspotsToFind is not valid, let's make it valid\n      hotspotsToFind.value = Math.max(numberOfCorrectHotspots.value, 1);\n      modelTaskDefinition.value = produce(\n        modelTaskDefinition.value,\n        (draft) => {\n          draft.hotspotsToFind = hotspotsToFind.value\n            ? hotspotsToFind.value\n            : numberOfCorrectHotspots.value;\n        }\n      );\n    }\n  }\n\n  updateTaskDefinition();\n\n  // If we changed the number of hotspotsToFind we also need to update\n  // the allowed clicks limit to make sure the task is still valid\n  updateAllowedClicksInTaskDefinition();\n}\n\nfunction onImageUploaded(file: FileRef): void {\n  modelTaskDefinition.value = produce(modelTaskDefinition.value, (draft) => {\n    draft.image = {\n      uuid: v4(),\n      type: 'image',\n      file_id: file.id,\n      altText: '',\n    };\n  });\n\n  updateTaskDefinition();\n}\n\nfunction addRectangularHotspot(): void {\n  const imgEl = document.querySelector('.hotspots-image');\n  const imageWidthPixels = imgEl ? imgEl.clientWidth : 10;\n  const imageHeightPixels = imgEl ? imgEl.clientHeight : 10;\n  let hotspotWidthPercent: number, hotspotHeightPercent: number;\n  const size = 0.3;\n  const smallestDim = imageWidthPixels > imageHeightPixels ? 'height' : 'width';\n  if (smallestDim === 'height') {\n    hotspotHeightPercent = size;\n    const hotspotHeightPixels = hotspotHeightPercent * imageHeightPixels;\n    hotspotWidthPercent = hotspotHeightPixels / imageWidthPixels;\n  } else {\n    hotspotWidthPercent = size;\n    const hotspotWidthPixels = hotspotWidthPercent * imageWidthPixels;\n    hotspotHeightPercent = hotspotWidthPixels / imageHeightPixels;\n  }\n\n  const newHotspot: Hotspot = {\n    uuid: v4(),\n    type: 'rectangle',\n    x: 0.5 - hotspotWidthPercent / 2,\n    y: 0.5 - hotspotHeightPercent / 2,\n    width: hotspotWidthPercent,\n    height: hotspotHeightPercent,\n    correct: true,\n    feedback: '',\n  };\n  modelTaskDefinition.value = produce(modelTaskDefinition.value, (draft) => {\n    draft.hotspots.push(newHotspot);\n  });\n\n  updateTaskDefinition();\n\n  selectHotspot(newHotspot.uuid);\n}\n\nfunction addEllipseHotspot(): void {\n  const imgEl = document.querySelector('.hotspots-image');\n  const imageWidthPixels = imgEl ? imgEl.clientWidth : 10;\n  const imageHeightPixels = imgEl ? imgEl.clientHeight : 10;\n  let hotspotWidthPercent: number, hotspotHeightPercent: number;\n  const size = 0.3;\n  const smallestDim = imageWidthPixels > imageHeightPixels ? 'height' : 'width';\n  if (smallestDim === 'height') {\n    hotspotHeightPercent = size;\n    const hotspotHeightPixels = hotspotHeightPercent * imageHeightPixels;\n    hotspotWidthPercent = hotspotHeightPixels / imageWidthPixels;\n  } else {\n    hotspotWidthPercent = size;\n    const hotspotWidthPixels = hotspotWidthPercent * imageWidthPixels;\n    hotspotHeightPercent = hotspotWidthPixels / imageHeightPixels;\n  }\n\n  const newHotspot: Hotspot = {\n    uuid: v4(),\n    type: 'ellipse',\n    x: 0.5 - hotspotWidthPercent / 2,\n    y: 0.5 - hotspotHeightPercent / 2,\n    width: hotspotWidthPercent,\n    height: hotspotHeightPercent,\n    correct: true,\n    feedback: '',\n  };\n  modelTaskDefinition.value = produce(modelTaskDefinition.value, (draft) => {\n    draft.hotspots.push(newHotspot);\n  });\n\n  updateTaskDefinition();\n\n  selectHotspot(newHotspot.uuid);\n}\n\nfunction removeAllHotspots(): void {\n  modelTaskDefinition.value = produce(modelTaskDefinition.value, (draft) => {\n    draft.hotspots = [];\n  });\n\n  updateTaskDefinition();\n}\n\nfunction deleteImage(): void {\n  // Delete the image and also remove all hotspots\n  modelTaskDefinition.value = produce(modelTaskDefinition.value, (draft) => {\n    draft.image = {\n      type: 'none',\n    };\n    draft.hotspots = [];\n  });\n\n  updateTaskDefinition();\n}\n\nfunction deleteSelectedHotspot(): void {\n  if (!selectedHotspotId.value) {\n    console.error(\n      'Called deleteSelectedHotspot, but selectedHotspotId is undefined'\n    );\n    return;\n  }\n  deleteHotspot(selectedHotspotId.value);\n}\n\nfunction deleteHotspot(id: string): void {\n  modelTaskDefinition.value = produce(modelTaskDefinition.value, (draft) => {\n    const index = draft.hotspots.findIndex((hotspot) => hotspot.uuid === id);\n    if (index === -1) {\n      throw new Error('No hotspot with id ' + id + ' found.');\n    }\n    draft.hotspots.splice(index, 1);\n  });\n\n  updateTaskDefinition();\n}\n\nfunction changeHotspotCorrectness(correct: boolean): void {\n  if (!selectedHotspotId.value) {\n    console.error(\n      'Called deleteSelectedHotspot, but selectedHotspotId is undefined'\n    );\n    return;\n  }\n\n  modelTaskDefinition.value = produce(modelTaskDefinition.value, (draft) => {\n    const hotspot = draft.hotspots.find(\n      (hotspot) => hotspot.uuid === selectedHotspotId.value\n    );\n    if (hotspot) {\n      hotspot.correct = correct;\n    }\n  });\n\n  updateTaskDefinition();\n}\n\nfunction setHotspotFeedback(feedback: string): void {\n  console.log('setHotspotFeedback', feedback);\n\n  if (!selectedHotspotId.value) {\n    console.error(\n      'Called setHotspotFeedback, but selectedHotspot is undefined'\n    );\n    return;\n  }\n\n  modelTaskDefinition.value = produce(modelTaskDefinition.value, (draft) => {\n    const hotspot = draft.hotspots.find(\n      (hotspot) => hotspot.uuid === selectedHotspotId.value\n    );\n    if (hotspot) {\n      hotspot.feedback = feedback;\n    }\n  });\n\n  updateTaskDefinition('task.hotspots.feedback' + selectedHotspotId.value);\n}\n\nfunction selectHotspot(id: string): void {\n  selectedHotspotId.value = id;\n}\n\nfunction dragHotspot(\n  dragId: string,\n  hotspotId: string,\n  xFraction: number,\n  yFraction: number\n): void {\n  modelTaskDefinition.value = produce(modelTaskDefinition.value, (draft) => {\n    const hotspot = draft.hotspots.find((h) => h.uuid === hotspotId);\n    if (!hotspot) {\n      throw new Error(`Hotspot with id ${hotspotId} not found`);\n    }\n    hotspot.x = xFraction;\n    hotspot.y = yFraction;\n  });\n\n  updateTaskDefinition(dragId);\n}\n\nfunction resizeHotspot(\n  dragId: string,\n  hotspotId: string,\n  xFraction: number,\n  yFraction: number,\n  width: number,\n  height: number\n): void {\n  modelTaskDefinition.value = produce(modelTaskDefinition.value, (draft) => {\n    const hotspot = draft.hotspots.find((h) => h.uuid === hotspotId);\n    if (!hotspot) {\n      throw new Error(`Hotspot with id ${hotspotId} not found`);\n    }\n    hotspot.x = xFraction;\n    hotspot.y = yFraction;\n    hotspot.width = width;\n    hotspot.height = height;\n  });\n\n  updateTaskDefinition(dragId);\n}\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(_Fragment, null, [\n    _createElementVNode(\"div\", _hoisted_1, [\n      _createElementVNode(\"form\", _hoisted_2, [\n        _createElementVNode(\"fieldset\", null, [\n          _createElementVNode(\"legend\", null, _toDisplayString(_unref($gettext)('Find the Hotspots')), 1),\n          (__props.taskDefinition.image.type === 'image')\n            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [\n                _createElementVNode(\"div\", _hoisted_4, [\n                  _createElementVNode(\"button\", {\n                    onClick: addRectangularHotspot,\n                    type: \"button\",\n                    class: \"hotspot-button\",\n                    title: _unref($gettext)('Rechteckigen Hotspot hinzufgen')\n                  }, _hoisted_7, 8, _hoisted_5),\n                  _createElementVNode(\"button\", {\n                    onClick: addEllipseHotspot,\n                    type: \"button\",\n                    class: \"hotspot-button\",\n                    title: _unref($gettext)('Runden Hotspot hinzufgen')\n                  }, _hoisted_10, 8, _hoisted_8),\n                  _createElementVNode(\"button\", {\n                    onClick: removeAllHotspots,\n                    type: \"button\",\n                    class: \"hotspot-button\"\n                  }, _toDisplayString(_unref($gettext)('Alle Hotspots entfernen')), 1),\n                  _createElementVNode(\"button\", {\n                    onClick: deleteImage,\n                    type: \"button\",\n                    class: \"hotspot-button\"\n                  }, _toDisplayString(_unref($gettext)('Bild lschen')), 1)\n                ]),\n                _createVNode(ImageWithHotspots, {\n                  ref_key: \"imageWithHotspotsRef\",\n                  ref: imageWithHotspotsRef,\n                  hotspots: __props.taskDefinition.hotspots,\n                  image: __props.taskDefinition.image\n                }, null, 8, [\"hotspots\", \"image\"])\n              ]))\n            : (_openBlock(), _createElementBlock(\"label\", _hoisted_11, [\n                _createTextVNode(_toDisplayString(_unref($gettext)('Neues Bild hochladen')) + \" \", 1),\n                _createVNode(FileUpload, {\n                  onFileUploaded: onImageUploaded,\n                  accept: 'image/*'\n                })\n              ]))\n        ]),\n        _createElementVNode(\"fieldset\", _hoisted_12, [\n          _createElementVNode(\"legend\", null, _toDisplayString(_unref($gettext)('Einstellungen')), 1),\n          (_unref(numberOfCorrectHotspots))\n            ? (_openBlock(), _createElementBlock(_Fragment, { key: 0 }, [\n                _createElementVNode(\"label\", _hoisted_13, [\n                  _createElementVNode(\"span\", _hoisted_14, [\n                    _withDirectives(_createElementVNode(\"input\", {\n                      \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((limitHotspotsToFind).value = $event)),\n                      onChange: updateHotspotsToFindInTaskDefinition,\n                      type: \"checkbox\"\n                    }, null, 544), [\n                      [_vModelCheckbox, limitHotspotsToFind.value]\n                    ]),\n                    _createTextVNode(\" \" + _toDisplayString(_unref($gettext)('Anzahl zu findender Hotspots begrenzen auf:')) + \" \", 1),\n                    _withDirectives(_createElementVNode(\"input\", {\n                      \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event: any) => ((hotspotsToFind).value = $event)),\n                      style: {\"margin-bottom\":\"0.25em\",\"width\":\"4em\",\"padding\":\"0 0.25em 0 0.25em\"},\n                      disabled: !limitHotspotsToFind.value,\n                      class: _normalizeClass({ 'setting-disabled': !limitHotspotsToFind.value }),\n                      onChange: updateHotspotsToFindInTaskDefinition,\n                      type: \"number\",\n                      min: 1,\n                      max: _unref(numberOfCorrectHotspots)\n                    }, null, 42, _hoisted_15), [\n                      [_vModelText, hotspotsToFind.value]\n                    ])\n                  ])\n                ]),\n                _createElementVNode(\"label\", _hoisted_16, [\n                  _createElementVNode(\"span\", _hoisted_17, [\n                    _withDirectives(_createElementVNode(\"input\", {\n                      \"onUpdate:modelValue\": _cache[2] || (_cache[2] = ($event: any) => ((limitClicks).value = $event)),\n                      onChange: updateAllowedClicksInTaskDefinition,\n                      type: \"checkbox\"\n                    }, null, 544), [\n                      [_vModelCheckbox, limitClicks.value]\n                    ]),\n                    _createTextVNode(\" \" + _toDisplayString(_unref($gettext)('Anzahl erlaubter Klicks begrenzen auf: ')) + \" \", 1),\n                    _withDirectives(_createElementVNode(\"input\", {\n                      \"onUpdate:modelValue\": _cache[3] || (_cache[3] = ($event: any) => ((allowedClicks).value = $event)),\n                      style: {\"margin-bottom\":\"0.25em\",\"width\":\"4em\",\"padding\":\"0 0.25em 0 0.25em\"},\n                      disabled: !limitClicks.value,\n                      class: _normalizeClass({ 'setting-disabled': !limitClicks.value }),\n                      onChange: updateAllowedClicksInTaskDefinition,\n                      type: \"number\",\n                      min: \n                  Math.max(\n                    modelTaskDefinition.value.hotspotsToFind\n                      ? modelTaskDefinition.value.hotspotsToFind\n                      : _unref(numberOfCorrectHotspots),\n                    1\n                  )\n                \n                    }, null, 42, _hoisted_18), [\n                      [_vModelText, allowedClicks.value]\n                    ])\n                  ])\n                ])\n              ], 64))\n            : (_openBlock(), _createElementBlock(\"label\", _hoisted_19, _toDisplayString(_unref($gettext)('Fgen Sie mindestens einen korrekten Hotspot hinzu.')), 1))\n        ]),\n        _createElementVNode(\"fieldset\", _hoisted_20, [\n          _createElementVNode(\"legend\", null, _toDisplayString(_unref($gettext)('Beschriftungen')), 1),\n          _createElementVNode(\"label\", null, [\n            _createTextVNode(_toDisplayString(_unref($gettext)('Text fr Wiederholen-Button:')) + \" \", 1),\n            _withDirectives(_createElementVNode(\"input\", {\n              \"onUpdate:modelValue\": _cache[4] || (_cache[4] = ($event: any) => ((modelTaskDefinition.value.strings.retryButton) = $event)),\n              onInput: _cache[5] || (_cache[5] = ($event: any) => (updateTaskDefinition('taskDefinition.strings.retryButton'))),\n              type: \"text\"\n            }, null, 544), [\n              [_vModelText, modelTaskDefinition.value.strings.retryButton]\n            ])\n          ])\n        ]),\n        _createElementVNode(\"fieldset\", _hoisted_21, [\n          _createElementVNode(\"legend\", null, _toDisplayString(_unref($gettext)('Feedback')), 1),\n          _createElementVNode(\"label\", null, [\n            _createTextVNode(_toDisplayString(_unref($gettext)(\n              'Ergebnismitteilung (mgliche Variablen :correct und :total):'\n            )) + \" \", 1),\n            _withDirectives(_createElementVNode(\"input\", {\n              \"onUpdate:modelValue\": _cache[6] || (_cache[6] = ($event: any) => ((modelTaskDefinition.value.strings.resultMessage) = $event)),\n              onInput: _cache[7] || (_cache[7] = ($event: any) => (\n              updateTaskDefinition('taskDefinition.strings.resultMessage')\n            )),\n              type: \"text\"\n            }, null, 544), [\n              [_vModelText, modelTaskDefinition.value.strings.resultMessage]\n            ])\n          ]),\n          _createElementVNode(\"label\", null, [\n            _createTextVNode(_toDisplayString(_unref($gettext)('Feedback, wenn in den leeren Bereich geklickt wurde:')) + \" \", 1),\n            _withDirectives(_createElementVNode(\"input\", {\n              \"onUpdate:modelValue\": _cache[8] || (_cache[8] = ($event: any) => ((modelTaskDefinition.value.strings.feedbackWhenClickingBackground) = $event)),\n              onInput: _cache[9] || (_cache[9] = ($event: any) => (\n              updateTaskDefinition(\n                'taskDefinition.strings.feedbackWhenClickingBackground'\n              )\n            )),\n              type: \"text\"\n            }, null, 544), [\n              [_vModelText, modelTaskDefinition.value.strings.feedbackWhenClickingBackground]\n            ])\n          ]),\n          _createElementVNode(\"label\", null, [\n            _createTextVNode(_toDisplayString(_unref($gettext)(\n              'Feedback, wenn auf einen bereits gefundenen Hotspot geklickt wurde:'\n            )) + \" \", 1),\n            _withDirectives(_createElementVNode(\"input\", {\n              \"onUpdate:modelValue\": _cache[10] || (_cache[10] = ($event: any) => ((\n              modelTaskDefinition.value.strings.feedbackWhenClickingHotspotAgain\n            ) = $event)),\n              onInput: _cache[11] || (_cache[11] = ($event: any) => (\n              updateTaskDefinition(\n                'taskDefinition.strings.feedbackWhenClickingHotspotAgain'\n              )\n            )),\n              type: \"text\"\n            }, null, 544), [\n              [_vModelText, \n              modelTaskDefinition.value.strings.feedbackWhenClickingHotspotAgain\n            ]\n            ])\n          ])\n        ])\n      ])\n    ]),\n    (_unref(debug) && true)\n      ? (_openBlock(), _createElementBlock(\"pre\", _hoisted_22, _toDisplayString({\n        numberOfCorrectHotspots: _unref(numberOfCorrectHotspots),\n        limitHotspotsToFind: limitHotspotsToFind.value,\n        hotspotsToFind: hotspotsToFind.value,\n        limitClicks: limitClicks.value,\n        allowedClicks: allowedClicks.value,\n        numberOfClicksAllowed: _unref(numberOfClicksAllowed),\n        numberOfHotspotsToFind: _unref(numberOfHotspotsToFind),\n      }), 1))\n      : _createCommentVNode(\"\", true)\n  ], 64))\n}\n}\n\n})","<template>\n  <div class=\"stud5p-task\">\n    <form class=\"default\">\n      <fieldset>\n        <legend>{{ $gettext('Find the Hotspots') }}</legend>\n\n        <div\n          v-if=\"taskDefinition.image.type === 'image'\"\n          class=\"find-the-hotspots-editor\"\n        >\n          <div class=\"button-bar\">\n            <button\n              @click=\"addRectangularHotspot\"\n              type=\"button\"\n              class=\"hotspot-button\"\n              :title=\"$gettext('Rechteckigen Hotspot hinzufgen')\"\n            >\n              <svg\n                width=\"20\"\n                height=\"20\"\n                viewBox=\"0 0 32 32\"\n                xmlns=\"http://www.w3.org/2000/svg\"\n              >\n                <rect\n                  x=\"1\"\n                  y=\"1\"\n                  width=\"30\"\n                  height=\"30\"\n                  fill=\"none\"\n                  stroke=\"currentColor\"\n                  stroke-width=\"2px\"\n                  rx=\"2\"\n                />\n              </svg>\n            </button>\n            <button\n              @click=\"addEllipseHotspot\"\n              type=\"button\"\n              class=\"hotspot-button\"\n              :title=\"$gettext('Runden Hotspot hinzufgen')\"\n            >\n              <svg\n                width=\"20\"\n                height=\"20\"\n                viewBox=\"0 0 32 32\"\n                xmlns=\"http://www.w3.org/2000/svg\"\n              >\n                <circle\n                  cx=\"16\"\n                  cy=\"16\"\n                  r=\"15\"\n                  fill=\"none\"\n                  stroke=\"currentColor\"\n                  stroke-width=\"2px\"\n                />\n              </svg>\n            </button>\n            <button\n              @click=\"removeAllHotspots\"\n              type=\"button\"\n              class=\"hotspot-button\"\n            >\n              {{ $gettext('Alle Hotspots entfernen') }}\n            </button>\n            <button @click=\"deleteImage\" type=\"button\" class=\"hotspot-button\">\n              {{ $gettext('Bild lschen') }}\n            </button>\n          </div>\n          <ImageWithHotspots\n            ref=\"imageWithHotspotsRef\"\n            :hotspots=\"taskDefinition.hotspots\"\n            :image=\"taskDefinition.image\"\n          />\n        </div>\n\n        <label v-else>\n          {{ $gettext('Neues Bild hochladen') }}\n          <FileUpload @file-uploaded=\"onImageUploaded\" :accept=\"'image/*'\" />\n        </label>\n      </fieldset>\n      <fieldset class=\"collapsable collapsed\">\n        <legend>{{ $gettext('Einstellungen') }}</legend>\n        <template v-if=\"numberOfCorrectHotspots\">\n          <label style=\"margin-bottom: 0; width: fit-content\">\n            <span style=\"display: flex; align-items: center; gap: 0.25em\">\n              <input\n                v-model=\"limitHotspotsToFind\"\n                @change=\"updateHotspotsToFindInTaskDefinition\"\n                type=\"checkbox\"\n              />\n              {{ $gettext('Anzahl zu findender Hotspots begrenzen auf:') }}\n              <input\n                v-model=\"hotspotsToFind\"\n                style=\"\n                  margin-bottom: 0.25em;\n                  width: 4em;\n                  padding: 0 0.25em 0 0.25em;\n                \"\n                :disabled=\"!limitHotspotsToFind\"\n                :class=\"{ 'setting-disabled': !limitHotspotsToFind }\"\n                @change=\"updateHotspotsToFindInTaskDefinition\"\n                type=\"number\"\n                :min=\"1\"\n                :max=\"numberOfCorrectHotspots\"\n              />\n            </span>\n          </label>\n\n          <label style=\"width: fit-content\">\n            <span style=\"display: flex; align-items: center; gap: 0.25em\">\n              <input\n                v-model=\"limitClicks\"\n                @change=\"updateAllowedClicksInTaskDefinition\"\n                type=\"checkbox\"\n              />\n              {{ $gettext('Anzahl erlaubter Klicks begrenzen auf: ') }}\n              <input\n                v-model=\"allowedClicks\"\n                style=\"\n                  margin-bottom: 0.25em;\n                  width: 4em;\n                  padding: 0 0.25em 0 0.25em;\n                \"\n                :disabled=\"!limitClicks\"\n                :class=\"{ 'setting-disabled': !limitClicks }\"\n                @change=\"updateAllowedClicksInTaskDefinition\"\n                type=\"number\"\n                :min=\"\n                  Math.max(\n                    modelTaskDefinition.hotspotsToFind\n                      ? modelTaskDefinition.hotspotsToFind\n                      : numberOfCorrectHotspots,\n                    1\n                  )\n                \"\n              />\n            </span>\n          </label>\n        </template>\n        <label v-else>{{\n          $gettext('Fgen Sie mindestens einen korrekten Hotspot hinzu.')\n        }}</label>\n      </fieldset>\n      <fieldset class=\"collapsable collapsed\">\n        <legend>{{ $gettext('Beschriftungen') }}</legend>\n\n        <label>\n          {{ $gettext('Text fr Wiederholen-Button:') }}\n          <input\n            v-model=\"modelTaskDefinition.strings.retryButton\"\n            @input=\"updateTaskDefinition('taskDefinition.strings.retryButton')\"\n            type=\"text\"\n          />\n        </label>\n      </fieldset>\n      <fieldset class=\"collapsable collapsed\">\n        <legend>{{ $gettext('Feedback') }}</legend>\n\n        <label>\n          {{\n            $gettext(\n              'Ergebnismitteilung (mgliche Variablen :correct und :total):'\n            )\n          }}\n          <input\n            v-model=\"modelTaskDefinition.strings.resultMessage\"\n            @input=\"\n              updateTaskDefinition('taskDefinition.strings.resultMessage')\n            \"\n            type=\"text\"\n          />\n        </label>\n\n        <label>\n          {{ $gettext('Feedback, wenn in den leeren Bereich geklickt wurde:') }}\n          <input\n            v-model=\"modelTaskDefinition.strings.feedbackWhenClickingBackground\"\n            @input=\"\n              updateTaskDefinition(\n                'taskDefinition.strings.feedbackWhenClickingBackground'\n              )\n            \"\n            type=\"text\"\n          />\n        </label>\n\n        <label>\n          {{\n            $gettext(\n              'Feedback, wenn auf einen bereits gefundenen Hotspot geklickt wurde:'\n            )\n          }}\n          <input\n            v-model=\"\n              modelTaskDefinition.strings.feedbackWhenClickingHotspotAgain\n            \"\n            @input=\"\n              updateTaskDefinition(\n                'taskDefinition.strings.feedbackWhenClickingHotspotAgain'\n              )\n            \"\n            type=\"text\"\n          />\n        </label>\n      </fieldset>\n    </form>\n  </div>\n  <pre\n    v-if=\"debug && true\"\n    :style=\"{ flexBasis: '50%', flexGrow: 0, flexShrink: 0 }\"\n    >{{\n      {\n        numberOfCorrectHotspots,\n        limitHotspotsToFind,\n        hotspotsToFind,\n        limitClicks,\n        allowedClicks,\n        numberOfClicksAllowed,\n        numberOfHotspotsToFind,\n      }\n    }}</pre\n  >\n</template>\n\n<script setup lang=\"ts\">\nimport {\n  inject,\n  PropType,\n  provide,\n  ref,\n  defineProps,\n  watch,\n  computed,\n} from 'vue';\nimport FileUpload from '@/components/FileUpload.vue';\nimport produce from 'immer';\nimport { v4 } from 'uuid';\nimport { FileRef } from '@/routes/jsonApi';\nimport {\n  TaskEditorState,\n  taskEditorStateSymbol,\n} from '@/components/taskEditorState';\nimport { FindTheHotspotsTask, Hotspot } from '@/models/FindTheHotspotsTask';\nimport { findTheHotspotsEditorStateSymbol } from '@/components/findTheHotspots/findTheHotspotsEditorState';\nimport ImageWithHotspots from '@/components/findTheHotspots/ImageWithHotspots.vue';\nimport { cloneDeep } from 'lodash';\nimport { $gettext } from '@/language/gettext';\n\nconst taskEditor = inject<TaskEditorState>(taskEditorStateSymbol);\n\nconst props = defineProps({\n  taskDefinition: {\n    type: Object as PropType<FindTheHotspotsTask>,\n    required: true,\n  },\n});\n\nconst debug = window.STUDIP.LernmoduleVueJS.LERNMODULE_DEBUG;\n\n// State\nconst modelTaskDefinition = ref<FindTheHotspotsTask>(\n  cloneDeep(props.taskDefinition)\n);\nconst selectedHotspotId = ref<string | undefined>(undefined);\nconst limitHotspotsToFind = ref<boolean>(false);\nconst hotspotsToFind = ref<number | null>(null);\nconst limitClicks = ref<boolean>(false);\nconst allowedClicks = ref<number | null>(null);\nconst imageWithHotspotsRef = ref<\n  InstanceType<typeof ImageWithHotspots> | undefined\n>();\n\nprovide(findTheHotspotsEditorStateSymbol, {\n  selectedHotspotId,\n  selectHotspot,\n  deleteSelectedHotspot,\n  changeHotspotCorrectness,\n  setHotspotFeedback,\n  dragHotspot,\n  resizeHotspot,\n});\n\n// Computed properties\nconst numberOfCorrectHotspots = computed(\n  () =>\n    modelTaskDefinition.value.hotspots.filter((hotspot) => hotspot.correct)\n      .length\n);\n\nconst numberOfHotspotsToFind = computed(\n  () => modelTaskDefinition.value.hotspotsToFind\n);\n\nconst numberOfClicksAllowed = computed(\n  () => modelTaskDefinition.value.allowedClicks\n);\n\n// Watchers\nwatch(\n  () => props.taskDefinition,\n  (newTaskDefinition, oldTaskDefinition) => {\n    modelTaskDefinition.value = cloneDeep(newTaskDefinition);\n  },\n  { deep: true }\n);\n\nwatch(numberOfCorrectHotspots, (newValue) => {\n  // Reset settings if numberOfCorrectHotspots changes\n  limitHotspotsToFind.value = false;\n  limitClicks.value = false;\n  updateHotspotsToFindInTaskDefinition();\n});\n\nfunction updateTaskDefinition(undoBatch?: unknown): void {\n  // Synchronize state modelTaskDefinition -> taskDefinition.\n  console.log('update task definition');\n  taskEditor!.performEdit({\n    newTaskDefinition: cloneDeep(modelTaskDefinition.value),\n    undoBatch: undoBatch ?? {},\n  });\n}\n\nfunction updateAllowedClicksInTaskDefinition(): void {\n  if (!limitClicks.value) {\n    // If the setting is not checked we set the allowedClicks value to 0 which means unlimited clicks\n    allowedClicks.value = null;\n    modelTaskDefinition.value = produce(modelTaskDefinition.value, (draft) => {\n      draft.allowedClicks = 0;\n    });\n  } else {\n    // If the setting is checked we need to make sure we set a valid value for the limit\n    if (\n      allowedClicks.value &&\n      allowedClicks.value >=\n        (numberOfHotspotsToFind.value\n          ? numberOfHotspotsToFind.value\n          : numberOfCorrectHotspots.value)\n    ) {\n      // We already have a valid value, set it in the taskDefinition\n      modelTaskDefinition.value = produce(\n        modelTaskDefinition.value,\n        (draft) => {\n          draft.allowedClicks = allowedClicks.value as number;\n        }\n      );\n    } else {\n      // The value in allowedClicks is not valid, make it valid\n      allowedClicks.value = Math.max(\n        numberOfHotspotsToFind.value\n          ? numberOfHotspotsToFind.value\n          : numberOfCorrectHotspots.value,\n        1\n      );\n      modelTaskDefinition.value = produce(\n        modelTaskDefinition.value,\n        (draft) => {\n          draft.allowedClicks = allowedClicks.value as number;\n        }\n      );\n    }\n  }\n\n  updateTaskDefinition();\n}\n\nfunction updateHotspotsToFindInTaskDefinition(): void {\n  if (!limitHotspotsToFind.value) {\n    // If the setting is not checked we set the hotspotsToFind value to 0 which means all\n    hotspotsToFind.value = null;\n    modelTaskDefinition.value = produce(modelTaskDefinition.value, (draft) => {\n      draft.hotspotsToFind = 0;\n    });\n  } else {\n    // If the setting is checked we need to make sure we set a valid value for the limit\n    if (\n      hotspotsToFind.value &&\n      hotspotsToFind.value <= numberOfCorrectHotspots.value\n    ) {\n      // We already have a valid value, let's set it in the taskDefinition\n      modelTaskDefinition.value = produce(\n        modelTaskDefinition.value,\n        (draft) => {\n          draft.hotspotsToFind = hotspotsToFind.value\n            ? hotspotsToFind.value\n            : numberOfCorrectHotspots.value;\n        }\n      );\n    } else {\n      // The value in hotspotsToFind is not valid, let's make it valid\n      hotspotsToFind.value = Math.max(numberOfCorrectHotspots.value, 1);\n      modelTaskDefinition.value = produce(\n        modelTaskDefinition.value,\n        (draft) => {\n          draft.hotspotsToFind = hotspotsToFind.value\n            ? hotspotsToFind.value\n            : numberOfCorrectHotspots.value;\n        }\n      );\n    }\n  }\n\n  updateTaskDefinition();\n\n  // If we changed the number of hotspotsToFind we also need to update\n  // the allowed clicks limit to make sure the task is still valid\n  updateAllowedClicksInTaskDefinition();\n}\n\nfunction onImageUploaded(file: FileRef): void {\n  modelTaskDefinition.value = produce(modelTaskDefinition.value, (draft) => {\n    draft.image = {\n      uuid: v4(),\n      type: 'image',\n      file_id: file.id,\n      altText: '',\n    };\n  });\n\n  updateTaskDefinition();\n}\n\nfunction addRectangularHotspot(): void {\n  const imgEl = document.querySelector('.hotspots-image');\n  const imageWidthPixels = imgEl ? imgEl.clientWidth : 10;\n  const imageHeightPixels = imgEl ? imgEl.clientHeight : 10;\n  let hotspotWidthPercent: number, hotspotHeightPercent: number;\n  const size = 0.3;\n  const smallestDim = imageWidthPixels > imageHeightPixels ? 'height' : 'width';\n  if (smallestDim === 'height') {\n    hotspotHeightPercent = size;\n    const hotspotHeightPixels = hotspotHeightPercent * imageHeightPixels;\n    hotspotWidthPercent = hotspotHeightPixels / imageWidthPixels;\n  } else {\n    hotspotWidthPercent = size;\n    const hotspotWidthPixels = hotspotWidthPercent * imageWidthPixels;\n    hotspotHeightPercent = hotspotWidthPixels / imageHeightPixels;\n  }\n\n  const newHotspot: Hotspot = {\n    uuid: v4(),\n    type: 'rectangle',\n    x: 0.5 - hotspotWidthPercent / 2,\n    y: 0.5 - hotspotHeightPercent / 2,\n    width: hotspotWidthPercent,\n    height: hotspotHeightPercent,\n    correct: true,\n    feedback: '',\n  };\n  modelTaskDefinition.value = produce(modelTaskDefinition.value, (draft) => {\n    draft.hotspots.push(newHotspot);\n  });\n\n  updateTaskDefinition();\n\n  selectHotspot(newHotspot.uuid);\n}\n\nfunction addEllipseHotspot(): void {\n  const imgEl = document.querySelector('.hotspots-image');\n  const imageWidthPixels = imgEl ? imgEl.clientWidth : 10;\n  const imageHeightPixels = imgEl ? imgEl.clientHeight : 10;\n  let hotspotWidthPercent: number, hotspotHeightPercent: number;\n  const size = 0.3;\n  const smallestDim = imageWidthPixels > imageHeightPixels ? 'height' : 'width';\n  if (smallestDim === 'height') {\n    hotspotHeightPercent = size;\n    const hotspotHeightPixels = hotspotHeightPercent * imageHeightPixels;\n    hotspotWidthPercent = hotspotHeightPixels / imageWidthPixels;\n  } else {\n    hotspotWidthPercent = size;\n    const hotspotWidthPixels = hotspotWidthPercent * imageWidthPixels;\n    hotspotHeightPercent = hotspotWidthPixels / imageHeightPixels;\n  }\n\n  const newHotspot: Hotspot = {\n    uuid: v4(),\n    type: 'ellipse',\n    x: 0.5 - hotspotWidthPercent / 2,\n    y: 0.5 - hotspotHeightPercent / 2,\n    width: hotspotWidthPercent,\n    height: hotspotHeightPercent,\n    correct: true,\n    feedback: '',\n  };\n  modelTaskDefinition.value = produce(modelTaskDefinition.value, (draft) => {\n    draft.hotspots.push(newHotspot);\n  });\n\n  updateTaskDefinition();\n\n  selectHotspot(newHotspot.uuid);\n}\n\nfunction removeAllHotspots(): void {\n  modelTaskDefinition.value = produce(modelTaskDefinition.value, (draft) => {\n    draft.hotspots = [];\n  });\n\n  updateTaskDefinition();\n}\n\nfunction deleteImage(): void {\n  // Delete the image and also remove all hotspots\n  modelTaskDefinition.value = produce(modelTaskDefinition.value, (draft) => {\n    draft.image = {\n      type: 'none',\n    };\n    draft.hotspots = [];\n  });\n\n  updateTaskDefinition();\n}\n\nfunction deleteSelectedHotspot(): void {\n  if (!selectedHotspotId.value) {\n    console.error(\n      'Called deleteSelectedHotspot, but selectedHotspotId is undefined'\n    );\n    return;\n  }\n  deleteHotspot(selectedHotspotId.value);\n}\n\nfunction deleteHotspot(id: string): void {\n  modelTaskDefinition.value = produce(modelTaskDefinition.value, (draft) => {\n    const index = draft.hotspots.findIndex((hotspot) => hotspot.uuid === id);\n    if (index === -1) {\n      throw new Error('No hotspot with id ' + id + ' found.');\n    }\n    draft.hotspots.splice(index, 1);\n  });\n\n  updateTaskDefinition();\n}\n\nfunction changeHotspotCorrectness(correct: boolean): void {\n  if (!selectedHotspotId.value) {\n    console.error(\n      'Called deleteSelectedHotspot, but selectedHotspotId is undefined'\n    );\n    return;\n  }\n\n  modelTaskDefinition.value = produce(modelTaskDefinition.value, (draft) => {\n    const hotspot = draft.hotspots.find(\n      (hotspot) => hotspot.uuid === selectedHotspotId.value\n    );\n    if (hotspot) {\n      hotspot.correct = correct;\n    }\n  });\n\n  updateTaskDefinition();\n}\n\nfunction setHotspotFeedback(feedback: string): void {\n  console.log('setHotspotFeedback', feedback);\n\n  if (!selectedHotspotId.value) {\n    console.error(\n      'Called setHotspotFeedback, but selectedHotspot is undefined'\n    );\n    return;\n  }\n\n  modelTaskDefinition.value = produce(modelTaskDefinition.value, (draft) => {\n    const hotspot = draft.hotspots.find(\n      (hotspot) => hotspot.uuid === selectedHotspotId.value\n    );\n    if (hotspot) {\n      hotspot.feedback = feedback;\n    }\n  });\n\n  updateTaskDefinition('task.hotspots.feedback' + selectedHotspotId.value);\n}\n\nfunction selectHotspot(id: string): void {\n  selectedHotspotId.value = id;\n}\n\nfunction dragHotspot(\n  dragId: string,\n  hotspotId: string,\n  xFraction: number,\n  yFraction: number\n): void {\n  modelTaskDefinition.value = produce(modelTaskDefinition.value, (draft) => {\n    const hotspot = draft.hotspots.find((h) => h.uuid === hotspotId);\n    if (!hotspot) {\n      throw new Error(`Hotspot with id ${hotspotId} not found`);\n    }\n    hotspot.x = xFraction;\n    hotspot.y = yFraction;\n  });\n\n  updateTaskDefinition(dragId);\n}\n\nfunction resizeHotspot(\n  dragId: string,\n  hotspotId: string,\n  xFraction: number,\n  yFraction: number,\n  width: number,\n  height: number\n): void {\n  modelTaskDefinition.value = produce(modelTaskDefinition.value, (draft) => {\n    const hotspot = draft.hotspots.find((h) => h.uuid === hotspotId);\n    if (!hotspot) {\n      throw new Error(`Hotspot with id ${hotspotId} not found`);\n    }\n    hotspot.x = xFraction;\n    hotspot.y = yFraction;\n    hotspot.width = width;\n    hotspot.height = height;\n  });\n\n  updateTaskDefinition(dragId);\n}\n</script>\n\n<style scoped>\n.find-the-hotspots-editor {\n  border: 1px solid #ccc;\n}\n\n.button-bar {\n  display: flex;\n  gap: 0.5em;\n  padding: 0.25em;\n  border-bottom: 1px solid #ccc;\n  background: #f5f5f5;\n}\n\n.hotspot-button {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: #444;\n\n  cursor: pointer;\n\n  background: linear-gradient(to bottom, #fff 0, #f2f2f2 100%);\n  border: 1px solid #ccc;\n  border-radius: 0.25em;\n  padding: 0.75em;\n\n  &:hover {\n    border: 1px solid #999;\n  }\n\n  &:nth-child(2) {\n    margin-right: auto;\n  }\n}\n</style>\n","import script from \"./FindTheHotspotsEditor.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./FindTheHotspotsEditor.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./FindTheHotspotsEditor.vue?vue&type=style&index=0&id=46a54772&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-46a54772\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { createVNode as _createVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, normalizeStyle as _normalizeStyle, createElementVNode as _createElementVNode, unref as _unref, createBlock as _createBlock, createCommentVNode as _createCommentVNode, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-bb237ee8\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"stud5p-task\" }\nconst _hoisted_2 = { style: {\"position\":\"relative\"} }\nconst _hoisted_3 = { class: \"feedback-and-button-container\" }\nconst _hoisted_4 = { class: \"feedback-container\" }\nconst _hoisted_5 = { class: \"feedback-text\" }\nconst _hoisted_6 = { class: \"button-panel\" }\nconst _hoisted_7 = [\"textContent\"]\n\nimport {\n  PropType,\n  computed,\n  provide,\n  ref,\n  watch,\n} from 'vue';\nimport { FindTheHotspotsTask } from '@/models/FindTheHotspotsTask';\nimport ImageWithHotspots from '@/components/findTheHotspots/ImageWithHotspots.vue';\nimport FeedbackElement from '@/components/FeedbackElement.vue';\nimport { findTheHotspotsViewerStateSymbol } from '@/components/findTheHotspots/findTheHotspotsViewerState';\n\ninterface Click {\n  x: number;\n  y: number;\n  hotspot: string;\n  correct: boolean;\n  feedback: string;\n}\n\n// State\n\nexport default /*#__PURE__*/_defineComponent({\n  props: {\n  task: {\n    type: Object as PropType<FindTheHotspotsTask>,\n    required: true,\n  },\n},\n  emits: ['updateAttempt'],\n  setup(__props) {\n\nconst props = __props\n\n\n\nprovide(findTheHotspotsViewerStateSymbol, {\n  clickHotspot,\n  clickBackground,\n});\n\nwatch(\n  () => props.task,\n  () => {\n    resetViewerState();\n  },\n  { deep: true }\n);\n\n\n\nconst clickHistory = ref<Click[]>([]);\nconst points = ref<number>(0);\nconst clicks = ref<number>(0);\nconst clickedHotspots = ref<string[]>([]);\n\n// Computed properties\nconst showResults = computed(() => clicks.value > 0);\n\nconst maxPoints = computed(() => {\n  if (props.task?.hotspotsToFind > 0) {\n    return props.task?.hotspotsToFind;\n  } else {\n    return props.task.hotspots.filter((hotspot) => hotspot.correct).length;\n  }\n});\n\nconst editable = computed(() =>\n  props.task.allowedClicks > 0\n    ? points.value < maxPoints.value && clicks.value < props.task?.allowedClicks\n    : points.value < maxPoints.value\n);\n\nconst resultMessage = computed(() => {\n  let result = props.task.strings.resultMessage.replace(\n    ':correct',\n    points.value.toString()\n  );\n  result = result.replace(':total', maxPoints.value.toString());\n\n  return result;\n});\n\nconst feedback = computed(() => {\n  // Returns the most recent click feedback\n  return clickHistory.value.at(-1)?.feedback;\n});\n\nconst showRetryButton = computed(() => {\n  return !editable.value;\n});\n\n// Functions\nfunction resetViewerState(): void {\n  points.value = 0;\n  clicks.value = 0;\n  clickedHotspots.value = [];\n  clickHistory.value = [];\n}\n\nfunction clickHotspot(id: string | undefined, x: number, y: number): void {\n  if (!editable.value) return;\n\n  console.log('Viewer: Clicked hotspot with id', id);\n  if (!id) {\n    console.error('No id for clicked hotspot.');\n    return;\n  }\n\n  const hotspot = props.task.hotspots.find((hotspot) => hotspot.uuid === id);\n  if (!hotspot) {\n    console.error('No hotspot for given id:', id);\n    return;\n  }\n\n  if (clickedHotspots.value.includes(id) && hotspot.correct) {\n    const index = clickHistory.value.findIndex((click) => click.hotspot === id);\n    if (index !== -1) {\n      const click = clickHistory.value[index];\n      click.x = x;\n      click.y = y;\n      click.feedback = props.task.strings.feedbackWhenClickingHotspotAgain;\n      clickHistory.value.splice(index, 1);\n      clickHistory.value.push(click);\n    }\n  } else {\n    clickedHotspots.value?.push(id);\n    clicks.value++;\n\n    if (hotspot.correct) {\n      points.value++;\n    }\n\n    const click = {\n      x: x,\n      y: y,\n      hotspot: id,\n      correct: hotspot.correct,\n      feedback: hotspot.feedback,\n    };\n    clickHistory.value.push(click);\n  }\n}\n\nfunction clickBackground(x: number, y: number): void {\n  if (!editable.value) return;\n  console.log('Viewer: Clicked background');\n  clicks.value++;\n\n  const click = {\n    x: x,\n    y: y,\n    hotspot: '',\n    correct: false,\n    feedback: props.task?.strings.feedbackWhenClickingBackground,\n  };\n  clickHistory.value.push(click);\n}\n\nfunction onClickRetry(): void {\n  resetViewerState();\n}\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createElementVNode(\"div\", _hoisted_2, [\n      _createVNode(ImageWithHotspots, {\n        hotspots: __props.task.hotspots,\n        image: __props.task.image\n      }, null, 8, [\"hotspots\", \"image\"]),\n      (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(clickHistory.value, (click, index) => {\n        return (_openBlock(), _createElementBlock(\"span\", {\n          key: `${click.x}-${click.y}`,\n          class: _normalizeClass([\"click-indicator\", {\n          pulse: index === clickHistory.value.length - 1,\n          correct: click.correct,\n          incorrect: !click.correct,\n        }]),\n          style: _normalizeStyle({\n          left: `${click.x - 16}px`,\n          top: `${click.y - 16}px`,\n        })\n        }, _toDisplayString(click.correct ? '' : ''), 7))\n      }), 128))\n    ]),\n    _createElementVNode(\"div\", _hoisted_3, [\n      _createElementVNode(\"div\", _hoisted_4, [\n        (_unref(showResults))\n          ? (_openBlock(), _createBlock(FeedbackElement, {\n              key: 0,\n              achievedPoints: points.value,\n              maxPoints: _unref(maxPoints),\n              \"result-message\": _unref(resultMessage)\n            }, null, 8, [\"achievedPoints\", \"maxPoints\", \"result-message\"]))\n          : _createCommentVNode(\"\", true),\n        _createElementVNode(\"div\", _hoisted_5, _toDisplayString(_unref(feedback)), 1)\n      ]),\n      _createElementVNode(\"div\", _hoisted_6, [\n        (_unref(showRetryButton))\n          ? (_openBlock(), _createElementBlock(\"button\", {\n              key: 0,\n              textContent: _toDisplayString(__props.task.strings.retryButton),\n              onClick: onClickRetry,\n              type: \"button\",\n              class: \"stud5p-button\"\n            }, null, 8, _hoisted_7))\n          : _createCommentVNode(\"\", true)\n      ])\n    ])\n  ]))\n}\n}\n\n})","<template>\n  <div class=\"stud5p-task\">\n    <div style=\"position: relative\">\n      <ImageWithHotspots :hotspots=\"task.hotspots\" :image=\"task.image\" />\n      <span\n        v-for=\"(click, index) in clickHistory\"\n        :key=\"`${click.x}-${click.y}`\"\n        class=\"click-indicator\"\n        :class=\"{\n          pulse: index === clickHistory.length - 1,\n          correct: click.correct,\n          incorrect: !click.correct,\n        }\"\n        :style=\"{\n          left: `${click.x - 16}px`,\n          top: `${click.y - 16}px`,\n        }\"\n      >\n        {{ click.correct ? '' : '' }}\n      </span>\n    </div>\n    <div class=\"feedback-and-button-container\">\n      <div class=\"feedback-container\">\n        <FeedbackElement\n          v-if=\"showResults\"\n          :achievedPoints=\"points\"\n          :maxPoints=\"maxPoints\"\n          :result-message=\"resultMessage\"\n        />\n        <div class=\"feedback-text\">{{ feedback }}</div>\n      </div>\n\n      <div class=\"button-panel\">\n        <button\n          v-if=\"showRetryButton\"\n          v-text=\"task.strings.retryButton\"\n          @click=\"onClickRetry\"\n          type=\"button\"\n          class=\"stud5p-button\"\n        />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport {\n  defineProps,\n  PropType,\n  computed,\n  provide,\n  ref,\n  defineEmits,\n  watch,\n} from 'vue';\nimport { FindTheHotspotsTask } from '@/models/FindTheHotspotsTask';\nimport ImageWithHotspots from '@/components/findTheHotspots/ImageWithHotspots.vue';\nimport FeedbackElement from '@/components/FeedbackElement.vue';\nimport { findTheHotspotsViewerStateSymbol } from '@/components/findTheHotspots/findTheHotspotsViewerState';\n\nconst props = defineProps({\n  task: {\n    type: Object as PropType<FindTheHotspotsTask>,\n    required: true,\n  },\n});\n\nprovide(findTheHotspotsViewerStateSymbol, {\n  clickHotspot,\n  clickBackground,\n});\n\nwatch(\n  () => props.task,\n  () => {\n    resetViewerState();\n  },\n  { deep: true }\n);\n\ndefineEmits(['updateAttempt']);\n\ninterface Click {\n  x: number;\n  y: number;\n  hotspot: string;\n  correct: boolean;\n  feedback: string;\n}\n\n// State\nconst clickHistory = ref<Click[]>([]);\nconst points = ref<number>(0);\nconst clicks = ref<number>(0);\nconst clickedHotspots = ref<string[]>([]);\n\n// Computed properties\nconst showResults = computed(() => clicks.value > 0);\n\nconst maxPoints = computed(() => {\n  if (props.task?.hotspotsToFind > 0) {\n    return props.task?.hotspotsToFind;\n  } else {\n    return props.task.hotspots.filter((hotspot) => hotspot.correct).length;\n  }\n});\n\nconst editable = computed(() =>\n  props.task.allowedClicks > 0\n    ? points.value < maxPoints.value && clicks.value < props.task?.allowedClicks\n    : points.value < maxPoints.value\n);\n\nconst resultMessage = computed(() => {\n  let result = props.task.strings.resultMessage.replace(\n    ':correct',\n    points.value.toString()\n  );\n  result = result.replace(':total', maxPoints.value.toString());\n\n  return result;\n});\n\nconst feedback = computed(() => {\n  // Returns the most recent click feedback\n  return clickHistory.value.at(-1)?.feedback;\n});\n\nconst showRetryButton = computed(() => {\n  return !editable.value;\n});\n\n// Functions\nfunction resetViewerState(): void {\n  points.value = 0;\n  clicks.value = 0;\n  clickedHotspots.value = [];\n  clickHistory.value = [];\n}\n\nfunction clickHotspot(id: string | undefined, x: number, y: number): void {\n  if (!editable.value) return;\n\n  console.log('Viewer: Clicked hotspot with id', id);\n  if (!id) {\n    console.error('No id for clicked hotspot.');\n    return;\n  }\n\n  const hotspot = props.task.hotspots.find((hotspot) => hotspot.uuid === id);\n  if (!hotspot) {\n    console.error('No hotspot for given id:', id);\n    return;\n  }\n\n  if (clickedHotspots.value.includes(id) && hotspot.correct) {\n    const index = clickHistory.value.findIndex((click) => click.hotspot === id);\n    if (index !== -1) {\n      const click = clickHistory.value[index];\n      click.x = x;\n      click.y = y;\n      click.feedback = props.task.strings.feedbackWhenClickingHotspotAgain;\n      clickHistory.value.splice(index, 1);\n      clickHistory.value.push(click);\n    }\n  } else {\n    clickedHotspots.value?.push(id);\n    clicks.value++;\n\n    if (hotspot.correct) {\n      points.value++;\n    }\n\n    const click = {\n      x: x,\n      y: y,\n      hotspot: id,\n      correct: hotspot.correct,\n      feedback: hotspot.feedback,\n    };\n    clickHistory.value.push(click);\n  }\n}\n\nfunction clickBackground(x: number, y: number): void {\n  if (!editable.value) return;\n  console.log('Viewer: Clicked background');\n  clicks.value++;\n\n  const click = {\n    x: x,\n    y: y,\n    hotspot: '',\n    correct: false,\n    feedback: props.task?.strings.feedbackWhenClickingBackground,\n  };\n  clickHistory.value.push(click);\n}\n\nfunction onClickRetry(): void {\n  resetViewerState();\n}\n</script>\n\n<style scoped>\n.click-indicator {\n  position: absolute;\n  cursor: default;\n\n  width: 32px;\n  height: 32px;\n  line-height: 32px;\n  font-size: 16px;\n  border-radius: 50%;\n  text-align: center;\n  pointer-events: none;\n\n  box-shadow: 0 0 0.25em 0 rgba(0, 0, 0, 0.5);\n\n  &.correct {\n    color: #39692e;\n    background: #d1e2ce;\n  }\n\n  &.incorrect {\n    color: #c33f62;\n    background: #e6ced1;\n  }\n}\n\n@keyframes pulse {\n  0% {\n    transform: scale(0);\n    opacity: 0;\n  }\n  50% {\n    transform: scale(1.2);\n  }\n  100% {\n    opacity: 1;\n    transform: scale(1);\n  }\n}\n\n.pulse {\n  animation: pulse 0.25s ease-in-out 0s 1;\n}\n\n.feedback-text {\n  font-size: 1.25em;\n  font-weight: bold;\n  color: #1a73d9;\n}\n\n.feedback-container {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  gap: 0.75em;\n}\n</style>\n","import script from \"./FindTheHotspotsViewer.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./FindTheHotspotsViewer.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./FindTheHotspotsViewer.vue?vue&type=style&index=0&id=bb237ee8&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-bb237ee8\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { unref as _unref, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, vModelText as _vModelText, withDirectives as _withDirectives, createTextVNode as _createTextVNode, vModelCheckbox as _vModelCheckbox, withModifiers as _withModifiers, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nconst _hoisted_1 = { class: \"stud5p-task\" }\nconst _hoisted_2 = [\"textContent\"]\nconst _hoisted_3 = [\"textContent\"]\nconst _hoisted_4 = { class: \"collapsable collapsed\" }\nconst _hoisted_5 = { class: \"collapsable collapsed\" }\nconst _hoisted_6 = { class: \"collapsable collapsed\" }\n\nimport { computed, inject, PropType, ref, watch } from 'vue';\nimport { FindTheWordsTask } from '@/models/TaskDefinition';\nimport { $gettext } from '@/language/gettext';\nimport {\n  TaskEditorState,\n  taskEditorStateSymbol,\n} from '@/components/taskEditorState';\nimport { cloneDeep } from 'lodash';\nimport produce from 'immer';\n\n\nexport default /*#__PURE__*/_defineComponent({\n  props: {\n  taskDefinition: {\n    type: Object as PropType<FindTheWordsTask>,\n    required: true,\n  },\n},\n  setup(__props) {\n\nconst props = __props\n\nconst taskEditor = inject<TaskEditorState>(taskEditorStateSymbol);\n\n\n\nconst debug = window.STUDIP.LernmoduleVueJS.LERNMODULE_DEBUG;\n\n// State\nconst modelTaskDefinition = ref<FindTheWordsTask>(\n  cloneDeep(props.taskDefinition)\n);\nconst wordsInputMessage = ref<string>('');\nconst userInput = ref<string>(modelTaskDefinition.value.words);\nconst lastValidInput = ref<string>(modelTaskDefinition.value.words);\nconst numbersInputMessage = ref<string>('');\n\nconst words = computed(() => {\n  if (props.taskDefinition?.words) {\n    return props.taskDefinition.words\n      .split(',')\n      .filter((word) => word.trim())\n      .map((word) => word.trim().toUpperCase());\n  }\n  return [];\n});\n\nwatch(\n  () => props.taskDefinition,\n  (newTaskDefinition, oldTaskDefinition) => {\n    modelTaskDefinition.value = cloneDeep(newTaskDefinition);\n  },\n  { deep: true }\n);\n\nfunction clearMessages(): void {\n  wordsInputMessage.value = '';\n  numbersInputMessage.value = '';\n}\n\nfunction onInputWords(words: string): void {\n  let wordArray = words\n    .split(',')\n    .filter((word) => word.trim())\n    .map((word) => word.trim().toUpperCase());\n\n  let longestWord = 0;\n  for (const word of wordArray) {\n    if (word.length > longestWord) {\n      longestWord = word.length;\n    }\n  }\n\n  const tooLongWord = longestWord > 20;\n  const tooManyWords = wordArray.length > 20;\n\n  if (tooLongWord) {\n    wordsInputMessage.value = $gettext(\n      'Wrter drfen nicht lnger als 20 Zeichen sein.'\n    );\n    userInput.value = lastValidInput.value;\n    return;\n  } else if (tooManyWords) {\n    wordsInputMessage.value = $gettext(\n      'Es drfen maximal 20 Wrter eingegeben werden.'\n    );\n    userInput.value = lastValidInput.value;\n    return;\n  } else {\n    wordsInputMessage.value = '';\n    lastValidInput.value = words;\n  }\n\n  modelTaskDefinition.value = produce(modelTaskDefinition.value, (draft) => {\n    draft.words = words;\n  });\n\n  if (longestWord > modelTaskDefinition.value.size) {\n    numbersInputMessage.value = '';\n    modelTaskDefinition.value = produce(modelTaskDefinition.value, (draft) => {\n      draft.size = longestWord;\n    });\n  }\n\n  // Synchronize state modelTaskDefinition -> taskDefinition.\n  console.log('update task definition');\n  taskEditor!.performEdit({\n    newTaskDefinition: cloneDeep(modelTaskDefinition.value),\n  });\n}\n\nfunction onInputSize(size: number): void {\n  let longestWord = 0;\n\n  for (const word of words.value) {\n    console.log(word, word.length);\n    if (word.length > longestWord) {\n      longestWord = word.length;\n    }\n  }\n\n  let num = Number(size);\n  if (num > 20) {\n    console.log(num);\n    num = 20;\n  }\n  if (num < longestWord) {\n    num = longestWord;\n    numbersInputMessage.value = $gettext(\n      'Minimum %{ characters } da ein Wort mit %{ characters } Zeichen existiert',\n      { characters: num.toString() }\n    );\n  } else {\n    numbersInputMessage.value = '';\n  }\n\n  modelTaskDefinition.value = produce(modelTaskDefinition.value, (draft) => {\n    draft.size = num;\n  });\n\n  updateTaskDefinition('size');\n}\n\nfunction onInputAlphabet(alphabet: string): void {\n  modelTaskDefinition.value = produce(modelTaskDefinition.value, (draft) => {\n    draft.alphabet = alphabet;\n  });\n\n  updateTaskDefinition('alphabet');\n}\n\nfunction resetAlphabet(): void {\n  modelTaskDefinition.value = produce(modelTaskDefinition.value, (draft) => {\n    draft.alphabet = 'abcdefghijklmnopqrstuvwxyz';\n  });\n\n  updateTaskDefinition();\n}\n\nfunction resetAlphabetToUsedLetters(): void {\n  modelTaskDefinition.value = produce(modelTaskDefinition.value, (draft) => {\n    draft.alphabet = Array.from(\n      new Set(draft.words.toLowerCase().replace(/[\\s,]/g, '').split(''))\n    ).join('');\n  });\n\n  updateTaskDefinition();\n}\n\nfunction updateTaskDefinition(undoBatch?: unknown): void {\n  // Synchronize state modelTaskDefinition -> taskDefinition.\n  console.log('update task definition');\n  taskEditor!.performEdit({\n    newTaskDefinition: cloneDeep(modelTaskDefinition.value),\n    undoBatch: undoBatch ?? {},\n  });\n}\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createElementVNode(\"form\", {\n      class: \"default\",\n      onSubmit: _cache[26] || (_cache[26] = _withModifiers(() => {}, [\"prevent\"]))\n    }, [\n      _createElementVNode(\"fieldset\", null, [\n        _createElementVNode(\"legend\", null, _toDisplayString(_unref($gettext)('Find the Words')), 1),\n        _createElementVNode(\"label\", null, [\n          _createTextVNode(_toDisplayString(_unref($gettext)('Zu findende Wrter:')) + \" \", 1),\n          _withDirectives(_createElementVNode(\"input\", {\n            \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((userInput).value = $event)),\n            onInput: _cache[1] || (_cache[1] = ($event: any) => (onInputWords($event.target.value))),\n            type: \"text\"\n          }, null, 544), [\n            [_vModelText, userInput.value]\n          ]),\n          _createElementVNode(\"p\", {\n            textContent: _toDisplayString(wordsInputMessage.value)\n          }, null, 8, _hoisted_2)\n        ]),\n        _createElementVNode(\"label\", null, [\n          _createTextVNode(_toDisplayString(_unref($gettext)('Feldgre:')) + \" \", 1),\n          _withDirectives(_createElementVNode(\"input\", {\n            \"onUpdate:modelValue\": _cache[2] || (_cache[2] = ($event: any) => ((modelTaskDefinition.value.size) = $event)),\n            onChange: _cache[3] || (_cache[3] = ($event: any) => (onInputSize($event.target.value))),\n            onBlur: _cache[4] || (_cache[4] = ($event: any) => (clearMessages())),\n            min: \"6\",\n            max: \"20\",\n            type: \"number\"\n          }, null, 544), [\n            [_vModelText, modelTaskDefinition.value.size]\n          ]),\n          _createElementVNode(\"p\", {\n            textContent: _toDisplayString(numbersInputMessage.value)\n          }, null, 8, _hoisted_3)\n        ]),\n        _createElementVNode(\"label\", null, [\n          _createTextVNode(_toDisplayString(_unref($gettext)('Zeichen, mit denen die Tafel aufgefllt wird:')) + \" \", 1),\n          _withDirectives(_createElementVNode(\"input\", {\n            \"onUpdate:modelValue\": _cache[5] || (_cache[5] = ($event: any) => ((modelTaskDefinition.value.alphabet) = $event)),\n            onInput: _cache[6] || (_cache[6] = ($event: any) => (onInputAlphabet($event.target.value))),\n            type: \"text\"\n          }, null, 544), [\n            [_vModelText, modelTaskDefinition.value.alphabet]\n          ]),\n          _createElementVNode(\"button\", {\n            type: \"button\",\n            class: \"button\",\n            style: {\"white-space\":\"normal\"},\n            onClick: resetAlphabet\n          }, _toDisplayString(_unref($gettext)('Zurcksetzen auf A - Z')), 1),\n          _createElementVNode(\"button\", {\n            type: \"button\",\n            class: \"button\",\n            style: {\"white-space\":\"normal\"},\n            onClick: resetAlphabetToUsedLetters\n          }, _toDisplayString(_unref($gettext)('Buchstaben der Lsungswrter')), 1)\n        ])\n      ]),\n      _createElementVNode(\"fieldset\", _hoisted_4, [\n        _createElementVNode(\"legend\", null, _toDisplayString(_unref($gettext)('Einstellungen')), 1),\n        _createElementVNode(\"label\", null, [\n          _withDirectives(_createElementVNode(\"input\", {\n            \"onUpdate:modelValue\": _cache[7] || (_cache[7] = ($event: any) => ((modelTaskDefinition.value.showWordList) = $event)),\n            onChange: updateTaskDefinition,\n            type: \"checkbox\"\n          }, null, 544), [\n            [_vModelCheckbox, modelTaskDefinition.value.showWordList]\n          ]),\n          _createTextVNode(\" \" + _toDisplayString(_unref($gettext)('Wortliste anzeigen')), 1)\n        ]),\n        _createElementVNode(\"fieldset\", null, [\n          _createElementVNode(\"legend\", null, _toDisplayString(_unref($gettext)('Wortrichtungen')), 1),\n          _createElementVNode(\"label\", null, [\n            _withDirectives(_createElementVNode(\"input\", {\n              \"onUpdate:modelValue\": _cache[8] || (_cache[8] = ($event: any) => ((modelTaskDefinition.value.directions.e) = $event)),\n              onChange: updateTaskDefinition,\n              type: \"checkbox\"\n            }, null, 544), [\n              [_vModelCheckbox, modelTaskDefinition.value.directions.e]\n            ]),\n            _createTextVNode(\" \" + _toDisplayString(_unref($gettext)('Horizontal nach rechts')), 1)\n          ]),\n          _createElementVNode(\"label\", null, [\n            _withDirectives(_createElementVNode(\"input\", {\n              \"onUpdate:modelValue\": _cache[9] || (_cache[9] = ($event: any) => ((modelTaskDefinition.value.directions.w) = $event)),\n              onChange: updateTaskDefinition,\n              type: \"checkbox\"\n            }, null, 544), [\n              [_vModelCheckbox, modelTaskDefinition.value.directions.w]\n            ]),\n            _createTextVNode(\" \" + _toDisplayString(_unref($gettext)('Horizontal nach links')), 1)\n          ]),\n          _createElementVNode(\"label\", null, [\n            _withDirectives(_createElementVNode(\"input\", {\n              \"onUpdate:modelValue\": _cache[10] || (_cache[10] = ($event: any) => ((modelTaskDefinition.value.directions.s) = $event)),\n              onChange: updateTaskDefinition,\n              type: \"checkbox\"\n            }, null, 544), [\n              [_vModelCheckbox, modelTaskDefinition.value.directions.s]\n            ]),\n            _createTextVNode(\" \" + _toDisplayString(_unref($gettext)('Vertikal nach unten')), 1)\n          ]),\n          _createElementVNode(\"label\", null, [\n            _withDirectives(_createElementVNode(\"input\", {\n              \"onUpdate:modelValue\": _cache[11] || (_cache[11] = ($event: any) => ((modelTaskDefinition.value.directions.n) = $event)),\n              onChange: updateTaskDefinition,\n              type: \"checkbox\"\n            }, null, 544), [\n              [_vModelCheckbox, modelTaskDefinition.value.directions.n]\n            ]),\n            _createTextVNode(\" \" + _toDisplayString(_unref($gettext)('Vertikal nach oben')), 1)\n          ]),\n          _createElementVNode(\"label\", null, [\n            _withDirectives(_createElementVNode(\"input\", {\n              \"onUpdate:modelValue\": _cache[12] || (_cache[12] = ($event: any) => ((modelTaskDefinition.value.directions.ne) = $event)),\n              onChange: updateTaskDefinition,\n              type: \"checkbox\"\n            }, null, 544), [\n              [_vModelCheckbox, modelTaskDefinition.value.directions.ne]\n            ]),\n            _createTextVNode(\" \" + _toDisplayString(_unref($gettext)('Diagonal nach oben rechts')), 1)\n          ]),\n          _createElementVNode(\"label\", null, [\n            _withDirectives(_createElementVNode(\"input\", {\n              \"onUpdate:modelValue\": _cache[13] || (_cache[13] = ($event: any) => ((modelTaskDefinition.value.directions.se) = $event)),\n              onChange: updateTaskDefinition,\n              type: \"checkbox\"\n            }, null, 544), [\n              [_vModelCheckbox, modelTaskDefinition.value.directions.se]\n            ]),\n            _createTextVNode(\" \" + _toDisplayString(_unref($gettext)('Diagonal nach unten rechts')), 1)\n          ]),\n          _createElementVNode(\"label\", null, [\n            _withDirectives(_createElementVNode(\"input\", {\n              \"onUpdate:modelValue\": _cache[14] || (_cache[14] = ($event: any) => ((modelTaskDefinition.value.directions.nw) = $event)),\n              onChange: updateTaskDefinition,\n              type: \"checkbox\"\n            }, null, 544), [\n              [_vModelCheckbox, modelTaskDefinition.value.directions.nw]\n            ]),\n            _createTextVNode(\" \" + _toDisplayString(_unref($gettext)('Diagonal nach oben links')), 1)\n          ]),\n          _createElementVNode(\"label\", null, [\n            _withDirectives(_createElementVNode(\"input\", {\n              \"onUpdate:modelValue\": _cache[15] || (_cache[15] = ($event: any) => ((modelTaskDefinition.value.directions.sw) = $event)),\n              onChange: updateTaskDefinition,\n              type: \"checkbox\"\n            }, null, 544), [\n              [_vModelCheckbox, modelTaskDefinition.value.directions.sw]\n            ]),\n            _createTextVNode(\" \" + _toDisplayString(_unref($gettext)('Diagonal nach unten links')), 1)\n          ])\n        ])\n      ]),\n      _createElementVNode(\"fieldset\", _hoisted_5, [\n        _createElementVNode(\"legend\", null, _toDisplayString(_unref($gettext)('Beschriftungen')), 1),\n        _createElementVNode(\"label\", null, [\n          _createTextVNode(_toDisplayString(_unref($gettext)('Titel der Wortliste:')) + \" \", 1),\n          _withDirectives(_createElementVNode(\"input\", {\n            \"onUpdate:modelValue\": _cache[16] || (_cache[16] = ($event: any) => ((modelTaskDefinition.value.strings.wordListTitle) = $event)),\n            onInput: _cache[17] || (_cache[17] = ($event: any) => (\n              updateTaskDefinition('taskDefinition.strings.wordListTitle')\n            )),\n            type: \"text\"\n          }, null, 544), [\n            [_vModelText, modelTaskDefinition.value.strings.wordListTitle]\n          ])\n        ]),\n        _createElementVNode(\"label\", null, [\n          _createTextVNode(_toDisplayString(_unref($gettext)('Text fr berprfen-Button:')) + \" \", 1),\n          _withDirectives(_createElementVNode(\"input\", {\n            \"onUpdate:modelValue\": _cache[18] || (_cache[18] = ($event: any) => ((modelTaskDefinition.value.strings.checkButton) = $event)),\n            onInput: _cache[19] || (_cache[19] = ($event: any) => (updateTaskDefinition('taskDefinition.strings.checkButton'))),\n            type: \"text\"\n          }, null, 544), [\n            [_vModelText, modelTaskDefinition.value.strings.checkButton]\n          ])\n        ]),\n        _createElementVNode(\"label\", null, [\n          _createTextVNode(_toDisplayString(_unref($gettext)('Text fr Wiederholen-Button:')) + \" \", 1),\n          _withDirectives(_createElementVNode(\"input\", {\n            \"onUpdate:modelValue\": _cache[20] || (_cache[20] = ($event: any) => ((modelTaskDefinition.value.strings.retryButton) = $event)),\n            onInput: _cache[21] || (_cache[21] = ($event: any) => (updateTaskDefinition('taskDefinition.strings.retryButton'))),\n            type: \"text\"\n          }, null, 544), [\n            [_vModelText, modelTaskDefinition.value.strings.retryButton]\n          ])\n        ]),\n        _createElementVNode(\"label\", null, [\n          _createTextVNode(_toDisplayString(_unref($gettext)('Text fr Zeitanzeige:')) + \" \", 1),\n          _withDirectives(_createElementVNode(\"input\", {\n            \"onUpdate:modelValue\": _cache[22] || (_cache[22] = ($event: any) => ((modelTaskDefinition.value.strings.timer) = $event)),\n            onInput: _cache[23] || (_cache[23] = ($event: any) => (updateTaskDefinition('taskDefinition.strings.timer'))),\n            type: \"text\"\n          }, null, 544), [\n            [_vModelText, modelTaskDefinition.value.strings.timer]\n          ])\n        ])\n      ]),\n      _createElementVNode(\"fieldset\", _hoisted_6, [\n        _createElementVNode(\"legend\", null, _toDisplayString(_unref($gettext)('Feedback')), 1),\n        _createElementVNode(\"label\", null, [\n          _createTextVNode(_toDisplayString(_unref($gettext)(\n              'Ergebnismitteilung (mgliche Variablen :correct und :total):'\n            )) + \" \", 1),\n          _withDirectives(_createElementVNode(\"input\", {\n            type: \"text\",\n            \"onUpdate:modelValue\": _cache[24] || (_cache[24] = ($event: any) => ((modelTaskDefinition.value.strings.resultMessage) = $event)),\n            onInput: _cache[25] || (_cache[25] = ($event: any) => (\n              updateTaskDefinition('taskDefinition.strings.resultMessage')\n            ))\n          }, null, 544), [\n            [_vModelText, modelTaskDefinition.value.strings.resultMessage]\n          ])\n        ])\n      ])\n    ], 32)\n  ]))\n}\n}\n\n})","<template>\n  <div class=\"stud5p-task\">\n    <form class=\"default\" @submit.prevent>\n      <fieldset>\n        <legend>{{ $gettext('Find the Words') }}</legend>\n        <label>\n          {{ $gettext('Zu findende Wrter:') }}\n          <input\n            v-model=\"userInput\"\n            @input=\"onInputWords($event.target.value)\"\n            type=\"text\"\n          />\n          <p v-text=\"wordsInputMessage\" />\n        </label>\n        <label>\n          {{ $gettext('Feldgre:') }}\n          <input\n            v-model=\"modelTaskDefinition.size\"\n            @change=\"onInputSize($event.target.value)\"\n            @blur=\"clearMessages()\"\n            min=\"6\"\n            max=\"20\"\n            type=\"number\"\n          />\n          <p v-text=\"numbersInputMessage\" />\n        </label>\n        <label>\n          {{ $gettext('Zeichen, mit denen die Tafel aufgefllt wird:') }}\n          <input\n            v-model=\"modelTaskDefinition.alphabet\"\n            @input=\"onInputAlphabet($event.target.value)\"\n            type=\"text\"\n          />\n          <button\n            type=\"button\"\n            class=\"button\"\n            style=\"white-space: normal\"\n            @click=\"resetAlphabet\"\n          >\n            {{ $gettext('Zurcksetzen auf A - Z') }}\n          </button>\n          <button\n            type=\"button\"\n            class=\"button\"\n            style=\"white-space: normal\"\n            @click=\"resetAlphabetToUsedLetters\"\n          >\n            {{ $gettext('Buchstaben der Lsungswrter') }}\n          </button>\n        </label>\n      </fieldset>\n\n      <fieldset class=\"collapsable collapsed\">\n        <legend>{{ $gettext('Einstellungen') }}</legend>\n\n        <label>\n          <input\n            v-model=\"modelTaskDefinition.showWordList\"\n            @change=\"updateTaskDefinition\"\n            type=\"checkbox\"\n          />\n          {{ $gettext('Wortliste anzeigen') }}\n        </label>\n\n        <fieldset>\n          <legend>{{ $gettext('Wortrichtungen') }}</legend>\n          <label>\n            <input\n              v-model=\"modelTaskDefinition.directions.e\"\n              @change=\"updateTaskDefinition\"\n              type=\"checkbox\"\n            />\n            {{ $gettext('Horizontal nach rechts') }}\n          </label>\n\n          <label>\n            <input\n              v-model=\"modelTaskDefinition.directions.w\"\n              @change=\"updateTaskDefinition\"\n              type=\"checkbox\"\n            />\n            {{ $gettext('Horizontal nach links') }}\n          </label>\n\n          <label>\n            <input\n              v-model=\"modelTaskDefinition.directions.s\"\n              @change=\"updateTaskDefinition\"\n              type=\"checkbox\"\n            />\n            {{ $gettext('Vertikal nach unten') }}\n          </label>\n\n          <label>\n            <input\n              v-model=\"modelTaskDefinition.directions.n\"\n              @change=\"updateTaskDefinition\"\n              type=\"checkbox\"\n            />\n            {{ $gettext('Vertikal nach oben') }}\n          </label>\n\n          <label>\n            <input\n              v-model=\"modelTaskDefinition.directions.ne\"\n              @change=\"updateTaskDefinition\"\n              type=\"checkbox\"\n            />\n            {{ $gettext('Diagonal nach oben rechts') }}\n          </label>\n\n          <label>\n            <input\n              v-model=\"modelTaskDefinition.directions.se\"\n              @change=\"updateTaskDefinition\"\n              type=\"checkbox\"\n            />\n            {{ $gettext('Diagonal nach unten rechts') }}\n          </label>\n\n          <label>\n            <input\n              v-model=\"modelTaskDefinition.directions.nw\"\n              @change=\"updateTaskDefinition\"\n              type=\"checkbox\"\n            />\n            {{ $gettext('Diagonal nach oben links') }}\n          </label>\n\n          <label>\n            <input\n              v-model=\"modelTaskDefinition.directions.sw\"\n              @change=\"updateTaskDefinition\"\n              type=\"checkbox\"\n            />\n            {{ $gettext('Diagonal nach unten links') }}\n          </label>\n        </fieldset>\n      </fieldset>\n\n      <fieldset class=\"collapsable collapsed\">\n        <legend>{{ $gettext('Beschriftungen') }}</legend>\n\n        <label>\n          {{ $gettext('Titel der Wortliste:') }}\n          <input\n            v-model=\"modelTaskDefinition.strings.wordListTitle\"\n            @input=\"\n              updateTaskDefinition('taskDefinition.strings.wordListTitle')\n            \"\n            type=\"text\"\n          />\n        </label>\n\n        <label>\n          {{ $gettext('Text fr berprfen-Button:') }}\n          <input\n            v-model=\"modelTaskDefinition.strings.checkButton\"\n            @input=\"updateTaskDefinition('taskDefinition.strings.checkButton')\"\n            type=\"text\"\n          />\n        </label>\n\n        <label>\n          {{ $gettext('Text fr Wiederholen-Button:') }}\n          <input\n            v-model=\"modelTaskDefinition.strings.retryButton\"\n            @input=\"updateTaskDefinition('taskDefinition.strings.retryButton')\"\n            type=\"text\"\n          />\n        </label>\n\n        <label>\n          {{ $gettext('Text fr Zeitanzeige:') }}\n          <input\n            v-model=\"modelTaskDefinition.strings.timer\"\n            @input=\"updateTaskDefinition('taskDefinition.strings.timer')\"\n            type=\"text\"\n          />\n        </label>\n      </fieldset>\n\n      <fieldset class=\"collapsable collapsed\">\n        <legend>{{ $gettext('Feedback') }}</legend>\n        <label>\n          {{\n            $gettext(\n              'Ergebnismitteilung (mgliche Variablen :correct und :total):'\n            )\n          }}\n          <input\n            type=\"text\"\n            v-model=\"modelTaskDefinition.strings.resultMessage\"\n            @input=\"\n              updateTaskDefinition('taskDefinition.strings.resultMessage')\n            \"\n          />\n        </label>\n      </fieldset>\n    </form>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed, defineProps, inject, PropType, ref, watch } from 'vue';\nimport { FindTheWordsTask } from '@/models/TaskDefinition';\nimport { $gettext } from '@/language/gettext';\nimport {\n  TaskEditorState,\n  taskEditorStateSymbol,\n} from '@/components/taskEditorState';\nimport { cloneDeep } from 'lodash';\nimport produce from 'immer';\n\nconst taskEditor = inject<TaskEditorState>(taskEditorStateSymbol);\n\nconst props = defineProps({\n  taskDefinition: {\n    type: Object as PropType<FindTheWordsTask>,\n    required: true,\n  },\n});\n\nconst debug = window.STUDIP.LernmoduleVueJS.LERNMODULE_DEBUG;\n\n// State\nconst modelTaskDefinition = ref<FindTheWordsTask>(\n  cloneDeep(props.taskDefinition)\n);\nconst wordsInputMessage = ref<string>('');\nconst userInput = ref<string>(modelTaskDefinition.value.words);\nconst lastValidInput = ref<string>(modelTaskDefinition.value.words);\nconst numbersInputMessage = ref<string>('');\n\nconst words = computed(() => {\n  if (props.taskDefinition?.words) {\n    return props.taskDefinition.words\n      .split(',')\n      .filter((word) => word.trim())\n      .map((word) => word.trim().toUpperCase());\n  }\n  return [];\n});\n\nwatch(\n  () => props.taskDefinition,\n  (newTaskDefinition, oldTaskDefinition) => {\n    modelTaskDefinition.value = cloneDeep(newTaskDefinition);\n  },\n  { deep: true }\n);\n\nfunction clearMessages(): void {\n  wordsInputMessage.value = '';\n  numbersInputMessage.value = '';\n}\n\nfunction onInputWords(words: string): void {\n  let wordArray = words\n    .split(',')\n    .filter((word) => word.trim())\n    .map((word) => word.trim().toUpperCase());\n\n  let longestWord = 0;\n  for (const word of wordArray) {\n    if (word.length > longestWord) {\n      longestWord = word.length;\n    }\n  }\n\n  const tooLongWord = longestWord > 20;\n  const tooManyWords = wordArray.length > 20;\n\n  if (tooLongWord) {\n    wordsInputMessage.value = $gettext(\n      'Wrter drfen nicht lnger als 20 Zeichen sein.'\n    );\n    userInput.value = lastValidInput.value;\n    return;\n  } else if (tooManyWords) {\n    wordsInputMessage.value = $gettext(\n      'Es drfen maximal 20 Wrter eingegeben werden.'\n    );\n    userInput.value = lastValidInput.value;\n    return;\n  } else {\n    wordsInputMessage.value = '';\n    lastValidInput.value = words;\n  }\n\n  modelTaskDefinition.value = produce(modelTaskDefinition.value, (draft) => {\n    draft.words = words;\n  });\n\n  if (longestWord > modelTaskDefinition.value.size) {\n    numbersInputMessage.value = '';\n    modelTaskDefinition.value = produce(modelTaskDefinition.value, (draft) => {\n      draft.size = longestWord;\n    });\n  }\n\n  // Synchronize state modelTaskDefinition -> taskDefinition.\n  console.log('update task definition');\n  taskEditor!.performEdit({\n    newTaskDefinition: cloneDeep(modelTaskDefinition.value),\n  });\n}\n\nfunction onInputSize(size: number): void {\n  let longestWord = 0;\n\n  for (const word of words.value) {\n    console.log(word, word.length);\n    if (word.length > longestWord) {\n      longestWord = word.length;\n    }\n  }\n\n  let num = Number(size);\n  if (num > 20) {\n    console.log(num);\n    num = 20;\n  }\n  if (num < longestWord) {\n    num = longestWord;\n    numbersInputMessage.value = $gettext(\n      'Minimum %{ characters } da ein Wort mit %{ characters } Zeichen existiert',\n      { characters: num.toString() }\n    );\n  } else {\n    numbersInputMessage.value = '';\n  }\n\n  modelTaskDefinition.value = produce(modelTaskDefinition.value, (draft) => {\n    draft.size = num;\n  });\n\n  updateTaskDefinition('size');\n}\n\nfunction onInputAlphabet(alphabet: string): void {\n  modelTaskDefinition.value = produce(modelTaskDefinition.value, (draft) => {\n    draft.alphabet = alphabet;\n  });\n\n  updateTaskDefinition('alphabet');\n}\n\nfunction resetAlphabet(): void {\n  modelTaskDefinition.value = produce(modelTaskDefinition.value, (draft) => {\n    draft.alphabet = 'abcdefghijklmnopqrstuvwxyz';\n  });\n\n  updateTaskDefinition();\n}\n\nfunction resetAlphabetToUsedLetters(): void {\n  modelTaskDefinition.value = produce(modelTaskDefinition.value, (draft) => {\n    draft.alphabet = Array.from(\n      new Set(draft.words.toLowerCase().replace(/[\\s,]/g, '').split(''))\n    ).join('');\n  });\n\n  updateTaskDefinition();\n}\n\nfunction updateTaskDefinition(undoBatch?: unknown): void {\n  // Synchronize state modelTaskDefinition -> taskDefinition.\n  console.log('update task definition');\n  taskEditor!.performEdit({\n    newTaskDefinition: cloneDeep(modelTaskDefinition.value),\n    undoBatch: undoBatch ?? {},\n  });\n}\n</script>\n\n<style scoped></style>\n","import script from \"./FindTheWordsEditor.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./FindTheWordsEditor.vue?vue&type=script&setup=true&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { unref as _unref, withModifiers as _withModifiers, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, normalizeClass as _normalizeClass, createCommentVNode as _createCommentVNode, createBlock as _createBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-93149c48\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"stud5p-task\" }\nconst _hoisted_2 = { class: \"canvas-and-word-list-container\" }\nconst _hoisted_3 = [\"width\", \"height\"]\nconst _hoisted_4 = {\n  key: 0,\n  class: \"word-list\"\n}\nconst _hoisted_5 = [\"textContent\"]\nconst _hoisted_6 = [\"title\"]\nconst _hoisted_7 = { class: \"time-container\" }\nconst _hoisted_8 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"span\", null, \"\", -1))\nconst _hoisted_9 = [\"textContent\"]\nconst _hoisted_10 = [\"textContent\"]\nconst _hoisted_11 = { class: \"feedback-and-button-container\" }\nconst _hoisted_12 = { class: \"feedback-container\" }\nconst _hoisted_13 = { class: \"button-panel\" }\nconst _hoisted_14 = [\"textContent\"]\nconst _hoisted_15 = [\"textContent\"]\nconst _hoisted_16 = [\"textContent\"]\nconst _hoisted_17 = { key: 1 }\n\nimport {\n  computed,\n  onBeforeUnmount,\n  onMounted,\n  PropType,\n  ref,\n  watch,\n} from 'vue';\nimport FeedbackElement from '@/components/FeedbackElement.vue';\nimport { FindTheWordsTask } from '@/models/TaskDefinition';\nimport { v4 } from 'uuid';\nimport { $gettext } from '@/language/gettext';\n\ntype Direction =\n  | 'left'\n  | 'right'\n  | 'up'\n  | 'down'\n  | 'up-left'\n  | 'up-right'\n  | 'down-left'\n  | 'down-right'\n  | undefined;\n\ntype DragState =\n  | {\n      dragId: string;\n      startCell: [number, number];\n      currentCell: [number, number];\n      direction: Direction;\n    }\n  | undefined;\n\n// Props\n\nexport default /*#__PURE__*/_defineComponent({\n  props: {\n  task: {\n    type: Object as PropType<FindTheWordsTask>,\n    required: true,\n  },\n},\n  setup(__props) {\n\nconst props = __props\n\nconst WordSearch = require('@blex41/word-search');\n\n// Types\n\n\n// Refs\nconst canvasRef = ref<HTMLCanvasElement | null>(null);\n\n// State\nlet grid: string[][] = [];\nlet selectedCells: boolean[][] = [];\nlet correctCells: boolean[][] = [];\nlet solutionCoordinates: { x: number; y: number }[] = [];\nconst foundWords = ref<string[]>([]);\nconst dragState = ref<DragState>();\nconst taskSubmitted = ref<boolean>(false);\nconst showSolutions = ref<boolean>(false);\nconst timer = ref<number>(0); // Track elapsed time in seconds\nlet timerStarted: boolean = false; // Flag to check if timer has started\nlet timerInterval: number | null = null; // Store interval ID to control timer\n\n// Lifecycle Hooks\nonMounted(() => {\n  initializeGrid();\n  drawGrid();\n  document.addEventListener('pointerdown', onPointerdownOutsideCanvas);\n  document.addEventListener('pointerup', onPointerupOutsideCanvas);\n});\n\nonBeforeUnmount(() => {\n  document.removeEventListener('pointerdown', onPointerdownOutsideCanvas);\n  document.removeEventListener('pointerup', onPointerupOutsideCanvas);\n});\n\n// Computed properties\nconst gridSize = computed(() => {\n  return props.task?.size;\n});\n\nconst cellSize = computed(() => {\n  return 42;\n});\n\nconst canvasSize = computed(() => {\n  return gridSize.value * cellSize.value;\n});\n\nconst words = computed(() => {\n  if (props.task?.words) {\n    return props.task.words\n      .split(',')\n      .filter((word) => word.trim())\n      .map((word) => word.trim().toUpperCase());\n  }\n  return [];\n});\n\nconst disabledDirections = computed(() => {\n  let result = [];\n  if (props.task?.directions) {\n    if (!props.task.directions.n) result.push('N');\n    if (!props.task.directions.ne) result.push('NE');\n    if (!props.task.directions.e) result.push('E');\n    if (!props.task.directions.se) result.push('SE');\n    if (!props.task.directions.s) result.push('S');\n    if (!props.task.directions.sw) result.push('SW');\n    if (!props.task.directions.w) result.push('W');\n    if (!props.task.directions.nw) result.push('NW');\n  }\n  return result;\n});\n\nconst alphabet = computed(() => {\n  if (props.task?.alphabet) {\n    return props.task.alphabet\n      .toUpperCase()\n      .split('')\n      .filter((char) => char.match(/[0-9\\p{L}]/u));\n  }\n  return [];\n});\n\nconst score = computed(() => {\n  return foundWords.value.length;\n});\n\nconst maxScore = computed(() => {\n  return words.value.length;\n});\n\nconst taskCompleted = computed(() => {\n  return score.value === maxScore.value || taskSubmitted.value;\n});\n\nconst resultMessage = computed(() => {\n  let result = props.task.strings.resultMessage.replace(\n    ':correct',\n    score.value.toString()\n  );\n  result = result.replace(':total', maxScore.value.toString());\n\n  return result;\n});\n\nconst showCheckButton = computed(() => {\n  return !taskCompleted.value;\n});\n\n// Watchers\nwatch(\n  () => props.task,\n  () => {\n    initializeGrid();\n    drawGrid();\n  },\n  { deep: true }\n);\n\nwatch(\n  () => taskCompleted.value,\n  (newValue) => {\n    if (newValue) {\n      stopTimer();\n    }\n  }\n);\n\n// Functions\nfunction startTimer(): void {\n  timerStarted = true;\n\n  // Start a timer that increments every second\n  timerInterval = setInterval(() => {\n    timer.value++;\n  }, 1000) as unknown as number;\n}\n\nfunction stopTimer(): void {\n  // Stop the timer and clear the interval\n  if (timerInterval !== null) {\n    clearInterval(timerInterval);\n    timerInterval = null; // Reset after clearing\n  }\n\n  timerStarted = false;\n}\n\nfunction onClickCheck(): void {\n  taskSubmitted.value = true;\n  stopTimer();\n}\n\nfunction onClickRetry(): void {\n  taskSubmitted.value = false;\n  showSolutions.value = false;\n  timer.value = 0;\n  solutionCoordinates = [];\n  stopTimer();\n  initializeGrid();\n  drawGrid();\n}\n\nfunction onClickShowSolutions(): void {\n  showSolutions.value = true;\n  drawGrid();\n}\n\nfunction randomLetter() {\n  if (alphabet.value.length > 0) {\n    const randomIndex = Math.floor(Math.random() * alphabet.value.length);\n    return alphabet.value[randomIndex];\n  }\n  return '';\n}\n\nfunction resetSelectedCells() {\n  selectedCells = [];\n  for (let x = 0; x < gridSize.value; x++) {\n    selectedCells[x] = [];\n    for (let y = 0; y < gridSize.value; y++) {\n      selectedCells[x][y] = false;\n    }\n  }\n}\n\nfunction resetCorrectCells() {\n  correctCells = [];\n  for (let x = 0; x < gridSize.value; x++) {\n    correctCells[x] = [];\n    for (let y = 0; y < gridSize.value; y++) {\n      correctCells[x][y] = false;\n    }\n  }\n}\n\nfunction initializeGrid() {\n  resetSelectedCells();\n  resetCorrectCells();\n  foundWords.value = [];\n  solutionCoordinates = [];\n\n  // Create a new puzzle with the WordSearch library\n  const options = {\n    cols: gridSize.value,\n    rows: gridSize.value,\n    disabledDirections: disabledDirections.value,\n    dictionary: words.value,\n    maxWords: words.value.length,\n    backwardsProbability: 0.3,\n    upperCase: true,\n    diacritics: true,\n  };\n\n  let ws = new WordSearch(options);\n\n  // Retry up to 10 times if the library wasn't able to place all words of the task in the grid\n  let count = 1;\n  while (ws.words.length !== words.value.length && count <= 10) {\n    console.log(\n      'Es konnten nicht alle Wrter untergebracht werden. Versuche es bis zu 10 mal erneut:',\n      count + '. Versuch'\n    );\n    ws = new WordSearch(options);\n    count++;\n  }\n\n  // Save the coordinates of the placed words\n  ws.words.forEach((word: any) => {\n    solutionCoordinates.push(...word.path);\n  });\n\n  // Fill the grid with the placed words and random letters for unused cells\n  grid = [];\n  for (let x = 0; x < gridSize.value; x++) {\n    grid[x] = [];\n    for (let y = 0; y < gridSize.value; y++) {\n      if (solutionCoordinates.some((coord) => coord.x === x && coord.y === y)) {\n        grid[x][y] = ws.grid[y][x];\n      } else {\n        grid[x][y] = randomLetter();\n      }\n    }\n  }\n}\n\nfunction drawGrid() {\n  const canvas = canvasRef.value;\n  if (!canvas) {\n    console.error('No Canvas');\n    return;\n  }\n  const ctx = canvas.getContext('2d');\n  if (ctx) {\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n    ctx.font = 'bold 26px calibri';\n    ctx.textAlign = 'center';\n    ctx.textBaseline = 'middle';\n    for (let x = 0; x < gridSize.value; x++) {\n      for (let y = 0; y < gridSize.value; y++) {\n        if (correctCells[x][y]) {\n          fillCell(x, y, '#d4f6e6');\n        }\n        if (!showSolutions.value && selectedCells[x][y]) {\n          fillCell(x, y, 'rgba(140, 180, 255, 0.34)');\n        }\n        if (\n          showSolutions.value &&\n          solutionCoordinates.some((coord) => coord.x === x && coord.y === y) &&\n          !correctCells[x][y]\n        ) {\n          fillCell(x, y, 'rgba(140, 180, 255, 0.34)');\n        }\n        ctx.strokeStyle = 'gainsboro';\n        ctx.strokeRect(\n          x * cellSize.value,\n          y * cellSize.value,\n          cellSize.value,\n          cellSize.value\n        );\n        ctx.fillStyle = '#404040';\n        ctx.fillText(\n          grid[x][y],\n          x * cellSize.value + cellSize.value / 2,\n          y * cellSize.value + cellSize.value / 2\n        );\n      }\n    }\n  }\n}\n\nfunction onPointerdownCanvas(event: PointerEvent) {\n  if (taskCompleted.value) return;\n\n  if (!timerStarted) {\n    console.log('Starting timer');\n    startTimer();\n  }\n\n  if (!dragState.value) {\n    // Start selection\n    const { cellX, cellY } = getCellUnderCursor(event);\n\n    dragState.value = {\n      dragId: v4(),\n      startCell: [cellX, cellY],\n      currentCell: [cellX, cellY],\n      direction: undefined,\n    };\n\n    resetSelectedCells();\n    selectedCells[cellX][cellY] = true;\n    drawGrid();\n  } else {\n    // We are already selecting with the two-clicks selection method and this\n    // is the second click, so we end the selection\n    endSelection();\n  }\n}\n\nfunction getCellUnderCursor(event: PointerEvent) {\n  const canvas = document.getElementById('c') as HTMLCanvasElement;\n  const rect = canvas.getBoundingClientRect();\n  const x = event.clientX - rect.left;\n  const y = event.clientY - rect.top;\n  const cellX = Math.max(\n    0,\n    Math.min(Math.floor(x / cellSize.value), gridSize.value - 1)\n  );\n  const cellY = Math.max(\n    0,\n    Math.min(Math.floor(y / cellSize.value), gridSize.value - 1)\n  );\n  return { cellX, cellY };\n}\n\nfunction onPointermoveCanvas(event: PointerEvent) {\n  if (dragState.value) {\n    const { cellX, cellY } = getCellUnderCursor(event);\n\n    const direction = getDirection(\n      dragState.value.startCell[0],\n      dragState.value.startCell[1],\n      cellX,\n      cellY\n    );\n\n    resetSelectedCells();\n\n    selectedCells[dragState.value.startCell[0]][dragState.value.startCell[1]] =\n      true;\n\n    if (direction === 'left') {\n      for (\n        let xCoordinate = dragState.value.startCell[0];\n        xCoordinate >= cellX;\n        xCoordinate--\n      ) {\n        selectedCells[xCoordinate][dragState.value.startCell[1]] = true;\n      }\n    } else if (direction === 'right') {\n      for (\n        let xCoordinate = dragState.value.startCell[0];\n        xCoordinate <= cellX;\n        xCoordinate++\n      ) {\n        selectedCells[xCoordinate][dragState.value.startCell[1]] = true;\n      }\n    } else if (direction === 'up') {\n      for (\n        let yCoordinate = dragState.value.startCell[1];\n        yCoordinate >= cellY;\n        yCoordinate--\n      ) {\n        selectedCells[dragState.value.startCell[0]][yCoordinate] = true;\n      }\n    } else if (direction === 'down') {\n      for (\n        let yCoordinate = dragState.value.startCell[1];\n        yCoordinate <= cellY;\n        yCoordinate++\n      ) {\n        selectedCells[dragState.value.startCell[0]][yCoordinate] = true;\n      }\n    } else if (direction === 'up-right') {\n      for (\n        let yCoordinate = dragState.value.startCell[1];\n        yCoordinate >= cellY;\n        yCoordinate--\n      ) {\n        const xCoordinate =\n          dragState.value.startCell[0] -\n          (yCoordinate - dragState.value.startCell[1]);\n        if (coordinatesAreValid(xCoordinate, yCoordinate)) {\n          selectedCells[xCoordinate][yCoordinate] = true;\n        }\n      }\n    } else if (direction === 'up-left') {\n      for (\n        let yCoordinate = dragState.value.startCell[1];\n        yCoordinate >= cellY;\n        yCoordinate--\n      ) {\n        const xCoordinate =\n          dragState.value.startCell[0] +\n          (yCoordinate - dragState.value.startCell[1]);\n        if (coordinatesAreValid(xCoordinate, yCoordinate)) {\n          selectedCells[xCoordinate][yCoordinate] = true;\n        }\n      }\n    } else if (direction === 'down-left') {\n      for (\n        let yCoordinate = dragState.value.startCell[1];\n        yCoordinate <= cellY;\n        yCoordinate++\n      ) {\n        const xCoordinate =\n          dragState.value.startCell[0] -\n          (yCoordinate - dragState.value.startCell[1]);\n        if (coordinatesAreValid(xCoordinate, yCoordinate)) {\n          selectedCells[xCoordinate][yCoordinate] = true;\n        }\n      }\n    } else if (direction === 'down-right') {\n      for (\n        let yCoordinate = dragState.value.startCell[1];\n        yCoordinate <= cellY;\n        yCoordinate++\n      ) {\n        const xCoordinate =\n          dragState.value.startCell[0] +\n          (yCoordinate - dragState.value.startCell[1]);\n        if (coordinatesAreValid(xCoordinate, yCoordinate)) {\n          selectedCells[xCoordinate][yCoordinate] = true;\n        }\n      }\n    }\n\n    dragState.value = {\n      dragId: dragState.value.dragId,\n      startCell: dragState.value.startCell,\n      currentCell: [cellX, cellY],\n      direction: direction,\n    };\n\n    drawGrid();\n  }\n}\n\nfunction onPointerupCanvas(event: PointerEvent) {\n  if (dragState.value) {\n    const { cellX, cellY } = getCellUnderCursor(event);\n\n    if (\n      dragState.value.startCell[0] != cellX ||\n      dragState.value.startCell[1] != cellY\n    ) {\n      // Moved the cursor to another cell before releasing, so we use click-and-hold selection and end the selection\n      endSelection();\n    }\n  }\n}\n\nfunction onPointerdownOutsideCanvas(event: PointerEvent) {\n  if (dragState.value) {\n    endSelection();\n  }\n}\n\nfunction onPointerupOutsideCanvas(event: PointerEvent) {\n  if (dragState.value) {\n    endSelection();\n  }\n}\n\nfunction endSelection() {\n  const selectedWord = getSelectedWord();\n  const reversedSelectedWord = selectedWord.split('').reverse().join('');\n  console.log('Selected:', selectedWord, reversedSelectedWord);\n\n  const isWordFound =\n    words.value.includes(selectedWord) ||\n    words.value.includes(reversedSelectedWord);\n\n  if (isWordFound) markSelectedWordCorrect();\n\n  const isNewWord =\n    !foundWords.value.includes(selectedWord) &&\n    !foundWords.value.includes(reversedSelectedWord);\n\n  if (isWordFound && isNewWord) {\n    if (words.value.includes(selectedWord)) {\n      console.log('Found:', selectedWord);\n      foundWords.value.push(selectedWord);\n    } else {\n      console.log('Found:', reversedSelectedWord);\n      foundWords.value.push(reversedSelectedWord);\n    }\n  }\n\n  dragState.value = undefined;\n  drawGrid();\n}\n\nfunction coordinatesAreValid(x: number, y: number): boolean {\n  return !(x < 0 || x >= gridSize.value || y < 0 || y >= gridSize.value);\n}\n\nfunction getSelectedWord(): string {\n  let selectedWord = '';\n\n  const startCell = dragState.value?.startCell;\n  const endCell = dragState.value?.currentCell;\n  const direction = dragState.value?.direction;\n\n  if (startCell && endCell) {\n    if (direction === 'left') {\n      for (let x = startCell[0]; x >= endCell[0]; x--) {\n        selectedWord += grid[x][startCell[1]];\n      }\n    } else if (direction === 'right') {\n      for (let x = startCell[0]; x <= endCell[0]; x++) {\n        selectedWord += grid[x][startCell[1]];\n      }\n    } else if (direction === 'up') {\n      for (let y = startCell[1]; y >= endCell[1]; y--) {\n        selectedWord += grid[startCell[0]][y];\n      }\n    } else if (direction === 'down') {\n      for (let y = startCell[1]; y <= endCell[1]; y++) {\n        selectedWord += grid[startCell[0]][y];\n      }\n    } else if (direction === 'up-left') {\n      for (let i = 0; i <= startCell[1] - endCell[1]; i++) {\n        const x = startCell[0] - i;\n        const y = startCell[1] - i;\n        if (coordinatesAreValid(x, y)) {\n          selectedWord += grid[x][y];\n        } else {\n          break;\n        }\n      }\n    } else if (direction === 'up-right') {\n      for (let i = 0; i <= startCell[1] - endCell[1]; i++) {\n        const x = startCell[0] + i;\n        const y = startCell[1] - i;\n        if (coordinatesAreValid(x, y)) {\n          selectedWord += grid[x][y];\n        } else {\n          break;\n        }\n      }\n    } else if (direction === 'down-left') {\n      for (let i = 0; i <= endCell[1] - startCell[1]; i++) {\n        const x = startCell[0] - i;\n        const y = startCell[1] + i;\n        if (coordinatesAreValid(x, y)) {\n          selectedWord += grid[x][y];\n        } else {\n          break;\n        }\n      }\n    } else if (direction === 'down-right') {\n      for (let i = 0; i <= endCell[1] - startCell[1]; i++) {\n        const x = startCell[0] + i;\n        const y = startCell[1] + i;\n        if (coordinatesAreValid(x, y)) {\n          selectedWord += grid[x][y];\n        } else {\n          break;\n        }\n      }\n    } else {\n      selectedWord = grid[startCell[0]][startCell[1]];\n    }\n  }\n\n  return selectedWord;\n}\n\nfunction fillCell(xCell: number, yCell: number, fillStyle: string) {\n  if (\n    xCell < 0 ||\n    xCell > gridSize.value - 1 ||\n    yCell < 0 ||\n    yCell > gridSize.value - 1\n  ) {\n    return;\n  }\n\n  const canvas = document.getElementById('c') as HTMLCanvasElement;\n  const ctx = canvas.getContext('2d');\n\n  if (ctx) {\n    ctx.fillStyle = fillStyle;\n    ctx.fillRect(\n      xCell * cellSize.value,\n      yCell * cellSize.value,\n      cellSize.value,\n      cellSize.value\n    );\n  }\n}\n\nfunction markSelectedWordCorrect() {\n  for (let x = 0; x < gridSize.value; x++) {\n    for (let y = 0; y < gridSize.value; y++) {\n      if (!correctCells[x][y]) {\n        correctCells[x][y] = selectedCells[x][y];\n      }\n    }\n  }\n\n  resetSelectedCells();\n}\n\nfunction getDirection(\n  startX: number,\n  startY: number,\n  x: number,\n  y: number\n): Direction {\n  const dx = x - startX;\n  const dy = y - startY;\n\n  if (dx === 0) {\n    if (dy > 0) {\n      return 'down';\n    } else if (dy < 0) {\n      return 'up';\n    }\n  } else if (dy === 0) {\n    if (dx > 0) {\n      return 'right';\n    } else if (dx < 0) {\n      return 'left';\n    }\n  } else if (dx >= 1 && dy >= 1) {\n    return 'down-right';\n  } else if (dx <= -1 && dy >= 1) {\n    return 'down-left';\n  } else if (dx >= 1 && dy <= -1) {\n    return 'up-right';\n  } else if (dx <= -1 && dy <= -1) {\n    return 'up-left';\n  } else {\n    return undefined;\n  }\n}\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    (_unref(words).length > 0)\n      ? (_openBlock(), _createElementBlock(_Fragment, { key: 0 }, [\n          _createElementVNode(\"div\", _hoisted_2, [\n            _createElementVNode(\"canvas\", {\n              ref_key: \"canvasRef\",\n              ref: canvasRef,\n              width: _unref(canvasSize),\n              height: _unref(canvasSize),\n              onPointerdown: _cache[0] || (_cache[0] = _withModifiers(($event: any) => (onPointerdownCanvas($event)), [\"stop\"])),\n              onPointermove: _cache[1] || (_cache[1] = _withModifiers(($event: any) => (onPointermoveCanvas($event)), [\"stop\"])),\n              onPointerup: _cache[2] || (_cache[2] = _withModifiers(($event: any) => (onPointerupCanvas($event)), [\"stop\"]))\n            }, null, 40, _hoisted_3),\n            (__props.task.showWordList)\n              ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [\n                  _createElementVNode(\"h2\", {\n                    class: \"word-list-title\",\n                    textContent: _toDisplayString(__props.task.strings.wordListTitle)\n                  }, null, 8, _hoisted_5),\n                  _createElementVNode(\"ul\", null, [\n                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(words), (word) => {\n                      return (_openBlock(), _createElementBlock(\"li\", {\n                        key: word,\n                        title: word,\n                        class: _normalizeClass([\"word\", { 'found-word': foundWords.value.includes(word) }])\n                      }, _toDisplayString(word), 11, _hoisted_6))\n                    }), 128))\n                  ])\n                ]))\n              : _createCommentVNode(\"\", true)\n          ]),\n          _createElementVNode(\"div\", _hoisted_7, [\n            _hoisted_8,\n            _createElementVNode(\"span\", {\n              class: \"time-info\",\n              textContent: _toDisplayString(__props.task.strings.timer)\n            }, null, 8, _hoisted_9),\n            _createElementVNode(\"span\", {\n              textContent: _toDisplayString(\n            Math.floor(timer.value / 60) +\n            ':' +\n            (timer.value % 60).toString().padStart(2, '0')\n          )\n            }, null, 8, _hoisted_10)\n          ]),\n          _createElementVNode(\"div\", _hoisted_11, [\n            _createElementVNode(\"div\", _hoisted_12, [\n              (_unref(taskCompleted))\n                ? (_openBlock(), _createBlock(FeedbackElement, {\n                    key: 0,\n                    achievedPoints: _unref(score),\n                    maxPoints: _unref(maxScore),\n                    \"result-message\": _unref(resultMessage)\n                  }, null, 8, [\"achievedPoints\", \"maxPoints\", \"result-message\"]))\n                : _createCommentVNode(\"\", true)\n            ]),\n            _createElementVNode(\"div\", _hoisted_13, [\n              (_unref(showCheckButton))\n                ? (_openBlock(), _createElementBlock(\"button\", {\n                    key: 0,\n                    textContent: _toDisplayString(__props.task.strings.checkButton),\n                    onClick: onClickCheck,\n                    type: \"button\",\n                    class: \"stud5p-button\"\n                  }, null, 8, _hoisted_14))\n                : _createCommentVNode(\"\", true),\n              (_unref(taskCompleted))\n                ? (_openBlock(), _createElementBlock(\"button\", {\n                    key: 1,\n                    textContent: _toDisplayString(__props.task.strings.retryButton),\n                    onClick: onClickRetry,\n                    type: \"button\",\n                    class: \"stud5p-button\"\n                  }, null, 8, _hoisted_15))\n                : _createCommentVNode(\"\", true),\n              (taskSubmitted.value && !showSolutions.value)\n                ? (_openBlock(), _createElementBlock(\"button\", {\n                    key: 2,\n                    textContent: _toDisplayString(__props.task.strings.solutionsButton),\n                    onClick: onClickShowSolutions,\n                    type: \"button\",\n                    class: \"stud5p-button\"\n                  }, null, 8, _hoisted_16))\n                : _createCommentVNode(\"\", true)\n            ])\n          ])\n        ], 64))\n      : (_openBlock(), _createElementBlock(\"div\", _hoisted_17, _toDisplayString(_unref($gettext)(\n          'Fgen Sie Wrter hinzu um ein Find the Words Rtsel zu erstellen.'\n        )), 1))\n  ]))\n}\n}\n\n})","<template>\n  <div class=\"stud5p-task\">\n    <template v-if=\"words.length > 0\">\n      <div class=\"canvas-and-word-list-container\">\n        <canvas\n          ref=\"canvasRef\"\n          :width=\"canvasSize\"\n          :height=\"canvasSize\"\n          @pointerdown.stop=\"onPointerdownCanvas($event)\"\n          @pointermove.stop=\"onPointermoveCanvas($event)\"\n          @pointerup.stop=\"onPointerupCanvas($event)\"\n        />\n\n        <div class=\"word-list\" v-if=\"task.showWordList\">\n          <h2 class=\"word-list-title\" v-text=\"task.strings.wordListTitle\" />\n          <ul>\n            <template v-for=\"word in words\" :key=\"word\">\n              <li\n                :title=\"word\"\n                class=\"word\"\n                :class=\"{ 'found-word': foundWords.includes(word) }\"\n              >\n                {{ word }}\n              </li>\n            </template>\n          </ul>\n        </div>\n      </div>\n      <div class=\"time-container\">\n        <span></span>\n        <span class=\"time-info\" v-text=\"task.strings.timer\" />\n        <span\n          v-text=\"\n            Math.floor(timer / 60) +\n            ':' +\n            (timer % 60).toString().padStart(2, '0')\n          \"\n        />\n      </div>\n      <div class=\"feedback-and-button-container\">\n        <div class=\"feedback-container\">\n          <FeedbackElement\n            v-if=\"taskCompleted\"\n            :achievedPoints=\"score\"\n            :maxPoints=\"maxScore\"\n            :result-message=\"resultMessage\"\n          />\n        </div>\n\n        <div class=\"button-panel\">\n          <button\n            v-if=\"showCheckButton\"\n            v-text=\"task.strings.checkButton\"\n            @click=\"onClickCheck\"\n            type=\"button\"\n            class=\"stud5p-button\"\n          />\n\n          <button\n            v-if=\"taskCompleted\"\n            v-text=\"task.strings.retryButton\"\n            @click=\"onClickRetry\"\n            type=\"button\"\n            class=\"stud5p-button\"\n          />\n\n          <button\n            v-if=\"taskSubmitted && !showSolutions\"\n            v-text=\"task.strings.solutionsButton\"\n            @click=\"onClickShowSolutions\"\n            type=\"button\"\n            class=\"stud5p-button\"\n          />\n        </div>\n      </div>\n    </template>\n    <div v-else>\n      {{\n        $gettext(\n          'Fgen Sie Wrter hinzu um ein Find the Words Rtsel zu erstellen.'\n        )\n      }}\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport {\n  computed,\n  defineProps,\n  onBeforeUnmount,\n  onMounted,\n  PropType,\n  ref,\n  watch,\n} from 'vue';\nimport FeedbackElement from '@/components/FeedbackElement.vue';\nimport { FindTheWordsTask } from '@/models/TaskDefinition';\nimport { v4 } from 'uuid';\nimport { $gettext } from '@/language/gettext';\n\nconst WordSearch = require('@blex41/word-search');\n\n// Types\ntype Direction =\n  | 'left'\n  | 'right'\n  | 'up'\n  | 'down'\n  | 'up-left'\n  | 'up-right'\n  | 'down-left'\n  | 'down-right'\n  | undefined;\n\ntype DragState =\n  | {\n      dragId: string;\n      startCell: [number, number];\n      currentCell: [number, number];\n      direction: Direction;\n    }\n  | undefined;\n\n// Props\nconst props = defineProps({\n  task: {\n    type: Object as PropType<FindTheWordsTask>,\n    required: true,\n  },\n});\n\n// Refs\nconst canvasRef = ref<HTMLCanvasElement | null>(null);\n\n// State\nlet grid: string[][] = [];\nlet selectedCells: boolean[][] = [];\nlet correctCells: boolean[][] = [];\nlet solutionCoordinates: { x: number; y: number }[] = [];\nconst foundWords = ref<string[]>([]);\nconst dragState = ref<DragState>();\nconst taskSubmitted = ref<boolean>(false);\nconst showSolutions = ref<boolean>(false);\nconst timer = ref<number>(0); // Track elapsed time in seconds\nlet timerStarted: boolean = false; // Flag to check if timer has started\nlet timerInterval: number | null = null; // Store interval ID to control timer\n\n// Lifecycle Hooks\nonMounted(() => {\n  initializeGrid();\n  drawGrid();\n  document.addEventListener('pointerdown', onPointerdownOutsideCanvas);\n  document.addEventListener('pointerup', onPointerupOutsideCanvas);\n});\n\nonBeforeUnmount(() => {\n  document.removeEventListener('pointerdown', onPointerdownOutsideCanvas);\n  document.removeEventListener('pointerup', onPointerupOutsideCanvas);\n});\n\n// Computed properties\nconst gridSize = computed(() => {\n  return props.task?.size;\n});\n\nconst cellSize = computed(() => {\n  return 42;\n});\n\nconst canvasSize = computed(() => {\n  return gridSize.value * cellSize.value;\n});\n\nconst words = computed(() => {\n  if (props.task?.words) {\n    return props.task.words\n      .split(',')\n      .filter((word) => word.trim())\n      .map((word) => word.trim().toUpperCase());\n  }\n  return [];\n});\n\nconst disabledDirections = computed(() => {\n  let result = [];\n  if (props.task?.directions) {\n    if (!props.task.directions.n) result.push('N');\n    if (!props.task.directions.ne) result.push('NE');\n    if (!props.task.directions.e) result.push('E');\n    if (!props.task.directions.se) result.push('SE');\n    if (!props.task.directions.s) result.push('S');\n    if (!props.task.directions.sw) result.push('SW');\n    if (!props.task.directions.w) result.push('W');\n    if (!props.task.directions.nw) result.push('NW');\n  }\n  return result;\n});\n\nconst alphabet = computed(() => {\n  if (props.task?.alphabet) {\n    return props.task.alphabet\n      .toUpperCase()\n      .split('')\n      .filter((char) => char.match(/[0-9\\p{L}]/u));\n  }\n  return [];\n});\n\nconst score = computed(() => {\n  return foundWords.value.length;\n});\n\nconst maxScore = computed(() => {\n  return words.value.length;\n});\n\nconst taskCompleted = computed(() => {\n  return score.value === maxScore.value || taskSubmitted.value;\n});\n\nconst resultMessage = computed(() => {\n  let result = props.task.strings.resultMessage.replace(\n    ':correct',\n    score.value.toString()\n  );\n  result = result.replace(':total', maxScore.value.toString());\n\n  return result;\n});\n\nconst showCheckButton = computed(() => {\n  return !taskCompleted.value;\n});\n\n// Watchers\nwatch(\n  () => props.task,\n  () => {\n    initializeGrid();\n    drawGrid();\n  },\n  { deep: true }\n);\n\nwatch(\n  () => taskCompleted.value,\n  (newValue) => {\n    if (newValue) {\n      stopTimer();\n    }\n  }\n);\n\n// Functions\nfunction startTimer(): void {\n  timerStarted = true;\n\n  // Start a timer that increments every second\n  timerInterval = setInterval(() => {\n    timer.value++;\n  }, 1000) as unknown as number;\n}\n\nfunction stopTimer(): void {\n  // Stop the timer and clear the interval\n  if (timerInterval !== null) {\n    clearInterval(timerInterval);\n    timerInterval = null; // Reset after clearing\n  }\n\n  timerStarted = false;\n}\n\nfunction onClickCheck(): void {\n  taskSubmitted.value = true;\n  stopTimer();\n}\n\nfunction onClickRetry(): void {\n  taskSubmitted.value = false;\n  showSolutions.value = false;\n  timer.value = 0;\n  solutionCoordinates = [];\n  stopTimer();\n  initializeGrid();\n  drawGrid();\n}\n\nfunction onClickShowSolutions(): void {\n  showSolutions.value = true;\n  drawGrid();\n}\n\nfunction randomLetter() {\n  if (alphabet.value.length > 0) {\n    const randomIndex = Math.floor(Math.random() * alphabet.value.length);\n    return alphabet.value[randomIndex];\n  }\n  return '';\n}\n\nfunction resetSelectedCells() {\n  selectedCells = [];\n  for (let x = 0; x < gridSize.value; x++) {\n    selectedCells[x] = [];\n    for (let y = 0; y < gridSize.value; y++) {\n      selectedCells[x][y] = false;\n    }\n  }\n}\n\nfunction resetCorrectCells() {\n  correctCells = [];\n  for (let x = 0; x < gridSize.value; x++) {\n    correctCells[x] = [];\n    for (let y = 0; y < gridSize.value; y++) {\n      correctCells[x][y] = false;\n    }\n  }\n}\n\nfunction initializeGrid() {\n  resetSelectedCells();\n  resetCorrectCells();\n  foundWords.value = [];\n  solutionCoordinates = [];\n\n  // Create a new puzzle with the WordSearch library\n  const options = {\n    cols: gridSize.value,\n    rows: gridSize.value,\n    disabledDirections: disabledDirections.value,\n    dictionary: words.value,\n    maxWords: words.value.length,\n    backwardsProbability: 0.3,\n    upperCase: true,\n    diacritics: true,\n  };\n\n  let ws = new WordSearch(options);\n\n  // Retry up to 10 times if the library wasn't able to place all words of the task in the grid\n  let count = 1;\n  while (ws.words.length !== words.value.length && count <= 10) {\n    console.log(\n      'Es konnten nicht alle Wrter untergebracht werden. Versuche es bis zu 10 mal erneut:',\n      count + '. Versuch'\n    );\n    ws = new WordSearch(options);\n    count++;\n  }\n\n  // Save the coordinates of the placed words\n  ws.words.forEach((word: any) => {\n    solutionCoordinates.push(...word.path);\n  });\n\n  // Fill the grid with the placed words and random letters for unused cells\n  grid = [];\n  for (let x = 0; x < gridSize.value; x++) {\n    grid[x] = [];\n    for (let y = 0; y < gridSize.value; y++) {\n      if (solutionCoordinates.some((coord) => coord.x === x && coord.y === y)) {\n        grid[x][y] = ws.grid[y][x];\n      } else {\n        grid[x][y] = randomLetter();\n      }\n    }\n  }\n}\n\nfunction drawGrid() {\n  const canvas = canvasRef.value;\n  if (!canvas) {\n    console.error('No Canvas');\n    return;\n  }\n  const ctx = canvas.getContext('2d');\n  if (ctx) {\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n    ctx.font = 'bold 26px calibri';\n    ctx.textAlign = 'center';\n    ctx.textBaseline = 'middle';\n    for (let x = 0; x < gridSize.value; x++) {\n      for (let y = 0; y < gridSize.value; y++) {\n        if (correctCells[x][y]) {\n          fillCell(x, y, '#d4f6e6');\n        }\n        if (!showSolutions.value && selectedCells[x][y]) {\n          fillCell(x, y, 'rgba(140, 180, 255, 0.34)');\n        }\n        if (\n          showSolutions.value &&\n          solutionCoordinates.some((coord) => coord.x === x && coord.y === y) &&\n          !correctCells[x][y]\n        ) {\n          fillCell(x, y, 'rgba(140, 180, 255, 0.34)');\n        }\n        ctx.strokeStyle = 'gainsboro';\n        ctx.strokeRect(\n          x * cellSize.value,\n          y * cellSize.value,\n          cellSize.value,\n          cellSize.value\n        );\n        ctx.fillStyle = '#404040';\n        ctx.fillText(\n          grid[x][y],\n          x * cellSize.value + cellSize.value / 2,\n          y * cellSize.value + cellSize.value / 2\n        );\n      }\n    }\n  }\n}\n\nfunction onPointerdownCanvas(event: PointerEvent) {\n  if (taskCompleted.value) return;\n\n  if (!timerStarted) {\n    console.log('Starting timer');\n    startTimer();\n  }\n\n  if (!dragState.value) {\n    // Start selection\n    const { cellX, cellY } = getCellUnderCursor(event);\n\n    dragState.value = {\n      dragId: v4(),\n      startCell: [cellX, cellY],\n      currentCell: [cellX, cellY],\n      direction: undefined,\n    };\n\n    resetSelectedCells();\n    selectedCells[cellX][cellY] = true;\n    drawGrid();\n  } else {\n    // We are already selecting with the two-clicks selection method and this\n    // is the second click, so we end the selection\n    endSelection();\n  }\n}\n\nfunction getCellUnderCursor(event: PointerEvent) {\n  const canvas = document.getElementById('c') as HTMLCanvasElement;\n  const rect = canvas.getBoundingClientRect();\n  const x = event.clientX - rect.left;\n  const y = event.clientY - rect.top;\n  const cellX = Math.max(\n    0,\n    Math.min(Math.floor(x / cellSize.value), gridSize.value - 1)\n  );\n  const cellY = Math.max(\n    0,\n    Math.min(Math.floor(y / cellSize.value), gridSize.value - 1)\n  );\n  return { cellX, cellY };\n}\n\nfunction onPointermoveCanvas(event: PointerEvent) {\n  if (dragState.value) {\n    const { cellX, cellY } = getCellUnderCursor(event);\n\n    const direction = getDirection(\n      dragState.value.startCell[0],\n      dragState.value.startCell[1],\n      cellX,\n      cellY\n    );\n\n    resetSelectedCells();\n\n    selectedCells[dragState.value.startCell[0]][dragState.value.startCell[1]] =\n      true;\n\n    if (direction === 'left') {\n      for (\n        let xCoordinate = dragState.value.startCell[0];\n        xCoordinate >= cellX;\n        xCoordinate--\n      ) {\n        selectedCells[xCoordinate][dragState.value.startCell[1]] = true;\n      }\n    } else if (direction === 'right') {\n      for (\n        let xCoordinate = dragState.value.startCell[0];\n        xCoordinate <= cellX;\n        xCoordinate++\n      ) {\n        selectedCells[xCoordinate][dragState.value.startCell[1]] = true;\n      }\n    } else if (direction === 'up') {\n      for (\n        let yCoordinate = dragState.value.startCell[1];\n        yCoordinate >= cellY;\n        yCoordinate--\n      ) {\n        selectedCells[dragState.value.startCell[0]][yCoordinate] = true;\n      }\n    } else if (direction === 'down') {\n      for (\n        let yCoordinate = dragState.value.startCell[1];\n        yCoordinate <= cellY;\n        yCoordinate++\n      ) {\n        selectedCells[dragState.value.startCell[0]][yCoordinate] = true;\n      }\n    } else if (direction === 'up-right') {\n      for (\n        let yCoordinate = dragState.value.startCell[1];\n        yCoordinate >= cellY;\n        yCoordinate--\n      ) {\n        const xCoordinate =\n          dragState.value.startCell[0] -\n          (yCoordinate - dragState.value.startCell[1]);\n        if (coordinatesAreValid(xCoordinate, yCoordinate)) {\n          selectedCells[xCoordinate][yCoordinate] = true;\n        }\n      }\n    } else if (direction === 'up-left') {\n      for (\n        let yCoordinate = dragState.value.startCell[1];\n        yCoordinate >= cellY;\n        yCoordinate--\n      ) {\n        const xCoordinate =\n          dragState.value.startCell[0] +\n          (yCoordinate - dragState.value.startCell[1]);\n        if (coordinatesAreValid(xCoordinate, yCoordinate)) {\n          selectedCells[xCoordinate][yCoordinate] = true;\n        }\n      }\n    } else if (direction === 'down-left') {\n      for (\n        let yCoordinate = dragState.value.startCell[1];\n        yCoordinate <= cellY;\n        yCoordinate++\n      ) {\n        const xCoordinate =\n          dragState.value.startCell[0] -\n          (yCoordinate - dragState.value.startCell[1]);\n        if (coordinatesAreValid(xCoordinate, yCoordinate)) {\n          selectedCells[xCoordinate][yCoordinate] = true;\n        }\n      }\n    } else if (direction === 'down-right') {\n      for (\n        let yCoordinate = dragState.value.startCell[1];\n        yCoordinate <= cellY;\n        yCoordinate++\n      ) {\n        const xCoordinate =\n          dragState.value.startCell[0] +\n          (yCoordinate - dragState.value.startCell[1]);\n        if (coordinatesAreValid(xCoordinate, yCoordinate)) {\n          selectedCells[xCoordinate][yCoordinate] = true;\n        }\n      }\n    }\n\n    dragState.value = {\n      dragId: dragState.value.dragId,\n      startCell: dragState.value.startCell,\n      currentCell: [cellX, cellY],\n      direction: direction,\n    };\n\n    drawGrid();\n  }\n}\n\nfunction onPointerupCanvas(event: PointerEvent) {\n  if (dragState.value) {\n    const { cellX, cellY } = getCellUnderCursor(event);\n\n    if (\n      dragState.value.startCell[0] != cellX ||\n      dragState.value.startCell[1] != cellY\n    ) {\n      // Moved the cursor to another cell before releasing, so we use click-and-hold selection and end the selection\n      endSelection();\n    }\n  }\n}\n\nfunction onPointerdownOutsideCanvas(event: PointerEvent) {\n  if (dragState.value) {\n    endSelection();\n  }\n}\n\nfunction onPointerupOutsideCanvas(event: PointerEvent) {\n  if (dragState.value) {\n    endSelection();\n  }\n}\n\nfunction endSelection() {\n  const selectedWord = getSelectedWord();\n  const reversedSelectedWord = selectedWord.split('').reverse().join('');\n  console.log('Selected:', selectedWord, reversedSelectedWord);\n\n  const isWordFound =\n    words.value.includes(selectedWord) ||\n    words.value.includes(reversedSelectedWord);\n\n  if (isWordFound) markSelectedWordCorrect();\n\n  const isNewWord =\n    !foundWords.value.includes(selectedWord) &&\n    !foundWords.value.includes(reversedSelectedWord);\n\n  if (isWordFound && isNewWord) {\n    if (words.value.includes(selectedWord)) {\n      console.log('Found:', selectedWord);\n      foundWords.value.push(selectedWord);\n    } else {\n      console.log('Found:', reversedSelectedWord);\n      foundWords.value.push(reversedSelectedWord);\n    }\n  }\n\n  dragState.value = undefined;\n  drawGrid();\n}\n\nfunction coordinatesAreValid(x: number, y: number): boolean {\n  return !(x < 0 || x >= gridSize.value || y < 0 || y >= gridSize.value);\n}\n\nfunction getSelectedWord(): string {\n  let selectedWord = '';\n\n  const startCell = dragState.value?.startCell;\n  const endCell = dragState.value?.currentCell;\n  const direction = dragState.value?.direction;\n\n  if (startCell && endCell) {\n    if (direction === 'left') {\n      for (let x = startCell[0]; x >= endCell[0]; x--) {\n        selectedWord += grid[x][startCell[1]];\n      }\n    } else if (direction === 'right') {\n      for (let x = startCell[0]; x <= endCell[0]; x++) {\n        selectedWord += grid[x][startCell[1]];\n      }\n    } else if (direction === 'up') {\n      for (let y = startCell[1]; y >= endCell[1]; y--) {\n        selectedWord += grid[startCell[0]][y];\n      }\n    } else if (direction === 'down') {\n      for (let y = startCell[1]; y <= endCell[1]; y++) {\n        selectedWord += grid[startCell[0]][y];\n      }\n    } else if (direction === 'up-left') {\n      for (let i = 0; i <= startCell[1] - endCell[1]; i++) {\n        const x = startCell[0] - i;\n        const y = startCell[1] - i;\n        if (coordinatesAreValid(x, y)) {\n          selectedWord += grid[x][y];\n        } else {\n          break;\n        }\n      }\n    } else if (direction === 'up-right') {\n      for (let i = 0; i <= startCell[1] - endCell[1]; i++) {\n        const x = startCell[0] + i;\n        const y = startCell[1] - i;\n        if (coordinatesAreValid(x, y)) {\n          selectedWord += grid[x][y];\n        } else {\n          break;\n        }\n      }\n    } else if (direction === 'down-left') {\n      for (let i = 0; i <= endCell[1] - startCell[1]; i++) {\n        const x = startCell[0] - i;\n        const y = startCell[1] + i;\n        if (coordinatesAreValid(x, y)) {\n          selectedWord += grid[x][y];\n        } else {\n          break;\n        }\n      }\n    } else if (direction === 'down-right') {\n      for (let i = 0; i <= endCell[1] - startCell[1]; i++) {\n        const x = startCell[0] + i;\n        const y = startCell[1] + i;\n        if (coordinatesAreValid(x, y)) {\n          selectedWord += grid[x][y];\n        } else {\n          break;\n        }\n      }\n    } else {\n      selectedWord = grid[startCell[0]][startCell[1]];\n    }\n  }\n\n  return selectedWord;\n}\n\nfunction fillCell(xCell: number, yCell: number, fillStyle: string) {\n  if (\n    xCell < 0 ||\n    xCell > gridSize.value - 1 ||\n    yCell < 0 ||\n    yCell > gridSize.value - 1\n  ) {\n    return;\n  }\n\n  const canvas = document.getElementById('c') as HTMLCanvasElement;\n  const ctx = canvas.getContext('2d');\n\n  if (ctx) {\n    ctx.fillStyle = fillStyle;\n    ctx.fillRect(\n      xCell * cellSize.value,\n      yCell * cellSize.value,\n      cellSize.value,\n      cellSize.value\n    );\n  }\n}\n\nfunction markSelectedWordCorrect() {\n  for (let x = 0; x < gridSize.value; x++) {\n    for (let y = 0; y < gridSize.value; y++) {\n      if (!correctCells[x][y]) {\n        correctCells[x][y] = selectedCells[x][y];\n      }\n    }\n  }\n\n  resetSelectedCells();\n}\n\nfunction getDirection(\n  startX: number,\n  startY: number,\n  x: number,\n  y: number\n): Direction {\n  const dx = x - startX;\n  const dy = y - startY;\n\n  if (dx === 0) {\n    if (dy > 0) {\n      return 'down';\n    } else if (dy < 0) {\n      return 'up';\n    }\n  } else if (dy === 0) {\n    if (dx > 0) {\n      return 'right';\n    } else if (dx < 0) {\n      return 'left';\n    }\n  } else if (dx >= 1 && dy >= 1) {\n    return 'down-right';\n  } else if (dx <= -1 && dy >= 1) {\n    return 'down-left';\n  } else if (dx >= 1 && dy <= -1) {\n    return 'up-right';\n  } else if (dx <= -1 && dy <= -1) {\n    return 'up-left';\n  } else {\n    return undefined;\n  }\n}\n</script>\n\n<style scoped>\n.canvas-and-word-list-container {\n  display: flex;\n  flex-direction: row;\n  align-items: flex-start;\n  justify-content: center;\n}\n\n.word-list {\n  display: flex;\n  flex-direction: column;\n  gap: 1em;\n  background: #f5f5f5;\n  padding: 0.5em;\n  border: 1px solid #ccc;\n  align-self: stretch;\n  max-width: 12em;\n}\n\n.word-list-title {\n  margin: 0;\n  font-weight: bold;\n}\n\n.word-list ul {\n  padding-left: 0.75em;\n  padding-right: 1.5em;\n}\n\n.word-list ul .found-word {\n  color: #255c41;\n  position: relative;\n}\n\n.word-list ul .found-word::after {\n  content: '';\n  position: absolute;\n  right: -1.5em;\n}\n\n.word {\n  overflow-wrap: break-word;\n}\n\n.time-container {\n  padding-top: 0.5em;\n  display: flex;\n  flex-direction: row;\n  gap: 0.25em;\n  justify-content: flex-start;\n  align-items: center;\n}\n\n.time-info {\n  font-weight: bold;\n}\n</style>\n","import script from \"./FindTheWordsViewer.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./FindTheWordsViewer.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./FindTheWordsViewer.vue?vue&type=style&index=0&id=93149c48&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-93149c48\"]])\n\nexport default __exports__","import { resolveComponent as _resolveComponent, createVNode as _createVNode, withCtx as _withCtx, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, Fragment as _Fragment } from \"vue\"\n\nconst _hoisted_1 = { key: 0 }\nconst _hoisted_2 = /*#__PURE__*/_createTextVNode(\" Task definition: \")\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_SelectVideo = _resolveComponent(\"SelectVideo\")!\n  const _component_TabComponent = _resolveComponent(\"TabComponent\")!\n  const _component_AddInteractions = _resolveComponent(\"AddInteractions\")!\n  const _component_ConfigureTravisGo = _resolveComponent(\"ConfigureTravisGo\")!\n  const _component_TabsComponent = _resolveComponent(\"TabsComponent\")!\n\n  return (_openBlock(), _createElementBlock(_Fragment, null, [\n    _createVNode(_component_TabsComponent, null, {\n      default: _withCtx(() => [\n        _createVNode(_component_TabComponent, {\n          title: _ctx.$gettext('1. Video auswhlen'),\n          icon: \"video2\"\n        }, {\n          default: _withCtx(() => [\n            _createVNode(_component_SelectVideo, { \"task-definition\": _ctx.taskDefinition }, null, 8, [\"task-definition\"])\n          ]),\n          _: 1\n        }, 8, [\"title\"]),\n        _createVNode(_component_TabComponent, {\n          title: _ctx.$gettext('2. Interaktionen hinzufgen'),\n          icon: \"content\"\n        }, {\n          default: _withCtx(() => [\n            _createVNode(_component_AddInteractions, { \"task-definition\": _ctx.taskDefinition }, null, 8, [\"task-definition\"])\n          ]),\n          _: 1\n        }, 8, [\"title\"]),\n        _createVNode(_component_TabComponent, {\n          title: _ctx.$gettext('3. Travis Go konfigurieren'),\n          icon: \"visibility-visible\"\n        }, {\n          default: _withCtx(() => [\n            _createVNode(_component_ConfigureTravisGo, {\n              settings: _ctx.taskDefinition.travisGoSettings,\n              onUpdate: _ctx.updateTravisGoSettings\n            }, null, 8, [\"settings\", \"onUpdate\"])\n          ]),\n          _: 1\n        }, 8, [\"title\"])\n      ]),\n      _: 1\n    }),\n    false\n      ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n          _hoisted_2,\n          _createElementVNode(\"pre\", null, _toDisplayString(_ctx.taskDefinition), 1)\n        ]))\n      : _createCommentVNode(\"\", true)\n  ], 64))\n}","<script lang=\"ts\">\nimport { defineComponent, inject, PropType } from 'vue';\nimport {\n  InteractiveVideoTask,\n  TravisGoSettings,\n} from '@/models/InteractiveVideoTask';\nimport { $gettext } from '@/language/gettext';\nimport TabsComponent from '@/components/studip/TabsComponent.vue';\nimport TabComponent from '@/components/studip/TabComponent.vue';\nimport AddInteractions from '@/components/interactiveVideo/editor/AddInteractions.vue';\nimport SelectVideo from '@/components/interactiveVideo/editor/SelectVideo.vue';\nimport ConfigureTravisGo from '@/components/interactiveVideo/editor/ConfigureTravisGo.vue';\nimport {\n  TaskEditorState,\n  taskEditorStateSymbol,\n} from '@/components/taskEditorState';\nimport produce from 'immer';\n\nexport default defineComponent({\n  name: 'InteractiveVideoEditor',\n  setup() {\n    return {\n      taskEditor: inject<TaskEditorState>(taskEditorStateSymbol),\n    };\n  },\n  methods: {\n    $gettext,\n    updateTravisGoSettings(payload: {\n      settings: TravisGoSettings;\n      undoBatch?: unknown;\n    }) {\n      this.taskEditor!.performEdit({\n        newTaskDefinition: produce(this.taskDefinition, (draft) => {\n          draft.travisGoSettings = payload.settings;\n        }),\n        undoBatch: payload.undoBatch,\n      });\n    },\n  },\n  props: {\n    taskDefinition: {\n      type: Object as PropType<InteractiveVideoTask>,\n      required: true,\n    },\n  },\n  computed: {},\n  components: {\n    ConfigureTravisGo,\n    SelectVideo,\n    AddInteractions,\n    TabComponent,\n    TabsComponent,\n  },\n});\n</script>\n\n<template>\n  <TabsComponent>\n    <TabComponent :title=\"$gettext('1. Video auswhlen')\" icon=\"video2\">\n      <SelectVideo :task-definition=\"taskDefinition\" />\n    </TabComponent>\n    <TabComponent\n      :title=\"$gettext('2. Interaktionen hinzufgen')\"\n      icon=\"content\"\n    >\n      <AddInteractions :task-definition=\"taskDefinition\" />\n    </TabComponent>\n    <TabComponent\n      :title=\"$gettext('3. Travis Go konfigurieren')\"\n      icon=\"visibility-visible\"\n    >\n      <ConfigureTravisGo\n        :settings=\"taskDefinition.travisGoSettings\"\n        @update=\"updateTravisGoSettings\"\n      />\n    </TabComponent>\n  </TabsComponent>\n  <div v-if=\"false\">\n    Task definition:\n    <pre>{{ taskDefinition }}</pre>\n  </div>\n</template>\n\n<style scoped></style>\n","import { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, normalizeStyle as _normalizeStyle, normalizeClass as _normalizeClass, resolveComponent as _resolveComponent, createBlock as _createBlock, resolveDynamicComponent as _resolveDynamicComponent, withModifiers as _withModifiers, Transition as _Transition, withCtx as _withCtx, createVNode as _createVNode, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-571a793f\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { key: 0 }\nconst _hoisted_2 = { style: {\"white-space\":\"pre\"} }\nconst _hoisted_3 = { ref: \"videoJsContainer\" }\nconst _hoisted_4 = [\"onClick\", \"title\"]\nconst _hoisted_5 = [\"title\"]\nconst _hoisted_6 = [\"title\"]\nconst _hoisted_7 = [\"title\"]\nconst _hoisted_8 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"arrow\",\n  \"data-popper-arrow\": \"\"\n}, null, -1))\nconst _hoisted_9 = { class: \"active-interaction\" }\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_LmbTaskInteraction = _resolveComponent(\"LmbTaskInteraction\")!\n  const _component_OverlayInteraction = _resolveComponent(\"OverlayInteraction\")!\n\n  return (_openBlock(), _createElementBlock(_Fragment, null, [\n    (_ctx.errorLoadingVideo)\n      ? (_openBlock(), _createElementBlock(\"p\", _hoisted_1, [\n          _createTextVNode(_toDisplayString(_ctx.$gettext('Das Video konnte nicht geladen werden. Grund: ')) + \" \", 1),\n          _createElementVNode(\"span\", _hoisted_2, _toDisplayString(_ctx.errorLoadingVideo), 1)\n        ]))\n      : _createCommentVNode(\"\", true),\n    _createElementVNode(\"div\", {\n      class: _normalizeClass([\"video-player-root\", { 'drag-in-progress': !!_ctx.dragState }]),\n      ref: \"root\"\n    }, [\n      _createElementVNode(\"div\", _hoisted_3, null, 512),\n      (!!_ctx.selectedInteractionId)\n        ? (_openBlock(), _createElementBlock(\"div\", {\n            key: 0,\n            class: \"cancel-selection-overlay\",\n            onClick: _cache[0] || (_cache[0] = ($event: any) => (_ctx.editor!.selectInteraction(undefined)))\n          }))\n        : _createCommentVNode(\"\", true),\n      (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.task.interactions, (interaction) => {\n        return (_openBlock(), _createElementBlock(\"button\", {\n          class: \"progress-bar-interaction-marker\",\n          key: interaction.id,\n          style: _normalizeStyle(_ctx.progressBarInteractionMarkerStyle(interaction)),\n          onClick: ($event: any) => (_ctx.onClickInteractionMarker(interaction)),\n          title: \n        _ctx.$gettext('Zu %{ interaction } springen', {\n          interaction: _ctx.printInteractionType(interaction),\n        })\n      \n        }, null, 12, _hoisted_4))\n      }), 128)),\n      (_ctx.editor)\n        ? (_openBlock(), _createElementBlock(\"div\", {\n            key: 1,\n            ref: \"selectedInteractionTooltip\",\n            class: _normalizeClass([\"selected-interaction-tooltip\", {\n        hidden: !_ctx.interactionForPopper,\n      }])\n          }, [\n            (_ctx.selectedInteraction?.type === 'lmbTask')\n              ? (_openBlock(), _createElementBlock(\"button\", {\n                  key: 0,\n                  type: \"button\",\n                  class: \"small-button visibility-visible\",\n                  onClick: _cache[1] || (_cache[1] = ($event: any) => (_ctx.activateInteraction(_ctx.selectedInteraction))),\n                  title: _ctx.$gettext('Vorschau')\n                }, null, 8, _hoisted_5))\n              : _createCommentVNode(\"\", true),\n            _createElementVNode(\"button\", {\n              type: \"button\",\n              class: \"small-button edit\",\n              onClick: _cache[2] || (_cache[2] = ($event: any) => (_ctx.selectedInteraction && _ctx.editInteraction(_ctx.selectedInteraction))),\n              title: _ctx.$gettext('Bearbeiten')\n            }, null, 8, _hoisted_6),\n            _createElementVNode(\"button\", {\n              type: \"button\",\n              class: \"small-button trash\",\n              onClick: _cache[3] || (_cache[3] = ($event: any) => (\n          _ctx.selectedInteractionId &&\n            _ctx.editor?.deleteInteraction(_ctx.selectedInteractionId)\n        )),\n              title: _ctx.$gettext('Lschen')\n            }, null, 8, _hoisted_7),\n            _hoisted_8\n          ], 2))\n        : _createCommentVNode(\"\", true),\n      (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.visibleInteractions, (interaction) => {\n        return (_openBlock(), _createElementBlock(_Fragment, {\n          key: interaction.id\n        }, [\n          (interaction.type === 'lmbTask')\n            ? (_openBlock(), _createBlock(_component_LmbTaskInteraction, {\n                key: 0,\n                id: `interaction-${_ctx.uid}-${interaction.id}`,\n                class: \"video-player-interaction\",\n                style: _normalizeStyle({\n          left: `${interaction.x * 100}%`,\n          top: `${interaction.y * 100}%`,\n        }),\n                interaction: interaction,\n                onClick: ($event: any) => (_ctx.editor?.selectInteraction(interaction.id)),\n                onPointerdown: ($event: any) => (_ctx.onPointerDownInteraction($event, interaction)),\n                onPointermove: ($event: any) => (_ctx.onPointerMoveInteraction($event, interaction)),\n                onPointerup: ($event: any) => (_ctx.onPointerUpInteraction($event, interaction)),\n                onActivateInteraction: _ctx.activateInteraction\n              }, null, 8, [\"id\", \"style\", \"interaction\", \"onClick\", \"onPointerdown\", \"onPointermove\", \"onPointerup\", \"onActivateInteraction\"]))\n            : (interaction.type === 'overlay')\n              ? (_openBlock(), _createBlock(_component_OverlayInteraction, {\n                  key: 1,\n                  id: `interaction-${_ctx.uid}-${interaction.id}`,\n                  class: \"video-player-interaction\",\n                  style: _normalizeStyle({\n          left: `${interaction.x * 100}%`,\n          top: `${interaction.y * 100}%`,\n          width: `${interaction.width * 100}%`,\n          height: `${interaction.height * 100}%`,\n        }),\n                  interaction: interaction,\n                  onClick: ($event: any) => (_ctx.editor?.selectInteraction(interaction.id)),\n                  onPointerdown: ($event: any) => (_ctx.onPointerDownInteraction($event, interaction)),\n                  onPointermove: ($event: any) => (_ctx.onPointerMoveInteraction($event, interaction)),\n                  onPointerup: ($event: any) => (_ctx.onPointerUpInteraction($event, interaction)),\n                  onPointerDownResizeHandle: _ctx.onPointerDownResizeHandle,\n                  onPointerMoveResizeHandle: _ctx.onPointerMoveResizeHandle,\n                  onPointerUpResizeHandle: _ctx.onPointerUpResizeHandle\n                }, null, 8, [\"id\", \"style\", \"interaction\", \"onClick\", \"onPointerdown\", \"onPointermove\", \"onPointerup\", \"onPointerDownResizeHandle\", \"onPointerMoveResizeHandle\", \"onPointerUpResizeHandle\"]))\n              : _createCommentVNode(\"\", true)\n        ], 64))\n      }), 128)),\n      _createVNode(_Transition, { name: \"fade\" }, {\n        default: _withCtx(() => [\n          (_ctx.activeInteraction?.type === 'lmbTask')\n            ? (_openBlock(), _createElementBlock(\"div\", {\n                key: 0,\n                class: \"active-interaction-container\",\n                onClick: _cache[5] || (_cache[5] = _withModifiers(\n//@ts-ignore\n(...args) => (_ctx.closeInteraction && _ctx.closeInteraction(...args)), [\"self\"]))\n              }, [\n                _createElementVNode(\"div\", _hoisted_9, [\n                  _createElementVNode(\"h1\", null, _toDisplayString(_ctx.printTaskType(_ctx.activeInteraction.taskDefinition.task_type)), 1),\n                  (_openBlock(), _createBlock(_resolveDynamicComponent(_ctx.viewerForTaskType(_ctx.activeInteraction.taskDefinition.task_type)), {\n                    task: _ctx.activeInteraction.taskDefinition\n                  }, null, 8, [\"task\"])),\n                  _createElementVNode(\"button\", {\n                    type: \"button\",\n                    class: \"button cancel\",\n                    onClick: _cache[4] || (_cache[4] = \n//@ts-ignore\n(...args) => (_ctx.closeInteraction && _ctx.closeInteraction(...args)))\n                  }, _toDisplayString(_ctx.$gettext('Schlieen')), 1)\n                ])\n              ]))\n            : _createCommentVNode(\"\", true)\n        ]),\n        _: 1\n      })\n    ], 2)\n  ], 64))\n}","<script lang=\"ts\">\nimport { defineComponent, inject, PropType } from 'vue';\nimport videojs from 'video.js';\nimport Player from 'video.js/dist/types/player';\nrequire('!style-loader!css-loader!video.js/dist/video-js.css');\nimport 'videojs-youtube/dist/Youtube.min.js';\nimport {\n  Interaction,\n  InteractiveVideoTask,\n  NoVideo,\n  printInteractionType,\n  ResizeHandle,\n  StudipFileVideo,\n  Video,\n  YoutubeVideo,\n} from '@/models/InteractiveVideoTask';\nimport {\n  InteractiveVideoEditorState,\n  interactiveVideoEditorStateSymbol,\n} from '@/components/interactiveVideo/editor/interactiveVideoEditorState';\nimport LmbTaskInteraction from '@/components/interactiveVideo/interactions/LmbTaskInteraction.vue';\nimport { printTaskType, viewerForTaskType } from '@/models/TaskDefinition';\nimport { $gettext } from '../../language/gettext';\nimport { createPopper, Instance } from '@popperjs/core';\nimport type { StrictModifiers } from '@popperjs/core';\nimport { v4 } from 'uuid';\nimport OverlayInteraction from '@/components/interactiveVideo/interactions/OverlayInteraction.vue';\nimport { OverlayInteraction as OverlayInteractionType } from '@/models/InteractiveVideoTask';\nimport { mapActions, mapGetters } from 'vuex';\nimport { fileRefsSchema } from '@/routes/jsonApi';\nimport {\n  DragState,\n  VideoMetadata,\n} from '@/components/interactiveVideo/editor/events';\n\ntype LoadedStudipFileVideo = StudipFileVideo & {\n  download_url: string;\n  mime_type: string;\n};\ntype VideoInfo = LoadedStudipFileVideo | NoVideo | YoutubeVideo;\n\nlet popperInstance: Instance | undefined;\nexport default defineComponent({\n  name: 'VideoPlayer',\n  components: { OverlayInteraction, LmbTaskInteraction },\n  setup() {\n    return {\n      editor: inject<InteractiveVideoEditorState | undefined>(\n        interactiveVideoEditorStateSymbol,\n        undefined\n      ),\n    };\n  },\n  props: {\n    task: {\n      type: Object as PropType<InteractiveVideoTask>,\n      required: true,\n    },\n  },\n  emits: {\n    timeupdate(time: number) {\n      return true;\n    },\n    metadataChange(payload: VideoMetadata) {\n      return true;\n    },\n  },\n  data() {\n    return {\n      player: null as Player | null,\n      // The time the video player is seeked to\n      time: 0,\n      // The time reached by the user watching the video without seeking.\n      // This is used to enforce the setting 'disable navigation'.\n      playedTime: 0,\n      isPlaying: false,\n      dragState: undefined as DragState,\n      activeInteraction: undefined as Interaction | undefined,\n      progressBarParameters: {\n        widthPixels: 1,\n        xOffsetPixels: 0,\n      },\n      progressBarObserver: undefined as ResizeObserver | undefined,\n      videoInfoPromise: Promise.resolve({ type: 'none' }) as Promise<VideoInfo>,\n      errorLoadingVideo: undefined as unknown,\n    };\n  },\n  computed: {\n    ...mapGetters({\n      fileRefById: 'file-refs/byId',\n    }),\n    // A unique ID for this instance of VideoPlayer, so that we can refer\n    // to elements inside of it by ID when there are multiple VideoPlayers\n    // (e.g. viewer on one tab, editor on another tab).\n    uid(): string {\n      return v4();\n    },\n    // Return the Interaction, if any, for which a popper tooltip should be shown\n    interactionForPopper(): Interaction | undefined {\n      // The popper should only be rendered if the selected interaction is visible.\n      if (\n        this.selectedInteraction &&\n        this.visibleInteractions.includes(this.selectedInteraction)\n      ) {\n        return this.selectedInteraction;\n      } else {\n        return undefined;\n      }\n    },\n    selectedInteraction(): Interaction | undefined {\n      return this.task.interactions.find(\n        (i) => i.id === this.selectedInteractionId\n      );\n    },\n    selectedInteractionId(): string | undefined {\n      return this.editor?.selectedInteractionId.value;\n    },\n    /**\n     * @return a list of Interaction objects whose clickable icons (or other elements)\n     * should be shown overlaid over the video at the timestamp given by this.time.\n     */\n    visibleInteractions(): Interaction[] {\n      return this.task.interactions.filter((i) => {\n        return i.startTime <= this.time && i.endTime > this.time;\n      });\n    },\n    // Computed property created so that we can register a watcher which triggers\n    // when either of these things changes.\n    timeAndVisibleInteractions(): [number, Interaction[]] {\n      return [this.time, this.visibleInteractions];\n    },\n  },\n  watch: {\n    'task.video': {\n      handler(video: Video) {\n        console.log('video prop changed', video);\n        this.videoInfoPromise = this.loadVideoInfo(video);\n        this.videoInfoPromise.catch((error: unknown) => {\n          console.error('Error while loading video.', error);\n          this.errorLoadingVideo = error;\n        });\n        this.videoInfoPromise.then((videoInfo) => {\n          this.initializePlayer(videoInfo);\n          this.errorLoadingVideo = undefined; // Clear error\n        });\n      },\n      immediate: true,\n    },\n    // Handle pausing the video when an interaction becomes visible.\n    timeAndVisibleInteractions(\n      [newTime, newVisibleInteractions]: [number, Interaction[]],\n      [oldTime, oldVisibleInteractions]: [number, Interaction[]]\n    ): void {\n      const isPlayingForward = this.isPlaying && newTime > oldTime;\n      const newlyVisibleInteractionWithPause = newVisibleInteractions.find(\n        (i) => !oldVisibleInteractions.includes(i) && i.pauseWhenVisible\n      );\n      if (isPlayingForward && newlyVisibleInteractionWithPause) {\n        console.log(\n          'pausing for interaction: ',\n          newlyVisibleInteractionWithPause\n        );\n        this.player!.pause();\n      }\n    },\n    interactionForPopper: {\n      immediate: true,\n      handler: function (interaction: Interaction | undefined) {\n        popperInstance?.destroy();\n        if (interaction) {\n          // Run on next tick, because we need to wait for the interactionElement\n          // to be rendered by Vue, in case it isn't yet visible at the moment this\n          // watcher is triggered.\n          // For example, if the user clicks on the timeline to jump to a point\n          // in the video where the currently selected interaction is visible,\n          // when it previously was not.\n          this.$nextTick(() => {\n            const interactionElement = document.getElementById(\n              `interaction-${this.uid}-${interaction.id}`\n            ) as HTMLElement;\n            const tooltipElement = this.$refs\n              .selectedInteractionTooltip as HTMLElement;\n            popperInstance = createPopper(interactionElement, tooltipElement, {\n              placement: 'top',\n              modifiers: [\n                {\n                  name: 'offset',\n                  options: {\n                    offset: [0, 8],\n                  },\n                },\n              ],\n            });\n          });\n        }\n      },\n    },\n  },\n  methods: {\n    printInteractionType,\n    $gettext,\n    printTaskType,\n    viewerForTaskType,\n    ...mapActions({\n      loadFileRef: 'file-refs/loadById',\n    }),\n    onPlayerReady() {\n      console.log('player ready');\n    },\n    // TODO This information is needed in other places in the Interactive\n    //  Video Editor, for example, in 'SelectVideo.vue' to display the name and\n    //  file type of the selected file.  This asynchronous method should be\n    //  implemented and called one time in InteractiveVideoEditor.vue.\n    async loadVideoInfo(video: Video): Promise<VideoInfo> {\n      switch (video.type) {\n        case 'youtube':\n        case 'none':\n          return video;\n        case 'studipFileReference': {\n          await this.loadFileRef({ id: video.file_id });\n          const ref = fileRefsSchema.parse(\n            this.fileRefById({ id: video.file_id })\n          );\n          return {\n            ...video,\n            mime_type: ref.attributes['mime-type'],\n            download_url: ref.meta['download-url'],\n          };\n        }\n      }\n    },\n    videoUrl(videoInfo: VideoInfo): string {\n      switch (videoInfo.type) {\n        case 'youtube':\n          return videoInfo.url;\n        case 'studipFileReference':\n          return videoInfo.download_url;\n        default:\n          return '';\n      }\n    },\n    videoType(videoInfo: VideoInfo): string | undefined {\n      switch (videoInfo.type) {\n        case 'youtube':\n          return 'video/youtube';\n        case 'studipFileReference':\n          return videoInfo.mime_type;\n        default:\n          return '';\n      }\n    },\n    initializePlayer(videoInfo: VideoInfo) {\n      if (!this.$refs.videoJsContainer) {\n        console.warn(\n          'initializePlayer called but $refs.videoJsContainer is undefined. ' +\n            'Returning early without doing anything.'\n        );\n        return;\n      }\n      // If player has already been created, it must be destroyed before we\n      // create a new one.\n      this.progressBarObserver?.disconnect();\n      this.player?.dispose();\n\n      // The dispose() method removes the player element from the dom, so we must\n      // create and append the player element by hand to the DOM each time.\n      const playerElement = document.createElement('video-js');\n      playerElement.classList.add('video-js', 'vjs-fluid');\n      (this.$refs.videoJsContainer as HTMLDivElement).appendChild(\n        playerElement\n      );\n\n      // Create the player and set up event listeners\n      this.player = videojs(\n        playerElement,\n        {\n          techOrder: ['html5', 'youtube'],\n          sources: [\n            {\n              src: this.videoUrl(videoInfo),\n              type: this.videoType(videoInfo),\n            },\n          ],\n          controls: true,\n          controlBar: {\n            children: [\n              'playToggle',\n              'progressControl',\n              'currentTimeDisplay',\n              'timeDivider',\n              'durationDisplay',\n              'volumePanel',\n              'fullscreenToggle',\n            ],\n            volumePanel: {\n              inline: false,\n            },\n          },\n          autoplay: this.task.autoplay && !this.editor,\n          // Major browsers block autoplay unless the video is muted.\n          muted: this.task.autoplay && !this.editor,\n        },\n        this.onPlayerReady\n      );\n      this.player.on('timeupdate', () => {\n        const time = this.player!.currentTime();\n        if (time) {\n          this.$emit('timeupdate', time);\n          this.time = time;\n          if (this.isPlaying && !this.player!.paused()!) {\n            // Track how far the user has \"watched\" the video without seeking\n            this.playedTime = Math.max(this.playedTime, time);\n          }\n        }\n      });\n      this.player.on('loadedmetadata', () => {\n        this.playedTime = this.task.startAt;\n        this.player!.currentTime(this.task.startAt);\n        if (this.task.autoplay && !this.editor) {\n          this.player!.play();\n        }\n        this.$emit('metadataChange', {\n          length: this.player!.duration() ?? 1,\n        });\n      });\n      this.player.on('playing', () => {\n        this.isPlaying = true;\n      });\n      this.player.on(['waiting', 'pause'], () => {\n        this.isPlaying = false;\n      });\n\n      const enforceDisabledNavigation = () => {\n        if (this.task.disableNavigation === 'forward disabled') {\n          // Prevent forward navigation\n          if (this.player!.currentTime()! - this.playedTime > 0.5) {\n            this.player!.currentTime(this.playedTime);\n          }\n        } else if (\n          this.task.disableNavigation === 'forward and backward disabled'\n        ) {\n          // Prevent all navigation\n          if (Math.abs(this.player!.currentTime()! - this.playedTime) > 0.5) {\n            this.player!.currentTime(this.playedTime);\n          }\n        }\n      };\n      this.player.on('seeking', () => {\n        if (!this.editor) {\n          enforceDisabledNavigation();\n        }\n      });\n      this.player.on('seeked', () => {\n        if (!this.editor) {\n          enforceDisabledNavigation();\n        }\n      });\n\n      // Observe the progress bar -- we need to know its size and location\n      // in order to position our interaction markers correctly on top of it.\n      const progressBarEls = playerElement.getElementsByClassName(\n        'vjs-progress-holder'\n      );\n      const progressHolder = progressBarEls.item(0) as HTMLElement | undefined;\n      if (!progressHolder) {\n        console.error('no progress holder found');\n      } else {\n        this.progressBarObserver = new ResizeObserver((entries) => {\n          const root = this.$refs.root as HTMLElement;\n          const rootLeft = root.getBoundingClientRect().x;\n          const progressHolderLeft = progressHolder.getBoundingClientRect().x;\n          const offset = progressHolderLeft - rootLeft;\n          this.progressBarParameters.xOffsetPixels = offset;\n          this.progressBarParameters.widthPixels = progressHolder.clientWidth;\n        });\n        this.progressBarObserver.observe(progressHolder);\n      }\n    },\n    activateInteraction(interaction: Interaction) {\n      this.activeInteraction = interaction;\n      this.player!.pause();\n    },\n    closeInteraction() {\n      this.activeInteraction = undefined;\n    },\n    editInteraction(interaction: Interaction) {\n      this.editor!.editInteraction(interaction.id);\n    },\n    onPointerDownResizeHandle(payload: {\n      event: PointerEvent;\n      handle: ResizeHandle;\n      interaction: OverlayInteractionType;\n    }) {\n      if (!this.editor) {\n        return;\n      }\n      const { event, handle, interaction } = payload;\n      this.editor.selectInteraction(interaction.id);\n      this.dragState = {\n        type: 'resizeInteraction',\n        interactionId: interaction.id,\n        mouseStartPos: [event.clientX, event.clientY],\n        interactionStartPos: [interaction.x, interaction.y],\n        interactionStartSize: [interaction.width, interaction.height],\n        handle,\n      };\n      (event.target as HTMLElement).setPointerCapture(event.pointerId);\n    },\n    onPointerUpResizeHandle(payload: {\n      event: PointerEvent;\n      handle: ResizeHandle;\n      interaction: Interaction;\n    }) {\n      this.dragState = undefined;\n      (payload.event.target as HTMLElement).releasePointerCapture(\n        payload.event.pointerId\n      );\n    },\n    onPointerMoveResizeHandle(payload: {\n      event: PointerEvent;\n      handle: ResizeHandle;\n      interaction: OverlayInteractionType;\n    }) {\n      const { event, handle, interaction } = payload;\n      if (\n        this.dragState?.type === 'resizeInteraction' &&\n        this.dragState.interactionId === interaction.id\n      ) {\n        const rootRect = (\n          this.$refs.root as HTMLElement\n        ).getBoundingClientRect();\n\n        const {\n          interactionStartPos: [xInitial, yInitial],\n          interactionStartSize: [widthInitial, heightInitial],\n        } = this.dragState;\n        let newX = xInitial;\n        let newWidth = widthInitial;\n        let newY = yInitial;\n        let newHeight = heightInitial;\n\n        // Convert mouse movement in pixels to fractions of root rect width/height\n        const xPointer = event.clientX / rootRect.width;\n        const dxPointerPixels = event.clientX - this.dragState.mouseStartPos[0];\n        const dxPointer = dxPointerPixels / rootRect.width;\n\n        const yPointer = event.clientY / rootRect.height;\n        const dyPointerPixels = event.clientY - this.dragState.mouseStartPos[1];\n        const dyPointer = dyPointerPixels / rootRect.height;\n\n        // Horizontal resizing\n        if (\n          handle === 'left' ||\n          handle === 'top-left' ||\n          handle === 'bottom-left'\n        ) {\n          if (xPointer > xInitial + widthInitial) {\n            newX = xInitial + widthInitial;\n            newWidth = xPointer - newX;\n          } else {\n            newX = xInitial + dxPointer;\n            newWidth = widthInitial - dxPointer;\n          }\n        } else if (\n          handle === 'right' ||\n          handle === 'top-right' ||\n          handle === 'bottom-right'\n        ) {\n          if (xPointer < xInitial) {\n            newX = xPointer;\n            newWidth = xInitial - xPointer;\n          } else {\n            newX = xInitial;\n            newWidth = widthInitial + dxPointer;\n          }\n        }\n\n        // Vertical resizing\n        if (\n          handle === 'top-left' ||\n          handle === 'top' ||\n          handle === 'top-right'\n        ) {\n          // I wish I could explain to you why this formula has to be different\n          // than the one used for horizontal resizing, but I figured out by\n          // trial and error that I needed to use dyPointer in my calculations\n          // and that yPointer was not reliable.\n          // I suspect that something about the surrounding HTML causes the event\n          // absolute coordinates on the Y axis to not be exactly correct. -Ann\n          if (dyPointer > heightInitial) {\n            newY = yInitial + heightInitial;\n            newHeight = dyPointer - heightInitial;\n          } else {\n            newY = yInitial + dyPointer;\n            newHeight = heightInitial - dyPointer;\n          }\n        } else if (\n          handle === 'bottom-left' ||\n          handle === 'bottom' ||\n          handle === 'bottom-right'\n        ) {\n          // Ditto for this formula here. -Ann\n          if (-dyPointer > heightInitial) {\n            newY = yInitial + heightInitial + dyPointer;\n            newHeight = -dyPointer - heightInitial;\n          } else {\n            newY = yInitial;\n            newHeight = heightInitial + dyPointer;\n          }\n        }\n\n        // Prevent shrinking the interaction below a minimum size\n        let filteredHeight = interaction.height,\n          filteredWidth = interaction.width,\n          filteredX = interaction.x,\n          filteredY = interaction.y;\n        if (newHeight > 0.05) {\n          filteredHeight = newHeight;\n          filteredY = newY;\n        }\n        if (newWidth > 0.05) {\n          filteredWidth = newWidth;\n          filteredX = newX;\n        }\n\n        // Prevent moving the interaction completely off screen\n        const isOffscreenX =\n          filteredX > 0.95 || filteredX + filteredWidth < 0.05;\n        const isOffscreenY =\n          filteredY > 0.9 || filteredY + filteredHeight < 0.05;\n        if (isOffscreenX) {\n          filteredX = interaction.x;\n          filteredWidth = interaction.width;\n        }\n        if (isOffscreenY) {\n          filteredY = interaction.y;\n          filteredHeight = interaction.height;\n        }\n\n        this.editor!.resizeOverlay(\n          interaction.id,\n          filteredX,\n          filteredY,\n          filteredWidth,\n          filteredHeight,\n          this.dragState\n        );\n        popperInstance?.update();\n      }\n    },\n    onPointerDownInteraction(event: PointerEvent, interaction: Interaction) {\n      if (!this.editor) {\n        return;\n      }\n      this.editor.selectInteraction(interaction.id);\n      this.dragState = {\n        type: 'dragInteraction',\n        interactionId: interaction.id,\n        mouseStartPos: [event.clientX, event.clientY],\n        interactionStartPos: [interaction.x, interaction.y],\n      };\n      (event.target as HTMLElement).setPointerCapture(event.pointerId);\n    },\n    onPointerUpInteraction(event: PointerEvent, interaction: Interaction) {\n      this.dragState = undefined;\n      (event.target as HTMLElement).releasePointerCapture(event.pointerId);\n    },\n    onPointerMoveInteraction(event: PointerEvent, interaction: Interaction) {\n      if (\n        this.dragState?.type === 'dragInteraction' &&\n        this.dragState.interactionId === interaction.id\n      ) {\n        const rootRect = (\n          this.$refs.root as HTMLElement\n        ).getBoundingClientRect();\n        const interactionEl = event.currentTarget as HTMLElement;\n\n        const clientDx = event.clientX - this.dragState.mouseStartPos[0];\n        const dxFraction = clientDx / rootRect.width;\n        const xFraction = this.dragState.interactionStartPos[0] + dxFraction;\n        const interactionWidth = interactionEl.clientWidth / rootRect.width;\n        const minX = 0.05 - interactionWidth;\n        const maxX = 0.95;\n        const clampedXFraction = Math.min(maxX, Math.max(minX, xFraction));\n\n        const clientDy = event.clientY - this.dragState.mouseStartPos[1];\n        const dyFraction = clientDy / rootRect.height;\n        const yFraction = this.dragState.interactionStartPos[1] + dyFraction;\n        const interactionHeight = interactionEl.clientHeight / rootRect.height;\n        const minY = 0.05 - interactionHeight;\n        const maxY = 0.9;\n        const clampedYFraction = Math.min(maxY, Math.max(minY, yFraction));\n\n        const id = this.dragState.interactionId;\n        this.editor?.dragInteraction(\n          id,\n          clampedXFraction,\n          clampedYFraction,\n          this.dragState\n        );\n        popperInstance?.update();\n      }\n    },\n    progressBarInteractionMarkerStyle(\n      interaction: Interaction\n    ): Partial<CSSStyleDeclaration> {\n      const progressPercentage =\n        interaction.startTime / (this.player?.duration() ?? 1);\n      const timeOffsetPx =\n        this.progressBarParameters.widthPixels * progressPercentage;\n      return {\n        left: `calc(${this.progressBarParameters.xOffsetPixels}px +\n        ${timeOffsetPx}px - 0.25em)`,\n      };\n    },\n    onClickInteractionMarker(interaction: Interaction): void {\n      this.editor?.selectInteraction(interaction.id);\n      // Give keyboard focus to the interaction whose interaction marker was clicked.\n      const focusInteraction = () => {\n        const interactionElement = document.getElementById(\n          `interaction-${this.uid}-${interaction.id}`\n        ) as HTMLElement;\n        interactionElement.focus({\n          focusVisible: true,\n        } as any);\n      };\n      if (!this.visibleInteractions.includes(interaction)) {\n        // Wait for player to seek so the interaction becomes visible\n        this.player!.one('seeked', () => {\n          // Need to wait one Vue 'tick' so that the interaction element appears.\n          this.$nextTick(focusInteraction);\n        });\n      } else {\n        // The interaction is already visible. Focus it immediately.\n        focusInteraction();\n      }\n      // Skip to a time just slightly ahead of the point where the interaction\n      // appears.  This is necessary to avoid off-by-one-frame errors\n      const delta = 0.2;\n      const difference = this.player!.currentTime()! - interaction.startTime;\n      if (difference < 0 || difference > delta) {\n        this.player!.currentTime(interaction.startTime + delta / 2);\n      }\n    },\n  },\n  beforeUnmount() {\n    this.progressBarObserver?.disconnect();\n  },\n});\n</script>\n\n<template>\n  <p v-if=\"errorLoadingVideo\">\n    {{ $gettext('Das Video konnte nicht geladen werden. Grund: ') }}\n    <span style=\"white-space: pre\">{{ errorLoadingVideo }}</span>\n  </p>\n  <div\n    class=\"video-player-root\"\n    ref=\"root\"\n    :class=\"{ 'drag-in-progress': !!dragState }\"\n  >\n    <div ref=\"videoJsContainer\"></div>\n    <div\n      class=\"cancel-selection-overlay\"\n      v-if=\"!!selectedInteractionId\"\n      @click=\"editor!.selectInteraction(undefined)\"\n    ></div>\n    <button\n      class=\"progress-bar-interaction-marker\"\n      v-for=\"interaction in task.interactions\"\n      :key=\"interaction.id\"\n      :style=\"progressBarInteractionMarkerStyle(interaction)\"\n      @click=\"onClickInteractionMarker(interaction)\"\n      :title=\"\n        $gettext('Zu %{ interaction } springen', {\n          interaction: printInteractionType(interaction),\n        })\n      \"\n    />\n    <div\n      ref=\"selectedInteractionTooltip\"\n      v-if=\"editor\"\n      class=\"selected-interaction-tooltip\"\n      :class=\"{\n        hidden: !interactionForPopper,\n      }\"\n    >\n      <button\n        type=\"button\"\n        class=\"small-button visibility-visible\"\n        @click=\"activateInteraction(selectedInteraction)\"\n        :title=\"$gettext('Vorschau')\"\n        v-if=\"selectedInteraction?.type === 'lmbTask'\"\n      ></button>\n      <button\n        type=\"button\"\n        class=\"small-button edit\"\n        @click=\"selectedInteraction && editInteraction(selectedInteraction)\"\n        :title=\"$gettext('Bearbeiten')\"\n      ></button>\n      <button\n        type=\"button\"\n        class=\"small-button trash\"\n        @click=\"\n          selectedInteractionId &&\n            editor?.deleteInteraction(selectedInteractionId)\n        \"\n        :title=\"$gettext('Lschen')\"\n      ></button>\n      <div class=\"arrow\" data-popper-arrow></div>\n    </div>\n    <template v-for=\"interaction in visibleInteractions\" :key=\"interaction.id\">\n      <LmbTaskInteraction\n        v-if=\"interaction.type === 'lmbTask'\"\n        :id=\"`interaction-${uid}-${interaction.id}`\"\n        class=\"video-player-interaction\"\n        :style=\"{\n          left: `${interaction.x * 100}%`,\n          top: `${interaction.y * 100}%`,\n        }\"\n        :interaction=\"interaction\"\n        @click=\"editor?.selectInteraction(interaction.id)\"\n        @pointerdown=\"onPointerDownInteraction($event, interaction)\"\n        @pointermove=\"onPointerMoveInteraction($event, interaction)\"\n        @pointerup=\"onPointerUpInteraction($event, interaction)\"\n        @activateInteraction=\"activateInteraction\"\n      />\n      <OverlayInteraction\n        v-else-if=\"interaction.type === 'overlay'\"\n        :id=\"`interaction-${uid}-${interaction.id}`\"\n        class=\"video-player-interaction\"\n        :style=\"{\n          left: `${interaction.x * 100}%`,\n          top: `${interaction.y * 100}%`,\n          width: `${interaction.width * 100}%`,\n          height: `${interaction.height * 100}%`,\n        }\"\n        :interaction=\"interaction\"\n        @click=\"editor?.selectInteraction(interaction.id)\"\n        @pointerdown=\"onPointerDownInteraction($event, interaction)\"\n        @pointermove=\"onPointerMoveInteraction($event, interaction)\"\n        @pointerup=\"onPointerUpInteraction($event, interaction)\"\n        @pointerDownResizeHandle=\"onPointerDownResizeHandle\"\n        @pointerMoveResizeHandle=\"onPointerMoveResizeHandle\"\n        @pointerUpResizeHandle=\"onPointerUpResizeHandle\"\n      />\n    </template>\n    <Transition name=\"fade\">\n      <div\n        v-if=\"activeInteraction?.type === 'lmbTask'\"\n        class=\"active-interaction-container\"\n        @click.self=\"closeInteraction\"\n      >\n        <div class=\"active-interaction\">\n          <h1>\n            {{ printTaskType(activeInteraction.taskDefinition.task_type) }}\n          </h1>\n          <component\n            :is=\"viewerForTaskType(activeInteraction.taskDefinition.task_type)\"\n            :task=\"activeInteraction.taskDefinition\"\n          />\n          <button type=\"button\" class=\"button cancel\" @click=\"closeInteraction\">\n            {{ $gettext('Schlieen') }}\n          </button>\n        </div>\n      </div>\n    </Transition>\n  </div>\n</template>\n\n<style scoped lang=\"scss\">\n.drag-in-progress > :not(.video-player-interaction) {\n  pointer-events: none;\n}\n\n.video-player-root {\n  position: relative;\n  overflow: hidden;\n}\n.selected-interaction-tooltip {\n  &.hidden {\n    display: none;\n  }\n  z-index: 2;\n  position: absolute;\n  display: flex;\n  gap: 0.5em;\n  background: white;\n  color: black;\n  border-radius: 12px;\n  border: 2px solid black;\n  padding: 8px;\n  > .arrow,\n  > .arrow::before {\n    position: absolute;\n    width: 8px;\n    height: 8px;\n    background: inherit;\n  }\n\n  > .arrow {\n    visibility: hidden;\n  }\n\n  > .arrow::before {\n    visibility: visible;\n    content: '';\n    transform: rotate(45deg);\n  }\n\n  &[data-popper-placement^='top'] > .arrow {\n    bottom: -4px;\n  }\n\n  &[data-popper-placement^='bottom'] > .arrow {\n    top: -4px;\n  }\n\n  &[data-popper-placement^='left'] > .arrow {\n    right: -4px;\n  }\n\n  &[data-popper-placement^='right'] > .arrow {\n    left: -4px;\n  }\n}\n\n$progress-control-height: 3.5em;\n.progress-bar-interaction-marker {\n  /* CSS Reset for button styles */\n  padding: 0;\n  border: none;\n  font: inherit;\n  color: inherit;\n  background-color: transparent;\n  cursor: pointer;\n  box-sizing: border-box;\n\n  z-index: 3;\n  $radius: 0.5em;\n  position: absolute;\n  bottom: calc($progress-control-height - 1.7em);\n  shape-outside: circle();\n  clip-path: circle();\n  width: $radius;\n  height: $radius;\n  background-color: white;\n  cursor: pointer;\n  &::before {\n    display: block;\n    content: ' ';\n    shape-outside: circle();\n    clip-path: circle();\n    width: calc($radius - 2px);\n    height: calc($radius - 2px);\n    transform: translate(1px, 0px);\n    background-color: rgba(43, 51, 63, 1);\n  }\n\n  &:hover,\n  &:focus {\n    &::before {\n      background-color: white;\n    }\n  }\n  // Ensure that an outline is drawn when element is focused with the keyboard\n  &:focus-visible {\n    clip-path: unset;\n    &::before {\n      border: 2px solid white;\n    }\n  }\n}\n// Ensure that progress bar interaction markers fade out just as the progress bar does\n// when the user is watching the video and not touching the controls\n.video-player-root:has(.vjs-has-started.vjs-user-inactive.vjs-playing) {\n  .progress-bar-interaction-marker {\n    opacity: 0;\n    transition: opacity 1s;\n  }\n}\n.video-player-root:not(:has(.vjs-has-started)) {\n  .progress-bar-interaction-marker {\n    display: none;\n  }\n}\n\n.cancel-selection-overlay {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 2.5em;\n}\n.video-player-interaction {\n  position: absolute;\n  &:focus {\n    z-index: 2;\n  }\n}\n.active-interaction-container {\n  z-index: 3;\n  position: absolute;\n  top: 0;\n  left: 0;\n  height: 100%;\n  width: 100%;\n\n  .active-interaction {\n    position: absolute;\n    top: 1em;\n    bottom: 1em;\n    left: 1em;\n    right: 1em;\n    background: white;\n    padding: 1em;\n    overflow: auto;\n  }\n}\n.fade-enter-active,\n.fade-leave-active {\n  transition: opacity 0.3s ease;\n}\n.fade-enter-from,\n.fade-leave-to {\n  opacity: 0;\n}\n</style>\n\n<style lang=\"scss\">\n$progress-control-height: 3.5em;\n.video-player-root .video-js {\n  .vjs-control-bar {\n    height: $progress-control-height;\n    padding-top: 0.5em;\n    // Make sure the video controls are not hidden by any Interactions the\n    // teacher/content creator has placed\n    z-index: 3;\n\n    // Un-hide these elements -- they have display: none in videojs default css.\n    .vjs-current-time {\n      display: flex;\n      padding: 0;\n    }\n    .vjs-time-divider {\n      display: inline;\n      min-width: fit-content;\n      padding-left: 0.5em;\n      padding-right: 0.5em;\n    }\n    .vjs-duration {\n      display: flex;\n      padding: 0;\n    }\n  }\n}\n</style>\n","// Types for the Interactive Video task type.\nimport { z } from 'zod';\nimport {\n  iconForTaskType,\n  printTaskType,\n  taskDefinitionSchemaMinusInteractiveVideo,\n} from '@/models/TaskDefinition';\nimport { $gettext } from '@/language/gettext';\nimport { wysiwygUploadedFileSchema } from '@/routes/lernmodule';\n\n// There are different types of 'interaction' which can be added to the video.\n// TODO Maybe put the 'base' attributes shared by all types of interaction all in one place.\n// TODO I think it may be wiser to use 'startTime' and 'duration' rather than 'startTime' and 'endTime'.\n// I chose to use 'start' and 'end' because it made the ui in one place easier to implement\n// (v-model for 'end time' input field), but I have noticed that I must calculate a duration\n// by hand in many other places anyway.\n\n/**\n * @deprecated -- Text field renamed to content_wysiwyg to simplify implementation\n * of file export in PHP.\n */\nconst overlaySchema_v1 = z.object({\n  type: z.literal('overlay'),\n  id: z.string(),\n  startTime: z.number(), // Seconds\n  endTime: z.number(), // Seconds\n  x: z.number(), // Position, as a fraction of video width, between 0 and 1\n  y: z.number(), // Position, as a fraction of video height, between 0 and 1\n  width: z.number(), // Width, as a fraction of video width, between 0 and 1\n  height: z.number(), // Height, as a fraction of video width, between 0 and 1\n  text: z.string(), // Sanitized HTML from Wysiwyg editor\n  pauseWhenVisible: z.boolean().optional().default(true),\n});\nconst overlaySchema_v2 = overlaySchema_v1.omit({ text: true }).extend({\n  v: z.literal(2), // Schema version\n  content_wysiwyg: z.string(), // Sanitized HTML from Wysiwyg editor\n});\n// Overlay: An overlay is shown on top of the video over a span of time\nconst overlaySchema = z\n  .union([overlaySchema_v1, overlaySchema_v2])\n  .transform((val): z.infer<typeof overlaySchema_v2> => {\n    if (!Object.hasOwn(val, 'v')) {\n      // Migration from v1 to v2\n      const val_v1 = val as z.infer<typeof overlaySchema_v1>;\n      const { text, ...val_v1_rest } = val_v1;\n      const val_v2 = {\n        v: 2,\n        content_wysiwyg: text,\n        ...val_v1_rest,\n      } as z.infer<typeof overlaySchema_v2>;\n      console.log(\n        'Migrating from overlaySchema_v1 to overlaySchema_v2',\n        'v1:',\n        val_v1,\n        'v2:',\n        val_v2\n      );\n      return val_v2;\n    } else {\n      return val as z.infer<typeof overlaySchema_v2>;\n    }\n  });\nexport type OverlayInteraction = z.infer<typeof overlaySchema_v2>;\n\n// LMB Task interaction: A Lernmodule Block Task (LMB Task) is shown at a given\n// point in the video for the student to solve.\nconst lmbTaskInteractionSchema = z.object({\n  type: z.literal('lmbTask'),\n  id: z.string(),\n  startTime: z.number(), // Seconds\n  endTime: z.number(), // Seconds\n  x: z.number(), // Position, as a fraction of video width, between 0 and 1\n  y: z.number(), // Position, as a fraction of video height, between 0 and 1\n  taskDefinition: z.lazy(() => taskDefinitionSchemaMinusInteractiveVideo),\n  pauseWhenVisible: z.boolean().optional().default(true),\n});\nexport type LmbTaskInteraction = z.infer<typeof lmbTaskInteractionSchema>;\n\nconst interactiveVideoInteractionSchema = z\n  .union([overlaySchema, lmbTaskInteractionSchema])\n  .refine((data) => data.endTime > data.startTime, {\n    message: 'endTime cannot be earlier than startTime',\n    path: ['endTime'],\n  });\nexport type Interaction = z.infer<typeof interactiveVideoInteractionSchema>;\n\nconst noVideoSchema = z.object({\n  type: z.literal('none'),\n});\nexport type NoVideo = z.infer<typeof noVideoSchema>;\nconst youtubeVideoSchema = z.object({\n  type: z.literal('youtube'),\n  url: z.string(),\n});\nexport type YoutubeVideo = z.infer<typeof youtubeVideoSchema>;\n\n/**\n * @deprecated -- File is now stored as ID instead of url,name,type.\n */\nconst studipFileVideoSchema_v1 = z.object({\n  type: z.literal('studipFileReference'),\n  file: wysiwygUploadedFileSchema,\n});\nconst studipFileVideoSchema_v2 = z.object({\n  v: z.literal(2),\n  type: z.literal('studipFileReference'),\n  file_id: z.string(),\n});\nconst studipFileVideoSchema = z\n  .union([studipFileVideoSchema_v1, studipFileVideoSchema_v2])\n  .transform((val) => {\n    if (!Object.hasOwn(val, 'v')) {\n      // Migration from v1 to v2\n      const val_v1 = val as z.infer<typeof studipFileVideoSchema_v1>;\n      const urlParams = new URLSearchParams(val_v1.file.url);\n      const file_id = urlParams.get('file_id');\n      if (!file_id) {\n        throw new Error(\n          'Could not migrate studip file reference schema v1 to v2. The query param ' +\n            `\"file_id\" was not found in the string file.url: \"${val_v1.file.url}\"`\n        );\n      }\n      const val_v2 = {\n        v: 2,\n        type: 'studipFileReference',\n        file_id,\n      } as z.infer<typeof studipFileVideoSchema_v2>;\n      console.log(\n        'Migrating from studipFileVideoSchema_v1 to studipFileVideoSchema_v2',\n        'v1:',\n        val_v1,\n        'v2:',\n        val_v2\n      );\n      return val_v2;\n    } else {\n      return val as z.infer<typeof studipFileVideoSchema_v2>;\n    }\n  });\nexport type StudipFileVideo = z.infer<typeof studipFileVideoSchema>;\n\nconst videoSchema = z.union([\n  noVideoSchema,\n  youtubeVideoSchema,\n  studipFileVideoSchema,\n]);\nexport type Video = z.infer<typeof videoSchema>;\n\nexport const travisGoSettingsSchema = z.object({\n  enabled: z.boolean(),\n  projectTitle: z.string(),\n  projectDescription: z.string(),\n});\nexport type TravisGoSettings = z.infer<typeof travisGoSettingsSchema>;\n\nexport const interactiveVideoTaskSchema = z.object({\n  task_type: z.literal('InteractiveVideo'),\n  video: videoSchema,\n  autoplay: z.boolean().optional().default(false),\n  startAt: z.number().optional().default(0),\n  disableNavigation: z\n    .union([\n      z.literal('not disabled'),\n      z.literal('forward disabled'),\n      z.literal('forward and backward disabled'),\n    ])\n    .default('not disabled'),\n  interactions: z.array(interactiveVideoInteractionSchema),\n  travisGoSettings: travisGoSettingsSchema.optional().default(\n    (): TravisGoSettings => ({\n      enabled: false,\n      projectTitle: '',\n      projectDescription: '',\n    })\n  ),\n});\nexport type InteractiveVideoTask = z.infer<typeof interactiveVideoTaskSchema>;\n\nexport function printInteractionType(interaction: Interaction): string {\n  switch (interaction.type) {\n    case 'lmbTask':\n      return printTaskType(interaction.taskDefinition.task_type);\n    case 'overlay':\n      return $gettext('Einblendung');\n  }\n}\n\nexport function iconForInteraction(interaction: Interaction): string {\n  switch (interaction.type) {\n    case 'overlay':\n      return 'item';\n    case 'lmbTask':\n      return iconForTaskType(interaction.taskDefinition.task_type);\n  }\n}\n\nexport const resizeHandles = [\n  'left',\n  'top-left',\n  'top',\n  'top-right',\n  'right',\n  'bottom-right',\n  'bottom',\n  'bottom-left',\n] as const;\nexport type ResizeHandle = typeof resizeHandles[number];\n\nconst permissionsSchema = z.object({\n  mayEdit: z.boolean(),\n  mayDelete: z.boolean(),\n});\n\nconst travisGoPostTypeSchema = z.union([\n  z.literal('meta'),\n  z.literal('image'),\n  z.literal('audio'),\n  z.literal('text'),\n]);\nexport type TravisGoPostType = z.infer<typeof travisGoPostTypeSchema>;\nconst travisGoPostEditableKeys = {\n  video_id: z.string(),\n  video_type: z.enum(['lernmodule_module', 'cw_blocks']),\n  start_time: z.coerce.number(),\n  end_time: z.coerce.number().nullable(),\n  contents: z.string(),\n  post_type: travisGoPostTypeSchema,\n};\n\nexport const travisGoPostSchema = z.object({\n  attributes: z.object({\n    id: z.string(),\n    mk_user_id: z.string(),\n    mkdate: z.string().datetime({ offset: true }),\n    chdate: z.string().datetime({ offset: true }),\n    ...travisGoPostEditableKeys,\n  }),\n  meta: z.object({ permissions: permissionsSchema }),\n});\nexport type TravisGoPost = z.infer<typeof travisGoPostSchema>;\n\nexport const createPostRequestSchema = z.object(travisGoPostEditableKeys);\nexport type CreatePostRequest = z.infer<typeof createPostRequestSchema>;\nexport const updatePostRequestSchema = z.object({\n  id: z.string(),\n  attributes: z.object({\n    start_time: z.coerce.number(),\n    end_time: z.coerce.number().nullable(),\n    contents: z.string(),\n    post_type: travisGoPostTypeSchema,\n  }),\n});\n\nexport type UpdatePostRequest = z.infer<typeof updatePostRequestSchema>;\n\nconst travisGoCommentEditableKeys = {\n  post_id: z.string(),\n  contents: z.string(),\n};\n\nexport const travisGoCommentSchema = z.object({\n  attributes: z.object({\n    id: z.string(),\n    mk_user_id: z.string(),\n    mkdate: z.string().datetime({ offset: true }),\n    chdate: z.string().datetime({ offset: true }),\n    ...travisGoCommentEditableKeys,\n  }),\n  meta: z.object({ permissions: permissionsSchema }),\n});\nexport type TravisGoComment = z.infer<typeof travisGoCommentSchema>;\n\nexport const createCommentRequestSchema = z.object({\n  attributes: z.object(travisGoCommentEditableKeys),\n});\nexport type CreateCommentRequest = z.infer<typeof createCommentRequestSchema>;\n\nexport const updateCommentRequestSchema = z.object({\n  id: z.string(),\n  attributes: z.object({\n    contents: z.string(),\n  }),\n});\nexport type UpdateCommentRequest = z.infer<typeof updateCommentRequestSchema>;\n","import { InjectionKey, Ref } from 'vue';\nimport {\n  DragState,\n  TimelineDragState,\n} from '@/components/interactiveVideo/editor/events';\n\n/**\n * In the Interactive Video Editor, we use provide/inject to pass data to many\n * different components at once without prop drilling.\n * There is a little bit of ceremony required to have the passed data be statically typed.\n * https://vuejs.org/guide/typescript/composition-api.html#typing-provide-inject\n */\nexport const interactiveVideoEditorStateSymbol = Symbol(\n  'Interactive Video Editor state'\n) as InjectionKey<InteractiveVideoEditorState>;\n\nexport interface InteractiveVideoEditorState {\n  selectedInteractionId: Ref<string | undefined>;\n  selectInteraction(id: string | undefined): void;\n  editInteraction(id: string): void;\n  dragInteraction(\n    interactionId: string,\n    clampedXFraction: number,\n    clampedYFraction: number,\n    dragState: DragState\n  ): void;\n  resizeOverlay(\n    id: string,\n    x: number,\n    y: number,\n    width: number,\n    height: number,\n    dragState: DragState\n  ): void;\n  deleteInteraction(interactionId: string): void;\n\n  dragInteractionTimeline(\n    id: string,\n    startTime: number,\n    dragState: TimelineDragState\n  ): void;\n  resizeInteractionTimeline(\n    id: string,\n    type: 'start' | 'end',\n    time: number,\n    dragState: TimelineDragState\n  ): void;\n}\n","import { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, normalizeClass as _normalizeClass, openBlock as _openBlock, createElementBlock as _createElementBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-75680916\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = [\"data-hover-tooltip\"]\nconst _hoisted_2 = { class: \"interaction-label\" }\nconst _hoisted_3 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", { class: \"icon-circle-border\" }, null, -1))\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  return (_openBlock(), _createElementBlock(\"button\", {\n    type: \"button\",\n    class: _normalizeClass([\"lmb-task-interaction\", {\n      selected: _ctx.editor?.selectedInteractionId.value === _ctx.interaction.id,\n      editor: !!_ctx.editor,\n    }]),\n    \"data-hover-tooltip\": _ctx.printTaskType(_ctx.interaction.taskDefinition.task_type),\n    onClick: _cache[0] || (_cache[0] = ($event: any) => (!this.editor && _ctx.$emit('activateInteraction', _ctx.interaction)))\n  }, [\n    _createElementVNode(\"div\", _hoisted_2, _toDisplayString(_ctx.printTaskType(_ctx.interaction.taskDefinition.task_type)), 1),\n    _hoisted_3,\n    _createElementVNode(\"div\", {\n      class: _normalizeClass([\"icon-circle button no-hover-effect\", _ctx.iconForTaskType(_ctx.interaction.taskDefinition.task_type)])\n    }, null, 2)\n  ], 10, _hoisted_1))\n}","<script lang=\"ts\">\nimport { defineComponent, inject, PropType } from 'vue';\nimport {\n  InteractiveVideoEditorState,\n  interactiveVideoEditorStateSymbol,\n} from '@/components/interactiveVideo/editor/interactiveVideoEditorState';\nimport { Interaction, LmbTaskInteraction } from '@/models/InteractiveVideoTask';\nimport { iconForTaskType, printTaskType } from '@/models/TaskDefinition';\n\nexport default defineComponent({\n  name: 'LmbTaskInteraction',\n  methods: { iconForTaskType, printTaskType },\n  setup() {\n    return {\n      editor: inject<InteractiveVideoEditorState | undefined>(\n        interactiveVideoEditorStateSymbol,\n        undefined\n      ),\n    };\n  },\n  props: {\n    interaction: {\n      type: Object as PropType<LmbTaskInteraction>,\n      required: true,\n    },\n  },\n});\n</script>\n\n<template>\n  <button\n    type=\"button\"\n    class=\"lmb-task-interaction\"\n    :class=\"{\n      selected: editor?.selectedInteractionId.value === interaction.id,\n      editor: !!editor,\n    }\"\n    :data-hover-tooltip=\"printTaskType(interaction.taskDefinition.task_type)\"\n    @click=\"!this.editor && $emit('activateInteraction', interaction)\"\n  >\n    <div class=\"interaction-label\">\n      {{ printTaskType(interaction.taskDefinition.task_type) }}\n    </div>\n    <div class=\"icon-circle-border\"></div>\n    <div\n      class=\"icon-circle button no-hover-effect\"\n      :class=\"iconForTaskType(interaction.taskDefinition.task_type)\"\n    ></div>\n  </button>\n</template>\n\n<style scoped lang=\"scss\">\nbutton.lmb-task-interaction {\n  /* CSS Reset for button styles */\n  padding: 0;\n  border: none;\n  font: inherit;\n  color: inherit;\n  background-color: transparent;\n  cursor: pointer;\n  box-sizing: border-box;\n\n  $border-width: 0.2em;\n  $circle-radius: 3em;\n\n  > .icon-circle {\n    position: absolute;\n    top: $border-width;\n    left: $border-width;\n    background: #c3abd1;\n    shape-outside: circle();\n    clip-path: circle();\n    width: $circle-radius;\n    height: $circle-radius;\n    /* Position the icon centered inside the circle */\n    &::before {\n      transform: translate(\n          calc($circle-radius / 2),\n          calc($circle-radius / 2 - 0.6em)\n        )\n        scale(1.3);\n      filter: grayscale(1) contrast(1.5);\n    }\n  }\n  &:hover > .icon-circle {\n    background: var(--dark-violet-20);\n  }\n\n  > .interaction-label {\n    display: flex;\n    align-items: center;\n    position: absolute;\n    left: calc($circle-radius / 2);\n    padding-left: calc($circle-radius / 2 + 0.5em + $border-width);\n    padding-right: 0.5em;\n    top: calc(0.1em + $border-width);\n    white-space: nowrap;\n    height: calc($circle-radius - 0.2em);\n    background: var(--dark-gray-color-15);\n    border-radius: 12px;\n  }\n\n  &.selected {\n    z-index: 1;\n    > .interaction-label {\n      border: $border-width solid var(--base-gray);\n      margin-top: calc(-1 * $border-width);\n      margin-left: calc(-1 * $border-width);\n    }\n    .icon-circle-border {\n      shape-outside: circle();\n      clip-path: circle();\n      width: calc($circle-radius + 2 * $border-width);\n      height: calc($circle-radius + 2 * $border-width);\n      background: var(--base-gray);\n    }\n  }\n\n  /* This provides a bigger, visible focus marker when the user tabs between\n   interactions using the keyboard or assistive device */\n  &:focus:not(.selected) {\n    > .icon-circle-border {\n      shape-outside: circle();\n      clip-path: circle();\n      width: calc($circle-radius + 2 * $border-width);\n      height: calc($circle-radius + 2 * $border-width);\n      background: transparent;\n    }\n  }\n\n  // Display a tooltip when hovered or focused.\n  &.editor:not(.selected) {\n    &:hover::before,\n    &:focus::before {\n      content: attr(data-hover-tooltip);\n      display: flex;\n      align-items: center;\n      white-space: nowrap;\n      position: absolute;\n      top: -2em;\n      /* Center the tooltip over the circle with the icon */\n      transform: translateX(calc(-50% + $circle-radius / 2));\n      height: 1em;\n      padding: 0.35em;\n      border-radius: 12px;\n      background: white;\n      color: black;\n      opacity: 0.9;\n      z-index: 2;\n    }\n  }\n}\n</style>\n","import { render } from \"./LmbTaskInteraction.vue?vue&type=template&id=75680916&scoped=true&ts=true\"\nimport script from \"./LmbTaskInteraction.vue?vue&type=script&lang=ts\"\nexport * from \"./LmbTaskInteraction.vue?vue&type=script&lang=ts\"\n\nimport \"./LmbTaskInteraction.vue?vue&type=style&index=0&id=75680916&scoped=true&lang=scss\"\n\nimport exportComponent from \"../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-75680916\"]])\n\nexport default __exports__","import { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, withModifiers as _withModifiers, normalizeClass as _normalizeClass, createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-69424511\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = [\"data-hover-tooltip\"]\nconst _hoisted_2 = [\"onPointerdown\", \"onPointermove\", \"onPointerup\"]\nconst _hoisted_3 = [\"innerHTML\"]\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  return (_openBlock(), _createElementBlock(\"div\", {\n    class: _normalizeClass([\"overlay\", {\n      selected: _ctx.editor?.selectedInteractionId.value === _ctx.interaction.id,\n      editor: !!_ctx.editor,\n    }]),\n    \"data-hover-tooltip\": _ctx.$gettext('Einblendung')\n  }, [\n    (_ctx.editor)\n      ? (_openBlock(true), _createElementBlock(_Fragment, { key: 0 }, _renderList(_ctx.resizeHandles, (handle) => {\n          return (_openBlock(), _createElementBlock(\"div\", {\n            key: handle,\n            class: _normalizeClass([\"resize-handle\", handle]),\n            onPointerdown: _withModifiers(($event: any) => (_ctx.onPointerDownResizeHandle($event, handle)), [\"stop\"]),\n            onPointermove: _withModifiers(($event: any) => (_ctx.onPointerMoveResizeHandle($event, handle)), [\"stop\"]),\n            onPointerup: _withModifiers(($event: any) => (_ctx.onPointerUpResizeHandle($event, handle)), [\"stop\"])\n          }, null, 42, _hoisted_2))\n        }), 128))\n      : _createCommentVNode(\"\", true),\n    _createElementVNode(\"div\", {\n      class: \"overlay-content\",\n      innerHTML: _ctx.interaction.content_wysiwyg\n    }, null, 8, _hoisted_3)\n  ], 10, _hoisted_1))\n}","<script lang=\"ts\">\nimport { defineComponent, inject, PropType } from 'vue';\nimport {\n  InteractiveVideoEditorState,\n  interactiveVideoEditorStateSymbol,\n} from '@/components/interactiveVideo/editor/interactiveVideoEditorState';\nimport { OverlayInteraction } from '@/models/InteractiveVideoTask';\nimport { $gettext } from '@/language/gettext';\n\nexport default defineComponent({\n  name: 'OverlayInteraction',\n  methods: {\n    $gettext,\n    onPointerDownResizeHandle(event: PointerEvent, handle: string) {\n      this.$emit('pointerDownResizeHandle', {\n        event,\n        handle,\n        interaction: this.interaction,\n      });\n    },\n    onPointerMoveResizeHandle(event: PointerEvent, handle: string) {\n      this.$emit('pointerMoveResizeHandle', {\n        event,\n        handle,\n        interaction: this.interaction,\n      });\n    },\n    onPointerUpResizeHandle(event: PointerEvent, handle: string) {\n      this.$emit('pointerUpResizeHandle', {\n        event,\n        handle,\n        interaction: this.interaction,\n      });\n    },\n  },\n  setup() {\n    return {\n      editor: inject<InteractiveVideoEditorState | undefined>(\n        interactiveVideoEditorStateSymbol,\n        undefined\n      ),\n    };\n  },\n  data() {\n    return {\n      resizeHandles: [\n        'left',\n        'top-left',\n        'top',\n        'top-right',\n        'right',\n        'bottom-right',\n        'bottom',\n        'bottom-left',\n      ],\n    };\n  },\n  props: {\n    interaction: {\n      type: Object as PropType<OverlayInteraction>,\n      required: true,\n    },\n  },\n});\n</script>\n\n<template>\n  <div\n    class=\"overlay\"\n    :class=\"{\n      selected: editor?.selectedInteractionId.value === interaction.id,\n      editor: !!editor,\n    }\"\n    :data-hover-tooltip=\"$gettext('Einblendung')\"\n  >\n    <template v-if=\"editor\">\n      <div\n        v-for=\"handle in resizeHandles\"\n        :key=\"handle\"\n        class=\"resize-handle\"\n        :class=\"handle\"\n        @pointerdown.stop=\"onPointerDownResizeHandle($event, handle)\"\n        @pointermove.stop=\"onPointerMoveResizeHandle($event, handle)\"\n        @pointerup.stop=\"onPointerUpResizeHandle($event, handle)\"\n      />\n    </template>\n    <div class=\"overlay-content\" v-html=\"interaction.content_wysiwyg\" />\n  </div>\n</template>\n\n<style scoped lang=\"scss\">\n.overlay {\n  background: var(--dark-gray-color-15);\n  box-sizing: border-box;\n  border-radius: 10px;\n  padding: 0.5em;\n  position: relative;\n\n  .overlay-content {\n    height: 100%;\n    width: 100%;\n    overflow: hidden;\n  }\n\n  &.editor {\n    cursor: pointer;\n  }\n\n  &.editor .overlay-content {\n    // Prevent accidentally selecting text, activating links or \"dragging\"\n    // embedded images when dragging/dropping the overlay in the editor\n    pointer-events: none;\n    user-select: none;\n  }\n\n  &.selected {\n    z-index: 1;\n    border: 0.2em solid black;\n  }\n\n  // Display a tooltip when hovered or focused.\n  &.editor:not(.selected) {\n    &:hover::before,\n    &:focus::before {\n      content: attr(data-hover-tooltip);\n      display: flex;\n      align-items: center;\n      white-space: nowrap;\n      position: absolute;\n      top: -2em;\n      left: 50%;\n      transform: translateX(-50%);\n      height: 1em;\n      padding: 0.35em;\n      border-radius: 12px;\n      background: white;\n      color: black;\n      opacity: 0.9;\n      z-index: 2;\n    }\n  }\n\n  .resize-handle {\n    $size: 8px;\n    position: absolute;\n    //background: cornflowerblue;\n    &.top {\n      cursor: ns-resize;\n      top: 0;\n      left: $size;\n      right: $size;\n      height: $size;\n    }\n    &.top-right {\n      cursor: nesw-resize;\n      top: 0;\n      right: 0;\n      height: $size;\n      width: $size;\n    }\n    &.right {\n      cursor: ew-resize;\n      top: $size;\n      bottom: $size;\n      right: 0;\n      width: $size;\n    }\n    &.bottom-right {\n      cursor: nwse-resize;\n      bottom: 0;\n      right: 0;\n      width: $size;\n      height: $size;\n    }\n    &.bottom {\n      cursor: ns-resize;\n      bottom: 0;\n      left: $size;\n      right: $size;\n      height: $size;\n    }\n    &.bottom-left {\n      cursor: nesw-resize;\n      bottom: 0;\n      left: 0;\n      width: $size;\n      height: $size;\n    }\n    &.left {\n      cursor: ew-resize;\n      top: $size;\n      bottom: $size;\n      left: 0;\n      width: $size;\n    }\n    &.top-left {\n      cursor: nwse-resize;\n      top: 0;\n      left: 0;\n      height: $size;\n      width: $size;\n    }\n  }\n}\n</style>\n","import { render } from \"./OverlayInteraction.vue?vue&type=template&id=69424511&scoped=true&ts=true\"\nimport script from \"./OverlayInteraction.vue?vue&type=script&lang=ts\"\nexport * from \"./OverlayInteraction.vue?vue&type=script&lang=ts\"\n\nimport \"./OverlayInteraction.vue?vue&type=style&index=0&id=69424511&scoped=true&lang=scss\"\n\nimport exportComponent from \"../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-69424511\"]])\n\nexport default __exports__","import { render } from \"./VideoPlayer.vue?vue&type=template&id=571a793f&scoped=true&ts=true\"\nimport script from \"./VideoPlayer.vue?vue&type=script&lang=ts\"\nexport * from \"./VideoPlayer.vue?vue&type=script&lang=ts\"\n\nimport \"./VideoPlayer.vue?vue&type=style&index=0&id=571a793f&scoped=true&lang=scss\"\nimport \"./VideoPlayer.vue?vue&type=style&index=1&id=571a793f&lang=scss\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-571a793f\"]])\n\nexport default __exports__","import { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, normalizeClass as _normalizeClass, withModifiers as _withModifiers, normalizeStyle as _normalizeStyle, createCommentVNode as _createCommentVNode, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-7caf349f\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"tick-label\" }\nconst _hoisted_2 = [\"onClick\", \"title\"]\nconst _hoisted_3 = { class: \"timeline-interactions\" }\nconst _hoisted_4 = [\"title\"]\nconst _hoisted_5 = { class: \"overflow-container\" }\nconst _hoisted_6 = [\"onClick\", \"onPointerdown\", \"onPointermove\", \"onPointerup\"]\nconst _hoisted_7 = { class: \"timeline-interaction-label\" }\nconst _hoisted_8 = [\"title\", \"onClick\"]\nconst _hoisted_9 = [\"onPointerdown\", \"onPointermove\", \"onPointerup\"]\nconst _hoisted_10 = [\"onPointerdown\", \"onPointermove\", \"onPointerup\"]\nconst _hoisted_11 = { style: {\"white-space\":\"pre-wrap\",\"display\":\"none\"} }\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  return (_openBlock(), _createElementBlock(\"div\", {\n    ref: \"root\",\n    class: \"timeline-root\",\n    onDragoverCapture: _cache[6] || (_cache[6] = \n//@ts-ignore\n(...args) => (_ctx.onDragOverTimeline && _ctx.onDragOverTimeline(...args)))\n  }, [\n    _createElementVNode(\"div\", {\n      class: \"timeline-axis\",\n      ref: \"timelineAxis\",\n      onPointerdown: _cache[1] || (_cache[1] = \n//@ts-ignore\n(...args) => (_ctx.onPointerDownAxis && _ctx.onPointerDownAxis(...args)))\n    }, [\n      (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.axisScale, (point, index) => {\n        return (_openBlock(), _createElementBlock(\"div\", {\n          class: \"tick\",\n          key: index\n        }, [\n          _createElementVNode(\"div\", _hoisted_1, _toDisplayString(index % 5 === 0 ? _ctx.formatVideoTimestamp(point) : ' '), 1),\n          _createElementVNode(\"div\", {\n            class: _normalizeClass([\"tick-line\", {\n            major: index % 5 === 0,\n          }])\n          }, null, 2)\n        ]))\n      }), 128)),\n      (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.visibleInteractions, (interaction) => {\n        return (_openBlock(), _createElementBlock(\"button\", {\n          key: interaction.id,\n          class: \"interaction-marker\",\n          style: _normalizeStyle(_ctx.interactionMarkerStyle(interaction)),\n          onPointerdown: _cache[0] || (_cache[0] = _withModifiers(() => {}, [\"stop\"])),\n          onClick: _withModifiers(($event: any) => {\n          _ctx.onClickInteraction(interaction);\n          _ctx.$emit('timelineSeek', interaction.startTime + 0.1);\n        }, [\"stop\"]),\n          title: \n          _ctx.$gettext('Zu %{ interaction } springen', {\n            interaction: _ctx.printInteractionType(interaction),\n          })\n        \n        }, null, 44, _hoisted_2))\n      }), 128))\n    ], 544),\n    _createElementVNode(\"div\", {\n      class: _normalizeClass([\"timeline\", { 'pan-timeline': this.dragState?.type === 'panTimeline' }]),\n      ref: \"timeline\",\n      onPointerdown: _cache[3] || (_cache[3] = _withModifiers(\n//@ts-ignore\n(...args) => (_ctx.onPointerDownAxis && _ctx.onPointerDownAxis(...args)), [\"self\"])),\n      onWheel: _cache[4] || (_cache[4] = \n//@ts-ignore\n(...args) => (_ctx.onWheel && _ctx.onWheel(...args))),\n      onContextmenu: _cache[5] || (_cache[5] = _withModifiers(() => {}, [\"prevent\"]))\n    }, [\n      _createElementVNode(\"div\", _hoisted_3, [\n        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.visibleInteractions, (interaction) => {\n          return (_openBlock(), _createElementBlock(\"div\", {\n            key: interaction.id,\n            class: _normalizeClass([\"timeline-interaction\", {\n            selected: _ctx.selectedInteractionId === interaction.id,\n          }]),\n            style: _normalizeStyle(_ctx.timelineInteractionStyle(interaction)),\n            title: _ctx.printInteractionType(interaction)\n          }, [\n            _createElementVNode(\"div\", _hoisted_5, [\n              _createElementVNode(\"button\", {\n                type: \"button\",\n                class: _normalizeClass([\"button select-interaction\", _ctx.iconForInteraction(interaction)]),\n                onClick: _withModifiers(($event: any) => (_ctx.onClickInteraction(interaction)), [\"stop\"]),\n                onPointerdown: ($event: any) => (_ctx.onPointerDownInteraction($event, interaction)),\n                onPointermove: ($event: any) => (_ctx.onPointerMoveInteraction($event, interaction)),\n                onPointerup: ($event: any) => (_ctx.onPointerUpInteraction($event, interaction))\n              }, [\n                _createElementVNode(\"span\", _hoisted_7, _toDisplayString(_ctx.printInteractionType(interaction)), 1)\n              ], 42, _hoisted_6),\n              (interaction.endTime < _ctx.viewportEnd)\n                ? (_openBlock(), _createElementBlock(\"button\", {\n                    key: 0,\n                    type: \"button\",\n                    class: \"small-button trash delete-interaction\",\n                    title: _ctx.$gettext('Lschen'),\n                    onClick: ($event: any) => (_ctx.$emit('deleteInteraction', interaction.id))\n                  }, null, 8, _hoisted_8))\n                : _createCommentVNode(\"\", true)\n            ]),\n            _createElementVNode(\"div\", {\n              class: \"interaction-drag-handle start\",\n              onPointerdown: ($event: any) => (_ctx.onPointerDownInteractionStart($event, interaction)),\n              onPointermove: ($event: any) => (_ctx.onPointerMoveInteractionStart($event, interaction)),\n              onPointerup: ($event: any) => (_ctx.onPointerUpInteractionStart($event, interaction))\n            }, null, 40, _hoisted_9),\n            _createElementVNode(\"div\", {\n              class: \"interaction-drag-handle end\",\n              onPointerdown: ($event: any) => (_ctx.onPointerDownInteractionEnd($event, interaction)),\n              onPointermove: ($event: any) => (_ctx.onPointerMoveInteractionEnd($event, interaction)),\n              onPointerup: ($event: any) => (_ctx.onPointerUpInteractionEnd($event, interaction))\n            }, null, 40, _hoisted_10)\n          ], 14, _hoisted_4))\n        }), 128))\n      ]),\n      _createElementVNode(\"div\", {\n        class: \"time-marker\",\n        draggable: \"true\",\n        onDragstart: _cache[2] || (_cache[2] = \n//@ts-ignore\n(...args) => (_ctx.onDragStartTimeMarker && _ctx.onDragStartTimeMarker(...args))),\n        style: _normalizeStyle({\n          left: _ctx.positionForTimeMarker,\n        })\n      }, null, 36)\n    ], 34),\n    _createElementVNode(\"div\", _hoisted_11, _toDisplayString({\n          zoomTransform: _ctx.zoomTransform,\n          viewportWidthEm: _ctx.viewportWidthEm,\n          viewportWidthSeconds: _ctx.viewportWidthSeconds,\n          viewportStart: _ctx.viewportStart,\n          viewportEnd: _ctx.viewportEnd,\n          dragState: _ctx.dragState,\n        }), 1)\n  ], 544))\n}","<script lang=\"ts\">\nimport {\n  ComponentPublicInstance,\n  defineComponent,\n  inject,\n  PropType,\n  StyleValue,\n} from 'vue';\nimport {\n  TimelineDragState,\n  VideoMetadata,\n} from '@/components/interactiveVideo/editor/events';\nimport { throttle } from 'lodash';\nimport {\n  iconForInteraction,\n  Interaction,\n  InteractiveVideoTask,\n  printInteractionType,\n} from '@/models/InteractiveVideoTask';\nimport { $gettext } from '@/language/gettext';\nimport {\n  InteractiveVideoEditorState,\n  interactiveVideoEditorStateSymbol,\n} from '@/components/interactiveVideo/editor/interactiveVideoEditorState';\nimport getEmValueFromElement from '@/components/interactiveVideo/getEmValueFromElement';\nimport { select } from 'd3-selection';\nimport { D3DragEvent, drag } from 'd3-drag';\nimport { formatVideoTimestamp } from '@/components/interactiveVideo/formatVideoTimestamp';\n\nexport default defineComponent({\n  name: 'VideoTimeline',\n  setup() {\n    return {\n      editor: inject<InteractiveVideoEditorState>(\n        interactiveVideoEditorStateSymbol\n      ),\n    };\n  },\n  props: {\n    currentTime: {\n      type: Number,\n      required: true,\n    },\n    videoMetadata: {\n      type: Object as PropType<VideoMetadata>,\n      required: true,\n    },\n    task: {\n      type: Object as PropType<InteractiveVideoTask>,\n      required: true,\n    },\n    selectedInteractionId: {\n      type: String,\n      required: false,\n    },\n  },\n  data() {\n    return {\n      dragState: undefined as TimelineDragState,\n      zoomTransform: { t: 0, k: 1 },\n      viewportWidthEm: 1,\n    };\n  },\n  mounted() {\n    // When timeline axis becomes visible, its width should be recalculated.\n    // TODO recalculate also when it changes size (e.g. window is resized)\n    const observer = new IntersectionObserver(() =>\n      this.recomputeViewportWidth()\n    );\n    observer.observe(this.$refs.timelineAxis as HTMLElement);\n\n    // Set up d3-drag\n    const dragTimeline = (ev: D3DragEvent<HTMLElement, unknown, unknown>) => {\n      const dSeconds = this.pixelsToSeconds(ev.dx);\n      const translate = this.zoomTransform.t - dSeconds;\n      this.zoomTransform.t = this.constrainZoomTranslate(translate);\n    };\n    const dragBehavior = drag<HTMLElement, unknown>()\n      .filter((event: D3DragEvent<HTMLElement, unknown, unknown>) => {\n        return (event as any).button !== 0; // All buttons except 'left click'\n      })\n      .on('start', () => {\n        this.dragState = { type: 'panTimeline' };\n      })\n      .on('drag', dragTimeline)\n      .on('end', () => {\n        this.dragState = undefined;\n      });\n    select(this.$refs.timeline as HTMLElement).call(dragBehavior);\n  },\n  watch: {\n    // Automatically scroll timeline to keep the current playback position in view\n    currentTime(currentTime: number) {\n      if (currentTime < this.viewportStart || currentTime > this.viewportEnd) {\n        this.zoomTransform.t = this.constrainZoomTranslate(currentTime - 0.5);\n      }\n    },\n  },\n  computed: {\n    visibleInteractions(): Interaction[] {\n      const visibleInteractions: Interaction[] = [];\n      for (let i of this.task.interactions) {\n        const isWithinViewport =\n          i.startTime < this.viewportEnd && i.endTime > this.viewportStart;\n        // An Interaction element should not suddenly disappear if it is dragged\n        // outside of the timeline viewport. That would cause the drag-drop\n        // interaction to unexpectedly end in a confusing way.\n        const isBeingDragged =\n          (this.dragState?.type === 'interaction' ||\n            this.dragState?.type === 'interactionStart' ||\n            this.dragState?.type === 'interactionEnd') &&\n          this.dragState.id === i.id;\n        if (isWithinViewport || isBeingDragged) {\n          visibleInteractions.push(i);\n        }\n      }\n      return visibleInteractions;\n    },\n    viewportWidthSeconds(): number {\n      const secondsPerEm = 0.5 / this.zoomTransform.k;\n      return this.viewportWidthEm * secondsPerEm;\n    },\n    viewportStart(): number {\n      return this.zoomTransform.t;\n    },\n    viewportEnd(): number {\n      return this.viewportStart + this.viewportWidthSeconds;\n    },\n    positionForTimeMarker(): string {\n      return `${this.secondsToTimelinePercentage(this.currentTime)}%`;\n    },\n    axisScale(): number[] {\n      const points = 25;\n      const start = this.viewportStart;\n      const end = this.viewportEnd;\n      const scale: number[] = [];\n      for (let i = 0; i < points; i++) {\n        scale.push(start + ((end - start) / points) * i);\n      }\n      scale.push(end);\n      return scale;\n    },\n  },\n  methods: {\n    iconForInteraction,\n    printInteractionType,\n    $gettext,\n    secondsToTimelinePercentage(seconds: number): number {\n      const deltaT = seconds - this.viewportStart;\n      return (deltaT / this.viewportWidthSeconds) * 100;\n    },\n    interactionMarkerStyle(\n      interaction: Interaction\n    ): Partial<CSSStyleDeclaration> {\n      return {\n        left: `${this.secondsToTimelinePercentage(interaction.startTime)}%`,\n      };\n    },\n    zoom(delta: number, time?: number) {\n      if (!time) {\n        time = (this.viewportStart + this.viewportEnd) / 2;\n      }\n      // Save information needed to recalculate 't' (translate) parameter after zoom\n      const viewportStart0 = this.zoomTransform.t;\n      const viewportWidth0 = this.viewportWidthSeconds;\n\n      // Calculate new zoom level\n      const exp = Math.exp(delta);\n      const newK = this.zoomTransform.k * exp;\n      // Prevent zooming too far in/out\n      this.zoomTransform.k = Math.max(0.005, Math.min(5, newK));\n\n      // Calculate new translation in order to keep the point under the mouse\n      // cursor stationary.\n      // viewportWidthSeconds is recalculated (because it's a computed property)\n      // after zoomTransform.k is modified in the previous block of code..\n      const viewportWidth1 = this.viewportWidthSeconds;\n      const viewportStart1 =\n        time - ((time - viewportStart0) / viewportWidth0) * viewportWidth1;\n      // Prevent panning before video start or after video end\n      this.zoomTransform.t = this.constrainZoomTranslate(viewportStart1);\n    },\n    onWheel(event: WheelEvent) {\n      event.preventDefault(); // Prevent scrolling page up/down\n      const t = this.xCoordinateToTime(event.clientX);\n      const delta = -event.deltaY / 1000;\n      this.zoom(delta, t);\n    },\n    constrainZoomTranslate(t: number): number {\n      return Math.max(0, Math.min(this.videoMetadata.length, t));\n    },\n    pixelsToEm(pixels: number): number {\n      const timeline = this.$refs.timelineAxis;\n      if (!timeline) {\n        return 1;\n      }\n      return (\n        getEmValueFromElement(this.$refs.timelineAxis as HTMLElement, pixels) ??\n        NaN\n      );\n    },\n    recomputeViewportWidth() {\n      const axis = this.$refs.timelineAxis as HTMLElement | null;\n      if (!axis) {\n        console.warn('recomputeViewportWidth: timelineAxis is null');\n        return;\n      }\n      const rect = axis.getBoundingClientRect();\n      const widthInEm = this.pixelsToEm(rect.width);\n      this.viewportWidthEm = widthInEm;\n    },\n    formatVideoTimestamp,\n    pixelsToSeconds(pixels: number): number {\n      const rect = (\n        this.$refs.timelineAxis as HTMLElement\n      ).getBoundingClientRect();\n      const fraction = pixels / rect.width;\n      return fraction * this.viewportWidthSeconds;\n    },\n    /**\n     * Convert the x coordinate in pixels on the timeline to a time in seconds\n     * in the video, clamped between 0 and the video's length.\n     */\n    xCoordinateToTime(clientX: number): number {\n      const rect = (\n        this.$refs.timelineAxis as HTMLElement\n      ).getBoundingClientRect();\n      const x = clientX - rect.left; //x position within the element.\n      const xFraction = x / rect.width;\n      const time = this.viewportStart + xFraction * this.viewportWidthSeconds;\n      const clampedTime = Math.min(\n        this.videoMetadata.length,\n        Math.max(0, time)\n      );\n      return clampedTime;\n    },\n    timelineInteractionStyle(interaction: Interaction): StyleValue {\n      const startDeltaT = interaction.startTime - this.viewportStart;\n      const startPercent = (startDeltaT / this.viewportWidthSeconds) * 100;\n      const endDeltaT = interaction.endTime - this.viewportStart;\n      const endPercent = (endDeltaT / this.viewportWidthSeconds) * 100;\n      return {\n        left: `${startPercent}%`,\n        width: `${endPercent - startPercent}%`,\n      };\n    },\n    onClickInteraction(interaction: Interaction) {\n      this.$emit('clickInteraction', interaction);\n    },\n    onPointerDownInteraction(event: PointerEvent, interaction: Interaction) {\n      if (event.button !== 0) {\n        // Prevent unintentionally selecting interaction when dragging to\n        // scroll around in the timeline\n        return;\n      }\n      const interactionLength = interaction.endTime - interaction.startTime;\n      this.dragState = {\n        type: 'interaction',\n        id: interaction.id,\n        mouseStartPos: [event.clientX, event.clientY],\n        interactionStartTime: interaction.startTime,\n        interactionDuration: interactionLength,\n      };\n      (event.target as HTMLElement).setPointerCapture(event.pointerId);\n      this.editor!.selectInteraction(interaction.id);\n    },\n    onPointerMoveInteraction(event: PointerEvent, interaction: Interaction) {\n      if (\n        this.dragState?.type === 'interaction' &&\n        this.dragState.id === interaction.id\n      ) {\n        const mouseDx = event.clientX - this.dragState.mouseStartPos[0];\n        const rect = (\n          this.$refs.timelineAxis as HTMLElement\n        ).getBoundingClientRect();\n        const secondsPerPixel = this.viewportWidthSeconds / rect.width;\n        const dSeconds = mouseDx * secondsPerPixel;\n        const seconds = this.dragState.interactionStartTime + dSeconds;\n        // Prevent from dragging so far that the endTime > video length\n        const maxTime =\n          this.videoMetadata.length - this.dragState.interactionDuration;\n        const secondsClamped = Math.max(0, Math.min(maxTime, seconds));\n        const id = this.dragState.id;\n        this.editor!.dragInteractionTimeline(\n          id,\n          secondsClamped,\n          this.dragState\n        );\n      }\n    },\n    onPointerUpInteraction(event: PointerEvent, interaction: Interaction) {\n      this.dragState = undefined;\n      (event.target as HTMLElement).releasePointerCapture(event.pointerId);\n    },\n    onPointerDownInteractionStart(ev: PointerEvent, interaction: Interaction) {\n      this.dragState = {\n        type: 'interactionStart',\n        id: interaction.id,\n        time: interaction.startTime,\n      };\n      (ev.target as HTMLElement).setPointerCapture(ev.pointerId);\n    },\n    onPointerDownInteractionEnd(ev: PointerEvent, interaction: Interaction) {\n      this.dragState = {\n        type: 'interactionEnd',\n        id: interaction.id,\n        time: interaction.endTime,\n      };\n      (ev.target as HTMLElement).setPointerCapture(ev.pointerId);\n    },\n    onPointerMoveInteractionStart(ev: PointerEvent, interaction: Interaction) {\n      if (\n        this.dragState?.type === 'interactionStart' &&\n        this.dragState.id === interaction.id\n      ) {\n        const dSeconds = this.pixelsToSeconds(ev.movementX);\n        this.dragState.time += dSeconds;\n        const timeClamped = Math.max(\n          0,\n          Math.min(interaction.endTime - 1, this.dragState.time)\n        );\n        this.editor!.resizeInteractionTimeline(\n          interaction.id,\n          'start',\n          timeClamped,\n          this.dragState\n        );\n      }\n    },\n    onPointerMoveInteractionEnd(ev: PointerEvent, interaction: Interaction) {\n      if (\n        this.dragState?.type === 'interactionEnd' &&\n        this.dragState.id === interaction.id\n      ) {\n        const dSeconds = this.pixelsToSeconds(ev.movementX);\n        this.dragState.time += dSeconds;\n        const secondsClamped = Math.max(\n          interaction.startTime + 1,\n          Math.min(this.videoMetadata.length, this.dragState.time)\n        );\n        this.editor!.resizeInteractionTimeline(\n          interaction.id,\n          'end',\n          secondsClamped,\n          this.dragState\n        );\n      }\n    },\n    onPointerUpInteractionStart(ev: PointerEvent, interaction: Interaction) {\n      this.dragState = undefined;\n      (ev.target as HTMLElement).releasePointerCapture(ev.pointerId);\n    },\n    onPointerUpInteractionEnd(ev: PointerEvent, interaction: Interaction) {\n      this.dragState = undefined;\n      (ev.target as HTMLElement).releasePointerCapture(ev.pointerId);\n    },\n    onPointerDownAxis(e: PointerEvent) {\n      const time = this.xCoordinateToTime(e.clientX);\n      this.$emit('timelineSeek', time);\n    },\n    onDragStartTimeMarker(e: DragEvent) {\n      this.dragState = { type: 'timeMarker' };\n    },\n    onDragOverTimeline(e: DragEvent) {\n      if (this.dragState?.type === 'timeMarker') {\n        e.preventDefault(); // Stop ghost image from flying back after drop\n        const time = this.xCoordinateToTime(e.clientX);\n        this.emitTimelineSeekThrottled(time);\n      }\n    },\n    emitTimelineSeekThrottled: throttle(function emitTimelineSeek(\n      this: ComponentPublicInstance,\n      time: number\n    ) {\n      this.$emit('timelineSeek', time);\n    },\n    100),\n  },\n});\n</script>\n\n<template>\n  <div ref=\"root\" class=\"timeline-root\" @dragover.capture=\"onDragOverTimeline\">\n    <div\n      class=\"timeline-axis\"\n      ref=\"timelineAxis\"\n      @pointerdown=\"onPointerDownAxis\"\n    >\n      <div class=\"tick\" v-for=\"(point, index) in axisScale\" :key=\"index\">\n        <div class=\"tick-label\">\n          {{ index % 5 === 0 ? formatVideoTimestamp(point) : ' ' }}\n        </div>\n        <div\n          class=\"tick-line\"\n          :class=\"{\n            major: index % 5 === 0,\n          }\"\n        ></div>\n      </div>\n      <button\n        v-for=\"interaction in visibleInteractions\"\n        :key=\"interaction.id\"\n        class=\"interaction-marker\"\n        :style=\"interactionMarkerStyle(interaction)\"\n        @pointerdown.stop\n        @click.stop=\"\n          onClickInteraction(interaction);\n          $emit('timelineSeek', interaction.startTime + 0.1);\n        \"\n        :title=\"\n          $gettext('Zu %{ interaction } springen', {\n            interaction: printInteractionType(interaction),\n          })\n        \"\n      ></button>\n    </div>\n    <div\n      class=\"timeline\"\n      :class=\"{ 'pan-timeline': this.dragState?.type === 'panTimeline' }\"\n      ref=\"timeline\"\n      @pointerdown.self=\"onPointerDownAxis\"\n      @wheel=\"onWheel\"\n      @contextmenu.prevent\n    >\n      <div class=\"timeline-interactions\">\n        <div\n          v-for=\"interaction in visibleInteractions\"\n          :key=\"interaction.id\"\n          class=\"timeline-interaction\"\n          :class=\"{\n            selected: selectedInteractionId === interaction.id,\n          }\"\n          :style=\"timelineInteractionStyle(interaction)\"\n          :title=\"printInteractionType(interaction)\"\n        >\n          <div class=\"overflow-container\">\n            <button\n              type=\"button\"\n              class=\"button select-interaction\"\n              :class=\"iconForInteraction(interaction)\"\n              @click.stop=\"onClickInteraction(interaction)\"\n              @pointerdown=\"onPointerDownInteraction($event, interaction)\"\n              @pointermove=\"onPointerMoveInteraction($event, interaction)\"\n              @pointerup=\"onPointerUpInteraction($event, interaction)\"\n            >\n              <span class=\"timeline-interaction-label\">\n                {{ printInteractionType(interaction) }}\n              </span>\n            </button>\n            <!--  The delete button is hidden (v-if) unless you can see the end\n            of the interaction within the timeline viewport, because otherwise,\n            you can 'tab' over to it while it's off screen, and that causes a\n            visual glitch, as the button is automatically scrolled into view. -->\n            <button\n              type=\"button\"\n              class=\"small-button trash delete-interaction\"\n              :title=\"$gettext('Lschen')\"\n              @click=\"$emit('deleteInteraction', interaction.id)\"\n              v-if=\"interaction.endTime < viewportEnd\"\n            ></button>\n          </div>\n          <div\n            class=\"interaction-drag-handle start\"\n            @pointerdown=\"onPointerDownInteractionStart($event, interaction)\"\n            @pointermove=\"onPointerMoveInteractionStart($event, interaction)\"\n            @pointerup=\"onPointerUpInteractionStart($event, interaction)\"\n          ></div>\n          <div\n            class=\"interaction-drag-handle end\"\n            @pointerdown=\"onPointerDownInteractionEnd($event, interaction)\"\n            @pointermove=\"onPointerMoveInteractionEnd($event, interaction)\"\n            @pointerup=\"onPointerUpInteractionEnd($event, interaction)\"\n          ></div>\n        </div>\n      </div>\n\n      <div\n        class=\"time-marker\"\n        draggable=\"true\"\n        @dragstart=\"onDragStartTimeMarker\"\n        :style=\"{\n          left: positionForTimeMarker,\n        }\"\n      />\n    </div>\n    <div style=\"white-space: pre-wrap; display: none\">\n      {{\n        {\n          zoomTransform,\n          viewportWidthEm,\n          viewportWidthSeconds,\n          viewportStart,\n          viewportEnd,\n          dragState: dragState,\n        }\n      }}\n    </div>\n  </div>\n</template>\n\n<style scoped lang=\"scss\">\n.timeline-root {\n  position: relative;\n  margin-left: 1em;\n  margin-right: 1em;\n}\n.timeline {\n  position: relative;\n  width: 100%;\n  height: 5em;\n  border: 1px solid black;\n  cursor: text;\n\n  &.pan-timeline,\n  &.pan-timeline * {\n    cursor: move !important;\n  }\n\n  .time-marker {\n    position: absolute;\n    z-index: 2;\n    top: 0;\n    height: 5em;\n    width: 2px;\n    background-color: blue;\n    &::before {\n      content: '';\n      position: absolute;\n      top: -1em;\n      height: 1em;\n      width: 1em;\n      background-color: blue;\n    }\n  }\n\n  .timeline-interactions {\n    position: relative;\n    width: 100%;\n    height: 100%;\n    overflow: hidden;\n\n    .timeline-interaction {\n      position: absolute;\n      height: 100%;\n      background: var(--content-color-20);\n      cursor: default;\n\n      .overflow-container {\n        position: absolute;\n        height: 100%;\n        width: 100%;\n        overflow: hidden;\n      }\n\n      button.select-interaction {\n        /* CSS Reset for button styles */\n        padding: 0;\n        font: inherit;\n        color: inherit;\n        background-color: transparent;\n        cursor: pointer;\n        box-sizing: border-box;\n        // Remove stud.ip 'button' class margin\n        margin: 0;\n\n        height: 100%;\n        width: 100%;\n        min-width: 0;\n        overflow: hidden;\n\n        box-sizing: border-box;\n        border: 2px solid darkgrey;\n\n        display: flex;\n        flex-direction: column;\n        justify-content: flex-end;\n        &::before {\n          position: absolute;\n          left: 50%;\n          top: calc(50% - 16px);\n        }\n\n        .timeline-interaction-label {\n          width: 100%;\n          overflow: hidden;\n          text-overflow: ellipsis;\n          text-align: center;\n        }\n      }\n\n      &.selected {\n        z-index: 1;\n        button.select-interaction {\n          border: 2px solid black;\n          &:focus-visible {\n            outline: none;\n            border-style: dashed;\n          }\n        }\n      }\n      &:not(.selected) {\n        &:has(button:focus-visible) {\n          z-index: 2;\n        }\n        button.select-interaction {\n          &:focus-visible {\n            outline: none;\n            border: 2px dashed var(--content-color-80);\n          }\n        }\n      }\n\n      &:hover {\n        background: var(--content-color-40);\n      }\n\n      .interaction-drag-handle {\n        position: absolute;\n        top: 0;\n        bottom: 0;\n        width: 5px;\n        cursor: ew-resize;\n        &.start {\n          left: -3px;\n        }\n        &.end {\n          right: -4px;\n        }\n      }\n\n      button.delete-interaction {\n        position: absolute;\n        top: 0;\n        right: 0;\n        padding: 0;\n        display: none;\n      }\n      &.selected button.delete-interaction {\n        display: block;\n      }\n    }\n  }\n}\n\n.timeline-axis {\n  position: relative;\n  top: 0;\n  display: flex;\n  justify-content: space-between;\n  align-items: flex-end;\n  gap: 1em;\n  cursor: text;\n  user-select: none;\n  .tick {\n    position: relative;\n    .tick-label {\n      position: absolute;\n      top: -1.5em;\n      transform: translateX(-50%);\n      text-align: center;\n      white-space: pre;\n    }\n    .tick-line {\n      width: 1px;\n      border-left: thin solid lightgray;\n      height: 1em;\n      &.major {\n        height: 1.5em;\n      }\n    }\n  }\n  .interaction-marker {\n    /* CSS Reset for button styles */\n    padding: 0;\n    border: none;\n    font: inherit;\n    color: inherit;\n    cursor: pointer;\n    box-sizing: border-box;\n\n    $radius: 0.85em;\n    position: absolute;\n    bottom: 0.5em;\n    shape-outside: circle();\n    clip-path: circle();\n    width: $radius;\n    height: $radius;\n    background-color: black;\n    &::after {\n      display: block;\n      content: ' ';\n      shape-outside: circle();\n      clip-path: circle();\n      width: calc($radius - 2px);\n      height: calc($radius - 2px);\n      transform: translate(1px, 0px);\n      background-color: var(--content-color-20);\n    }\n\n    &:hover {\n      &::after {\n        background-color: black;\n      }\n    }\n    // Ensure that an outline is drawn when element is focused with the keyboard\n    &:focus-visible {\n      clip-path: unset;\n      &::after {\n        border: 2px solid black;\n      }\n    }\n  }\n}\n</style>\n","/**\n * Get the equivalent EM value on a given element with a given pixel value.\n *\n * Normally the number of pixel specified should come from the element itself (e.g. element.style.height) since EM is\n * relative.\n *\n * @param {Object} element - The HTML element.\n * @param {Number} pixelValue - The number of pixel to convert in EM on this specific element.\n * @author Nicolas Bouvrette\n * @license CC BY-SA 3.0 https://stackoverflow.com/a/34540037/7359454\n * Adapted by Ann Yanich\n *\n * @returns {Boolean|undefined} The EM value, or undefined if unable to convert.\n */\nexport default function getEmValueFromElement(\n  element: Element,\n  pixelValue: number\n): number | undefined {\n  if (element.parentNode) {\n    const parentFontSize = parseFloat(\n      window.getComputedStyle(element.parentNode as Element).fontSize\n    );\n    const elementFontSize = parseFloat(\n      window.getComputedStyle(element).fontSize\n    );\n    const pixelValueOfOneEm =\n      (elementFontSize / parentFontSize) * elementFontSize;\n    return pixelValue / pixelValueOfOneEm;\n  }\n  return undefined;\n}\n","// Format video timestamp for timeline axis. e.g. 1m30s becomes 00;01;30;00\nexport function formatVideoTimestamp(\n  timestampSeconds: number,\n  showCentiseconds: boolean = true,\n  separator: string = ';'\n): string {\n  let hours = 0,\n    minutes = 0,\n    seconds = 0,\n    centiseconds = 0;\n  while (timestampSeconds >= 3600) {\n    hours++;\n    timestampSeconds -= 3600;\n  }\n  while (timestampSeconds >= 60) {\n    minutes++;\n    timestampSeconds -= 60;\n  }\n  while (timestampSeconds >= 1) {\n    seconds++;\n    timestampSeconds -= 1;\n  }\n  centiseconds = Math.floor(timestampSeconds * 100);\n  function twoDigits(n: number): string {\n    return n.toLocaleString('de-DE', {\n      minimumIntegerDigits: 2,\n      maximumFractionDigits: 0,\n    });\n  }\n  const short = `${twoDigits(hours)}${separator}${twoDigits(\n    minutes\n  )}${separator}${twoDigits(seconds)}`;\n  if (showCentiseconds) {\n    const long = short.concat(`${separator}${twoDigits(centiseconds)}`);\n    return long;\n  } else {\n    return short;\n  }\n}\n","import { render } from \"./VideoTimeline.vue?vue&type=template&id=7caf349f&scoped=true&ts=true\"\nimport script from \"./VideoTimeline.vue?vue&type=script&lang=ts\"\nexport * from \"./VideoTimeline.vue?vue&type=script&lang=ts\"\n\nimport \"./VideoTimeline.vue?vue&type=style&index=0&id=7caf349f&scoped=true&lang=scss\"\n\nimport exportComponent from \"../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-7caf349f\"]])\n\nexport default __exports__","import { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, normalizeClass as _normalizeClass, createVNode as _createVNode, createTextVNode as _createTextVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, vModelCheckbox as _vModelCheckbox, withDirectives as _withDirectives, createCommentVNode as _createCommentVNode, createBlock as _createBlock, KeepAlive as _KeepAlive, resolveDynamicComponent as _resolveDynamicComponent, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-1c1c37d6\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"selected-interaction-properties\" }\nconst _hoisted_2 = {\n  key: 0,\n  class: \"default\"\n}\nconst _hoisted_3 = { class: \"collapsable\" }\nconst _hoisted_4 = { class: \"start-and-end-time-inputs\" }\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_VideoTimeInput = _resolveComponent(\"VideoTimeInput\")!\n  const _component_StudipWysiwyg = _resolveComponent(\"StudipWysiwyg\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createElementVNode(\"h3\", null, _toDisplayString(_ctx.$gettext('Interaktion')) + \" \\\"\" + _toDisplayString(_ctx.printInteractionType(_ctx.selectedInteraction)) + \"\\\" \", 1),\n    (_ctx.selectedInteraction)\n      ? (_openBlock(), _createElementBlock(\"form\", _hoisted_2, [\n          _createElementVNode(\"fieldset\", _hoisted_3, [\n            _createElementVNode(\"legend\", null, _toDisplayString(_ctx.$gettext('Einstellungen')), 1),\n            _createElementVNode(\"div\", _hoisted_4, [\n              _createElementVNode(\"label\", null, [\n                _createTextVNode(_toDisplayString(_ctx.$gettext('Start')) + \" \", 1),\n                _createVNode(_component_VideoTimeInput, {\n                  modelValue: _ctx.inputStartTime,\n                  \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((_ctx.inputStartTime) = $event)),\n                  \"onUpdate:error\": _cache[1] || (_cache[1] = (error) => (_ctx.inputStartTimeFormatError = error)),\n                  class: _normalizeClass([\"time-input\", {\n                invalid: _ctx.inputStartTimeErrors.length > 0,\n              }]),\n                  \"aria-invalid\": _ctx.inputStartTimeErrors.length > 0\n                }, null, 8, [\"modelValue\", \"class\", \"aria-invalid\"])\n              ]),\n              (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.inputStartTimeErrors, (error) => {\n                return (_openBlock(), _createElementBlock(\"p\", {\n                  class: \"validation-error\",\n                  key: error\n                }, _toDisplayString(error), 1))\n              }), 128)),\n              _createElementVNode(\"label\", null, [\n                _createTextVNode(_toDisplayString(_ctx.$gettext('Ende')) + \" \", 1),\n                _createVNode(_component_VideoTimeInput, {\n                  modelValue: _ctx.inputEndTime,\n                  \"onUpdate:modelValue\": _cache[2] || (_cache[2] = ($event: any) => ((_ctx.inputEndTime) = $event)),\n                  \"onUpdate:error\": _cache[3] || (_cache[3] = (error) => (_ctx.inputEndTimeFormatError = error)),\n                  class: _normalizeClass([\"time-input\", {\n                invalid: _ctx.inputEndTimeErrors.length > 0,\n              }]),\n                  \"aria-invalid\": _ctx.inputEndTimeErrors.length > 0\n                }, null, 8, [\"modelValue\", \"class\", \"aria-invalid\"])\n              ])\n            ]),\n            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.inputEndTimeErrors, (error) => {\n              return (_openBlock(), _createElementBlock(\"p\", {\n                class: \"validation-error\",\n                key: error\n              }, _toDisplayString(error), 1))\n            }), 128)),\n            _createElementVNode(\"label\", null, [\n              _withDirectives(_createElementVNode(\"input\", {\n                type: \"checkbox\",\n                \"onUpdate:modelValue\": _cache[4] || (_cache[4] = ($event: any) => ((_ctx.selectedInteraction.pauseWhenVisible) = $event))\n              }, null, 512), [\n                [_vModelCheckbox, _ctx.selectedInteraction.pauseWhenVisible]\n              ]),\n              _createTextVNode(\" \" + _toDisplayString(_ctx.$gettext('Video pausieren')), 1)\n            ])\n          ])\n        ]))\n      : _createCommentVNode(\"\", true),\n    (_ctx.selectedInteraction.type === 'overlay')\n      ? (_openBlock(), _createBlock(_KeepAlive, { key: 1 }, [\n          _createElementVNode(\"div\", null, [\n            (_openBlock(), _createBlock(_component_StudipWysiwyg, {\n              key: `${_ctx.selectedInteraction.id}-overlay-wysiwyg`,\n              modelValue: _ctx.selectedInteraction.content_wysiwyg,\n              \"onUpdate:modelValue\": _cache[5] || (_cache[5] = ($event: any) => ((_ctx.selectedInteraction.content_wysiwyg) = $event))\n            }, null, 8, [\"modelValue\"]))\n          ])\n        ], 1024))\n      : (_ctx.selectedInteraction.type === 'lmbTask')\n        ? (_openBlock(), _createElementBlock(_Fragment, { key: 2 }, [\n            (_openBlock(), _createBlock(_KeepAlive, null, [\n              (_openBlock(), _createBlock(_resolveDynamicComponent(_ctx.editorForTaskType(_ctx.selectedInteraction.taskDefinition.task_type)), {\n                key: `${_ctx.selectedInteraction.id}-editor`,\n                taskDefinition: _ctx.selectedInteraction.taskDefinition\n              }, null, 8, [\"taskDefinition\"]))\n            ], 1024)),\n            (\n          _ctx.showViewerAboveEditor(_ctx.selectedInteraction.taskDefinition.task_type)\n        )\n              ? (_openBlock(), _createElementBlock(_Fragment, { key: 0 }, [\n                  _createElementVNode(\"h3\", null, _toDisplayString(_ctx.$gettext('Vorschau')), 1),\n                  (_openBlock(), _createBlock(_KeepAlive, null, [\n                    (_openBlock(), _createBlock(_resolveDynamicComponent(\n              _ctx.viewerForTaskType(_ctx.selectedInteraction.taskDefinition.task_type)\n            ), {\n                      class: \"lmb-task-preview\",\n                      key: `${_ctx.selectedInteraction.id}-viewer`,\n                      task: _ctx.selectedInteraction.taskDefinition\n                    }, null, 8, [\"task\"]))\n                  ], 1024))\n                ], 64))\n              : _createCommentVNode(\"\", true)\n          ], 64))\n        : _createCommentVNode(\"\", true)\n  ]))\n}","<template>\n  <div class=\"selected-interaction-properties\">\n    <h3>\n      {{ $gettext('Interaktion') }}\n      \"{{ printInteractionType(selectedInteraction) }}\"\n    </h3>\n    <form v-if=\"selectedInteraction\" class=\"default\">\n      <fieldset class=\"collapsable\">\n        <legend>\n          {{ $gettext('Einstellungen') }}\n        </legend>\n        <div class=\"start-and-end-time-inputs\">\n          <label>\n            {{ $gettext('Start') }}\n            <VideoTimeInput\n              v-model=\"inputStartTime\"\n              @update:error=\"(error) => (inputStartTimeFormatError = error)\"\n              class=\"time-input\"\n              :class=\"{\n                invalid: inputStartTimeErrors.length > 0,\n              }\"\n              :aria-invalid=\"inputStartTimeErrors.length > 0\"\n            />\n          </label>\n          <p\n            class=\"validation-error\"\n            v-for=\"error in inputStartTimeErrors\"\n            :key=\"error\"\n          >\n            {{ error }}\n          </p>\n          <label>\n            {{ $gettext('Ende') }}\n            <VideoTimeInput\n              v-model=\"inputEndTime\"\n              @update:error=\"(error) => (inputEndTimeFormatError = error)\"\n              class=\"time-input\"\n              :class=\"{\n                invalid: inputEndTimeErrors.length > 0,\n              }\"\n              :aria-invalid=\"inputEndTimeErrors.length > 0\"\n            />\n          </label>\n        </div>\n        <p\n          class=\"validation-error\"\n          v-for=\"error in inputEndTimeErrors\"\n          :key=\"error\"\n        >\n          {{ error }}\n        </p>\n        <label>\n          <!-- TODO don't mutate props -- this should be undoable -->\n          <!-- eslint-disable vue/no-mutating-props -->\n          <input\n            type=\"checkbox\"\n            v-model=\"selectedInteraction.pauseWhenVisible\"\n          />\n          {{ $gettext('Video pausieren') }}\n        </label>\n      </fieldset>\n    </form>\n    <template v-if=\"selectedInteraction.type === 'overlay'\">\n      <!-- Oddly, if this StudipWysiwyg is not wrapped in a div, it seems not to\n      work correctly. It keeps firing its mounted() function when hidden/shown,\n      (e.g. when you alternate between selecting an overlay and selecting another\n      Interaction), and it leads to many instances of the WYSIWYG editor\n      appearing next to each other.\n      I don't entirely understand it, but this is my workaround for the issue. -Ann -->\n      <KeepAlive>\n        <div>\n          <StudipWysiwyg\n            :key=\"`${selectedInteraction.id}-overlay-wysiwyg`\"\n            v-model=\"selectedInteraction.content_wysiwyg\"\n          />\n        </div>\n      </KeepAlive>\n    </template>\n    <template v-else-if=\"selectedInteraction.type === 'lmbTask'\">\n      <KeepAlive>\n        <component\n          :key=\"`${selectedInteraction.id}-editor`\"\n          :is=\"editorForTaskType(selectedInteraction.taskDefinition.task_type)\"\n          :taskDefinition=\"selectedInteraction.taskDefinition\"\n        />\n      </KeepAlive>\n      <template\n        v-if=\"\n          showViewerAboveEditor(selectedInteraction.taskDefinition.task_type)\n        \"\n      >\n        <h3>\n          {{ $gettext('Vorschau') }}\n        </h3>\n        <KeepAlive>\n          <component\n            class=\"lmb-task-preview\"\n            :key=\"`${selectedInteraction.id}-viewer`\"\n            :is=\"\n              viewerForTaskType(selectedInteraction.taskDefinition.task_type)\n            \"\n            :task=\"selectedInteraction.taskDefinition\"\n          />\n        </KeepAlive>\n      </template>\n    </template>\n  </div>\n</template>\n<script lang=\"ts\">\nimport { defineComponent, inject, PropType } from 'vue';\nimport {\n  Interaction,\n  printInteractionType,\n} from '@/models/InteractiveVideoTask';\nimport {\n  editorForTaskType,\n  showViewerAboveEditor,\n  viewerForTaskType,\n} from '@/models/TaskDefinition';\nimport { $gettext } from '@/language/gettext';\nimport {\n  InteractiveVideoEditorState,\n  interactiveVideoEditorStateSymbol,\n} from '@/components/interactiveVideo/editor/interactiveVideoEditorState';\nimport VideoTimeInput from '@/components/interactiveVideo/VideoTimeInput.vue';\nimport StudipWysiwyg from '@/components/StudipWysiwyg.vue';\n\nexport default defineComponent({\n  name: 'SelectedInteractionProperties',\n  components: { VideoTimeInput, StudipWysiwyg },\n  setup() {\n    return {\n      editor: inject<InteractiveVideoEditorState>(\n        interactiveVideoEditorStateSymbol\n      ),\n    };\n  },\n  props: {\n    selectedInteraction: {\n      type: Object as PropType<Interaction>,\n      required: true,\n    },\n  },\n  data() {\n    return {\n      inputStartTime: 0,\n      inputStartTimeFormatError: undefined as Error | undefined,\n      inputEndTime: 1,\n      inputEndTimeFormatError: undefined as Error | undefined,\n    };\n  },\n  methods: {\n    showViewerAboveEditor,\n    viewerForTaskType,\n    $gettext,\n    printInteractionType,\n    editorForTaskType,\n  },\n  watch: {\n    inputStartTime(value: number) {\n      if (this.inputStartTimeErrors.length === 0) {\n        // eslint-disable-next-line vue/no-mutating-props\n        this.selectedInteraction.startTime = value;\n      }\n      if (this.inputEndTimeErrors.length === 0) {\n        // eslint-disable-next-line vue/no-mutating-props\n        this.selectedInteraction.endTime = this.inputEndTime;\n      }\n    },\n    'selectedInteraction.startTime': {\n      handler: function (value: number) {\n        this.inputStartTime = value;\n      },\n      immediate: true,\n    },\n    inputEndTime(value: number) {\n      if (this.inputEndTimeErrors.length === 0) {\n        // eslint-disable-next-line vue/no-mutating-props\n        this.selectedInteraction.endTime = value;\n        /*\n         Scenario: startTime = 0, endTime = 4.\n         User begins to edit startTime and sets startTime = 5.\n         This is invalid (startTime > endTime) and is not applied.\n         Then, user edits endTime and sets endTime = 6.\n         Now, both inputs are valid. start < end. So, both should be applied.\n        */\n        if (this.inputStartTimeErrors.length === 0) {\n          // eslint-disable-next-line vue/no-mutating-props\n          this.selectedInteraction.startTime = this.inputStartTime;\n        }\n      }\n    },\n    'selectedInteraction.endTime': {\n      handler: function (value: number) {\n        this.inputEndTime = value;\n      },\n      immediate: true,\n    },\n  },\n  computed: {\n    inputStartTimeErrors(): string[] {\n      const errors: string[] = [];\n      if (this.inputStartTimeFormatError) {\n        errors.push(this.inputStartTimeFormatError.message);\n      }\n      if (this.inputStartTime < 0) {\n        errors.push($gettext('Das eingegebene Wert muss grer als 0 sein.'));\n      }\n      if (this.inputStartTime >= this.selectedInteraction.endTime) {\n        errors.push($gettext('Der Startpunkt muss vor dem Endpunkt sein.'));\n      }\n      // TODO check video length as well.\n      return errors;\n    },\n    inputEndTimeErrors(): string[] {\n      const errors: string[] = [];\n      if (this.inputEndTimeFormatError) {\n        errors.push(this.inputEndTimeFormatError.message);\n      }\n      if (this.inputEndTime < 0) {\n        errors.push($gettext('Das eingegebene Wert muss grer als 0 sein.'));\n      }\n      if (this.inputEndTime <= this.selectedInteraction.startTime) {\n        errors.push($gettext('Der Startpunkt muss vor dem Endpunkt sein.'));\n      }\n      // TODO check video length as well.\n      return errors;\n    },\n  },\n});\n</script>\n<style scoped lang=\"scss\">\nform.default .time-input {\n  max-width: 12em;\n}\n.start-and-end-time-inputs {\n  display: flex;\n  gap: 1em;\n}\n.lmb-task-preview {\n  margin-bottom: 1em;\n}\n</style>\n","import { vModelText as _vModelText, withDirectives as _withDirectives, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  return _withDirectives((_openBlock(), _createElementBlock(\"input\", {\n    type: \"text\",\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((_ctx.userInput) = $event)),\n    onBlur: _cache[1] || (_cache[1] = \n//@ts-ignore\n(...args) => (_ctx.onBlurUserInput && _ctx.onBlurUserInput(...args)))\n  }, null, 544)), [\n    [_vModelText, _ctx.userInput]\n  ])\n}","<script lang=\"ts\">\nimport { defineComponent } from 'vue';\nimport { $gettext } from '@/language/gettext';\n\nexport default defineComponent({\n  name: 'VideoTimeInput',\n  props: {\n    modelValue: {\n      type: Number,\n      required: true,\n    },\n  },\n  data() {\n    return {\n      userInput: '',\n    };\n  },\n  watch: {\n    modelValue: {\n      immediate: true,\n      handler(newValue: number) {\n        this.userInput = this.formatSeconds(newValue);\n      },\n    },\n    parsedUserInput() {\n      if (this.parsedUserInput instanceof Error) {\n        this.$emit('update:error', this.parsedUserInput);\n      } else {\n        this.$emit('update:error', undefined);\n      }\n    },\n  },\n  methods: {\n    onBlurUserInput() {\n      if (this.parsedUserInput instanceof Error) {\n        // Reset the input to a good value\n        this.userInput = this.formatSeconds(this.modelValue);\n        this.$emit('update:error', undefined);\n      } else {\n        this.$emit('update:modelValue', this.parsedUserInput);\n        this.$emit('update:error', undefined);\n      }\n    },\n    // Format a time in seconds as HH;MM;SS;SS (Centiseconds at end)\n    formatSeconds(time: number): string {\n      let hours = 0,\n        minutes = 0,\n        seconds = 0,\n        centiseconds = 0;\n      while (time >= 3600) {\n        time -= 3600;\n        hours += 1;\n      }\n      while (time >= 60) {\n        time -= 60;\n        minutes += 1;\n      }\n      while (time >= 1) {\n        time -= 1;\n        seconds += 1;\n      }\n      centiseconds = Math.floor(time * 100);\n      function twoDigits(n: number): string {\n        return n.toLocaleString('de-DE', {\n          minimumIntegerDigits: 2,\n          maximumFractionDigits: 0,\n        });\n      }\n      let string = `${twoDigits(hours)};${twoDigits(minutes)};${twoDigits(\n        seconds\n      )};${twoDigits(centiseconds)}`;\n      return string;\n    },\n  },\n  computed: {\n    /**\n     * Either the time the user input, converted into seconds, or an Error with\n     * a message explaining why the user's input was invalid.\n     */\n    parsedUserInput(): number | Error {\n      const timeRegexCentiseconds =\n        /^(\\d?\\d)[;:](\\d?\\d)[;:](\\d?\\d)[;:](\\d?\\d)$/;\n      const centisecondsMatch = timeRegexCentiseconds.exec(this.userInput);\n      if (centisecondsMatch) {\n        return (\n          parseInt(centisecondsMatch[1]) * 3600 +\n          parseInt(centisecondsMatch[2]) * 60 +\n          parseInt(centisecondsMatch[3]) +\n          parseInt(centisecondsMatch[4]) / 100\n        );\n      }\n      // If the exact format for a time with centiseconds isn't matched, use\n      // a more permissive regex.\n      // This regex is adapted from https://stackoverflow.com/a/8318367/7359454\n      // License CC BY-SA 3.0 https://creativecommons.org/licenses/by-sa/3.0/\n      // Accessed and adapted on 10.01.2024 by Ann Yanich\n      const timeRegexHhMmSs =\n        /^(?:(?:([0-9]?\\d)[;:])?([0-5]?\\d)[:;])?([0-5]?\\d)$/;\n      const hhMmSsMatch = timeRegexHhMmSs.exec(this.userInput);\n      if (!hhMmSsMatch || hhMmSsMatch.length !== 4) {\n        return new Error(\n          $gettext(\n            'Die Startposition muss der Syntax HH;MM;SS oder HH;MM;SS;SS entsprechen.'\n          )\n        );\n      }\n      // match[0] is the time string with colons,\n      // match[1] is hours (or undefined if not present),\n      // match[2] is minutes (or undefined if not present),\n      // and match[3] is seconds (always present).\n      if (hhMmSsMatch[1]) {\n        return (\n          parseInt(hhMmSsMatch[1]) * 3600 +\n          parseInt(hhMmSsMatch[2]) * 60 +\n          parseInt(hhMmSsMatch[3])\n        );\n      } else if (hhMmSsMatch[2]) {\n        return parseInt(hhMmSsMatch[2]) * 60 + parseInt(hhMmSsMatch[3]);\n      } else {\n        return parseInt(hhMmSsMatch[3]);\n      }\n    },\n  },\n});\n</script>\n\n<template>\n  <input type=\"text\" v-model=\"userInput\" @blur=\"onBlurUserInput\" />\n</template>\n\n<style scoped></style>\n","import { render } from \"./VideoTimeInput.vue?vue&type=template&id=9aba7cc0&ts=true\"\nimport script from \"./VideoTimeInput.vue?vue&type=script&lang=ts\"\nexport * from \"./VideoTimeInput.vue?vue&type=script&lang=ts\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { render } from \"./SelectedInteractionProperties.vue?vue&type=template&id=1c1c37d6&scoped=true&ts=true\"\nimport script from \"./SelectedInteractionProperties.vue?vue&type=script&lang=ts\"\nexport * from \"./SelectedInteractionProperties.vue?vue&type=script&lang=ts\"\n\nimport \"./SelectedInteractionProperties.vue?vue&type=style&index=0&id=1c1c37d6&scoped=true&lang=scss\"\n\nimport exportComponent from \"../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-1c1c37d6\"]])\n\nexport default __exports__","import { $gettext } from '@/language/gettext';\n\nconst strings = {\n  forbiddenToNestInteractiveVideos: $gettext(\n    'Es ist nicht erlaubt, ein ' +\n      'Interactive Video in ein anderes Interactive Video einzufgen.'\n  ),\n  notAnOverlayError: $gettext(\n    'Die ausgefhrte Aktion ist nur fr Overlay-Elemente gltig.'\n  ),\n  interactionNotFoundError: $gettext(\n    'Es wurde keine Interaktion mit der angegebenen ID gefunden.'\n  ),\n  postCouldNotBeParsedError: $gettext(\n    'Dieser Post konnte nicht geladen werden.'\n  ),\n  couldNotLoadPostsError: $gettext(\n    'Die Posts unter dem Video konnten nicht geladen werden.'\n  ),\n  couldNotSendPostError: $gettext('Ihr Post konnte nicht gepostet werden.'),\n} as const;\nexport default strings;\n","import { defineComponent as _defineComponent } from 'vue'\nimport { createVNode as _createVNode, unref as _unref, createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, normalizeClass as _normalizeClass, createBlock as _createBlock, createCommentVNode as _createCommentVNode, KeepAlive as _KeepAlive, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-39de7364\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"add-interactions-root\" }\nconst _hoisted_2 = { class: \"toolbar-under-video\" }\nconst _hoisted_3 = { class: \"insert-interactions-buttons\" }\nconst _hoisted_4 = [\"title\"]\nconst _hoisted_5 = [\"onClick\", \"title\"]\nconst _hoisted_6 = { class: \"video-controls\" }\nconst _hoisted_7 = [\"title\"]\nconst _hoisted_8 = [\"title\"]\nconst _hoisted_9 = [\"title\"]\nconst _hoisted_10 = [\"title\"]\n\nimport {\n  computed,\n  inject,\n  nextTick,\n  PropType,\n  provide,\n  ref,\n} from 'vue';\nimport type {\n  Interaction,\n  InteractiveVideoTask,\n  LmbTaskInteraction,\n  OverlayInteraction,\n} from '@/models/InteractiveVideoTask';\nimport VideoPlayer from '@/components/interactiveVideo/VideoPlayer.vue';\nimport VideoTimeline from '@/components/interactiveVideo/editor/VideoTimeline.vue';\nimport SelectedInteractionProperties from '@/components/interactiveVideo/editor/SelectedInteractionProperties.vue';\nimport {\n  DragState,\n  TimelineDragState,\n  VideoMetadata,\n} from '@/components/interactiveVideo/editor/events';\nimport {\n  iconForTaskType,\n  newTask,\n  printTaskType,\n  TaskDefinition,\n  TaskDefinitionMinusInteractiveVideo,\n} from '@/models/TaskDefinition';\nimport { v4 } from 'uuid';\nimport { interactiveVideoEditorStateSymbol } from '@/components/interactiveVideo/editor/interactiveVideoEditorState';\nimport { $gettext } from '@/language/gettext';\nimport { printInteractionType } from '@/models/InteractiveVideoTask';\nimport {\n  TaskEditorState,\n  taskEditorStateSymbol,\n} from '@/components/taskEditorState';\nimport produce from 'immer';\nimport { isEqual } from 'lodash';\nimport strings from '@/components/interactiveVideo/strings';\n\n\nexport default /*#__PURE__*/_defineComponent({\n  props: {\n  taskDefinition: {\n    type: Object as PropType<InteractiveVideoTask>,\n    required: true,\n  },\n},\n  setup(__props) {\n\nconst props = __props\n\n\nconst currentTime = ref(0);\nconst videoMetadata = ref<VideoMetadata>({ length: 1 });\nconst selectedInteractionId = ref<string | undefined>(undefined);\nconst videoPlayer = ref<InstanceType<typeof VideoPlayer> | undefined>(\n  undefined\n);\nconst videoTimeline = ref<InstanceType<typeof VideoTimeline> | undefined>(\n  undefined\n);\nconst selectedInteractionProperties = ref<\n  InstanceType<typeof SelectedInteractionProperties> | undefined\n>(undefined);\n\nconst taskTypes: Array<TaskDefinition['task_type']> = [\n  'DragTheWords',\n  'FillInTheBlanks',\n  'FindTheHotspots',\n  'FindTheWords',\n  'MarkTheWords',\n  'Memory',\n  'Pairing',\n  'Question',\n  'Sequencing',\n];\n\nprovide(interactiveVideoEditorStateSymbol, {\n  selectInteraction,\n  selectedInteractionId,\n  editInteraction,\n  dragInteraction,\n  resizeOverlay,\n  deleteInteraction,\n  dragInteractionTimeline,\n  resizeInteractionTimeline,\n});\n\n/**\n *  Do the necessary so that calls to performEdit from within the LMB Task\n *  editor will not overwrite the state of the Interactive Video task\n *  that contains them.\n *  TODO Make a graphic diagram of all provides/injects in LernmodulePlugin\n */\n\nprovide(taskEditorStateSymbol, {\n  performEdit: performEditForEditedLmbInteraction,\n});\n\nconst taskEditor = inject<TaskEditorState>(taskEditorStateSymbol);\n\nfunction performEditForEditedLmbInteraction(payload: {\n  newTaskDefinition: TaskDefinitionMinusInteractiveVideo;\n  undoBatch: unknown;\n}): void {\n  // Apply the new task definition for the edited interaction.\n  const newDefinition = produce(\n    props.taskDefinition,\n    (videoTask: InteractiveVideoTask) => {\n      const interactionIndex = videoTask.interactions.findIndex(\n        (i) => i.id === selectedInteractionId.value\n      );\n      if (interactionIndex === -1) {\n        throw new Error('cant find selected interaction in interactions array');\n      }\n      const interaction = videoTask.interactions[interactionIndex];\n      if (interaction.type !== 'lmbTask') {\n        throw new Error('Selected interaction is not of type lmbTask');\n      }\n      interaction.taskDefinition = payload.newTaskDefinition;\n    }\n  );\n  const undoBatch = isEqual(payload.undoBatch, {})\n    ? // If the edited interaction's LMB task editor sends empty object as undoBatch,\n      // pass it through. This way, a new undo/redo state will always be created.\n      {}\n    : // If it doesn't send the empty object, that means that this edit should\n      // be merged together with other edits with the same undoBatch to the same\n      // Interaction.\n      {\n        type: 'editedLmbInteractionTask',\n        interactionId: selectedInteractionId.value,\n        undoBatch: payload.undoBatch,\n      };\n  taskEditor!.performEdit({\n    newTaskDefinition: newDefinition,\n    undoBatch: undoBatch,\n  });\n}\n\nconst selectedInteraction = computed((): Interaction | undefined =>\n  props.taskDefinition.interactions.find(\n    (interaction) => interaction.id === selectedInteractionId.value\n  )\n);\n\nfunction selectInteraction(selectionId: string | undefined) {\n  selectedInteractionId.value = selectionId;\n}\nfunction editInteraction(id: string) {\n  selectedInteractionId.value = id;\n  nextTick(() => {\n    const el = selectedInteractionProperties.value?.$el as HTMLElement;\n    el.scrollIntoView({\n      behavior: 'smooth',\n      block: 'start',\n    });\n  });\n}\nfunction onVideoMetadataChange(data: VideoMetadata) {\n  videoMetadata.value = data;\n}\nfunction onTimeUpdate(time: number) {\n  currentTime.value = time;\n}\nfunction onTimelineSeek(time: number) {\n  videoPlayer.value!.player!.currentTime(time);\n}\nfunction onClickZoomIn() {\n  videoTimeline.value!.zoom(0.18);\n}\nfunction onClickZoomOut() {\n  videoTimeline.value!.zoom(-0.18);\n}\nfunction onClickPlay() {\n  videoPlayer.value!.player!.play();\n}\nfunction onClickPause() {\n  videoPlayer.value!.player!.pause();\n}\nfunction insertOverlay() {\n  const interaction: OverlayInteraction = {\n    type: 'overlay',\n    v: 2,\n    id: v4(),\n    startTime: currentTime.value,\n    endTime: Math.min(videoMetadata.value.length, currentTime.value + 10),\n    x: 0.4,\n    y: 0.4,\n    width: 0.2,\n    height: 0.2,\n    content_wysiwyg: $gettext('Einblendung'),\n    pauseWhenVisible: true,\n  };\n  taskEditor!.performEdit({\n    newTaskDefinition: produce(\n      props.taskDefinition,\n      (draft: InteractiveVideoTask) => {\n        draft.interactions.push(interaction);\n      }\n    ),\n  });\n  selectedInteractionId.value = interaction.id;\n}\n\nfunction insertLmbTaskInteraction(type: TaskDefinition['task_type']) {\n  if (type === 'InteractiveVideo') {\n    throw new Error(strings.forbiddenToNestInteractiveVideos);\n  }\n  const task = newTask(type) as TaskDefinitionMinusInteractiveVideo;\n  const interaction: LmbTaskInteraction = {\n    type: 'lmbTask',\n    id: v4(),\n    taskDefinition: task,\n    startTime: currentTime.value,\n    endTime: Math.min(videoMetadata.value.length, currentTime.value + 10),\n    x: 0.5,\n    y: 0.5,\n    pauseWhenVisible: true,\n  };\n  taskEditor!.performEdit({\n    newTaskDefinition: produce(\n      props.taskDefinition,\n      (draft: InteractiveVideoTask) => {\n        draft.interactions.push(interaction);\n      }\n    ),\n  });\n  selectedInteractionId.value = interaction.id;\n}\nfunction deleteInteraction(id: string) {\n  console.log('deleteInteraction', id);\n  const interaction = props.taskDefinition.interactions.find(\n    (i) => i.id === id\n  );\n  if (!interaction) {\n    throw new Error(strings.interactionNotFoundError);\n  }\n  const prompt = $gettext('%{ interaction } lschen', {\n    interaction: printInteractionType(interaction),\n  });\n  const confirmed = window.confirm(prompt);\n  if (!confirmed) {\n    console.info('Delete prompt canceled by user');\n    return;\n  }\n  const index = props.taskDefinition.interactions.findIndex((i) => i.id === id);\n  if (index === -1) {\n    throw new Error(strings.interactionNotFoundError);\n  }\n  taskEditor!.performEdit({\n    newTaskDefinition: produce(\n      props.taskDefinition,\n      (draft: InteractiveVideoTask) => {\n        draft.interactions.splice(index, 1);\n      }\n    ),\n  });\n}\nfunction dragInteraction(\n  id: string,\n  xFraction: number,\n  yFraction: number,\n  // Used in order to batch actions for undo/redo.  Each time you click, drag,\n  // and let go, that should result in a new state in the undo/redo history.\n  dragState: DragState\n) {\n  taskEditor!.performEdit({\n    newTaskDefinition: produce(\n      props.taskDefinition,\n      (draft: InteractiveVideoTask) => {\n        const interaction = draft.interactions.find((i) => i.id === id);\n        if (!interaction) {\n          throw new Error(`Interaction with id ${id} not found`);\n        }\n        interaction.x = xFraction;\n        interaction.y = yFraction;\n      }\n    ),\n    undoBatch: dragState,\n  });\n}\nfunction resizeOverlay(\n  id: string,\n  x: number,\n  y: number,\n  width: number,\n  height: number,\n  dragState: DragState\n) {\n  taskEditor!.performEdit({\n    newTaskDefinition: produce(\n      props.taskDefinition,\n      (draft: InteractiveVideoTask) => {\n        const interaction = draft.interactions.find((i) => i.id === id);\n        if (!interaction) {\n          throw new Error(`Interaction with id ${id} not found`);\n        }\n        if (interaction.type !== 'overlay') {\n          throw new Error(strings.notAnOverlayError);\n        }\n        interaction.x = x;\n        interaction.y = y;\n        interaction.width = width;\n        interaction.height = height;\n      }\n    ),\n    undoBatch: dragState,\n  });\n}\nfunction dragInteractionTimeline(\n  id: string,\n  startTime: number,\n  dragState: TimelineDragState\n) {\n  taskEditor!.performEdit({\n    newTaskDefinition: produce(\n      props.taskDefinition,\n      (draft: InteractiveVideoTask) => {\n        const interaction = draft.interactions.find((i) => i.id === id);\n        if (!interaction) {\n          throw new Error(`Interaction with id ${id} not found`);\n        }\n        const duration = interaction.endTime - interaction.startTime;\n        interaction.endTime = startTime + duration;\n        interaction.startTime = startTime;\n      }\n    ),\n    undoBatch: dragState,\n  });\n}\n\nfunction resizeInteractionTimeline(\n  id: string,\n  type: 'start' | 'end',\n  time: number,\n  dragState: TimelineDragState\n) {\n  taskEditor!.performEdit({\n    newTaskDefinition: produce(\n      props.taskDefinition,\n      (draft: InteractiveVideoTask) => {\n        const interaction = draft.interactions.find((i) => i.id === id);\n        if (!interaction) {\n          throw new Error(`Interaction with id ${id} not found`);\n        }\n        if (type === 'start') {\n          interaction.startTime = time;\n        } else {\n          interaction.endTime = time;\n        }\n      }\n    ),\n    undoBatch: dragState,\n  });\n}\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createVNode(VideoPlayer, {\n      ref_key: \"videoPlayer\",\n      ref: videoPlayer,\n      task: __props.taskDefinition,\n      onTimeupdate: onTimeUpdate,\n      onMetadataChange: onVideoMetadataChange,\n      onClickInteraction: _cache[0] || (_cache[0] = (i) => selectInteraction(i.id))\n    }, null, 8, [\"task\"]),\n    _createElementVNode(\"div\", _hoisted_2, [\n      _createElementVNode(\"div\", _hoisted_3, [\n        _createElementVNode(\"button\", {\n          type: \"button\",\n          class: \"button item\",\n          onClick: insertOverlay,\n          title: \n            _unref($gettext)('%{ interactionType } einfgen', {\n              interactionType: _unref($gettext)('Einblendung'),\n            })\n          \n        }, null, 8, _hoisted_4),\n        (_openBlock(), _createElementBlock(_Fragment, null, _renderList(taskTypes, (taskType) => {\n          return _createElementVNode(\"button\", {\n            key: taskType,\n            type: \"button\",\n            class: _normalizeClass([\"button\", _unref(iconForTaskType)(taskType)]),\n            onClick: ($event: any) => (insertLmbTaskInteraction(taskType)),\n            title: \n            _unref($gettext)('%{ interactionType } einfgen', {\n              interactionType: _unref(printTaskType)(taskType),\n            })\n          \n          }, null, 10, _hoisted_5)\n        }), 64))\n      ]),\n      _createElementVNode(\"div\", _hoisted_6, [\n        _createElementVNode(\"button\", {\n          type: \"button\",\n          class: \"button zoom-in\",\n          title: _unref($gettext)('Vergrern'),\n          onClick: onClickZoomIn\n        }, null, 8, _hoisted_7),\n        _createElementVNode(\"button\", {\n          type: \"button\",\n          class: \"button zoom-out\",\n          title: _unref($gettext)('Verkleinern'),\n          onClick: onClickZoomOut\n        }, null, 8, _hoisted_8),\n        _createElementVNode(\"button\", {\n          type: \"button\",\n          class: \"button play\",\n          title: _unref($gettext)('Abspielen'),\n          onClick: onClickPlay\n        }, null, 8, _hoisted_9),\n        _createElementVNode(\"button\", {\n          type: \"button\",\n          class: \"button pause\",\n          title: _unref($gettext)('Pausieren'),\n          onClick: onClickPause\n        }, null, 8, _hoisted_10)\n      ])\n    ]),\n    _createVNode(VideoTimeline, {\n      class: \"video-timeline\",\n      ref_key: \"videoTimeline\",\n      ref: videoTimeline,\n      task: __props.taskDefinition,\n      currentTime: currentTime.value,\n      videoMetadata: videoMetadata.value,\n      selectedInteractionId: selectedInteractionId.value,\n      onTimelineSeek: onTimelineSeek,\n      onClickInteraction: _cache[1] || (_cache[1] = (i) => selectInteraction(i.id)),\n      onDeleteInteraction: deleteInteraction\n    }, null, 8, [\"task\", \"currentTime\", \"videoMetadata\", \"selectedInteractionId\"]),\n    (_openBlock(), _createBlock(_KeepAlive, null, [\n      (_unref(selectedInteraction))\n        ? (_openBlock(), _createBlock(SelectedInteractionProperties, {\n            ref_key: \"selectedInteractionProperties\",\n            ref: selectedInteractionProperties,\n            selectedInteraction: _unref(selectedInteraction),\n            key: _unref(selectedInteraction).id\n          }, null, 8, [\"selectedInteraction\"]))\n        : _createCommentVNode(\"\", true)\n    ], 1024))\n  ]))\n}\n}\n\n})","<template>\n  <div class=\"add-interactions-root\">\n    <VideoPlayer\n      ref=\"videoPlayer\"\n      :task=\"taskDefinition\"\n      @timeupdate=\"onTimeUpdate\"\n      @metadataChange=\"onVideoMetadataChange\"\n      @clickInteraction=\"(i: Interaction) => selectInteraction(i.id)\"\n    />\n    <div class=\"toolbar-under-video\">\n      <div class=\"insert-interactions-buttons\">\n        <button\n          type=\"button\"\n          class=\"button item\"\n          @click=\"insertOverlay\"\n          :title=\"\n            $gettext('%{ interactionType } einfgen', {\n              interactionType: $gettext('Einblendung'),\n            })\n          \"\n        ></button>\n        <button\n          v-for=\"taskType in taskTypes\"\n          :key=\"taskType\"\n          type=\"button\"\n          class=\"button\"\n          :class=\"iconForTaskType(taskType)\"\n          @click=\"insertLmbTaskInteraction(taskType)\"\n          :title=\"\n            $gettext('%{ interactionType } einfgen', {\n              interactionType: printTaskType(taskType),\n            })\n          \"\n        ></button>\n      </div>\n      <div class=\"video-controls\">\n        <button\n          type=\"button\"\n          class=\"button zoom-in\"\n          :title=\"$gettext('Vergrern')\"\n          @click=\"onClickZoomIn\"\n        ></button>\n        <button\n          type=\"button\"\n          class=\"button zoom-out\"\n          :title=\"$gettext('Verkleinern')\"\n          @click=\"onClickZoomOut\"\n        ></button>\n        <button\n          type=\"button\"\n          class=\"button play\"\n          :title=\"$gettext('Abspielen')\"\n          @click=\"onClickPlay\"\n        ></button>\n        <button\n          type=\"button\"\n          class=\"button pause\"\n          :title=\"$gettext('Pausieren')\"\n          @click=\"onClickPause\"\n        ></button>\n      </div>\n    </div>\n\n    <VideoTimeline\n      class=\"video-timeline\"\n      ref=\"videoTimeline\"\n      :task=\"taskDefinition\"\n      :currentTime=\"currentTime\"\n      :videoMetadata=\"videoMetadata\"\n      :selectedInteractionId=\"selectedInteractionId\"\n      @timelineSeek=\"onTimelineSeek\"\n      @clickInteraction=\"(i: Interaction) => selectInteraction(i.id)\"\n      @deleteInteraction=\"deleteInteraction\"\n    />\n    <!-- :key is needed to prevent a bug where if you first selected one overlay,\n      then clicked on another one to select it, there would be two WYSIWYG editors\n      open in the 'selected interaction properties' dialog, and a new one would be\n      added each time you clicked from one overlay to the other. -->\n    <KeepAlive>\n      <SelectedInteractionProperties\n        v-if=\"selectedInteraction\"\n        ref=\"selectedInteractionProperties\"\n        :selectedInteraction=\"selectedInteraction\"\n        :key=\"selectedInteraction.id\"\n      />\n    </KeepAlive>\n  </div>\n</template>\n\n<style scoped lang=\"scss\">\n.toolbar-under-video {\n  display: flex;\n  justify-content: space-between;\n}\n.insert-interactions-buttons button,\n.video-controls button {\n  // Make the buttons into little squares so a lot of them will fit next to each\n  // other in one row.\n  min-width: unset;\n  width: 0;\n}\n.add-interactions-root {\n  overflow: hidden;\n}\n.video-timeline {\n  margin-top: 2em;\n}\n\n.selected-interaction-properties {\n  margin-top: 1em;\n}\n</style>\n\n<script setup lang=\"ts\">\nimport {\n  computed,\n  defineProps,\n  inject,\n  nextTick,\n  PropType,\n  provide,\n  ref,\n} from 'vue';\nimport type {\n  Interaction,\n  InteractiveVideoTask,\n  LmbTaskInteraction,\n  OverlayInteraction,\n} from '@/models/InteractiveVideoTask';\nimport VideoPlayer from '@/components/interactiveVideo/VideoPlayer.vue';\nimport VideoTimeline from '@/components/interactiveVideo/editor/VideoTimeline.vue';\nimport SelectedInteractionProperties from '@/components/interactiveVideo/editor/SelectedInteractionProperties.vue';\nimport {\n  DragState,\n  TimelineDragState,\n  VideoMetadata,\n} from '@/components/interactiveVideo/editor/events';\nimport {\n  iconForTaskType,\n  newTask,\n  printTaskType,\n  TaskDefinition,\n  TaskDefinitionMinusInteractiveVideo,\n} from '@/models/TaskDefinition';\nimport { v4 } from 'uuid';\nimport { interactiveVideoEditorStateSymbol } from '@/components/interactiveVideo/editor/interactiveVideoEditorState';\nimport { $gettext } from '@/language/gettext';\nimport { printInteractionType } from '@/models/InteractiveVideoTask';\nimport {\n  TaskEditorState,\n  taskEditorStateSymbol,\n} from '@/components/taskEditorState';\nimport produce from 'immer';\nimport { isEqual } from 'lodash';\nimport strings from '@/components/interactiveVideo/strings';\n\nconst props = defineProps({\n  taskDefinition: {\n    type: Object as PropType<InteractiveVideoTask>,\n    required: true,\n  },\n});\nconst currentTime = ref(0);\nconst videoMetadata = ref<VideoMetadata>({ length: 1 });\nconst selectedInteractionId = ref<string | undefined>(undefined);\nconst videoPlayer = ref<InstanceType<typeof VideoPlayer> | undefined>(\n  undefined\n);\nconst videoTimeline = ref<InstanceType<typeof VideoTimeline> | undefined>(\n  undefined\n);\nconst selectedInteractionProperties = ref<\n  InstanceType<typeof SelectedInteractionProperties> | undefined\n>(undefined);\n\nconst taskTypes: Array<TaskDefinition['task_type']> = [\n  'DragTheWords',\n  'FillInTheBlanks',\n  'FindTheHotspots',\n  'FindTheWords',\n  'MarkTheWords',\n  'Memory',\n  'Pairing',\n  'Question',\n  'Sequencing',\n];\n\nprovide(interactiveVideoEditorStateSymbol, {\n  selectInteraction,\n  selectedInteractionId,\n  editInteraction,\n  dragInteraction,\n  resizeOverlay,\n  deleteInteraction,\n  dragInteractionTimeline,\n  resizeInteractionTimeline,\n});\n\n/**\n *  Do the necessary so that calls to performEdit from within the LMB Task\n *  editor will not overwrite the state of the Interactive Video task\n *  that contains them.\n *  TODO Make a graphic diagram of all provides/injects in LernmodulePlugin\n */\n\nprovide(taskEditorStateSymbol, {\n  performEdit: performEditForEditedLmbInteraction,\n});\n\nconst taskEditor = inject<TaskEditorState>(taskEditorStateSymbol);\n\nfunction performEditForEditedLmbInteraction(payload: {\n  newTaskDefinition: TaskDefinitionMinusInteractiveVideo;\n  undoBatch: unknown;\n}): void {\n  // Apply the new task definition for the edited interaction.\n  const newDefinition = produce(\n    props.taskDefinition,\n    (videoTask: InteractiveVideoTask) => {\n      const interactionIndex = videoTask.interactions.findIndex(\n        (i) => i.id === selectedInteractionId.value\n      );\n      if (interactionIndex === -1) {\n        throw new Error('cant find selected interaction in interactions array');\n      }\n      const interaction = videoTask.interactions[interactionIndex];\n      if (interaction.type !== 'lmbTask') {\n        throw new Error('Selected interaction is not of type lmbTask');\n      }\n      interaction.taskDefinition = payload.newTaskDefinition;\n    }\n  );\n  const undoBatch = isEqual(payload.undoBatch, {})\n    ? // If the edited interaction's LMB task editor sends empty object as undoBatch,\n      // pass it through. This way, a new undo/redo state will always be created.\n      {}\n    : // If it doesn't send the empty object, that means that this edit should\n      // be merged together with other edits with the same undoBatch to the same\n      // Interaction.\n      {\n        type: 'editedLmbInteractionTask',\n        interactionId: selectedInteractionId.value,\n        undoBatch: payload.undoBatch,\n      };\n  taskEditor!.performEdit({\n    newTaskDefinition: newDefinition,\n    undoBatch: undoBatch,\n  });\n}\n\nconst selectedInteraction = computed((): Interaction | undefined =>\n  props.taskDefinition.interactions.find(\n    (interaction) => interaction.id === selectedInteractionId.value\n  )\n);\n\nfunction selectInteraction(selectionId: string | undefined) {\n  selectedInteractionId.value = selectionId;\n}\nfunction editInteraction(id: string) {\n  selectedInteractionId.value = id;\n  nextTick(() => {\n    const el = selectedInteractionProperties.value?.$el as HTMLElement;\n    el.scrollIntoView({\n      behavior: 'smooth',\n      block: 'start',\n    });\n  });\n}\nfunction onVideoMetadataChange(data: VideoMetadata) {\n  videoMetadata.value = data;\n}\nfunction onTimeUpdate(time: number) {\n  currentTime.value = time;\n}\nfunction onTimelineSeek(time: number) {\n  videoPlayer.value!.player!.currentTime(time);\n}\nfunction onClickZoomIn() {\n  videoTimeline.value!.zoom(0.18);\n}\nfunction onClickZoomOut() {\n  videoTimeline.value!.zoom(-0.18);\n}\nfunction onClickPlay() {\n  videoPlayer.value!.player!.play();\n}\nfunction onClickPause() {\n  videoPlayer.value!.player!.pause();\n}\nfunction insertOverlay() {\n  const interaction: OverlayInteraction = {\n    type: 'overlay',\n    v: 2,\n    id: v4(),\n    startTime: currentTime.value,\n    endTime: Math.min(videoMetadata.value.length, currentTime.value + 10),\n    x: 0.4,\n    y: 0.4,\n    width: 0.2,\n    height: 0.2,\n    content_wysiwyg: $gettext('Einblendung'),\n    pauseWhenVisible: true,\n  };\n  taskEditor!.performEdit({\n    newTaskDefinition: produce(\n      props.taskDefinition,\n      (draft: InteractiveVideoTask) => {\n        draft.interactions.push(interaction);\n      }\n    ),\n  });\n  selectedInteractionId.value = interaction.id;\n}\n\nfunction insertLmbTaskInteraction(type: TaskDefinition['task_type']) {\n  if (type === 'InteractiveVideo') {\n    throw new Error(strings.forbiddenToNestInteractiveVideos);\n  }\n  const task = newTask(type) as TaskDefinitionMinusInteractiveVideo;\n  const interaction: LmbTaskInteraction = {\n    type: 'lmbTask',\n    id: v4(),\n    taskDefinition: task,\n    startTime: currentTime.value,\n    endTime: Math.min(videoMetadata.value.length, currentTime.value + 10),\n    x: 0.5,\n    y: 0.5,\n    pauseWhenVisible: true,\n  };\n  taskEditor!.performEdit({\n    newTaskDefinition: produce(\n      props.taskDefinition,\n      (draft: InteractiveVideoTask) => {\n        draft.interactions.push(interaction);\n      }\n    ),\n  });\n  selectedInteractionId.value = interaction.id;\n}\nfunction deleteInteraction(id: string) {\n  console.log('deleteInteraction', id);\n  const interaction = props.taskDefinition.interactions.find(\n    (i) => i.id === id\n  );\n  if (!interaction) {\n    throw new Error(strings.interactionNotFoundError);\n  }\n  const prompt = $gettext('%{ interaction } lschen', {\n    interaction: printInteractionType(interaction),\n  });\n  const confirmed = window.confirm(prompt);\n  if (!confirmed) {\n    console.info('Delete prompt canceled by user');\n    return;\n  }\n  const index = props.taskDefinition.interactions.findIndex((i) => i.id === id);\n  if (index === -1) {\n    throw new Error(strings.interactionNotFoundError);\n  }\n  taskEditor!.performEdit({\n    newTaskDefinition: produce(\n      props.taskDefinition,\n      (draft: InteractiveVideoTask) => {\n        draft.interactions.splice(index, 1);\n      }\n    ),\n  });\n}\nfunction dragInteraction(\n  id: string,\n  xFraction: number,\n  yFraction: number,\n  // Used in order to batch actions for undo/redo.  Each time you click, drag,\n  // and let go, that should result in a new state in the undo/redo history.\n  dragState: DragState\n) {\n  taskEditor!.performEdit({\n    newTaskDefinition: produce(\n      props.taskDefinition,\n      (draft: InteractiveVideoTask) => {\n        const interaction = draft.interactions.find((i) => i.id === id);\n        if (!interaction) {\n          throw new Error(`Interaction with id ${id} not found`);\n        }\n        interaction.x = xFraction;\n        interaction.y = yFraction;\n      }\n    ),\n    undoBatch: dragState,\n  });\n}\nfunction resizeOverlay(\n  id: string,\n  x: number,\n  y: number,\n  width: number,\n  height: number,\n  dragState: DragState\n) {\n  taskEditor!.performEdit({\n    newTaskDefinition: produce(\n      props.taskDefinition,\n      (draft: InteractiveVideoTask) => {\n        const interaction = draft.interactions.find((i) => i.id === id);\n        if (!interaction) {\n          throw new Error(`Interaction with id ${id} not found`);\n        }\n        if (interaction.type !== 'overlay') {\n          throw new Error(strings.notAnOverlayError);\n        }\n        interaction.x = x;\n        interaction.y = y;\n        interaction.width = width;\n        interaction.height = height;\n      }\n    ),\n    undoBatch: dragState,\n  });\n}\nfunction dragInteractionTimeline(\n  id: string,\n  startTime: number,\n  dragState: TimelineDragState\n) {\n  taskEditor!.performEdit({\n    newTaskDefinition: produce(\n      props.taskDefinition,\n      (draft: InteractiveVideoTask) => {\n        const interaction = draft.interactions.find((i) => i.id === id);\n        if (!interaction) {\n          throw new Error(`Interaction with id ${id} not found`);\n        }\n        const duration = interaction.endTime - interaction.startTime;\n        interaction.endTime = startTime + duration;\n        interaction.startTime = startTime;\n      }\n    ),\n    undoBatch: dragState,\n  });\n}\n\nfunction resizeInteractionTimeline(\n  id: string,\n  type: 'start' | 'end',\n  time: number,\n  dragState: TimelineDragState\n) {\n  taskEditor!.performEdit({\n    newTaskDefinition: produce(\n      props.taskDefinition,\n      (draft: InteractiveVideoTask) => {\n        const interaction = draft.interactions.find((i) => i.id === id);\n        if (!interaction) {\n          throw new Error(`Interaction with id ${id} not found`);\n        }\n        if (type === 'start') {\n          interaction.startTime = time;\n        } else {\n          interaction.endTime = time;\n        }\n      }\n    ),\n    undoBatch: dragState,\n  });\n}\n</script>\n","import script from \"./AddInteractions.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./AddInteractions.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./AddInteractions.vue?vue&type=style&index=0&id=39de7364&scoped=true&lang=scss\"\n\nimport exportComponent from \"../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-39de7364\"]])\n\nexport default __exports__","import { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, createTextVNode as _createTextVNode, vModelText as _vModelText, withDirectives as _withDirectives, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, vModelCheckbox as _vModelCheckbox, normalizeClass as _normalizeClass, vModelSelect as _vModelSelect, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-a420e4fa\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"picker\" }\nconst _hoisted_2 = { class: \"default\" }\nconst _hoisted_3 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"br\", null, null, -1))\nconst _hoisted_4 = { class: \"bottom-actions\" }\nconst _hoisted_5 = { class: \"default\" }\nconst _hoisted_6 = { class: \"bottom-actions\" }\nconst _hoisted_7 = {\n  key: 1,\n  class: \"video-preview\"\n}\nconst _hoisted_8 = { key: 0 }\nconst _hoisted_9 = [\"href\"]\nconst _hoisted_10 = { key: 1 }\nconst _hoisted_11 = [\"href\"]\nconst _hoisted_12 = { class: \"video-preview-actions\" }\nconst _hoisted_13 = { class: \"form default\" }\nconst _hoisted_14 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"button\", {\n  type: \"submit\",\n  disabled: \"\",\n  style: {\"display\":\"none\"},\n  \"aria-hidden\": \"true\"\n}, null, -1))\nconst _hoisted_15 = { class: \"start-at-setting\" }\nconst _hoisted_16 = { class: \"start-at-setting-flex\" }\nconst _hoisted_17 = {\n  key: 0,\n  class: \"errors\"\n}\nconst _hoisted_18 = { key: 0 }\nconst _hoisted_19 = { value: 'not disabled' }\nconst _hoisted_20 = { value: 'forward disabled' }\nconst _hoisted_21 = { value: 'forward and backward disabled' }\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_FileUpload = _resolveComponent(\"FileUpload\")!\n  const _component_FilePicker = _resolveComponent(\"FilePicker\")!\n  const _component_VideoPlayer = _resolveComponent(\"VideoPlayer\")!\n  const _component_VideoTimeInput = _resolveComponent(\"VideoTimeInput\")!\n\n  return (_openBlock(), _createElementBlock(_Fragment, null, [\n    (_ctx.taskDefinition.video.type === 'none')\n      ? (_openBlock(), _createElementBlock(_Fragment, { key: 0 }, [\n          _createElementVNode(\"p\", null, _toDisplayString(_ctx.$gettext(\n          'Lade ein Video hoch oder fge einen Link zu einem Youtube-Video ein.'\n        )), 1),\n          _createElementVNode(\"div\", _hoisted_1, [\n            _createElementVNode(\"form\", _hoisted_2, [\n              _createElementVNode(\"fieldset\", null, [\n                _createElementVNode(\"legend\", null, _toDisplayString(_ctx.$gettext('Stud.IP-Video')), 1),\n                _createElementVNode(\"label\", null, [\n                  _createTextVNode(_toDisplayString(_ctx.$gettext('Neues Video hochladen')) + \" \", 1),\n                  _hoisted_3,\n                  _createVNode(_component_FileUpload, {\n                    onFileUploaded: _ctx.onUploadStudipVideo,\n                    accept: 'video/*'\n                  }, null, 8, [\"onFileUploaded\"])\n                ]),\n                _createElementVNode(\"label\", null, [\n                  _createTextVNode(_toDisplayString(_ctx.$gettext('Vorhandenes Video auswhlen')) + \" \", 1),\n                  _createVNode(_component_FilePicker, {\n                    modelValue: _ctx.selectedFileId,\n                    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((_ctx.selectedFileId) = $event)),\n                    \"is-video\": \"\",\n                    onSelectFile: _ctx.updateCurrentFile\n                  }, null, 8, [\"modelValue\", \"onSelectFile\"])\n                ]),\n                _createElementVNode(\"div\", _hoisted_4, [\n                  _createElementVNode(\"button\", {\n                    type: \"button\",\n                    class: \"button accept\",\n                    onClick: _cache[1] || (_cache[1] = \n//@ts-ignore\n(...args) => (_ctx.onSaveUploadedFile && _ctx.onSaveUploadedFile(...args)))\n                  }, _toDisplayString(_ctx.$gettext('bernehmen')), 1)\n                ])\n              ])\n            ]),\n            _createElementVNode(\"form\", _hoisted_5, [\n              _createElementVNode(\"fieldset\", null, [\n                _createElementVNode(\"legend\", null, _toDisplayString(_ctx.$gettext('Youtube-Video')), 1),\n                _createElementVNode(\"label\", null, [\n                  _createTextVNode(_toDisplayString(_ctx.$gettext('Youtube-URL')) + \" \", 1),\n                  _withDirectives(_createElementVNode(\"input\", {\n                    class: \"youtube-url-input\",\n                    type: \"text\",\n                    \"onUpdate:modelValue\": _cache[2] || (_cache[2] = ($event: any) => ((_ctx.youtubeUrlInput) = $event))\n                  }, null, 512), [\n                    [_vModelText, _ctx.youtubeUrlInput]\n                  ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_6, [\n                  _createElementVNode(\"button\", {\n                    type: \"submit\",\n                    class: \"button accept\",\n                    onClick: _cache[3] || (_cache[3] = \n//@ts-ignore\n(...args) => (_ctx.onSaveYoutubeVideo && _ctx.onSaveYoutubeVideo(...args)))\n                  }, _toDisplayString(_ctx.$gettext('bernehmen')), 1)\n                ])\n              ])\n            ])\n          ])\n        ], 64))\n      : _createCommentVNode(\"\", true),\n    (_ctx.taskDefinition.video.type !== 'none')\n      ? (_openBlock(), _createElementBlock(\"div\", _hoisted_7, [\n          _createVNode(_component_VideoPlayer, {\n            ref: \"videoPlayer\",\n            task: _ctx.taskDefinition,\n            class: \"video-player\",\n            onTimeupdate: _ctx.onTimeUpdate\n          }, null, 8, [\"task\", \"onTimeupdate\"]),\n          (_ctx.taskDefinition.video.type === 'youtube')\n            ? (_openBlock(), _createElementBlock(\"p\", _hoisted_8, [\n                _createTextVNode(_toDisplayString(_ctx.$gettext('Youtube-Video: ')) + \" \", 1),\n                _createElementVNode(\"a\", {\n                  href: _ctx.taskDefinition.video.url,\n                  target: \"_blank\"\n                }, _toDisplayString(_ctx.taskDefinition.video.url), 9, _hoisted_9)\n              ]))\n            : (_ctx.taskDefinition.video.type === 'studipFileReference')\n              ? (_openBlock(), _createElementBlock(\"p\", _hoisted_10, [\n                  _createTextVNode(_toDisplayString(_ctx.$gettext('Hochgeladenes Video: ')) + \" \", 1),\n                  _createElementVNode(\"a\", {\n                    href: _ctx.fileDetailsUrl(_ctx.taskDefinition.video.file_id),\n                    target: \"_blank\"\n                  }, [\n                    (_ctx.selectedFile)\n                      ? (_openBlock(), _createElementBlock(_Fragment, { key: 0 }, [\n                          _createTextVNode(_toDisplayString(_ctx.selectedFile.name), 1)\n                        ], 64))\n                      : (_openBlock(), _createElementBlock(_Fragment, { key: 1 }, [\n                          _createTextVNode(_toDisplayString(_ctx.taskDefinition.video.file_id), 1)\n                        ], 64))\n                  ], 8, _hoisted_11)\n                ]))\n              : _createCommentVNode(\"\", true),\n          _createElementVNode(\"div\", _hoisted_12, [\n            _createElementVNode(\"button\", {\n              class: \"button trash\",\n              onClick: _cache[4] || (_cache[4] = \n//@ts-ignore\n(...args) => (_ctx.deleteVideo && _ctx.deleteVideo(...args)))\n            }, _toDisplayString(_ctx.$gettext('Video lschen')), 1)\n          ])\n        ]))\n      : _createCommentVNode(\"\", true),\n    _createElementVNode(\"form\", _hoisted_13, [\n      _hoisted_14,\n      _createElementVNode(\"fieldset\", null, [\n        _createElementVNode(\"legend\", null, _toDisplayString(_ctx.$gettext('Einstellungen')), 1),\n        _createElementVNode(\"label\", null, [\n          _withDirectives(_createElementVNode(\"input\", {\n            type: \"checkbox\",\n            \"onUpdate:modelValue\": _cache[5] || (_cache[5] = ($event: any) => ((_ctx.modelTaskDefinition.autoplay) = $event)),\n            onInput: _cache[6] || (_cache[6] = \n//@ts-ignore\n(...args) => (_ctx.updateTaskDefinition && _ctx.updateTaskDefinition(...args)))\n          }, null, 544), [\n            [_vModelCheckbox, _ctx.modelTaskDefinition.autoplay]\n          ]),\n          _createTextVNode(\" \" + _toDisplayString(_ctx.$gettext('Automatisch abspielen')), 1)\n        ]),\n        _createElementVNode(\"div\", _hoisted_15, [\n          _createElementVNode(\"div\", _hoisted_16, [\n            _createElementVNode(\"label\", null, [\n              _createTextVNode(_toDisplayString(_ctx.$gettext('Anfangen um')) + \" \", 1),\n              _createVNode(_component_VideoTimeInput, {\n                class: _normalizeClass({ invalid: !!_ctx.startPositionInputError }),\n                \"aria-invalid\": !!_ctx.startPositionInputError,\n                modelValue: _ctx.modelTaskDefinition.startAt,\n                \"onUpdate:modelValue\": _cache[7] || (_cache[7] = ($event: any) => ((_ctx.modelTaskDefinition.startAt) = $event)),\n                onInput: _cache[8] || (_cache[8] = ($event: any) => (_ctx.updateTaskDefinition('inputStartAt'))),\n                \"onUpdate:error\": _cache[9] || (_cache[9] = (error) => (_ctx.startPositionInputError = error))\n              }, null, 8, [\"class\", \"aria-invalid\", \"modelValue\"])\n            ]),\n            _createElementVNode(\"button\", {\n              type: \"button\",\n              class: \"button\",\n              onClick: _cache[10] || (_cache[10] = \n//@ts-ignore\n(...args) => (_ctx.onClickUseCurrentTime && _ctx.onClickUseCurrentTime(...args)))\n            }, _toDisplayString(_ctx.$gettext('Aktuelle Position setzen')), 1)\n          ]),\n          (_ctx.startPositionInputError)\n            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_17, _toDisplayString(_ctx.startPositionInputError), 1))\n            : _createCommentVNode(\"\", true)\n        ]),\n        false\n          ? (_openBlock(), _createElementBlock(\"label\", _hoisted_18, [\n              _createTextVNode(_toDisplayString(_ctx.$gettext('Navigation deaktivieren')) + \" \", 1),\n              _withDirectives(_createElementVNode(\"select\", {\n                \"onUpdate:modelValue\": _cache[11] || (_cache[11] = ($event: any) => ((_ctx.modelTaskDefinition.disableNavigation) = $event)),\n                onInput: _cache[12] || (_cache[12] = \n//@ts-ignore\n(...args) => (_ctx.updateTaskDefinition && _ctx.updateTaskDefinition(...args)))\n              }, [\n                _createElementVNode(\"option\", _hoisted_19, _toDisplayString(_ctx.$gettext('Nicht deaktiviert')), 1),\n                _createElementVNode(\"option\", _hoisted_20, _toDisplayString(_ctx.$gettext('Vorspulen deaktiviert')), 1),\n                _createElementVNode(\"option\", _hoisted_21, _toDisplayString(_ctx.$gettext('Vorspulen und Rckspulen deaktiviert')), 1)\n              ], 544), [\n                [_vModelSelect, _ctx.modelTaskDefinition.disableNavigation]\n              ])\n            ]))\n          : _createCommentVNode(\"\", true)\n      ])\n    ])\n  ], 64))\n}","<script lang=\"ts\">\nimport { defineComponent, inject, PropType } from 'vue';\nimport VideoPlayer from '@/components/interactiveVideo/VideoPlayer.vue';\nimport { $gettext } from '@/language/gettext';\nimport { InteractiveVideoTask, Video } from '@/models/InteractiveVideoTask';\nimport FileUpload from '@/components/FileUpload.vue';\nimport VideoTimeInput from '@/components/interactiveVideo/VideoTimeInput.vue';\nimport FilePicker, { FilePickerFile } from '@/components/studip/FilePicker.vue';\nimport { FileRef, fileRefsSchema } from '@/routes/jsonApi';\nimport { fileDetailsUrl, fileIdToUrl } from '@/models/TaskDefinition';\nimport { mapActions, mapGetters } from 'vuex';\nimport {\n  TaskEditorState,\n  taskEditorStateSymbol,\n} from '@/components/taskEditorState';\nimport { cloneDeep } from 'lodash';\n\nexport default defineComponent({\n  name: 'SelectVideo',\n  props: {\n    taskDefinition: {\n      type: Object as PropType<InteractiveVideoTask>,\n      required: true,\n    },\n  },\n  setup() {\n    return {\n      taskEditor: inject<TaskEditorState>(taskEditorStateSymbol),\n    };\n  },\n  data() {\n    return {\n      modelTaskDefinition: cloneDeep(this.taskDefinition),\n      youtubeUrlInput: '',\n      startPositionInputError: undefined as Error | undefined,\n      currentTime: 0,\n      selectedFolderId: '',\n      selectedFile: undefined as FilePickerFile | undefined,\n      selectedFileId: '',\n    };\n  },\n  watch: {\n    // Synchronize state taskDefinition -> modelTaskDefinition.\n    taskDefinition: {\n      immediate: true,\n      handler: function (): void {\n        this.modelTaskDefinition = cloneDeep(this.taskDefinition);\n      },\n    },\n    'taskDefinition.video': {\n      immediate: true,\n      handler: async function (value: Video) {\n        switch (value.type) {\n          case 'none':\n            break;\n          case 'studipFileReference':\n            if (\n              this.selectedFile === undefined ||\n              this.selectedFile.id !== value.file_id\n            ) {\n              // Get metadata for file\n              await this.loadFileRef({ id: value.file_id });\n              const ref = fileRefsSchema.parse(\n                this.fileRefById({ id: value.file_id })\n              );\n              this.selectedFile = {\n                id: value.file_id,\n                name: ref.attributes.name,\n                mime_type: ref.attributes['mime-type'],\n                download_url: ref.meta['download-url'],\n              };\n            }\n            break;\n          case 'youtube':\n            this.youtubeUrlInput = value.url;\n        }\n      },\n    },\n  },\n  computed: {\n    ...mapGetters({\n      fileRefById: 'file-refs/byId',\n    }),\n  },\n  methods: {\n    fileDetailsUrl,\n    fileIdToUrl,\n    $gettext,\n    ...mapActions({\n      loadFileRef: 'file-refs/loadById',\n    }),\n    // Synchronize state modelTaskDefinition -> taskDefinition.\n    updateTaskDefinition(undoBatch?: unknown) {\n      this.taskEditor!.performEdit({\n        newTaskDefinition: cloneDeep(this.modelTaskDefinition),\n        undoBatch: undoBatch ?? {},\n      });\n    },\n    onTimeUpdate(time: number) {\n      this.currentTime = time;\n    },\n    onClickUseCurrentTime() {\n      this.modelTaskDefinition.startAt = this.currentTime;\n      this.updateTaskDefinition('inputStartAt');\n    },\n    updateCurrentFile(file: FilePickerFile) {\n      this.selectedFile = file;\n      this.selectedFileId = file.id;\n    },\n    onSaveYoutubeVideo() {\n      this.modelTaskDefinition.video = {\n        type: 'youtube',\n        url: this.youtubeUrlInput,\n      };\n      this.updateTaskDefinition();\n    },\n    onSaveUploadedFile() {\n      if (!this.selectedFile) {\n        throw new Error('No selected file');\n      }\n      this.modelTaskDefinition.video = {\n        v: 2,\n        type: 'studipFileReference',\n        file_id: this.selectedFile.id,\n      };\n      this.updateTaskDefinition();\n    },\n    deleteVideo() {\n      this.modelTaskDefinition.video = {\n        type: 'none',\n      };\n      this.updateTaskDefinition();\n    },\n    onUploadStudipVideo(file: FileRef) {\n      this.modelTaskDefinition.video = {\n        v: 2,\n        type: 'studipFileReference',\n        file_id: file.id,\n      };\n      this.updateTaskDefinition();\n      this.selectedFile = {\n        id: file.id,\n        name: file.attributes.name,\n        mime_type: file.attributes['mime-type'],\n        download_url: file.meta['download-url'],\n      };\n    },\n  },\n  components: {\n    VideoTimeInput,\n    FileUpload,\n    VideoPlayer,\n    FilePicker,\n  },\n});\n</script>\n\n<template>\n  <template v-if=\"taskDefinition.video.type === 'none'\">\n    <p>\n      {{\n        $gettext(\n          'Lade ein Video hoch oder fge einen Link zu einem Youtube-Video ein.'\n        )\n      }}\n    </p>\n    <div class=\"picker\">\n      <form class=\"default\">\n        <fieldset>\n          <legend>\n            {{ $gettext('Stud.IP-Video') }}\n          </legend>\n          <label>\n            {{ $gettext('Neues Video hochladen') }} <br />\n            <FileUpload\n              @file-uploaded=\"onUploadStudipVideo\"\n              :accept=\"'video/*'\"\n            />\n          </label>\n          <label>\n            {{ $gettext('Vorhandenes Video auswhlen') }}\n            <FilePicker\n              v-model=\"selectedFileId\"\n              is-video\n              @selectFile=\"updateCurrentFile\"\n            />\n          </label>\n          <div class=\"bottom-actions\">\n            <button\n              type=\"button\"\n              class=\"button accept\"\n              @click=\"onSaveUploadedFile\"\n            >\n              {{ $gettext('bernehmen') }}\n            </button>\n          </div>\n          <!--          <div style=\"white-space: pre-wrap\">-->\n          <!--            {{ { selectedFile, selectedFileId } }}-->\n          <!--          </div>-->\n        </fieldset>\n      </form>\n      <form class=\"default\">\n        <fieldset>\n          <legend>\n            {{ $gettext('Youtube-Video') }}\n          </legend>\n          <label>\n            {{ $gettext('Youtube-URL') }}\n            <input\n              class=\"youtube-url-input\"\n              type=\"text\"\n              v-model=\"youtubeUrlInput\"\n            />\n          </label>\n          <div class=\"bottom-actions\">\n            <button\n              type=\"submit\"\n              class=\"button accept\"\n              @click=\"onSaveYoutubeVideo\"\n            >\n              {{ $gettext('bernehmen') }}\n            </button>\n          </div>\n        </fieldset>\n      </form>\n    </div>\n  </template>\n  <div class=\"video-preview\" v-if=\"taskDefinition.video.type !== 'none'\">\n    <VideoPlayer\n      ref=\"videoPlayer\"\n      :task=\"taskDefinition\"\n      class=\"video-player\"\n      @timeupdate=\"onTimeUpdate\"\n    />\n    <p v-if=\"taskDefinition.video.type === 'youtube'\">\n      {{ $gettext('Youtube-Video: ') }}\n      <a :href=\"taskDefinition.video.url\" target=\"_blank\">\n        {{ taskDefinition.video.url }}</a\n      >\n    </p>\n    <p v-else-if=\"taskDefinition.video.type === 'studipFileReference'\">\n      {{ $gettext('Hochgeladenes Video: ') }}\n      <a :href=\"fileDetailsUrl(taskDefinition.video.file_id)\" target=\"_blank\">\n        <template v-if=\"selectedFile\">\n          {{ selectedFile.name }}\n        </template>\n        <template v-else>\n          {{ taskDefinition.video.file_id }}\n        </template>\n      </a>\n    </p>\n    <div class=\"video-preview-actions\">\n      <button class=\"button trash\" @click=\"deleteVideo\">\n        {{ $gettext('Video lschen') }}\n      </button>\n    </div>\n  </div>\n  <form class=\"form default\">\n    <!-- Prevent implicit submission of the form -->\n    <button\n      type=\"submit\"\n      disabled\n      style=\"display: none\"\n      aria-hidden=\"true\"\n    ></button>\n    <fieldset>\n      <legend>{{ $gettext('Einstellungen') }}</legend>\n      <label>\n        <input\n          type=\"checkbox\"\n          v-model=\"modelTaskDefinition.autoplay\"\n          @input=\"updateTaskDefinition\"\n        />\n        {{ $gettext('Automatisch abspielen') }}\n      </label>\n      <div class=\"start-at-setting\">\n        <div class=\"start-at-setting-flex\">\n          <label>\n            {{ $gettext('Anfangen um') }}\n            <VideoTimeInput\n              :class=\"{ invalid: !!startPositionInputError }\"\n              :aria-invalid=\"!!startPositionInputError\"\n              v-model=\"modelTaskDefinition.startAt\"\n              @input=\"updateTaskDefinition('inputStartAt')\"\n              @update:error=\"(error) => (startPositionInputError = error)\"\n            />\n          </label>\n          <button type=\"button\" class=\"button\" @click=\"onClickUseCurrentTime\">\n            {{ $gettext('Aktuelle Position setzen') }}\n          </button>\n        </div>\n        <div class=\"errors\" v-if=\"startPositionInputError\">\n          {{ startPositionInputError }}\n        </div>\n      </div>\n      <label v-if=\"false\">\n        <!-- hidden until 'disable navigation' feature is ready -->\n        {{ $gettext('Navigation deaktivieren') }}\n        <select\n          v-model=\"modelTaskDefinition.disableNavigation\"\n          @input=\"updateTaskDefinition\"\n        >\n          <option :value=\"'not disabled'\">\n            {{ $gettext('Nicht deaktiviert') }}\n          </option>\n          <option :value=\"'forward disabled'\">\n            {{ $gettext('Vorspulen deaktiviert') }}\n          </option>\n          <option :value=\"'forward and backward disabled'\">\n            {{ $gettext('Vorspulen und Rckspulen deaktiviert') }}\n          </option>\n        </select>\n      </label>\n    </fieldset>\n  </form>\n</template>\n\n<style scoped lang=\"scss\">\n.picker {\n  display: grid;\n  grid-template-columns: 1fr 1fr;\n  gap: 0.5em;\n  &.hidden {\n    display: none;\n  }\n  > form {\n    > fieldset {\n      height: 100%;\n      display: flex;\n      flex-direction: column;\n      justify-content: space-between;\n      .bottom-actions {\n        display: flex;\n        justify-content: flex-end;\n        button.button {\n          margin-right: 0.6em;\n          margin-bottom: 0;\n          margin-top: 0;\n        }\n      }\n    }\n  }\n  padding-bottom: 1em;\n}\n.youtube-url-input {\n  width: 100%;\n  max-width: 48em;\n  box-sizing: border-box;\n}\n.video-preview {\n  .video-player {\n    margin-bottom: 1em;\n  }\n  .video-preview-actions {\n    margin-top: 1em;\n    text-align: end;\n  }\n}\n.start-at-setting {\n  > .start-at-setting-flex {\n    display: flex;\n    gap: 1em;\n    align-items: flex-end;\n  }\n}\ninput[type='number'].wide {\n  max-width: 12em;\n}\n</style>\n","import { toDisplayString as _toDisplayString, resolveComponent as _resolveComponent, createVNode as _createVNode, createTextVNode as _createTextVNode, createElementVNode as _createElementVNode, withCtx as _withCtx, vShow as _vShow, withDirectives as _withDirectives, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, vModelSelect as _vModelSelect } from \"vue\"\n\nconst _hoisted_1 = { class: \"cw-file-chooser\" }\nconst _hoisted_2 = { value: \"\" }\nconst _hoisted_3 = /*#__PURE__*/_createTextVNode(\"Keine Auswahl\")\nconst _hoisted_4 = [\"value\"]\nconst _hoisted_5 = { disabled: \"\" }\nconst _hoisted_6 = /*#__PURE__*/_createTextVNode(\"Keine Dateien vorhanden\")\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_FolderPicker = _resolveComponent(\"FolderPicker\")!\n  const _component_translate = _resolveComponent(\"translate\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createElementVNode(\"label\", null, [\n      _createTextVNode(_toDisplayString(_ctx.$gettext('Ordner-Filter')) + \" \", 1),\n      _createVNode(_component_FolderPicker, {\n        allowUserFolders: \"\",\n        unchoose: \"\",\n        modelValue: _ctx.selectedFolderId,\n        \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((_ctx.selectedFolderId) = $event))\n      }, null, 8, [\"modelValue\"])\n    ]),\n    _createElementVNode(\"label\", null, [\n      _createTextVNode(_toDisplayString(_ctx.$gettext('Datei')) + \" \", 1),\n      _withDirectives(_createElementVNode(\"select\", {\n        \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event: any) => ((_ctx.currentValue) = $event)),\n        onChange: _cache[2] || (_cache[2] = \n//@ts-ignore\n(...args) => (_ctx.selectFile && _ctx.selectFile(...args)))\n      }, [\n        _withDirectives(_createElementVNode(\"option\", _hoisted_2, [\n          _createVNode(_component_translate, null, {\n            default: _withCtx(() => [\n              _hoisted_3\n            ]),\n            _: 1\n          })\n        ], 512), [\n          [_vShow, _ctx.canBeEmpty]\n        ]),\n        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.files, (file, index) => {\n          return (_openBlock(), _createElementBlock(\"option\", {\n            key: index,\n            value: file.id\n          }, _toDisplayString(file.name), 9, _hoisted_4))\n        }), 128)),\n        _withDirectives(_createElementVNode(\"option\", _hoisted_5, [\n          _createVNode(_component_translate, null, {\n            default: _withCtx(() => [\n              _hoisted_6\n            ]),\n            _: 1\n          })\n        ], 512), [\n          [_vShow, _ctx.files.length === 0]\n        ])\n      ], 544), [\n        [_vModelSelect, _ctx.currentValue]\n      ])\n    ])\n  ]))\n}","<!-- This component is a port of the courseware-file-chooser component from\nthe Stud.IP core 5.4, rewritten in Typescript / Vue 3, removing its dependency\n on the core VueX 3.x store, allowing it to be used in our Vue 3 app. -->\n<template>\n  <div class=\"cw-file-chooser\">\n    <label\n      >{{ $gettext('Ordner-Filter') }}\n      <FolderPicker allowUserFolders unchoose v-model=\"selectedFolderId\" />\n    </label>\n    <label\n      >{{ $gettext('Datei') }}\n      <select v-model=\"currentValue\" @change=\"selectFile\">\n        <option v-show=\"canBeEmpty\" value=\"\">\n          <translate>Keine Auswahl</translate>\n        </option>\n        <option v-for=\"(file, index) in files\" :key=\"index\" :value=\"file.id\">\n          {{ file.name }}\n        </option>\n        <option v-show=\"files.length === 0\" disabled>\n          <translate>Keine Dateien vorhanden</translate>\n        </option>\n      </select>\n    </label>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport FolderPicker from '@/components/studip/FolderPicker.vue';\nimport { mapActions, mapGetters } from 'vuex';\nimport { defineComponent } from 'vue';\nimport { $gettext } from '../../language/gettext';\n\n// TODO #21 Refactor to remove this datatype\nexport interface FilePickerFile {\n  id: string;\n  name: string;\n  mime_type: string;\n  download_url: string;\n}\n\nexport default defineComponent({\n  name: 'FilePicker',\n  components: { FolderPicker },\n  props: {\n    value: String,\n    mimeType: { type: String, default: '' },\n    isImage: { type: Boolean, default: false },\n    isVideo: { type: Boolean, default: false },\n    isAudio: { type: Boolean, default: false },\n    isDocument: { type: Boolean, default: false },\n    canBeEmpty: { type: Boolean, default: false },\n  },\n  data() {\n    return {\n      currentValue: '',\n      selectedFolderId: '',\n      files: [] as any[],\n    };\n  },\n  computed: {\n    ...mapGetters({\n      fileRefById: 'file-refs/byId',\n      relatedFileRefs: 'file-refs/related',\n      relatedTermOfUse: 'terms-of-use/related',\n    }),\n    userId(): string {\n      return window.STUDIP.USER_ID;\n    },\n  },\n  methods: {\n    $gettext,\n    ...mapActions({\n      loadFileRef: 'file-refs/loadById',\n      loadRelatedFileRefs: 'file-refs/loadRelated',\n    }),\n    selectFile() {\n      this.$emit(\n        'selectFile',\n        this.files.find((file) => file.id === this.currentValue)\n      );\n    },\n    filterFiles(loadArray: any[]) {\n      const filterFile = (file: any) => {\n        let fileTermsOfUse = this.relatedTermOfUse({\n          parent: file,\n          relationship: 'terms-of-use',\n        });\n\n        if (\n          fileTermsOfUse !== null &&\n          fileTermsOfUse.attributes['download-condition'] !== 0\n        ) {\n          return false;\n        }\n        if (\n          this.mimeType !== '' &&\n          this.mimeType !== file.attributes['mime-type']\n        ) {\n          return false;\n        }\n        if (this.isImage && !file.attributes['mime-type'].includes('image')) {\n          return false;\n        }\n        const videoConditions = ['video/mp4', 'video/ogg', 'video/webm'];\n        if (\n          this.isVideo &&\n          !videoConditions.some((condition) =>\n            file.attributes['mime-type'].includes(condition)\n          )\n        ) {\n          return false;\n        }\n        const audioConditions = [\n          'audio/wav',\n          'audio/ogg',\n          'audio/webm',\n          'audio/flac',\n          'audio/mpeg',\n          'audio/x-m4a',\n          'audio/mp4',\n        ];\n        if (\n          this.isAudio &&\n          !audioConditions.some((condition) =>\n            file.attributes['mime-type'].includes(condition)\n          )\n        ) {\n          return false;\n        }\n        const officeConditions = ['application/pdf']; //TODO enable more mime types\n        if (\n          this.isDocument &&\n          !officeConditions.some((condition) =>\n            file.attributes['mime-type'].includes(condition)\n          )\n        ) {\n          return false;\n        }\n\n        return true;\n      };\n\n      // TODO #21 Refactor.. I'm not sure it is useful to map the file-ref,\n      // which we fetched from the JSON API, to a subset of its keys here.\n      // Clients may need other values, like the folder ID, which we do not\n      // provide here.\n      return loadArray.filter(filterFile).map((file) => ({\n        id: file.id,\n        name: file.attributes.name,\n        mime_type: file.attributes['mime-type'],\n        download_url: window.STUDIP.URLHelper.getURL(\n          'sendfile.php',\n          { type: 0, file_id: file.id, file_name: file.attributes.name },\n          true\n        ),\n      }));\n    },\n    async getFolderFiles() {\n      const parent = { type: 'folders', id: `${this.selectedFolderId}` };\n      const relationship = 'file-refs';\n      const options = { include: 'terms-of-use', 'page[limit]': 10000 };\n      await this.loadRelatedFileRefs({ parent, relationship, options });\n\n      const fileRefs = this.relatedFileRefs({ parent, relationship });\n      this.files = this.filterFiles(fileRefs);\n    },\n  },\n  async mounted() {\n    console.log('mounted');\n    if (this.value) {\n      try {\n        await this.loadFileRef({ id: this.value });\n      } catch (error: unknown) {\n        console.error(\n          'loadfileRef threw an error. File picker will not be ' +\n            'initialized to show the selected file.',\n          error\n        );\n        return;\n      }\n      const fileRef = this.fileRefById({ id: this.value });\n\n      if (fileRef) {\n        this.selectedFolderId = fileRef.relationships.parent.data.id;\n        this.currentValue = this.value ?? '';\n      }\n    }\n  },\n  watch: {\n    selectedFolderId() {\n      if (this.selectedFolderId !== '') {\n        this.getFolderFiles();\n      }\n    },\n    value(newValue, oldValue) {\n      if (newValue === '') {\n        this.selectedFolderId = '';\n        this.currentValue = '';\n      }\n    },\n  },\n});\n</script>\n","import { createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, toDisplayString as _toDisplayString, vModelSelect as _vModelSelect, withDirectives as _withDirectives } from \"vue\"\n\nconst _hoisted_1 = {\n  key: 0,\n  value: \"\"\n}\nconst _hoisted_2 = /*#__PURE__*/_createTextVNode(\"kein Ordner ausgewhlt\")\nconst _hoisted_3 = [\"label\"]\nconst _hoisted_4 = [\"value\"]\nconst _hoisted_5 = [\"label\"]\nconst _hoisted_6 = [\"value\"]\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_translate = _resolveComponent(\"translate\")!\n\n  return _withDirectives((_openBlock(), _createElementBlock(\"select\", {\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((_ctx.currentValue) = $event)),\n    onChange: _cache[1] || (_cache[1] = \n//@ts-ignore\n(...args) => (_ctx.changeSelection && _ctx.changeSelection(...args)))\n  }, [\n    (_ctx.unchoose)\n      ? (_openBlock(), _createElementBlock(\"option\", _hoisted_1, [\n          _createVNode(_component_translate, null, {\n            default: _withCtx(() => [\n              _hoisted_2\n            ]),\n            _: 1\n          })\n        ]))\n      : _createCommentVNode(\"\", true),\n    (_ctx.context.type === 'courses')\n      ? (_openBlock(), _createElementBlock(\"optgroup\", {\n          key: 1,\n          label: _ctx.textOptGroupCourse\n        }, [\n          (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.loadedCourseFolders, (folder) => {\n            return (_openBlock(), _createElementBlock(\"option\", {\n              key: folder.id,\n              value: folder.id\n            }, _toDisplayString(folder.attributes.name), 9, _hoisted_4))\n          }), 128))\n        ], 8, _hoisted_3))\n      : _createCommentVNode(\"\", true),\n    (_ctx.allowUserFolders)\n      ? (_openBlock(), _createElementBlock(\"optgroup\", {\n          key: 2,\n          label: _ctx.textOptGroupUser\n        }, [\n          (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.loadedUserFolders, (folder) => {\n            return (_openBlock(), _createElementBlock(\"option\", {\n              key: folder.id,\n              value: folder.id\n            }, _toDisplayString(folder.attributes.name), 9, _hoisted_6))\n          }), 128))\n        ], 8, _hoisted_5))\n      : _createCommentVNode(\"\", true)\n  ], 544)), [\n    [_vModelSelect, _ctx.currentValue]\n  ])\n}","<!-- This component is a port of the courseware-folder-chooser component from\nthe Stud.IP core 5.4, rewritten in Typescript / Vue 3, removing its dependency\n on the core VueX store. -->\n<template>\n  <select v-model=\"currentValue\" @change=\"changeSelection\">\n    <option v-if=\"unchoose\" value=\"\">\n      <translate>kein Ordner ausgewhlt</translate>\n    </option>\n    <optgroup v-if=\"context.type === 'courses'\" :label=\"textOptGroupCourse\">\n      <option\n        v-for=\"folder in loadedCourseFolders\"\n        :key=\"folder.id\"\n        :value=\"folder.id\"\n      >\n        {{ folder.attributes.name }}\n      </option>\n    </optgroup>\n    <optgroup v-if=\"allowUserFolders\" :label=\"textOptGroupUser\">\n      <option\n        v-for=\"folder in loadedUserFolders\"\n        :key=\"folder.id\"\n        :value=\"folder.id\"\n      >\n        {{ folder.attributes.name }}\n      </option>\n    </optgroup>\n  </select>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from 'vue';\nimport { Context } from '@/models/CoursewareBlockIframeMessages';\nimport { coursewareBlockStore } from '@/store';\nimport { mapActions, mapGetters } from 'vuex';\nimport { FolderRef } from '@/routes/jsonApi';\n\nfunction filterCourseFolders(\n  folders: FolderRef[],\n  { allowHomeworkFolders }: { allowHomeworkFolders: boolean }\n) {\n  const validatedParents = new Map();\n\n  return folders.filter((folder: FolderRef) => {\n    if (validateParentFolder(folder)) {\n      switch (folder.attributes['folder-type']) {\n        case 'HiddenFolder':\n          if (folder.attributes['data-content']['download_allowed'] === 1) {\n            return true;\n          }\n          break;\n        case 'HomeworkFolder':\n          if (allowHomeworkFolders) {\n            return true;\n          }\n          break;\n        default:\n          return true;\n      }\n    }\n  });\n\n  function validateParentFolder(folder: FolderRef): boolean {\n    let isValid = true;\n    if (folder?.relationships?.parent) {\n      let parentId = folder.relationships.parent.data.id;\n      if (validatedParents.has(parentId)) {\n        isValid = validatedParents.get(parentId);\n      } else {\n        let parent = folders.find((f) => f.id === parentId);\n        if (parent) {\n          isValid = hiddenParentFolderValidation(parent);\n          validatedParents.set(parentId, isValid);\n        }\n      }\n    }\n    return isValid;\n  }\n\n  function hiddenParentFolderValidation(parentFolder: FolderRef): boolean {\n    if (parentFolder.attributes['folder-type'] === 'HiddenFolder') {\n      return false;\n    } else if (parentFolder?.relationships?.parent) {\n      // Recursively validating the parents.\n      return validateParentFolder(parentFolder);\n    } else {\n      return true;\n    }\n  }\n}\n\nexport default defineComponent({\n  name: 'FolderPicker',\n  props: {\n    value: {\n      type: String,\n      required: false,\n      default: '',\n    },\n    allowUserFolders: { type: Boolean, default: false },\n    allowHomeworkFolders: { type: Boolean, default: false },\n    unchoose: { type: Boolean, default: false },\n  },\n  data() {\n    return {\n      currentValue: '',\n      textOptGroupCourse: this.$gettext('Dateibereich dieser Veranstaltung'),\n      textOptGroupUser: this.$gettext('Persnlicher Dateibereich'),\n    };\n  },\n  computed: {\n    ...mapGetters({\n      relatedFolders: 'folders/related',\n    }),\n    context(): Context {\n      // Replaces the vuex getter 'context'\n      return coursewareBlockStore.studipContext;\n    },\n    userId(): string {\n      // Replaces the vuex getter 'userId'\n      return window.STUDIP.USER_ID;\n    },\n    courseObject() {\n      return { type: 'courses', id: `${this.context.id}` };\n    },\n    userObject() {\n      return { type: 'users', id: `${this.userId}` };\n    },\n    loadedCourseFolders() {\n      return filterCourseFolders(\n        this.relatedFolders({\n          parent: this.courseObject,\n          relationship: 'folders',\n        }) ?? [],\n        {\n          allowHomeworkFolders: this.allowHomeworkFolders,\n        }\n      );\n    },\n    loadedUserFolders() {\n      let loadedUserFolders: FolderRef[] = [];\n      let userFolders: FolderRef[] =\n        this.relatedFolders({\n          parent: this.userObject,\n          relationship: 'folders',\n        }) ?? [];\n      userFolders.forEach((folder: FolderRef) => {\n        if (folder.attributes['folder-type'] === 'PublicFolder') {\n          loadedUserFolders.push(folder);\n        }\n      });\n\n      return loadedUserFolders;\n    },\n  },\n  methods: {\n    ...mapActions({\n      _loadRelatedFolders: 'folders/loadRelated',\n    }),\n    // Typed shim for vuex action 'folders/loadRelated'\n    loadRelatedFolders(params: {\n      parent: {\n        type: string;\n        id: string;\n      };\n      relationship: string;\n      options: {\n        'page[limit]': number;\n      };\n    }): Promise<unknown> {\n      return this._loadRelatedFolders(params);\n    },\n\n    changeSelection() {\n      this.$emit('input', this.currentValue);\n    },\n\n    getCourseFolders() {\n      const parent = this.courseObject;\n      const relationship = 'folders';\n      const options = { 'page[limit]': 10000 };\n\n      return this.loadRelatedFolders({ parent, relationship, options });\n    },\n\n    getUserFolders() {\n      const parent = this.userObject;\n      const relationship = 'folders';\n      const options = { 'page[limit]': 10000 };\n\n      return this.loadRelatedFolders({ parent, relationship, options });\n    },\n\n    confirmSelectedFolder() {\n      const folders: FolderRef[] = this.loadedUserFolders.concat(\n        this.loadedCourseFolders\n      );\n\n      let folder = folders.find((folder) => folder.id === this.currentValue);\n\n      if (this.currentValue !== '' && folder === undefined) {\n        this.currentValue = '';\n        this.changeSelection();\n      }\n    },\n  },\n  async mounted() {\n    this.currentValue = this.value;\n    if (this.context.type !== 'users') {\n      try {\n        await this.getCourseFolders();\n      } catch (error) {\n        console.error('Error loading course folders: ', error);\n      }\n    }\n    try {\n      await this.getUserFolders();\n    } catch (error) {\n      console.error('Error loading user folders: ', error);\n    }\n    this.confirmSelectedFolder();\n  },\n  watch: {\n    value() {\n      this.currentValue = this.value;\n    },\n  },\n});\n</script>\n","import { render } from \"./FolderPicker.vue?vue&type=template&id=422ae930&ts=true\"\nimport script from \"./FolderPicker.vue?vue&type=script&lang=ts\"\nexport * from \"./FolderPicker.vue?vue&type=script&lang=ts\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { render } from \"./FilePicker.vue?vue&type=template&id=78a89c55&ts=true\"\nimport script from \"./FilePicker.vue?vue&type=script&lang=ts\"\nexport * from \"./FilePicker.vue?vue&type=script&lang=ts\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { render } from \"./SelectVideo.vue?vue&type=template&id=a420e4fa&scoped=true&ts=true\"\nimport script from \"./SelectVideo.vue?vue&type=script&lang=ts\"\nexport * from \"./SelectVideo.vue?vue&type=script&lang=ts\"\n\nimport \"./SelectVideo.vue?vue&type=style&index=0&id=a420e4fa&scoped=true&lang=scss\"\n\nimport exportComponent from \"../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-a420e4fa\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { vModelCheckbox as _vModelCheckbox, createElementVNode as _createElementVNode, withDirectives as _withDirectives, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, vModelText as _vModelText, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-9bf42a86\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"default travis-go-settings\" }\n\nimport { PropType, ref, watch } from 'vue';\nimport { TravisGoSettings } from '@/models/InteractiveVideoTask';\nimport { cloneDeep } from 'lodash';\n\n\nexport default /*#__PURE__*/_defineComponent({\n  props: {\n  settings: {\n    type: Object as PropType<TravisGoSettings>,\n    required: true,\n  },\n},\n  emits: {\n  update(payload: { settings: TravisGoSettings; undoBatch?: unknown }) {\n    return true;\n  },\n},\n  setup(__props, { emit }) {\n\nconst props = __props\n\n\n\n\n\nconst modelSettings = ref<TravisGoSettings>(cloneDeep(props.settings));\nwatch(\n  () => props.settings,\n  (settings) => {\n    modelSettings.value = cloneDeep(settings);\n  },\n  { deep: true }\n);\n\nfunction updateSettings(undoBatch: unknown = {}) {\n  emit('update', {\n    settings: modelSettings.value,\n    undoBatch,\n  });\n}\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(\"form\", _hoisted_1, [\n    _createElementVNode(\"label\", null, [\n      _withDirectives(_createElementVNode(\"input\", {\n        type: \"checkbox\",\n        \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((modelSettings.value.enabled) = $event)),\n        onChange: updateSettings\n      }, null, 544), [\n        [_vModelCheckbox, modelSettings.value.enabled]\n      ]),\n      _createTextVNode(\" \" + _toDisplayString(_ctx.$gettext('\"Travis Go\"-Funktionalitt enablen')), 1)\n    ]),\n    (modelSettings.value.enabled)\n      ? (_openBlock(), _createElementBlock(_Fragment, { key: 0 }, [\n          _createElementVNode(\"label\", null, [\n            _createTextVNode(_toDisplayString(_ctx.$gettext('Projekttitel')) + \" \", 1),\n            _withDirectives(_createElementVNode(\"input\", {\n              type: \"text\",\n              \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event: any) => ((modelSettings.value.projectTitle) = $event)),\n              onInput: _cache[2] || (_cache[2] = ($event: any) => (updateSettings('editProjectTitle')))\n            }, null, 544), [\n              [_vModelText, modelSettings.value.projectTitle]\n            ])\n          ]),\n          _createElementVNode(\"label\", null, [\n            _createTextVNode(_toDisplayString(_ctx.$gettext('Projektbeschreibung')) + \" \", 1),\n            _withDirectives(_createElementVNode(\"input\", {\n              type: \"text\",\n              \"onUpdate:modelValue\": _cache[3] || (_cache[3] = ($event: any) => ((modelSettings.value.projectDescription) = $event)),\n              onInput: _cache[4] || (_cache[4] = ($event: any) => (updateSettings('editProjectDescription')))\n            }, null, 544), [\n              [_vModelText, modelSettings.value.projectDescription]\n            ])\n          ])\n        ], 64))\n      : _createCommentVNode(\"\", true)\n  ]))\n}\n}\n\n})","<script setup lang=\"ts\">\nimport { defineProps, PropType, ref, defineEmits, watch } from 'vue';\nimport { TravisGoSettings } from '@/models/InteractiveVideoTask';\nimport { cloneDeep } from 'lodash';\n\nconst emit = defineEmits({\n  update(payload: { settings: TravisGoSettings; undoBatch?: unknown }) {\n    return true;\n  },\n});\n\nconst props = defineProps({\n  settings: {\n    type: Object as PropType<TravisGoSettings>,\n    required: true,\n  },\n});\n\nconst modelSettings = ref<TravisGoSettings>(cloneDeep(props.settings));\nwatch(\n  () => props.settings,\n  (settings) => {\n    modelSettings.value = cloneDeep(settings);\n  },\n  { deep: true }\n);\n\nfunction updateSettings(undoBatch: unknown = {}) {\n  emit('update', {\n    settings: modelSettings.value,\n    undoBatch,\n  });\n}\n</script>\n\n<template>\n  <form class=\"default travis-go-settings\">\n    <label>\n      <input\n        type=\"checkbox\"\n        v-model=\"modelSettings.enabled\"\n        @change=\"updateSettings\"\n      />\n      {{ $gettext('\"Travis Go\"-Funktionalitt enablen') }}\n    </label>\n    <template v-if=\"modelSettings.enabled\">\n      <label>\n        {{ $gettext('Projekttitel') }}\n        <input\n          type=\"text\"\n          v-model=\"modelSettings.projectTitle\"\n          @input=\"updateSettings('editProjectTitle')\"\n        />\n      </label>\n      <label>\n        {{ $gettext('Projektbeschreibung') }}\n        <input\n          type=\"text\"\n          v-model=\"modelSettings.projectDescription\"\n          @input=\"updateSettings('editProjectDescription')\"\n        />\n      </label>\n    </template>\n  </form>\n</template>\n\n<style scoped lang=\"scss\">\n.travis-go-settings {\n  padding: 10px;\n}\n</style>\n","import script from \"./ConfigureTravisGo.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./ConfigureTravisGo.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./ConfigureTravisGo.vue?vue&type=style&index=0&id=9bf42a86&scoped=true&lang=scss\"\n\nimport exportComponent from \"../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-9bf42a86\"]])\n\nexport default __exports__","import { render } from \"./InteractiveVideoEditor.vue?vue&type=template&id=954d6b0a&ts=true\"\nimport script from \"./InteractiveVideoEditor.vue?vue&type=script&lang=ts\"\nexport * from \"./InteractiveVideoEditor.vue?vue&type=script&lang=ts\"\n\nimport exportComponent from \"../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<!-- Copied from KanbanBoard plugin -->\n<!-- TODO Implement icons. -->\n<template>\n  <div v-if=\"shouldCollapse\" class=\"action-menu\">\n    <button class=\"action-menu-icon\" :title=\"tooltip\" aria-expanded=\"false\">\n      <span></span>\n      <span></span>\n      <span></span>\n    </button>\n    <div class=\"action-menu-content\">\n      <div class=\"action-menu-title\">\n        {{ title }}\n      </div>\n      <ul class=\"action-menu-list\">\n        <li\n          v-for=\"item in navigationItems\"\n          :key=\"item.id\"\n          class=\"action-menu-item\"\n          :class=\"{ 'action-menu-item-disabled': item.disabled }\"\n        >\n          <label\n            v-if=\"item.disabled\"\n            aria-disabled=\"true\"\n            v-bind=\"item.attributes\"\n          >\n            <studip-icon\n              v-if=\"item.icon\"\n              :shape=\"item.icon\"\n              role=\"inactive\"\n              class=\"action-menu-item-icon\"\n            />\n            <span v-else class=\"action-menu-no-icon\"></span>\n\n            {{ item.label }}\n          </label>\n          <a\n            v-else-if=\"item.type === 'link'\"\n            v-bind=\"item.attributes\"\n            v-on=\"linkEvents(item)\"\n          >\n            <studip-icon\n              v-if=\"item.icon\"\n              :shape=\"item.icon\"\n              class=\"action-menu-item-icon\"\n            />\n            <span v-else class=\"action-menu-no-icon\"></span>\n\n            {{ item.label }}\n          </a>\n          <label\n            v-else-if=\"item.icon\"\n            class=\"undecorated\"\n            v-on=\"linkEvents(item)\"\n            tabindex=\"0\"\n          >\n            <studip-icon\n              :shape=\"item.icon\"\n              :name=\"item.name\"\n              class=\"action-menu-item-icon\"\n              v-bind=\"item.attributes\"\n            />\n            {{ item.label }}\n          </label>\n          <template v-else>\n            <span class=\"action-menu-no-icon\"></span>\n            <button\n              :name=\"item.name\"\n              v-bind=\"item.attributes\"\n              v-on=\"linkEvents(item)\"\n            >\n              {{ item.label }}\n            </button>\n          </template>\n        </li>\n      </ul>\n    </div>\n  </div>\n  <div v-else>\n    <template v-for=\"item in navigationItems\">\n      <label\n        v-if=\"item.disabled\"\n        :key=\"item.id\"\n        aria-disabled=\"true\"\n        v-bind=\"item.attributes\"\n      >\n        <studip-icon\n          :shape=\"item.icon\"\n          :title=\"item.label\"\n          role=\"inactive\"\n          class=\"action-menu-item-icon\"\n        />\n      </label>\n      <a v-else :key=\"item.id\" v-bind=\"item.attributes\" v-on=\"linkEvents(item)\">\n        <studip-icon\n          :shape=\"item.icon\"\n          :title=\"item.label\"\n          class=\"action-menu-item-icon\"\n        />\n      </a>\n    </template>\n  </div>\n</template>\n\n<script>\nimport { $gettext } from '@/language/gettext';\nimport StudipIcon from '@/components/studip/StudipIcon.vue';\n\nexport default {\n  name: 'studip-action-menu',\n  components: { StudipIcon },\n  props: {\n    items: Array,\n    collapseAt: {\n      default: null,\n    },\n    context: {\n      type: String,\n      default: '',\n    },\n    title: {\n      type: String,\n      default() {\n        return $gettext('Aktionen');\n      },\n    },\n  },\n  data() {\n    return {\n      open: false,\n    };\n  },\n  methods: {\n    linkEvents(item) {\n      let events = {};\n      if (item.emit) {\n        events.click = (e) => {\n          e.preventDefault();\n          this.$emit.apply(this, [item.emit].concat(item.emitArguments ?? []));\n          this.close();\n        };\n      }\n      return events;\n    },\n    close() {\n      window.STUDIP.ActionMenu.closeAll();\n    },\n  },\n  computed: {\n    navigationItems() {\n      return this.items.map((item) => {\n        item.type = item.type ?? 'link';\n        item.attributes = item.attributes ?? {};\n\n        if (item.type === 'link') {\n          item.attributes.href = item.url ?? '#';\n        }\n\n        return item;\n      });\n    },\n    shouldCollapse() {\n      const collapseAt = this.collapseAt ?? 4;\n\n      if (collapseAt === false) {\n        return false;\n      }\n      if (collapseAt === true) {\n        return true;\n      }\n      return Number.parseInt(collapseAt) <= this.items.length;\n    },\n    tooltip() {\n      return this.context\n        ? this.$gettextInterpolate(this.$gettext('%{title} fr %{context}'), {\n            title: this.title,\n            context: this.context,\n          })\n        : this.title;\n    },\n  },\n};\n</script>\n","type CacheOption = 'off' | 'session' | 'local';\n\ntype CachedIcon = {\n  isSvg: boolean;\n  content: string;\n};\n\nclass IconLoader {\n  readonly #cacheKey: string = 'studip/icons';\n\n  #baseUrl: string;\n  #useCache: CacheOption = 'off';\n\n  #cache: Map<string, string>;\n  #promises: Map<string, Promise<CachedIcon>>;\n\n  constructor(baseUrl: string, useCache: CacheOption = 'off') {\n    this.#baseUrl = baseUrl;\n    this.#useCache = useCache;\n\n    this.#cache = new Map<string, string>(this.#initialState());\n    this.#promises = new Map<string, Promise<CachedIcon>>();\n  }\n\n  async load(shape: string): Promise<CachedIcon> {\n    if (this.#cache.has(shape)) {\n      return JSON.parse(this.#cache.get(shape)!);\n    }\n\n    if (this.#promises.has(shape)) {\n      return this.#promises.get(shape)!;\n    }\n\n    const containsUrl = (shape: string): boolean =>\n      /\\bhttps?:\\/\\/[^\\s]+/i.test(shape);\n\n    const url = containsUrl(shape)\n      ? shape\n      : `${this.#baseUrl}images/icons/blue/${shape}.svg`;\n\n    const promise = (async () => {\n      try {\n        const response = await fetch(url);\n        if (!response.ok) {\n          throw new Error(\n            `IconLoader: HTTP ${response.status} ${response.statusText}`\n          );\n        }\n\n        const icon: CachedIcon = {\n          isSvg:\n            response.headers.get('Content-Type')?.includes('image/svg+xml') ??\n            false,\n          content: '',\n        };\n\n        if (icon.isSvg) {\n          let svg = await response.text();\n          svg = svg.replace(/fill=\"(?!none)[^\"]+\"/g, 'fill=\"currentColor\"');\n          svg = svg.replace(/(width|height)=\"[^\"]+\"/g, '');\n          icon.content = svg;\n        } else {\n          const blob = await response.blob();\n          icon.content = await new Promise((resolve) => {\n            const reader = new FileReader();\n            reader.onload = () => resolve(reader.result as string);\n            reader.readAsDataURL(blob);\n          });\n        }\n\n        this.store(shape, icon);\n\n        return icon;\n      } catch (error) {\n        console.error(`IconLoader: Fehler beim Laden von ${shape}`, error);\n        return {\n          isSvg: true,\n          content: '',\n        } as CachedIcon;\n      } finally {\n        this.#promises.delete(shape);\n      }\n    })();\n\n    this.#promises.set(shape, promise);\n\n    return promise;\n  }\n\n  store(shape: string, icon: CachedIcon): void {\n    this.#cache.set(shape, JSON.stringify(icon));\n\n    this.#getStorage()?.setItem(\n      this.#cacheKey,\n      JSON.stringify([...this.#cache])\n    );\n  }\n\n  #getStorage(): Storage | null {\n    if (this.#useCache === 'off') {\n      return null;\n    }\n    return this.#useCache === 'session' ? sessionStorage : localStorage;\n  }\n\n  #initialState(): [string, string][] {\n    const cached = this.#getStorage()?.getItem(this.#cacheKey);\n    if (!cached) {\n      return [];\n    }\n\n    try {\n      return JSON.parse(cached);\n    } catch {\n      return [];\n    }\n  }\n}\n\nconst defaultLoader = new IconLoader(window.STUDIP.ASSETS_URL, 'session');\n\nexport default defaultLoader;\nexport { IconLoader, CachedIcon };\n","import { defineComponent as _defineComponent } from 'vue'\nimport { unref as _unref, mergeProps as _mergeProps, createElementVNode as _createElementVNode, normalizeProps as _normalizeProps, guardReactiveProps as _guardReactiveProps, createVNode as _createVNode, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, createBlock as _createBlock } from \"vue\"\n\nconst _hoisted_1 = {\n  key: 0,\n  class: \"icon-button undecorated\"\n}\nconst _hoisted_2 = { key: 0 }\n\nimport {\n  computed,\n  defineComponent,\n  h,\n  ref,\n  useAttrs,\n  watch,\n  withDefaults,\n  CSSProperties,\n  PropType,\n} from 'vue';\nimport iconLoader, { CachedIcon } from '@/components/studip/icon-loader';\n\ninterface IconProps {\n  ariaRole?: string;\n  name?: string;\n  role?: string;\n  shape: string;\n  size?: number | null;\n  inline?: boolean;\n  text?: string;\n}\n\n\nexport default /*#__PURE__*/_defineComponent({\n  props: {\n    ariaRole: null,\n    name: null,\n    role: { default: 'clickable' },\n    shape: null,\n    size: { default: null },\n    inline: { type: Boolean, default: false },\n    text: null\n  },\n  setup(__props: any) {\n\nconst props = __props as { ariaRole?: string, name?: string, role: string, shape: string, size: number | null, inline: boolean, text?: string }\n\n\n\nconst isSvg = ref(false);\nconst content = ref('');\n\nconst attrs = useAttrs();\nconst iconAttrs = computed(() => ({\n  ariaRole: props.ariaRole,\n  class: cssClass.value,\n  content: content.value,\n  isSvg: isSvg.value,\n  style: computedStyle.value,\n}));\nconst allAttrs = computed(() => ({\n  ...attrs,\n  ...iconAttrs.value,\n}));\n\nconst cssClass = computed(() => [\n  'studip-icon',\n  props.inline ? 'studip-icon-inline' : '',\n  `icon-role-${props.role}`,\n  `icon-shape-${shapeName.value}`,\n]);\n\nconst computedStyle = computed(() =>\n  props.size ? { width: `${props.size}px`, height: `${props.size}px` } : {}\n);\n\nconst shapeName = computed((): string => {\n  const containsUrl = (shape: string): boolean =>\n    /\\bhttps?:\\/\\/\\S+/i.test(shape);\n  return containsUrl(props.shape)\n    ? props.shape.split('/').pop()?.replace('.svg', '') ?? ''\n    : props.shape;\n});\n\nwatch(\n  () => props.shape,\n  async (shape) => {\n    const icon: CachedIcon = await iconLoader.load(shape);\n    isSvg.value = icon.isSvg;\n    content.value = icon.content;\n  },\n  { immediate: true }\n);\n\nconst IconContent = defineComponent({\n  props: {\n    isSvg: Boolean,\n    content: String,\n    ariaRole: String,\n    cssClass: String,\n    computedStyle: Object as PropType<CSSProperties>,\n  },\n  setup(props, { attrs }) {\n    const baseAttrs = {\n      class: props.cssClass,\n      role: props.ariaRole,\n      style: props.computedStyle,\n      ...attrs,\n    };\n\n    return () =>\n      props.isSvg\n        ? h('div', {\n            innerHTML: props.content,\n            ...baseAttrs,\n          })\n        : h('img', {\n            src: props.content,\n            ...baseAttrs,\n          });\n  },\n});\n\nreturn (_ctx: any,_cache: any) => {\n  return (__props.name)\n    ? (_openBlock(), _createElementBlock(\"label\", _hoisted_1, [\n        _createElementVNode(\"input\", _mergeProps({\n          type: \"submit\",\n          hidden: \"\"\n        }, _unref(attrs)), null, 16),\n        _createVNode(_unref(IconContent), _normalizeProps(_guardReactiveProps(_unref(iconAttrs))), null, 16),\n        (__props.text)\n          ? (_openBlock(), _createElementBlock(\"span\", _hoisted_2, _toDisplayString(__props.text), 1))\n          : _createCommentVNode(\"\", true)\n      ]))\n    : (_openBlock(), _createBlock(_unref(IconContent), _normalizeProps(_mergeProps({ key: 1 }, _unref(allAttrs))), null, 16))\n}\n}\n\n})","<template>\n  <label v-if=\"name\" class=\"icon-button undecorated\">\n    <input type=\"submit\" hidden v-bind=\"attrs\" />\n    <IconContent v-bind=\"iconAttrs\" />\n    <span v-if=\"text\">{{ text }}</span>\n  </label>\n\n  <IconContent v-else v-bind=\"allAttrs\" />\n</template>\n\n<script lang=\"ts\" setup>\nimport {\n  computed,\n  defineComponent,\n  h,\n  ref,\n  useAttrs,\n  watch,\n  defineProps,\n  withDefaults,\n  CSSProperties,\n  PropType,\n} from 'vue';\nimport iconLoader, { CachedIcon } from '@/components/studip/icon-loader';\n\ninterface IconProps {\n  ariaRole?: string;\n  name?: string;\n  role?: string;\n  shape: string;\n  size?: number | null;\n  inline?: boolean;\n  text?: string;\n}\n\nconst props = withDefaults(defineProps<IconProps>(), {\n  role: 'clickable',\n  size: null,\n  inline: false,\n});\n\nconst isSvg = ref(false);\nconst content = ref('');\n\nconst attrs = useAttrs();\nconst iconAttrs = computed(() => ({\n  ariaRole: props.ariaRole,\n  class: cssClass.value,\n  content: content.value,\n  isSvg: isSvg.value,\n  style: computedStyle.value,\n}));\nconst allAttrs = computed(() => ({\n  ...attrs,\n  ...iconAttrs.value,\n}));\n\nconst cssClass = computed(() => [\n  'studip-icon',\n  props.inline ? 'studip-icon-inline' : '',\n  `icon-role-${props.role}`,\n  `icon-shape-${shapeName.value}`,\n]);\n\nconst computedStyle = computed(() =>\n  props.size ? { width: `${props.size}px`, height: `${props.size}px` } : {}\n);\n\nconst shapeName = computed((): string => {\n  const containsUrl = (shape: string): boolean =>\n    /\\bhttps?:\\/\\/\\S+/i.test(shape);\n  return containsUrl(props.shape)\n    ? props.shape.split('/').pop()?.replace('.svg', '') ?? ''\n    : props.shape;\n});\n\nwatch(\n  () => props.shape,\n  async (shape) => {\n    const icon: CachedIcon = await iconLoader.load(shape);\n    isSvg.value = icon.isSvg;\n    content.value = icon.content;\n  },\n  { immediate: true }\n);\n\nconst IconContent = defineComponent({\n  props: {\n    isSvg: Boolean,\n    content: String,\n    ariaRole: String,\n    cssClass: String,\n    computedStyle: Object as PropType<CSSProperties>,\n  },\n  setup(props, { attrs }) {\n    const baseAttrs = {\n      class: props.cssClass,\n      role: props.ariaRole,\n      style: props.computedStyle,\n      ...attrs,\n    };\n\n    return () =>\n      props.isSvg\n        ? h('div', {\n            innerHTML: props.content,\n            ...baseAttrs,\n          })\n        : h('img', {\n            src: props.content,\n            ...baseAttrs,\n          });\n  },\n});\n</script>\n","import script from \"./StudipIcon.vue?vue&type=script&lang=ts&setup=true\"\nexport * from \"./StudipIcon.vue?vue&type=script&lang=ts&setup=true\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { render } from \"./StudipActionMenu.vue?vue&type=template&id=5f5a7c44\"\nimport script from \"./StudipActionMenu.vue?vue&type=script&lang=js\"\nexport * from \"./StudipActionMenu.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { unref as _unref, toDisplayString as _toDisplayString, withModifiers as _withModifiers, createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, createVNode as _createVNode, Fragment as _Fragment, renderList as _renderList, createBlock as _createBlock, vModelText as _vModelText, withDirectives as _withDirectives, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-90169508\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = [\"data-post-type\"]\nconst _hoisted_2 = { class: \"travis-go-post-heading\" }\nconst _hoisted_3 = /*#__PURE__*/_createTextVNode(\" [\")\nconst _hoisted_4 = { class: \"video-timestamp\" }\nconst _hoisted_5 = { key: 0 }\nconst _hoisted_6 = /*#__PURE__*/_createTextVNode(\"  \")\nconst _hoisted_7 = { class: \"post-type\" }\nconst _hoisted_8 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"span\", null, null, -1))\nconst _hoisted_9 = /*#__PURE__*/_createTextVNode(\"] \")\nconst _hoisted_10 = { class: \"travis-go-post-contents-container\" }\nconst _hoisted_11 = [\"innerHTML\"]\nconst _hoisted_12 = {\n  key: 0,\n  class: \"travis-go-comments\"\n}\nconst _hoisted_13 = { class: \"collapsable collapsed\" }\nconst _hoisted_14 = { class: \"travis-go-comments-list\" }\nconst _hoisted_15 = [\"onClick\"]\nconst _hoisted_16 = [\"placeholder\"]\nconst _hoisted_17 = [\"disabled\"]\n\nimport {\n  computed,\n  PropType,\n  ref,\n  nextTick,\n} from 'vue';\nimport {\n  CreateCommentRequest,\n  TravisGoComment,\n  travisGoCommentSchema,\n  TravisGoPost,\n  UpdateCommentRequest,\n} from '@/models/InteractiveVideoTask';\nimport { formatVideoTimestamp } from '@/components/interactiveVideo/formatVideoTimestamp';\nimport { store } from '@/store';\nimport DOMPurify from 'dompurify';\nimport { User } from '@/php-integration';\nimport StudipActionMenu from '@/components/studip/StudipActionMenu.vue';\nimport { LinkAction } from '@/components/studip/interfaces';\nimport { $gettext, $ngettext, $gettextInterpolate } from '@/language/gettext';\n\nexport default /*#__PURE__*/_defineComponent({\n  props: {\n  post: {\n    type: Object as PropType<TravisGoPost>,\n    required: true,\n  },\n  comments: {\n    type: Object as PropType<TravisGoComment[]>,\n    required: true,\n  },\n},\n  emits: {\n  clickTimestamp(payload: number) {\n    return true;\n  },\n  startEditingPost(post: TravisGoPost) {\n    return true;\n  },\n  deletePost(postId: string) {\n    return true;\n  },\n  deleteComment(id: string) {\n    return true;\n  },\n  clickPostAuthorName(post: TravisGoPost) {\n    return true;\n  },\n  clickCommentAuthorName(comment: TravisGoComment) {\n    return true;\n  },\n},\n  setup(__props, { emit }) {\n\nconst props = __props\n\n\n\nconst contentsPurified = computed(() =>\n  DOMPurify.sanitize(props.post?.attributes.contents, {\n    USE_PROFILES: { html: true },\n  })\n);\n\nfunction userById(id: string): User | undefined {\n  return store.getters['users/byId']({ id });\n}\nconst postAuthor = computed<User | undefined>(() =>\n  userById(props.post?.attributes.mk_user_id)\n);\nconst postAuthorFormattedName = computed<string | undefined>(\n  () => postAuthor.value?.attributes?.['formatted-name']\n);\n\nfunction userUrl(user: User | undefined): string {\n  const username = user?.attributes?.['username'];\n  if (username) {\n    return window.STUDIP.URLHelper.getURL('dispatch.php/profile', { username });\n  } else {\n    return '';\n  }\n}\n\nconst postAuthorUrl = computed<string>(() => {\n  return userUrl(postAuthor.value);\n});\n\nfunction commentAuthorName(comment: TravisGoComment): string {\n  return (\n    userById(comment.attributes.mk_user_id)?.attributes['formatted-name'] ??\n    $gettext('Unbekannt')\n  );\n}\n\nconst commentEditorInput = ref<string>('');\nconst commentEditorInputElement = ref<HTMLInputElement | undefined>();\nconst isCommenting = ref(false);\nfunction startCommentingPost() {\n  isCommenting.value = true;\n  nextTick(() => {\n    const inputEl = commentEditorInputElement.value as HTMLElement;\n    // If the input is inside of a collapsed <fieldset>, then the <fieldset>\n    // should be un-collapsed so that the user can see the input field.\n    const collapsedParents = [\n      ...document.querySelectorAll('fieldset.collapsable.collapsed'),\n    ].filter((element) => element.contains(inputEl));\n    collapsedParents.forEach((parent) => parent.classList.remove('collapsed'));\n    inputEl.focus();\n  });\n}\nasync function submitComment() {\n  try {\n    await createComment({\n      attributes: {\n        post_id: props.post.attributes.id,\n        contents: commentEditorInput.value,\n      },\n    });\n    commentEditorInput.value = '';\n  } catch (error: unknown) {\n    window.STUDIP.Report.error(\n      $gettext('Dein Kommentar konnte nicht abgeschickt werden.'),\n      [JSON.stringify(error, null, 2)]\n    );\n    console.error(error);\n  }\n}\nasync function createComment(post: CreateCommentRequest) {\n  return await store.dispatch(\n    'lernmodule-plugin/travis-go-comments/create',\n    post\n  );\n}\n\nconst editedCommentId = ref<string | undefined>();\nconst isEditingComment = computed<boolean>(\n  () => editedCommentId.value !== undefined\n);\nfunction startEditingComment(comment: TravisGoComment) {\n  editedCommentId.value = comment.attributes.id;\n  commentEditorInput.value = comment.attributes.contents;\n  commentEditorInputElement.value!.focus();\n}\nfunction cancelEditingComment() {\n  editedCommentId.value = undefined;\n  commentEditorInput.value = '';\n}\nasync function submitEditedComment() {\n  try {\n    if (!editedCommentId.value) {\n      throw new Error(\n        $gettext('Das bearbeitete Comment ID ist undefined oder leer.')\n      );\n    }\n    await updateComment({\n      id: editedCommentId.value,\n      attributes: {\n        contents: commentEditorInput.value,\n      },\n    });\n    editedCommentId.value = undefined;\n    commentEditorInput.value = '';\n  } catch (error: unknown) {\n    window.STUDIP.Report.error(\n      $gettext('Dein Kommentar konnte nicht abgeschickt werden.'),\n      [JSON.stringify(error, null, 2)]\n    );\n    console.error(error);\n  }\n}\n\nasync function updateComment(comment: UpdateCommentRequest) {\n  return await store.dispatch(\n    'lernmodule-plugin/travis-go-comments/update',\n    comment\n  );\n}\n\nfunction postActionMenuItems(): LinkAction[] {\n  const deletePostAction = {\n    action_id: '1',\n    label: $gettext('Lschen'),\n    icon: 'trash',\n    emit: 'deletePost',\n  };\n  const startEditingPostAction = {\n    action_id: '2',\n    label: $gettext('Bearbeiten'),\n    icon: 'edit',\n    emit: 'startEditingPost',\n  };\n  return [\n    ...(props.post.meta.permissions.mayDelete ? [deletePostAction] : []),\n    ...(props.post.meta.permissions.mayEdit ? [startEditingPostAction] : []),\n    {\n      action_id: '3',\n      label: $gettext('Kommentieren'),\n      icon: 'comment',\n      emit: 'startCommentingPost',\n    },\n    {\n      action_id: '3',\n      type: 'link',\n      label: $gettext('Nutzerprofil ffnen'),\n      icon: 'share',\n      url: postAuthorUrl.value,\n    },\n  ];\n}\n\nfunction commentActionMenuItems(comment: TravisGoComment): LinkAction[] {\n  const deleteAction = {\n    action_id: '1',\n    label: $gettext('Lschen'),\n    icon: 'trash',\n    emit: 'deleteComment',\n  };\n  const startEditingAction = {\n    action_id: '2',\n    label: $gettext('Bearbeiten'),\n    icon: 'edit',\n    emit: 'startEditingComment',\n  };\n  return [\n    ...(comment.meta.permissions.mayDelete ? [deleteAction] : []),\n    ...(comment.meta.permissions.mayEdit ? [startEditingAction] : []),\n    {\n      action_id: '3',\n      type: 'link',\n      label: $gettext('Nutzerprofil ffnen'),\n      icon: 'share',\n      url: userUrl(userById(comment.attributes.mk_user_id)),\n    },\n  ];\n}\nfunction deletePost(id: string) {\n  emit('deletePost', id);\n}\nfunction startEditingPost(post: TravisGoPost) {\n  emit('startEditingPost', post);\n}\nfunction deleteComment(id: string) {\n  emit('deleteComment', id);\n}\n\nfunction onClickTimestamp(time: number) {\n  emit('clickTimestamp', time);\n}\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(\"div\", {\n    class: \"travis-go-post\",\n    \"data-post-type\": __props.post.attributes.post_type\n  }, [\n    _createElementVNode(\"h4\", _hoisted_2, [\n      _hoisted_3,\n      _createElementVNode(\"span\", _hoisted_4, [\n        _createElementVNode(\"a\", {\n          href: \"#\",\n          onClick: _cache[0] || (_cache[0] = _withModifiers(($event: any) => (onClickTimestamp(__props.post.attributes.start_time)), [\"prevent\"]))\n        }, _toDisplayString(_unref(formatVideoTimestamp)(__props.post.attributes.start_time, false, ':')), 1),\n        (__props.post.attributes.end_time)\n          ? (_openBlock(), _createElementBlock(\"span\", _hoisted_5, [\n              _hoisted_6,\n              _createElementVNode(\"a\", {\n                href: \"#\",\n                onClick: _cache[1] || (_cache[1] = _withModifiers(($event: any) => (onClickTimestamp(__props.post.attributes.end_time)), [\"prevent\"]))\n              }, _toDisplayString(_unref(formatVideoTimestamp)(__props.post.attributes.end_time, false, ':')), 1)\n            ]))\n          : _createCommentVNode(\"\", true)\n      ]),\n      _createElementVNode(\"span\", _hoisted_7, _toDisplayString(__props.post.attributes.post_type), 1),\n      _hoisted_8,\n      _createElementVNode(\"a\", {\n        href: \"#\",\n        onClick: _cache[2] || (_cache[2] = _withModifiers(($event: any) => (_ctx.$emit('clickPostAuthorName', __props.post)), [\"prevent\"]))\n      }, \"@\" + _toDisplayString(_unref(postAuthorFormattedName)), 1),\n      _hoisted_9,\n      _createVNode(StudipActionMenu, {\n        title: _unref($gettext)('Aktionen'),\n        items: postActionMenuItems(),\n        collapseAt: true,\n        class: \"travis-go-post-action-menu\",\n        onDeletePost: _cache[3] || (_cache[3] = ($event: any) => (deletePost(__props.post.attributes.id))),\n        onStartEditingPost: _cache[4] || (_cache[4] = ($event: any) => (startEditingPost(__props.post))),\n        onStartCommentingPost: startCommentingPost\n      }, null, 8, [\"title\", \"items\"])\n    ]),\n    _createElementVNode(\"div\", _hoisted_10, [\n      _createElementVNode(\"p\", {\n        class: \"travis-go-post-contents\",\n        innerHTML: _unref(contentsPurified)\n      }, null, 8, _hoisted_11),\n      (isCommenting.value || __props.comments.length > 0)\n        ? (_openBlock(), _createElementBlock(\"section\", _hoisted_12, [\n            _createElementVNode(\"form\", {\n              class: \"default\",\n              onSubmit: _cache[7] || (_cache[7] = _withModifiers(() => {}, [\"prevent\"]))\n            }, [\n              _createElementVNode(\"fieldset\", _hoisted_13, [\n                _createElementVNode(\"legend\", null, [\n                  (__props.comments.length > 0)\n                    ? (_openBlock(), _createElementBlock(_Fragment, { key: 0 }, [\n                        _createTextVNode(_toDisplayString(_unref($gettextInterpolate)(\n                    _unref($ngettext)(\n                      '%{ numberOfComments } Kommentar',\n                      '%{ numberOfComments } Kommentare',\n                      __props.comments.length\n                    ),\n                    { numberOfComments: __props.comments.length }\n                  )), 1)\n                      ], 64))\n                    : (_openBlock(), _createElementBlock(_Fragment, { key: 1 }, [\n                        _createTextVNode(_toDisplayString(_unref($gettext)('Kommentieren')), 1)\n                      ], 64))\n                ]),\n                _createElementVNode(\"div\", _hoisted_14, [\n                  (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(__props.comments, (comment) => {\n                    return (_openBlock(), _createElementBlock(\"p\", {\n                      class: \"travis-go-comment\",\n                      key: comment.attributes.id\n                    }, [\n                      _createElementVNode(\"a\", {\n                        class: \"travis-go-comment-author\",\n                        href: \"#\",\n                        onClick: _withModifiers(($event: any) => (_ctx.$emit('clickCommentAuthorName', comment)), [\"prevent\"])\n                      }, \"@\" + _toDisplayString(commentAuthorName(comment)), 9, _hoisted_15),\n                      _createTextVNode(\" \" + _toDisplayString(comment.attributes.contents) + \" \", 1),\n                      (commentActionMenuItems(comment).length > 0)\n                        ? (_openBlock(), _createBlock(StudipActionMenu, {\n                            key: 0,\n                            title: _unref($gettext)('Aktionen'),\n                            items: commentActionMenuItems(comment),\n                            collapseAt: true,\n                            class: \"travis-go-comment-action-menu\",\n                            onDeleteComment: ($event: any) => (deleteComment(comment.attributes.id)),\n                            onStartEditingComment: ($event: any) => (startEditingComment(comment))\n                          }, null, 8, [\"title\", \"items\", \"onDeleteComment\", \"onStartEditingComment\"]))\n                        : _createCommentVNode(\"\", true)\n                    ]))\n                  }), 128))\n                ]),\n                _createElementVNode(\"div\", null, [\n                  _createElementVNode(\"form\", {\n                    class: \"comment-editor\",\n                    onSubmit: _cache[6] || (_cache[6] = _withModifiers(($event: any) => (\n                  _unref(isEditingComment) ? submitEditedComment() : submitComment()\n                ), [\"prevent\"]))\n                  }, [\n                    _withDirectives(_createElementVNode(\"input\", {\n                      type: \"text\",\n                      placeholder: _unref($gettext)('Schreibe einen Kommentar...'),\n                      \"onUpdate:modelValue\": _cache[5] || (_cache[5] = ($event: any) => ((commentEditorInput).value = $event)),\n                      ref_key: \"commentEditorInputElement\",\n                      ref: commentEditorInputElement\n                    }, null, 8, _hoisted_16), [\n                      [_vModelText, commentEditorInput.value]\n                    ]),\n                    (_unref(isEditingComment))\n                      ? (_openBlock(), _createElementBlock(\"button\", {\n                          key: 0,\n                          type: \"button\",\n                          class: \"button cancel cancel-editing-comment-button\",\n                          onClick: cancelEditingComment\n                        }, _toDisplayString(_unref($gettext)('Zurcksetzen')), 1))\n                      : _createCommentVNode(\"\", true),\n                    _createElementVNode(\"button\", {\n                      class: \"button accept send-comment-button\",\n                      type: \"submit\",\n                      disabled: commentEditorInput.value.trim().length === 0\n                    }, _toDisplayString(_unref(isEditingComment)\n                      ? _unref($gettext)('Aktualisieren')\n                      : _unref($gettext)('Abschicken')), 9, _hoisted_17)\n                  ], 32)\n                ])\n              ])\n            ], 32)\n          ]))\n        : _createCommentVNode(\"\", true)\n    ])\n  ], 8, _hoisted_1))\n}\n}\n\n})","<template>\n  <div class=\"travis-go-post\" :data-post-type=\"post.attributes.post_type\">\n    <h4 class=\"travis-go-post-heading\">\n      [<span class=\"video-timestamp\"\n        ><a\n          href=\"#\"\n          @click.prevent=\"onClickTimestamp(post.attributes.start_time)\"\n          >{{ formatVideoTimestamp(post.attributes.start_time, false, ':') }}</a\n        >\n        <span v-if=\"post.attributes.end_time\">\n          \n          <a\n            href=\"#\"\n            @click.prevent=\"onClickTimestamp(post.attributes.end_time)\"\n          >\n            {{ formatVideoTimestamp(post.attributes.end_time, false, ':') }}\n          </a></span\n        ></span\n      >\n      <span class=\"post-type\">{{ post.attributes.post_type }}</span>\n      <span> </span>\n      <a href=\"#\" @click.prevent=\"$emit('clickPostAuthorName', post)\"\n        >@{{ postAuthorFormattedName }}</a\n      >]\n      <StudipActionMenu\n        :title=\"$gettext('Aktionen')\"\n        :items=\"postActionMenuItems()\"\n        :collapseAt=\"true\"\n        class=\"travis-go-post-action-menu\"\n        @deletePost=\"deletePost(post.attributes.id)\"\n        @startEditingPost=\"startEditingPost(post)\"\n        @startCommentingPost=\"startCommentingPost\"\n      />\n    </h4>\n    <div class=\"travis-go-post-contents-container\">\n      <p class=\"travis-go-post-contents\" v-html=\"contentsPurified\"></p>\n      <section\n        class=\"travis-go-comments\"\n        v-if=\"isCommenting || comments.length > 0\"\n      >\n        <form class=\"default\" @submit.prevent>\n          <fieldset class=\"collapsable collapsed\">\n            <legend>\n              <template v-if=\"comments.length > 0\">\n                {{\n                  $gettextInterpolate(\n                    $ngettext(\n                      '%{ numberOfComments } Kommentar',\n                      '%{ numberOfComments } Kommentare',\n                      comments.length\n                    ),\n                    { numberOfComments: comments.length }\n                  )\n                }}\n              </template>\n              <template v-else>{{ $gettext('Kommentieren') }}</template>\n            </legend>\n            <div class=\"travis-go-comments-list\">\n              <p\n                class=\"travis-go-comment\"\n                v-for=\"comment in comments\"\n                :key=\"comment.attributes.id\"\n              >\n                <a\n                  class=\"travis-go-comment-author\"\n                  href=\"#\"\n                  @click.prevent=\"$emit('clickCommentAuthorName', comment)\"\n                  >@{{ commentAuthorName(comment) }}</a\n                >\n                {{ comment.attributes.contents }}\n                <StudipActionMenu\n                  v-if=\"commentActionMenuItems(comment).length > 0\"\n                  :title=\"$gettext('Aktionen')\"\n                  :items=\"commentActionMenuItems(comment)\"\n                  :collapseAt=\"true\"\n                  class=\"travis-go-comment-action-menu\"\n                  @deleteComment=\"deleteComment(comment.attributes.id)\"\n                  @startEditingComment=\"startEditingComment(comment)\"\n                />\n              </p>\n            </div>\n            <!--  Wrapped in a div so the form will be hidden when the enclosing\n                  fieldset is collapsed - otherwise the css rule display: flex\n                  will override the fieldset's rule '> * { display: none }' -->\n            <div>\n              <form\n                class=\"comment-editor\"\n                @submit.prevent=\"\n                  isEditingComment ? submitEditedComment() : submitComment()\n                \"\n              >\n                <input\n                  type=\"text\"\n                  :placeholder=\"$gettext('Schreibe einen Kommentar...')\"\n                  v-model=\"commentEditorInput\"\n                  ref=\"commentEditorInputElement\"\n                />\n                <button\n                  v-if=\"isEditingComment\"\n                  type=\"button\"\n                  class=\"button cancel cancel-editing-comment-button\"\n                  @click=\"cancelEditingComment\"\n                >\n                  {{ $gettext('Zurcksetzen') }}\n                </button>\n                <button\n                  class=\"button accept send-comment-button\"\n                  type=\"submit\"\n                  :disabled=\"commentEditorInput.trim().length === 0\"\n                >\n                  {{\n                    isEditingComment\n                      ? $gettext('Aktualisieren')\n                      : $gettext('Abschicken')\n                  }}\n                </button>\n              </form>\n            </div>\n          </fieldset>\n        </form>\n      </section>\n    </div>\n  </div>\n</template>\n<style scoped lang=\"scss\">\n.travis-go-post {\n  display: grid;\n  grid-template-columns: min-content 1fr;\n  grid-template-rows: min-content 1fr;\n  grid-template-areas:\n    'icon heading'\n    '.    contents';\n  grid-column-gap: 5px;\n  grid-row-gap: 0.45em;\n  align-items: start;\n  &::before {\n    grid-area: icon;\n  }\n  .travis-go-post-heading {\n    grid-area: heading;\n    margin-top: 0;\n    margin-bottom: 0;\n  }\n  .travis-go-post-contents-container {\n    grid-area: contents;\n    form.default {\n      fieldset {\n        padding: 0;\n        margin: 0;\n        border: none;\n      }\n      legend {\n        background-color: unset;\n        border: none;\n        padding-left: 0;\n        padding-top: 0;\n        padding-bottom: 0;\n        margin-bottom: 0.5em;\n        margin-left: -5px;\n        font-size: unset;\n      }\n    }\n    .travis-go-comments-list {\n      border-left: 3px solid #899ab9;\n      padding: 0 10px 0 26px;\n      margin-top: 0.5em;\n      margin-bottom: 10px;\n\n      .travis-go-comment {\n        .travis-go-comment-author {\n          font-weight: 700;\n        }\n        /* We use opacity, not visibility or display: none, so the buttons can\n           be accessed via tab */\n        .travis-go-comment-action-menu {\n          opacity: 0;\n        }\n        &:hover,\n        &:focus-within {\n          .travis-go-comment-action-menu {\n            opacity: 1;\n          }\n        }\n      }\n    }\n    .comment-editor {\n      display: flex;\n      gap: 10px;\n      button.send-comment-button,\n      button.cancel-editing-comment-button {\n        margin: 0;\n        min-width: fit-content;\n      }\n    }\n  }\n  .travis-go-post-contents {\n    margin-bottom: 0;\n  }\n  .video-timestamp,\n  .post-type {\n    margin-right: 0.25em;\n  }\n  margin: 0;\n  padding: 5px;\n}\n</style>\n<style lang=\"scss\">\n/* Prevent large images from messing up the page layout. */\n.travis-go-post-contents {\n  overflow: hidden;\n  img {\n    object-fit: contain;\n    width: auto;\n    max-height: 20vh;\n  }\n}\n</style>\n\n<script setup lang=\"ts\">\nimport {\n  computed,\n  defineProps,\n  defineEmits,\n  PropType,\n  ref,\n  nextTick,\n} from 'vue';\nimport {\n  CreateCommentRequest,\n  TravisGoComment,\n  travisGoCommentSchema,\n  TravisGoPost,\n  UpdateCommentRequest,\n} from '@/models/InteractiveVideoTask';\nimport { formatVideoTimestamp } from '@/components/interactiveVideo/formatVideoTimestamp';\nimport { store } from '@/store';\nimport DOMPurify from 'dompurify';\nimport { User } from '@/php-integration';\nimport StudipActionMenu from '@/components/studip/StudipActionMenu.vue';\nimport { LinkAction } from '@/components/studip/interfaces';\nimport { $gettext, $ngettext, $gettextInterpolate } from '@/language/gettext';\nconst props = defineProps({\n  post: {\n    type: Object as PropType<TravisGoPost>,\n    required: true,\n  },\n  comments: {\n    type: Object as PropType<TravisGoComment[]>,\n    required: true,\n  },\n});\nconst emit = defineEmits({\n  clickTimestamp(payload: number) {\n    return true;\n  },\n  startEditingPost(post: TravisGoPost) {\n    return true;\n  },\n  deletePost(postId: string) {\n    return true;\n  },\n  deleteComment(id: string) {\n    return true;\n  },\n  clickPostAuthorName(post: TravisGoPost) {\n    return true;\n  },\n  clickCommentAuthorName(comment: TravisGoComment) {\n    return true;\n  },\n});\nconst contentsPurified = computed(() =>\n  DOMPurify.sanitize(props.post?.attributes.contents, {\n    USE_PROFILES: { html: true },\n  })\n);\n\nfunction userById(id: string): User | undefined {\n  return store.getters['users/byId']({ id });\n}\nconst postAuthor = computed<User | undefined>(() =>\n  userById(props.post?.attributes.mk_user_id)\n);\nconst postAuthorFormattedName = computed<string | undefined>(\n  () => postAuthor.value?.attributes?.['formatted-name']\n);\n\nfunction userUrl(user: User | undefined): string {\n  const username = user?.attributes?.['username'];\n  if (username) {\n    return window.STUDIP.URLHelper.getURL('dispatch.php/profile', { username });\n  } else {\n    return '';\n  }\n}\n\nconst postAuthorUrl = computed<string>(() => {\n  return userUrl(postAuthor.value);\n});\n\nfunction commentAuthorName(comment: TravisGoComment): string {\n  return (\n    userById(comment.attributes.mk_user_id)?.attributes['formatted-name'] ??\n    $gettext('Unbekannt')\n  );\n}\n\nconst commentEditorInput = ref<string>('');\nconst commentEditorInputElement = ref<HTMLInputElement | undefined>();\nconst isCommenting = ref(false);\nfunction startCommentingPost() {\n  isCommenting.value = true;\n  nextTick(() => {\n    const inputEl = commentEditorInputElement.value as HTMLElement;\n    // If the input is inside of a collapsed <fieldset>, then the <fieldset>\n    // should be un-collapsed so that the user can see the input field.\n    const collapsedParents = [\n      ...document.querySelectorAll('fieldset.collapsable.collapsed'),\n    ].filter((element) => element.contains(inputEl));\n    collapsedParents.forEach((parent) => parent.classList.remove('collapsed'));\n    inputEl.focus();\n  });\n}\nasync function submitComment() {\n  try {\n    await createComment({\n      attributes: {\n        post_id: props.post.attributes.id,\n        contents: commentEditorInput.value,\n      },\n    });\n    commentEditorInput.value = '';\n  } catch (error: unknown) {\n    window.STUDIP.Report.error(\n      $gettext('Dein Kommentar konnte nicht abgeschickt werden.'),\n      [JSON.stringify(error, null, 2)]\n    );\n    console.error(error);\n  }\n}\nasync function createComment(post: CreateCommentRequest) {\n  return await store.dispatch(\n    'lernmodule-plugin/travis-go-comments/create',\n    post\n  );\n}\n\nconst editedCommentId = ref<string | undefined>();\nconst isEditingComment = computed<boolean>(\n  () => editedCommentId.value !== undefined\n);\nfunction startEditingComment(comment: TravisGoComment) {\n  editedCommentId.value = comment.attributes.id;\n  commentEditorInput.value = comment.attributes.contents;\n  commentEditorInputElement.value!.focus();\n}\nfunction cancelEditingComment() {\n  editedCommentId.value = undefined;\n  commentEditorInput.value = '';\n}\nasync function submitEditedComment() {\n  try {\n    if (!editedCommentId.value) {\n      throw new Error(\n        $gettext('Das bearbeitete Comment ID ist undefined oder leer.')\n      );\n    }\n    await updateComment({\n      id: editedCommentId.value,\n      attributes: {\n        contents: commentEditorInput.value,\n      },\n    });\n    editedCommentId.value = undefined;\n    commentEditorInput.value = '';\n  } catch (error: unknown) {\n    window.STUDIP.Report.error(\n      $gettext('Dein Kommentar konnte nicht abgeschickt werden.'),\n      [JSON.stringify(error, null, 2)]\n    );\n    console.error(error);\n  }\n}\n\nasync function updateComment(comment: UpdateCommentRequest) {\n  return await store.dispatch(\n    'lernmodule-plugin/travis-go-comments/update',\n    comment\n  );\n}\n\nfunction postActionMenuItems(): LinkAction[] {\n  const deletePostAction = {\n    action_id: '1',\n    label: $gettext('Lschen'),\n    icon: 'trash',\n    emit: 'deletePost',\n  };\n  const startEditingPostAction = {\n    action_id: '2',\n    label: $gettext('Bearbeiten'),\n    icon: 'edit',\n    emit: 'startEditingPost',\n  };\n  return [\n    ...(props.post.meta.permissions.mayDelete ? [deletePostAction] : []),\n    ...(props.post.meta.permissions.mayEdit ? [startEditingPostAction] : []),\n    {\n      action_id: '3',\n      label: $gettext('Kommentieren'),\n      icon: 'comment',\n      emit: 'startCommentingPost',\n    },\n    {\n      action_id: '3',\n      type: 'link',\n      label: $gettext('Nutzerprofil ffnen'),\n      icon: 'share',\n      url: postAuthorUrl.value,\n    },\n  ];\n}\n\nfunction commentActionMenuItems(comment: TravisGoComment): LinkAction[] {\n  const deleteAction = {\n    action_id: '1',\n    label: $gettext('Lschen'),\n    icon: 'trash',\n    emit: 'deleteComment',\n  };\n  const startEditingAction = {\n    action_id: '2',\n    label: $gettext('Bearbeiten'),\n    icon: 'edit',\n    emit: 'startEditingComment',\n  };\n  return [\n    ...(comment.meta.permissions.mayDelete ? [deleteAction] : []),\n    ...(comment.meta.permissions.mayEdit ? [startEditingAction] : []),\n    {\n      action_id: '3',\n      type: 'link',\n      label: $gettext('Nutzerprofil ffnen'),\n      icon: 'share',\n      url: userUrl(userById(comment.attributes.mk_user_id)),\n    },\n  ];\n}\nfunction deletePost(id: string) {\n  emit('deletePost', id);\n}\nfunction startEditingPost(post: TravisGoPost) {\n  emit('startEditingPost', post);\n}\nfunction deleteComment(id: string) {\n  emit('deleteComment', id);\n}\n\nfunction onClickTimestamp(time: number) {\n  emit('clickTimestamp', time);\n}\n</script>\n","import script from \"./TravisGoPost.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./TravisGoPost.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./TravisGoPost.vue?vue&type=style&index=0&id=90169508&scoped=true&lang=scss\"\nimport \"./TravisGoPost.vue?vue&type=style&index=1&id=90169508&lang=scss\"\n\nimport exportComponent from \"../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-90169508\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { createVNode as _createVNode, unref as _unref, toDisplayString as _toDisplayString, withModifiers as _withModifiers, createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, vModelSelect as _vModelSelect, withDirectives as _withDirectives, createBlock as _createBlock, renderList as _renderList, vModelText as _vModelText, normalizeClass as _normalizeClass, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-23982f67\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = {\n  key: 0,\n  class: \"travis-go-main\"\n}\nconst _hoisted_2 = { class: \"travis-go-left-column\" }\nconst _hoisted_3 = { class: \"annotation-controls\" }\nconst _hoisted_4 = [\"onClick\"]\nconst _hoisted_5 = [\"onClick\"]\nconst _hoisted_6 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"option\", { value: \"meta\" }, \"Meta\", -1))\nconst _hoisted_7 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"option\", { value: \"image\" }, \"Image\", -1))\nconst _hoisted_8 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"option\", { value: \"audio\" }, \"Audio\", -1))\nconst _hoisted_9 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"option\", { value: \"text\" }, \"Text\", -1))\nconst _hoisted_10 = [\n  _hoisted_6,\n  _hoisted_7,\n  _hoisted_8,\n  _hoisted_9\n]\nconst _hoisted_11 = [\"disabled\"]\nconst _hoisted_12 = { class: \"travis-go-participants-list\" }\nconst _hoisted_13 = [\"href\"]\nconst _hoisted_14 = { class: \"travis-go-right-column\" }\nconst _hoisted_15 = { class: \"search-bar\" }\nconst _hoisted_16 = [\"placeholder\"]\nconst _hoisted_17 = [\"title\"]\nconst _hoisted_18 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"button\", { class: \"button h5p-search\" }, null, -1))\nconst _hoisted_19 = { class: \"project-title-and-description\" }\nconst _hoisted_20 = { class: \"travis-go-posts\" }\nconst _hoisted_21 = {\n  key: 0,\n  style: {\"white-space\":\"pre-wrap\"}\n}\n\nimport {\n  computed,\n  nextTick,\n  onMounted,\n  PropType,\n  ref,\n  watch,\n} from 'vue';\nimport {\n  CreatePostRequest,\n  InteractiveVideoTask,\n  TravisGoComment,\n  travisGoCommentSchema,\n  TravisGoPost,\n  travisGoPostSchema,\n  TravisGoPostType,\n  UpdatePostRequest,\n} from '@/models/InteractiveVideoTask';\nimport VideoPlayer from '@/components/interactiveVideo/VideoPlayer.vue';\nimport StudipWysiwyg from '@/components/StudipWysiwyg.vue';\nimport TravisGoPostComponent from '@/components/interactiveVideo/viewer/TravisGoPost.vue';\nimport { store, taskEditorStore } from '@/store';\nimport ErrorMessage from '@/components/ErrorMessage.vue';\nimport { SafeParseError } from 'zod';\nimport strings from '@/components/interactiveVideo/strings';\nimport { User } from '@/php-integration';\nimport { formatVideoTimestamp } from '@/components/interactiveVideo/formatVideoTimestamp';\nimport { $gettext } from '@/language/gettext';\n\ntype ParsedPosts = [TravisGoPost[], SafeParseError<TravisGoPost>[]];\n\nexport default /*#__PURE__*/_defineComponent({\n  props: {\n  task: {\n    type: Object as PropType<InteractiveVideoTask>,\n    required: true,\n  },\n},\n  setup(__props) {\n\nconst props = __props\n\n\n\nconst debug = window.STUDIP.LernmoduleVueJS.LERNMODULE_DEBUG;\n\nconst videoPlayer = ref<InstanceType<typeof VideoPlayer> | undefined>(\n  undefined\n);\n\nfunction onClickPostTimestamp(time: number) {\n  seekVideo(time);\n}\n\nfunction searchUserComments(userId: string) {\n  const user = getUserById(userId);\n  if (!user) {\n    throw new Error('User not found by id ' + userId);\n  }\n  searchInput.value = '@' + user.attributes.username;\n}\nfunction searchPostAuthor(post: TravisGoPost) {\n  searchUserComments(post.attributes.mk_user_id);\n}\nfunction searchCommentAuthor(comment: TravisGoComment) {\n  searchUserComments(comment.attributes.mk_user_id);\n}\nasync function deleteComment(id: string) {\n  const prompt = $gettext('Kommentar lschen');\n  const confirmed = window.confirm(prompt);\n  if (!confirmed) {\n    console.info('Delete prompt canceled by user');\n    return;\n  }\n  try {\n    await store.dispatch('lernmodule-plugin/travis-go-comments/delete', {\n      id,\n    });\n    window.STUDIP.Report.success($gettext('Der Kommentar wurde gelscht.'));\n  } catch (error: unknown) {\n    window.STUDIP.Report.error(\n      $gettext('Der Kommentar konnte nicht gelscht werden.'),\n      [JSON.stringify(error, null, 2)]\n    );\n    console.error(error);\n  }\n}\n\nconst editedPostId = ref<string | undefined>();\nfunction startEditingPost(post: TravisGoPost): void {\n  if (\n    postWysiwygInput.value !== '' ||\n    startTimeInput.value !== undefined ||\n    endTimeInput.value !== undefined\n  ) {\n    const confirmed = confirm(\n      $gettext('Die Inhalte des Post-Editors werden gelscht.')\n    );\n    if (!confirmed) {\n      return;\n    }\n  }\n  editedPostId.value = post.attributes.id;\n  postWysiwygInput.value = post.attributes.contents;\n  postTypeInput.value = post.attributes.post_type;\n  startTimeInput.value = post.attributes.start_time;\n  endTimeInput.value = post.attributes.end_time ?? undefined;\n  // Focus the wysiwyg text area.\n  nextTick(() => {\n    // Use nextTick to allow for the editor contents to be updated.\n    const wysiwygEl = postWysiwygInputElement.value!.$el;\n    const editor = window.STUDIP.wysiwyg.getEditor(wysiwygEl);\n    editor!.editing!.view.focus();\n    // Put the cursor at the end.\n    editor!.model.change((writer) => {\n      writer.setSelection(\n        writer.createPositionAt(editor!.model.document.getRoot()!, 'end')\n      );\n    });\n  });\n}\n\nfunction resetPostEditor() {\n  if (\n    postWysiwygInput.value !== '' ||\n    startTimeInput.value !== undefined ||\n    endTimeInput.value !== undefined\n  ) {\n    const confirmed = confirm(\n      $gettext('Die Inhalte des Post-Editors werden gelscht.')\n    );\n    if (!confirmed) {\n      return;\n    }\n  }\n  editedPostId.value = undefined;\n  postWysiwygInput.value = '';\n  postTypeInput.value = 'text';\n  startTimeInput.value = undefined;\n  endTimeInput.value = undefined;\n}\n\nasync function deletePost(id: string) {\n  const prompt = $gettext('Post lschen');\n  const confirmed = window.confirm(prompt);\n  if (!confirmed) {\n    console.info('Delete prompt canceled by user');\n    return;\n  }\n  try {\n    await store.dispatch('lernmodule-plugin/travis-go-posts/delete', {\n      id,\n    });\n    window.STUDIP.Report.success($gettext('Der Post wurde gelscht.'));\n  } catch (error: unknown) {\n    window.STUDIP.Report.error(\n      $gettext('Der Post konnte nicht gelscht werden.'),\n      [JSON.stringify(error, null, 2)]\n    );\n    console.error(error);\n  }\n}\n\nfunction seekVideo(time: number) {\n  videoPlayer.value!.player!.currentTime(time);\n}\n\nconst currentTime = ref(0);\nfunction onTimeUpdate(time: number) {\n  currentTime.value = time;\n}\n\nconst startTimeInput = ref<number | undefined>();\nfunction onClickStartTime() {\n  if (startTimeInput.value) {\n    seekVideo(startTimeInput.value);\n  } else {\n    startTimeInput.value = currentTime.value;\n  }\n}\nfunction clearStartTime() {\n  startTimeInput.value = undefined;\n}\n\nconst endTimeInput = ref<number | undefined>();\nfunction onClickEndTime() {\n  if (endTimeInput.value) {\n    seekVideo(endTimeInput.value);\n  } else {\n    endTimeInput.value = currentTime.value;\n  }\n}\nfunction clearEndTime() {\n  endTimeInput.value = undefined;\n}\n\nfunction loadCurrentUser() {\n  store.dispatch('users/loadById', { id: window.STUDIP.USER_ID });\n}\n\nconst loadPostsError = ref<string | undefined>();\nfunction loadPosts() {\n  if (!taskEditorStore.taskSaveLocation) {\n    throw new Error('taskEditorStore.taskSaveLocation is missing.');\n  }\n  const x = store\n    .dispatch('lernmodule-plugin/travis-go-posts/loadWhere', {\n      filter: {\n        video_id: taskEditorStore.taskSaveLocation.id,\n        video_type: taskEditorStore.taskSaveLocation.type,\n      },\n      options: {\n        include: 'user,comments,comments.user',\n        'fields[users]': 'formatted-name,username',\n      },\n    })\n    .then((result) => console.log('result of travis-go-posts/loadAll', result))\n    .catch((error) => {\n      loadPostsError.value = error;\n      console.error('error', error);\n    });\n  /* eslint-disable-next-line no-debugger */\n  // debugger;\n}\nconst rawPosts = computed<unknown[]>(\n  () => store.getters['lernmodule-plugin/travis-go-posts/all']\n);\nconst postParseResults = computed<ParsedPosts>(() => {\n  const errors: SafeParseError<TravisGoPost>[] = [];\n  const successes: TravisGoPost[] = [];\n  for (let rawVal of rawPosts.value) {\n    const parsed = travisGoPostSchema.safeParse(rawVal);\n    if (parsed.success) {\n      successes.push(parsed.data);\n    } else {\n      errors.push(parsed);\n    }\n  }\n  return [successes, errors];\n});\nconst parsedPosts = computed<TravisGoPost[]>(() => postParseResults.value[0]);\nconst erroredPosts = computed<SafeParseError<TravisGoPost>[]>(\n  () => postParseResults.value[1]\n);\n\n// Posts that match the search entered by the user\nconst filteredAndSortedPosts = computed<TravisGoPost[]>(() => {\n  return parsedPosts.value\n    .filter((post) => postMatchesSearch(post, searchInput.value))\n    .toSorted((a, b) => a.attributes.start_time - b.attributes.start_time);\n});\n\n// True iff post matches the given search query string\nfunction postMatchesSearch(post: TravisGoPost, query: string): boolean {\n  if (!query) {\n    return true;\n  } else {\n    const author = getUserById(post.attributes.mk_user_id);\n    const texts = [\n      post.attributes.contents,\n      post.attributes.post_type,\n      author?.attributes.username ?? '',\n      author?.attributes['formatted-name'] ?? '',\n    ];\n    const canonicalQuery = canonicalize(query);\n    const comments = commentsForPost(post);\n    return (\n      texts.some((text) => canonicalize(text).includes(canonicalQuery)) ||\n      comments.some((comment) => commentMatchesSearch(comment, canonicalQuery))\n    );\n  }\n}\nfunction commentMatchesSearch(\n  comment: TravisGoComment,\n  canonicalQuery: string\n): boolean {\n  const author = getUserById(comment.attributes.mk_user_id);\n  const texts = [\n    comment.attributes.contents,\n    author?.attributes.username ?? '',\n    author?.attributes['formatted-name'] ?? '',\n  ];\n  return texts.some((text) => canonicalize(text).includes(canonicalQuery));\n}\n\nfunction canonicalize(str: string): string {\n  return str\n    .toLowerCase()\n    .replaceAll(/[.,/#!$%^&@*;:{}=\\-_`~()]/g, '')\n    .trim();\n}\n\nconst parsedComments = computed<TravisGoComment[]>(() => {\n  return store.getters['lernmodule-plugin/travis-go-comments/all'].flatMap(\n    (record: unknown) => {\n      const parsedComment = travisGoCommentSchema.safeParse(record);\n      if (parsedComment.success) {\n        return parsedComment.data;\n      } else {\n        return [];\n      }\n    }\n  );\n});\nconst erroredComments = computed<unknown[]>(() => {\n  return store.getters['lernmodule-plugin/travis-go-comments/all'].flatMap(\n    (record: unknown) => {\n      const parsedComment = travisGoCommentSchema.safeParse(record);\n      if (!parsedComment.success) {\n        return { record, error: parsedComment.error };\n      } else {\n        return [];\n      }\n    }\n  );\n});\nwatch(\n  () => erroredComments.value,\n  () => {\n    if (erroredComments.value.length === 0) {\n      return;\n    }\n    console.error(`${erroredComments.value} Comment(s) could not be loaded`);\n    console.error(erroredComments.value);\n  }\n);\n\nfunction commentsForPost(post: TravisGoPost): TravisGoComment[] {\n  return parsedComments.value.filter(\n    (comment) => comment.attributes.post_id === post.attributes.id\n  );\n}\n\nconst participantsIds = computed<string[]>(() => {\n  const postUserIds = parsedPosts.value.map((post) => {\n    return post.attributes.mk_user_id;\n  });\n  const commentUserIds = parsedComments.value\n    .filter((comment) =>\n      parsedPosts.value.some(\n        (post) => post.attributes.id === comment.attributes.post_id\n      )\n    )\n    .map((comment) => comment.attributes.mk_user_id);\n  // Use Set to remove duplicates\n  return [...new Set(postUserIds.concat(commentUserIds))];\n});\n\nfunction urlForUserId(id: string): string {\n  const user = getUserById(id);\n  if (user) {\n    return window.STUDIP.URLHelper.getURL('dispatch.php/profile', {\n      username: user.attributes.username,\n    });\n  } else {\n    return '';\n  }\n}\nfunction getUserById(id: string): User | undefined {\n  return store.getters['users/byId']({ id });\n}\n\nonMounted(() => {\n  loadPosts();\n  loadCurrentUser();\n});\n\nconst searchInput = ref<string>('');\nconst postWysiwygInput = ref<string>('');\nconst postWysiwygInputElement = ref<\n  InstanceType<typeof StudipWysiwyg> | undefined\n>();\nconst postTypeInput = ref<TravisGoPostType>('text');\nconst createPostError = ref<string | undefined>();\nfunction cancelSearch() {\n  searchInput.value = '';\n}\n\nasync function createPost(post: { attributes: CreatePostRequest }) {\n  return await store.dispatch('lernmodule-plugin/travis-go-posts/create', post);\n}\nasync function updatePost(post: UpdatePostRequest) {\n  return await store.dispatch('lernmodule-plugin/travis-go-posts/update', post);\n}\nfunction submitNewPost() {\n  console.log('submitNewPost');\n  if (!props.task) {\n    throw new Error('task not provided');\n  }\n  if (!taskEditorStore.taskSaveLocation) {\n    throw new Error('taskEditorStore.taskSaveLocation is missing.');\n  }\n  const res = createPost({\n    attributes: {\n      contents: postWysiwygInput.value,\n      post_type: postTypeInput.value,\n      start_time: startTimeInput.value ?? 0,\n      end_time: endTimeInput.value ?? null,\n      video_id: taskEditorStore.taskSaveLocation.id,\n      video_type: taskEditorStore.taskSaveLocation.type,\n    },\n  })\n    .then((result) => {\n      console.log('result of create post', result);\n      postWysiwygInput.value = '';\n      startTimeInput.value = undefined;\n      endTimeInput.value = undefined;\n      createPostError.value = undefined;\n    })\n    .catch((error) => {\n      console.error('error', error);\n      createPostError.value = error;\n      window.STUDIP.Report.error(\n        $gettext('Der Post konnte nicht gepostet werden.'),\n        [JSON.stringify(error, null, 2)]\n      );\n    });\n  return res;\n}\n\nfunction submitEditedPost() {\n  console.log('submitNewPost');\n  if (!props.task) {\n    throw new Error('task not provided');\n  }\n  if (!taskEditorStore.taskSaveLocation) {\n    throw new Error('taskEditorStore.taskSaveLocation is missing.');\n  }\n  if (editedPostId.value === undefined) {\n    throw new Error('editedPostId is undefined');\n  }\n  const res = updatePost({\n    id: editedPostId.value,\n    attributes: {\n      contents: postWysiwygInput.value,\n      post_type: postTypeInput.value,\n      start_time: startTimeInput.value ?? 0,\n      end_time: endTimeInput.value ?? null,\n    },\n  })\n    .then((result) => {\n      console.log('result of update post', result);\n      editedPostId.value = undefined;\n      postWysiwygInput.value = '';\n      startTimeInput.value = undefined;\n      endTimeInput.value = undefined;\n      createPostError.value = undefined;\n    })\n    .catch((error) => {\n      console.error('error', error);\n      createPostError.value = error;\n      window.STUDIP.Report.error(\n        $gettext('Der Post konnte nicht geupdated werden.'),\n        [JSON.stringify(error, null, 2)]\n      );\n    });\n  return res;\n}\n\nreturn (_ctx: any,_cache: any) => {\n  return (__props.task.travisGoSettings.enabled)\n    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n        _createElementVNode(\"div\", _hoisted_2, [\n          _createVNode(VideoPlayer, {\n            onTimeupdate: onTimeUpdate,\n            task: __props.task,\n            ref_key: \"videoPlayer\",\n            ref: videoPlayer\n          }, null, 8, [\"task\"]),\n          _createElementVNode(\"div\", _hoisted_3, [\n            _createElementVNode(\"button\", {\n              class: \"button date time-input\",\n              onClick: onClickStartTime\n            }, [\n              (startTimeInput.value)\n                ? (_openBlock(), _createElementBlock(_Fragment, { key: 0 }, [\n                    _createTextVNode(_toDisplayString(_unref(formatVideoTimestamp)(startTimeInput.value, false, ':')) + \" \", 1),\n                    _createElementVNode(\"button\", {\n                      class: \"small-button cancel\",\n                      onClick: _withModifiers(clearStartTime, [\"stop\"])\n                    }, null, 8, _hoisted_4)\n                  ], 64))\n                : (_openBlock(), _createElementBlock(_Fragment, { key: 1 }, [\n                    _createTextVNode(_toDisplayString(_unref($gettext)('Start')), 1)\n                  ], 64))\n            ]),\n            _createElementVNode(\"button\", {\n              class: \"button date time-input\",\n              onClick: onClickEndTime\n            }, [\n              (endTimeInput.value)\n                ? (_openBlock(), _createElementBlock(_Fragment, { key: 0 }, [\n                    _createTextVNode(_toDisplayString(_unref(formatVideoTimestamp)(endTimeInput.value, false, ':')) + \" \", 1),\n                    _createElementVNode(\"button\", {\n                      class: \"small-button cancel\",\n                      onClick: _withModifiers(clearEndTime, [\"stop\"])\n                    }, null, 8, _hoisted_5)\n                  ], 64))\n                : (_openBlock(), _createElementBlock(_Fragment, { key: 1 }, [\n                    _createTextVNode(_toDisplayString(_unref($gettext)('End')), 1)\n                  ], 64))\n            ]),\n            _withDirectives(_createElementVNode(\"select\", {\n              class: \"post-type-input\",\n              \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((postTypeInput).value = $event))\n            }, _hoisted_10, 512), [\n              [_vModelSelect, postTypeInput.value]\n            ])\n          ]),\n          _createVNode(StudipWysiwyg, {\n            insertHtmlComment: \"\",\n            modelValue: postWysiwygInput.value,\n            \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event: any) => ((postWysiwygInput).value = $event)),\n            ref_key: \"postWysiwygInputElement\",\n            ref: postWysiwygInputElement\n          }, null, 8, [\"modelValue\"]),\n          (editedPostId.value !== undefined)\n            ? (_openBlock(), _createElementBlock(\"button\", {\n                key: 0,\n                onClick: resetPostEditor,\n                type: \"button\",\n                class: \"button\"\n              }, _toDisplayString(_unref($gettext)('Zurcksetzen')), 1))\n            : _createCommentVNode(\"\", true),\n          _createElementVNode(\"button\", {\n            onClick: _cache[2] || (_cache[2] = ($event: any) => (\n          editedPostId.value !== undefined ? submitEditedPost() : submitNewPost()\n        )),\n            class: \"button\",\n            disabled: postWysiwygInput.value.trim().length === 0\n          }, _toDisplayString(editedPostId.value !== undefined\n            ? _unref($gettext)('Post updaten')\n            : _unref($gettext)('Post abschicken')), 9, _hoisted_11),\n          (createPostError.value)\n            ? (_openBlock(), _createBlock(ErrorMessage, {\n                key: 1,\n                style: {\"max-height\":\"unset\"},\n                error: \n          _unref(debug)\n            ? `${_unref(strings).couldNotSendPostError} Error: ${JSON.stringify(\n                createPostError.value,\n                null,\n                2\n              )}`\n            : _unref(strings).couldNotSendPostError\n        \n              }, null, 8, [\"error\"]))\n            : _createCommentVNode(\"\", true),\n          _createElementVNode(\"div\", _hoisted_12, [\n            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(participantsIds), (id) => {\n              return (_openBlock(), _createElementBlock(\"a\", {\n                key: id,\n                href: urlForUserId(id)\n              }, _toDisplayString(getUserById(id)?.attributes['formatted-name']), 9, _hoisted_13))\n            }), 128))\n          ])\n        ]),\n        _createElementVNode(\"div\", _hoisted_14, [\n          _createElementVNode(\"nav\", _hoisted_15, [\n            _withDirectives(_createElementVNode(\"input\", {\n              type: \"text\",\n              role: \"searchbox\",\n              placeholder: _unref($gettext)('Suche'),\n              \"onUpdate:modelValue\": _cache[3] || (_cache[3] = ($event: any) => ((searchInput).value = $event))\n            }, null, 8, _hoisted_16), [\n              [_vModelText, searchInput.value]\n            ]),\n            (searchInput.value !== '')\n              ? (_openBlock(), _createElementBlock(\"button\", {\n                  key: 0,\n                  class: \"button h5p-search cancel\",\n                  title: _unref($gettext)('Suche zurcksetzen'),\n                  onClick: cancelSearch\n                }, null, 8, _hoisted_17))\n              : _createCommentVNode(\"\", true),\n            _hoisted_18\n          ]),\n          _createElementVNode(\"section\", _hoisted_19, [\n            _createElementVNode(\"h3\", null, _toDisplayString(_unref($gettext)('Projekttitel')), 1),\n            _createElementVNode(\"p\", null, _toDisplayString(__props.task.travisGoSettings.projectTitle), 1),\n            _createElementVNode(\"h3\", null, _toDisplayString(_unref($gettext)('Projektbeschreibung')), 1),\n            _createElementVNode(\"p\", null, _toDisplayString(__props.task.travisGoSettings.projectDescription), 1)\n          ]),\n          _createElementVNode(\"section\", _hoisted_20, [\n            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(filteredAndSortedPosts), (post, index) => {\n              return (_openBlock(), _createBlock(TravisGoPostComponent, {\n                key: post.attributes.id,\n                post: post,\n                comments: commentsForPost(post),\n                onClickTimestamp: onClickPostTimestamp,\n                onStartEditingPost: startEditingPost,\n                onDeletePost: deletePost,\n                onDeleteComment: deleteComment,\n                onClickPostAuthorName: searchPostAuthor,\n                onClickCommentAuthorName: searchCommentAuthor,\n                class: _normalizeClass({\n              odd: index % 2 === 0,\n            })\n              }, null, 8, [\"post\", \"comments\", \"class\"]))\n            }), 128)),\n            (false && _unref(debug))\n              ? (_openBlock(), _createElementBlock(\"pre\", _hoisted_21, \"          \" + _toDisplayString({ rawPosts: _unref(rawPosts) }) + \"\\n        \", 1))\n              : _createCommentVNode(\"\", true)\n          ]),\n          (loadPostsError.value)\n            ? (_openBlock(), _createBlock(ErrorMessage, {\n                key: 0,\n                error: \n          _unref(debug)\n            ? `${_unref(strings).couldNotLoadPostsError} Error: ${JSON.stringify(\n                loadPostsError.value,\n                null,\n                2\n              )}`\n            : _unref(strings).couldNotLoadPostsError\n        \n              }, null, 8, [\"error\"]))\n            : _createCommentVNode(\"\", true),\n          (_unref(erroredPosts).length > 0)\n            ? (_openBlock(), _createBlock(ErrorMessage, {\n                key: 1,\n                error: `${_unref(erroredPosts).length} post(s) could not be loaded`\n              }, null, 8, [\"error\"]))\n            : _createCommentVNode(\"\", true),\n          (_unref(erroredComments).length > 0)\n            ? (_openBlock(), _createBlock(ErrorMessage, {\n                key: 2,\n                error: `${_unref(erroredComments).length} comment(s) could not be loaded`\n              }, null, 8, [\"error\"]))\n            : _createCommentVNode(\"\", true)\n        ])\n      ]))\n    : (_openBlock(), _createBlock(VideoPlayer, {\n        key: 1,\n        onTimeupdate: onTimeUpdate,\n        task: __props.task,\n        ref_key: \"videoPlayer\",\n        ref: videoPlayer\n      }, null, 8, [\"task\"]))\n}\n}\n\n})","<script setup lang=\"ts\">\nimport {\n  computed,\n  defineProps,\n  nextTick,\n  onMounted,\n  PropType,\n  ref,\n  watch,\n} from 'vue';\nimport {\n  CreatePostRequest,\n  InteractiveVideoTask,\n  TravisGoComment,\n  travisGoCommentSchema,\n  TravisGoPost,\n  travisGoPostSchema,\n  TravisGoPostType,\n  UpdatePostRequest,\n} from '@/models/InteractiveVideoTask';\nimport VideoPlayer from '@/components/interactiveVideo/VideoPlayer.vue';\nimport StudipWysiwyg from '@/components/StudipWysiwyg.vue';\nimport TravisGoPostComponent from '@/components/interactiveVideo/viewer/TravisGoPost.vue';\nimport { store, taskEditorStore } from '@/store';\nimport ErrorMessage from '@/components/ErrorMessage.vue';\nimport { SafeParseError } from 'zod';\nimport strings from '@/components/interactiveVideo/strings';\nimport { User } from '@/php-integration';\nimport { formatVideoTimestamp } from '@/components/interactiveVideo/formatVideoTimestamp';\nimport { $gettext } from '@/language/gettext';\n\nconst props = defineProps({\n  task: {\n    type: Object as PropType<InteractiveVideoTask>,\n    required: true,\n  },\n});\n\nconst debug = window.STUDIP.LernmoduleVueJS.LERNMODULE_DEBUG;\n\nconst videoPlayer = ref<InstanceType<typeof VideoPlayer> | undefined>(\n  undefined\n);\n\nfunction onClickPostTimestamp(time: number) {\n  seekVideo(time);\n}\n\nfunction searchUserComments(userId: string) {\n  const user = getUserById(userId);\n  if (!user) {\n    throw new Error('User not found by id ' + userId);\n  }\n  searchInput.value = '@' + user.attributes.username;\n}\nfunction searchPostAuthor(post: TravisGoPost) {\n  searchUserComments(post.attributes.mk_user_id);\n}\nfunction searchCommentAuthor(comment: TravisGoComment) {\n  searchUserComments(comment.attributes.mk_user_id);\n}\nasync function deleteComment(id: string) {\n  const prompt = $gettext('Kommentar lschen');\n  const confirmed = window.confirm(prompt);\n  if (!confirmed) {\n    console.info('Delete prompt canceled by user');\n    return;\n  }\n  try {\n    await store.dispatch('lernmodule-plugin/travis-go-comments/delete', {\n      id,\n    });\n    window.STUDIP.Report.success($gettext('Der Kommentar wurde gelscht.'));\n  } catch (error: unknown) {\n    window.STUDIP.Report.error(\n      $gettext('Der Kommentar konnte nicht gelscht werden.'),\n      [JSON.stringify(error, null, 2)]\n    );\n    console.error(error);\n  }\n}\n\nconst editedPostId = ref<string | undefined>();\nfunction startEditingPost(post: TravisGoPost): void {\n  if (\n    postWysiwygInput.value !== '' ||\n    startTimeInput.value !== undefined ||\n    endTimeInput.value !== undefined\n  ) {\n    const confirmed = confirm(\n      $gettext('Die Inhalte des Post-Editors werden gelscht.')\n    );\n    if (!confirmed) {\n      return;\n    }\n  }\n  editedPostId.value = post.attributes.id;\n  postWysiwygInput.value = post.attributes.contents;\n  postTypeInput.value = post.attributes.post_type;\n  startTimeInput.value = post.attributes.start_time;\n  endTimeInput.value = post.attributes.end_time ?? undefined;\n  // Focus the wysiwyg text area.\n  nextTick(() => {\n    // Use nextTick to allow for the editor contents to be updated.\n    const wysiwygEl = postWysiwygInputElement.value!.$el;\n    const editor = window.STUDIP.wysiwyg.getEditor(wysiwygEl);\n    editor!.editing!.view.focus();\n    // Put the cursor at the end.\n    editor!.model.change((writer) => {\n      writer.setSelection(\n        writer.createPositionAt(editor!.model.document.getRoot()!, 'end')\n      );\n    });\n  });\n}\n\nfunction resetPostEditor() {\n  if (\n    postWysiwygInput.value !== '' ||\n    startTimeInput.value !== undefined ||\n    endTimeInput.value !== undefined\n  ) {\n    const confirmed = confirm(\n      $gettext('Die Inhalte des Post-Editors werden gelscht.')\n    );\n    if (!confirmed) {\n      return;\n    }\n  }\n  editedPostId.value = undefined;\n  postWysiwygInput.value = '';\n  postTypeInput.value = 'text';\n  startTimeInput.value = undefined;\n  endTimeInput.value = undefined;\n}\n\nasync function deletePost(id: string) {\n  const prompt = $gettext('Post lschen');\n  const confirmed = window.confirm(prompt);\n  if (!confirmed) {\n    console.info('Delete prompt canceled by user');\n    return;\n  }\n  try {\n    await store.dispatch('lernmodule-plugin/travis-go-posts/delete', {\n      id,\n    });\n    window.STUDIP.Report.success($gettext('Der Post wurde gelscht.'));\n  } catch (error: unknown) {\n    window.STUDIP.Report.error(\n      $gettext('Der Post konnte nicht gelscht werden.'),\n      [JSON.stringify(error, null, 2)]\n    );\n    console.error(error);\n  }\n}\n\nfunction seekVideo(time: number) {\n  videoPlayer.value!.player!.currentTime(time);\n}\n\nconst currentTime = ref(0);\nfunction onTimeUpdate(time: number) {\n  currentTime.value = time;\n}\n\nconst startTimeInput = ref<number | undefined>();\nfunction onClickStartTime() {\n  if (startTimeInput.value) {\n    seekVideo(startTimeInput.value);\n  } else {\n    startTimeInput.value = currentTime.value;\n  }\n}\nfunction clearStartTime() {\n  startTimeInput.value = undefined;\n}\n\nconst endTimeInput = ref<number | undefined>();\nfunction onClickEndTime() {\n  if (endTimeInput.value) {\n    seekVideo(endTimeInput.value);\n  } else {\n    endTimeInput.value = currentTime.value;\n  }\n}\nfunction clearEndTime() {\n  endTimeInput.value = undefined;\n}\n\nfunction loadCurrentUser() {\n  store.dispatch('users/loadById', { id: window.STUDIP.USER_ID });\n}\n\nconst loadPostsError = ref<string | undefined>();\nfunction loadPosts() {\n  if (!taskEditorStore.taskSaveLocation) {\n    throw new Error('taskEditorStore.taskSaveLocation is missing.');\n  }\n  const x = store\n    .dispatch('lernmodule-plugin/travis-go-posts/loadWhere', {\n      filter: {\n        video_id: taskEditorStore.taskSaveLocation.id,\n        video_type: taskEditorStore.taskSaveLocation.type,\n      },\n      options: {\n        include: 'user,comments,comments.user',\n        'fields[users]': 'formatted-name,username',\n      },\n    })\n    .then((result) => console.log('result of travis-go-posts/loadAll', result))\n    .catch((error) => {\n      loadPostsError.value = error;\n      console.error('error', error);\n    });\n  /* eslint-disable-next-line no-debugger */\n  // debugger;\n}\nconst rawPosts = computed<unknown[]>(\n  () => store.getters['lernmodule-plugin/travis-go-posts/all']\n);\ntype ParsedPosts = [TravisGoPost[], SafeParseError<TravisGoPost>[]];\nconst postParseResults = computed<ParsedPosts>(() => {\n  const errors: SafeParseError<TravisGoPost>[] = [];\n  const successes: TravisGoPost[] = [];\n  for (let rawVal of rawPosts.value) {\n    const parsed = travisGoPostSchema.safeParse(rawVal);\n    if (parsed.success) {\n      successes.push(parsed.data);\n    } else {\n      errors.push(parsed);\n    }\n  }\n  return [successes, errors];\n});\nconst parsedPosts = computed<TravisGoPost[]>(() => postParseResults.value[0]);\nconst erroredPosts = computed<SafeParseError<TravisGoPost>[]>(\n  () => postParseResults.value[1]\n);\n\n// Posts that match the search entered by the user\nconst filteredAndSortedPosts = computed<TravisGoPost[]>(() => {\n  return parsedPosts.value\n    .filter((post) => postMatchesSearch(post, searchInput.value))\n    .toSorted((a, b) => a.attributes.start_time - b.attributes.start_time);\n});\n\n// True iff post matches the given search query string\nfunction postMatchesSearch(post: TravisGoPost, query: string): boolean {\n  if (!query) {\n    return true;\n  } else {\n    const author = getUserById(post.attributes.mk_user_id);\n    const texts = [\n      post.attributes.contents,\n      post.attributes.post_type,\n      author?.attributes.username ?? '',\n      author?.attributes['formatted-name'] ?? '',\n    ];\n    const canonicalQuery = canonicalize(query);\n    const comments = commentsForPost(post);\n    return (\n      texts.some((text) => canonicalize(text).includes(canonicalQuery)) ||\n      comments.some((comment) => commentMatchesSearch(comment, canonicalQuery))\n    );\n  }\n}\nfunction commentMatchesSearch(\n  comment: TravisGoComment,\n  canonicalQuery: string\n): boolean {\n  const author = getUserById(comment.attributes.mk_user_id);\n  const texts = [\n    comment.attributes.contents,\n    author?.attributes.username ?? '',\n    author?.attributes['formatted-name'] ?? '',\n  ];\n  return texts.some((text) => canonicalize(text).includes(canonicalQuery));\n}\n\nfunction canonicalize(str: string): string {\n  return str\n    .toLowerCase()\n    .replaceAll(/[.,/#!$%^&@*;:{}=\\-_`~()]/g, '')\n    .trim();\n}\n\nconst parsedComments = computed<TravisGoComment[]>(() => {\n  return store.getters['lernmodule-plugin/travis-go-comments/all'].flatMap(\n    (record: unknown) => {\n      const parsedComment = travisGoCommentSchema.safeParse(record);\n      if (parsedComment.success) {\n        return parsedComment.data;\n      } else {\n        return [];\n      }\n    }\n  );\n});\nconst erroredComments = computed<unknown[]>(() => {\n  return store.getters['lernmodule-plugin/travis-go-comments/all'].flatMap(\n    (record: unknown) => {\n      const parsedComment = travisGoCommentSchema.safeParse(record);\n      if (!parsedComment.success) {\n        return { record, error: parsedComment.error };\n      } else {\n        return [];\n      }\n    }\n  );\n});\nwatch(\n  () => erroredComments.value,\n  () => {\n    if (erroredComments.value.length === 0) {\n      return;\n    }\n    console.error(`${erroredComments.value} Comment(s) could not be loaded`);\n    console.error(erroredComments.value);\n  }\n);\n\nfunction commentsForPost(post: TravisGoPost): TravisGoComment[] {\n  return parsedComments.value.filter(\n    (comment) => comment.attributes.post_id === post.attributes.id\n  );\n}\n\nconst participantsIds = computed<string[]>(() => {\n  const postUserIds = parsedPosts.value.map((post) => {\n    return post.attributes.mk_user_id;\n  });\n  const commentUserIds = parsedComments.value\n    .filter((comment) =>\n      parsedPosts.value.some(\n        (post) => post.attributes.id === comment.attributes.post_id\n      )\n    )\n    .map((comment) => comment.attributes.mk_user_id);\n  // Use Set to remove duplicates\n  return [...new Set(postUserIds.concat(commentUserIds))];\n});\n\nfunction urlForUserId(id: string): string {\n  const user = getUserById(id);\n  if (user) {\n    return window.STUDIP.URLHelper.getURL('dispatch.php/profile', {\n      username: user.attributes.username,\n    });\n  } else {\n    return '';\n  }\n}\nfunction getUserById(id: string): User | undefined {\n  return store.getters['users/byId']({ id });\n}\n\nonMounted(() => {\n  loadPosts();\n  loadCurrentUser();\n});\n\nconst searchInput = ref<string>('');\nconst postWysiwygInput = ref<string>('');\nconst postWysiwygInputElement = ref<\n  InstanceType<typeof StudipWysiwyg> | undefined\n>();\nconst postTypeInput = ref<TravisGoPostType>('text');\nconst createPostError = ref<string | undefined>();\nfunction cancelSearch() {\n  searchInput.value = '';\n}\n\nasync function createPost(post: { attributes: CreatePostRequest }) {\n  return await store.dispatch('lernmodule-plugin/travis-go-posts/create', post);\n}\nasync function updatePost(post: UpdatePostRequest) {\n  return await store.dispatch('lernmodule-plugin/travis-go-posts/update', post);\n}\nfunction submitNewPost() {\n  console.log('submitNewPost');\n  if (!props.task) {\n    throw new Error('task not provided');\n  }\n  if (!taskEditorStore.taskSaveLocation) {\n    throw new Error('taskEditorStore.taskSaveLocation is missing.');\n  }\n  const res = createPost({\n    attributes: {\n      contents: postWysiwygInput.value,\n      post_type: postTypeInput.value,\n      start_time: startTimeInput.value ?? 0,\n      end_time: endTimeInput.value ?? null,\n      video_id: taskEditorStore.taskSaveLocation.id,\n      video_type: taskEditorStore.taskSaveLocation.type,\n    },\n  })\n    .then((result) => {\n      console.log('result of create post', result);\n      postWysiwygInput.value = '';\n      startTimeInput.value = undefined;\n      endTimeInput.value = undefined;\n      createPostError.value = undefined;\n    })\n    .catch((error) => {\n      console.error('error', error);\n      createPostError.value = error;\n      window.STUDIP.Report.error(\n        $gettext('Der Post konnte nicht gepostet werden.'),\n        [JSON.stringify(error, null, 2)]\n      );\n    });\n  return res;\n}\n\nfunction submitEditedPost() {\n  console.log('submitNewPost');\n  if (!props.task) {\n    throw new Error('task not provided');\n  }\n  if (!taskEditorStore.taskSaveLocation) {\n    throw new Error('taskEditorStore.taskSaveLocation is missing.');\n  }\n  if (editedPostId.value === undefined) {\n    throw new Error('editedPostId is undefined');\n  }\n  const res = updatePost({\n    id: editedPostId.value,\n    attributes: {\n      contents: postWysiwygInput.value,\n      post_type: postTypeInput.value,\n      start_time: startTimeInput.value ?? 0,\n      end_time: endTimeInput.value ?? null,\n    },\n  })\n    .then((result) => {\n      console.log('result of update post', result);\n      editedPostId.value = undefined;\n      postWysiwygInput.value = '';\n      startTimeInput.value = undefined;\n      endTimeInput.value = undefined;\n      createPostError.value = undefined;\n    })\n    .catch((error) => {\n      console.error('error', error);\n      createPostError.value = error;\n      window.STUDIP.Report.error(\n        $gettext('Der Post konnte nicht geupdated werden.'),\n        [JSON.stringify(error, null, 2)]\n      );\n    });\n  return res;\n}\n</script>\n\n<template>\n  <div v-if=\"task.travisGoSettings.enabled\" class=\"travis-go-main\">\n    <div class=\"travis-go-left-column\">\n      <VideoPlayer @timeupdate=\"onTimeUpdate\" :task=\"task\" ref=\"videoPlayer\" />\n      <div class=\"annotation-controls\">\n        <button class=\"button date time-input\" @click=\"onClickStartTime\">\n          <template v-if=\"startTimeInput\">\n            {{ formatVideoTimestamp(startTimeInput, false, ':') }}\n            <button class=\"small-button cancel\" @click.stop=\"clearStartTime\" />\n          </template>\n          <template v-else>\n            {{ $gettext('Start') }}\n          </template>\n        </button>\n        <button class=\"button date time-input\" @click=\"onClickEndTime\">\n          <template v-if=\"endTimeInput\">\n            {{ formatVideoTimestamp(endTimeInput, false, ':') }}\n            <button class=\"small-button cancel\" @click.stop=\"clearEndTime\" />\n          </template>\n          <template v-else>\n            {{ $gettext('End') }}\n          </template>\n        </button>\n        <select class=\"post-type-input\" v-model=\"postTypeInput\">\n          <option value=\"meta\">Meta</option>\n          <option value=\"image\">Image</option>\n          <option value=\"audio\">Audio</option>\n          <option value=\"text\">Text</option>\n        </select>\n      </div>\n      <StudipWysiwyg\n        insertHtmlComment\n        v-model=\"postWysiwygInput\"\n        ref=\"postWysiwygInputElement\"\n      />\n      <button\n        v-if=\"editedPostId !== undefined\"\n        @click=\"resetPostEditor\"\n        type=\"button\"\n        class=\"button\"\n      >\n        {{ $gettext('Zurcksetzen') }}\n      </button>\n      <button\n        @click=\"\n          editedPostId !== undefined ? submitEditedPost() : submitNewPost()\n        \"\n        class=\"button\"\n        :disabled=\"postWysiwygInput.trim().length === 0\"\n      >\n        {{\n          editedPostId !== undefined\n            ? $gettext('Post updaten')\n            : $gettext('Post abschicken')\n        }}\n      </button>\n      <ErrorMessage\n        style=\"max-height: unset\"\n        :error=\"\n          debug\n            ? `${strings.couldNotSendPostError} Error: ${JSON.stringify(\n                createPostError,\n                null,\n                2\n              )}`\n            : strings.couldNotSendPostError\n        \"\n        v-if=\"createPostError\"\n      />\n      <div class=\"travis-go-participants-list\">\n        <a v-for=\"id in participantsIds\" :key=\"id\" :href=\"urlForUserId(id)\">\n          {{ getUserById(id)?.attributes['formatted-name'] }}\n        </a>\n      </div>\n    </div>\n    <div class=\"travis-go-right-column\">\n      <nav class=\"search-bar\">\n        <input\n          type=\"text\"\n          role=\"searchbox\"\n          :placeholder=\"$gettext('Suche')\"\n          v-model=\"searchInput\"\n        />\n        <button\n          v-if=\"searchInput !== ''\"\n          class=\"button h5p-search cancel\"\n          :title=\"$gettext('Suche zurcksetzen')\"\n          @click=\"cancelSearch\"\n        ></button>\n        <button class=\"button h5p-search\" />\n      </nav>\n      <section class=\"project-title-and-description\">\n        <h3>{{ $gettext('Projekttitel') }}</h3>\n        <p>\n          {{ task.travisGoSettings.projectTitle }}\n        </p>\n        <h3>{{ $gettext('Projektbeschreibung') }}</h3>\n        <p>\n          {{ task.travisGoSettings.projectDescription }}\n        </p>\n      </section>\n      <section class=\"travis-go-posts\">\n        <template\n          v-for=\"(post, index) in filteredAndSortedPosts\"\n          :key=\"post.attributes.id\"\n        >\n          <TravisGoPostComponent\n            :post=\"post\"\n            :comments=\"commentsForPost(post)\"\n            @clickTimestamp=\"onClickPostTimestamp\"\n            @startEditingPost=\"startEditingPost\"\n            @deletePost=\"deletePost\"\n            @deleteComment=\"deleteComment\"\n            @clickPostAuthorName=\"searchPostAuthor\"\n            @clickCommentAuthorName=\"searchCommentAuthor\"\n            :class=\"{\n              odd: index % 2 === 0,\n            }\"\n          />\n        </template>\n        <pre style=\"white-space: pre-wrap\" v-if=\"false && debug\">\n          {{ { rawPosts } }}\n        </pre>\n      </section>\n      <ErrorMessage\n        v-if=\"loadPostsError\"\n        :error=\"\n          debug\n            ? `${strings.couldNotLoadPostsError} Error: ${JSON.stringify(\n                loadPostsError,\n                null,\n                2\n              )}`\n            : strings.couldNotLoadPostsError\n        \"\n      />\n      <ErrorMessage\n        v-if=\"erroredPosts.length > 0\"\n        :error=\"`${erroredPosts.length} post(s) could not be loaded`\"\n      ></ErrorMessage>\n      <ErrorMessage\n        v-if=\"erroredComments.length > 0\"\n        :error=\"`${erroredComments.length} comment(s) could not be loaded`\"\n      ></ErrorMessage>\n    </div>\n  </div>\n  <VideoPlayer\n    v-else\n    @timeupdate=\"onTimeUpdate\"\n    :task=\"task\"\n    ref=\"videoPlayer\"\n  />\n</template>\n\n<style scoped lang=\"scss\">\n.travis-go-main {\n  h3 {\n    margin-top: 0;\n    margin-bottom: 0.45em;\n  }\n  p {\n    margin-bottom: 0.45em;\n  }\n  display: flex;\n  flex-wrap: wrap;\n\n  gap: 10px;\n  > .travis-go-left-column {\n    flex: 1;\n    min-width: calc(min(400px, 100%));\n  }\n  > .travis-go-right-column {\n    flex: 1;\n    min-width: calc(min(300px, 100%));\n  }\n\n  .annotation-controls {\n    display: flex;\n    align-items: center;\n    margin-top: 0.5em;\n    margin-bottom: 0.5em;\n    gap: 0.5em;\n    > * {\n      margin: 0;\n    }\n    button.time-input {\n      display: flex;\n      align-items: center;\n      gap: 0.5em;\n    }\n    .post-type-input {\n      align-self: stretch;\n      height: auto;\n    }\n  }\n}\n\n.travis-go-posts {\n  .travis-go-post.odd {\n    background: var(--color--gray-6);\n  }\n}\n.travis-go-participants-list {\n  background: var(--color--gray-6);\n  display: flex;\n  gap: 10px;\n  padding: 10px;\n  align-items: center;\n}\n.search-bar {\n  display: flex;\n  align-items: flex-start;\n  gap: 10px;\n  margin-bottom: 10px;\n  width: 100%;\n  input[type='text'] {\n    flex-grow: 1;\n    align-self: stretch;\n  }\n  button.h5p-search {\n    min-width: unset;\n    width: 0;\n    margin: 0;\n    padding: 5px 15px;\n  }\n}\n</style>\n","import script from \"./InteractiveVideoViewer.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./InteractiveVideoViewer.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./InteractiveVideoViewer.vue?vue&type=style&index=0&id=23982f67&scoped=true&lang=scss\"\n\nimport exportComponent from \"../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-23982f67\"]])\n\nexport default __exports__","import { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, vModelCheckbox as _vModelCheckbox, withDirectives as _withDirectives, createTextVNode as _createTextVNode, vModelText as _vModelText, normalizeClass as _normalizeClass, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nconst _hoisted_1 = { class: \"stud5p-task\" }\nconst _hoisted_2 = { class: \"default\" }\nconst _hoisted_3 = { class: \"h5pEditorTopPanel\" }\nconst _hoisted_4 = [\"data-tooltip\"]\nconst _hoisted_5 = { class: \"collapsable collapsed\" }\nconst _hoisted_6 = { class: \"collapsable collapsed\" }\nconst _hoisted_7 = [\"disabled\"]\nconst _hoisted_8 = [\"disabled\"]\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_studip_wysiwyg = _resolveComponent(\"studip-wysiwyg\")!\n  const _component_feedback_editor = _resolveComponent(\"feedback-editor\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createElementVNode(\"form\", _hoisted_2, [\n      _createElementVNode(\"fieldset\", null, [\n        _createElementVNode(\"legend\", null, _toDisplayString(_ctx.$gettext('Mark the Words')), 1),\n        _createElementVNode(\"div\", _hoisted_3, [\n          _createElementVNode(\"button\", {\n            onClick: _cache[0] || (_cache[0] = \n//@ts-ignore\n(...args) => (_ctx.addSolution && _ctx.addSolution(...args))),\n            class: \"button add-blank\",\n            type: \"button\"\n          }, _toDisplayString(_ctx.$gettext('Richtiges Wort markieren')), 1),\n          _createElementVNode(\"div\", {\n            class: \"tooltip tooltip-icon\",\n            \"data-tooltip\": _ctx.instructions\n          }, null, 8, _hoisted_4)\n        ]),\n        _createVNode(_component_studip_wysiwyg, {\n          modelValue: _ctx.modelTaskDefinition.template,\n          \"onUpdate:modelValue\": _ctx.onEditTemplate,\n          ref: \"wysiwyg\",\n          \"force-soft-breaks\": \"\",\n          \"remove-wrapping-p-tag\": \"\",\n          \"disable-autoformat\": \"\"\n        }, null, 8, [\"modelValue\", \"onUpdate:modelValue\"])\n      ]),\n      _createElementVNode(\"fieldset\", _hoisted_5, [\n        _createElementVNode(\"legend\", null, _toDisplayString(_ctx.$gettext('Einstellungen')), 1),\n        _createElementVNode(\"label\", null, [\n          _withDirectives(_createElementVNode(\"input\", {\n            \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event: any) => ((_ctx.modelTaskDefinition.retryAllowed) = $event)),\n            onChange: _cache[2] || (_cache[2] = \n//@ts-ignore\n(...args) => (_ctx.updateTaskDefinition && _ctx.updateTaskDefinition(...args))),\n            type: \"checkbox\"\n          }, null, 544), [\n            [_vModelCheckbox, _ctx.modelTaskDefinition.retryAllowed]\n          ]),\n          _createTextVNode(\" \" + _toDisplayString(_ctx.$gettext('Mehrere Versuche erlauben')), 1)\n        ]),\n        _createElementVNode(\"label\", null, [\n          _withDirectives(_createElementVNode(\"input\", {\n            \"onUpdate:modelValue\": _cache[3] || (_cache[3] = ($event: any) => ((_ctx.modelTaskDefinition.showSolutionsAllowed) = $event)),\n            onChange: _cache[4] || (_cache[4] = \n//@ts-ignore\n(...args) => (_ctx.updateTaskDefinition && _ctx.updateTaskDefinition(...args))),\n            type: \"checkbox\"\n          }, null, 544), [\n            [_vModelCheckbox, _ctx.modelTaskDefinition.showSolutionsAllowed]\n          ]),\n          _createTextVNode(\" \" + _toDisplayString(_ctx.$gettext('Lsungen anzeigen erlauben')), 1)\n        ])\n      ]),\n      _createElementVNode(\"fieldset\", _hoisted_6, [\n        _createElementVNode(\"legend\", null, _toDisplayString(_ctx.$gettext('Beschriftungen')), 1),\n        _createElementVNode(\"label\", null, [\n          _createTextVNode(_toDisplayString(_ctx.$gettext('Text fr berprfen-Button:')) + \" \", 1),\n          _withDirectives(_createElementVNode(\"input\", {\n            \"onUpdate:modelValue\": _cache[5] || (_cache[5] = ($event: any) => ((_ctx.modelTaskDefinition.strings.checkButton) = $event)),\n            onInput: _cache[6] || (_cache[6] = ($event: any) => (_ctx.updateTaskDefinition('taskDefinition.strings.checkButton'))),\n            type: \"text\"\n          }, null, 544), [\n            [_vModelText, _ctx.modelTaskDefinition.strings.checkButton]\n          ])\n        ]),\n        _createElementVNode(\"label\", {\n          class: _normalizeClass({ 'setting-disabled': !_ctx.modelTaskDefinition.retryAllowed })\n        }, [\n          _createTextVNode(_toDisplayString(_ctx.$gettext('Text fr Wiederholen-Button:')) + \" \", 1),\n          _withDirectives(_createElementVNode(\"input\", {\n            \"onUpdate:modelValue\": _cache[7] || (_cache[7] = ($event: any) => ((_ctx.modelTaskDefinition.strings.retryButton) = $event)),\n            onInput: _cache[8] || (_cache[8] = ($event: any) => (_ctx.updateTaskDefinition('taskDefinition.strings.retryButton'))),\n            disabled: !_ctx.modelTaskDefinition.retryAllowed,\n            type: \"text\"\n          }, null, 40, _hoisted_7), [\n            [_vModelText, _ctx.modelTaskDefinition.strings.retryButton]\n          ])\n        ], 2),\n        _createElementVNode(\"label\", {\n          class: _normalizeClass({\n            'setting-disabled': !_ctx.modelTaskDefinition.showSolutionsAllowed,\n          })\n        }, [\n          _createTextVNode(_toDisplayString(_ctx.$gettext('Text fr Lsungen-Button:')) + \" \", 1),\n          _withDirectives(_createElementVNode(\"input\", {\n            \"onUpdate:modelValue\": _cache[9] || (_cache[9] = ($event: any) => ((_ctx.modelTaskDefinition.strings.solutionsButton) = $event)),\n            onInput: _cache[10] || (_cache[10] = ($event: any) => (\n              _ctx.updateTaskDefinition('taskDefinition.strings.solutionsButton')\n            )),\n            disabled: !_ctx.modelTaskDefinition.showSolutionsAllowed,\n            type: \"text\"\n          }, null, 40, _hoisted_8), [\n            [_vModelText, _ctx.modelTaskDefinition.strings.solutionsButton]\n          ])\n        ], 2)\n      ]),\n      _createVNode(_component_feedback_editor, {\n        feedback: _ctx.modelTaskDefinition.feedback,\n        \"result-message\": _ctx.modelTaskDefinition.strings.resultMessage,\n        \"onUpdate:feedback\": _ctx.updateFeedback,\n        \"onUpdate:resultMessage\": _ctx.updateResultMessage\n      }, null, 8, [\"feedback\", \"result-message\", \"onUpdate:feedback\", \"onUpdate:resultMessage\"])\n    ])\n  ]))\n}","<template>\n  <div class=\"stud5p-task\">\n    <form class=\"default\">\n      <fieldset>\n        <legend>{{ $gettext('Mark the Words') }}</legend>\n\n        <div class=\"h5pEditorTopPanel\">\n          <button @click=\"addSolution\" class=\"button add-blank\" type=\"button\">\n            {{ $gettext('Richtiges Wort markieren') }}\n          </button>\n\n          <div class=\"tooltip tooltip-icon\" :data-tooltip=\"instructions\" />\n        </div>\n\n        <studip-wysiwyg\n          :modelValue=\"modelTaskDefinition.template\"\n          @update:modelValue=\"onEditTemplate\"\n          ref=\"wysiwyg\"\n          force-soft-breaks\n          remove-wrapping-p-tag\n          disable-autoformat\n        />\n      </fieldset>\n\n      <fieldset class=\"collapsable collapsed\">\n        <legend>{{ $gettext('Einstellungen') }}</legend>\n\n        <label>\n          <input\n            v-model=\"modelTaskDefinition.retryAllowed\"\n            @change=\"updateTaskDefinition\"\n            type=\"checkbox\"\n          />\n          {{ $gettext('Mehrere Versuche erlauben') }}\n        </label>\n\n        <label>\n          <input\n            v-model=\"modelTaskDefinition.showSolutionsAllowed\"\n            @change=\"updateTaskDefinition\"\n            type=\"checkbox\"\n          />\n          {{ $gettext('Lsungen anzeigen erlauben') }}\n        </label>\n      </fieldset>\n\n      <fieldset class=\"collapsable collapsed\">\n        <legend>{{ $gettext('Beschriftungen') }}</legend>\n\n        <label>\n          {{ $gettext('Text fr berprfen-Button:') }}\n          <input\n            v-model=\"modelTaskDefinition.strings.checkButton\"\n            @input=\"updateTaskDefinition('taskDefinition.strings.checkButton')\"\n            type=\"text\"\n          />\n        </label>\n\n        <label\n          :class=\"{ 'setting-disabled': !modelTaskDefinition.retryAllowed }\"\n        >\n          {{ $gettext('Text fr Wiederholen-Button:') }}\n          <input\n            v-model=\"modelTaskDefinition.strings.retryButton\"\n            @input=\"updateTaskDefinition('taskDefinition.strings.retryButton')\"\n            :disabled=\"!modelTaskDefinition.retryAllowed\"\n            type=\"text\"\n          />\n        </label>\n\n        <label\n          :class=\"{\n            'setting-disabled': !modelTaskDefinition.showSolutionsAllowed,\n          }\"\n        >\n          {{ $gettext('Text fr Lsungen-Button:') }}\n          <input\n            v-model=\"modelTaskDefinition.strings.solutionsButton\"\n            @input=\"\n              updateTaskDefinition('taskDefinition.strings.solutionsButton')\n            \"\n            :disabled=\"!modelTaskDefinition.showSolutionsAllowed\"\n            type=\"text\"\n          />\n        </label>\n      </fieldset>\n\n      <feedback-editor\n        :feedback=\"modelTaskDefinition.feedback\"\n        :result-message=\"modelTaskDefinition.strings.resultMessage\"\n        @update:feedback=\"updateFeedback\"\n        @update:result-message=\"updateResultMessage\"\n      />\n    </form>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, inject, PropType } from 'vue';\nimport { MarkTheWordsTask } from '@/models/TaskDefinition';\nimport { Feedback } from '@/models/common';\nimport { $gettext } from '@/language/gettext';\nimport StudipWysiwyg from '@/components/StudipWysiwyg.vue';\nimport FeedbackEditor from '@/components/FeedbackEditor.vue';\nimport produce from 'immer';\nimport {\n  TaskEditorState,\n  taskEditorStateSymbol,\n} from '@/components/taskEditorState';\nimport { cloneDeep } from 'lodash';\n\nexport default defineComponent({\n  name: 'MarkTheWordsEditor',\n  setup() {\n    return {\n      taskEditor: inject<TaskEditorState>(taskEditorStateSymbol),\n    };\n  },\n  components: { FeedbackEditor, StudipWysiwyg },\n  props: {\n    taskDefinition: {\n      type: Object as PropType<MarkTheWordsTask>,\n      required: true,\n    },\n  },\n  data() {\n    return {\n      modelTaskDefinition: cloneDeep(this.taskDefinition),\n    };\n  },\n  watch: {\n    // Synchronize state taskDefinition -> modelTaskDefinition.\n    taskDefinition: {\n      immediate: true,\n      handler: function (): void {\n        this.modelTaskDefinition = cloneDeep(this.taskDefinition);\n      },\n    },\n  },\n  methods: {\n    $gettext,\n\n    /**\n     * Surround the selected text with two asterisks\n     */\n    addSolution() {\n      const wysiwygEl = (this.$refs.wysiwyg as any)?.$el;\n      const editor = window.STUDIP.wysiwyg.getEditor(wysiwygEl);\n      if (!editor) {\n        console.error('getEditor(wysiwygEl) returned: ', editor);\n        throw new Error('Could not get reference to wysiwyg editor');\n      }\n      const selection = editor.model.document.selection;\n      const start = selection.getFirstPosition();\n      const end = selection.getLastPosition();\n      if (!start || !end) {\n        console.error('selection start: ', start, ' selection end: ', end);\n        throw new Error('Could not get selection in editor');\n      }\n      editor.model.change((writer) => {\n        writer.insertText('*', end);\n        writer.insertText('*', start);\n      });\n    },\n\n    urlForIcon(iconName: string) {\n      return (\n        window.STUDIP.ASSETS_URL + 'images/icons/blue/' + iconName + '.svg'\n      );\n    },\n\n    onEditTemplate(data: string): void {\n      // Copy new data from wysiwyg editor into task definition\n      this.taskEditor!.performEdit({\n        newTaskDefinition: produce(\n          this.modelTaskDefinition,\n          (draft: MarkTheWordsTask) => {\n            draft.template = data;\n          }\n        ),\n        undoBatch: 'taskDefinition.template',\n      });\n    },\n\n    updateTaskDefinition(undoBatch?: unknown) {\n      // Synchronize state modelTaskDefinition -> taskDefinition.\n      this.taskEditor!.performEdit({\n        newTaskDefinition: cloneDeep(this.modelTaskDefinition),\n        undoBatch: undoBatch ?? {},\n      });\n    },\n\n    updateFeedback(updatedFeedback: Feedback[]) {\n      this.taskEditor!.performEdit({\n        newTaskDefinition: produce(\n          this.modelTaskDefinition,\n          (taskDraft: MarkTheWordsTask) => {\n            taskDraft.feedback = updatedFeedback;\n          }\n        ),\n        undoBatch: 'taskDefinition.feedback',\n      });\n    },\n\n    updateResultMessage(updatedResultMessage: string) {\n      this.taskEditor!.performEdit({\n        newTaskDefinition: produce(\n          this.modelTaskDefinition,\n          (taskDraft: MarkTheWordsTask) => {\n            taskDraft.strings.resultMessage = updatedResultMessage;\n          }\n        ),\n        undoBatch: 'taskDefinition.strings.resultMessage',\n      });\n    },\n  },\n\n  computed: {\n    instructions(): string {\n      return $gettext(\n        'Markieren Sie ein Wort als Lsung, indem Sie ein Sternchen (*) vor und hinter dem Wort setzen oder markieren Sie ein Wort und klicken Sie den Richtiges Wort markierenButton.'\n      );\n    },\n  },\n});\n</script>\n\n<style scoped></style>\n","import { render } from \"./MarkTheWordsEditor.vue?vue&type=template&id=fc939f02&ts=true\"\nimport script from \"./MarkTheWordsEditor.vue?vue&type=script&lang=ts\"\nexport * from \"./MarkTheWordsEditor.vue?vue&type=script&lang=ts\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, normalizeClass as _normalizeClass, createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, createBlock as _createBlock, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-8fc7d02c\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"stud5p-task\" }\nconst _hoisted_2 = { class: \"mark-the-words-text\" }\nconst _hoisted_3 = [\"aria-pressed\", \"onClick\", \"onKeydown\", \"onKeyup\", \"innerHTML\"]\nconst _hoisted_4 = [\"aria-pressed\", \"onClick\", \"onKeydown\", \"onKeyup\", \"innerHTML\"]\nconst _hoisted_5 = [\"innerHTML\"]\nconst _hoisted_6 = { key: 3 }\nconst _hoisted_7 = {\n  key: 4,\n  class: \"space\"\n}\nconst _hoisted_8 = { class: \"feedback-and-button-container\" }\nconst _hoisted_9 = { class: \"button-panel\" }\nconst _hoisted_10 = [\"textContent\"]\nconst _hoisted_11 = [\"textContent\"]\nconst _hoisted_12 = [\"textContent\"]\nconst _hoisted_13 = { key: 0 }\nconst _hoisted_14 = /*#__PURE__*/_createTextVNode(\" Marked words: \")\nconst _hoisted_15 = /*#__PURE__*/_createTextVNode(\" template: \")\nconst _hoisted_16 = /*#__PURE__*/_createTextVNode(\" Split template: \")\nconst _hoisted_17 = /*#__PURE__*/_createTextVNode(\" Parsed template: \")\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_feedback_element = _resolveComponent(\"feedback-element\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createElementVNode(\"div\", _hoisted_2, [\n      (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.parsedTemplate, (element) => {\n        return (_openBlock(), _createElementBlock(_Fragment, {\n          key: element.uuid\n        }, [\n          (element.type === 'solution')\n            ? (_openBlock(), _createElementBlock(\"span\", {\n                key: 0,\n                tabindex: \"0\",\n                role: \"button\",\n                \"aria-pressed\": _ctx.isMarked(element),\n                onClick: ($event: any) => (_ctx.onClickWord(element)),\n                onKeydown: ($event: any) => (_ctx.onWordKeydown($event, element)),\n                onKeyup: ($event: any) => (_ctx.onWordKeyup($event, element)),\n                class: _normalizeClass(['no-break', _ctx.classForWord(element)]),\n                innerHTML: element.text\n              }, null, 42, _hoisted_3))\n            : (element.type === 'word')\n              ? (_openBlock(), _createElementBlock(\"span\", {\n                  key: 1,\n                  tabindex: \"0\",\n                  role: \"button\",\n                  \"aria-pressed\": _ctx.isMarked(element),\n                  onClick: ($event: any) => (_ctx.onClickWord(element)),\n                  onKeydown: ($event: any) => (_ctx.onWordKeydown($event, element)),\n                  onKeyup: ($event: any) => (_ctx.onWordKeyup($event, element)),\n                  class: _normalizeClass(['no-break', _ctx.classForWord(element)]),\n                  innerHTML: element.text\n                }, null, 42, _hoisted_4))\n              : (element.type === 'punctuation')\n                ? (_openBlock(), _createElementBlock(\"span\", {\n                    key: 2,\n                    innerHTML: element.text\n                  }, null, 8, _hoisted_5))\n                : (element.type === 'line-break')\n                  ? (_openBlock(), _createElementBlock(\"br\", _hoisted_6))\n                  : (element.type === 'space')\n                    ? (_openBlock(), _createElementBlock(\"pre\", _hoisted_7, \" \"))\n                    : _createCommentVNode(\"\", true)\n        ], 64))\n      }), 128))\n    ]),\n    _createElementVNode(\"div\", _hoisted_8, [\n      (_ctx.showResults)\n        ? (_openBlock(), _createBlock(_component_feedback_element, {\n            key: 0,\n            \"achieved-points\": _ctx.score,\n            \"max-points\": _ctx.maxScore,\n            feedback: _ctx.task.feedback,\n            \"result-message\": _ctx.resultMessage\n          }, null, 8, [\"achieved-points\", \"max-points\", \"feedback\", \"result-message\"]))\n        : _createCommentVNode(\"\", true),\n      _createElementVNode(\"div\", _hoisted_9, [\n        (_ctx.showCheckButton)\n          ? (_openBlock(), _createElementBlock(\"button\", {\n              key: 0,\n              textContent: _toDisplayString(_ctx.task.strings.checkButton),\n              onClick: _cache[0] || (_cache[0] = \n//@ts-ignore\n(...args) => (_ctx.onClickCheck && _ctx.onClickCheck(...args))),\n              type: \"button\",\n              class: \"stud5p-button\"\n            }, null, 8, _hoisted_10))\n          : _createCommentVNode(\"\", true),\n        (_ctx.showSolutionsButton)\n          ? (_openBlock(), _createElementBlock(\"button\", {\n              key: 1,\n              textContent: _toDisplayString(_ctx.task.strings.solutionsButton),\n              onClick: _cache[1] || (_cache[1] = \n//@ts-ignore\n(...args) => (_ctx.onClickShowSolutions && _ctx.onClickShowSolutions(...args))),\n              type: \"button\",\n              class: \"stud5p-button\"\n            }, null, 8, _hoisted_11))\n          : _createCommentVNode(\"\", true),\n        (_ctx.showRetryButton)\n          ? (_openBlock(), _createElementBlock(\"button\", {\n              key: 2,\n              textContent: _toDisplayString(_ctx.task.strings.retryButton),\n              onClick: _cache[2] || (_cache[2] = \n//@ts-ignore\n(...args) => (_ctx.onClickRetry && _ctx.onClickRetry(...args))),\n              type: \"button\",\n              class: \"stud5p-button\"\n            }, null, 8, _hoisted_12))\n          : _createCommentVNode(\"\", true)\n      ])\n    ]),\n    (_ctx.debug)\n      ? (_openBlock(), _createElementBlock(\"div\", _hoisted_13, [\n          _hoisted_14,\n          _createElementVNode(\"pre\", null, _toDisplayString(_ctx.markedWords), 1),\n          _hoisted_15,\n          _createElementVNode(\"pre\", null, _toDisplayString(_ctx.task.template), 1),\n          _hoisted_16,\n          _createElementVNode(\"pre\", null, _toDisplayString(_ctx.splitTemplate), 1),\n          _hoisted_17,\n          _createElementVNode(\"pre\", null, _toDisplayString(_ctx.parsedTemplate), 1)\n        ]))\n      : _createCommentVNode(\"\", true)\n  ]))\n}","<template>\n  <div class=\"stud5p-task\">\n    <div class=\"mark-the-words-text\">\n      <template v-for=\"element in parsedTemplate\" :key=\"element.uuid\">\n        <span\n          v-if=\"element.type === 'solution'\"\n          tabindex=\"0\"\n          role=\"button\"\n          :aria-pressed=\"isMarked(element)\"\n          @click=\"onClickWord(element)\"\n          @keydown=\"onWordKeydown($event, element)\"\n          @keyup=\"onWordKeyup($event, element)\"\n          :class=\"['no-break', classForWord(element)]\"\n          v-html=\"element.text\"\n        ></span>\n\n        <span\n          v-else-if=\"element.type === 'word'\"\n          tabindex=\"0\"\n          role=\"button\"\n          :aria-pressed=\"isMarked(element)\"\n          @click=\"onClickWord(element)\"\n          @keydown=\"onWordKeydown($event, element)\"\n          @keyup=\"onWordKeyup($event, element)\"\n          :class=\"['no-break', classForWord(element)]\"\n          v-html=\"element.text\"\n        ></span>\n\n        <span\n          v-else-if=\"element.type === 'punctuation'\"\n          v-html=\"element.text\"\n        ></span>\n\n        <br v-else-if=\"element.type === 'line-break'\" />\n\n        <!--  prettier-ignore-->\n        <pre v-else-if=\"element.type === 'space'\" class=\"space\"> </pre>\n      </template>\n    </div>\n\n    <!-- Feedback and button section -->\n    <div class=\"feedback-and-button-container\">\n      <feedback-element\n        v-if=\"showResults\"\n        :achieved-points=\"score\"\n        :max-points=\"maxScore\"\n        :feedback=\"task.feedback\"\n        :result-message=\"resultMessage\"\n      />\n\n      <div class=\"button-panel\">\n        <button\n          v-if=\"showCheckButton\"\n          v-text=\"task.strings.checkButton\"\n          @click=\"onClickCheck\"\n          type=\"button\"\n          class=\"stud5p-button\"\n        />\n\n        <button\n          v-if=\"showSolutionsButton\"\n          v-text=\"task.strings.solutionsButton\"\n          @click=\"onClickShowSolutions\"\n          type=\"button\"\n          class=\"stud5p-button\"\n        />\n\n        <button\n          v-if=\"showRetryButton\"\n          v-text=\"task.strings.retryButton\"\n          @click=\"onClickRetry\"\n          type=\"button\"\n          class=\"stud5p-button\"\n        />\n      </div>\n    </div>\n\n    <div v-if=\"debug\">\n      Marked words:\n      <pre>{{ markedWords }}</pre>\n      template:\n      <pre>{{ task.template }}</pre>\n      Split template:\n      <pre>{{ splitTemplate }}</pre>\n      Parsed template:\n      <pre>{{ parsedTemplate }}</pre>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, PropType } from 'vue';\nimport { MarkTheWordsTask } from '@/models/TaskDefinition';\nimport { v4 as uuidv4 } from 'uuid';\nimport FeedbackElement from '@/components/FeedbackElement.vue';\n\ntype Uuid = string;\n\ntype MarkTheWordsElement = Solution | Word | Space | Punctuation | LineBreak;\n\ninterface Solution {\n  type: 'solution';\n  uuid: Uuid;\n  text: string;\n}\n\ninterface Word {\n  type: 'word';\n  uuid: Uuid;\n  text: string;\n}\n\ninterface Space {\n  type: 'space';\n  uuid: Uuid;\n}\n\ninterface Punctuation {\n  type: 'punctuation';\n  uuid: Uuid;\n  text: string;\n}\n\ninterface LineBreak {\n  type: 'line-break';\n  uuid: Uuid;\n}\n\nexport default defineComponent({\n  name: 'MarkTheWordsViewer',\n  props: {\n    task: {\n      type: Object as PropType<MarkTheWordsTask>,\n      required: true,\n    },\n  },\n  components: {\n    FeedbackElement,\n  },\n  data() {\n    return {\n      markedWords: new Set<MarkTheWordsElement>(),\n      showResults: false,\n      showSolutions: false,\n      debug: false,\n    };\n  },\n  methods: {\n    onClickCheck() {\n      this.showResults = true;\n    },\n\n    onClickShowSolutions() {\n      this.showSolutions = true;\n    },\n\n    onClickRetry() {\n      this.showResults = false;\n      this.showSolutions = false;\n      this.markedWords.clear();\n    },\n\n    onClickWord(word: MarkTheWordsElement) {\n      if (this.showResults) return;\n\n      if (this.isMarked(word)) {\n        this.markedWords.delete(word);\n      } else {\n        this.markedWords.add(word);\n      }\n    },\n\n    /**\n     * Marks/unmarks a word using the enter key.\n     */\n    onWordKeydown(event: KeyboardEvent, word: MarkTheWordsElement) {\n      // The action button is activated by space on the keyup event, but the\n      // default action for space is already triggered on keydown. It needs to be\n      // prevented to stop scrolling the page before activating the button.\n      if (event.code === 'Space') {\n        event.preventDefault();\n      }\n      // If enter is pressed, activate the button\n      else if (event.code === 'Enter' || event.code === 'Return') {\n        event.preventDefault();\n        this.onClickWord(word);\n      }\n    },\n\n    /**\n     * Marks/unmarks a word with the space key.\n     */\n    onWordKeyup(event: KeyboardEvent, word: MarkTheWordsElement) {\n      if (event.code === 'Space') {\n        event.preventDefault();\n        this.onClickWord(word);\n      }\n    },\n\n    classForWord(word: MarkTheWordsElement) {\n      if (this.showResults) {\n        // User is done marking words and wants to see the results\n        if (this.isMarked(word)) {\n          return word.type === 'solution'\n            ? 'correct-answer'\n            : 'incorrect-answer';\n        }\n        // Word is not marked\n        return this.showSolutions && word.type === 'solution'\n          ? 'solution'\n          : 'static-word-no-hover';\n      }\n\n      // User is still working on the task\n      return this.isMarked(word) ? 'marked-word' : 'static-word';\n    },\n\n    isMarked(word: MarkTheWordsElement): boolean {\n      return this.markedWords.has(word);\n    },\n\n    sanitizeText(text: string) {\n      // Remove all opening and closing <p> tags and all occurrences of &nbsp;\n      return text.replace(/<\\/?p>/g, '').replace(/&nbsp;/g, ' ');\n    },\n  },\n  computed: {\n    splitTemplate(): string[] {\n      // Step 1: Sanitize the template (removes <p> tags and &nbsp;)\n      const cleanTemplate = this.sanitizeText(this.task.template);\n\n      // Step 2: Split by solutions (words surrounded by asterisks)\n      // This captures solutions as one piece and separates the rest of the text.\n      const splitBySolutions = cleanTemplate.split(/(\\*[^*]+\\*)/g);\n\n      // Step 3: Process each chunk: If it's a solution, leave it intact.\n      // If it's not a solution, split it further by line breaks, punctuation and spaces.\n      const finalSplit = splitBySolutions.flatMap((part) => {\n        if (/^\\*[^*]+\\*$/.test(part)) {\n          // This part is a solution (surrounded by asterisks), leave it intact\n          return part;\n        } else {\n          // This part is regular text, split by line breaks, spaces, and punctuation\n          return part.split(/(<br\\s*\\/?>|\\s+|[.,!?;:()])/g).filter(Boolean); // Remove empty parts\n        }\n      });\n\n      // Step 4: Return the final split array\n      return finalSplit;\n    },\n\n    parsedTemplate(): MarkTheWordsElement[] {\n      let parsedTemplate: MarkTheWordsElement[] = [];\n\n      this.splitTemplate.forEach((templateElement) => {\n        if (/^\\*[^*]+\\*$/.test(templateElement)) {\n          // If it's a solution (word surrounded by asterisks)\n          // Remove the asterisks first\n          const content = templateElement.replace(/\\*/g, '');\n\n          parsedTemplate.push({\n            type: 'solution',\n            uuid: uuidv4(),\n            text: content,\n          });\n        } else if (/^\\s+$/.test(templateElement)) {\n          // If it's a space\n          parsedTemplate.push({\n            type: 'space',\n            uuid: uuidv4(),\n          });\n        } else if (/^<br\\s*\\/?>$/.test(templateElement)) {\n          // If it's a line break\n          parsedTemplate.push({\n            type: 'line-break',\n            uuid: uuidv4(),\n          });\n        } else if (/[.,!?;:()]/.test(templateElement)) {\n          // If it's a punctuation mark\n          parsedTemplate.push({\n            type: 'punctuation',\n            uuid: uuidv4(),\n            text: templateElement,\n          });\n        } else {\n          // It's a regular word (including hyphenated words)\n          parsedTemplate.push({\n            type: 'word',\n            uuid: uuidv4(),\n            text: templateElement,\n          });\n        }\n      });\n\n      return parsedTemplate;\n    },\n\n    showCheckButton(): boolean {\n      return !this.showResults;\n    },\n\n    showRetryButton(): boolean {\n      return (\n        this.task.retryAllowed && this.showResults && !this.allAnswersAreCorrect\n      );\n    },\n\n    showSolutionsButton(): boolean {\n      return (\n        this.task.showSolutionsAllowed &&\n        this.showResults &&\n        !this.showSolutions &&\n        !this.allAnswersAreCorrect\n      );\n    },\n\n    score(): number {\n      let score = 0;\n\n      for (const element of this.markedWords) {\n        if (element.type === 'solution') {\n          score++;\n        } else {\n          score--;\n        }\n      }\n\n      if (score < 0) score = 0;\n\n      return score;\n    },\n\n    maxScore(): number {\n      let maxScore = 0;\n\n      for (const element of this.parsedTemplate) {\n        if (element.type === 'solution') {\n          maxScore++;\n        }\n      }\n\n      return maxScore;\n    },\n\n    resultMessage(): string {\n      let resultMessage = this.task.strings.resultMessage.replace(\n        ':correct',\n        this.score.toString()\n      );\n\n      resultMessage = resultMessage.replace(':total', this.maxScore.toString());\n\n      return resultMessage;\n    },\n\n    allAnswersAreCorrect(): boolean {\n      return this.score === this.maxScore;\n    },\n  },\n});\n</script>\n\n<style scoped>\n.static-word {\n  background: #ffffff;\n  color: #000000;\n}\n\n.static-word:hover {\n  box-shadow: 0 0 0 1px #cee0f4;\n  border-radius: 0.25em;\n  cursor: pointer;\n}\n\n.static-word-no-hover {\n  background: #ffffff;\n  color: #000000;\n}\n\n.marked-word {\n  box-shadow: 0 0 0 1px #cee0f4;\n  border-radius: 0.25em;\n  background-color: #d4f1f6;\n}\n\n.marked-word:hover {\n  box-shadow: 0 0 0 1px #cee0f4;\n  border-radius: 0.25em;\n  cursor: pointer;\n}\n\n.correct-answer {\n  color: #255c41;\n  box-shadow: 0 0 0 1px #d4f6e6;\n  border-radius: 0.25em;\n  background-color: #d4f6e6;\n}\n\n.solution {\n  color: #255c41;\n  box-shadow: 0 0 0 1px #d4f6e6;\n  border-radius: 0.25em;\n  background-color: #d4f6e6;\n  border: 1px #255c41 dashed;\n}\n\n.incorrect-answer {\n  color: #b71c1c;\n  box-shadow: 0 0 0 1px #f7d0d0;\n  border-radius: 0.25em;\n  background-color: #f7d0d0;\n  text-decoration: line-through;\n}\n\n.space {\n  font-family: Sans-Serif;\n  display: inline;\n}\n\n.no-break {\n  white-space: nowrap; /* Prevents line break inside the element */\n  display: inline-block; /* Makes sure it behaves like a block in inline context */\n}\n</style>\n","import { render } from \"./MarkTheWordsViewer.vue?vue&type=template&id=8fc7d02c&scoped=true&ts=true\"\nimport script from \"./MarkTheWordsViewer.vue?vue&type=script&lang=ts\"\nexport * from \"./MarkTheWordsViewer.vue?vue&type=script&lang=ts\"\n\nimport \"./MarkTheWordsViewer.vue?vue&type=style&index=0&id=8fc7d02c&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-8fc7d02c\"]])\n\nexport default __exports__","import { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, withModifiers as _withModifiers, normalizeClass as _normalizeClass, resolveComponent as _resolveComponent, createVNode as _createVNode, createCommentVNode as _createCommentVNode, vModelCheckbox as _vModelCheckbox, withDirectives as _withDirectives, createTextVNode as _createTextVNode, createBlock as _createBlock, vModelText as _vModelText, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-e3fd84b0\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"stud5p-task\" }\nconst _hoisted_2 = { class: \"default\" }\nconst _hoisted_3 = { class: \"memory-editor\" }\nconst _hoisted_4 = { class: \"cards-list\" }\nconst _hoisted_5 = [\"onClick\"]\nconst _hoisted_6 = [\"textContent\"]\nconst _hoisted_7 = [\"onClick\", \"aria-label\"]\nconst _hoisted_8 = [\"src\"]\nconst _hoisted_9 = {\n  key: 0,\n  class: \"edited-memory-card\"\n}\nconst _hoisted_10 = {\n  key: 1,\n  class: \"no-card-selected-placeholder\"\n}\nconst _hoisted_11 = { class: \"collapsable collapsed\" }\nconst _hoisted_12 = {\n  key: 0,\n  class: \"flipside-image-and-button-container\"\n}\nconst _hoisted_13 = { class: \"collapsable collapsed\" }\nconst _hoisted_14 = [\"disabled\"]\nconst _hoisted_15 = { class: \"collapsable collapsed\" }\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_MemoryEditorCard = _resolveComponent(\"MemoryEditorCard\")!\n  const _component_LazyImage = _resolveComponent(\"LazyImage\")!\n  const _component_FileUpload = _resolveComponent(\"FileUpload\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createElementVNode(\"form\", _hoisted_2, [\n      _createElementVNode(\"fieldset\", _hoisted_3, [\n        _createElementVNode(\"legend\", null, _toDisplayString(_ctx.$gettext('Memory')), 1),\n        _createElementVNode(\"div\", _hoisted_4, [\n          (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.modelTaskDefinition.cards, (card, index) => {\n            return (_openBlock(), _createElementBlock(\"div\", {\n              key: card.uuid,\n              class: _normalizeClass({\n              'cards-list-item': true,\n              'selected-card': index === _ctx.selectedCardIndex,\n            }),\n              onClick: ($event: any) => (_ctx.selectCard(index))\n            }, [\n              _createElementVNode(\"div\", {\n                textContent: _toDisplayString(_ctx.listEntryText(index, card)),\n                class: \"list-entry-text\"\n              }, null, 8, _hoisted_6),\n              _createElementVNode(\"button\", {\n                type: \"button\",\n                class: \"flex-child-element remove-card-button\",\n                onClick: _withModifiers(($event: any) => (_ctx.deleteCard(index)), [\"stop\"]),\n                \"aria-label\": _ctx.$pgettext('Karte im Memory Spiel', 'Karte lschen')\n              }, [\n                _createElementVNode(\"img\", {\n                  src: _ctx.urlForIcon('trash'),\n                  alt: \"\"\n                }, null, 8, _hoisted_8)\n              ], 8, _hoisted_7)\n            ], 10, _hoisted_5))\n          }), 128)),\n          _createElementVNode(\"button\", {\n            type: \"button\",\n            class: \"button add add-card-button\",\n            onClick: _cache[0] || (_cache[0] = \n//@ts-ignore\n(...args) => (_ctx.addCard && _ctx.addCard(...args)))\n          }, _toDisplayString(_ctx.$gettext('Karte hinzufgen')), 1)\n        ]),\n        (_ctx.modelTaskDefinition.cards[_ctx.selectedCardIndex])\n          ? (_openBlock(), _createElementBlock(\"div\", _hoisted_9, [\n              _createVNode(_component_MemoryEditorCard, {\n                card: _ctx.modelTaskDefinition.cards[_ctx.selectedCardIndex],\n                \"onUpdate:card\": _ctx.updateCard\n              }, null, 8, [\"card\", \"onUpdate:card\"])\n            ]))\n          : (_openBlock(), _createElementBlock(\"fieldset\", _hoisted_10, [\n              _createElementVNode(\"legend\", null, _toDisplayString(_ctx.$gettext('Keine Karte ausgewhlt')), 1)\n            ]))\n      ]),\n      _createElementVNode(\"fieldset\", _hoisted_11, [\n        _createElementVNode(\"legend\", null, _toDisplayString(_ctx.$gettext('Einstellungen')), 1),\n        _createElementVNode(\"label\", null, [\n          _withDirectives(_createElementVNode(\"input\", {\n            \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event: any) => ((_ctx.modelTaskDefinition.retryAllowed) = $event)),\n            onChange: _cache[2] || (_cache[2] = \n//@ts-ignore\n(...args) => (_ctx.updateTaskDefinition && _ctx.updateTaskDefinition(...args))),\n            type: \"checkbox\"\n          }, null, 544), [\n            [_vModelCheckbox, _ctx.modelTaskDefinition.retryAllowed]\n          ]),\n          _createTextVNode(\" \" + _toDisplayString(_ctx.$gettext('Mehrere Versuche erlauben')), 1)\n        ]),\n        _createElementVNode(\"label\", null, [\n          _withDirectives(_createElementVNode(\"input\", {\n            \"onUpdate:modelValue\": _cache[3] || (_cache[3] = ($event: any) => ((_ctx.modelTaskDefinition.squareLayout) = $event)),\n            onChange: _cache[4] || (_cache[4] = \n//@ts-ignore\n(...args) => (_ctx.updateTaskDefinition && _ctx.updateTaskDefinition(...args))),\n            type: \"checkbox\"\n          }, null, 544), [\n            [_vModelCheckbox, _ctx.modelTaskDefinition.squareLayout]\n          ]),\n          _createTextVNode(\" \" + _toDisplayString(_ctx.$gettext('Karten in einem Quadrat positionieren')), 1)\n        ]),\n        _createElementVNode(\"label\", null, [\n          _createTextVNode(_toDisplayString(_ctx.$gettext('Rckseite')) + \" \", 1),\n          (\n              _ctx.modelTaskDefinition.flipside &&\n              _ctx.modelTaskDefinition.flipside.file_id\n            )\n            ? (_openBlock(), _createElementBlock(\"span\", _hoisted_12, [\n                _createVNode(_component_LazyImage, {\n                  src: _ctx.fileIdToUrl(_ctx.modelTaskDefinition.flipside.file_id),\n                  alt: _ctx.modelTaskDefinition.flipside.altText,\n                  class: \"flipside-image\"\n                }, null, 8, [\"src\", \"alt\"]),\n                _createElementVNode(\"button\", {\n                  onClick: _cache[5] || (_cache[5] = \n//@ts-ignore\n(...args) => (_ctx.deleteFlipsideImage && _ctx.deleteFlipsideImage(...args))),\n                  type: \"button\",\n                  class: \"button delete-flipside-image-button\"\n                }, _toDisplayString(_ctx.$gettext('Bild Lschen')), 1)\n              ]))\n            : (_openBlock(), _createBlock(_component_FileUpload, {\n                key: 1,\n                onFileUploaded: _ctx.onFlipsideImageUploaded\n              }, null, 8, [\"onFileUploaded\"]))\n        ])\n      ]),\n      _createElementVNode(\"fieldset\", _hoisted_13, [\n        _createElementVNode(\"legend\", null, _toDisplayString(_ctx.$gettext('Beschriftungen')), 1),\n        _createElementVNode(\"label\", {\n          class: _normalizeClass({ 'setting-disabled': !_ctx.modelTaskDefinition.retryAllowed })\n        }, [\n          _createTextVNode(_toDisplayString(_ctx.$gettext('Text fr Wiederholen-Button:')) + \" \", 1),\n          _withDirectives(_createElementVNode(\"input\", {\n            \"onUpdate:modelValue\": _cache[6] || (_cache[6] = ($event: any) => ((_ctx.modelTaskDefinition.strings.retryButton) = $event)),\n            onInput: _cache[7] || (_cache[7] = ($event: any) => (_ctx.updateTaskDefinition('taskDefinition.strings.retryButton'))),\n            disabled: !_ctx.modelTaskDefinition.retryAllowed,\n            type: \"text\"\n          }, null, 40, _hoisted_14), [\n            [_vModelText, _ctx.modelTaskDefinition.strings.retryButton]\n          ])\n        ], 2)\n      ]),\n      _createElementVNode(\"fieldset\", _hoisted_15, [\n        _createElementVNode(\"legend\", null, _toDisplayString(_ctx.$gettext('Feedback')), 1),\n        _createElementVNode(\"label\", null, [\n          _createTextVNode(_toDisplayString(_ctx.$gettext('Ergebnismitteilung:')) + \" \", 1),\n          _withDirectives(_createElementVNode(\"input\", {\n            \"onUpdate:modelValue\": _cache[8] || (_cache[8] = ($event: any) => ((_ctx.modelTaskDefinition.strings.resultMessage) = $event)),\n            onInput: _cache[9] || (_cache[9] = ($event: any) => (\n              _ctx.updateTaskDefinition('taskDefinition.strings.resultMessage')\n            )),\n            type: \"text\"\n          }, null, 544), [\n            [_vModelText, _ctx.modelTaskDefinition.strings.resultMessage]\n          ])\n        ])\n      ])\n    ])\n  ]))\n}","<template>\n  <div class=\"stud5p-task\">\n    <form class=\"default\">\n      <fieldset class=\"memory-editor\">\n        <legend>{{ $gettext('Memory') }}</legend>\n\n        <div class=\"cards-list\">\n          <div\n            v-for=\"(card, index) in modelTaskDefinition.cards\"\n            :key=\"card.uuid\"\n            :class=\"{\n              'cards-list-item': true,\n              'selected-card': index === selectedCardIndex,\n            }\"\n            @click=\"selectCard(index)\"\n          >\n            <div v-text=\"listEntryText(index, card)\" class=\"list-entry-text\" />\n\n            <!-- Apply .stop modifier so that the selectCard event handler on the\n            parent element doesn't get called when the delete button is clicked -->\n            <button\n              type=\"button\"\n              class=\"flex-child-element remove-card-button\"\n              @click.stop=\"deleteCard(index)\"\n              :aria-label=\"$pgettext('Karte im Memory Spiel', 'Karte lschen')\"\n            >\n              <img :src=\"urlForIcon('trash')\" alt=\"\" />\n            </button>\n          </div>\n\n          <button\n            type=\"button\"\n            class=\"button add add-card-button\"\n            @click=\"addCard\"\n          >\n            {{ $gettext('Karte hinzufgen') }}\n          </button>\n        </div>\n\n        <div\n          v-if=\"modelTaskDefinition.cards[selectedCardIndex]\"\n          class=\"edited-memory-card\"\n        >\n          <MemoryEditorCard\n            :card=\"modelTaskDefinition.cards[selectedCardIndex]\"\n            @update:card=\"updateCard\"\n          />\n        </div>\n\n        <fieldset v-else class=\"no-card-selected-placeholder\">\n          <legend>\n            {{ $gettext('Keine Karte ausgewhlt') }}\n          </legend>\n        </fieldset>\n      </fieldset>\n\n      <fieldset class=\"collapsable collapsed\">\n        <legend>{{ $gettext('Einstellungen') }}</legend>\n\n        <label>\n          <input\n            v-model=\"modelTaskDefinition.retryAllowed\"\n            @change=\"updateTaskDefinition\"\n            type=\"checkbox\"\n          />\n          {{ $gettext('Mehrere Versuche erlauben') }}\n        </label>\n\n        <label>\n          <input\n            v-model=\"modelTaskDefinition.squareLayout\"\n            @change=\"updateTaskDefinition\"\n            type=\"checkbox\"\n          />\n          {{ $gettext('Karten in einem Quadrat positionieren') }}\n        </label>\n\n        <label\n          >{{ $gettext('Rckseite') }}\n          <span\n            v-if=\"\n              modelTaskDefinition.flipside &&\n              modelTaskDefinition.flipside.file_id\n            \"\n            class=\"flipside-image-and-button-container\"\n          >\n            <LazyImage\n              :src=\"fileIdToUrl(modelTaskDefinition.flipside.file_id)\"\n              :alt=\"modelTaskDefinition.flipside.altText\"\n              class=\"flipside-image\"\n            />\n\n            <button\n              @click=\"deleteFlipsideImage\"\n              type=\"button\"\n              class=\"button delete-flipside-image-button\"\n            >\n              {{ $gettext('Bild Lschen') }}\n            </button>\n          </span>\n\n          <FileUpload v-else @file-uploaded=\"onFlipsideImageUploaded\" />\n        </label>\n      </fieldset>\n\n      <fieldset class=\"collapsable collapsed\">\n        <legend>{{ $gettext('Beschriftungen') }}</legend>\n\n        <label\n          :class=\"{ 'setting-disabled': !modelTaskDefinition.retryAllowed }\"\n        >\n          {{ $gettext('Text fr Wiederholen-Button:') }}\n          <input\n            v-model=\"modelTaskDefinition.strings.retryButton\"\n            @input=\"updateTaskDefinition('taskDefinition.strings.retryButton')\"\n            :disabled=\"!modelTaskDefinition.retryAllowed\"\n            type=\"text\"\n          />\n        </label>\n      </fieldset>\n\n      <fieldset class=\"collapsable collapsed\">\n        <legend>{{ $gettext('Feedback') }}</legend>\n\n        <label>\n          {{ $gettext('Ergebnismitteilung:') }}\n          <input\n            v-model=\"modelTaskDefinition.strings.resultMessage\"\n            @input=\"\n              updateTaskDefinition('taskDefinition.strings.resultMessage')\n            \"\n            type=\"text\"\n          />\n        </label>\n      </fieldset>\n    </form>\n  </div>\n</template>\n\n<style scoped>\n.memory-editor {\n  display: flex;\n  gap: 1em;\n}\n\n.cards-list {\n  display: flex;\n  flex-direction: column;\n  flex: 0 0 200px;\n  max-width: 14em;\n}\n\n.cards-list-item {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  border: transparent 2px solid;\n  padding: 2px;\n  cursor: pointer;\n  user-select: none;\n}\n\n.selected-card {\n  border: #0a78d1 2px solid;\n}\n\n.edited-memory-card {\n  flex: 1 1 auto;\n}\n\n.no-card-selected-placeholder {\n  flex: 1 1 auto;\n  height: 150px;\n}\n\n.list-entry-text {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  max-width: 11em;\n}\n\n.remove-card-button {\n  aspect-ratio: 1;\n  display: flex;\n  align-items: center;\n  border: 1px solid #28497c;\n  color: #28497c;\n  background: #fff;\n  cursor: pointer;\n}\n\n.remove-card-button:hover {\n  background: rgba(109, 114, 122, 0.2);\n}\n\n.add-card-button {\n  margin: 0.8em 0 0 0;\n}\n\n.delete-flipside-image-button {\n  margin: 0;\n}\n\n.flipside-image-and-button-container {\n  display: flex;\n  flex-direction: row;\n  justify-content: flex-start;\n  align-items: flex-end;\n  gap: 0.5em;\n}\n\n.memory-card-flipside {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n\n  width: 100%;\n  max-width: 14em;\n  aspect-ratio: 1;\n\n  border: 2px solid #d0d7e3;\n  color: #28497c;\n  background: #e7ebf1;\n}\n\n.flipside-image {\n  width: 12em;\n  height: 12em;\n\n  display: flex;\n  justify-content: center;\n  align-items: center;\n\n  border: 2px solid #dbe2e8;\n  border-radius: 0.5em;\n  margin: 0;\n}\n</style>\n\n<script lang=\"ts\">\nimport { defineComponent, inject, PropType } from 'vue';\nimport { fileIdToUrl, MemoryCard, MemoryTask } from '@/models/TaskDefinition';\nimport { $gettext, $pgettext } from '@/language/gettext';\nimport produce from 'immer';\nimport { v4 } from 'uuid';\nimport FileUpload from '@/components/FileUpload.vue';\nimport { FileRef } from '@/routes/jsonApi';\nimport MemoryEditorCard from '@/components/MemoryEditorCard.vue';\nimport LazyImage from '@/components/LazyImage.vue';\nimport {\n  TaskEditorState,\n  taskEditorStateSymbol,\n} from '@/components/taskEditorState';\nimport { cloneDeep } from 'lodash';\n\nexport default defineComponent({\n  name: 'MemoryEditor',\n  setup() {\n    return {\n      taskEditor: inject<TaskEditorState>(taskEditorStateSymbol),\n    };\n  },\n  components: { LazyImage, MemoryEditorCard, FileUpload },\n  props: {\n    taskDefinition: {\n      type: Object as PropType<MemoryTask>,\n      required: true,\n    },\n  },\n  data() {\n    return {\n      selectedCardIndex: -1,\n      modelTaskDefinition: cloneDeep(this.taskDefinition),\n    };\n  },\n  watch: {\n    // Synchronize state taskDefinition -> modelTaskDefinition.\n    taskDefinition: {\n      immediate: true,\n      handler: function (): void {\n        this.modelTaskDefinition = cloneDeep(this.taskDefinition);\n      },\n    },\n  },\n  beforeMount(): void {\n    if (this.taskDefinition.cards.length > 0) {\n      this.selectedCardIndex = 0;\n    }\n  },\n  methods: {\n    fileIdToUrl,\n    $gettext,\n    $pgettext,\n    updateTaskDefinition(undoBatch?: unknown) {\n      // Synchronize state modelTaskDefinition -> taskDefinition.\n      this.taskEditor!.performEdit({\n        newTaskDefinition: cloneDeep(this.modelTaskDefinition),\n        undoBatch: undoBatch ?? {},\n      });\n    },\n    urlForIcon(iconName: string) {\n      return (\n        window.STUDIP.ASSETS_URL + 'images/icons/blue/' + iconName + '.svg'\n      );\n    },\n    selectCard(index: number) {\n      this.selectedCardIndex = index;\n    },\n    listEntryText(index: number, card: MemoryCard) {\n      let text = index + 1 + '. ';\n      text += $gettext('Paar');\n\n      /*\n      if (card.first.altText != '') {\n        text += card.first.altText;\n\n        if (card.second && card.second?.altText != '') {\n          text += ' ' + $gettext('und') + ' ' + card.second.altText;\n        }\n      } else {\n        text += $gettext('Paar');\n      }\n      */\n\n      return text;\n    },\n    addCard() {\n      this.modelTaskDefinition = produce(this.modelTaskDefinition, (draft) => {\n        draft.cards.push({\n          uuid: v4(),\n          first: {\n            uuid: v4(),\n            type: 'image',\n            file_id: '',\n            altText: '',\n          },\n        });\n      });\n      this.taskEditor!.performEdit({\n        newTaskDefinition: this.modelTaskDefinition,\n        undoBatch: {},\n      });\n      // Select the newly inserted card\n      this.selectedCardIndex = this.modelTaskDefinition.cards.length - 1;\n    },\n    deleteCard(index: number) {\n      this.modelTaskDefinition = produce(this.modelTaskDefinition, (draft) => {\n        draft.cards.splice(index, 1);\n      });\n\n      this.updateTaskDefinition();\n\n      // Adjust the selection index so the selected card doesn't unexpectedly change\n      if (index <= this.selectedCardIndex) {\n        this.selectedCardIndex = this.selectedCardIndex - 1;\n      }\n    },\n    updateCard(updatedCard: MemoryCard, undoBatch?: unknown) {\n      this.modelTaskDefinition = produce(this.modelTaskDefinition, (draft) => {\n        draft.cards[this.selectedCardIndex] = updatedCard;\n      });\n      this.updateTaskDefinition(undoBatch);\n    },\n    onFlipsideImageUploaded(file: FileRef): void {\n      const newTaskDefinition = produce(this.modelTaskDefinition, (draft) => {\n        draft.flipside = {\n          uuid: v4(),\n          type: 'image',\n          file_id: file.id,\n          altText: '',\n        };\n      });\n      this.taskEditor!.performEdit({\n        newTaskDefinition: newTaskDefinition,\n        undoBatch: {},\n      });\n    },\n    deleteFlipsideImage(): void {\n      const newTaskDefinition = produce(this.modelTaskDefinition, (draft) => {\n        draft.flipside = undefined;\n      });\n      this.taskEditor!.performEdit({\n        newTaskDefinition: newTaskDefinition,\n        undoBatch: {},\n      });\n    },\n  },\n});\n</script>\n","import { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, createTextVNode as _createTextVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, createBlock as _createBlock, Fragment as _Fragment, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-de915fa4\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"memory-editor-card\" }\nconst _hoisted_2 = {\n  key: 0,\n  class: \"image-memory-card-container\"\n}\nconst _hoisted_3 = { class: \"multimedia-element-wrapper\" }\nconst _hoisted_4 = { style: {\"align-self\":\"stretch\"} }\nconst _hoisted_5 = [\"value\"]\nconst _hoisted_6 = {\n  key: 0,\n  id: \"secondImage\",\n  class: \"image-memory-card-container\"\n}\nconst _hoisted_7 = { class: \"multimedia-element-wrapper\" }\nconst _hoisted_8 = { style: {\"align-self\":\"stretch\"} }\nconst _hoisted_9 = [\"value\"]\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_MultimediaElement = _resolveComponent(\"MultimediaElement\")!\n  const _component_FileUpload = _resolveComponent(\"FileUpload\")!\n\n  return (_openBlock(), _createElementBlock(\"fieldset\", _hoisted_1, [\n    _createElementVNode(\"legend\", null, _toDisplayString(_ctx.$gettext('Karte')), 1),\n    _createElementVNode(\"label\", null, _toDisplayString(_ctx.$gettext(_ctx.card.second ? 'Erstes Bild' : 'Bild')), 1),\n    (_ctx.card.first.type === 'image' && _ctx.card.first.file_id)\n      ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n          _createElementVNode(\"div\", _hoisted_3, [\n            _createVNode(_component_MultimediaElement, {\n              element: _ctx.card.first\n            }, null, 8, [\"element\"])\n          ]),\n          _createElementVNode(\"button\", {\n            type: \"button\",\n            onClick: _cache[0] || (_cache[0] = ($event: any) => (_ctx.onClickDeleteImage('first'))),\n            class: \"button trash settings-item\"\n          }, _toDisplayString(_ctx.$gettext('Bild lschen')), 1),\n          _createElementVNode(\"label\", _hoisted_4, [\n            _createTextVNode(_toDisplayString(_ctx.$gettext('Bildbeschreibung')) + \" \", 1),\n            _createElementVNode(\"input\", {\n              type: \"text\",\n              value: _ctx.card.first.altText,\n              onInput: _cache[1] || (_cache[1] = ($event: any) => (_ctx.onInputAltText($event, 'first'))),\n              class: \"settings-item\"\n            }, null, 40, _hoisted_5)\n          ])\n        ]))\n      : (_openBlock(), _createBlock(_component_FileUpload, {\n          key: 1,\n          onFileUploaded: _cache[2] || (_cache[2] = ($event: any) => (_ctx.onUploadImage($event, 'first')))\n        })),\n    (_ctx.card.second)\n      ? (_openBlock(), _createElementBlock(_Fragment, { key: 2 }, [\n          _createElementVNode(\"label\", null, _toDisplayString(_ctx.$gettext('Zweites Bild')), 1),\n          (_ctx.card.second.type === 'image' && _ctx.card.second.file_id)\n            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_6, [\n                _createElementVNode(\"div\", _hoisted_7, [\n                  _createVNode(_component_MultimediaElement, {\n                    element: _ctx.card.second,\n                    class: \"multimedia-element\"\n                  }, null, 8, [\"element\"])\n                ]),\n                _createElementVNode(\"button\", {\n                  type: \"button\",\n                  onClick: _cache[3] || (_cache[3] = ($event: any) => (_ctx.onClickDeleteImage('second'))),\n                  class: \"button trash settings-item\"\n                }, _toDisplayString(_ctx.$gettext('Bild lschen')), 1),\n                _createElementVNode(\"label\", _hoisted_8, [\n                  _createTextVNode(_toDisplayString(_ctx.$gettext('Bildbeschreibung')) + \" \", 1),\n                  _createElementVNode(\"input\", {\n                    type: \"text\",\n                    value: _ctx.card.second.altText,\n                    onInput: _cache[4] || (_cache[4] = ($event: any) => (_ctx.onInputAltText($event, 'second'))),\n                    class: \"settings-item\"\n                  }, null, 40, _hoisted_9)\n                ])\n              ]))\n            : (_openBlock(), _createBlock(_component_FileUpload, {\n                key: 1,\n                onFileUploaded: _cache[5] || (_cache[5] = ($event: any) => (_ctx.onUploadImage($event, 'second')))\n              }))\n        ], 64))\n      : (_ctx.card.first.file_id)\n        ? (_openBlock(), _createElementBlock(\"button\", {\n            key: 3,\n            type: \"button\",\n            onClick: _cache[6] || (_cache[6] = \n//@ts-ignore\n(...args) => (_ctx.addSecondImage && _ctx.addSecondImage(...args))),\n            class: \"button add-image-button\"\n          }, _toDisplayString(_ctx.$gettext('Zweites Bild hinzufgen')), 1))\n        : _createCommentVNode(\"\", true)\n  ]))\n}","<template>\n  <fieldset class=\"memory-editor-card\">\n    <legend>{{ $gettext('Karte') }}</legend>\n\n    <label>{{ $gettext(card.second ? 'Erstes Bild' : 'Bild') }}</label>\n    <div\n      v-if=\"card.first.type === 'image' && card.first.file_id\"\n      class=\"image-memory-card-container\"\n    >\n      <div class=\"multimedia-element-wrapper\">\n        <MultimediaElement :element=\"card.first\" />\n      </div>\n\n      <button\n        type=\"button\"\n        @click=\"onClickDeleteImage('first')\"\n        class=\"button trash settings-item\"\n      >\n        {{ $gettext('Bild lschen') }}\n      </button>\n\n      <label style=\"align-self: stretch\"\n        >{{ $gettext('Bildbeschreibung') }}\n        <input\n          type=\"text\"\n          :value=\"card.first.altText\"\n          @input=\"onInputAltText($event, 'first')\"\n          class=\"settings-item\"\n        />\n      </label>\n    </div>\n    <FileUpload v-else @file-uploaded=\"onUploadImage($event, 'first')\" />\n\n    <template v-if=\"card.second\">\n      <label>{{ $gettext('Zweites Bild') }}</label>\n\n      <div\n        v-if=\"card.second.type === 'image' && card.second.file_id\"\n        id=\"secondImage\"\n        class=\"image-memory-card-container\"\n      >\n        <div class=\"multimedia-element-wrapper\">\n          <MultimediaElement\n            :element=\"card.second\"\n            class=\"multimedia-element\"\n          />\n        </div>\n\n        <button\n          type=\"button\"\n          @click=\"onClickDeleteImage('second')\"\n          class=\"button trash settings-item\"\n        >\n          {{ $gettext('Bild lschen') }}\n        </button>\n\n        <label style=\"align-self: stretch\"\n          >{{ $gettext('Bildbeschreibung') }}\n          <input\n            type=\"text\"\n            :value=\"card.second.altText\"\n            @input=\"onInputAltText($event, 'second')\"\n            class=\"settings-item\"\n          />\n        </label>\n      </div>\n      <FileUpload v-else @file-uploaded=\"onUploadImage($event, 'second')\" />\n    </template>\n\n    <button\n      v-else-if=\"card.first.file_id\"\n      type=\"button\"\n      @click=\"addSecondImage\"\n      class=\"button add-image-button\"\n    >\n      {{ $gettext('Zweites Bild hinzufgen') }}\n    </button>\n  </fieldset>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, PropType } from 'vue';\nimport { MemoryCard } from '@/models/TaskDefinition';\nimport { $gettext } from '@/language/gettext';\nimport FileUpload from '@/components/FileUpload.vue';\nimport { FileRef } from '@/routes/jsonApi';\nimport { v4 } from 'uuid';\nimport MultimediaElement from '@/components/MultimediaElement.vue';\n\nexport default defineComponent({\n  name: 'MemoryEditorCard',\n  components: { MultimediaElement, FileUpload },\n  props: {\n    card: {\n      type: Object as PropType<MemoryCard>,\n      required: true,\n    },\n  },\n  methods: {\n    $gettext,\n    onUploadImage(file: FileRef, element: 'first' | 'second'): void {\n      // Why not use 'produce' here? I find it more readable, personally.\n      this.$emit('update:card', {\n        ...this.card,\n        [element]: {\n          ...this.card[element],\n          file_id: file.id,\n        },\n      });\n    },\n    onInputAltText(event: InputEvent, element: 'first' | 'second'): void {\n      const altText = (event.target as HTMLInputElement).value;\n      this.$emit(\n        'update:card',\n        {\n          ...this.card,\n          [element]: {\n            ...this.card[element],\n            altText,\n          },\n        },\n        this.card[element]?.uuid + '.altText'\n      );\n    },\n    addSecondImage(): void {\n      this.$emit('update:card', {\n        ...this.card,\n        second: {\n          uuid: v4(),\n          type: 'image',\n          file_id: '',\n          altText: '',\n        },\n      });\n    },\n    onClickDeleteImage(element: 'first' | 'second'): void {\n      if (element === 'first') {\n        this.$emit('update:card', {\n          ...this.card,\n          first: {\n            ...this.card.first,\n            file_id: '',\n          },\n        });\n      } else {\n        this.$emit('update:card', {\n          ...this.card,\n          second: undefined,\n        });\n      }\n    },\n  },\n});\n</script>\n\n<style scoped>\n.memory-editor-card {\n  flex: 1 1 auto;\n}\n\n.add-image-button {\n  margin: 0;\n}\n\n.multimedia-element-wrapper {\n  width: 12em;\n  height: 12em;\n\n  display: flex;\n  justify-content: center;\n  align-items: center;\n\n  border: 2px solid #dbe2e8;\n  border-radius: 0.5em;\n  background: white;\n\n  padding: 0.5em;\n  margin: 0;\n\n  overflow: hidden;\n}\n\n.image-memory-card-container {\n  display: flex;\n  flex-direction: column;\n  justify-content: flex-start;\n  align-items: flex-start;\n  gap: 0.5em;\n}\n\n.settings-item {\n  /* top | right | bottom | left */\n  margin: 0.25em 0 0 0;\n}\n</style>\n","import { resolveComponent as _resolveComponent, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, resolveDirective as _resolveDirective, withDirectives as _withDirectives, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-20c78112\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"multimedia-element\" }\nconst _hoisted_2 = {\n  key: 0,\n  class: \"image-element-wrapper\"\n}\nconst _hoisted_3 = {\n  key: 1,\n  class: \"image-element-placeholder\"\n}\nconst _hoisted_4 = {\n  key: 1,\n  class: \"text-element\"\n}\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_LazyImage = _resolveComponent(\"LazyImage\")!\n  const _directive_disable_drag = _resolveDirective(\"disable-drag\")!\n\n  return _withDirectives((_openBlock(), _createElementBlock(\"span\", _hoisted_1, [\n    (_ctx.element.type === 'image')\n      ? (_openBlock(), _createElementBlock(\"span\", _hoisted_2, [\n          (_ctx.element.file_id)\n            ? (_openBlock(), _createBlock(_component_LazyImage, {\n                key: 0,\n                src: _ctx.fileIdToUrl(_ctx.element.file_id),\n                alt: _ctx.element.altText,\n                class: \"image-element\"\n              }, null, 8, [\"src\", \"alt\"]))\n            : (_openBlock(), _createElementBlock(\"span\", _hoisted_3))\n        ]))\n      : (_ctx.element.type === 'text')\n        ? (_openBlock(), _createElementBlock(\"span\", _hoisted_4, [\n            _createElementVNode(\"span\", null, _toDisplayString(_ctx.element.content), 1)\n          ]))\n        : _createCommentVNode(\"\", true)\n  ])), [\n    [_directive_disable_drag]\n  ])\n}","<template>\n  <span class=\"multimedia-element\" v-disable-drag>\n    <span v-if=\"element.type === 'image'\" class=\"image-element-wrapper\">\n      <LazyImage\n        v-if=\"element.file_id\"\n        :src=\"fileIdToUrl(element.file_id)\"\n        :alt=\"element.altText\"\n        class=\"image-element\"\n      />\n      <span v-else class=\"image-element-placeholder\" />\n    </span>\n    <span v-else-if=\"element.type === 'text'\" class=\"text-element\">\n      <span> {{ element.content }} </span>\n    </span>\n  </span>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, PropType } from 'vue';\nimport {\n  fileIdToUrl,\n  LernmoduleMultimediaElement,\n} from '@/models/TaskDefinition';\nimport LazyImage from '@/components/LazyImage.vue';\n\nexport default defineComponent({\n  name: 'MultimediaElement',\n  components: { LazyImage },\n  props: {\n    element: {\n      type: Object as PropType<LernmoduleMultimediaElement>,\n      required: true,\n    },\n  },\n  methods: { fileIdToUrl },\n});\n</script>\n\n<style scoped>\n.multimedia-element {\n  width: 100%;\n  height: 100%;\n\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n\n.image-element {\n  width: 100%;\n  height: 100%;\n\n  border-radius: 0.25em;\n}\n\n.image-element-wrapper {\n  width: 100%;\n  height: 100%;\n\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  background: white;\n\n  box-shadow: inset 0 2px 74px 0 #cbd5de;\n  border-radius: 0.25em;\n}\n\n.image-element-placeholder {\n  width: 100%;\n  height: 100%;\n}\n\n.text-element {\n  width: 100%;\n  height: 100%;\n\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n</style>\n","import { render } from \"./MultimediaElement.vue?vue&type=template&id=20c78112&scoped=true&ts=true\"\nimport script from \"./MultimediaElement.vue?vue&type=script&lang=ts\"\nexport * from \"./MultimediaElement.vue?vue&type=script&lang=ts\"\n\nimport \"./MultimediaElement.vue?vue&type=style&index=0&id=20c78112&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-20c78112\"]])\n\nexport default __exports__","import { render } from \"./MemoryEditorCard.vue?vue&type=template&id=de915fa4&scoped=true&ts=true\"\nimport script from \"./MemoryEditorCard.vue?vue&type=script&lang=ts\"\nexport * from \"./MemoryEditorCard.vue?vue&type=script&lang=ts\"\n\nimport \"./MemoryEditorCard.vue?vue&type=style&index=0&id=de915fa4&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-de915fa4\"]])\n\nexport default __exports__","import { render } from \"./MemoryEditor.vue?vue&type=template&id=e3fd84b0&scoped=true&ts=true\"\nimport script from \"./MemoryEditor.vue?vue&type=script&lang=ts\"\nexport * from \"./MemoryEditor.vue?vue&type=script&lang=ts\"\n\nimport \"./MemoryEditor.vue?vue&type=style&index=0&id=e3fd84b0&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-e3fd84b0\"]])\n\nexport default __exports__","import { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, resolveComponent as _resolveComponent, createBlock as _createBlock, normalizeStyle as _normalizeStyle, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, createCommentVNode as _createCommentVNode, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-180b5606\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"stud5p-task\" }\nconst _hoisted_2 = {\n  key: 0,\n  style: {\"display\":\"flex\",\"flex-direction\":\"column\",\"align-items\":\"flex-start\",\"gap\":\"0.25em\",\"padding-top\":\"1em\",\"padding-bottom\":\"0.5em\"}\n}\nconst _hoisted_3 = [\"textContent\"]\nconst _hoisted_4 = [\"textContent\"]\nconst _hoisted_5 = [\"textContent\"]\nconst _hoisted_6 = [\"textContent\"]\nconst _hoisted_7 = [\"textContent\"]\nconst _hoisted_8 = [\"textContent\"]\nconst _hoisted_9 = {\n  key: 0,\n  class: \"result-message\"\n}\nconst _hoisted_10 = { class: \"button-panel\" }\nconst _hoisted_11 = [\"textContent\"]\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_MemoryViewerCard = _resolveComponent(\"MemoryViewerCard\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createElementVNode(\"div\", {\n      class: \"memory-grid\",\n      style: _normalizeStyle({\n        gridTemplateColumns: _ctx.gridTemplateColumns,\n        gridTemplateRows: _ctx.gridTemplateRows,\n      })\n    }, [\n      (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(this.cards, (card) => {\n        return (_openBlock(), _createBlock(_component_MemoryViewerCard, {\n          key: card.id,\n          card: card,\n          flipside: _ctx.task.flipside,\n          onClick: ($event: any) => (_ctx.onClickCard(card))\n        }, null, 8, [\"card\", \"flipside\", \"onClick\"]))\n      }), 128))\n    ], 4),\n    (_ctx.isPlayable)\n      ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n          _createElementVNode(\"div\", null, [\n            _createElementVNode(\"span\", {\n              class: \"memory-info-header\",\n              textContent: _toDisplayString(_ctx.$gettext('Zeit:'))\n            }, null, 8, _hoisted_3),\n            _createElementVNode(\"span\", {\n              textContent: _toDisplayString(\n            ' ' +\n            _ctx.$gettext('%{ time } Sekunden', {\n              time: this.timer.toString(),\n            })\n          )\n            }, null, 8, _hoisted_4)\n          ]),\n          _createElementVNode(\"div\", null, [\n            _createElementVNode(\"span\", {\n              class: \"memory-info-header\",\n              textContent: _toDisplayString(_ctx.$gettext('Umgedrehte Karten:'))\n            }, null, 8, _hoisted_5),\n            _createElementVNode(\"span\", {\n              textContent: _toDisplayString(' ' + this.amountOfFlips.toString())\n            }, null, 8, _hoisted_6)\n          ]),\n          _createElementVNode(\"div\", null, [\n            _createElementVNode(\"span\", {\n              class: \"memory-info-header\",\n              textContent: _toDisplayString(_ctx.$gettext('Aufgedeckte Paare:'))\n            }, null, 8, _hoisted_7),\n            _createElementVNode(\"span\", {\n              textContent: _toDisplayString(\n            ' ' +\n            _ctx.$gettext('%{ amountOfPairsSolved } von %{ totalAmountOfPairs }', {\n              amountOfPairsSolved: this.amountOfPairsSolved.toString(),\n              totalAmountOfPairs: this.totalAmountOfPairs.toString(),\n            })\n          )\n            }, null, 8, _hoisted_8)\n          ]),\n          (_ctx.showResults)\n            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_9, _toDisplayString(this.resultMessage), 1))\n            : _createCommentVNode(\"\", true)\n        ]))\n      : _createCommentVNode(\"\", true),\n    _createElementVNode(\"div\", _hoisted_10, [\n      (_ctx.showRetryButton)\n        ? (_openBlock(), _createElementBlock(\"button\", {\n            key: 0,\n            textContent: _toDisplayString(this.task.strings.retryButton),\n            onClick: _cache[0] || (_cache[0] = \n//@ts-ignore\n(...args) => (_ctx.onClickTryAgain && _ctx.onClickTryAgain(...args))),\n            type: \"button\",\n            class: \"stud5p-button\"\n          }, null, 8, _hoisted_11))\n        : _createCommentVNode(\"\", true)\n    ])\n  ]))\n}","<template>\n  <div class=\"stud5p-task\">\n    <div\n      class=\"memory-grid\"\n      :style=\"{\n        gridTemplateColumns: gridTemplateColumns,\n        gridTemplateRows: gridTemplateRows,\n      }\"\n    >\n      <template v-for=\"card in this.cards\" :key=\"card.id\">\n        <MemoryViewerCard\n          :card=\"card\"\n          :flipside=\"task.flipside\"\n          @click=\"onClickCard(card)\"\n        />\n      </template>\n    </div>\n\n    <div\n      v-if=\"isPlayable\"\n      style=\"\n        display: flex;\n        flex-direction: column;\n        align-items: flex-start;\n        gap: 0.25em;\n        padding-top: 1em;\n        padding-bottom: 0.5em;\n      \"\n    >\n      <div>\n        <span class=\"memory-info-header\" v-text=\"$gettext('Zeit:')\" />\n        <span\n          v-text=\"\n            ' ' +\n            $gettext('%{ time } Sekunden', {\n              time: this.timer.toString(),\n            })\n          \"\n        />\n      </div>\n\n      <div>\n        <span\n          class=\"memory-info-header\"\n          v-text=\"$gettext('Umgedrehte Karten:')\"\n        />\n        <span v-text=\"' ' + this.amountOfFlips.toString()\" />\n      </div>\n\n      <div>\n        <span\n          class=\"memory-info-header\"\n          v-text=\"$gettext('Aufgedeckte Paare:')\"\n        />\n        <span\n          v-text=\"\n            ' ' +\n            $gettext('%{ amountOfPairsSolved } von %{ totalAmountOfPairs }', {\n              amountOfPairsSolved: this.amountOfPairsSolved.toString(),\n              totalAmountOfPairs: this.totalAmountOfPairs.toString(),\n            })\n          \"\n        />\n      </div>\n\n      <div v-if=\"showResults\" class=\"result-message\">\n        {{ this.resultMessage }}\n      </div>\n    </div>\n\n    <div class=\"button-panel\">\n      <button\n        v-if=\"showRetryButton\"\n        v-text=\"this.task.strings.retryButton\"\n        @click=\"onClickTryAgain\"\n        type=\"button\"\n        class=\"stud5p-button\"\n      />\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, PropType } from 'vue';\nimport {\n  MemoryTask,\n  LernmoduleMultimediaElement,\n} from '@/models/TaskDefinition';\nimport { $gettext } from '@/language/gettext';\nimport MemoryViewerCard from '@/components/MemoryViewerCard.vue';\nimport { v4 } from 'uuid';\n\nexport interface ViewerMemoryCard {\n  uuid: string;\n  type: string;\n  file_id: string | undefined;\n  altText: string | undefined;\n  content: string | undefined;\n  flipped: boolean;\n  solved: boolean;\n  matchingCardId: string | undefined;\n}\n\nexport default defineComponent({\n  name: 'MemoryViewer',\n  components: { MemoryViewerCard },\n  emits: ['updateAttempt'],\n  props: {\n    task: {\n      type: Object as PropType<MemoryTask>,\n      required: true,\n    },\n  },\n  data() {\n    return {\n      cards: [] as ViewerMemoryCard[],\n      firstFlippedCardId: undefined as string | undefined,\n      firstFlippedCardMatchingCardId: undefined as string | undefined,\n      amountOfFlips: 0 as number,\n\n      timer: 0, // Track elapsed time in seconds\n      timerStarted: false, // Flag to check if timer has started\n      timerInterval: null as number | null, // Store interval ID to control timer\n    };\n  },\n  methods: {\n    $gettext,\n\n    onClickCard(card: ViewerMemoryCard): void {\n      // do nothing if card is already open\n      if (card.flipped) return;\n\n      card.flipped = true;\n\n      // Start timer\n      if (!this.timerStarted) {\n        this.startTimer();\n      }\n\n      this.amountOfFlips++;\n\n      if (!this.firstFlippedCardId) {\n        // This is the first of two cards to be flipped around\n        // Reset all previous unsuccessful cardflips except the card we just flipped\n        this.resetAllUnsolvedCardsExcept(card.uuid);\n\n        this.firstFlippedCardId = card.uuid;\n        this.firstFlippedCardMatchingCardId = card.matchingCardId;\n      } else {\n        // We flipped the second card around, check if we got a pair\n        if (card.matchingCardId === this.firstFlippedCardMatchingCardId) {\n          // We found a pair!\n          // Set both cards' solved attribute to true\n          card.solved = true;\n          const firstCard = this.getCardById(this.firstFlippedCardId);\n          firstCard.solved = true;\n        }\n\n        this.firstFlippedCardId = undefined;\n        this.firstFlippedCardMatchingCardId = undefined;\n      }\n    },\n\n    startTimer() {\n      this.timerStarted = true;\n\n      // Start a timer that increments every second\n      this.timerInterval = setInterval(() => {\n        this.timer++;\n      }, 1000) as unknown as number;\n    },\n\n    stopTimer() {\n      // Stop the timer and clear the interval\n      if (this.timerInterval !== null) {\n        clearInterval(this.timerInterval);\n        this.timerInterval = null; // Reset after clearing\n      }\n\n      this.timerStarted = false;\n    },\n\n    resetAllUnsolvedCardsExcept(exceptionId: string): void {\n      for (const card of this.cards) {\n        if (!card.solved && card.uuid !== exceptionId) {\n          card.flipped = false;\n        }\n      }\n    },\n\n    onClickTryAgain(): void {\n      this.amountOfFlips = 0;\n      this.timer = 0;\n      this.firstFlippedCardId = undefined;\n      this.resetCards();\n      this.shuffleCards();\n    },\n\n    resetCards(): void {\n      // Set all cards' flipped and solved attribute to false\n      for (const card of this.cards) {\n        card.flipped = false;\n        card.solved = false;\n      }\n    },\n\n    shuffleCards(): void {\n      // Shuffle the cards\n      // https://stackoverflow.com/a/46545530\n      this.cards = this.cards\n        .map((card) => ({ card, sort: Math.random() }))\n        .sort((card1, card2) => card1.sort - card2.sort)\n        .map(({ card }) => card);\n    },\n\n    getCardById(cardId: string): ViewerMemoryCard {\n      const card = this.cards.find((card) => card.uuid === cardId);\n      if (!card) {\n        throw new Error('No card found with the given ID: ' + cardId);\n      }\n      return card;\n    },\n\n    createCard(\n      element: LernmoduleMultimediaElement,\n      matchingCardId: string\n    ): ViewerMemoryCard {\n      return {\n        uuid: element.uuid,\n        type: element.type,\n        file_id: element.type !== 'text' ? element.file_id : undefined,\n        altText: element.type !== 'text' ? element.altText : undefined,\n        content: element.type === 'text' ? element.content : undefined,\n        flipped: false,\n        solved: false,\n        matchingCardId,\n      };\n    },\n  },\n\n  computed: {\n    totalAmountOfPairs(): number {\n      return this.task.cards.length;\n    },\n\n    isPlayable(): boolean {\n      for (const card of this.task.cards) {\n        if (\n          (card.first.type === 'image' || card.first.type === 'audio') &&\n          card.first.file_id\n        ) {\n          return true;\n        }\n      }\n      return false;\n    },\n\n    amountOfPairsSolved(): number {\n      let amountOfCardsSolved = 0;\n      for (const card of this.cards) {\n        if (card.solved) amountOfCardsSolved++;\n      }\n      return amountOfCardsSolved / 2;\n    },\n\n    gameIsOver(): boolean {\n      return (\n        this.totalAmountOfPairs > 0 &&\n        this.amountOfPairsSolved === this.totalAmountOfPairs\n      );\n    },\n\n    showResults(): boolean {\n      return this.gameIsOver;\n    },\n\n    showRetryButton(): boolean {\n      return this.gameIsOver;\n    },\n\n    resultMessage(): string {\n      return this.task.strings.resultMessage;\n    },\n\n    gridTemplateColumns(): string {\n      if (this.task.squareLayout) {\n        const columns = Math.ceil(Math.sqrt(this.cards.length));\n        return `repeat(${columns}, 1fr)`;\n      } else {\n        return 'repeat(auto-fill, minmax(12em, 1fr))'; // Responsive behavior\n      }\n    },\n\n    gridTemplateRows(): string {\n      if (this.task.squareLayout) {\n        const rows = Math.ceil(\n          this.cards.length / Math.ceil(Math.sqrt(this.cards.length))\n        );\n        return `repeat(${rows}, 1fr)`;\n      } else {\n        return 'auto'; // For responsive layout, let the rows be created automatically\n      }\n    },\n  },\n  watch: {\n    task: {\n      handler() {\n        console.log('watcher for this.task');\n        this.firstFlippedCardId = undefined;\n        this.amountOfFlips = 0;\n\n        // Generate cards\n        this.cards = this.task.cards.flatMap((card) => {\n          if (!card.second) {\n            // Single card: create original and duplicate\n            const original = this.createCard(card.first, card.uuid);\n            const duplicate = this.createCard(\n              { ...card.first, uuid: v4() },\n              card.uuid\n            );\n            return [original, duplicate];\n          } else {\n            // Paired cards: create first and second\n            const firstCard = this.createCard(card.first, card.uuid);\n            const secondCard = this.createCard(card.second, card.uuid);\n            return [firstCard, secondCard];\n          }\n        });\n\n        // Shuffle the cards\n        this.shuffleCards();\n      },\n      immediate: true, // Ensure that the watcher is also called immediately when the component is first mounted\n    },\n    gameIsOver(newValue) {\n      if (newValue) {\n        this.stopTimer();\n      }\n    },\n  },\n});\n</script>\n\n<style scoped>\n.memory-grid {\n  display: grid;\n  grid-gap: 1.5em;\n  justify-items: center;\n}\n\n.memory-info-header {\n  font-weight: bold;\n}\n\n.result-message {\n  font-weight: bold;\n  font-size: 2em;\n  color: #1a73d9;\n}\n</style>\n","import { resolveComponent as _resolveComponent, createVNode as _createVNode, normalizeClass as _normalizeClass, createElementVNode as _createElementVNode, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, createElementBlock as _createElementBlock, resolveDirective as _resolveDirective, withDirectives as _withDirectives, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\nimport _imports_0 from '../assets/memoryCardBack.png'\n\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-6a6f67ea\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"memory-card-back\" }\nconst _hoisted_2 = [\"alt\"]\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_MultimediaElement = _resolveComponent(\"MultimediaElement\")!\n  const _component_lazy_image = _resolveComponent(\"lazy-image\")!\n  const _directive_disable_drag = _resolveDirective(\"disable-drag\")!\n\n  return _withDirectives((_openBlock(), _createElementBlock(\"button\", {\n    type: \"button\",\n    class: _normalizeClass([\"memory-card no-select\", { flipped: _ctx.card.flipped }])\n  }, [\n    _createElementVNode(\"span\", {\n      class: _normalizeClass([\"memory-card-front\", { 'solved-card': _ctx.card.solved }])\n    }, [\n      _createVNode(_component_MultimediaElement, { element: _ctx.card }, null, 8, [\"element\"])\n    ], 2),\n    _createElementVNode(\"span\", _hoisted_1, [\n      (_ctx.flipside)\n        ? (_openBlock(), _createBlock(_component_lazy_image, {\n            key: 0,\n            src: _ctx.fileIdToUrl(_ctx.flipside.file_id),\n            alt: _ctx.flipside.altText,\n            class: \"memory-card-back-image\"\n          }, null, 8, [\"src\", \"alt\"]))\n        : (_openBlock(), _createElementBlock(\"img\", {\n            key: 1,\n            src: _imports_0,\n            alt: _ctx.$gettext('Rckseite einer Memory Karte.'),\n            class: \"memory-card-back-image\"\n          }, null, 8, _hoisted_2))\n    ])\n  ], 2)), [\n    [_directive_disable_drag]\n  ])\n}","<template>\n  <button\n    type=\"button\"\n    class=\"memory-card no-select\"\n    :class=\"{ flipped: card.flipped }\"\n    v-disable-drag\n  >\n    <span class=\"memory-card-front\" :class=\"{ 'solved-card': card.solved }\">\n      <MultimediaElement :element=\"card\" />\n    </span>\n    <span class=\"memory-card-back\">\n      <lazy-image\n        v-if=\"flipside\"\n        :src=\"fileIdToUrl(flipside.file_id)\"\n        :alt=\"flipside.altText\"\n        class=\"memory-card-back-image\"\n      />\n      <img\n        v-else\n        src=\"../assets/memoryCardBack.png\"\n        :alt=\"$gettext('Rckseite einer Memory Karte.')\"\n        class=\"memory-card-back-image\"\n      />\n    </span>\n  </button>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, PropType } from 'vue';\nimport { ViewerMemoryCard } from '@/components/MemoryViewer.vue';\nimport { fileIdToUrl } from '@/models/TaskDefinition';\nimport LazyImage from '@/components/LazyImage.vue';\nimport { $gettext } from '@/language/gettext';\nimport MultimediaElement from '@/components/MultimediaElement.vue';\nimport { ImageFileElement } from '@/models/common';\n\nexport default defineComponent({\n  name: 'MemoryViewerCard',\n  components: { MultimediaElement, LazyImage },\n  props: {\n    card: {\n      type: Object as PropType<ViewerMemoryCard>,\n      required: true,\n    },\n    flipside: {\n      type: Object as PropType<ImageFileElement>,\n      required: false,\n    },\n  },\n  computed: {},\n  methods: { $gettext, fileIdToUrl },\n});\n</script>\n\n<style scoped>\nbutton {\n  all: unset; /* Reset browser styles for all buttons in this component */\n}\n\n.memory-card {\n  width: 11em;\n  height: 11em;\n\n  position: relative;\n\n  display: flex;\n  justify-content: center;\n  align-items: center;\n\n  border: 2px solid #dbe2e8;\n  border-radius: 0.5em;\n  background: white;\n\n  padding: 0.5em;\n  margin: 0;\n\n  transform-style: preserve-3d;\n  perspective: 1000px;\n\n  transition: transform 0.48s ease-in-out, box-shadow 0.24s ease-in-out;\n}\n\n.flipped {\n  transform: rotate3d(0, 1, 0, 180deg);\n}\n\n.memory-card-front,\n.memory-card-back {\n  width: 11em;\n  height: 11em;\n\n  position: absolute;\n\n  display: flex;\n  justify-content: center;\n  align-items: center;\n\n  backface-visibility: hidden;\n  overflow: hidden;\n}\n\n.memory-card-front {\n  transform: rotateY(180deg); /* Start rotated, flipped with the back side */\n}\n\n.memory-card-back {\n  transform: rotateY(0deg); /* Back side is initially visible */\n}\n\n.memory-card-back-image {\n  height: 100%;\n  width: 100%;\n  object-fit: contain;\n\n  border-radius: 0.25em;\n}\n\n.memory-card:not(.flipped):hover {\n  cursor: grab;\n  border: 2px solid #7ba4d3;\n  box-shadow: 0 0 10px 0 #406ef3;\n}\n\n.solved-card {\n  animation: foundPairEffect 1s ease-in-out;\n  animation-fill-mode: forwards; /* Ensures final state persists */\n}\n\n@keyframes foundPairEffect {\n  50% {\n    opacity: 1;\n  }\n  100% {\n    opacity: 0.6;\n  }\n}\n</style>\n","import { render } from \"./MemoryViewerCard.vue?vue&type=template&id=6a6f67ea&scoped=true&ts=true\"\nimport script from \"./MemoryViewerCard.vue?vue&type=script&lang=ts\"\nexport * from \"./MemoryViewerCard.vue?vue&type=script&lang=ts\"\n\nimport \"./MemoryViewerCard.vue?vue&type=style&index=0&id=6a6f67ea&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-6a6f67ea\"]])\n\nexport default __exports__","import { render } from \"./MemoryViewer.vue?vue&type=template&id=180b5606&scoped=true&ts=true\"\nimport script from \"./MemoryViewer.vue?vue&type=script&lang=ts\"\nexport * from \"./MemoryViewer.vue?vue&type=script&lang=ts\"\n\nimport \"./MemoryViewer.vue?vue&type=style&index=0&id=180b5606&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-180b5606\"]])\n\nexport default __exports__","import { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, resolveComponent as _resolveComponent, normalizeClass as _normalizeClass, createBlock as _createBlock, normalizeStyle as _normalizeStyle, createVNode as _createVNode, createCommentVNode as _createCommentVNode, vModelCheckbox as _vModelCheckbox, withDirectives as _withDirectives, createTextVNode as _createTextVNode, vModelText as _vModelText, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-70d5756a\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"stud5p-task\" }\nconst _hoisted_2 = { class: \"default\" }\nconst _hoisted_3 = { class: \"pairing-editor\" }\nconst _hoisted_4 = { class: \"pairs-overview\" }\nconst _hoisted_5 = {\n  key: 0,\n  class: \"selected-pair\"\n}\nconst _hoisted_6 = { class: \"remove-pair-button-container\" }\nconst _hoisted_7 = [\"textContent\"]\nconst _hoisted_8 = { class: \"collapsable collapsed\" }\nconst _hoisted_9 = { class: \"collapsable collapsed\" }\nconst _hoisted_10 = [\"disabled\"]\nconst _hoisted_11 = [\"disabled\"]\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_PairingEditorPair = _resolveComponent(\"PairingEditorPair\")!\n  const _component_PairingEditorCard = _resolveComponent(\"PairingEditorCard\")!\n  const _component_FeedbackEditor = _resolveComponent(\"FeedbackEditor\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createElementVNode(\"form\", _hoisted_2, [\n      _createElementVNode(\"fieldset\", _hoisted_3, [\n        _createElementVNode(\"legend\", null, _toDisplayString(_ctx.$gettext('Pairing')), 1),\n        _createElementVNode(\"div\", _hoisted_4, [\n          (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.modelTaskDefinition.pairs, (pair, index) => {\n            return (_openBlock(), _createBlock(_component_PairingEditorPair, {\n              key: pair.uuid,\n              class: _normalizeClass({\n              selected: index === _ctx.selectedPairIndex,\n            }),\n              pair: _ctx.modelTaskDefinition.pairs[index],\n              onClick: ($event: any) => (_ctx.onClickPair(index))\n            }, null, 8, [\"class\", \"pair\", \"onClick\"]))\n          }), 128)),\n          _createElementVNode(\"button\", {\n            type: \"button\",\n            class: \"add-pair-button\",\n            onClick: _cache[0] || (_cache[0] = ($event: any) => (_ctx.onClickAddPair())),\n            style: _normalizeStyle(_ctx.addPairButtonBackgroundImage)\n          }, null, 4)\n        ]),\n        (_ctx.selectedPair)\n          ? (_openBlock(), _createElementBlock(\"fieldset\", _hoisted_5, [\n              _createElementVNode(\"legend\", null, _toDisplayString(_ctx.$gettext('Paar')), 1),\n              _createVNode(_component_PairingEditorCard, {\n                title: _ctx.$gettext('Karte 1'),\n                \"multimedia-element\": _ctx.selectedPair.draggableElement,\n                onElementChanged: _ctx.onChangeDraggableElement\n              }, null, 8, [\"title\", \"multimedia-element\", \"onElementChanged\"]),\n              _createVNode(_component_PairingEditorCard, {\n                title: _ctx.$gettext('Karte 2'),\n                \"multimedia-element\": _ctx.selectedPair.targetElement,\n                onElementChanged: _ctx.onChangeTargetElement\n              }, null, 8, [\"title\", \"multimedia-element\", \"onElementChanged\"]),\n              _createElementVNode(\"div\", _hoisted_6, [\n                _createElementVNode(\"button\", {\n                  type: \"button\",\n                  onClick: _cache[1] || (_cache[1] = ($event: any) => (_ctx.onClickDeletePair(_ctx.selectedPairIndex))),\n                  textContent: _toDisplayString(_ctx.$gettext('Paar lschen')),\n                  class: \"button trash remove-pair-button\"\n                }, null, 8, _hoisted_7)\n              ])\n            ]))\n          : _createCommentVNode(\"\", true)\n      ]),\n      _createElementVNode(\"fieldset\", _hoisted_8, [\n        _createElementVNode(\"legend\", null, _toDisplayString(_ctx.$gettext('Einstellungen')), 1),\n        _createElementVNode(\"label\", null, [\n          _withDirectives(_createElementVNode(\"input\", {\n            \"onUpdate:modelValue\": _cache[2] || (_cache[2] = ($event: any) => ((_ctx.modelTaskDefinition.retryAllowed) = $event)),\n            onChange: _cache[3] || (_cache[3] = \n//@ts-ignore\n(...args) => (_ctx.updateTaskDefinition && _ctx.updateTaskDefinition(...args))),\n            type: \"checkbox\"\n          }, null, 544), [\n            [_vModelCheckbox, _ctx.modelTaskDefinition.retryAllowed]\n          ]),\n          _createTextVNode(\" \" + _toDisplayString(_ctx.$gettext('Mehrere Versuche erlauben')), 1)\n        ]),\n        _createElementVNode(\"label\", null, [\n          _withDirectives(_createElementVNode(\"input\", {\n            \"onUpdate:modelValue\": _cache[4] || (_cache[4] = ($event: any) => ((_ctx.modelTaskDefinition.showSolutionsAllowed) = $event)),\n            onChange: _cache[5] || (_cache[5] = \n//@ts-ignore\n(...args) => (_ctx.updateTaskDefinition && _ctx.updateTaskDefinition(...args))),\n            type: \"checkbox\"\n          }, null, 544), [\n            [_vModelCheckbox, _ctx.modelTaskDefinition.showSolutionsAllowed]\n          ]),\n          _createTextVNode(\" \" + _toDisplayString(_ctx.$gettext('Lsungen anzeigen erlauben')), 1)\n        ])\n      ]),\n      _createElementVNode(\"fieldset\", _hoisted_9, [\n        _createElementVNode(\"legend\", null, _toDisplayString(_ctx.$gettext('Beschriftungen')), 1),\n        _createElementVNode(\"label\", null, [\n          _createTextVNode(_toDisplayString(_ctx.$gettext('Text fr berprfen-Button:')) + \" \", 1),\n          _withDirectives(_createElementVNode(\"input\", {\n            \"onUpdate:modelValue\": _cache[6] || (_cache[6] = ($event: any) => ((_ctx.modelTaskDefinition.strings.checkButton) = $event)),\n            onInput: _cache[7] || (_cache[7] = ($event: any) => (_ctx.updateTaskDefinition('taskDefinition.strings.checkButton'))),\n            type: \"text\"\n          }, null, 544), [\n            [_vModelText, _ctx.modelTaskDefinition.strings.checkButton]\n          ])\n        ]),\n        _createElementVNode(\"label\", {\n          class: _normalizeClass({ 'setting-disabled': !_ctx.modelTaskDefinition.retryAllowed })\n        }, [\n          _createTextVNode(_toDisplayString(_ctx.$gettext('Text fr Wiederholen-Button:')) + \" \", 1),\n          _withDirectives(_createElementVNode(\"input\", {\n            \"onUpdate:modelValue\": _cache[8] || (_cache[8] = ($event: any) => ((_ctx.modelTaskDefinition.strings.retryButton) = $event)),\n            onInput: _cache[9] || (_cache[9] = ($event: any) => (_ctx.updateTaskDefinition('taskDefinition.strings.retryButton'))),\n            disabled: !_ctx.modelTaskDefinition.retryAllowed,\n            type: \"text\"\n          }, null, 40, _hoisted_10), [\n            [_vModelText, _ctx.modelTaskDefinition.strings.retryButton]\n          ])\n        ], 2),\n        _createElementVNode(\"label\", {\n          class: _normalizeClass({\n            'setting-disabled': !_ctx.modelTaskDefinition.showSolutionsAllowed,\n          })\n        }, [\n          _createTextVNode(_toDisplayString(_ctx.$gettext('Text fr Lsungen-Button:')) + \" \", 1),\n          _withDirectives(_createElementVNode(\"input\", {\n            \"onUpdate:modelValue\": _cache[10] || (_cache[10] = ($event: any) => ((_ctx.modelTaskDefinition.strings.solutionsButton) = $event)),\n            onInput: _cache[11] || (_cache[11] = ($event: any) => (\n              _ctx.updateTaskDefinition('taskDefinition.strings.solutionsButton')\n            )),\n            disabled: !_ctx.modelTaskDefinition.showSolutionsAllowed,\n            type: \"text\"\n          }, null, 40, _hoisted_11), [\n            [_vModelText, _ctx.modelTaskDefinition.strings.solutionsButton]\n          ])\n        ], 2)\n      ]),\n      _createVNode(_component_FeedbackEditor, {\n        feedback: _ctx.modelTaskDefinition.feedback,\n        \"result-message\": _ctx.modelTaskDefinition.strings.resultMessage,\n        \"onUpdate:feedback\": _ctx.updateFeedback,\n        \"onUpdate:resultMessage\": _ctx.updateResultMessage\n      }, null, 8, [\"feedback\", \"result-message\", \"onUpdate:feedback\", \"onUpdate:resultMessage\"])\n    ])\n  ]))\n}","<template>\n  <div class=\"stud5p-task\">\n    <form class=\"default\">\n      <fieldset class=\"pairing-editor\">\n        <legend>{{ $gettext('Pairing') }}</legend>\n\n        <div class=\"pairs-overview\">\n          <PairingEditorPair\n            v-for=\"(pair, index) in modelTaskDefinition.pairs\"\n            :key=\"pair.uuid\"\n            :class=\"{\n              selected: index === selectedPairIndex,\n            }\"\n            :pair=\"modelTaskDefinition.pairs[index]\"\n            @click=\"onClickPair(index)\"\n          />\n\n          <button\n            type=\"button\"\n            class=\"add-pair-button\"\n            @click=\"onClickAddPair()\"\n            :style=\"addPairButtonBackgroundImage\"\n          />\n        </div>\n\n        <fieldset v-if=\"selectedPair\" class=\"selected-pair\">\n          <legend>{{ $gettext('Paar') }}</legend>\n\n          <PairingEditorCard\n            :title=\"$gettext('Karte 1')\"\n            :multimedia-element=\"selectedPair.draggableElement\"\n            @element-changed=\"onChangeDraggableElement\"\n          />\n\n          <PairingEditorCard\n            :title=\"$gettext('Karte 2')\"\n            :multimedia-element=\"selectedPair.targetElement\"\n            @element-changed=\"onChangeTargetElement\"\n          />\n\n          <div class=\"remove-pair-button-container\">\n            <button\n              type=\"button\"\n              @click=\"onClickDeletePair(selectedPairIndex)\"\n              v-text=\"$gettext('Paar lschen')\"\n              class=\"button trash remove-pair-button\"\n            />\n          </div>\n        </fieldset>\n      </fieldset>\n\n      <fieldset class=\"collapsable collapsed\">\n        <legend>{{ $gettext('Einstellungen') }}</legend>\n\n        <label>\n          <input\n            v-model=\"modelTaskDefinition.retryAllowed\"\n            @change=\"updateTaskDefinition\"\n            type=\"checkbox\"\n          />\n          {{ $gettext('Mehrere Versuche erlauben') }}\n        </label>\n\n        <label>\n          <input\n            v-model=\"modelTaskDefinition.showSolutionsAllowed\"\n            @change=\"updateTaskDefinition\"\n            type=\"checkbox\"\n          />\n          {{ $gettext('Lsungen anzeigen erlauben') }}\n        </label>\n      </fieldset>\n\n      <fieldset class=\"collapsable collapsed\">\n        <legend>{{ $gettext('Beschriftungen') }}</legend>\n\n        <label>\n          {{ $gettext('Text fr berprfen-Button:') }}\n          <input\n            v-model=\"modelTaskDefinition.strings.checkButton\"\n            @input=\"updateTaskDefinition('taskDefinition.strings.checkButton')\"\n            type=\"text\"\n          />\n        </label>\n\n        <label\n          :class=\"{ 'setting-disabled': !modelTaskDefinition.retryAllowed }\"\n        >\n          {{ $gettext('Text fr Wiederholen-Button:') }}\n          <input\n            v-model=\"modelTaskDefinition.strings.retryButton\"\n            @input=\"updateTaskDefinition('taskDefinition.strings.retryButton')\"\n            :disabled=\"!modelTaskDefinition.retryAllowed\"\n            type=\"text\"\n          />\n        </label>\n\n        <label\n          :class=\"{\n            'setting-disabled': !modelTaskDefinition.showSolutionsAllowed,\n          }\"\n        >\n          {{ $gettext('Text fr Lsungen-Button:') }}\n          <input\n            v-model=\"modelTaskDefinition.strings.solutionsButton\"\n            @input=\"\n              updateTaskDefinition('taskDefinition.strings.solutionsButton')\n            \"\n            :disabled=\"!modelTaskDefinition.showSolutionsAllowed\"\n            type=\"text\"\n          />\n        </label>\n      </fieldset>\n\n      <FeedbackEditor\n        :feedback=\"modelTaskDefinition.feedback\"\n        :result-message=\"modelTaskDefinition.strings.resultMessage\"\n        @update:feedback=\"updateFeedback\"\n        @update:result-message=\"updateResultMessage\"\n      />\n    </form>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, inject, PropType } from 'vue';\nimport {\n  fileIdToUrl,\n  LernmoduleMultimediaElement,\n  Pair,\n  PairingTask,\n} from '@/models/TaskDefinition';\nimport { Feedback } from '@/models/common';\nimport { $gettext } from '@/language/gettext';\nimport produce from 'immer';\nimport { v4 } from 'uuid';\nimport PairingEditorPair from '@/components/PairingEditorPair.vue';\nimport PairingEditorCard from '@/components/PairingEditorCard.vue';\nimport FeedbackEditor from '@/components/FeedbackEditor.vue';\nimport {\n  TaskEditorState,\n  taskEditorStateSymbol,\n} from '@/components/taskEditorState';\nimport { cloneDeep } from 'lodash';\n\nexport default defineComponent({\n  name: 'PairingEditor',\n  setup() {\n    return {\n      taskEditor: inject<TaskEditorState>(taskEditorStateSymbol),\n    };\n  },\n  components: {\n    PairingEditorPair,\n    PairingEditorCard,\n    FeedbackEditor,\n  },\n  props: {\n    taskDefinition: {\n      type: Object as PropType<PairingTask>,\n      required: true,\n    },\n  },\n  data() {\n    return {\n      modelTaskDefinition: cloneDeep(this.taskDefinition),\n      selectedPairIndex: -1,\n    };\n  },\n  watch: {\n    // Synchronize state taskDefinition -> modelTaskDefinition.\n    taskDefinition: {\n      immediate: true,\n      handler: function (): void {\n        this.modelTaskDefinition = cloneDeep(this.taskDefinition);\n      },\n    },\n  },\n  beforeMount(): void {\n    if (this.taskDefinition.pairs.length > 0) {\n      this.selectedPairIndex = 0;\n    }\n  },\n  methods: {\n    fileIdToUrl,\n\n    $gettext,\n\n    urlForIcon(iconName: string) {\n      return (\n        window.STUDIP.ASSETS_URL + 'images/icons/blue/' + iconName + '.svg'\n      );\n    },\n\n    updateTaskDefinition(undoBatch?: unknown) {\n      // Synchronize state modelTaskDefinition -> taskDefinition.\n      this.taskEditor!.performEdit({\n        newTaskDefinition: cloneDeep(this.modelTaskDefinition),\n        undoBatch: undoBatch ?? {},\n      });\n    },\n\n    onClickPair(index: number) {\n      this.selectedPairIndex = index;\n    },\n\n    onClickAddPair() {\n      this.modelTaskDefinition = produce(this.modelTaskDefinition, (draft) => {\n        draft.pairs.push({\n          uuid: v4(),\n          draggableElement: {\n            uuid: v4(),\n            type: 'image',\n            file_id: '',\n            altText: '',\n          },\n          targetElement: {\n            uuid: v4(),\n            type: 'image',\n            file_id: '',\n            altText: '',\n          },\n        });\n      });\n\n      this.updateTaskDefinition();\n\n      // Select the newly inserted card\n      this.selectedPairIndex = this.modelTaskDefinition.pairs.length - 1;\n    },\n\n    onClickDeletePair(index: number) {\n      this.modelTaskDefinition = produce(this.modelTaskDefinition, (draft) => {\n        draft.pairs.splice(index, 1);\n      });\n\n      this.updateTaskDefinition();\n\n      // Adjust the selection index so the selected card doesn't unexpectedly change\n      if (this.modelTaskDefinition.pairs.length === 0) {\n        this.selectedPairIndex = -1;\n      } else if (index <= this.selectedPairIndex) {\n        this.selectedPairIndex = Math.max(0, this.selectedPairIndex - 1);\n      }\n    },\n\n    onChangeDraggableElement(payload: {\n      updatedElement: LernmoduleMultimediaElement;\n      undoBatch?: unknown;\n    }): void {\n      this.modelTaskDefinition = produce(this.modelTaskDefinition, (draft) => {\n        draft.pairs[this.selectedPairIndex].draggableElement =\n          payload.updatedElement;\n      });\n\n      this.updateTaskDefinition(payload.undoBatch);\n    },\n\n    onChangeTargetElement(payload: {\n      updatedElement: LernmoduleMultimediaElement;\n      undoBatch?: unknown;\n    }): void {\n      this.modelTaskDefinition = produce(this.modelTaskDefinition, (draft) => {\n        draft.pairs[this.selectedPairIndex].targetElement =\n          payload.updatedElement;\n      });\n\n      this.updateTaskDefinition(payload.undoBatch);\n    },\n\n    updateFeedback(updatedFeedback: Feedback[]) {\n      this.taskEditor!.performEdit({\n        newTaskDefinition: produce(\n          this.modelTaskDefinition,\n          (taskDraft: PairingTask) => {\n            taskDraft.feedback = updatedFeedback;\n          }\n        ),\n        undoBatch: 'taskDefinition.feedback',\n      });\n    },\n\n    updateResultMessage(updatedResultMessage: string) {\n      this.taskEditor!.performEdit({\n        newTaskDefinition: produce(\n          this.modelTaskDefinition,\n          (taskDraft: PairingTask) => {\n            taskDraft.strings.resultMessage = updatedResultMessage;\n          }\n        ),\n        undoBatch: 'taskDefinition.strings.resultMessage',\n      });\n    },\n  },\n  computed: {\n    debug: () => window.STUDIP.LernmoduleVueJS.LERNMODULE_DEBUG,\n\n    selectedPair(): Pair | undefined {\n      return this.modelTaskDefinition.pairs[this.selectedPairIndex];\n    },\n\n    addPairButtonBackgroundImage() {\n      return {\n        backgroundImage: `url(${this.urlForIcon('add')})`,\n      };\n    },\n  },\n});\n</script>\n\n<style scoped>\n.pairing-editor {\n  display: flex;\n  gap: 1em;\n}\n\n.pairs-overview {\n  flex-grow: 1;\n  /* Adapted from https://stackoverflow.com/a/46099319/7359454 */\n  display: grid;\n  /* 8em fixed width image + 2 x 0.25em padding + 2 x 0.125em border */\n  grid-template-columns: repeat(auto-fill, 8.75em);\n  /* 2 x 8em fixed height images + 0.25em gap + 2 x 0.25em padding + 2 x 0.125em border */\n  grid-auto-rows: 17em;\n  justify-content: space-around;\n  row-gap: 1em;\n  column-gap: 0.5em;\n}\n\n.selected-pair {\n  flex-grow: 0;\n  flex-shrink: 0;\n  width: 275px;\n}\n\n.add-pair-button {\n  aspect-ratio: 1;\n\n  border: solid 2px rgba(0, 0, 0, 0);\n  border-radius: 0.25em;\n\n  background-size: 40%;\n  background-repeat: no-repeat;\n  background-position: center;\n\n  cursor: pointer;\n}\n\n.add-pair-button:hover {\n  filter: brightness(0.9);\n}\n\n.remove-pair-button {\n  margin-right: 0;\n}\n\n.remove-pair-button-container {\n  text-align: end;\n  margin-top: 0.5em;\n}\n</style>\n","import { resolveComponent as _resolveComponent, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, createElementBlock as _createElementBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-c8b6ce94\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = {\n  type: \"button\",\n  class: \"pairing-editor-pair\"\n}\nconst _hoisted_2 = { class: \"pair-element\" }\nconst _hoisted_3 = { class: \"pair-element\" }\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_MultimediaElement = _resolveComponent(\"MultimediaElement\")!\n\n  return (_openBlock(), _createElementBlock(\"button\", _hoisted_1, [\n    _createElementVNode(\"span\", _hoisted_2, [\n      (_ctx.pair.draggableElement)\n        ? (_openBlock(), _createBlock(_component_MultimediaElement, {\n            key: 0,\n            element: _ctx.pair.draggableElement\n          }, null, 8, [\"element\"]))\n        : _createCommentVNode(\"\", true)\n    ]),\n    _createElementVNode(\"span\", _hoisted_3, [\n      (_ctx.pair.targetElement)\n        ? (_openBlock(), _createBlock(_component_MultimediaElement, {\n            key: 0,\n            element: _ctx.pair.targetElement\n          }, null, 8, [\"element\"]))\n        : _createCommentVNode(\"\", true)\n    ])\n  ]))\n}","<template>\n  <button type=\"button\" class=\"pairing-editor-pair\">\n    <span class=\"pair-element\">\n      <MultimediaElement\n        v-if=\"pair.draggableElement\"\n        :element=\"pair.draggableElement\"\n      />\n    </span>\n    <span class=\"pair-element\">\n      <MultimediaElement\n        v-if=\"pair.targetElement\"\n        :element=\"pair.targetElement\"\n      />\n    </span>\n  </button>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, PropType } from 'vue';\nimport { $gettext } from '@/language/gettext';\nimport { Pair } from '@/models/TaskDefinition';\nimport MultimediaElement from '@/components/MultimediaElement.vue';\n\nexport default defineComponent({\n  name: 'PairingEditorPair',\n  components: { MultimediaElement },\n  props: {\n    pair: {\n      type: Object as PropType<Pair>,\n      required: true,\n    },\n  },\n  methods: {\n    $gettext,\n  },\n});\n</script>\n\n<style scoped>\n.pairing-editor-pair {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: space-between;\n\n  border: 2px solid #dbe2e8;\n  border-radius: 0.5em;\n  background: white;\n\n  padding: 0.25em;\n  margin: 0;\n\n  overflow: hidden;\n\n  cursor: pointer;\n}\n\n.pairing-editor-pair.selected {\n  border: 2px solid #7ba4d3;\n  box-shadow: 0 0 10px 0 #406ef3;\n}\n\n.pairing-editor-pair:not(.disabled):not(.selected):hover {\n  border: 2px solid #7ba4d3;\n  box-shadow: 0 0 10px 0 #406ef3;\n}\n\n.pair-element {\n  width: 8em;\n  height: 8em;\n\n  display: flex;\n  align-items: center;\n  justify-content: center;\n\n  overflow: hidden;\n}\n</style>\n","import { render } from \"./PairingEditorPair.vue?vue&type=template&id=c8b6ce94&scoped=true&ts=true\"\nimport script from \"./PairingEditorPair.vue?vue&type=script&lang=ts\"\nexport * from \"./PairingEditorPair.vue?vue&type=script&lang=ts\"\n\nimport \"./PairingEditorPair.vue?vue&type=style&index=0&id=c8b6ce94&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-c8b6ce94\"]])\n\nexport default __exports__","import { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, createTextVNode as _createTextVNode, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-5df590ee\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"pairing-editor-card\" }\nconst _hoisted_2 = {\n  key: 0,\n  class: \"multimedia-element-container\"\n}\nconst _hoisted_3 = { class: \"multimedia-element-wrapper\" }\nconst _hoisted_4 = [\"textContent\"]\nconst _hoisted_5 = {\n  key: 1,\n  class: \"pairing-file-upload\"\n}\nconst _hoisted_6 = { style: {\"align-self\":\"stretch\"} }\nconst _hoisted_7 = [\"value\"]\nconst _hoisted_8 = { key: 1 }\nconst _hoisted_9 = { style: {\"align-self\":\"stretch\"} }\nconst _hoisted_10 = [\"value\"]\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_MultimediaElement = _resolveComponent(\"MultimediaElement\")!\n  const _component_FileUpload = _resolveComponent(\"FileUpload\")!\n\n  return (_openBlock(), _createElementBlock(\"fieldset\", _hoisted_1, [\n    _createElementVNode(\"legend\", null, _toDisplayString(_ctx.title), 1),\n    (_ctx.multimediaElement.type == 'image')\n      ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n          (_ctx.multimediaElement.file_id)\n            ? (_openBlock(), _createElementBlock(_Fragment, { key: 0 }, [\n                _createElementVNode(\"div\", _hoisted_3, [\n                  _createVNode(_component_MultimediaElement, { element: _ctx.multimediaElement }, null, 8, [\"element\"])\n                ]),\n                _createElementVNode(\"button\", {\n                  type: \"button\",\n                  onClick: _cache[0] || (_cache[0] = ($event: any) => (_ctx.onClickRemoveImage())),\n                  textContent: _toDisplayString(_ctx.$gettext('Bild lschen')),\n                  class: \"button trash element-pair-settings-item\"\n                }, null, 8, _hoisted_4)\n              ], 64))\n            : (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [\n                _createVNode(_component_FileUpload, {\n                  onFileUploaded: _cache[1] || (_cache[1] = ($event: any) => (_ctx.onUploadImage($event)))\n                })\n              ])),\n          _createElementVNode(\"label\", _hoisted_6, [\n            _createTextVNode(_toDisplayString(_ctx.$gettext('Bildbeschreibung')) + \" \", 1),\n            _createElementVNode(\"input\", {\n              type: \"text\",\n              value: _ctx.multimediaElement.altText,\n              onInput: _cache[2] || (_cache[2] = ($event: any) => (_ctx.onInputAltText($event))),\n              class: \"element-pair-settings-item\"\n            }, null, 40, _hoisted_7)\n          ])\n        ]))\n      : (_ctx.multimediaElement.type == 'text')\n        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_8, [\n            _createElementVNode(\"label\", _hoisted_9, [\n              _createTextVNode(_toDisplayString(_ctx.$gettext('Inhalt')) + \" \", 1),\n              _createElementVNode(\"textarea\", {\n                type: \"text\",\n                value: _ctx.multimediaElement.content,\n                onInput: _cache[3] || (_cache[3] = ($event: any) => (_ctx.onInputContent($event))),\n                class: \"element-pair-settings-item\"\n              }, null, 40, _hoisted_10)\n            ])\n          ]))\n        : _createCommentVNode(\"\", true)\n  ]))\n}","<template>\n  <fieldset class=\"pairing-editor-card\">\n    <legend>{{ title }}</legend>\n\n    <!--    <label>\n      {{ $gettext('Typ') }}\n      <select :value=\"multimediaElement.type\" @change=\"onChangeType($event)\">\n        <option :value=\"'image'\">\n          {{ $gettext('Bild') }}\n        </option>\n        <option :value=\"'text'\">\n          {{ $gettext('Text') }}\n        </option>\n      </select>\n    </label>-->\n\n    <div\n      v-if=\"multimediaElement.type == 'image'\"\n      class=\"multimedia-element-container\"\n    >\n      <template v-if=\"multimediaElement.file_id\">\n        <div class=\"multimedia-element-wrapper\">\n          <MultimediaElement :element=\"multimediaElement\" />\n        </div>\n        <button\n          type=\"button\"\n          @click=\"onClickRemoveImage()\"\n          v-text=\"$gettext('Bild lschen')\"\n          class=\"button trash element-pair-settings-item\"\n        />\n      </template>\n      <div v-else class=\"pairing-file-upload\">\n        <FileUpload @file-uploaded=\"onUploadImage($event)\" />\n      </div>\n\n      <label style=\"align-self: stretch\">\n        {{ $gettext('Bildbeschreibung') }}\n        <input\n          type=\"text\"\n          :value=\"multimediaElement.altText\"\n          @input=\"onInputAltText($event)\"\n          class=\"element-pair-settings-item\"\n        />\n      </label>\n    </div>\n\n    <div v-else-if=\"multimediaElement.type == 'text'\">\n      <label style=\"align-self: stretch\">\n        {{ $gettext('Inhalt') }}\n        <textarea\n          type=\"text\"\n          :value=\"multimediaElement.content\"\n          @input=\"onInputContent($event)\"\n          class=\"element-pair-settings-item\"\n        />\n      </label>\n    </div>\n  </fieldset>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, PropType } from 'vue';\nimport {\n  LernmoduleMultimediaElement,\n  MultimediaElementType,\n} from '@/models/TaskDefinition';\nimport { $gettext } from '@/language/gettext';\nimport MultimediaElement from '@/components/MultimediaElement.vue';\nimport FileUpload from '@/components/FileUpload.vue';\nimport { v4 } from 'uuid';\nimport { FileRef } from '@/routes/jsonApi';\nimport { ImageFileElement } from '@/models/common';\n\nexport default defineComponent({\n  name: 'PairingEditorCard',\n  components: { FileUpload, MultimediaElement },\n  props: {\n    title: {\n      type: String,\n      required: true,\n    },\n    multimediaElement: {\n      type: Object as PropType<LernmoduleMultimediaElement>,\n      required: true,\n    },\n  },\n  emits: {\n    elementChanged(payload: {\n      updatedElement: LernmoduleMultimediaElement;\n      undoBatch?: unknown;\n    }) {\n      return true;\n    },\n  },\n  data() {\n    return {};\n  },\n  methods: {\n    $gettext,\n    createNewLernmoduleMultimediaElement(\n      type: MultimediaElementType\n    ): LernmoduleMultimediaElement {\n      switch (type) {\n        case 'image':\n          return {\n            uuid: v4(),\n            type: type,\n            file_id: '',\n            altText: '',\n          };\n        case 'audio':\n          return {\n            uuid: v4(),\n            type: type,\n            file_id: '',\n            altText: '',\n          };\n        case 'text':\n          return {\n            uuid: v4(),\n            type: type,\n            content: '',\n          };\n        default:\n          throw new Error(\n            $gettext('Ungltiges MultimediaElementType: ') + type\n          );\n      }\n    },\n    onChangeType(event: Event) {\n      const target = event.target as HTMLSelectElement;\n      const selectedType = target.value as MultimediaElementType;\n      this.$emit('elementChanged', {\n        updatedElement: this.createNewLernmoduleMultimediaElement(selectedType),\n      });\n    },\n    onClickRemoveImage() {\n      this.$emit('elementChanged', {\n        updatedElement: {\n          ...(this.multimediaElement as ImageFileElement),\n          file_id: '',\n        },\n      });\n    },\n    onUploadImage(file: FileRef): void {\n      const updatedElement = { ...this.multimediaElement, file_id: file.id };\n      this.$emit('elementChanged', { updatedElement });\n    },\n    onInputAltText(event: Event) {\n      const target = event.target as HTMLInputElement;\n      const newAltText = target.value;\n      const updatedElement = { ...this.multimediaElement, altText: newAltText };\n      this.$emit('elementChanged', {\n        updatedElement,\n        undoBatch: { field: 'altText', uuid: this.multimediaElement.uuid },\n      });\n    },\n    onInputContent(event: Event) {\n      const target = event.target as HTMLInputElement;\n      const newContent = target.value;\n      const updatedElement = { ...this.multimediaElement, content: newContent };\n      this.$emit('elementChanged', {\n        updatedElement,\n        undoBatch: { field: 'content', uuid: this.multimediaElement.uuid },\n      });\n    },\n  },\n  computed: {},\n});\n</script>\n\n<style scoped>\n.pairing-editor-card {\n  flex: 1 1 auto;\n}\n\n.multimedia-element-container {\n  display: flex;\n  flex-direction: column;\n  justify-content: flex-start;\n  align-items: center;\n  gap: 0.5em;\n}\n\n.multimedia-element-wrapper {\n  width: 8em;\n  height: 8em;\n\n  display: flex;\n  justify-content: center;\n  align-items: center;\n\n  border: 2px solid #dbe2e8;\n  border-radius: 0.5em;\n  background: white;\n\n  padding: 0.5em;\n  margin: 0;\n\n  overflow: hidden;\n}\n\n.element-pair-settings-item {\n  /* top | right | bottom | left */\n  margin: 0.25em 0 0 0;\n}\n\n.pairing-file-upload,\n.pairing-file-upload input[type='file'] {\n  max-width: 100%;\n}\n</style>\n","import { render } from \"./PairingEditorCard.vue?vue&type=template&id=5df590ee&scoped=true&ts=true\"\nimport script from \"./PairingEditorCard.vue?vue&type=script&lang=ts\"\nexport * from \"./PairingEditorCard.vue?vue&type=script&lang=ts\"\n\nimport \"./PairingEditorCard.vue?vue&type=style&index=0&id=5df590ee&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-5df590ee\"]])\n\nexport default __exports__","import { render } from \"./PairingEditor.vue?vue&type=template&id=70d5756a&scoped=true&ts=true\"\nimport script from \"./PairingEditor.vue?vue&type=script&lang=ts\"\nexport * from \"./PairingEditor.vue?vue&type=script&lang=ts\"\n\nimport \"./PairingEditor.vue?vue&type=style&index=0&id=70d5756a&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-70d5756a\"]])\n\nexport default __exports__","import { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, resolveComponent as _resolveComponent, createVNode as _createVNode, normalizeClass as _normalizeClass, withModifiers as _withModifiers, createElementVNode as _createElementVNode, createBlock as _createBlock, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-96ded43e\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"stud5p-task\" }\nconst _hoisted_2 = { class: \"pairing-columns\" }\nconst _hoisted_3 = [\"draggable\", \"onDragstart\", \"onClick\"]\nconst _hoisted_4 = { class: \"targetElementsColumn\" }\nconst _hoisted_5 = { class: \"feedback-and-button-container\" }\nconst _hoisted_6 = { class: \"button-panel\" }\nconst _hoisted_7 = [\"textContent\"]\nconst _hoisted_8 = [\"textContent\"]\nconst _hoisted_9 = [\"textContent\"]\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_MultimediaElement = _resolveComponent(\"MultimediaElement\")!\n  const _component_PairingViewerTargetElement = _resolveComponent(\"PairingViewerTargetElement\")!\n  const _component_FeedbackElement = _resolveComponent(\"FeedbackElement\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createElementVNode(\"div\", _hoisted_2, [\n      _createElementVNode(\"div\", {\n        class: \"draggableElementsColumn\",\n        draggable: \"false\",\n        onDragover: _cache[1] || (_cache[1] = _withModifiers(() => {}, [\"prevent\"])),\n        onDragenter: _cache[2] || (_cache[2] = _withModifiers(() => {}, [\"prevent\"])),\n        onDrop: _cache[3] || (_cache[3] = ($event: any) => (_ctx.onDropOnInteractiveElements($event)))\n      }, [\n        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.draggableElements, (draggableElementId) => {\n          return (_openBlock(), _createElementBlock(\"button\", {\n            type: \"button\",\n            key: draggableElementId,\n            draggable: \n            !_ctx.isDraggableElementUsed(draggableElementId) && !_ctx.showResults\n          ,\n            onDragstart: ($event: any) => (_ctx.startDragElement($event, draggableElementId)),\n            onDragend: _cache[0] || (_cache[0] = ($event: any) => (_ctx.endDragElement())),\n            onClick: ($event: any) => (_ctx.onClickDraggableElement(draggableElementId)),\n            class: _normalizeClass([\"draggableElement\", {\n            disabled:\n              _ctx.isDraggableElementUsed(draggableElementId) ||\n              _ctx.draggedElementId === draggableElementId,\n            immovable: _ctx.showResults,\n            selected: _ctx.elementIdInteractedWith === draggableElementId,\n          }])\n          }, [\n            _createVNode(_component_MultimediaElement, {\n              element: _ctx.getElementById(draggableElementId),\n              ref_for: true,\n              ref: \"draggableImages\"\n            }, null, 8, [\"element\"])\n          ], 42, _hoisted_3))\n        }), 128))\n      ], 32),\n      _createElementVNode(\"div\", _hoisted_4, [\n        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.task.pairs, (pair) => {\n          return (_openBlock(), _createBlock(_component_PairingViewerTargetElement, {\n            class: _normalizeClass({\n            outlined:\n              !_ctx.elementsDraggedOntoTargets.hasOwnProperty(\n                pair.targetElement.uuid\n              ) &&\n              (_ctx.draggedElementId || _ctx.elementIdInteractedWith),\n          }),\n            \"draggable-image\": \n            _ctx.getElementDraggedOntoTarget(pair.targetElement.uuid)\n          ,\n            \"target-image\": _ctx.getElementById(pair.targetElement.uuid),\n            isCorrect: _ctx.isAnswerCorrect(pair.targetElement.uuid),\n            showResult: _ctx.showResults,\n            key: pair.uuid,\n            onDrop: ($event: any) => (_ctx.onDropOnTargetElement($event, pair.targetElement.uuid)),\n            onDragstart: ($event: any) => (_ctx.startDragTargetElement($event, pair.targetElement.uuid)),\n            onDragend: _cache[4] || (_cache[4] = ($event: any) => (_ctx.endDragTargetElement())),\n            onDragover: _cache[5] || (_cache[5] = _withModifiers(() => {}, [\"prevent\"])),\n            onDragenter: _cache[6] || (_cache[6] = _withModifiers(() => {}, [\"prevent\"])),\n            onClick: ($event: any) => (_ctx.onClickTargetElement(pair.targetElement.uuid))\n          }, null, 8, [\"class\", \"draggable-image\", \"target-image\", \"isCorrect\", \"showResult\", \"onDrop\", \"onDragstart\", \"onClick\"]))\n        }), 128))\n      ])\n    ]),\n    _createElementVNode(\"div\", _hoisted_5, [\n      (_ctx.showResults)\n        ? (_openBlock(), _createBlock(_component_FeedbackElement, {\n            key: 0,\n            achievedPoints: _ctx.correctAnswers,\n            maxPoints: _ctx.maxPoints,\n            resultMessage: _ctx.resultMessage,\n            feedback: _ctx.task.feedback\n          }, null, 8, [\"achievedPoints\", \"maxPoints\", \"resultMessage\", \"feedback\"]))\n        : _createCommentVNode(\"\", true),\n      _createElementVNode(\"div\", _hoisted_6, [\n        (_ctx.showCheckButton)\n          ? (_openBlock(), _createElementBlock(\"button\", {\n              key: 0,\n              textContent: _toDisplayString(_ctx.task.strings.checkButton),\n              onClick: _cache[7] || (_cache[7] = ($event: any) => (_ctx.onClickCheck())),\n              type: \"button\",\n              class: \"stud5p-button\"\n            }, null, 8, _hoisted_7))\n          : _createCommentVNode(\"\", true),\n        (_ctx.showSolutionsButton)\n          ? (_openBlock(), _createElementBlock(\"button\", {\n              key: 1,\n              textContent: _toDisplayString(_ctx.task.strings.solutionsButton),\n              onClick: _cache[8] || (_cache[8] = ($event: any) => (_ctx.onClickShowSolution())),\n              type: \"button\",\n              class: \"stud5p-button\"\n            }, null, 8, _hoisted_8))\n          : _createCommentVNode(\"\", true),\n        (_ctx.showRetryButton)\n          ? (_openBlock(), _createElementBlock(\"button\", {\n              key: 2,\n              textContent: _toDisplayString(_ctx.task.strings.retryButton),\n              onClick: _cache[9] || (_cache[9] = ($event: any) => (_ctx.onClickTryAgain())),\n              type: \"button\",\n              class: \"stud5p-button\"\n            }, null, 8, _hoisted_9))\n          : _createCommentVNode(\"\", true)\n      ])\n    ])\n  ]))\n}","<template>\n  <div class=\"stud5p-task\">\n    <div class=\"pairing-columns\">\n      <div\n        class=\"draggableElementsColumn\"\n        draggable=\"false\"\n        @dragover.prevent\n        @dragenter.prevent\n        @drop=\"onDropOnInteractiveElements($event)\"\n      >\n        <button\n          type=\"button\"\n          v-for=\"draggableElementId in draggableElements\"\n          :key=\"draggableElementId\"\n          :draggable=\"\n            !isDraggableElementUsed(draggableElementId) && !showResults\n          \"\n          @dragstart=\"startDragElement($event, draggableElementId)\"\n          @dragend=\"endDragElement()\"\n          @click=\"onClickDraggableElement(draggableElementId)\"\n          class=\"draggableElement\"\n          :class=\"{\n            disabled:\n              isDraggableElementUsed(draggableElementId) ||\n              draggedElementId === draggableElementId,\n            immovable: showResults,\n            selected: elementIdInteractedWith === draggableElementId,\n          }\"\n        >\n          <MultimediaElement\n            :element=\"getElementById(draggableElementId)\"\n            ref=\"draggableImages\"\n          />\n        </button>\n      </div>\n\n      <div class=\"targetElementsColumn\">\n        <PairingViewerTargetElement\n          v-for=\"pair in task.pairs\"\n          :class=\"{\n            outlined:\n              !elementsDraggedOntoTargets.hasOwnProperty(\n                pair.targetElement.uuid\n              ) &&\n              (draggedElementId || elementIdInteractedWith),\n          }\"\n          :draggable-image=\"\n            getElementDraggedOntoTarget(pair.targetElement.uuid)\n          \"\n          :target-image=\"getElementById(pair.targetElement.uuid)\"\n          :isCorrect=\"isAnswerCorrect(pair.targetElement.uuid)\"\n          :showResult=\"showResults\"\n          :key=\"pair.uuid\"\n          @drop=\"onDropOnTargetElement($event, pair.targetElement.uuid)\"\n          @dragstart=\"startDragTargetElement($event, pair.targetElement.uuid)\"\n          @dragend=\"endDragTargetElement()\"\n          @dragover.prevent\n          @dragenter.prevent\n          @click=\"onClickTargetElement(pair.targetElement.uuid)\"\n        />\n      </div>\n    </div>\n\n    <div class=\"feedback-and-button-container\">\n      <FeedbackElement\n        v-if=\"showResults\"\n        :achievedPoints=\"correctAnswers\"\n        :maxPoints=\"maxPoints\"\n        :resultMessage=\"resultMessage\"\n        :feedback=\"task.feedback\"\n      />\n\n      <div class=\"button-panel\">\n        <button\n          v-if=\"showCheckButton\"\n          v-text=\"task.strings.checkButton\"\n          @click=\"onClickCheck()\"\n          type=\"button\"\n          class=\"stud5p-button\"\n        />\n\n        <button\n          v-if=\"showSolutionsButton\"\n          v-text=\"task.strings.solutionsButton\"\n          @click=\"onClickShowSolution()\"\n          type=\"button\"\n          class=\"stud5p-button\"\n        />\n\n        <button\n          v-if=\"showRetryButton\"\n          v-text=\"task.strings.retryButton\"\n          @click=\"onClickTryAgain()\"\n          type=\"button\"\n          class=\"stud5p-button\"\n        />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, PropType } from 'vue';\nimport {\n  fileIdToUrl,\n  LernmoduleMultimediaElement,\n  PairingTask,\n} from '@/models/TaskDefinition';\nimport PairingViewerTargetElement from '@/components/PairingViewerTargetElement.vue';\nimport FeedbackElement from '@/components/FeedbackElement.vue';\nimport MultimediaElement from '@/components/MultimediaElement.vue';\n\ntype Uuid = string;\n\nexport default defineComponent({\n  name: 'PairingViewer',\n  components: {\n    MultimediaElement,\n    PairingViewerTargetElement,\n    FeedbackElement,\n  },\n  props: {\n    task: {\n      type: Object as PropType<PairingTask>,\n      required: true,\n    },\n  },\n  emits: ['updateAttempt'],\n  data() {\n    return {\n      elementIdInteractedWith: undefined as Uuid | undefined,\n      draggedElementId: undefined as Uuid | undefined,\n      // We used Record instead of Set because I wasn't sure if sets are\n      // reactive in Vue 3.\n      // Record from target ID -> draggable element ID.\n      elementsDraggedOntoTargets: {} as Record<Uuid, Uuid>,\n      showResults: false as boolean,\n      showSolutions: false as boolean,\n      originalScore: null as number | null,\n    };\n  },\n  methods: {\n    fileIdToUrl,\n\n    isAnswerCorrect(targetId: Uuid): boolean {\n      const userInput = this.elementsDraggedOntoTargets[targetId];\n      if (!userInput) {\n        return false;\n      }\n      // A little bit awkward -- we have to find the pair to which the target\n      // belongs so that we can check whether the user's solution is right\n      // This method itself is therefore O(n), giving an O(n^2) if you check\n      // every user answer in a loop every time the user makes an input.\n      // But it should be fine, because even if there are 50 elements in a set\n      // (very unlikely), this comes out to 2500 comparisons, which should\n      // complete in under a millisecond.\n      const pair = this.task.pairs.find(\n        (pair) => pair.targetElement.uuid === targetId\n      );\n      if (!pair) {\n        throw new Error(\n          'could not find the pair to which the target id ' +\n            targetId +\n            ' belongs'\n        );\n      }\n      return pair.draggableElement.uuid === userInput;\n    },\n\n    getElementDraggedOntoTarget(\n      targetId: Uuid\n    ): LernmoduleMultimediaElement | undefined {\n      const draggedElementId = this.elementsDraggedOntoTargets[targetId];\n      if (draggedElementId) {\n        return this.getElementById(draggedElementId);\n      } else {\n        return undefined;\n      }\n    },\n\n    startDragElement(dragEvent: DragEvent, elementId: Uuid): void {\n      /**\n       * TODO #27: After creating MultimediaElement: Refactor drag-drop interactions.\n       * The HTML5 drag-drop is hard to use with our planned refactoring\n       * to create the component 'MultimediaElement'.\n       * Since for HTML5 drag-drop, we have to do some hacking to make the\n       * ghost image look correct, and this hacking is not very robust and\n       * will fail for text/audio type content.\n       * So instead of using HTML5 drag-drop (draggable=true, ondrag, ondrop), let's\n       * use pointer events (pointerdown, pointermove and pointerup) and pointer capture API.\n       * (See Gitlab for rest of comment...)\n       */\n      if (!this.isDraggableElementUsed(elementId)) {\n        console.log('Dragging element:', elementId);\n        this.elementIdInteractedWith = elementId;\n        this.draggedElementId = elementId;\n\n        dragEvent.dataTransfer!.dropEffect = 'move';\n        dragEvent.dataTransfer!.effectAllowed = 'move';\n      }\n    },\n\n    endDragElement(): void {\n      this.elementIdInteractedWith = undefined;\n      this.draggedElementId = undefined;\n    },\n\n    startDragTargetElement(dragEvent: DragEvent, targetElementId: Uuid): void {\n      dragEvent.dataTransfer!.dropEffect = 'move';\n      dragEvent.dataTransfer!.effectAllowed = 'move';\n      // Remember that the element has been dragged away from a target\n      // where it had been placed by the user\n      dragEvent.dataTransfer!.setData('targetId', targetElementId);\n\n      // Check if an element has been dragged onto the target already\n      const userDraggedElementId =\n        this.elementsDraggedOntoTargets[targetElementId];\n      if (userDraggedElementId) {\n        this.elementIdInteractedWith = userDraggedElementId;\n\n        console.log(\n          'Dragging element:',\n          this.elementIdInteractedWith,\n          'from target element',\n          targetElementId\n        );\n      }\n    },\n\n    endDragTargetElement() {\n      this.elementIdInteractedWith = undefined;\n      this.draggedElementId = undefined;\n    },\n\n    onDropOnTargetElement(event: DragEvent, targetElementId: Uuid): void {\n      if (!this.elementIdInteractedWith) {\n        return;\n      }\n\n      // If the element has been dragged away from another target, then it should\n      // be removed from that target when it is dropped onto this target.\n      const otherTargetId = event.dataTransfer?.getData('targetId');\n      if (otherTargetId) {\n        delete this.elementsDraggedOntoTargets[otherTargetId];\n      }\n      // Save the dragged element onto the target where it has been dropped\n      this.elementsDraggedOntoTargets[targetElementId] =\n        this.elementIdInteractedWith;\n\n      console.log(\n        'Dropped element:',\n        this.elementIdInteractedWith,\n        'on target:',\n        targetElementId\n      );\n      // Mark that the drag interaction is over.\n      this.elementIdInteractedWith = undefined;\n      this.draggedElementId = undefined;\n    },\n\n    getElementById(elementId: string): LernmoduleMultimediaElement {\n      const element = this.elementsById[elementId];\n      if (!element) {\n        throw new Error('No element found with the given ID: ' + elementId);\n      }\n      return element;\n    },\n\n    onClickTargetElement(targetElementId: Uuid): void {\n      console.log('Clicked on target element', targetElementId);\n\n      // Do nothing if we are displaying the results already\n      if (this.showResults) return;\n\n      // Remove the element, if any, that has been dragged by the user onto\n      // the target they have clicked.\n      const usedElementId = this.elementsDraggedOntoTargets[targetElementId];\n      if (usedElementId) {\n        delete this.elementsDraggedOntoTargets[targetElementId];\n      }\n      // Check if the user clicked a draggable element and wants to put it here\n      if (this.elementIdInteractedWith) {\n        this.elementsDraggedOntoTargets[targetElementId] =\n          this.elementIdInteractedWith;\n        this.elementIdInteractedWith = undefined;\n      }\n    },\n\n    // This has a complexity of O(n).  When it is called in our v-for to set\n    // the class of every draggable element, it makes it O(n^2).\n    // But that should be OK, because no one will put more than (say) 100\n    // elements in a single task, right?\n    isDraggableElementUsed(draggableElementId: Uuid): boolean {\n      return Object.values(this.elementsDraggedOntoTargets).includes(\n        draggableElementId\n      );\n    },\n\n    onClickDraggableElement(elementId: Uuid): void {\n      if (!this.isDraggableElementUsed(elementId) && !this.showResults) {\n        console.log('Clicked on element:', elementId);\n        this.elementIdInteractedWith = elementId;\n      }\n    },\n\n    onDropOnInteractiveElements(event: DragEvent): void {\n      if (!this.elementIdInteractedWith) {\n        return;\n      }\n\n      // If the element has been dragged away from a target, then it should\n      // be removed from that target when it is dropped here.\n      const otherTargetId = event.dataTransfer?.getData('targetId');\n      if (otherTargetId) {\n        delete this.elementsDraggedOntoTargets[otherTargetId];\n      }\n\n      console.log('Returned element:', this.elementIdInteractedWith);\n\n      // Mark that the interaction is over.\n      this.elementIdInteractedWith = undefined;\n    },\n\n    onClickCheck(): void {\n      this.showResults = true;\n      this.originalScore = this.correctAnswers;\n    },\n\n    onClickShowSolution(): void {\n      this.showSolutions = true;\n\n      // Fill elementsDraggedOntoTargets with the correct answers\n      this.task.pairs.forEach((pair) => {\n        this.elementsDraggedOntoTargets[pair.targetElement.uuid] =\n          pair.draggableElement.uuid;\n      });\n    },\n\n    onClickTryAgain(): void {\n      this.showResults = false;\n      this.showSolutions = false;\n      this.elementsDraggedOntoTargets = {};\n      this.originalScore = null;\n    },\n  },\n  computed: {\n    draggableElements(): Uuid[] {\n      // Shuffle the elements\n      // https://stackoverflow.com/a/46545530\n      return this.task.pairs\n        .map((pair) => ({ pair: pair, sort: Math.random() }))\n        .sort((pair1, pair2) => pair1.sort - pair2.sort)\n        .map(({ pair }) => pair.draggableElement.uuid);\n    },\n\n    elementsById(): Record<Uuid, LernmoduleMultimediaElement> {\n      const elementsById: Record<Uuid, LernmoduleMultimediaElement> = {};\n      for (const pair of this.task.pairs) {\n        elementsById[pair.draggableElement.uuid] = pair.draggableElement;\n        elementsById[pair.targetElement.uuid] = pair.targetElement;\n      }\n      return elementsById;\n    },\n\n    correctAnswers(): number {\n      // If solutions are shown, return the original score instead of recalculating\n      if (this.showSolutions && this.originalScore !== null) {\n        return this.originalScore;\n      }\n\n      let correctAnswers = 0;\n      for (const pair of this.task.pairs) {\n        if (this.isAnswerCorrect(pair.targetElement.uuid)) correctAnswers++;\n      }\n      return correctAnswers;\n    },\n\n    maxPoints(): number {\n      return this.task.pairs.length;\n    },\n\n    resultMessage(): string {\n      let resultMessage = this.task.strings.resultMessage.replace(\n        ':correct',\n        this.correctAnswers.toString()\n      );\n\n      resultMessage = resultMessage.replace(\n        ':total',\n        this.maxPoints.toString()\n      );\n\n      return resultMessage;\n    },\n\n    showCheckButton(): boolean {\n      return !this.showResults;\n    },\n\n    showRetryButton(): boolean {\n      return (\n        this.task.retryAllowed && this.showResults && !this.allAnswersAreCorrect\n      );\n    },\n\n    showSolutionsButton(): boolean {\n      return (\n        this.task.showSolutionsAllowed &&\n        this.showResults &&\n        !this.showSolutions &&\n        !this.allAnswersAreCorrect\n      );\n    },\n\n    allAnswersAreCorrect(): boolean {\n      return this.correctAnswers === this.maxPoints;\n    },\n  },\n});\n</script>\n\n<style scoped lang=\"scss\">\n.pairing-columns {\n  display: flex;\n  flex-direction: row;\n}\n\n.draggableElementsColumn {\n  @extend .pairing-elements-grid;\n  flex-grow: 1;\n  user-select: none;\n  margin: 0.5em;\n}\n\n.targetElementsColumn {\n  @extend .pairing-elements-grid;\n  flex-grow: 1;\n  user-select: none;\n  margin: 0.5em;\n  border-radius: 0.25em;\n  background-color: #eef1f4;\n}\n\n.pairing-elements-grid {\n  /* Adapted from https://stackoverflow.com/a/46099319/7359454 */\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(9em, auto));\n  grid-auto-rows: max-content;\n  justify-content: space-around;\n  row-gap: 1em;\n  column-gap: 0.5em;\n  padding: 0.5em;\n}\n\n.disabled {\n  cursor: default;\n  opacity: 25%;\n}\n\n.outlined {\n  cursor: pointer;\n  border: 2px dashed #dbe2e8;\n}\n\n.draggableElement {\n  display: flex;\n  margin: unset;\n  width: 8em;\n  height: 8em;\n  box-sizing: content-box;\n\n  border: 2px solid #dbe2e8;\n  border-radius: 0.5em;\n  background: white;\n  padding: 0.5em;\n}\n\n.draggableElement.selected {\n  border: 2px solid #7ba4d3;\n  box-shadow: 0 0 10px 0 #406ef3;\n}\n\n.draggableElement:not(.disabled):not(.immovable):not(.selected):hover {\n  cursor: grab;\n  border: 2px solid #7ba4d3;\n  box-shadow: 0 0 10px 0 #406ef3;\n}\n</style>\n","import { resolveComponent as _resolveComponent, normalizeClass as _normalizeClass, createVNode as _createVNode, createElementVNode as _createElementVNode, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, createBlock as _createBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-315196fa\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"image-container back\" }\nconst _hoisted_2 = [\"draggable\"]\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_MultimediaElement = _resolveComponent(\"MultimediaElement\")!\n\n  return (_openBlock(), _createElementBlock(\"button\", {\n    type: \"button\",\n    class: _normalizeClass([\"grid-square\", {\n      'two-images': !!this.draggableImage,\n      'one-image': !this.draggableImage,\n      correct: this.isCorrect,\n      incorrect: !this.isCorrect,\n      showResult: this.showResult,\n    }])\n  }, [\n    (this.draggableImage)\n      ? (_openBlock(), _createElementBlock(_Fragment, { key: 0 }, [\n          _createElementVNode(\"div\", _hoisted_1, [\n            _createVNode(_component_MultimediaElement, {\n              element: _ctx.targetImage,\n              class: _normalizeClass([\"image\", {\n            correct: this.isCorrect,\n            incorrect: !this.isCorrect,\n            showResult: this.showResult,\n          }])\n            }, null, 8, [\"element\", \"class\"])\n          ]),\n          _createElementVNode(\"div\", {\n            class: \"image-container front\",\n            draggable: !this.showResult\n          }, [\n            _createVNode(_component_MultimediaElement, {\n              element: _ctx.draggableImage,\n              class: _normalizeClass([\"image\", {\n            correct: this.isCorrect,\n            incorrect: !this.isCorrect,\n            showResult: this.showResult,\n          }])\n            }, null, 8, [\"element\", \"class\"])\n          ], 8, _hoisted_2)\n        ], 64))\n      : (_openBlock(), _createBlock(_component_MultimediaElement, {\n          key: 1,\n          element: _ctx.targetImage\n        }, null, 8, [\"element\"]))\n  ], 2))\n}","<template>\n  <button\n    type=\"button\"\n    class=\"grid-square\"\n    :class=\"{\n      'two-images': !!this.draggableImage,\n      'one-image': !this.draggableImage,\n      correct: this.isCorrect,\n      incorrect: !this.isCorrect,\n      showResult: this.showResult,\n    }\"\n  >\n    <template v-if=\"this.draggableImage\">\n      <div class=\"image-container back\">\n        <MultimediaElement\n          :element=\"targetImage\"\n          class=\"image\"\n          :class=\"{\n            correct: this.isCorrect,\n            incorrect: !this.isCorrect,\n            showResult: this.showResult,\n          }\"\n        />\n      </div>\n      <div class=\"image-container front\" :draggable=\"!this.showResult\">\n        <MultimediaElement\n          :element=\"draggableImage\"\n          class=\"image\"\n          :class=\"{\n            correct: this.isCorrect,\n            incorrect: !this.isCorrect,\n            showResult: this.showResult,\n          }\"\n        />\n      </div>\n    </template>\n    <MultimediaElement v-else :element=\"targetImage\" />\n  </button>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, PropType } from 'vue';\nimport { fileIdToUrl } from '@/models/TaskDefinition';\nimport MultimediaElement from '@/components/MultimediaElement.vue';\nimport { ImageFileElement } from '@/models/common';\n\nexport default defineComponent({\n  name: 'TargetImage',\n  components: { MultimediaElement },\n  props: {\n    draggableImage: {\n      type: Object as PropType<ImageFileElement>,\n      required: false,\n    },\n    targetImage: {\n      type: Object as PropType<ImageFileElement>,\n      required: true,\n    },\n    isCorrect: {\n      type: Boolean,\n      required: false,\n    },\n    showResult: {\n      type: Boolean,\n      required: false,\n    },\n  },\n  computed: {},\n  methods: { fileIdToUrl },\n});\n</script>\n\n<style scoped>\n.grid-square {\n  display: flex;\n  margin: unset;\n  width: 8em;\n  height: 8em;\n  box-sizing: content-box;\n\n  border: 2px solid #dbe2e8;\n  border-radius: 0.5em;\n  background: white;\n  padding: 0.5em;\n}\n\n.grid-square.one-image {\n  display: flex;\n  justify-content: center;\n}\n\n.grid-square.two-images {\n  position: relative;\n}\n\n.grid-square.two-images .image {\n  border-radius: 0.5em;\n  border: 2px solid #dbe2e8;\n  padding: 0.25em;\n  background: white;\n}\n\n.grid-square.two-images:not(:hover):not(.showResult) {\n  background: unset;\n  border: 2px solid transparent;\n}\n\n.grid-square.two-images:is(.correct):is(.showResult) {\n  border: 2px solid #64a877;\n  box-shadow: inset 0 0 120px #64a877;\n}\n\n.grid-square.two-images:is(.incorrect):is(.showResult) {\n  border: 2px solid #dd2e2e;\n  box-shadow: inset 0 0 120px #dd2e2e;\n}\n\n.grid-square.two-images:hover:not(.showResult) {\n  cursor: grab;\n  border: 2px solid #7ba4d3;\n  box-shadow: inset 0 0 72px #cbd5de, 0 0 10px 0 #406ef3;\n}\n\n.grid-square.two-images:hover .image:is(.showResult) {\n  cursor: default;\n}\n\n.image-container {\n  position: absolute;\n  width: 60%;\n  height: 60%;\n}\n\n.image-container.front {\n  top: 0.25em;\n  left: 0.25em;\n}\n\n.image-container.back {\n  bottom: 0.25em;\n  right: 0.25em;\n}\n\n.image {\n  width: 100%;\n  height: 100%;\n  object-fit: contain;\n  object-position: center;\n  box-sizing: border-box;\n}\n</style>\n","import { render } from \"./PairingViewerTargetElement.vue?vue&type=template&id=315196fa&scoped=true&ts=true\"\nimport script from \"./PairingViewerTargetElement.vue?vue&type=script&lang=ts\"\nexport * from \"./PairingViewerTargetElement.vue?vue&type=script&lang=ts\"\n\nimport \"./PairingViewerTargetElement.vue?vue&type=style&index=0&id=315196fa&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-315196fa\"]])\n\nexport default __exports__","import { render } from \"./PairingViewer.vue?vue&type=template&id=96ded43e&scoped=true&ts=true\"\nimport script from \"./PairingViewer.vue?vue&type=script&lang=ts\"\nexport * from \"./PairingViewer.vue?vue&type=script&lang=ts\"\n\nimport \"./PairingViewer.vue?vue&type=style&index=0&id=96ded43e&scoped=true&lang=scss\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-96ded43e\"]])\n\nexport default __exports__","import { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createTextVNode as _createTextVNode, vModelText as _vModelText, withDirectives as _withDirectives, vModelCheckbox as _vModelCheckbox, normalizeClass as _normalizeClass, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-3555d82a\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"stud5p-task\" }\nconst _hoisted_2 = { class: \"default\" }\nconst _hoisted_3 = { class: \"answer-title\" }\nconst _hoisted_4 = [\"title\", \"aria-label\", \"onClick\"]\nconst _hoisted_5 = [\"src\"]\nconst _hoisted_6 = { class: \"answer-row\" }\nconst _hoisted_7 = [\"checked\", \"onInput\"]\nconst _hoisted_8 = [\"onUpdate:modelValue\", \"onInput\"]\nconst _hoisted_9 = { class: \"collapsable collapsed feedback\" }\nconst _hoisted_10 = [\"onUpdate:modelValue\", \"onInput\"]\nconst _hoisted_11 = [\"onUpdate:modelValue\", \"onInput\"]\nconst _hoisted_12 = [\"onUpdate:modelValue\", \"onInput\"]\nconst _hoisted_13 = { class: \"collapsable collapsed\" }\nconst _hoisted_14 = { class: \"collapsable collapsed\" }\nconst _hoisted_15 = [\"disabled\"]\nconst _hoisted_16 = [\"disabled\"]\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_studip_wysiwyg = _resolveComponent(\"studip-wysiwyg\")!\n  const _component_feedback_editor = _resolveComponent(\"feedback-editor\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createElementVNode(\"form\", _hoisted_2, [\n      _createElementVNode(\"fieldset\", null, [\n        _createElementVNode(\"legend\", null, _toDisplayString(_ctx.$gettext('Question')), 1),\n        _createElementVNode(\"label\", null, [\n          _createVNode(_component_studip_wysiwyg, {\n            modelValue: _ctx.taskDefinition.question,\n            \"onUpdate:modelValue\": _ctx.onEditQuestion,\n            \"force-soft-breaks\": \"\",\n            \"remove-wrapping-p-tag\": \"\",\n            \"disable-autoformat\": \"\"\n          }, null, 8, [\"modelValue\", \"onUpdate:modelValue\"])\n        ]),\n        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.modelTaskDefinition.answers, (answer, i) => {\n          return (_openBlock(), _createElementBlock(\"fieldset\", {\n            key: answer.uuid,\n            class: \"answer collapsable collapsed\"\n          }, [\n            _createElementVNode(\"legend\", _hoisted_3, [\n              _createTextVNode(_toDisplayString(answer.text) + \" \", 1),\n              _createElementVNode(\"button\", {\n                title: _ctx.$gettext('Antwort lschen'),\n                \"aria-label\": _ctx.$gettext('Antwort lschen'),\n                onClick: ($event: any) => (_ctx.removeAnswer(i)),\n                type: \"button\",\n                class: \"button-with-icon\"\n              }, [\n                _createElementVNode(\"img\", {\n                  src: _ctx.urlForIcon('trash'),\n                  alt: \"\"\n                }, null, 8, _hoisted_5)\n              ], 8, _hoisted_4)\n            ]),\n            _createElementVNode(\"div\", _hoisted_6, [\n              _createElementVNode(\"input\", {\n                checked: _ctx.taskDefinition.answers[i].correct,\n                onInput: ($event: any) => (_ctx.onInputAnswerCorrect($event, i)),\n                type: \"checkbox\"\n              }, null, 40, _hoisted_7),\n              _withDirectives(_createElementVNode(\"input\", {\n                \"onUpdate:modelValue\": ($event: any) => ((_ctx.modelTaskDefinition.answers[i].text) = $event),\n                onInput: ($event: any) => (_ctx.updateTaskDefinition(`taskDefinition.answers[${i}].text`)),\n                type: \"text\"\n              }, null, 40, _hoisted_8), [\n                [_vModelText, _ctx.modelTaskDefinition.answers[i].text]\n              ])\n            ]),\n            _createElementVNode(\"fieldset\", _hoisted_9, [\n              _createElementVNode(\"legend\", null, _toDisplayString(_ctx.$gettext('Hinweis und Feedback')), 1),\n              _createElementVNode(\"label\", null, [\n                _createElementVNode(\"span\", null, _toDisplayString(_ctx.$gettext('Hinweis:')), 1),\n                _withDirectives(_createElementVNode(\"input\", {\n                  \"onUpdate:modelValue\": ($event: any) => ((_ctx.modelTaskDefinition.answers[i].strings.hint) = $event),\n                  onInput: ($event: any) => (\n                  _ctx.updateTaskDefinition(\n                    `taskDefinition.answers[${i}].strings.hint`\n                  )\n                ),\n                  type: \"text\"\n                }, null, 40, _hoisted_10), [\n                  [_vModelText, _ctx.modelTaskDefinition.answers[i].strings.hint]\n                ])\n              ]),\n              _createElementVNode(\"label\", null, [\n                _createElementVNode(\"span\", null, _toDisplayString(_ctx.$gettext('Feedback, wenn ausgewhlt:')), 1),\n                _withDirectives(_createElementVNode(\"input\", {\n                  \"onUpdate:modelValue\": ($event: any) => ((\n                  _ctx.modelTaskDefinition.answers[i].strings.feedbackSelected\n                ) = $event),\n                  onInput: ($event: any) => (\n                  _ctx.updateTaskDefinition(\n                    `taskDefinition.answers[${i}].strings.feedbackSelected`\n                  )\n                ),\n                  type: \"text\"\n                }, null, 40, _hoisted_11), [\n                  [_vModelText, \n                  _ctx.modelTaskDefinition.answers[i].strings.feedbackSelected\n                ]\n                ])\n              ]),\n              _createElementVNode(\"label\", null, [\n                _createElementVNode(\"span\", null, _toDisplayString(_ctx.$gettext('Feedback, wenn nicht ausgewhlt:')), 1),\n                _withDirectives(_createElementVNode(\"input\", {\n                  \"onUpdate:modelValue\": ($event: any) => ((\n                  _ctx.modelTaskDefinition.answers[i].strings.feedbackNotSelected\n                ) = $event),\n                  onInput: ($event: any) => (\n                  _ctx.updateTaskDefinition(\n                    `taskDefinition.answers[${i}].strings.feedbackNotSelected`\n                  )\n                ),\n                  type: \"text\"\n                }, null, 40, _hoisted_12), [\n                  [_vModelText, \n                  _ctx.modelTaskDefinition.answers[i].strings.feedbackNotSelected\n                ]\n                ])\n              ])\n            ])\n          ]))\n        }), 128)),\n        _createElementVNode(\"button\", {\n          onClick: _cache[0] || (_cache[0] = \n//@ts-ignore\n(...args) => (_ctx.addAnswer && _ctx.addAnswer(...args))),\n          type: \"button\",\n          class: \"button\"\n        }, _toDisplayString(_ctx.$gettext('Neue Antwort')), 1)\n      ]),\n      _createElementVNode(\"fieldset\", _hoisted_13, [\n        _createElementVNode(\"legend\", null, _toDisplayString(_ctx.$gettext('Einstellungen')), 1),\n        _createElementVNode(\"label\", null, [\n          _withDirectives(_createElementVNode(\"input\", {\n            \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event: any) => ((_ctx.modelTaskDefinition.canAnswerMultiple) = $event)),\n            onChange: _cache[2] || (_cache[2] = \n//@ts-ignore\n(...args) => (_ctx.updateTaskDefinition && _ctx.updateTaskDefinition(...args))),\n            type: \"checkbox\"\n          }, null, 544), [\n            [_vModelCheckbox, _ctx.modelTaskDefinition.canAnswerMultiple]\n          ]),\n          _createTextVNode(\" \" + _toDisplayString(_ctx.$gettext('Mehrfachauswahl erlauben')), 1)\n        ]),\n        _createElementVNode(\"label\", null, [\n          _withDirectives(_createElementVNode(\"input\", {\n            \"onUpdate:modelValue\": _cache[3] || (_cache[3] = ($event: any) => ((_ctx.modelTaskDefinition.randomOrder) = $event)),\n            onChange: _cache[4] || (_cache[4] = \n//@ts-ignore\n(...args) => (_ctx.updateTaskDefinition && _ctx.updateTaskDefinition(...args))),\n            type: \"checkbox\"\n          }, null, 544), [\n            [_vModelCheckbox, _ctx.modelTaskDefinition.randomOrder]\n          ]),\n          _createTextVNode(\" \" + _toDisplayString(_ctx.$gettext('Antworten in zuflliger Reihenfolge anzeigen')), 1)\n        ]),\n        _createElementVNode(\"label\", null, [\n          _withDirectives(_createElementVNode(\"input\", {\n            \"onUpdate:modelValue\": _cache[5] || (_cache[5] = ($event: any) => ((_ctx.modelTaskDefinition.retryAllowed) = $event)),\n            onChange: _cache[6] || (_cache[6] = \n//@ts-ignore\n(...args) => (_ctx.updateTaskDefinition && _ctx.updateTaskDefinition(...args))),\n            type: \"checkbox\"\n          }, null, 544), [\n            [_vModelCheckbox, _ctx.modelTaskDefinition.retryAllowed]\n          ]),\n          _createTextVNode(\" \" + _toDisplayString(_ctx.$gettext('Mehrere Versuche erlauben')), 1)\n        ]),\n        _createElementVNode(\"label\", null, [\n          _withDirectives(_createElementVNode(\"input\", {\n            \"onUpdate:modelValue\": _cache[7] || (_cache[7] = ($event: any) => ((_ctx.modelTaskDefinition.showSolutionsAllowed) = $event)),\n            onChange: _cache[8] || (_cache[8] = \n//@ts-ignore\n(...args) => (_ctx.updateTaskDefinition && _ctx.updateTaskDefinition(...args))),\n            type: \"checkbox\"\n          }, null, 544), [\n            [_vModelCheckbox, _ctx.modelTaskDefinition.showSolutionsAllowed]\n          ]),\n          _createTextVNode(\" \" + _toDisplayString(_ctx.$gettext('Lsungen anzeigen erlauben')), 1)\n        ])\n      ]),\n      _createElementVNode(\"fieldset\", _hoisted_14, [\n        _createElementVNode(\"legend\", null, _toDisplayString(_ctx.$gettext('Beschriftungen')), 1),\n        _createElementVNode(\"label\", null, [\n          _createTextVNode(_toDisplayString(_ctx.$gettext('Text fr berprfen-Button:')) + \" \", 1),\n          _withDirectives(_createElementVNode(\"input\", {\n            \"onUpdate:modelValue\": _cache[9] || (_cache[9] = ($event: any) => ((_ctx.modelTaskDefinition.strings.checkButton) = $event)),\n            onInput: _cache[10] || (_cache[10] = ($event: any) => (_ctx.updateTaskDefinition('taskDefinition.strings.checkButton'))),\n            type: \"text\"\n          }, null, 544), [\n            [_vModelText, _ctx.modelTaskDefinition.strings.checkButton]\n          ])\n        ]),\n        _createElementVNode(\"label\", {\n          class: _normalizeClass({ 'setting-disabled': !_ctx.modelTaskDefinition.retryAllowed })\n        }, [\n          _createTextVNode(_toDisplayString(_ctx.$gettext('Text fr Wiederholen-Button:')) + \" \", 1),\n          _withDirectives(_createElementVNode(\"input\", {\n            \"onUpdate:modelValue\": _cache[11] || (_cache[11] = ($event: any) => ((_ctx.modelTaskDefinition.strings.retryButton) = $event)),\n            onInput: _cache[12] || (_cache[12] = ($event: any) => (_ctx.updateTaskDefinition('taskDefinition.strings.retryButton'))),\n            disabled: !_ctx.modelTaskDefinition.retryAllowed,\n            type: \"text\"\n          }, null, 40, _hoisted_15), [\n            [_vModelText, _ctx.modelTaskDefinition.strings.retryButton]\n          ])\n        ], 2),\n        _createElementVNode(\"label\", {\n          class: _normalizeClass({\n            'setting-disabled': !_ctx.modelTaskDefinition.showSolutionsAllowed,\n          })\n        }, [\n          _createTextVNode(_toDisplayString(_ctx.$gettext('Text fr Lsungen-Button:')) + \" \", 1),\n          _withDirectives(_createElementVNode(\"input\", {\n            \"onUpdate:modelValue\": _cache[13] || (_cache[13] = ($event: any) => ((_ctx.modelTaskDefinition.strings.solutionsButton) = $event)),\n            onInput: _cache[14] || (_cache[14] = ($event: any) => (\n              _ctx.updateTaskDefinition('taskDefinition.strings.solutionsButton')\n            )),\n            disabled: !_ctx.modelTaskDefinition.showSolutionsAllowed,\n            type: \"text\"\n          }, null, 40, _hoisted_16), [\n            [_vModelText, _ctx.modelTaskDefinition.strings.solutionsButton]\n          ])\n        ], 2)\n      ]),\n      _createVNode(_component_feedback_editor, {\n        feedback: _ctx.modelTaskDefinition.feedback,\n        \"result-message\": _ctx.modelTaskDefinition.strings.resultMessage,\n        \"onUpdate:feedback\": _ctx.updateFeedback,\n        \"onUpdate:resultMessage\": _ctx.updateResultMessage\n      }, null, 8, [\"feedback\", \"result-message\", \"onUpdate:feedback\", \"onUpdate:resultMessage\"])\n    ])\n  ]))\n}","<template>\n  <div class=\"stud5p-task\">\n    <form class=\"default\">\n      <fieldset>\n        <legend>{{ $gettext('Question') }}</legend>\n\n        <label>\n          <studip-wysiwyg\n            :modelValue=\"taskDefinition.question\"\n            @update:modelValue=\"onEditQuestion\"\n            force-soft-breaks\n            remove-wrapping-p-tag\n            disable-autoformat\n          />\n        </label>\n\n        <fieldset\n          v-for=\"(answer, i) in modelTaskDefinition.answers\"\n          :key=\"answer.uuid\"\n          class=\"answer collapsable collapsed\"\n        >\n          <legend class=\"answer-title\">\n            {{ answer.text }}\n            <button\n              :title=\"$gettext('Antwort lschen')\"\n              :aria-label=\"$gettext('Antwort lschen')\"\n              @click=\"removeAnswer(i)\"\n              type=\"button\"\n              class=\"button-with-icon\"\n            >\n              <img :src=\"urlForIcon('trash')\" alt=\"\" />\n            </button>\n          </legend>\n\n          <div class=\"answer-row\">\n            <input\n              :checked=\"taskDefinition.answers[i].correct\"\n              @input=\"onInputAnswerCorrect($event, i)\"\n              type=\"checkbox\"\n            />\n\n            <input\n              v-model=\"modelTaskDefinition.answers[i].text\"\n              @input=\"updateTaskDefinition(`taskDefinition.answers[${i}].text`)\"\n              type=\"text\"\n            />\n          </div>\n\n          <fieldset class=\"collapsable collapsed feedback\">\n            <legend>{{ $gettext('Hinweis und Feedback') }}</legend>\n\n            <label>\n              <span>{{ $gettext('Hinweis:') }}</span>\n              <input\n                v-model=\"modelTaskDefinition.answers[i].strings.hint\"\n                @input=\"\n                  updateTaskDefinition(\n                    `taskDefinition.answers[${i}].strings.hint`\n                  )\n                \"\n                type=\"text\"\n              />\n            </label>\n\n            <label>\n              <span>{{ $gettext('Feedback, wenn ausgewhlt:') }}</span>\n              <input\n                v-model=\"\n                  modelTaskDefinition.answers[i].strings.feedbackSelected\n                \"\n                @input=\"\n                  updateTaskDefinition(\n                    `taskDefinition.answers[${i}].strings.feedbackSelected`\n                  )\n                \"\n                type=\"text\"\n              />\n            </label>\n\n            <label>\n              <span>{{ $gettext('Feedback, wenn nicht ausgewhlt:') }}</span>\n              <input\n                v-model=\"\n                  modelTaskDefinition.answers[i].strings.feedbackNotSelected\n                \"\n                @input=\"\n                  updateTaskDefinition(\n                    `taskDefinition.answers[${i}].strings.feedbackNotSelected`\n                  )\n                \"\n                type=\"text\"\n              />\n            </label>\n          </fieldset>\n        </fieldset>\n\n        <button @click=\"addAnswer\" type=\"button\" class=\"button\">\n          {{ $gettext('Neue Antwort') }}\n        </button>\n      </fieldset>\n\n      <fieldset class=\"collapsable collapsed\">\n        <legend>{{ $gettext('Einstellungen') }}</legend>\n\n        <label>\n          <input\n            v-model=\"modelTaskDefinition.canAnswerMultiple\"\n            @change=\"updateTaskDefinition\"\n            type=\"checkbox\"\n          />\n          {{ $gettext('Mehrfachauswahl erlauben') }}\n        </label>\n\n        <label>\n          <input\n            v-model=\"modelTaskDefinition.randomOrder\"\n            @change=\"updateTaskDefinition\"\n            type=\"checkbox\"\n          />\n          {{ $gettext('Antworten in zuflliger Reihenfolge anzeigen') }}\n        </label>\n\n        <label>\n          <input\n            v-model=\"modelTaskDefinition.retryAllowed\"\n            @change=\"updateTaskDefinition\"\n            type=\"checkbox\"\n          />\n          {{ $gettext('Mehrere Versuche erlauben') }}\n        </label>\n\n        <label>\n          <input\n            v-model=\"modelTaskDefinition.showSolutionsAllowed\"\n            @change=\"updateTaskDefinition\"\n            type=\"checkbox\"\n          />\n          {{ $gettext('Lsungen anzeigen erlauben') }}\n        </label>\n      </fieldset>\n\n      <fieldset class=\"collapsable collapsed\">\n        <legend>{{ $gettext('Beschriftungen') }}</legend>\n\n        <label>\n          {{ $gettext('Text fr berprfen-Button:') }}\n          <input\n            v-model=\"modelTaskDefinition.strings.checkButton\"\n            @input=\"updateTaskDefinition('taskDefinition.strings.checkButton')\"\n            type=\"text\"\n          />\n        </label>\n\n        <label\n          :class=\"{ 'setting-disabled': !modelTaskDefinition.retryAllowed }\"\n        >\n          {{ $gettext('Text fr Wiederholen-Button:') }}\n          <input\n            v-model=\"modelTaskDefinition.strings.retryButton\"\n            @input=\"updateTaskDefinition('taskDefinition.strings.retryButton')\"\n            :disabled=\"!modelTaskDefinition.retryAllowed\"\n            type=\"text\"\n          />\n        </label>\n\n        <label\n          :class=\"{\n            'setting-disabled': !modelTaskDefinition.showSolutionsAllowed,\n          }\"\n        >\n          {{ $gettext('Text fr Lsungen-Button:') }}\n          <input\n            v-model=\"modelTaskDefinition.strings.solutionsButton\"\n            @input=\"\n              updateTaskDefinition('taskDefinition.strings.solutionsButton')\n            \"\n            :disabled=\"!modelTaskDefinition.showSolutionsAllowed\"\n            type=\"text\"\n          />\n        </label>\n      </fieldset>\n\n      <feedback-editor\n        :feedback=\"modelTaskDefinition.feedback\"\n        :result-message=\"modelTaskDefinition.strings.resultMessage\"\n        @update:feedback=\"updateFeedback\"\n        @update:result-message=\"updateResultMessage\"\n      />\n    </form>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, inject, PropType } from 'vue';\nimport { QuestionTask } from '@/models/TaskDefinition';\nimport { Feedback } from '@/models/common';\nimport StudipWysiwyg from '@/components/StudipWysiwyg.vue';\nimport { $gettext } from '@/language/gettext';\nimport produce from 'immer';\nimport {\n  TaskEditorState,\n  taskEditorStateSymbol,\n} from '@/components/taskEditorState';\nimport FeedbackEditor from '@/components/FeedbackEditor.vue';\nimport { v4 } from 'uuid';\nimport { cloneDeep } from 'lodash';\n\nexport default defineComponent({\n  name: 'QuestionEditor',\n  setup() {\n    return {\n      taskEditor: inject<TaskEditorState>(taskEditorStateSymbol),\n    };\n  },\n  components: { FeedbackEditor, StudipWysiwyg },\n  props: {\n    taskDefinition: {\n      type: Object as PropType<QuestionTask>,\n      required: true,\n    },\n  },\n  data() {\n    return {\n      // We use this as a helping means to allow us to use v-model for the\n      // inputs for the many different options that are used in this task.\n      // There are a lot of different strings to be typed in, checkboxes\n      // to be checked and so on. This saves us the effort of writing 11 more\n      // event handlers analogous to onInputAnswerCorrect.\n      // Instead, we just write a catchall function 'updateTaskDefinition'\n      // which we can call to copy modelTaskDefinition into taskDefinition.\n      modelTaskDefinition: cloneDeep(this.taskDefinition),\n    };\n  },\n  watch: {\n    // Synchronize state taskDefinition -> modelTaskDefinition.\n    taskDefinition: {\n      immediate: true,\n      handler: function (): void {\n        this.modelTaskDefinition = cloneDeep(this.taskDefinition);\n      },\n    },\n  },\n  methods: {\n    $gettext,\n    // An example of how you would write an event handler to replace v-model\n    // and completely avoid using modelTaskDefinition.\n    // I think it is OK for just one or two inputs, but if you have 10+ of them,\n    // then that would be a lot of boilerplate, and I prefer the solution\n    // using 'modelTaskDefinition', 'updateTaskDefinition' and the watcher\n    // to sync data in the other direction.\n    onInputAnswerCorrect(ev: InputEvent, answerIndex: number): void {\n      const value = (ev.target as HTMLInputElement).checked;\n      this.taskEditor!.performEdit({\n        newTaskDefinition: produce(\n          this.taskDefinition,\n          (draft: QuestionTask) => {\n            draft.answers[answerIndex].correct = value;\n          }\n        ),\n        undoBatch: {},\n      });\n    },\n    onEditQuestion(data: string): void {\n      // Copy new data from wysiwyg editor into task definition\n      this.taskEditor!.performEdit({\n        newTaskDefinition: produce(\n          this.taskDefinition,\n          (draft: QuestionTask) => {\n            draft.question = data;\n          }\n        ),\n        undoBatch: 'taskDefinition.question',\n      });\n      // Note this is not a perfect 'undoBatch' because normally you expect\n      // a sequence of edits in the text to produce a sequence of undo/redo\n      // steps... E.g. you type in one place, click to navigate to a different\n      // place in the text, then start typing there... You would expect\n      // this to produce two distinct steps in the undo/redo stack.\n      // But if the 'undoBatch' is simply 'taskDefinition.question', the\n      // undo/redo states will all be merged together into one step.\n      // TODO can we access CKEditor internal state to produce a more apt\n      // 'undoBatch'?\n    },\n\n    updateTaskDefinition(undoBatch?: unknown) {\n      // Synchronize state modelTaskDefinition -> taskDefinition.\n      this.taskEditor!.performEdit({\n        newTaskDefinition: cloneDeep(this.modelTaskDefinition),\n        undoBatch: undoBatch ?? {},\n      });\n    },\n\n    addAnswer(): void {\n      this.taskEditor!.performEdit({\n        newTaskDefinition: produce(\n          this.taskDefinition,\n          (draft: QuestionTask) => {\n            draft.answers.push({\n              uuid: v4(),\n              text: this.$gettext('Neue Antwort'),\n              correct: true,\n              strings: {\n                hint: '',\n                feedbackSelected: '',\n                feedbackNotSelected: '',\n              },\n            });\n          }\n        ),\n      });\n    },\n\n    removeAnswer(answerToRemoveIndex: number): void {\n      this.taskEditor!.performEdit({\n        newTaskDefinition: produce(\n          this.taskDefinition,\n          (draft: QuestionTask) => {\n            draft.answers.splice(answerToRemoveIndex, 1);\n          }\n        ),\n        undoBatch: {},\n      });\n    },\n\n    urlForIcon(iconName: string) {\n      return (\n        window.STUDIP.ASSETS_URL + 'images/icons/blue/' + iconName + '.svg'\n      );\n    },\n\n    updateFeedback(updatedFeedback: Feedback[], undoBatch: unknown) {\n      this.taskEditor!.performEdit({\n        newTaskDefinition: produce(\n          this.taskDefinition,\n          (taskDraft: QuestionTask) => {\n            taskDraft.feedback = updatedFeedback;\n          }\n        ),\n        undoBatch: undoBatch,\n      });\n    },\n\n    updateResultMessage(updatedResultMessage: string) {\n      this.taskEditor!.performEdit({\n        newTaskDefinition: produce(\n          this.taskDefinition,\n          (taskDraft: QuestionTask) => {\n            taskDraft.strings.resultMessage = updatedResultMessage;\n          }\n        ),\n        undoBatch: 'taskDefinition.strings.resultMessage',\n      });\n    },\n  },\n});\n</script>\n\n<style scoped>\n.answer {\n  max-width: 48em;\n}\n\n.answer-title {\n  position: relative;\n}\n\n.answer-row {\n  display: flex;\n  gap: 0.25em;\n  margin-bottom: 0.75em;\n}\n\n.button-with-icon {\n  /* Positioning */\n  position: absolute;\n  top: 50%;\n  right: 0.1em;\n  transform: translateY(-50%);\n  z-index: 10;\n\n  /* Children layout*/\n  display: flex;\n  justify-content: center;\n  align-items: center;\n\n  /* Shape & size */\n  aspect-ratio: 1 / 1;\n  height: 100%;\n  width: auto;\n  border-radius: 50%;\n\n  /* Appearance */\n  border: 1px solid rgba(40, 73, 124, 0.1); /* Light translucent border for depth */\n}\n\n.button-with-icon:hover {\n  background: rgba(100%, 100%, 100%, 0.75); /* Lighter background on hover */\n}\n\n.feedback {\n  margin: 0.5em 0 0 0;\n}\n</style>\n","import { render } from \"./QuestionEditor.vue?vue&type=template&id=3555d82a&scoped=true&ts=true\"\nimport script from \"./QuestionEditor.vue?vue&type=script&lang=ts\"\nexport * from \"./QuestionEditor.vue?vue&type=script&lang=ts\"\n\nimport \"./QuestionEditor.vue?vue&type=style&index=0&id=3555d82a&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-3555d82a\"]])\n\nexport default __exports__","import { createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, vModelCheckbox as _vModelCheckbox, withDirectives as _withDirectives, toDisplayString as _toDisplayString, createCommentVNode as _createCommentVNode, createTextVNode as _createTextVNode, normalizeClass as _normalizeClass, vModelRadio as _vModelRadio, resolveComponent as _resolveComponent, createBlock as _createBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-46775c00\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"stud5p-task\" }\nconst _hoisted_2 = [\"innerHTML\"]\nconst _hoisted_3 = [\"value\", \"onUpdate:modelValue\", \"disabled\"]\nconst _hoisted_4 = [\"data-tooltip\"]\nconst _hoisted_5 = {\n  key: 0,\n  class: \"answer-feedback\"\n}\nconst _hoisted_6 = {\n  key: 1,\n  class: \"answer-feedback\"\n}\nconst _hoisted_7 = [\"value\", \"disabled\"]\nconst _hoisted_8 = [\"data-tooltip\"]\nconst _hoisted_9 = {\n  key: 0,\n  class: \"answer-feedback\"\n}\nconst _hoisted_10 = {\n  key: 1,\n  class: \"answer-feedback\"\n}\nconst _hoisted_11 = { class: \"feedback-and-button-container\" }\nconst _hoisted_12 = { class: \"button-panel\" }\nconst _hoisted_13 = [\"textContent\"]\nconst _hoisted_14 = [\"textContent\"]\nconst _hoisted_15 = [\"textContent\"]\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_FeedbackElement = _resolveComponent(\"FeedbackElement\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createElementVNode(\"div\", null, [\n      _createElementVNode(\"div\", {\n        innerHTML: this.task.question\n      }, null, 8, _hoisted_2),\n      (_ctx.task.canAnswerMultiple)\n        ? (_openBlock(true), _createElementBlock(_Fragment, { key: 0 }, _renderList(_ctx.answers, (answer) => {\n            return (_openBlock(), _createElementBlock(_Fragment, {\n              key: answer.uuid\n            }, [\n              _createElementVNode(\"label\", {\n                class: _normalizeClass(_ctx.classForAnswer(answer))\n              }, [\n                _withDirectives(_createElementVNode(\"input\", {\n                  type: \"checkbox\",\n                  class: \"answer-checkbox\",\n                  value: answer.text,\n                  \"onUpdate:modelValue\": ($event: any) => ((_ctx.selectedAnswers[answer.text]) = $event),\n                  disabled: _ctx.isSubmitted\n                }, null, 8, _hoisted_3), [\n                  [_vModelCheckbox, _ctx.selectedAnswers[answer.text]]\n                ]),\n                _createTextVNode(\" \" + _toDisplayString(answer.text), 1),\n                (answer.strings.hint && !_ctx.isSubmitted)\n                  ? (_openBlock(), _createElementBlock(\"span\", {\n                      key: 0,\n                      class: \"tooltip tooltip-icon answer-tooltip\",\n                      \"data-tooltip\": answer.strings.hint\n                    }, null, 8, _hoisted_4))\n                  : _createCommentVNode(\"\", true)\n              ], 2),\n              (_ctx.isSubmitted)\n                ? (_openBlock(), _createElementBlock(_Fragment, { key: 0 }, [\n                    (\n                answer.strings.feedbackSelected && _ctx.selectedAnswers[answer.text]\n              )\n                      ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, _toDisplayString(answer.strings.feedbackSelected), 1))\n                      : (\n                answer.strings.feedbackNotSelected &&\n                !_ctx.selectedAnswers[answer.text]\n              )\n                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_6, _toDisplayString(answer.strings.feedbackNotSelected), 1))\n                        : _createCommentVNode(\"\", true)\n                  ], 64))\n                : _createCommentVNode(\"\", true)\n            ], 64))\n          }), 128))\n        : (_openBlock(true), _createElementBlock(_Fragment, { key: 1 }, _renderList(_ctx.answers, (answer, i) => {\n            return (_openBlock(), _createElementBlock(_Fragment, { key: i }, [\n              _createElementVNode(\"label\", {\n                class: _normalizeClass(_ctx.classForAnswer(answer))\n              }, [\n                _withDirectives(_createElementVNode(\"input\", {\n                  type: \"radio\",\n                  class: \"answer-radiobutton\",\n                  value: answer,\n                  \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((_ctx.selectedAnswer) = $event)),\n                  disabled: _ctx.isSubmitted\n                }, null, 8, _hoisted_7), [\n                  [_vModelRadio, _ctx.selectedAnswer]\n                ]),\n                _createTextVNode(\" \" + _toDisplayString(answer.text) + \" \", 1),\n                (answer.strings.hint && !_ctx.isSubmitted)\n                  ? (_openBlock(), _createElementBlock(\"span\", {\n                      key: 0,\n                      class: \"tooltip tooltip-icon answer-tooltip\",\n                      \"data-tooltip\": answer.strings.hint\n                    }, null, 8, _hoisted_8))\n                  : _createCommentVNode(\"\", true)\n              ], 2),\n              (_ctx.isSubmitted)\n                ? (_openBlock(), _createElementBlock(_Fragment, { key: 0 }, [\n                    (answer.strings.feedbackSelected && _ctx.selectedAnswer == answer)\n                      ? (_openBlock(), _createElementBlock(\"div\", _hoisted_9, _toDisplayString(answer.strings.feedbackSelected), 1))\n                      : (\n                answer.strings.feedbackNotSelected && _ctx.selectedAnswer !== answer\n              )\n                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_10, _toDisplayString(answer.strings.feedbackNotSelected), 1))\n                        : _createCommentVNode(\"\", true)\n                  ], 64))\n                : _createCommentVNode(\"\", true)\n            ], 64))\n          }), 128))\n    ]),\n    _createElementVNode(\"div\", _hoisted_11, [\n      (_ctx.isSubmitted)\n        ? (_openBlock(), _createBlock(_component_FeedbackElement, {\n            key: 0,\n            \"achieved-points\": _ctx.points,\n            \"max-points\": _ctx.maxPoints,\n            \"result-message\": _ctx.resultMessage,\n            feedback: _ctx.task.feedback\n          }, null, 8, [\"achieved-points\", \"max-points\", \"result-message\", \"feedback\"]))\n        : _createCommentVNode(\"\", true),\n      _createElementVNode(\"div\", _hoisted_12, [\n        (_ctx.showCheckButton)\n          ? (_openBlock(), _createElementBlock(\"button\", {\n              key: 0,\n              textContent: _toDisplayString(this.task.strings.checkButton),\n              onClick: _cache[1] || (_cache[1] = \n//@ts-ignore\n(...args) => (_ctx.onClickCheckButton && _ctx.onClickCheckButton(...args))),\n              type: \"button\",\n              class: \"stud5p-button\"\n            }, null, 8, _hoisted_13))\n          : _createCommentVNode(\"\", true),\n        (_ctx.showRetryButton)\n          ? (_openBlock(), _createElementBlock(\"button\", {\n              key: 1,\n              textContent: _toDisplayString(this.task.strings.retryButton),\n              onClick: _cache[2] || (_cache[2] = \n//@ts-ignore\n(...args) => (_ctx.onClickRetryButton && _ctx.onClickRetryButton(...args))),\n              type: \"button\",\n              class: \"stud5p-button\"\n            }, null, 8, _hoisted_14))\n          : _createCommentVNode(\"\", true),\n        (_ctx.showSolutionsButton)\n          ? (_openBlock(), _createElementBlock(\"button\", {\n              key: 2,\n              textContent: _toDisplayString(this.task.strings.solutionsButton),\n              onClick: _cache[3] || (_cache[3] = \n//@ts-ignore\n(...args) => (_ctx.onClickShowSolutionsButton && _ctx.onClickShowSolutionsButton(...args))),\n              type: \"button\",\n              class: \"stud5p-button\"\n            }, null, 8, _hoisted_15))\n          : _createCommentVNode(\"\", true)\n      ])\n    ])\n  ]))\n}","<template>\n  <div class=\"stud5p-task\">\n    <div>\n      <div v-html=\"this.task.question\" />\n      <template v-if=\"task.canAnswerMultiple\">\n        <template v-for=\"answer in answers\" :key=\"answer.uuid\">\n          <label :class=\"classForAnswer(answer)\">\n            <input\n              type=\"checkbox\"\n              class=\"answer-checkbox\"\n              :value=\"answer.text\"\n              v-model=\"selectedAnswers[answer.text]\"\n              :disabled=\"isSubmitted\"\n            />\n            {{ answer.text }}\n            <!--   Data-tooltip is a reference used by Stud.IP's javascript code based on jQuery.\n            See resources/assets/javascripts/bootstrap/tooltip.js.\n            This code has the limitation in 5.4 that it only reads the\n            content stored in this attribute a single time.  This is ultimately\n            due to the way it is accessed:\n            Line 13: let data = $(this).data();\n            This StackOverflow answer explains that the data attribute is only\n            read once and cached afterwards: https://stackoverflow.com/a/28176641\n            That is why the tooltip has not updated reactively in the viewer.\n            You will have to work around it somehow.\n            I found that deleting the whole 'hint' causes the hint icon to\n            disappear. Then, adding a new hint with different text inside\n            causes it to reappear with the updated text. -->\n            <span\n              v-if=\"answer.strings.hint && !isSubmitted\"\n              class=\"tooltip tooltip-icon answer-tooltip\"\n              :data-tooltip=\"answer.strings.hint\"\n            />\n          </label>\n\n          <template v-if=\"isSubmitted\">\n            <div\n              v-if=\"\n                answer.strings.feedbackSelected && selectedAnswers[answer.text]\n              \"\n              class=\"answer-feedback\"\n            >\n              {{ answer.strings.feedbackSelected }}\n            </div>\n\n            <div\n              v-else-if=\"\n                answer.strings.feedbackNotSelected &&\n                !selectedAnswers[answer.text]\n              \"\n              class=\"answer-feedback\"\n            >\n              {{ answer.strings.feedbackNotSelected }}\n            </div>\n          </template>\n        </template>\n      </template>\n\n      <template v-else>\n        <template v-for=\"(answer, i) in answers\" :key=\"i\">\n          <label :class=\"classForAnswer(answer)\">\n            <input\n              type=\"radio\"\n              class=\"answer-radiobutton\"\n              :value=\"answer\"\n              v-model=\"selectedAnswer\"\n              :disabled=\"isSubmitted\"\n            />\n            {{ answer.text }}\n            <span\n              v-if=\"answer.strings.hint && !isSubmitted\"\n              class=\"tooltip tooltip-icon answer-tooltip\"\n              :data-tooltip=\"answer.strings.hint\"\n            />\n          </label>\n\n          <template v-if=\"isSubmitted\">\n            <div\n              v-if=\"answer.strings.feedbackSelected && selectedAnswer == answer\"\n              class=\"answer-feedback\"\n            >\n              {{ answer.strings.feedbackSelected }}\n            </div>\n\n            <div\n              v-else-if=\"\n                answer.strings.feedbackNotSelected && selectedAnswer !== answer\n              \"\n              class=\"answer-feedback\"\n            >\n              {{ answer.strings.feedbackNotSelected }}\n            </div>\n          </template>\n        </template>\n      </template>\n    </div>\n\n    <div class=\"feedback-and-button-container\">\n      <FeedbackElement\n        v-if=\"isSubmitted\"\n        :achieved-points=\"points\"\n        :max-points=\"maxPoints\"\n        :result-message=\"resultMessage\"\n        :feedback=\"task.feedback\"\n      />\n\n      <div class=\"button-panel\">\n        <button\n          v-if=\"showCheckButton\"\n          v-text=\"this.task.strings.checkButton\"\n          @click=\"onClickCheckButton\"\n          type=\"button\"\n          class=\"stud5p-button\"\n        />\n\n        <button\n          v-if=\"showRetryButton\"\n          v-text=\"this.task.strings.retryButton\"\n          @click=\"onClickRetryButton\"\n          type=\"button\"\n          class=\"stud5p-button\"\n        />\n\n        <button\n          v-if=\"showSolutionsButton\"\n          v-text=\"this.task.strings.solutionsButton\"\n          @click=\"onClickShowSolutionsButton\"\n          type=\"button\"\n          class=\"stud5p-button\"\n        />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, PropType } from 'vue';\nimport { QuestionAnswer, QuestionTask } from '@/models/TaskDefinition';\nimport { $gettext } from '@/language/gettext';\nimport FeedbackElement from '@/components/FeedbackElement.vue';\n\nexport default defineComponent({\n  name: 'QuestionViewer',\n  props: {\n    task: {\n      type: Object as PropType<QuestionTask>,\n      required: true,\n    },\n  },\n  components: { FeedbackElement },\n  data() {\n    return {\n      selectedAnswers: {} as Record<string, boolean>,\n      selectedAnswer: {} as QuestionAnswer | undefined,\n      isSubmitted: false,\n      showSolutions: false,\n    };\n  },\n  methods: {\n    $gettext,\n\n    onClickCheckButton(): void {\n      this.isSubmitted = true;\n    },\n\n    onClickRetryButton(): void {\n      this.isSubmitted = false;\n      this.showSolutions = false;\n      this.selectedAnswers = {};\n      this.selectedAnswer = undefined;\n    },\n\n    onClickShowSolutionsButton(): void {\n      this.showSolutions = true;\n    },\n\n    classForAnswer(answer: QuestionAnswer): string {\n      if (this.showSolutions) {\n        if (answer.correct) return 'answer correct';\n      }\n\n      if (this.isSubmitted) {\n        if (this.task.canAnswerMultiple) {\n          if (this.selectedAnswers[answer.text]) {\n            if (answer.correct) {\n              return 'answer correct';\n            } else {\n              return 'answer incorrect';\n            }\n          } else {\n            return 'answer submitted';\n          }\n        } else {\n          if (this.selectedAnswer === answer) {\n            if (answer.correct) {\n              return 'answer correct';\n            } else {\n              return 'answer incorrect';\n            }\n          } else {\n            return 'answer submitted';\n          }\n        }\n      } else {\n        return 'answer unsubmitted';\n      }\n    },\n  },\n  computed: {\n    answers(): QuestionAnswer[] {\n      if (this.task.randomOrder) {\n        return this.task.answers\n          .map((answer) => ({ answer: answer, sort: Math.random() }))\n          .sort((answer1, answer2) => answer1.sort - answer2.sort)\n          .map(({ answer }) => answer);\n      } else {\n        return this.task.answers;\n      }\n    },\n\n    maxPoints(): number {\n      if (this.task.canAnswerMultiple) {\n        let maxPoints = 0;\n        this.task.answers.forEach((answer) => {\n          if (answer.correct) {\n            maxPoints++;\n          }\n        });\n        return maxPoints;\n      } else {\n        return 1;\n      }\n    },\n\n    points(): number {\n      if (this.task.canAnswerMultiple) {\n        let points = 0;\n\n        this.task.answers.forEach((answer) => {\n          if (this.selectedAnswers[answer.text]) {\n            if (answer.correct) {\n              points++;\n            } else {\n              points--;\n            }\n          }\n        });\n\n        // Cannot get less than 0 points\n        if (points < 0) points = 0;\n\n        return points;\n      } else {\n        return this.selectedAnswer && this.selectedAnswer.correct ? 1 : 0;\n      }\n    },\n\n    reachedMaxPoints(): boolean {\n      return this.points === this.maxPoints;\n    },\n\n    showCheckButton(): boolean {\n      return !this.isSubmitted;\n    },\n\n    showRetryButton(): boolean {\n      return (\n        this.task.retryAllowed && this.isSubmitted && !this.reachedMaxPoints\n      );\n    },\n\n    showSolutionsButton(): boolean {\n      return (\n        this.task.showSolutionsAllowed &&\n        this.isSubmitted &&\n        !this.showSolutions &&\n        !this.reachedMaxPoints\n      );\n    },\n\n    resultMessage(): string {\n      if (!this.task.strings.resultMessage) return '';\n\n      let resultMessage = this.task.strings.resultMessage.replace(\n        ':correct',\n        this.points.toString()\n      );\n\n      resultMessage = resultMessage.replace(\n        ':total',\n        this.maxPoints.toString()\n      );\n\n      return resultMessage;\n    },\n  },\n});\n</script>\n\n<style scoped>\n.answer {\n  display: flex;\n  justify-content: flex-start;\n  align-items: center;\n  border-radius: 0.3em;\n  margin: 0.5em 0;\n\n  border: 0.1em solid transparent;\n  background: #ddd;\n}\n\n.unsubmitted {\n  cursor: pointer;\n}\n\n.unsubmitted:hover {\n  background: #ececec;\n}\n\n.submitted {\n  cursor: default;\n}\n\n.correct {\n  border: 0.1em solid #b6e4ce;\n  background: #b6e4ce;\n  color: #255c41;\n  box-shadow: 0 0.1em 0 #a2bdb0;\n}\n\n.incorrect {\n  border: 0.1em solid #fbd7d8;\n  background: #fbd7d8;\n  color: #b71c1c;\n  box-shadow: 0 0.1em 0 #deb8b8;\n}\n\n.answer-checkbox,\n.answer-radiobutton {\n  margin: 0 0.4em 0 0.4em;\n}\n\n.answer-tooltip {\n  display: flex;\n  margin-left: 0.25em;\n}\n\n.answer-feedback {\n  margin-left: 0.25em;\n  border-left: 6px solid rgba(10, 10, 10, 0.1) !important;\n  padding: 0.01em 16px;\n}\n</style>\n","import { render } from \"./QuestionViewer.vue?vue&type=template&id=46775c00&scoped=true&ts=true\"\nimport script from \"./QuestionViewer.vue?vue&type=script&lang=ts\"\nexport * from \"./QuestionViewer.vue?vue&type=script&lang=ts\"\n\nimport \"./QuestionViewer.vue?vue&type=style&index=0&id=46775c00&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-46775c00\"]])\n\nexport default __exports__","import { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, withModifiers as _withModifiers, normalizeClass as _normalizeClass, resolveComponent as _resolveComponent, createBlock as _createBlock, createCommentVNode as _createCommentVNode, vModelCheckbox as _vModelCheckbox, withDirectives as _withDirectives, createTextVNode as _createTextVNode, vModelText as _vModelText, createVNode as _createVNode, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-79b0e546\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"stud5p-task\" }\nconst _hoisted_2 = { class: \"default\" }\nconst _hoisted_3 = { class: \"sequencing-editor\" }\nconst _hoisted_4 = { class: \"cards-list\" }\nconst _hoisted_5 = [\"onClick\"]\nconst _hoisted_6 = [\"textContent\"]\nconst _hoisted_7 = [\"onClick\", \"aria-label\"]\nconst _hoisted_8 = [\"src\"]\nconst _hoisted_9 = {\n  key: 1,\n  class: \"no-card-selected-placeholder\"\n}\nconst _hoisted_10 = { class: \"collapsable collapsed\" }\nconst _hoisted_11 = { class: \"collapsable collapsed\" }\nconst _hoisted_12 = [\"disabled\"]\nconst _hoisted_13 = [\"disabled\"]\nconst _hoisted_14 = [\"disabled\"]\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_SequencingEditorCard = _resolveComponent(\"SequencingEditorCard\")!\n  const _component_FeedbackEditor = _resolveComponent(\"FeedbackEditor\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createElementVNode(\"form\", _hoisted_2, [\n      _createElementVNode(\"fieldset\", _hoisted_3, [\n        _createElementVNode(\"legend\", null, _toDisplayString(_ctx.$gettext('Sequencing')), 1),\n        _createElementVNode(\"div\", _hoisted_4, [\n          (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.modelTaskDefinition.cards, (card, index) => {\n            return (_openBlock(), _createElementBlock(\"div\", {\n              key: card.uuid,\n              class: _normalizeClass({\n              'cards-list-item': true,\n              'selected-card': index === _ctx.selectedCardIndex,\n            }),\n              onClick: ($event: any) => (_ctx.selectCard(index))\n            }, [\n              _createElementVNode(\"div\", {\n                textContent: _toDisplayString(_ctx.listEntryText(index, card)),\n                class: \"list-entry-text\"\n              }, null, 8, _hoisted_6),\n              _createElementVNode(\"button\", {\n                type: \"button\",\n                class: \"remove-card-button\",\n                onClick: _withModifiers(($event: any) => (_ctx.deleteCard(index)), [\"stop\"]),\n                \"aria-label\": _ctx.$gettext('Karte lschen')\n              }, [\n                _createElementVNode(\"img\", {\n                  src: _ctx.urlForIcon('trash'),\n                  alt: \"\"\n                }, null, 8, _hoisted_8)\n              ], 8, _hoisted_7)\n            ], 10, _hoisted_5))\n          }), 128)),\n          _createElementVNode(\"button\", {\n            type: \"button\",\n            class: \"button add add-card-button\",\n            onClick: _cache[0] || (_cache[0] = \n//@ts-ignore\n(...args) => (_ctx.addCard && _ctx.addCard(...args)))\n          }, _toDisplayString(_ctx.$gettext('Karte hinzufgen')), 1)\n        ]),\n        (_ctx.modelTaskDefinition.cards[_ctx.selectedCardIndex])\n          ? (_openBlock(), _createBlock(_component_SequencingEditorCard, {\n              key: 0,\n              card: _ctx.modelTaskDefinition.cards[_ctx.selectedCardIndex],\n              \"card-index\": _ctx.selectedCardIndex\n            }, null, 8, [\"card\", \"card-index\"]))\n          : (_openBlock(), _createElementBlock(\"fieldset\", _hoisted_9, [\n              _createElementVNode(\"legend\", null, _toDisplayString(_ctx.$gettext('Keine Karte ausgewhlt')), 1)\n            ]))\n      ]),\n      _createElementVNode(\"fieldset\", _hoisted_10, [\n        _createElementVNode(\"legend\", null, _toDisplayString(_ctx.$gettext('Einstellungen')), 1),\n        _createElementVNode(\"label\", null, [\n          _withDirectives(_createElementVNode(\"input\", {\n            \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event: any) => ((_ctx.modelTaskDefinition.retryAllowed) = $event)),\n            onChange: _cache[2] || (_cache[2] = \n//@ts-ignore\n(...args) => (_ctx.updateTaskDefinition && _ctx.updateTaskDefinition(...args))),\n            type: \"checkbox\"\n          }, null, 544), [\n            [_vModelCheckbox, _ctx.modelTaskDefinition.retryAllowed]\n          ]),\n          _createTextVNode(\" \" + _toDisplayString(_ctx.$gettext('Mehrere Versuche erlauben')), 1)\n        ]),\n        _createElementVNode(\"label\", null, [\n          _withDirectives(_createElementVNode(\"input\", {\n            \"onUpdate:modelValue\": _cache[3] || (_cache[3] = ($event: any) => ((_ctx.modelTaskDefinition.resumeAllowed) = $event)),\n            onChange: _cache[4] || (_cache[4] = \n//@ts-ignore\n(...args) => (_ctx.updateTaskDefinition && _ctx.updateTaskDefinition(...args))),\n            type: \"checkbox\"\n          }, null, 544), [\n            [_vModelCheckbox, _ctx.modelTaskDefinition.resumeAllowed]\n          ]),\n          _createTextVNode(\" \" + _toDisplayString(_ctx.$gettext('Fortsetzen des aktuellen Spielstands erlauben')), 1)\n        ]),\n        _createElementVNode(\"label\", null, [\n          _withDirectives(_createElementVNode(\"input\", {\n            \"onUpdate:modelValue\": _cache[5] || (_cache[5] = ($event: any) => ((_ctx.modelTaskDefinition.showSolutionsAllowed) = $event)),\n            onChange: _cache[6] || (_cache[6] = \n//@ts-ignore\n(...args) => (_ctx.updateTaskDefinition && _ctx.updateTaskDefinition(...args))),\n            type: \"checkbox\"\n          }, null, 544), [\n            [_vModelCheckbox, _ctx.modelTaskDefinition.showSolutionsAllowed]\n          ]),\n          _createTextVNode(\" \" + _toDisplayString(_ctx.$gettext('Lsungen anzeigen erlauben')), 1)\n        ])\n      ]),\n      _createElementVNode(\"fieldset\", _hoisted_11, [\n        _createElementVNode(\"legend\", null, _toDisplayString(_ctx.$gettext('Beschriftungen')), 1),\n        _createElementVNode(\"label\", null, [\n          _createTextVNode(_toDisplayString(_ctx.$gettext('Text fr berprfen-Button:')) + \" \", 1),\n          _withDirectives(_createElementVNode(\"input\", {\n            \"onUpdate:modelValue\": _cache[7] || (_cache[7] = ($event: any) => ((_ctx.modelTaskDefinition.strings.checkButton) = $event)),\n            onInput: _cache[8] || (_cache[8] = ($event: any) => (_ctx.updateTaskDefinition('taskDefinition.strings.checkButton'))),\n            type: \"text\"\n          }, null, 544), [\n            [_vModelText, _ctx.modelTaskDefinition.strings.checkButton]\n          ])\n        ]),\n        _createElementVNode(\"label\", {\n          class: _normalizeClass({ 'setting-disabled': !_ctx.modelTaskDefinition.retryAllowed })\n        }, [\n          _createTextVNode(_toDisplayString(_ctx.$gettext('Text fr Wiederholen-Button:')) + \" \", 1),\n          _withDirectives(_createElementVNode(\"input\", {\n            \"onUpdate:modelValue\": _cache[9] || (_cache[9] = ($event: any) => ((_ctx.modelTaskDefinition.strings.retryButton) = $event)),\n            onInput: _cache[10] || (_cache[10] = ($event: any) => (_ctx.updateTaskDefinition('taskDefinition.strings.retryButton'))),\n            disabled: !_ctx.modelTaskDefinition.retryAllowed,\n            type: \"text\"\n          }, null, 40, _hoisted_12), [\n            [_vModelText, _ctx.modelTaskDefinition.strings.retryButton]\n          ])\n        ], 2),\n        _createElementVNode(\"label\", {\n          class: _normalizeClass({ 'setting-disabled': !_ctx.modelTaskDefinition.resumeAllowed })\n        }, [\n          _createTextVNode(_toDisplayString(_ctx.$gettext('Text fr Fortsetzen-Button:')) + \" \", 1),\n          _withDirectives(_createElementVNode(\"input\", {\n            \"onUpdate:modelValue\": _cache[11] || (_cache[11] = ($event: any) => ((_ctx.modelTaskDefinition.strings.resumeButton) = $event)),\n            onInput: _cache[12] || (_cache[12] = ($event: any) => (_ctx.updateTaskDefinition('taskDefinition.strings.resumeButton'))),\n            disabled: !_ctx.modelTaskDefinition.resumeAllowed,\n            type: \"text\"\n          }, null, 40, _hoisted_13), [\n            [_vModelText, _ctx.modelTaskDefinition.strings.resumeButton]\n          ])\n        ], 2),\n        _createElementVNode(\"label\", {\n          class: _normalizeClass({\n            'setting-disabled': !_ctx.modelTaskDefinition.showSolutionsAllowed,\n          })\n        }, [\n          _createTextVNode(_toDisplayString(_ctx.$gettext('Text fr Lsungen-Button:')) + \" \", 1),\n          _withDirectives(_createElementVNode(\"input\", {\n            \"onUpdate:modelValue\": _cache[13] || (_cache[13] = ($event: any) => ((_ctx.modelTaskDefinition.strings.solutionsButton) = $event)),\n            onInput: _cache[14] || (_cache[14] = ($event: any) => (\n              _ctx.updateTaskDefinition('taskDefinition.strings.solutionsButton')\n            )),\n            disabled: !_ctx.modelTaskDefinition.showSolutionsAllowed,\n            type: \"text\"\n          }, null, 40, _hoisted_14), [\n            [_vModelText, _ctx.modelTaskDefinition.strings.solutionsButton]\n          ])\n        ], 2)\n      ]),\n      _createVNode(_component_FeedbackEditor, {\n        feedback: _ctx.modelTaskDefinition.feedback,\n        \"result-message\": _ctx.modelTaskDefinition.strings.resultMessage,\n        \"onUpdate:feedback\": _ctx.updateFeedback,\n        \"onUpdate:resultMessage\": _ctx.updateResultMessage\n      }, null, 8, [\"feedback\", \"result-message\", \"onUpdate:feedback\", \"onUpdate:resultMessage\"])\n    ])\n  ]))\n}","<template>\n  <div class=\"stud5p-task\">\n    <form class=\"default\">\n      <fieldset class=\"sequencing-editor\">\n        <legend>{{ $gettext('Sequencing') }}</legend>\n\n        <div class=\"cards-list\">\n          <div\n            v-for=\"(card, index) in modelTaskDefinition.cards\"\n            :key=\"card.uuid\"\n            :class=\"{\n              'cards-list-item': true,\n              'selected-card': index === selectedCardIndex,\n            }\"\n            @click=\"selectCard(index)\"\n          >\n            <div v-text=\"listEntryText(index, card)\" class=\"list-entry-text\" />\n\n            <!-- Apply .stop modifier so that the selectCard event handler on the\n            parent element doesn't get called when the delete button is clicked -->\n            <button\n              type=\"button\"\n              class=\"remove-card-button\"\n              @click.stop=\"deleteCard(index)\"\n              :aria-label=\"$gettext('Karte lschen')\"\n            >\n              <img :src=\"urlForIcon('trash')\" alt=\"\" />\n            </button>\n          </div>\n\n          <button\n            type=\"button\"\n            class=\"button add add-card-button\"\n            @click=\"addCard\"\n          >\n            {{ $gettext('Karte hinzufgen') }}\n          </button>\n        </div>\n\n        <SequencingEditorCard\n          v-if=\"modelTaskDefinition.cards[selectedCardIndex]\"\n          :card=\"modelTaskDefinition.cards[selectedCardIndex]\"\n          :card-index=\"selectedCardIndex\"\n        />\n\n        <fieldset v-else class=\"no-card-selected-placeholder\">\n          <legend>\n            {{ $gettext('Keine Karte ausgewhlt') }}\n          </legend>\n        </fieldset>\n      </fieldset>\n\n      <fieldset class=\"collapsable collapsed\">\n        <legend>{{ $gettext('Einstellungen') }}</legend>\n\n        <label>\n          <input\n            v-model=\"modelTaskDefinition.retryAllowed\"\n            @change=\"updateTaskDefinition\"\n            type=\"checkbox\"\n          />\n          {{ $gettext('Mehrere Versuche erlauben') }}\n        </label>\n\n        <label>\n          <input\n            v-model=\"modelTaskDefinition.resumeAllowed\"\n            @change=\"updateTaskDefinition\"\n            type=\"checkbox\"\n          />\n          {{ $gettext('Fortsetzen des aktuellen Spielstands erlauben') }}\n        </label>\n\n        <label>\n          <input\n            v-model=\"modelTaskDefinition.showSolutionsAllowed\"\n            @change=\"updateTaskDefinition\"\n            type=\"checkbox\"\n          />\n          {{ $gettext('Lsungen anzeigen erlauben') }}\n        </label>\n      </fieldset>\n\n      <fieldset class=\"collapsable collapsed\">\n        <legend>{{ $gettext('Beschriftungen') }}</legend>\n\n        <label>\n          {{ $gettext('Text fr berprfen-Button:') }}\n          <input\n            v-model=\"modelTaskDefinition.strings.checkButton\"\n            @input=\"updateTaskDefinition('taskDefinition.strings.checkButton')\"\n            type=\"text\"\n          />\n        </label>\n\n        <label\n          :class=\"{ 'setting-disabled': !modelTaskDefinition.retryAllowed }\"\n        >\n          {{ $gettext('Text fr Wiederholen-Button:') }}\n          <input\n            v-model=\"modelTaskDefinition.strings.retryButton\"\n            @input=\"updateTaskDefinition('taskDefinition.strings.retryButton')\"\n            :disabled=\"!modelTaskDefinition.retryAllowed\"\n            type=\"text\"\n          />\n        </label>\n\n        <label\n          :class=\"{ 'setting-disabled': !modelTaskDefinition.resumeAllowed }\"\n        >\n          {{ $gettext('Text fr Fortsetzen-Button:') }}\n          <input\n            v-model=\"modelTaskDefinition.strings.resumeButton\"\n            @input=\"updateTaskDefinition('taskDefinition.strings.resumeButton')\"\n            :disabled=\"!modelTaskDefinition.resumeAllowed\"\n            type=\"text\"\n          />\n        </label>\n\n        <label\n          :class=\"{\n            'setting-disabled': !modelTaskDefinition.showSolutionsAllowed,\n          }\"\n        >\n          {{ $gettext('Text fr Lsungen-Button:') }}\n          <input\n            v-model=\"modelTaskDefinition.strings.solutionsButton\"\n            @input=\"\n              updateTaskDefinition('taskDefinition.strings.solutionsButton')\n            \"\n            :disabled=\"!modelTaskDefinition.showSolutionsAllowed\"\n            type=\"text\"\n          />\n        </label>\n      </fieldset>\n\n      <FeedbackEditor\n        :feedback=\"modelTaskDefinition.feedback\"\n        :result-message=\"modelTaskDefinition.strings.resultMessage\"\n        @update:feedback=\"updateFeedback\"\n        @update:result-message=\"updateResultMessage\"\n      />\n    </form>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, inject, PropType } from 'vue';\nimport {\n  LernmoduleMultimediaElement,\n  SequencingTask,\n} from '@/models/TaskDefinition';\nimport { Feedback } from '@/models/common';\nimport { $gettext } from '@/language/gettext';\nimport produce from 'immer';\nimport { v4 } from 'uuid';\nimport SequencingEditorCard from '@/components/SequencingEditorCard.vue';\nimport FeedbackEditor from '@/components/FeedbackEditor.vue';\nimport {\n  TaskEditorState,\n  taskEditorStateSymbol,\n} from '@/components/taskEditorState';\nimport { cloneDeep } from 'lodash';\n\nexport default defineComponent({\n  name: 'SequencingEditor',\n  components: { SequencingEditorCard, FeedbackEditor },\n  setup() {\n    return {\n      taskEditor: inject<TaskEditorState>(taskEditorStateSymbol),\n    };\n  },\n  props: {\n    taskDefinition: {\n      type: Object as PropType<SequencingTask>,\n      required: true,\n    },\n  },\n  data() {\n    return {\n      selectedCardIndex: -1,\n      modelTaskDefinition: cloneDeep(this.taskDefinition),\n    };\n  },\n  watch: {\n    // Synchronize state taskDefinition -> modelTaskDefinition.\n    taskDefinition: {\n      immediate: true,\n      handler: function (): void {\n        this.modelTaskDefinition = cloneDeep(this.taskDefinition);\n      },\n    },\n  },\n  beforeMount(): void {\n    if (this.modelTaskDefinition.cards.length > 0) {\n      this.selectedCardIndex = 0;\n    }\n  },\n  methods: {\n    $gettext,\n\n    urlForIcon(iconName: string) {\n      return (\n        window.STUDIP.ASSETS_URL + 'images/icons/blue/' + iconName + '.svg'\n      );\n    },\n\n    updateTaskDefinition(undoBatch?: unknown) {\n      // Synchronize state modelTaskDefinition -> taskDefinition.\n      this.taskEditor!.performEdit({\n        newTaskDefinition: cloneDeep(this.modelTaskDefinition),\n        undoBatch: undoBatch ?? {},\n      });\n    },\n\n    selectCard(index: number) {\n      this.selectedCardIndex = index;\n    },\n\n    addCard() {\n      this.modelTaskDefinition = produce(this.modelTaskDefinition, (draft) => {\n        draft.cards.push({\n          type: 'image',\n          uuid: v4(),\n          file_id: '',\n          altText: '',\n        });\n      });\n\n      this.updateTaskDefinition();\n\n      // Select the newly inserted image\n      this.selectedCardIndex = this.modelTaskDefinition.cards.length - 1;\n    },\n\n    deleteCard(index: number) {\n      this.modelTaskDefinition = produce(this.modelTaskDefinition, (draft) => {\n        draft.cards.splice(index, 1);\n      });\n\n      this.updateTaskDefinition();\n\n      // Adjust the selection index so the selected card doesn't unexpectedly change\n      if (index <= this.selectedCardIndex) {\n        this.selectedCardIndex = this.selectedCardIndex - 1;\n      }\n    },\n\n    listEntryText(index: number, card: LernmoduleMultimediaElement) {\n      let text = index + 1 + '. ';\n\n      if (card.type === 'image' && card.altText != '') {\n        text += card.altText;\n      } else {\n        text += $gettext('Bild');\n      }\n      return text;\n    },\n\n    updateFeedback(updatedFeedback: Feedback[]) {\n      this.taskEditor!.performEdit({\n        newTaskDefinition: produce(\n          this.modelTaskDefinition,\n          (taskDraft: SequencingTask) => {\n            taskDraft.feedback = updatedFeedback;\n          }\n        ),\n        undoBatch: 'taskDefinition.feedback',\n      });\n    },\n\n    updateResultMessage(updatedResultMessage: string) {\n      this.taskEditor!.performEdit({\n        newTaskDefinition: produce(\n          this.modelTaskDefinition,\n          (taskDraft: SequencingTask) => {\n            taskDraft.strings.resultMessage = updatedResultMessage;\n          }\n        ),\n        undoBatch: 'taskDefinition.strings.resultMessage',\n      });\n    },\n  },\n});\n</script>\n\n<style scoped>\n.sequencing-editor {\n  display: flex;\n  gap: 1em;\n}\n\n.cards-list {\n  display: flex;\n  flex-direction: column;\n  flex: 0 0 200px;\n  max-width: 14em;\n}\n\n.cards-list-item {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  border: transparent 2px solid;\n  padding: 2px;\n  cursor: pointer;\n  user-select: none;\n}\n\n.cards-list-item:last-of-type {\n  margin-bottom: 0.8em;\n}\n\n.selected-card {\n  border: #0a78d1 2px solid;\n}\n\n.list-entry-text {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  max-width: 11em;\n}\n\n.remove-card-button {\n  aspect-ratio: 1;\n  display: flex;\n  align-items: center;\n  border: 1px solid #28497c;\n  color: #28497c;\n  background: #fff;\n  cursor: pointer;\n}\n\n.remove-card-button:hover {\n  background: rgba(109, 114, 122, 0.2);\n}\n\n.add-card-button {\n  margin: 0 0 0 0;\n}\n\n.no-card-selected-placeholder {\n  flex: 1 1 auto;\n  height: 150px;\n}\n</style>\n","import { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, createTextVNode as _createTextVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, createBlock as _createBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-20dc9589\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"sequencing-editor-card\" }\nconst _hoisted_2 = {\n  key: 0,\n  class: \"image-card-container\"\n}\nconst _hoisted_3 = { class: \"multimedia-element-wrapper\" }\nconst _hoisted_4 = { style: {\"align-self\":\"stretch\"} }\nconst _hoisted_5 = [\"value\"]\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_MultimediaElement = _resolveComponent(\"MultimediaElement\")!\n  const _component_FileUpload = _resolveComponent(\"FileUpload\")!\n\n  return (_openBlock(), _createElementBlock(\"fieldset\", _hoisted_1, [\n    _createElementVNode(\"legend\", null, _toDisplayString(_ctx.$gettext('Karte')), 1),\n    _createElementVNode(\"label\", null, _toDisplayString(_ctx.$gettext('Bild')), 1),\n    (_ctx.card.type == 'image' && _ctx.card.file_id)\n      ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n          _createElementVNode(\"div\", _hoisted_3, [\n            _createVNode(_component_MultimediaElement, { element: _ctx.card }, null, 8, [\"element\"])\n          ]),\n          _createElementVNode(\"button\", {\n            type: \"button\",\n            onClick: _cache[0] || (_cache[0] = \n//@ts-ignore\n(...args) => (_ctx.onClickDeleteImage && _ctx.onClickDeleteImage(...args))),\n            class: \"button trash settings-item\"\n          }, _toDisplayString(_ctx.$gettext('Bild lschen')), 1),\n          _createElementVNode(\"label\", _hoisted_4, [\n            _createTextVNode(_toDisplayString(_ctx.$gettext('Bildbeschreibung')) + \" \", 1),\n            _createElementVNode(\"input\", {\n              type: \"text\",\n              value: _ctx.card.altText,\n              onInput: _cache[1] || (_cache[1] = \n//@ts-ignore\n(...args) => (_ctx.onInputAltText && _ctx.onInputAltText(...args))),\n              class: \"settings-item\"\n            }, null, 40, _hoisted_5)\n          ])\n        ]))\n      : (_openBlock(), _createBlock(_component_FileUpload, {\n          key: 1,\n          onFileUploaded: _ctx.onUploadImage\n        }, null, 8, [\"onFileUploaded\"]))\n  ]))\n}","<template>\n  <fieldset class=\"sequencing-editor-card\">\n    <legend>{{ $gettext('Karte') }}</legend>\n\n    <label>{{ $gettext('Bild') }}</label>\n    <div\n      v-if=\"card.type == 'image' && card.file_id\"\n      class=\"image-card-container\"\n    >\n      <div class=\"multimedia-element-wrapper\">\n        <MultimediaElement :element=\"card\" />\n      </div>\n\n      <button\n        type=\"button\"\n        @click=\"onClickDeleteImage\"\n        class=\"button trash settings-item\"\n      >\n        {{ $gettext('Bild lschen') }}\n      </button>\n\n      <label style=\"align-self: stretch\">\n        {{ $gettext('Bildbeschreibung') }}\n        <input\n          type=\"text\"\n          :value=\"card.altText\"\n          @input=\"onInputAltText\"\n          class=\"settings-item\"\n        />\n      </label>\n    </div>\n\n    <FileUpload v-else @file-uploaded=\"onUploadImage\" />\n  </fieldset>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, inject, PropType } from 'vue';\nimport { $gettext } from '@/language/gettext';\nimport {\n  fileIdToUrl,\n  LernmoduleMultimediaElement,\n  MultimediaElementType,\n  SequencingTask,\n} from '@/models/TaskDefinition';\nimport { taskEditorStore } from '@/store';\nimport produce from 'immer';\nimport FileUpload from '@/components/FileUpload.vue';\nimport { FileRef } from '@/routes/jsonApi';\nimport MultimediaElement from '@/components/MultimediaElement.vue';\nimport { v4 } from 'uuid';\nimport {\n  TaskEditorState,\n  taskEditorStateSymbol,\n} from '@/components/taskEditorState';\nimport { ImageFileElement } from '@/models/common';\n\nexport default defineComponent({\n  name: 'SequencingEditorCard',\n  components: { MultimediaElement, FileUpload },\n  setup() {\n    return {\n      taskEditor: inject<TaskEditorState>(taskEditorStateSymbol),\n    };\n  },\n  props: {\n    card: {\n      type: Object as PropType<LernmoduleMultimediaElement>,\n      required: true,\n    },\n    cardIndex: {\n      type: Number as PropType<number>,\n      required: true,\n    },\n  },\n  data() {\n    return {\n      debug: false,\n    };\n  },\n  methods: {\n    fileIdToUrl,\n    $gettext,\n    onUploadImage(file: FileRef): void {\n      const newTaskDefinition = produce(this.taskDefinition, (draft) => {\n        if (draft.cards[this.cardIndex].type === 'image') {\n          (draft.cards[this.cardIndex] as ImageFileElement).file_id = file.id;\n        }\n      });\n      this.taskEditor!.performEdit({\n        newTaskDefinition,\n        undoBatch: {},\n      });\n    },\n    onInputAltText(ev: InputEvent): void {\n      const value = (ev.target as HTMLInputElement).value;\n      const newTaskDefinition = produce(this.taskDefinition, (draft) => {\n        if (draft.cards[this.cardIndex].type === 'image') {\n          (draft.cards[this.cardIndex] as ImageFileElement).altText = value;\n        }\n      });\n      this.taskEditor!.performEdit({\n        newTaskDefinition,\n        undoBatch: { type: 'EditedImageAltText' },\n      });\n    },\n    onClickDeleteImage(): void {\n      const newTaskDefinition = produce(this.taskDefinition, (draft) => {\n        if (draft.cards[this.cardIndex].type === 'image') {\n          (draft.cards[this.cardIndex] as ImageFileElement).file_id = '';\n        }\n      });\n\n      this.taskEditor!.performEdit({\n        newTaskDefinition: newTaskDefinition,\n        undoBatch: {},\n      });\n    },\n    onChangeType(event: Event) {\n      const target = event.target as HTMLSelectElement;\n      const selectedType = target.value as MultimediaElementType;\n      const newTaskDefinition = produce(this.taskDefinition, (draft) => {\n        draft.cards[this.cardIndex].type = selectedType;\n      });\n\n      this.taskEditor!.performEdit({\n        newTaskDefinition: newTaskDefinition,\n        undoBatch: {},\n      });\n    },\n    createNewLernmoduleMultimediaElement(\n      type: MultimediaElementType\n    ): LernmoduleMultimediaElement {\n      switch (type) {\n        case 'image':\n          return {\n            uuid: v4(),\n            type: type,\n            file_id: '',\n            altText: '',\n          };\n        case 'audio':\n          return {\n            uuid: v4(),\n            type: type,\n            file_id: '',\n            altText: '',\n          };\n        case 'text':\n          return {\n            uuid: v4(),\n            type: type,\n            content: '',\n          };\n        default:\n          throw new Error(\n            $gettext('Ungltiges MultimediaElementType: ') + type\n          );\n      }\n    },\n  },\n  computed: {\n    taskDefinition: () => taskEditorStore.taskDefinition as SequencingTask,\n  },\n});\n</script>\n\n<style scoped>\n.sequencing-editor-card {\n  flex: 1 1 auto;\n}\n\n.multimedia-element-wrapper {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: flex-start;\n\n  width: 11.5em;\n  height: 11.5em;\n  padding: 0.5em;\n\n  border: 2px solid #dbe2e8;\n  border-radius: 0.5em;\n  background: white;\n}\n\n.image-card-container {\n  display: flex;\n  flex-direction: column;\n  justify-content: flex-start;\n  align-items: flex-start;\n  gap: 0.5em;\n}\n\n.settings-item {\n  /* top | right | bottom | left */\n  margin: 0.25em 0 0 0;\n}\n</style>\n","import { render } from \"./SequencingEditorCard.vue?vue&type=template&id=20dc9589&scoped=true&ts=true\"\nimport script from \"./SequencingEditorCard.vue?vue&type=script&lang=ts\"\nexport * from \"./SequencingEditorCard.vue?vue&type=script&lang=ts\"\n\nimport \"./SequencingEditorCard.vue?vue&type=style&index=0&id=20dc9589&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-20dc9589\"]])\n\nexport default __exports__","import { render } from \"./SequencingEditor.vue?vue&type=template&id=79b0e546&scoped=true&ts=true\"\nimport script from \"./SequencingEditor.vue?vue&type=script&lang=ts\"\nexport * from \"./SequencingEditor.vue?vue&type=script&lang=ts\"\n\nimport \"./SequencingEditor.vue?vue&type=style&index=0&id=79b0e546&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-79b0e546\"]])\n\nexport default __exports__","import { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, resolveComponent as _resolveComponent, createVNode as _createVNode, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, withModifiers as _withModifiers, normalizeClass as _normalizeClass, createBlock as _createBlock, createCommentVNode as _createCommentVNode, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-7ac5812a\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"stud5p-task\" }\nconst _hoisted_2 = {\n  class: \"card-row\",\n  tabIndex: \"-1\"\n}\nconst _hoisted_3 = [\"aria-label\", \"draggable\", \"onDragstart\", \"onDrag\", \"onDragend\", \"onDragover\", \"onClick\", \"onKeydown\"]\nconst _hoisted_4 = { class: \"image-wrapper\" }\nconst _hoisted_5 = { class: \"feedback-and-button-container\" }\nconst _hoisted_6 = { class: \"button-panel\" }\nconst _hoisted_7 = [\"textContent\"]\nconst _hoisted_8 = [\"textContent\"]\nconst _hoisted_9 = [\"textContent\"]\nconst _hoisted_10 = [\"textContent\"]\nconst _hoisted_11 = {\n  \"aria-live\": \"polite\",\n  \"aria-atomic\": \"true\",\n  style: {\"position\":\"absolute\",\"width\":\"1px\",\"height\":\"1px\",\"overflow\":\"hidden\"}\n}\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_MultimediaElement = _resolveComponent(\"MultimediaElement\")!\n  const _component_FeedbackElement = _resolveComponent(\"FeedbackElement\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createElementVNode(\"div\", _hoisted_2, [\n      (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.cards, (card, index) => {\n        return (_openBlock(), _createElementBlock(\"button\", {\n          type: \"button\",\n          \"aria-label\": _ctx.getAriaLabel(card, index),\n          key: card.uuid,\n          ref_for: true,\n          ref: 'card-' + index,\n          class: _normalizeClass([\"card\", {\n          dragged: _ctx.cardInteractedWith === card,\n          disabled: _ctx.isShowingResults,\n          correct: _ctx.isShowingResults && _ctx.isCardInCorrectPosition(card),\n          incorrect: _ctx.isShowingResults && !_ctx.isCardInCorrectPosition(card),\n        }]),\n          draggable: !_ctx.isShowingResults,\n          onDragstart: (event) => _ctx.startDragCard(card, event),\n          onDrag: ($event: any) => (_ctx.onDrag(card)),\n          onDragend: ($event: any) => (_ctx.endDragCard(card)),\n          onDragover: ($event: any) => (_ctx.onDragOver(card)),\n          onClick: ($event: any) => (_ctx.onClickCard(card)),\n          onKeydown: (event) => _ctx.onKeydown(card, event)\n        }, [\n          _createElementVNode(\"span\", _hoisted_4, [\n            _createVNode(_component_MultimediaElement, { element: card }, null, 8, [\"element\"])\n          ]),\n          _createElementVNode(\"span\", {\n            class: \"image-description\",\n            onDragover: _cache[0] || (_cache[0] = _withModifiers(() => {}, [\"prevent\"])),\n            onDragenter: _cache[1] || (_cache[1] = _withModifiers(() => {}, [\"prevent\"]))\n          }, _toDisplayString(card.altText), 33)\n        ], 42, _hoisted_3))\n      }), 128))\n    ]),\n    _createElementVNode(\"div\", _hoisted_5, [\n      (_ctx.isShowingResults && !_ctx.isShowingSolutions)\n        ? (_openBlock(), _createBlock(_component_FeedbackElement, {\n            key: 0,\n            achievedPoints: _ctx.correctAnswers,\n            maxPoints: _ctx.maxPoints,\n            resultMessage: _ctx.resultMessage,\n            feedback: _ctx.task.feedback\n          }, null, 8, [\"achievedPoints\", \"maxPoints\", \"resultMessage\", \"feedback\"]))\n        : _createCommentVNode(\"\", true),\n      _createElementVNode(\"div\", _hoisted_6, [\n        (_ctx.showCheckButton)\n          ? (_openBlock(), _createElementBlock(\"button\", {\n              key: 0,\n              textContent: _toDisplayString(_ctx.task.strings.checkButton),\n              onClick: _cache[2] || (_cache[2] = \n//@ts-ignore\n(...args) => (_ctx.onClickCheckButton && _ctx.onClickCheckButton(...args))),\n              type: \"button\",\n              class: \"stud5p-button\"\n            }, null, 8, _hoisted_7))\n          : _createCommentVNode(\"\", true),\n        (_ctx.showRetryButton)\n          ? (_openBlock(), _createElementBlock(\"button\", {\n              key: 1,\n              textContent: _toDisplayString(_ctx.task.strings.retryButton),\n              onClick: _cache[3] || (_cache[3] = \n//@ts-ignore\n(...args) => (_ctx.onClickRetryButton && _ctx.onClickRetryButton(...args))),\n              type: \"button\",\n              class: \"stud5p-button\"\n            }, null, 8, _hoisted_8))\n          : _createCommentVNode(\"\", true),\n        (_ctx.showResumeButton)\n          ? (_openBlock(), _createElementBlock(\"button\", {\n              key: 2,\n              textContent: _toDisplayString(_ctx.task.strings.resumeButton),\n              onClick: _cache[4] || (_cache[4] = \n//@ts-ignore\n(...args) => (_ctx.onClickResumeButton && _ctx.onClickResumeButton(...args))),\n              type: \"button\",\n              class: \"stud5p-button\"\n            }, null, 8, _hoisted_9))\n          : _createCommentVNode(\"\", true),\n        (_ctx.showSolutionsButton)\n          ? (_openBlock(), _createElementBlock(\"button\", {\n              key: 3,\n              textContent: _toDisplayString(_ctx.task.strings.solutionsButton),\n              onClick: _cache[5] || (_cache[5] = \n//@ts-ignore\n(...args) => (_ctx.onClickSolutionsButton && _ctx.onClickSolutionsButton(...args))),\n              type: \"button\",\n              class: \"stud5p-button\"\n            }, null, 8, _hoisted_10))\n          : _createCommentVNode(\"\", true)\n      ])\n    ]),\n    _createElementVNode(\"div\", _hoisted_11, _toDisplayString(_ctx.screenReaderAnnouncement), 1)\n  ]))\n}","<template>\n  <div class=\"stud5p-task\">\n    <div class=\"card-row\" tabIndex=\"-1\">\n      <button\n        type=\"button\"\n        v-for=\"(card, index) in cards\"\n        :aria-label=\"getAriaLabel(card, index)\"\n        :key=\"card.uuid\"\n        :ref=\"'card-' + index\"\n        class=\"card\"\n        :class=\"{\n          dragged: cardInteractedWith === card,\n          disabled: isShowingResults,\n          correct: isShowingResults && isCardInCorrectPosition(card),\n          incorrect: isShowingResults && !isCardInCorrectPosition(card),\n        }\"\n        :draggable=\"!isShowingResults\"\n        @dragstart=\"(event) => startDragCard(card, event)\"\n        @drag=\"onDrag(card)\"\n        @dragend=\"endDragCard(card)\"\n        @dragover=\"onDragOver(card)\"\n        @click=\"onClickCard(card)\"\n        @keydown=\"(event) => onKeydown(card, event)\"\n      >\n        <span class=\"image-wrapper\">\n          <MultimediaElement :element=\"card\" />\n        </span>\n\n        <span class=\"image-description\" @dragover.prevent @dragenter.prevent>\n          {{ card.altText }}\n        </span>\n      </button>\n    </div>\n\n    <div class=\"feedback-and-button-container\">\n      <FeedbackElement\n        v-if=\"isShowingResults && !isShowingSolutions\"\n        :achievedPoints=\"correctAnswers\"\n        :maxPoints=\"maxPoints\"\n        :resultMessage=\"resultMessage\"\n        :feedback=\"task.feedback\"\n      />\n\n      <div class=\"button-panel\">\n        <button\n          v-if=\"showCheckButton\"\n          v-text=\"task.strings.checkButton\"\n          @click=\"onClickCheckButton\"\n          type=\"button\"\n          class=\"stud5p-button\"\n        />\n\n        <button\n          v-if=\"showRetryButton\"\n          v-text=\"task.strings.retryButton\"\n          @click=\"onClickRetryButton\"\n          type=\"button\"\n          class=\"stud5p-button\"\n        />\n\n        <button\n          v-if=\"showResumeButton\"\n          v-text=\"task.strings.resumeButton\"\n          @click=\"onClickResumeButton\"\n          type=\"button\"\n          class=\"stud5p-button\"\n        />\n\n        <button\n          v-if=\"showSolutionsButton\"\n          v-text=\"task.strings.solutionsButton\"\n          @click=\"onClickSolutionsButton\"\n          type=\"button\"\n          class=\"stud5p-button\"\n        />\n      </div>\n    </div>\n\n    <div\n      aria-live=\"polite\"\n      aria-atomic=\"true\"\n      style=\"position: absolute; width: 1px; height: 1px; overflow: hidden\"\n    >\n      {{ screenReaderAnnouncement }}\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, PropType } from 'vue';\nimport {\n  fileIdToUrl,\n  SequencingTask,\n  LernmoduleMultimediaElement,\n} from '@/models/TaskDefinition';\nimport { $gettext } from '@/language/gettext';\nimport FeedbackElement from '@/components/FeedbackElement.vue';\nimport MultimediaElement from '@/components/MultimediaElement.vue';\n\ntype Uuid = string;\n\nexport default defineComponent({\n  name: 'SequencingViewer',\n\n  components: {\n    MultimediaElement,\n    FeedbackElement,\n  },\n\n  props: {\n    task: {\n      type: Object as PropType<SequencingTask>,\n      required: true,\n    },\n  },\n\n  emits: ['updateAttempt'],\n\n  data() {\n    return {\n      cards: [] as LernmoduleMultimediaElement[],\n      cardInteractedWith: undefined as LernmoduleMultimediaElement | undefined,\n      isShowingResults: false as boolean,\n      isShowingSolutions: false as boolean,\n      screenReaderAnnouncement: '' as string,\n    };\n  },\n\n  methods: {\n    fileIdToUrl,\n\n    $gettext,\n\n    startDragCard(card: LernmoduleMultimediaElement, event: DragEvent) {\n      console.log('Starting to drag card', card.uuid);\n      this.cardInteractedWith = card;\n    },\n\n    onDrag(card: LernmoduleMultimediaElement) {\n      console.log('Dragging card', card.uuid);\n    },\n\n    endDragCard(card: LernmoduleMultimediaElement) {\n      console.log('Ending to drag card', card.uuid);\n      this.cardInteractedWith = undefined;\n    },\n\n    onDragOver(card: LernmoduleMultimediaElement) {\n      if (this.cardInteractedWith && this.cardInteractedWith != card) {\n        const fromIndex = this.cards.indexOf(this.cardInteractedWith);\n        const toIndex = this.cards.indexOf(card);\n\n        console.log(\n          'Dragging card',\n          this.cardInteractedWith?.uuid,\n          '(',\n          fromIndex,\n          ') over target',\n          card.uuid,\n          '(',\n          toIndex,\n          ')'\n        );\n\n        this.moveInArray(fromIndex, toIndex);\n      }\n    },\n\n    onClickCard(card: LernmoduleMultimediaElement) {\n      if (this.isShowingSolutions || this.isShowingResults) return;\n\n      if (this.cardInteractedWith) {\n        const fromIndex = this.cards.indexOf(this.cardInteractedWith);\n        const toIndex = this.cards.indexOf(card);\n        this.moveInArray(fromIndex, toIndex);\n        this.cardInteractedWith = undefined;\n      } else {\n        this.cardInteractedWith = card;\n      }\n    },\n\n    onKeydown(card: LernmoduleMultimediaElement, event: KeyboardEvent) {\n      if (this.isShowingResults || this.isShowingSolutions) return;\n\n      const currentlySelectedIndex = this.cards.indexOf(card);\n      const previouslySelectedIndex = this.cardInteractedWith\n        ? this.cards.indexOf(this.cardInteractedWith)\n        : -1;\n\n      switch (event.key) {\n        case 'Enter':\n        case ' ':\n          event.preventDefault();\n          // If an card is already selected and it's different from the current one\n          if (this.cardInteractedWith && this.cardInteractedWith !== card) {\n            // Move the already selected card to the position of the currently selected card\n            this.moveInArray(previouslySelectedIndex, currentlySelectedIndex);\n            this.screenReaderAnnouncement = this.$gettext(\n              'Moved %1 to position %2.'\n            )\n              .replace('%1', this.cardInteractedWith.uuid)\n              .replace('%2', String(currentlySelectedIndex + 1)); // Convert number to string\n\n            this.cardInteractedWith = undefined;\n            this.moveFocus(currentlySelectedIndex);\n          } else {\n            // Select or deselect the card\n            this.cardInteractedWith = this.cardInteractedWith\n              ? undefined\n              : card;\n            this.screenReaderAnnouncement = this.cardInteractedWith\n              ? `Selected ${card.uuid} on position ${\n                  currentlySelectedIndex + 1\n                } for moving.`\n              : 'Selection cleared.';\n          }\n          break;\n\n        case 'Escape':\n          this.cardInteractedWith = undefined;\n          this.screenReaderAnnouncement = 'Selection canceled.';\n          break;\n      }\n    },\n\n    moveFocus(cardIndex: number) {\n      // Wait for the DOM to update before applying focus\n      this.$nextTick(() => {\n        const buttonRef = this.$refs[\n          `card-${cardIndex}`\n        ] as HTMLButtonElement[];\n        if (buttonRef && buttonRef[0]) {\n          // Check if the buttonRef exists and is not undefined\n          buttonRef[0].focus(); // Set focus on the new button\n        }\n      });\n    },\n\n    getAriaLabel(card: LernmoduleMultimediaElement, index: number) {\n      if (!this.isShowingResults) {\n        return `${card.uuid} on position ${index + 1}`;\n      } else {\n        return `${card.uuid} on position ${index + 1} is ${\n          this.isCardInCorrectPosition(card) ? 'correct' : 'not correct'\n        }`;\n      }\n    },\n\n    moveInArray(fromIndex: number, toIndex: number) {\n      let element = this.cards[fromIndex];\n      this.cards.splice(fromIndex, 1);\n      this.cards.splice(toIndex, 0, element);\n    },\n\n    isCardInCorrectPosition(card: LernmoduleMultimediaElement): boolean {\n      const index = this.cards.findIndex(\n        (cardToCheck) => cardToCheck.uuid === card.uuid\n      );\n      return index !== -1 && this.task.cards[index].uuid === card.uuid;\n    },\n\n    onClickCheckButton() {\n      this.isShowingResults = true;\n      this.screenReaderAnnouncement = this.resultMessage;\n    },\n\n    onClickSolutionsButton() {\n      this.isShowingSolutions = true;\n      this.resetCards();\n    },\n\n    onClickResumeButton() {\n      this.isShowingResults = false;\n    },\n\n    onClickRetryButton() {\n      this.isShowingResults = false;\n      this.isShowingSolutions = false;\n      this.shuffleCards();\n    },\n\n    shuffleCards() {\n      // Shuffle the cards\n      // https://stackoverflow.com/a/46545530\n      this.cards = this.cards\n        .map((card) => ({ card: card, sort: Math.random() }))\n        .sort((card1, card2) => card1.sort - card2.sort)\n        .map(({ card }) => card);\n    },\n\n    resetCards() {\n      this.cards = this.task.cards;\n    },\n  },\n\n  computed: {\n    showCheckButton(): boolean {\n      return !this.isShowingResults;\n    },\n\n    showRetryButton(): boolean {\n      return this.task.retryAllowed && this.isShowingResults;\n    },\n\n    showResumeButton(): boolean {\n      return (\n        this.task.resumeAllowed &&\n        this.isShowingResults &&\n        !this.isShowingSolutions &&\n        !this.allAnswersAreCorrect\n      );\n    },\n\n    showSolutionsButton(): boolean {\n      return (\n        this.task.showSolutionsAllowed &&\n        this.isShowingResults &&\n        !this.isShowingSolutions &&\n        !this.allAnswersAreCorrect\n      );\n    },\n\n    correctAnswers(): number {\n      let correctAnswers = 0;\n      for (let i = 0; i < this.task.cards.length; i++) {\n        if (this.task.cards[i].uuid === this.cards[i].uuid) {\n          correctAnswers++;\n        }\n      }\n      return correctAnswers;\n    },\n\n    maxPoints(): number {\n      return this.task.cards.length;\n    },\n\n    allAnswersAreCorrect(): boolean {\n      return this.correctAnswers === this.maxPoints;\n    },\n\n    resultMessage(): string {\n      let resultMessage = this.task.strings.resultMessage.replace(\n        ':correct',\n        this.correctAnswers.toString()\n      );\n\n      resultMessage = resultMessage.replace(\n        ':total',\n        this.maxPoints.toString()\n      );\n\n      return resultMessage;\n    },\n  },\n\n  watch: {\n    task: {\n      handler() {\n        console.log('watcher for this.task');\n        this.cards = [...this.task.cards];\n        this.shuffleCards();\n      },\n      immediate: true, // Ensure that the watcher is also called immediately when the component is first mounted\n    },\n  },\n});\n</script>\n\n<style scoped>\n.card-row {\n  display: flex;\n  flex-direction: row;\n  flex-wrap: wrap;\n  gap: 0.5em;\n}\n\n.card {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: flex-start;\n\n  width: 11.5em;\n  height: 13.5em;\n  padding: 0.5em 0.5em 0 0.5em;\n\n  border: 2px solid #dbe2e8;\n  border-radius: 0.5em;\n  background: white;\n\n  cursor: grab;\n  user-select: none;\n\n  transition: background-color 0.12s ease, border 0.12s ease,\n    box-shadow 0.12s ease;\n}\n\n.card:not(.disabled):focus,\n.card:not(.disabled):active,\n.card:not(.disabled):hover {\n  border: 2px solid #7ba4d3;\n  box-shadow: 0 0 10px 0 #406ef3;\n}\n\n.dragged {\n  border: 2px solid #7ba4d3;\n  box-shadow: 0 0 10px 0 #406ef3;\n  background-color: #dcf6ff;\n}\n\n.correct {\n  background-color: #9dd8bb;\n  border-color: #9dd8bb;\n}\n\n.incorrect {\n  background-color: #f7d0d0;\n  border-color: #f7d0d0;\n}\n\n.disabled {\n  cursor: default;\n}\n\n.image-wrapper {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n\n  flex: 1; /* Occupy remaining vertical space */\n  width: 100%;\n\n  overflow: hidden;\n}\n\n.image-description {\n  width: 100%;\n  height: 2em;\n\n  padding-top: 0.4em;\n\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  text-align: center;\n}\n</style>\n","import { render } from \"./SequencingViewer.vue?vue&type=template&id=7ac5812a&scoped=true&ts=true\"\nimport script from \"./SequencingViewer.vue?vue&type=script&lang=ts\"\nexport * from \"./SequencingViewer.vue?vue&type=script&lang=ts\"\n\nimport \"./SequencingViewer.vue?vue&type=style&index=0&id=7ac5812a&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-7ac5812a\"]])\n\nexport default __exports__","import { z } from 'zod';\n\nconst noImageSchema = z.object({\n  type: z.literal('none'),\n});\n\nexport const imageFileSchema = z.object({\n  uuid: z.string(),\n  type: z.literal('image'),\n  file_id: z.string(),\n  altText: z.string(),\n});\nexport type ImageFileElement = z.infer<typeof imageFileSchema>;\n\nexport const imageSchema = z.union([noImageSchema, imageFileSchema]);\nexport type ImageElement = z.infer<typeof imageSchema>;\n\nexport const feedbackSchema = z.object({\n  percentage: z.number(),\n  message: z.string(),\n});\nexport type Feedback = z.infer<typeof feedbackSchema>;\n","import { z } from 'zod';\nimport { imageSchema, feedbackSchema } from '@/models/common';\n\nconst rectangleHotspotSchema = z.object({\n  uuid: z.string(),\n  type: z.literal('rectangle'),\n  x: z.number(), // Fraction 0..1 of image width\n  y: z.number(), // Fraction 0..1 of image height\n  width: z.number(), // Fraction 0..1 of image width\n  height: z.number(), // Fraction 0..1 of image height\n  correct: z.boolean().default(true),\n  feedback: z.string().default(''),\n});\nexport type RectangleHotspot = z.infer<typeof rectangleHotspotSchema>;\n\nconst ellipseHotspotSchema = z.object({\n  uuid: z.string(),\n  type: z.literal('ellipse'),\n  x: z.number(), // Fraction 0..1 of image width\n  y: z.number(), // Fraction 0..1 of image height\n  width: z.number(), // Fraction 0..1 of image width\n  height: z.number(), // Fraction 0..1 of image height\n  correct: z.boolean().default(true),\n  feedback: z.string().default(''),\n});\nexport type EllipseHotspot = z.infer<typeof ellipseHotspotSchema>;\n\nexport const hotspotSchema = z.union([\n  rectangleHotspotSchema,\n  ellipseHotspotSchema,\n]);\nexport type Hotspot = z.infer<typeof hotspotSchema>;\nexport type HotspotType = Hotspot['type'];\n\nexport const findTheHotspotsTaskSchema = z.object({\n  task_type: z.literal('FindTheHotspots'),\n  image: imageSchema,\n  hotspots: z.array(hotspotSchema),\n  allowedClicks: z.number().default(0),\n  hotspotsToFind: z.number().default(0),\n  strings: z.object({\n    retryButton: z.string(),\n    resultMessage: z.string(),\n    feedbackWhenClickingBackground: z.string().default(''),\n    feedbackWhenClickingHotspotAgain: z\n      .string()\n      .default('Du hast diesen Hotspot bereits gefunden.'),\n  }),\n  feedback: z.array(feedbackSchema),\n});\nexport type FindTheHotspotsTask = z.infer<typeof findTheHotspotsTaskSchema>;\n","import { v4 } from 'uuid';\nimport { z } from 'zod';\nimport { $gettext } from '@/language/gettext';\nimport CrosswordEditor from '@/components/crossword/CrosswordEditor.vue';\nimport CrosswordViewer from '@/components/crossword/CrosswordViewer.vue';\nimport DragTheWordsEditor from '@/components/DragTheWordsEditor.vue';\nimport DragTheWordsViewer from '@/components/DragTheWordsViewer.vue';\nimport FillInTheBlanksEditor from '@/components/FillInTheBlanksEditor.vue';\nimport FillInTheBlanksViewer from '@/components/FillInTheBlanksViewer.vue';\nimport FindTheHotspotsEditor from '@/components/findTheHotspots/FindTheHotspotsEditor.vue';\nimport FindTheHotspotsViewer from '@/components/findTheHotspots/FindTheHotspotsViewer.vue';\nimport FindTheWordsEditor from '@/components/findTheWords/FindTheWordsEditor.vue';\nimport FindTheWordsViewer from '@/components/findTheWords/FindTheWordsViewer.vue';\nimport InteractiveVideoEditor from '@/components/interactiveVideo/editor/InteractiveVideoEditor.vue';\nimport InteractiveVideoViewer from '@/components/interactiveVideo/viewer/InteractiveVideoViewer.vue';\nimport MarkTheWordsEditor from '@/components/MarkTheWordsEditor.vue';\nimport MarkTheWordsViewer from '@/components/MarkTheWordsViewer.vue';\nimport MemoryEditor from '@/components/MemoryEditor.vue';\nimport MemoryViewer from '@/components/MemoryViewer.vue';\nimport PairingEditor from '@/components/PairingEditor.vue';\nimport PairingViewer from '@/components/PairingViewer.vue';\nimport QuestionEditor from '@/components/QuestionEditor.vue';\nimport QuestionViewer from '@/components/QuestionViewer.vue';\nimport SequencingEditor from '@/components/SequencingEditor.vue';\nimport SequencingViewer from '@/components/SequencingViewer.vue';\nimport { interactiveVideoTaskSchema } from '@/models/InteractiveVideoTask';\nimport { crosswordTaskSchema } from '@/models/CrosswordTask';\nimport { findTheHotspotsTaskSchema } from '@/models/FindTheHotspotsTask';\nimport { imageFileSchema, feedbackSchema, Feedback } from '@/models/common';\n\n/**\n * @return The Stud.IP download URL for the file with the given ID, or '' if id is ''\n */\nexport function fileIdToUrl(fileId: string): string {\n  if (fileId === '') {\n    return '';\n  }\n  return window.STUDIP.URLHelper.getURL('sendfile.php', {\n    file_id: fileId,\n  });\n}\n\n/**\n * @return The Stud.IP URL to view 'details' about the file with the given ID.\n */\nexport function fileDetailsUrl(fileId: string): string {\n  return window.STUDIP.URLHelper.getURL(`dispatch.php/file/details/${fileId}`);\n}\n\n// TODO Pull these things out into common.ts as well next to ImageElement/imageElementSchema.\nconst audioElementSchema = z.object({\n  uuid: z.string(),\n  type: z.literal('audio'),\n  file_id: z.string(),\n  altText: z.string(),\n});\nexport type AudioElement = z.infer<typeof audioElementSchema>;\n\nconst textElementSchema = z.object({\n  uuid: z.string(),\n  type: z.literal('text'),\n  content: z.string(),\n});\n\nexport const multimediaElementSchema = z.union([\n  imageFileSchema,\n  audioElementSchema,\n  textElementSchema,\n]);\nexport type LernmoduleMultimediaElement = z.infer<\n  typeof multimediaElementSchema\n>;\nexport type MultimediaElementType = LernmoduleMultimediaElement['type'];\n\nexport const dragTheWordsTaskSchema = z.object({\n  task_type: z.literal('DragTheWords'),\n  template: z.string(),\n  distractors: z.string().optional().default(''),\n  retryAllowed: z.boolean(),\n  showSolutionsAllowed: z.boolean(),\n  instantFeedback: z.boolean(),\n  allBlanksMustBeFilledForSolutions: z.boolean(),\n  alphabeticOrder: z.boolean(),\n  strings: z.object({\n    checkButton: z.string(),\n    retryButton: z.string(),\n    solutionsButton: z.string(),\n    fillInAllBlanksMessage: z.string(),\n    resultMessage: z.string(),\n  }),\n  feedback: z.array(feedbackSchema),\n});\nexport type DragTheWordsTask = z.infer<typeof dragTheWordsTaskSchema>;\n\nexport const findTheWordsTaskSchema = z.object({\n  task_type: z.literal('FindTheWords'),\n  words: z.string(),\n  size: z.number().optional().default(12),\n  alphabet: z.string(),\n  showWordList: z.boolean().default(true),\n  directions: z\n    .object({\n      n: z.boolean(),\n      ne: z.boolean(),\n      e: z.boolean(),\n      se: z.boolean(),\n      s: z.boolean(),\n      sw: z.boolean(),\n      w: z.boolean(),\n      nw: z.boolean(),\n    })\n    .optional(),\n  strings: z.object({\n    checkButton: z.string().default(''),\n    retryButton: z.string(),\n    solutionsButton: z.string(),\n    resultMessage: z.string(),\n    wordListTitle: z.string().default('Wrter'),\n    timer: z.string(),\n  }),\n});\nexport type FindTheWordsTask = z.infer<typeof findTheWordsTaskSchema>;\n\nexport const fillInTheBlanksTaskSchema = z.object({\n  task_type: z.literal('FillInTheBlanks'),\n  template: z.string(),\n  retryAllowed: z.boolean(),\n  showSolutionsAllowed: z.boolean(),\n  caseSensitive: z.boolean(),\n  autoCorrect: z.boolean(),\n  allBlanksMustBeFilledForSolutions: z.boolean(),\n  acceptTypos: z.boolean(),\n  strings: z.object({\n    checkButton: z.string(),\n    retryButton: z.string(),\n    solutionsButton: z.string(),\n    fillInAllBlanksMessage: z.string(),\n    resultMessage: z.string(),\n  }),\n  feedback: z.array(feedbackSchema),\n});\nexport type FillInTheBlanksTask = z.infer<typeof fillInTheBlanksTaskSchema>;\n\nexport const markTheWordsTaskSchema = z.object({\n  task_type: z.literal('MarkTheWords'),\n  template: z.string(),\n  retryAllowed: z.boolean(),\n  showSolutionsAllowed: z.boolean(),\n  strings: z.object({\n    checkButton: z.string(),\n    retryButton: z.string(),\n    solutionsButton: z.string(),\n    resultMessage: z.string(),\n  }),\n  feedback: z.array(feedbackSchema).default(() => defaultFeedback()),\n});\nexport type MarkTheWordsTask = z.infer<typeof markTheWordsTaskSchema>;\n\nexport const memoryCardSchema = z.object({\n  uuid: z.string(),\n  first: multimediaElementSchema,\n  second: multimediaElementSchema.optional(),\n});\nexport type MemoryCard = z.infer<typeof memoryCardSchema>;\n\nexport const memoryTaskSchema = z.object({\n  task_type: z.literal('Memory'),\n  cards: z.array(memoryCardSchema),\n  squareLayout: z.boolean(),\n  flipside: imageFileSchema.optional(),\n  retryAllowed: z.boolean(),\n  strings: z.object({\n    retryButton: z.string(),\n    resultMessage: z.string(),\n  }),\n});\nexport type MemoryTask = z.infer<typeof memoryTaskSchema>;\n\nexport const pairSchema = z.object({\n  uuid: z.string(),\n  draggableElement: multimediaElementSchema,\n  targetElement: multimediaElementSchema,\n});\nexport type Pair = z.infer<typeof pairSchema>;\n\nexport const pairingTaskSchema = z.object({\n  task_type: z.literal('Pairing'),\n  pairs: z.array(pairSchema),\n  retryAllowed: z.boolean().optional().default(true),\n  showSolutionsAllowed: z.boolean().optional().default(true),\n  strings: z.object({\n    checkButton: z.string(),\n    retryButton: z.string(),\n    solutionsButton: z.string(),\n    resultMessage: z.string(),\n  }),\n  feedback: z.array(feedbackSchema),\n});\nexport type PairingTask = z.infer<typeof pairingTaskSchema>;\n\nexport const questionAnswerSchema = z.object({\n  uuid: z.string().optional().default(v4()),\n  text: z.string(),\n  correct: z.boolean(),\n  strings: z.object({\n    hint: z.string(),\n    feedbackSelected: z.string(),\n    feedbackNotSelected: z.string(),\n  }),\n});\nexport type QuestionAnswer = z.infer<typeof questionAnswerSchema>;\n\nexport const questionTaskSchema = z.object({\n  task_type: z.literal('Question'),\n  question: z.string(),\n  answers: z.array(questionAnswerSchema),\n  canAnswerMultiple: z.boolean(),\n  retryAllowed: z.boolean(),\n  randomOrder: z.boolean(),\n  showSolutionsAllowed: z.boolean(),\n  strings: z.object({\n    checkButton: z.string(),\n    retryButton: z.string(),\n    solutionsButton: z.string(),\n    resultMessage: z.string().optional(),\n  }),\n  feedback: z.array(feedbackSchema).default(() => defaultFeedback()),\n});\nexport type QuestionTask = z.infer<typeof questionTaskSchema>;\n\nexport const sequencingTaskSchema = z.object({\n  task_type: z.literal('Sequencing'),\n  cards: z.array(multimediaElementSchema),\n  retryAllowed: z.boolean().optional().default(true),\n  resumeAllowed: z.boolean().optional().default(true),\n  showSolutionsAllowed: z.boolean().optional().default(true),\n  strings: z.object({\n    checkButton: z.string(),\n    retryButton: z.string(),\n    resumeButton: z.string().optional().default($gettext('Fortsetzen')),\n    solutionsButton: z.string(),\n    resultMessage: z.string(),\n  }),\n  feedback: z.array(feedbackSchema),\n});\nexport type SequencingTask = z.infer<typeof sequencingTaskSchema>;\n\nexport const taskDefinitionSchema = z.discriminatedUnion('task_type', [\n  crosswordTaskSchema,\n  dragTheWordsTaskSchema,\n  fillInTheBlanksTaskSchema,\n  findTheHotspotsTaskSchema,\n  findTheWordsTaskSchema,\n  interactiveVideoTaskSchema,\n  markTheWordsTaskSchema,\n  memoryTaskSchema,\n  pairingTaskSchema,\n  questionTaskSchema,\n  sequencingTaskSchema,\n]);\nexport type TaskDefinition = z.infer<typeof taskDefinitionSchema>;\n\n// Allowed lmb task types to be inserted in the Interactive Video Editor.\n// Excludes the type 'interactive video' to avoid a recursive reference, which\n// is cumbersome to solve in Typescript/Zod.\n// I at first used the workaround described at https://github.com/colinhacks/zod#recursive-types\n// but I later ran into hard-to-resolve typechecking errors when I started to\n// use .optional() inside of schemas. I decided this is the better option for now. -Ann\nexport const taskDefinitionSchemaMinusInteractiveVideo = z.discriminatedUnion(\n  'task_type',\n  [\n    crosswordTaskSchema,\n    dragTheWordsTaskSchema,\n    fillInTheBlanksTaskSchema,\n    findTheHotspotsTaskSchema,\n    findTheWordsTaskSchema,\n    markTheWordsTaskSchema,\n    memoryTaskSchema,\n    pairingTaskSchema,\n    questionTaskSchema,\n    sequencingTaskSchema,\n  ]\n);\nexport type TaskDefinitionMinusInteractiveVideo = z.infer<\n  typeof taskDefinitionSchemaMinusInteractiveVideo\n>;\n\n// Here, a bit of boilerplate is required to create a schema for the union of\n// all possible 'task_type' values\nexport const taskTypeSchema = z.union([\n  crosswordTaskSchema.shape.task_type,\n  dragTheWordsTaskSchema.shape.task_type,\n  fillInTheBlanksTaskSchema.shape.task_type,\n  findTheHotspotsTaskSchema.shape.task_type,\n  findTheWordsTaskSchema.shape.task_type,\n  interactiveVideoTaskSchema.shape.task_type,\n  markTheWordsTaskSchema.shape.task_type,\n  memoryTaskSchema.shape.task_type,\n  pairingTaskSchema.shape.task_type,\n  questionTaskSchema.shape.task_type,\n  sequencingTaskSchema.shape.task_type,\n]);\n\nfunction defaultFeedback(): Feedback[] {\n  return [\n    { percentage: 0, message: 'Versuchen Sie es noch einmal.' },\n    { percentage: 50, message: 'Gut.' },\n    { percentage: 75, message: 'Sehr gut.' },\n    { percentage: 100, message: 'Perfekt!' },\n  ];\n}\n\nexport function newTask(type: TaskDefinition['task_type']): TaskDefinition {\n  switch (type) {\n    case 'Crossword':\n      return {\n        task_type: 'Crossword',\n        words: [\n          {\n            uuid: v4(),\n            hint: 'Frucht mit gleichnamiger Farbe.',\n            solution: 'Orange',\n            x: 4,\n            y: 1,\n            direction: 'across',\n          },\n          {\n            uuid: v4(),\n            hint: 'Krummes Obst mit gelber Schale.',\n            solution: 'Banane',\n            x: 6,\n            y: 0,\n            direction: 'down',\n          },\n          {\n            uuid: v4(),\n            hint: 'Kleine rote Steinfrucht mit Stiel.',\n            solution: 'Kirsche',\n            x: 0,\n            y: 5,\n            direction: 'across',\n          },\n          {\n            uuid: v4(),\n            hint: 'Unsinn / Milchprodukt.',\n            solution: 'Quark',\n            x: 4,\n            y: 3,\n            direction: 'across',\n          },\n          {\n            uuid: v4(),\n            hint: 'Erworben.',\n            solution: 'Gekauft',\n            x: 8,\n            y: 1,\n            direction: 'down',\n          },\n        ],\n        colorEmptyCells: false,\n        strings: {\n          checkButton: 'berprfen',\n          retryButton: 'Erneut versuchen',\n          solutionsButton: 'Lsungen anzeigen',\n          resultMessage: ':correct von :total Felder richtig ausgefllt.',\n        },\n      };\n    case 'DragTheWords':\n      return {\n        task_type: 'DragTheWords',\n        template: 'Drag the *words* to the matching *gaps*.',\n        distractors: '',\n        retryAllowed: true,\n        showSolutionsAllowed: true,\n        instantFeedback: false,\n        allBlanksMustBeFilledForSolutions: false,\n        alphabeticOrder: false,\n        strings: {\n          checkButton: 'Antworten berprfen',\n          retryButton: 'Erneut versuchen',\n          solutionsButton: 'Lsungen anzeigen',\n          fillInAllBlanksMessage:\n            'Alle Lcken mssen ausgefllt sein, um Lsungen anzuzeigen.',\n          resultMessage: ':correct von :total Lcken richtig ausgefllt.',\n        },\n        feedback: defaultFeedback(),\n      };\n    case 'InteractiveVideo':\n      return {\n        task_type: 'InteractiveVideo',\n        interactions: [],\n        video: {\n          type: 'none',\n        },\n        autoplay: false,\n        startAt: 0,\n        disableNavigation: 'not disabled',\n        travisGoSettings: {\n          enabled: false,\n          projectTitle: $gettext('Projekttitel'),\n          projectDescription: $gettext('Projektbeschreibung'),\n        },\n      };\n    case 'FillInTheBlanks':\n      return {\n        task_type: 'FillInTheBlanks',\n        template: 'Hier entsteht der *Lcken*text.',\n        retryAllowed: true,\n        showSolutionsAllowed: true,\n        caseSensitive: true,\n        autoCorrect: false,\n        allBlanksMustBeFilledForSolutions: false,\n        acceptTypos: false,\n        strings: {\n          checkButton: 'Antworten berprfen',\n          retryButton: 'Erneut versuchen',\n          solutionsButton: 'Lsungen anzeigen',\n          fillInAllBlanksMessage:\n            'Alle Lcken mssen ausgefllt sein, um Lsungen anzuzeigen.',\n          resultMessage: ':correct von :total Lcken richtig ausgefllt.',\n        },\n        feedback: defaultFeedback(),\n      };\n    case 'FindTheHotspots':\n      return {\n        task_type: 'FindTheHotspots',\n        image: {\n          type: 'none',\n        },\n        hotspots: [],\n        allowedClicks: 0,\n        hotspotsToFind: 0,\n        strings: {\n          retryButton: 'Erneut versuchen',\n          resultMessage: ':correct von :total Hotspots gefunden.',\n          feedbackWhenClickingBackground: 'Hier ist kein Hotspot.',\n          feedbackWhenClickingHotspotAgain:\n            'Du hast diesen Hotspot bereits gefunden.',\n        },\n        feedback: defaultFeedback(),\n      };\n    case 'FindTheWords':\n      return {\n        task_type: 'FindTheWords',\n        words: 'Apfel, Banane, Orange',\n        size: 12,\n        alphabet: 'abcdefghijklmnopqrstuvwxyz',\n        showWordList: true,\n        directions: {\n          n: false,\n          ne: true,\n          e: true,\n          se: true,\n          s: true,\n          sw: false,\n          w: false,\n          nw: false,\n        },\n        strings: {\n          checkButton: 'berprfen',\n          retryButton: 'Erneut versuchen',\n          solutionsButton: 'Lsungen anzeigen',\n          resultMessage: ':correct von :total Wrter gefunden.',\n          wordListTitle: 'Wrter',\n          timer: 'Zeit:',\n        },\n      };\n    case 'MarkTheWords':\n      return {\n        task_type: 'MarkTheWords',\n        template:\n          '*The* moon is our natural satellite, *i.e.* it revolves around the *Earth!*',\n        retryAllowed: true,\n        showSolutionsAllowed: true,\n        strings: {\n          checkButton: 'Antworten berprfen',\n          retryButton: 'Erneut versuchen',\n          solutionsButton: 'Lsungen anzeigen',\n          resultMessage: ':correct von :total Wrtern richtig ausgewhlt.',\n        },\n        feedback: defaultFeedback(),\n      };\n    case 'Memory':\n      return {\n        task_type: 'Memory',\n        cards: [\n          {\n            uuid: v4(),\n            first: {\n              type: 'image',\n              uuid: v4(),\n              file_id: '',\n              altText: '',\n            },\n          },\n        ],\n        retryAllowed: true,\n        squareLayout: true,\n        strings: {\n          retryButton: 'Erneut versuchen',\n          resultMessage: 'Gut gemacht!',\n        },\n      };\n    case 'Pairing':\n      return {\n        task_type: 'Pairing',\n        pairs: [\n          {\n            uuid: v4(),\n            draggableElement: {\n              uuid: v4(),\n              type: 'image',\n              file_id: '',\n              altText: '',\n            },\n            targetElement: {\n              uuid: v4(),\n              type: 'image',\n              file_id: '',\n              altText: '',\n            },\n          },\n        ],\n        retryAllowed: true,\n        showSolutionsAllowed: true,\n        strings: {\n          checkButton: 'Antworten berprfen',\n          retryButton: 'Erneut versuchen',\n          solutionsButton: 'Lsungen anzeigen',\n          resultMessage: ':correct von :total Bildern richtig zugeordnet.',\n        },\n        feedback: defaultFeedback(),\n      };\n    case 'Question':\n      return {\n        task_type: 'Question',\n        question:\n          'Wie nennt man die strukturell abgrenzbaren Bereiche einer Zelle?',\n        answers: [\n          {\n            uuid: v4(),\n            text: 'Organellen',\n            correct: true,\n            strings: {\n              hint: '',\n              feedbackSelected: '',\n              feedbackNotSelected: '',\n            },\n          },\n          {\n            uuid: v4(),\n            text: 'Mitochondrien',\n            correct: false,\n            strings: {\n              hint: '',\n              feedbackSelected: '',\n              feedbackNotSelected: '',\n            },\n          },\n          {\n            uuid: v4(),\n            text: 'Ribosomen',\n            correct: false,\n            strings: {\n              hint: '',\n              feedbackSelected: '',\n              feedbackNotSelected: '',\n            },\n          },\n          {\n            uuid: v4(),\n            text: 'Plasma',\n            correct: false,\n            strings: {\n              hint: '',\n              feedbackSelected: '',\n              feedbackNotSelected: '',\n            },\n          },\n        ],\n        canAnswerMultiple: true,\n        retryAllowed: true,\n        randomOrder: true,\n        showSolutionsAllowed: true,\n        strings: {\n          checkButton: 'Antworten berprfen',\n          retryButton: 'Erneut versuchen',\n          solutionsButton: 'Lsungen anzeigen',\n          resultMessage: ':correct/:total',\n        },\n        feedback: defaultFeedback(),\n      };\n    case 'Sequencing':\n      return {\n        task_type: 'Sequencing',\n        cards: [\n          {\n            type: 'image',\n            uuid: v4(),\n            file_id: '',\n            altText: '',\n          },\n        ],\n        retryAllowed: true,\n        resumeAllowed: true,\n        showSolutionsAllowed: true,\n        strings: {\n          checkButton: 'Reihenfolge berprfen',\n          retryButton: 'Erneut versuchen',\n          resumeButton: 'Fortsetzen',\n          solutionsButton: 'Lsungen anzeigen',\n          resultMessage: ':correct von :total Elementen richtig sortiert.',\n        },\n        feedback: defaultFeedback(),\n      };\n    default:\n      throw new Error('Unimplemented type: ' + type);\n  }\n}\n\nexport function viewerForTaskType(type: TaskDefinition['task_type']) {\n  switch (type) {\n    case 'Crossword':\n      return CrosswordViewer;\n    case 'DragTheWords':\n      return DragTheWordsViewer;\n    case 'InteractiveVideo':\n      return InteractiveVideoViewer;\n    case 'FillInTheBlanks':\n      return FillInTheBlanksViewer;\n    case 'FindTheHotspots':\n      return FindTheHotspotsViewer;\n    case 'FindTheWords':\n      return FindTheWordsViewer;\n    case 'MarkTheWords':\n      return MarkTheWordsViewer;\n    case 'Memory':\n      return MemoryViewer;\n    case 'Pairing':\n      return PairingViewer;\n    case 'Question':\n      return QuestionViewer;\n    case 'Sequencing':\n      return SequencingViewer;\n    default:\n      throw new Error('Unimplemented task type: ' + type);\n  }\n}\n\nexport function editorForTaskType(type: TaskDefinition['task_type']) {\n  switch (type) {\n    case 'Crossword':\n      return CrosswordEditor;\n    case 'DragTheWords':\n      return DragTheWordsEditor;\n    case 'InteractiveVideo':\n      return InteractiveVideoEditor;\n    case 'FillInTheBlanks':\n      return FillInTheBlanksEditor;\n    case 'FindTheHotspots':\n      return FindTheHotspotsEditor;\n    case 'FindTheWords':\n      return FindTheWordsEditor;\n    case 'MarkTheWords':\n      return MarkTheWordsEditor;\n    case 'Memory':\n      return MemoryEditor;\n    case 'Pairing':\n      return PairingEditor;\n    case 'Question':\n      return QuestionEditor;\n    case 'Sequencing':\n      return SequencingEditor;\n    default:\n      throw new Error('Unimplemented task type: ' + type);\n  }\n}\n\nexport function printTaskType(type: TaskDefinition['task_type']): string {\n  switch (type) {\n    case 'Crossword':\n      return $gettext('Crossword');\n    case 'DragTheWords':\n      return $gettext('Drag The Words');\n    case 'InteractiveVideo':\n      return $gettext('Interactive Video');\n    case 'FillInTheBlanks':\n      return $gettext('Fill In The Blanks');\n    case 'FindTheHotspots':\n      return $gettext('Find The Hotspots');\n    case 'FindTheWords':\n      return $gettext('Find The Words');\n    case 'MarkTheWords':\n      return $gettext('Mark The Words');\n    case 'Memory':\n      return $gettext('Memory');\n    case 'Pairing':\n      return $gettext('Pairing');\n    case 'Question':\n      return $gettext('Question');\n    case 'Sequencing':\n      return $gettext('Sequencing');\n  }\n}\n\n/**\n * @return true if the viewer for the given task type should be visible\n * while the editor for that task type is open.\n */\nexport function showViewerAboveEditor(\n  type: TaskDefinition['task_type']\n): boolean {\n  switch (type) {\n    case 'InteractiveVideo':\n      return false;\n    default:\n      return true;\n  }\n}\n\nexport function iconForTaskType(type: TaskDefinition['task_type']): string {\n  switch (type) {\n    case 'DragTheWords':\n      return 'tan3';\n    case 'InteractiveVideo':\n      return 'file-video';\n    case 'FillInTheBlanks':\n      return 'file-office';\n    case 'FindTheWords':\n      return 'tan3';\n    case 'MarkTheWords':\n      return 'tan3';\n    case 'Memory':\n      return 'tan3';\n    case 'Pairing':\n      return 'copy';\n    case 'Question':\n      return 'question';\n    case 'Sequencing':\n      return 'picture';\n  }\n  return 'question';\n}\n","import axios from 'axios';\nimport { z } from 'zod';\n\nexport const httpClient = axios.create({\n  baseURL: window.STUDIP.URLHelper.getURL(`jsonapi.php/v1`, {}, true),\n  headers: {\n    'Content-Type': 'application/vnd.api+json',\n  },\n});\n\n/**\n * Send a request to the JSON API to create a file. Adapted from the file\n * \"courseware.module.js\" in the Stud.IP core.\n */\nexport async function createFile({\n  file,\n  fileData,\n  folder,\n}: {\n  file: CreateFileSpec;\n  fileData: File | Blob;\n  folder: Pick<FolderRef, 'id'>;\n}): Promise<FileRef> {\n  const termId = file?.relationships?.['terms-of-use']?.data?.id ?? null;\n  const formData = new FormData();\n  formData.append('file', fileData, file.attributes.name);\n  if (termId) {\n    formData.append('term-id', termId);\n  }\n  const url = `folders/${folder.id}/file-refs`;\n  const request = await httpClient.post(url, formData, {\n    headers: {\n      'Content-Type': 'multipart/form-data',\n    },\n  });\n  const response = await httpClient.get(request.headers.location);\n  const data = response.data.data;\n  return fileRefsSchema.parse(data);\n}\n\n/**\n * Send a request to the JSON API to get all folders for a given userId.\n */\nexport async function getFolders({\n  userId,\n}: {\n  userId: string;\n}): Promise<FolderRef[]> {\n  const url = `users/${userId}/folders`;\n\n  // Make the GET request\n  const response = await httpClient.get(url, {\n    headers: {\n      'Content-Type': 'application/vnd.api+json',\n    },\n  });\n\n  // Return the parsed response data\n  return response.data.data as FolderRef[];\n}\n\n/**\n * Send a request to the JSON API to create a folder.\n */\nexport async function createFolder({\n  userId,\n  name,\n  parentFolderId,\n  folderType,\n}: {\n  userId: string;\n  name: string;\n  parentFolderId: string;\n  folderType: string;\n}): Promise<FolderRef> {\n  // Construct the endpoint for creating a folder for a user\n  const url = `users/${userId}/folders`;\n\n  // Prepare the request payload\n  const payload = {\n    data: {\n      type: 'folders',\n      attributes: {\n        'folder-type': folderType,\n        name: name,\n      },\n      relationships: {\n        parent: {\n          data: {\n            type: 'folders',\n            id: parentFolderId,\n          },\n        },\n      },\n    },\n  };\n\n  // Make the POST request\n  const response = await httpClient.post(url, payload, {\n    headers: {\n      'Content-Type': 'application/vnd.api+json',\n    },\n  });\n\n  // Return the parsed response data\n  return response.data.data as FolderRef;\n}\n\n/**\n * Datatype 'file-refs' provided by the Stud.IP JSON API.\n */\nexport const fileRefsSchema = z.object({\n  type: z.literal('file-refs'),\n  id: z.string(),\n  attributes: z.object({\n    name: z.string(),\n    mkdate: z.string(),\n    chdate: z.string(),\n    description: z.string(),\n    downloads: z.number(),\n    filesize: z.number(),\n    'is-downloadable': z.boolean(),\n    'is-editable': z.boolean(),\n    'is-readable': z.boolean(),\n    'is-writable': z.boolean(),\n    'mime-type': z.string(),\n  }),\n  links: z.object({\n    self: z.string(),\n  }),\n  meta: z.object({\n    'download-url': z.string(),\n  }),\n  // 'unknown' for the moment because I did not care to write out types for this\n  // field and do not have a use for it in the code I have written thus far.\n  relationships: z.unknown(),\n});\nexport type FileRef = z.infer<typeof fileRefsSchema>;\n\nexport interface FolderRef {\n  id: string;\n  attributes: {\n    'folder-type': string;\n    'data-content': {\n      download_allowed: number;\n    };\n    name: string;\n  };\n  relationships?: {\n    parent?: {\n      data: {\n        id: string;\n      };\n    };\n  };\n}\n\n/**\n * A subset of the information contained in FileRef, containing the information\n * necessary to send a request to create a new file on the server.\n */\nexport interface CreateFileSpec {\n  relationships?: {\n    'terms-of-use'?: {\n      data?: {\n        id?: string;\n      };\n    };\n  };\n  attributes: {\n    name: string;\n  };\n}\n","import { TaskDefinition, taskDefinitionSchema } from '@/models/TaskDefinition';\nimport { z } from 'zod';\n\n/**\n * Save a Vue.js Lernmodul that is being edited in the \"Lernmodule\" tab of a\n * course.\n * @param taskDefinition The definition of the task\n * @param moduleName The name of the Lernmodul\n * @param infoText The HTML description of the Lernmodul\n * @param module_id The id from lernmodule_module\n * @param block_id The id from lernmodule_blocks where the module is to be\n *                 inserted.  (This only applies for newly created modules.)\n */\nexport async function saveTask(\n  taskDefinition: TaskDefinition,\n  moduleName: string,\n  infoText: string,\n  module_id: string,\n  block_id?: string\n): Promise<SaveTaskResponse> {\n  const url = window.STUDIP.LernmoduleVueJS.saveRoute;\n  const token = window.STUDIP.CSRF_TOKEN;\n  const formData = new FormData();\n  // Parse taskDefinition here to ensure it has no extra fields we didn't intend to save.\n  const parsedTaskDefinition = taskDefinitionSchema.parse(taskDefinition);\n  formData.append('task_definition', JSON.stringify(parsedTaskDefinition));\n  formData.append('module_id', module_id);\n  formData.append('name', moduleName);\n  formData.append('infotext', infoText);\n  if (block_id) {\n    formData.append('block_id', block_id);\n  }\n  formData.append(token.name, token.value);\n  return fetch(url, {\n    method: 'POST',\n    body: formData,\n  }).then((response) => {\n    if (!response.ok) {\n      throw new Error(response.statusText);\n    }\n    // TODO Maybe we should parse the server's response to ensure it really is\n    //  an instance of SaveTaskResponse.\n    return response.json() as Promise<SaveTaskResponse>;\n  });\n}\n\nexport interface SaveTaskResponse {\n  status: 'success';\n  taskDefinition: TaskDefinition;\n  moduleName: string;\n  infotext: string;\n}\n\n/**\n * Send a request to Stud.IP to update the number of points earned by the student\n * for the Lernmodul that is currently viewed.\n * @param points -- a map describing how many points the student should be reported\n * as having for each part of the Lernmodul.\n * Key: The ID or name of the part.  Value: The number of points.\n * @param success - If true, the attempt will be marked as 'successful'.\n */\nexport async function updateAttempt(\n  points: Record<string, number>,\n  success: boolean\n): Promise<void> {\n  // The ID of the Lernmodul is encoded in this URL provided to us by the server.\n  const url = window.STUDIP.LernmoduleVueJS.updateAttemptRoute;\n  const formData = new FormData();\n  const token = window.STUDIP.CSRF_TOKEN;\n  formData.append(token.name, token.value);\n  // Convert object into a nested array which PHP will understand\n  Object.entries(points).forEach(([name, score]) => {\n    formData.append(`message[points][${name}]`, score.toString());\n  });\n  if (success) {\n    formData.append('message[success]', 'true');\n  }\n  return fetch(url, {\n    method: 'POST',\n    body: formData,\n  }).then((response) => {\n    if (!response.ok) {\n      throw new Error(response.statusText);\n    }\n  });\n}\n\nexport const wysiwygUploadedFileSchema = z.object({\n  name: z.string(),\n  type: z.string(),\n  url: z.string(),\n});\n","import { Action, Module, Mutation, VuexModule } from 'vuex-module-decorators';\nimport {\n  newTask,\n  TaskDefinition,\n  taskDefinitionSchema,\n} from '@/models/TaskDefinition';\nimport { isArray, isEqual } from 'lodash';\nimport { saveTask, SaveTaskResponse } from '@/routes/lernmodule';\nimport { setAutoFreeze } from 'immer';\nimport { formatInvalidTaskDefinitionErrorMessage } from '@/functions';\nimport { InitializeMessage } from '@/models/CoursewareBlockIframeMessages';\n\n// Prevent immer from freezing objects.  This behavior causes trouble when we\n// attempt to use v-model with an object produced by immer, because v-model\n// works by mutating objects.\nsetAutoFreeze(false);\n\ntype Saved = {\n  status: 'saved';\n};\ntype Saving = {\n  status: 'saving';\n};\ntype SaveError = {\n  status: 'error';\n  error: unknown;\n};\ntype SaveStatus = Saved | Saving | SaveError;\n\ninterface UndoRedoState {\n  taskDefinition: TaskDefinition;\n  undoBatch: unknown;\n}\n\ntype TaskSaveLocation =\n  | {\n      type: 'cw_blocks';\n      id: string; // Corresponds to cw_blocks.id database column\n    }\n  | {\n      type: 'lernmodule_module';\n      id: string; // Corresponds to lernmodule_module.module_id database column\n    };\n\nfunction sleep(ms: number) {\n  return new Promise((r) => setTimeout(r, ms));\n}\n\n@Module({ name: 'taskEditor' })\nexport class TaskEditorModule extends VuexModule {\n  saveStatus: SaveStatus = { status: 'saved' };\n  fatalErrors: string[] = [];\n  nonFatalErrors: string[] = [];\n  serverTaskDefinition: TaskDefinition | [] = [];\n  serverModuleName: string = '';\n  serverInfotext: string = '';\n  moduleName: string = '';\n  infotext: string = '';\n  taskSaveLocation: TaskSaveLocation | null = null;\n  undoRedoStack: UndoRedoState[] = [\n    {\n      taskDefinition: newTask('FillInTheBlanks'),\n      undoBatch: {},\n    },\n  ];\n  undoRedoIndex = 0;\n\n  get taskDefinition(): TaskDefinition {\n    return this.undoRedoStack[this.undoRedoIndex].taskDefinition;\n  }\n\n  get hasUnsavedChanges(): boolean {\n    return (\n      !isEqual(this.taskDefinition, this.serverTaskDefinition) ||\n      this.serverModuleName !== this.moduleName ||\n      this.serverInfotext !== this.infotext\n    );\n  }\n\n  get canUndo() {\n    return this.undoRedoIndex > 0;\n  }\n\n  get canRedo() {\n    return this.undoRedoIndex < this.undoRedoStack.length - 1;\n  }\n\n  @Mutation\n  undo() {\n    if (this.undoRedoIndex > 0) {\n      const currentState = this.undoRedoStack[this.undoRedoIndex];\n      this.undoRedoIndex--;\n\n      // Focus the input field whose contents will change as a result of this undo.\n      // That's how undo/redo behaves in native apps like Microsoft Word.\n      // When you press undo, it scrolls to the point in the document where\n      // the undo took place.  This lets you observe the result of your action.\n      const inputElements = document.querySelectorAll(\n        `[data-undo-focus-id=\"${currentState.undoBatch}\"]`\n      );\n      if (inputElements.length > 0) {\n        const inputEl = inputElements.item(0) as HTMLElement;\n        // If the input is inside of a collapsed <fieldset>, then the <fieldset>\n        // should be un-collapsed so that the user can see the input field.\n        const collapsedParents = [\n          ...document.querySelectorAll('fieldset.collapsable.collapsed'),\n        ].filter((element) => element.contains(inputEl));\n        collapsedParents.forEach((parent) =>\n          parent.classList.remove('collapsed')\n        );\n        inputEl.focus();\n      }\n    }\n  }\n\n  @Mutation\n  redo() {\n    if (this.undoRedoIndex < this.undoRedoStack.length - 1) {\n      this.undoRedoIndex++;\n      const nextState = this.undoRedoStack[this.undoRedoIndex];\n\n      // Manage focus -- see comments in undo()\n      const inputElements = document.querySelectorAll(\n        `[data-undo-focus-id=\"${nextState.undoBatch}\"]`\n      );\n      if (inputElements.length > 0) {\n        const inputEl = inputElements.item(0) as HTMLElement;\n        const collapsedParents = [\n          ...document.querySelectorAll('fieldset.collapsable.collapsed'),\n        ].filter((element) => element.contains(inputEl));\n        collapsedParents.forEach((parent) =>\n          parent.classList.remove('collapsed')\n        );\n        inputEl.focus();\n      }\n    }\n  }\n\n  // Initialize the editor store to a state usable for courseware\n  @Mutation\n  initializeCourseware(payload: {\n    initializeMessage: InitializeMessage;\n    task_json: TaskDefinition;\n  }) {\n    console.info('initializeCourseware()', payload);\n    this.serverTaskDefinition = payload.task_json;\n    this.undoRedoStack = [\n      { taskDefinition: this.serverTaskDefinition, undoBatch: {} },\n    ];\n    this.taskSaveLocation = {\n      type: 'cw_blocks',\n      id: payload.initializeMessage.block.id,\n    };\n  }\n\n  // Initialize the editor store to a state usable for the non-courseware version\n  // of Lernmodule (AKA the 'Lernmodule' tab in a course).\n  @Mutation\n  initializeNonCourseware() {\n    // In Linux on Anns PC this is an empty array but on Windows on Thomas PC it's just NULL.\n    // We don't know why this is, but for now, we will just accept it and handle both cases.\n    if (\n      window.STUDIP.LernmoduleVueJS.module.customdata &&\n      !isArray(window.STUDIP.LernmoduleVueJS.module.customdata)\n    ) {\n      try {\n        this.serverTaskDefinition = taskDefinitionSchema.parse(\n          window.STUDIP.LernmoduleVueJS.module.customdata\n        );\n      } catch (e: unknown) {\n        const errorMessage = formatInvalidTaskDefinitionErrorMessage(\n          e,\n          window.STUDIP.LernmoduleVueJS.module.customdata\n        );\n        console.error(errorMessage, e);\n        console.error(\n          'task_json: ',\n          window.STUDIP.LernmoduleVueJS.module.customdata\n        );\n        throw new Error(errorMessage, { cause: e });\n      }\n      this.undoRedoStack = [\n        { taskDefinition: this.serverTaskDefinition, undoBatch: {} },\n      ];\n    }\n    this.serverModuleName = window.STUDIP.LernmoduleVueJS.module.name;\n    this.serverInfotext = window.STUDIP.LernmoduleVueJS.infotext;\n    this.moduleName = window.STUDIP.LernmoduleVueJS.module.name;\n    this.infotext = window.STUDIP.LernmoduleVueJS.infotext;\n    this.taskSaveLocation = {\n      type: 'lernmodule_module',\n      id: window.STUDIP.LernmoduleVueJS.module.module_id,\n    };\n  }\n\n  @Mutation\n  startedSaving() {\n    this.saveStatus = { status: 'saving' };\n  }\n\n  @Mutation\n  saveSuccess(payload: SaveTaskResponse) {\n    this.saveStatus = { status: 'saved' };\n    this.serverTaskDefinition = payload.taskDefinition;\n    this.serverModuleName = payload.moduleName;\n    this.serverInfotext = payload.infotext;\n  }\n\n  @Mutation\n  saveFailure(error: unknown) {\n    this.saveStatus = { status: 'error', error };\n    this.nonFatalErrors.push(\n      'The task could not be saved.  Check the console for more details. '\n    );\n    console.log(error);\n  }\n\n  @Action\n  async saveTask() {\n    if (this.saveStatus.status === 'saving') {\n      return;\n    }\n    this.context.commit('startedSaving');\n    try {\n      const saveResult = await saveTask(\n        this.taskDefinition,\n        this.moduleName,\n        this.infotext,\n        window.STUDIP.LernmoduleVueJS.module.module_id,\n        window.STUDIP.LernmoduleVueJS.block_id\n      );\n      await sleep(500);\n      this.context.commit('saveSuccess', saveResult);\n    } catch (error) {\n      this.context.commit('saveFailure', { error });\n    }\n  }\n\n  /**\n   * Modify the currently edited task definition, creating a new undo/redo state\n   * if appropriate.  Edits are batched together based on the parameter 'undoBatch'.\n   * @param payload.taskDefinition The new state of the task being edited\n   * @param payload.undoBatch (Optional) Any value.\n   * If undoBatch is not provided or an empty object is provided, a new\n   * undo/redo state will always be created.\n   * Otherwise, a new undo/redo state will be created iff undoBatch is different\n   * from the undoBatch of the previously performed action.\n   */\n  @Mutation\n  performEdit(payload: {\n    newTaskDefinition: TaskDefinition;\n    undoBatch?: unknown;\n  }) {\n    if (!payload.undoBatch) {\n      payload.undoBatch = {};\n    }\n    const currentUndoRedoState = this.undoRedoStack[this.undoRedoIndex];\n    if (\n      isEqual(currentUndoRedoState.taskDefinition, payload.newTaskDefinition)\n    ) {\n      return; // Do not pollute the undo-redo history with no-op changes\n    }\n    const shouldMergeEdits =\n      !isEqual(payload.undoBatch, {}) &&\n      isEqual(payload.undoBatch, currentUndoRedoState.undoBatch);\n    if (shouldMergeEdits) {\n      // Amend the last undo state instead of creating a new one.\n      currentUndoRedoState.taskDefinition = payload.newTaskDefinition;\n      this.undoRedoStack = this.undoRedoStack.slice(0, this.undoRedoIndex + 1);\n    } else {\n      // Create a new undo state and append it to the stack.\n      this.undoRedoStack = this.undoRedoStack\n        .slice(0, this.undoRedoIndex + 1)\n        .concat([\n          {\n            taskDefinition: payload.newTaskDefinition,\n            undoBatch: payload.undoBatch,\n          },\n        ]);\n      this.undoRedoIndex += 1;\n    }\n  }\n\n  @Mutation\n  setModuleName(name: string) {\n    this.moduleName = name;\n  }\n\n  @Mutation\n  setInfoText(value: string) {\n    this.infotext = value;\n  }\n}\n","import { Action, Module, Mutation, VuexModule } from 'vuex-module-decorators';\nimport { taskEditorStore } from '@/store';\nimport { Context } from '@/models/CoursewareBlockIframeMessages';\n\n@Module({ name: 'coursewareBlock' })\nexport class CoursewareBlockModule extends VuexModule {\n  showEditorUI: boolean = false;\n  studipContext: Context = {\n    id: '',\n    type: '',\n  };\n\n  // Toggle whether to show the editing UI in the courseware block.\n  // This should be triggered via messages posted to the iframe.\n  // See courseware-main.ts and LernmoduleCoursewareBlockBase.js.\n  @Mutation\n  setShowEditorUI(state: boolean) {\n    this.showEditorUI = state;\n  }\n\n  @Mutation\n  saveBlock() {\n    console.log('coursewareBlockStore: saveBlock() mutation called');\n    // Tell the Vue 2 component we are wrapped in to save the block.\n    // See the method 'onWindowMessage' of LernmoduleCoursewareBlockBase.js\n    // The taskDefinition must be serialized in order for it to be passed\n    // between windows.\n    const taskDefinition = JSON.parse(\n      JSON.stringify(taskEditorStore.taskDefinition)\n    );\n    window.parent.postMessage({\n      type: 'SaveCoursewareBlock',\n      taskDefinition,\n    });\n  }\n\n  @Mutation\n  cancelEditing() {\n    console.log('coursewareBlockStore: cancelEditing() mutation called');\n    // Tell the Vue 2 component we are wrapped in to stop editing the block\n    // without saving the user's changes.\n    // See the method 'onWindowMessage' of LernmoduleCoursewareBlockBase.js\n    window.parent.postMessage({\n      type: 'CancelEditingCoursewareBlock',\n    });\n  }\n\n  @Mutation\n  setContext(context: Context) {\n    this.studipContext = context;\n  }\n}\n","import { Module, VuexModule, Mutation, Action } from 'vuex-module-decorators';\n\n@Module({ name: 'requestQueue' })\nexport class RequestQueueModule extends VuexModule {\n  queue: Array<() => Promise<void>> = [];\n  active = 0;\n  maxConcurrent = 6;\n  delay = 0;\n\n  // Mutation to add a request to the queue\n  @Mutation\n  addToQueue(request: () => Promise<void>) {\n    this.queue.push(request);\n  }\n\n  // Mutation to update active request count\n  @Mutation\n  incrementActive() {\n    this.active++;\n  }\n\n  @Mutation\n  decrementActive() {\n    this.active--;\n  }\n\n  // Action to handle queue processing\n  @Action\n  async processQueue() {\n    if (this.active >= this.maxConcurrent) {\n      console.debug(\n        `Max concurrent limit reached (${this.maxConcurrent}). Active requests: ${this.active}. Queue length: ${this.queue.length}`\n      );\n      return;\n    }\n\n    if (this.queue.length === 0) {\n      console.debug(`Queue is empty. Active requests: ${this.active}`);\n      return;\n    }\n\n    const request = this.queue.shift();\n    if (request) {\n      this.context.commit('incrementActive');\n\n      try {\n        await request();\n      } finally {\n        this.context.commit('decrementActive');\n\n        if (this.delay) {\n          await new Promise((resolve) => setTimeout(resolve, this.delay));\n        }\n\n        await this.processQueue(); // Recursively process the next request\n      }\n    }\n  }\n\n  // Action to add a request and trigger queue processing\n  @Action\n  async enqueue(request: () => Promise<void>) {\n    this.context.commit('addToQueue', request);\n    await this.processQueue();\n  }\n}\n","// eslint-disable\nfunction filterQueryString(obj) {\n  return Object.keys(obj)\n    .map((k) => `filter[${k}]=${encodeURIComponent(obj[k])}`)\n    .join('&');\n}\n\nconst getOptionsQuery = (optionsObject = {}) =>\n  Object.keys(optionsObject)\n    .filter((k) => typeof optionsObject[k] !== 'undefined')\n    .map((k) => `${k}=${encodeURIComponent(optionsObject[k])}`)\n    .join('&');\n\nconst relatedResourceUrl = ({ parent, relationship }) => {\n  const builtUrl = `${parent.type}/${parent.id}/${relationship}`;\n\n  if (\n    parent.relationships &&\n    Object.keys(parent.relationships).includes(relationship)\n  ) {\n    return parent.relationships[relationship].links?.related ?? builtUrl;\n  }\n  return builtUrl;\n};\n\nconst extractData = (response) => response.data;\n\nconst extractErrorResponse = (error) => {\n  if (error && error.response) {\n    throw error.response;\n  } else {\n    throw error;\n  }\n};\n\nclass Resource {\n  constructor({ name, httpClient }) {\n    this.name = name;\n    this.api = httpClient;\n  }\n\n  all({ options = {} } = {}) {\n    let url;\n\n    if (options.url) {\n      ({ url } = options);\n    } else {\n      url = `${this.name}?${getOptionsQuery(options)}`;\n    }\n\n    return this.api.get(url).then(extractData).catch(extractErrorResponse);\n  }\n\n  find({ id, options } = {}) {\n    const url = `${this.name}/${id}?${getOptionsQuery(options)}`;\n\n    return this.api.get(url).then(extractData).catch(extractErrorResponse);\n  }\n\n  where({ filter, options } = {}) {\n    const queryString = filterQueryString(filter);\n    return this.api\n      .get(`${this.name}?${queryString}&${getOptionsQuery(options)}`)\n      .then(extractData)\n      .catch(extractErrorResponse);\n  }\n\n  related({ parent, relationship = this.name, options }) {\n    const baseUrl = relatedResourceUrl({ parent, relationship });\n    const url = `${baseUrl}?${getOptionsQuery(options)}`;\n    return this.api.get(url).then(extractData).catch(extractErrorResponse);\n  }\n\n  create(partialRecord) {\n    const record = Object.assign({}, partialRecord, { type: this.name });\n    const requestData = { data: record };\n    return this.api\n      .post(`${this.name}`, requestData)\n      .then(extractData)\n      .catch(extractErrorResponse);\n  }\n\n  createRelated(partialRecord) {\n    const record = Object.assign({}, partialRecord, { type: this.name });\n    const requestData = { data: record };\n    return this.api\n      .post(`${this.name}`, requestData)\n      .then(extractData)\n      .catch(extractErrorResponse);\n  }\n\n  updateRelationships(parent, relationship, records) {\n    // https://jsonapi.org/format/#crud-updating-to-many-relationships\n    const requestData = { data: records };\n    return this.api\n      .patch(\n        `${parent.type}/${parent.id}/relationships/${relationship}`,\n        requestData\n      )\n      .then(extractData)\n      .catch(extractErrorResponse);\n  }\n\n  createRelationships(parent, relationship, records) {\n    // https://jsonapi.org/format/#crud-updating-to-many-relationships\n    const requestData = { data: records };\n    return this.api\n      .post(\n        `${parent.type}/${parent.id}/relationships/${relationship}`,\n        requestData\n      )\n      .then(extractData)\n      .catch(extractErrorResponse);\n  }\n\n  removeRelationships(parent, relationship, records) {\n    // https://jsonapi.org/format/#crud-updating-to-many-relationships\n    const requestData = { data: records };\n    return this.api\n      .delete(\n        `${parent.type}/${parent.id}/relationships/${relationship}`,\n        requestData\n      )\n      .then(extractData)\n      .catch(extractErrorResponse);\n  }\n\n  update(record) {\n    // http://jsonapi.org/faq/#wheres-put\n    const requestData = { data: record };\n    return this.api\n      .patch(`${this.name}/${record.id}`, requestData)\n      .then(extractData)\n      .catch(extractErrorResponse);\n  }\n\n  delete({ id }) {\n    return this.api.delete(`${this.name}/${id}`).catch(extractErrorResponse);\n  }\n}\n\nexport default Resource;\n","// eslint-ignore\nimport ResourceClient from './reststate-client.js';\nimport { isEqual } from 'lodash';\n\nconst STATUS_INITIAL = 'INITIAL';\nconst STATUS_LOADING = 'LOADING';\nconst STATUS_ERROR = 'ERROR';\nconst STATUS_SUCCESS = 'SUCCESS';\n\nconst storeRecord = (records) => (newRecord) => {\n  const existingRecord = records.find((r) => r.id === newRecord.id);\n  if (existingRecord) {\n    Object.assign(existingRecord, newRecord);\n  } else {\n    records.push(newRecord);\n  }\n};\n\nconst getResourceIdentifier = (resource) => {\n  if (!resource) {\n    return resource;\n  }\n\n  return {\n    type: resource.type,\n    id: resource.id,\n  };\n};\n\nconst getRelationshipType = (relationship) => {\n  const data = Array.isArray(relationship.data)\n    ? relationship.data[0]\n    : relationship.data;\n\n  return data && data.type;\n};\n\nconst storeIncluded = ({ dispatch }, result) => {\n  if (result.included) {\n    // store the included records\n    result.included.forEach((relatedRecord) => {\n      const action = `${relatedRecord.type}/storeRecord`;\n      dispatch(action, relatedRecord, { root: true });\n    });\n\n    // store the relationship for primary and secondary records\n    let allRecords = [...result.included];\n    if (Array.isArray(result.data)) {\n      allRecords = [...allRecords, ...result.data];\n    } else {\n      allRecords = [...allRecords, result.data];\n    }\n\n    allRecords.forEach((primaryRecord) => {\n      if (primaryRecord.relationships) {\n        Object.keys(primaryRecord.relationships).forEach((relationshipName) => {\n          const relationship = primaryRecord.relationships[relationshipName];\n          if (!relationship.data || relationship.data.length === 0) {\n            return;\n          }\n\n          const type = getRelationshipType(relationship);\n          let relatedIds;\n          if (Array.isArray(relationship.data)) {\n            relatedIds = relationship.data.map(\n              (relatedRecord) => relatedRecord.id\n            );\n          } else {\n            ({ id: relatedIds } = relationship.data);\n          }\n          const options = {\n            relatedIds,\n            params: {\n              parent: getResourceIdentifier(primaryRecord),\n              relationship: relationshipName,\n            },\n          };\n          const action = `${type}/storeRelated`;\n          dispatch(action, options, { root: true });\n        });\n      }\n    });\n  }\n};\n\nconst matches = (criteria) => (test) =>\n  Object.keys(criteria).every((key) => isEqual(criteria[key], test[key]));\n\nconst handleError = (commit) => (errorResponse) => {\n  commit('SET_STATUS', STATUS_ERROR);\n  commit('STORE_ERROR', errorResponse);\n  throw errorResponse;\n};\n\nconst initialState = () => ({\n  records: [],\n  related: [],\n  filtered: [],\n  page: [],\n  error: null,\n  status: STATUS_INITIAL,\n  links: {},\n  lastCreated: null,\n  lastMeta: null,\n});\n\nconst resourceModule = ({ name: resourceName, httpClient }) => {\n  const client = new ResourceClient({ name: resourceName, httpClient });\n\n  const getRelationshipIndex = (params) => {\n    const { parent, relationship = resourceName } = params;\n    const parentResourceIdentifier = getResourceIdentifier(parent);\n\n    return {\n      parent: parentResourceIdentifier,\n      relationship,\n    };\n  };\n\n  return {\n    namespaced: true,\n\n    state: initialState,\n\n    mutations: {\n      REPLACE_ALL_RECORDS: (state, records) => {\n        state.records = records;\n      },\n\n      REPLACE_ALL_RELATED: (state, related) => {\n        state.related = related;\n      },\n\n      SET_STATUS: (state, status) => {\n        state.status = status;\n      },\n\n      STORE_RECORD: (state, newRecord) => {\n        const { records } = state;\n\n        storeRecord(records)(newRecord);\n      },\n\n      STORE_RECORDS: (state, newRecords) => {\n        const { records } = state;\n\n        newRecords.forEach(storeRecord(records));\n      },\n\n      STORE_PAGE: (state, records) => {\n        state.page = records.map(({ id }) => id);\n      },\n\n      STORE_META: (state, meta) => {\n        state.lastMeta = meta;\n      },\n\n      STORE_ERROR: (state, error) => {\n        state.error = error;\n      },\n\n      STORE_RELATED: (state, { relatedIds, params, resetRelated = true }) => {\n        const { related } = state;\n        const relationshipIndex = getRelationshipIndex(params);\n        const existingRecord = related.find(matches(relationshipIndex));\n        if (existingRecord) {\n          if (resetRelated) {\n            existingRecord.relatedIds = relatedIds;\n          } else {\n            const ids = new Set([...existingRecord.relatedIds, ...relatedIds]);\n            existingRecord.relatedIds = [...ids];\n          }\n        } else {\n          related.push(Object.assign({ relatedIds }, relationshipIndex));\n        }\n      },\n\n      STORE_FILTERED: (state, { matchedIds, params }) => {\n        const { filtered } = state;\n\n        const existingRecord = filtered.find(matches(params));\n        if (existingRecord) {\n          existingRecord.matchedIds = matchedIds;\n        } else {\n          filtered.push(Object.assign({ matchedIds }, params));\n        }\n      },\n\n      STORE_LAST_CREATED: (state, record) => {\n        state.lastCreated = record;\n      },\n\n      REMOVE_RECORD: (state, record) => {\n        state.records = state.records.filter((r) => r.id !== record.id);\n      },\n\n      SET_LINKS: (state, links) => {\n        state.links = links || {};\n      },\n\n      RESET_STATE: (state) => {\n        Object.assign(state, initialState());\n      },\n    },\n\n    actions: {\n      loadAll({ commit, dispatch }, { options } = {}) {\n        commit('SET_STATUS', STATUS_LOADING);\n        return client\n          .all({ options })\n          .then((result) => {\n            commit('SET_STATUS', STATUS_SUCCESS);\n            commit('REPLACE_ALL_RECORDS', result.data);\n            commit('STORE_META', result.meta);\n            storeIncluded({ commit, dispatch }, result);\n          })\n          .catch(handleError(commit));\n      },\n\n      loadById({ commit, dispatch }, { id, options }) {\n        commit('SET_STATUS', STATUS_LOADING);\n        return client\n          .find({ id, options })\n          .then((results) => {\n            commit('SET_STATUS', STATUS_SUCCESS);\n            commit('STORE_RECORD', results.data);\n            commit('STORE_META', results.meta);\n            storeIncluded({ commit, dispatch }, results);\n          })\n          .catch(handleError(commit));\n      },\n\n      loadWhere({ commit, dispatch }, params) {\n        const { filter, options } = params;\n        commit('SET_STATUS', STATUS_LOADING);\n        return client\n          .where({ filter, options })\n          .then((results) => {\n            commit('SET_STATUS', STATUS_SUCCESS);\n            const matches = results.data;\n            const matchedIds = matches.map((record) => record.id);\n            commit('STORE_RECORDS', matches);\n            commit('STORE_FILTERED', { params, matchedIds });\n            commit('STORE_META', results.meta);\n            storeIncluded({ commit, dispatch }, results);\n          })\n          .catch(handleError(commit));\n      },\n\n      loadPage({ commit, dispatch }, { options }) {\n        commit('SET_STATUS', STATUS_LOADING);\n        return client\n          .all({ options })\n          .then((response) => {\n            commit('SET_STATUS', STATUS_SUCCESS);\n            commit('STORE_RECORDS', response.data);\n            commit('STORE_PAGE', response.data);\n            commit('STORE_META', response.meta);\n            commit('SET_LINKS', response.links);\n            storeIncluded({ commit, dispatch }, response);\n          })\n          .catch(handleError(commit));\n      },\n\n      loadNextPage({ commit, state, dispatch }) {\n        const options = {\n          url: state.links.next,\n        };\n        return client.all({ options }).then((response) => {\n          commit('STORE_RECORDS', response.data);\n          commit('STORE_PAGE', response.data);\n          commit('SET_LINKS', response.links);\n          commit('STORE_META', response.meta);\n          storeIncluded({ commit, dispatch }, response);\n        });\n      },\n\n      loadPreviousPage({ commit, state, dispatch }) {\n        const options = {\n          url: state.links.prev,\n        };\n        return client.all({ options }).then((response) => {\n          commit('STORE_RECORDS', response.data);\n          commit('STORE_PAGE', response.data);\n          commit('SET_LINKS', response.links);\n          commit('STORE_META', response.meta);\n          storeIncluded({ commit, dispatch }, response);\n        });\n      },\n\n      loadRelated({ commit, dispatch }, params) {\n        const {\n          parent,\n          relationship = resourceName,\n          options,\n          resetRelated = true,\n        } = params;\n        commit('SET_STATUS', STATUS_LOADING);\n        const paramsToStore = {\n          ...params,\n          relationship,\n        };\n        return client\n          .related({ parent, relationship, options })\n          .then((results) => {\n            commit('SET_STATUS', STATUS_SUCCESS);\n            if (Array.isArray(results.data)) {\n              const relatedRecords = results.data;\n              const relatedIds = relatedRecords.map((record) => record.id);\n              commit('STORE_RECORDS', relatedRecords);\n              commit('STORE_RELATED', {\n                params: paramsToStore,\n                relatedIds,\n                resetRelated,\n              });\n            } else {\n              const record = results.data;\n              const relatedIds = record.id;\n              commit('STORE_RECORDS', [record]);\n              commit('STORE_RELATED', { params: paramsToStore, relatedIds });\n            }\n            commit('STORE_META', results.meta);\n            storeIncluded({ commit, dispatch }, results);\n          })\n          .catch(handleError(commit));\n      },\n\n      create({ commit }, recordData) {\n        return client.create(recordData).then((result) => {\n          commit('STORE_RECORD', result.data);\n          commit('STORE_LAST_CREATED', result.data);\n        });\n      },\n\n      update({ commit, dispatch, getters }, record) {\n        return client.update(record).then(({ data: newRecord }) => {\n          const oldRecord = getters.byId({ id: record.id });\n\n          // remove old relationships first\n          if (oldRecord && oldRecord.relationships) {\n            for (const entry of Object.entries(oldRecord.relationships)) {\n              const [relationship, entity] = entry;\n              const type = getRelationshipType(entity);\n              const paramsToStore = {\n                relationship,\n                parent: getResourceIdentifier(oldRecord),\n              };\n\n              // we cannot update the related resource without a type\n              // this could possibly be very bad as we cannot remove existing\n              // relationships\n              if (type === null || type === undefined) {\n                continue;\n              }\n\n              dispatch(\n                `${type}/storeRelated`,\n                {\n                  params: paramsToStore,\n                  relatedIds: null,\n                },\n                { root: true }\n              );\n            }\n          }\n\n          // save entity\n          commit('STORE_RECORD', newRecord);\n\n          // set new relationships\n          if (newRecord.relationships) {\n            for (const relationship of Object.keys(newRecord.relationships)) {\n              const relationshipObject = newRecord.relationships[relationship];\n              const { data } = relationshipObject;\n              const isNonEmptyArray =\n                Array.isArray(data) && Boolean(data.length);\n              const isObject = Boolean(data && data.type && data.id);\n\n              if (isNonEmptyArray || isObject) {\n                const paramsToStore = {\n                  parent: getResourceIdentifier(newRecord),\n                  relationship,\n                };\n                const type = getRelationshipType(relationshipObject);\n                let relatedIds;\n                if (Array.isArray(data)) {\n                  relatedIds = data.map((record) => record.id);\n                } else {\n                  relatedIds = data.id;\n                }\n                dispatch(\n                  `${type}/storeRelated`,\n                  {\n                    params: paramsToStore,\n                    relatedIds,\n                  },\n                  { root: true }\n                );\n              }\n            }\n          }\n        });\n      },\n\n      delete({ commit }, record) {\n        return client.delete(record).then(() => {\n          commit('REMOVE_RECORD', record);\n        });\n      },\n\n      storeRecord({ commit }, record) {\n        commit('STORE_RECORD', record);\n      },\n\n      storeRelated({ commit }, { relatedIds, params }) {\n        commit('STORE_RELATED', {\n          relatedIds,\n          params,\n        });\n      },\n\n      removeRecord({ commit }, record) {\n        commit('REMOVE_RECORD', record);\n      },\n\n      resetState({ commit }) {\n        commit('RESET_STATE');\n      },\n\n      addRelated({ getters }, params) {\n        const { parent, relationship = resourceName, data } = params;\n        const relatedItems = getters.related(params).map((o) => o.id);\n        const difference = data.filter((x) => !relatedItems.includes(x));\n        const records = difference.map((id) => {\n          return { type: relationship, id };\n        });\n        return client.createRelationships(parent, relationship, records);\n      },\n\n      setRelated({ commit }, params) {\n        const { parent, relationship = resourceName, data } = params;\n        return client\n          .updateRelationships(parent, relationship, data)\n          .then(() => {\n            let relatedIds;\n            if (Array.isArray(data)) {\n              relatedIds = data.map((record) => record.id);\n            } else if (data === null) {\n              relatedIds = null;\n            } else {\n              relatedIds = data.id;\n            }\n            commit('STORE_RELATED', {\n              params: { parent, relationship },\n              relatedIds,\n            });\n          });\n      },\n\n      removeRelated({ commit }, params) {\n        const { parent, relationship = resourceName, data } = params;\n        client.removeRelationships(parent, relationship, data);\n        let relatedIds;\n        if (Array.isArray(data)) {\n          relatedIds = data.map((record) => record.id);\n        } else {\n          relatedIds = data.id;\n        }\n        commit('REMOVE_RELATED', {\n          params: { parent, relationship },\n          relatedIds,\n        });\n      },\n\n      removeAllRelated({ commit }, params) {\n        const { parent, relationship = resourceName } = params;\n        client.updateRelationships(parent, relationship, []);\n        commit('REMOVE_RELATED', {\n          params: { parent, relationship },\n          relatedIds: [],\n        });\n      },\n    },\n\n    getters: {\n      isLoading: (state) => state.status === STATUS_LOADING,\n      isError: (state) => state.status === STATUS_ERROR,\n      error: (state) => state.error,\n      hasPrevious: (state) => !!state.links.prev,\n      hasNext: (state) => !!state.links.next,\n      all: (state) => state.records,\n      lastCreated: (state) => state.lastCreated,\n      byId:\n        (state) =>\n        ({ id }) =>\n          state.records.find((r) => r.id == id),\n      lastMeta: (state) => state.lastMeta,\n      page: (state) =>\n        state.page.map((id) =>\n          state.records.find((record) => record.id === id)\n        ),\n      where: (state) => (params) => {\n        const entry = state.filtered.find(matches(params));\n\n        if (!entry) {\n          return [];\n        }\n\n        const ids = entry.matchedIds;\n        return ids.map((id) =>\n          state.records.find((record) => record.id === id)\n        );\n      },\n      related: (state) => (params) => {\n        const relationshipIndex = getRelationshipIndex(params);\n        const related = state.related.find(matches(relationshipIndex));\n\n        if (!related) {\n          return null;\n        } else if (Array.isArray(related.relatedIds)) {\n          const ids = related.relatedIds;\n          return ids\n            .map((id) => state.records.find((record) => record.id === id))\n            .filter((record) => record !== undefined);\n        } else {\n          const id = related.relatedIds;\n          return state.records.find((record) => id === record.id);\n        }\n      },\n    },\n  };\n};\n\nconst mapResourceModules = ({ names, httpClient }) =>\n  names.reduce(\n    (acc, name) =>\n      Object.assign({ [name]: resourceModule({ name, httpClient }) }, acc),\n    {}\n  );\n\nexport { resourceModule, mapResourceModules };\n","import { createStore } from 'vuex';\nimport { getModule } from 'vuex-module-decorators';\nimport { TaskEditorModule } from '@/store/modules/taskEditor';\nimport { CoursewareBlockModule } from '@/store/modules/coursewareBlock';\nimport { RequestQueueModule } from '@/store/modules/requestQueue';\nimport { httpClient } from '@/routes/jsonApi';\nimport { mapResourceModules } from '@/reststate-vuex/reststate-vuex.js';\n\nexport const store = createStore({\n  modules: {\n    taskEditor: TaskEditorModule,\n    coursewareBlock: CoursewareBlockModule,\n    requestQueue: RequestQueueModule,\n    // Dynamically generated store modules used to access Stud.IP's JSON API\n    ...mapResourceModules({\n      names: [\n        'courses',\n        'course-memberships',\n        'courseware-blocks',\n        'courseware-block-comments',\n        'courseware-block-feedback',\n        'courseware-clipboards',\n        'courseware-containers',\n        'courseware-instances',\n        'courseware-public-links',\n        'courseware-structural-elements',\n        'courseware-structural-element-comments',\n        'courseware-structural-element-feedback',\n        'courseware-task-feedback',\n        'courseware-task-groups',\n        'courseware-tasks',\n        'courseware-templates',\n        'courseware-user-data-fields',\n        'courseware-user-progresses',\n        'courseware-units',\n        'files',\n        'file-refs',\n        'folders',\n        'lti-tools',\n        'status-groups',\n        'users',\n        'institutes',\n        'institute-memberships',\n        'semesters',\n        'sem-classes',\n        'sem-types',\n        'terms-of-use',\n        'user-data-field',\n        'studip-properties',\n        'lernmodule-plugin/travis-go-posts',\n        'lernmodule-plugin/travis-go-comments',\n      ],\n      httpClient,\n    }),\n  },\n});\n// These variables have type information attached to them, thanks to\n// the library vuex-module-decorators.\nexport const taskEditorStore = getModule(TaskEditorModule, store);\nexport const coursewareBlockStore = getModule(CoursewareBlockModule, store);\nexport const requestQueueStore = getModule(RequestQueueModule, store);\n","import { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-2efd9bb9\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"error-message\" }\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createElementVNode(\"p\", null, _toDisplayString(_ctx.$gettext('Es ist ein Fehler aufgetreten!')), 1),\n    _createElementVNode(\"p\", null, _toDisplayString(_ctx.error), 1)\n  ]))\n}","<script lang=\"ts\">\nimport { defineComponent } from 'vue';\nimport { $gettext } from '../language/gettext';\n\nexport default defineComponent({\n  name: 'ErrorMessage',\n  methods: { $gettext },\n  props: {\n    error: {\n      required: false,\n    },\n  },\n});\n</script>\n\n<template>\n  <div class=\"error-message\">\n    <p>{{ $gettext('Es ist ein Fehler aufgetreten!') }}</p>\n    <p>{{ error }}</p>\n  </div>\n</template>\n\n<style scoped>\n.error-message {\n  max-height: 200px;\n  overflow-y: scroll;\n  white-space: pre-wrap;\n  font-family: monospace;\n}\n</style>\n","import { render } from \"./ErrorMessage.vue?vue&type=template&id=2efd9bb9&scoped=true&ts=true\"\nimport script from \"./ErrorMessage.vue?vue&type=script&lang=ts\"\nexport * from \"./ErrorMessage.vue?vue&type=script&lang=ts\"\n\nimport \"./ErrorMessage.vue?vue&type=style&index=0&id=2efd9bb9&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-2efd9bb9\"]])\n\nexport default __exports__","import { openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nconst _hoisted_1 = [\"value\"]\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  return (_openBlock(), _createElementBlock(\"textarea\", {\n    value: _ctx.modelValue,\n    ref: \"studip_wysiwyg\",\n    class: \"studip-wysiwyg\",\n    onInput: _cache[0] || (_cache[0] = ($event: any) => (_ctx.updateValue($event.target.value)))\n  }, null, 40, _hoisted_1))\n}","<template>\n  <textarea\n    :value=\"modelValue\"\n    ref=\"studip_wysiwyg\"\n    class=\"studip-wysiwyg\"\n    @input=\"updateValue($event.target.value)\"\n  />\n</template>\n\n<script lang=\"ts\">\n// need v-model to provide and get content -> <studip-wysiwyg v-model=\"content\" />\nimport { defineComponent } from 'vue';\n\nexport default defineComponent({\n  name: 'studip-wysiwyg',\n  props: {\n    modelValue: String,\n    forceSoftBreaks: {\n      type: Boolean,\n      required: false,\n      default: false,\n    },\n    removeWrappingPTag: {\n      type: Boolean,\n      required: false,\n      default: false,\n    },\n    disableAutoformat: {\n      type: Boolean,\n      required: false,\n      default: false,\n    },\n    insertHtmlComment: {\n      type: Boolean,\n      required: false,\n      default: false,\n    },\n  },\n  data() {\n    return {\n      fallbackActive: false,\n    };\n  },\n  mounted() {\n    let ckeInit = this.initCKE();\n    if (!ckeInit) {\n      this.fallbackActive = true;\n    }\n  },\n  watch: {\n    modelValue(value: string) {\n      if (!this.fallbackActive) {\n        // Copy the new value into CKEditor (only if it's changed)\n        const textAreaElement = this.$refs\n          .studip_wysiwyg as HTMLTextAreaElement;\n        const ckeditor = window.STUDIP.wysiwyg.getEditor(textAreaElement)!;\n        const currentData = this.getAdjustedCkeditorData();\n        if (currentData !== value) {\n          ckeditor.data.set(value);\n        }\n      }\n    },\n  },\n  methods: {\n    initCKE() {\n      const textAreaElement = this.$refs.studip_wysiwyg as HTMLTextAreaElement;\n      // Process the jQuery event 'wysiwyg.load' which is triggered asynchronously\n      // after the wysiwyg editor is mounted using the 'replace()' method.\n      textAreaElement.onload = (event: any) => {\n        console.info('load');\n        let ckeditor = window.STUDIP.wysiwyg.getEditor(textAreaElement)!;\n        ckeditor.model.document.on('change:data', () => {\n          let data = this.getAdjustedCkeditorData();\n          this.$emit('update:modelValue', data);\n        });\n        ckeditor.editing.view.document.on(\n          'enter',\n          (evt, data) => {\n            if (this.forceSoftBreaks) {\n              // Override 'enter' to insert <br /> instead of <p></p> in the editor.\n              // This produces HTML which is more easily parsed in our various learning tasks.\n              // Source: https://github.com/ckeditor/ckeditor5/issues/1141#issuecomment-403403526\n              ckeditor.execute('shiftEnter');\n              data.preventDefault();\n              evt.stop();\n            }\n          },\n          { priority: 'high' }\n        );\n        if (this.disableAutoformat) {\n          // Disable the autoformat plugin so that *asterisks* surrounding text\n          // are not automatically converted into italic formatting.\n          // We use this syntax in the editor for various tasks, such as Fill In The Blanks.\n          // (It might be nicer to disable this using 'removePlugins' option in\n          // the config for CKEditor5, but the interface of STUDIP.wysiwyg.replace()\n          // does not allow us to alter the CKEditor5 config.)\n          const autoformat = ckeditor.plugins.get('Autoformat');\n          (autoformat as unknown as { isEnabled: boolean }).isEnabled = false;\n        }\n      };\n      // This asynchronous method does not return a promise.  Instead, it fires\n      // a 'load' event, which is processed in the above event handler. >:|\n      window.STUDIP.wysiwyg.replace(textAreaElement);\n      return true;\n    },\n    updateValue(value: unknown) {\n      if (this.fallbackActive) {\n        this.$emit('update:modelValue', value);\n      }\n    },\n    getAdjustedCkeditorData(): string {\n      const textAreaElement = this.$refs.studip_wysiwyg as HTMLTextAreaElement;\n      let ckeditor = window.STUDIP.wysiwyg.getEditor(textAreaElement)!;\n      let data = ckeditor.getData();\n      if (this.removeWrappingPTag) {\n        // Remove the <p> tag wrapping the editor's contents.\n        // These tags are inserted automatically by CKEditor5.\n        // It appears to be a WONTFIX on their end.\n        // See https://github.com/ckeditor/ckeditor5/issues/1537\n        data = data.replace(/<p>(.*?)/, '$1').replace(/(.*?)<\\/p>/, '$1');\n      }\n      if (this.insertHtmlComment) {\n        /**\n         Insert <!--HTML--> at the start of the text so it is recognized by studip as a\n         raw HTML that should be inserted as-is into a PHP page when formatted\n         using htmlReady.\n         */\n        if (!window.STUDIP.wysiwyg.hasHtmlMarker(data)) {\n          data = window.STUDIP.wysiwyg.markAsHtml(data);\n        }\n      }\n      return data;\n    },\n  },\n});\n</script>\n\n<style></style>\n","import { render } from \"./StudipWysiwyg.vue?vue&type=template&id=9c7ca282&ts=true\"\nimport script from \"./StudipWysiwyg.vue?vue&type=script&lang=ts\"\nexport * from \"./StudipWysiwyg.vue?vue&type=script&lang=ts\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["taskEditorStateSymbol","Symbol","disableDrag","mounted","el","setAttribute","setDraggableFalse","element","childNodes","forEach","child","HTMLElement","modelUndoable","binding","vnode","prevVnode","validEl","validateElement","setElValueFromStore","splitPath","parsePath","storeValue","getValueAtPath","taskEditorStore","validatedStoreValue","validateBoundValue","value","toString","join","addEventListener","ev","firstPathEl","restOfPath","newState","JSON","parse","stringify","taskDefinition","setValueAtPath","performEdit","newTaskDefinition","undoBatch","console","log","store","watch","Error","bindingMustBeStringError","split","bindingMustUseTaskDefinitionError","HTMLInputElement","HTMLTextAreaElement","HTMLSelectElement","invalidElementTypeError","val","boundValueMustBePrimitiveError","o","path","reduce","accumulator","pathComponent","Object","prototype","hasOwnProperty","call","invalidPathError","lastPathComponent","pop","undefined","targetObject","formatInvalidTaskDefinitionErrorMessage","e","task_json","$gettext","selectedLanguage","values","window","STUDIP","INSTALLED_LANGUAGES","find","lang","selected","gettextPlugin","createGettext","availableLanguages","en","de","defaultLanguage","translations","memoize","args","$pgettext","$ngettext","$npgettext","$gettextInterpolate","interpolate","Direction","z","enum","wordSchema","object","uuid","string","hint","solution","x","number","y","direction","crosswordTaskSchema","task_type","literal","words","array","colorEmptyCells","boolean","strings","checkButton","retryButton","solutionsButton","resultMessage","_createElementBlock","role","class","_normalizeClass","_ctx","isActive","buttonSelector","_renderSlot","$slots","defineComponent","inject","props","title","type","String","required","icon","default","data","hash","created","this","toLowerCase","replace","addTab","activeTabHash","computed","__exports__","render","_hoisted_1","_createElementVNode","_hoisted_2","_Fragment","_renderList","tabs","tab","key","onClick","$event","name","id","tabindex","_hoisted_3","provide","count","push","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","style","flexBasis","flexGrow","flexShrink","_defineComponent","setup","__props","taskEditor","debug","draggable","LernmoduleVueJS","LERNMODULE_DEBUG","selectedWord","ref","modelTaskDefinition","cloneDeep","wordList","get","set","newValue","updateTaskDefinition","deleteWord","produce","draft","index","findIndex","word","splice","addWord","newWord","v4","onClickWord","onInputHint","onInputSolution","onInputXCoordinate","onInputYCoordinate","onChangeDirection","event","selectedDirection","target","Enum","across","down","oldTaskDefinition","deep","_cache","_openBlock","onSubmit","_withModifiers","_toDisplayString","_unref","_createVNode","TabsComponent","_withCtx","TabComponent","modelValue","_isRef","filter","preventOnFilter","item","_withDirectives","onInput","placeholder","_vModelText","_","_createTextVNode","onChange","_vModelSelect","min","max","step","_vModelCheckbox","_createBlock","_createCommentVNode","$props","$setup","$data","$options","_directive_disable_drag","_resolveDirective","starVisible","src","_imports_0","width","height","alt","textContent","feedbackMessage","achievedPoints","Number","maxPoints","feedback","adjustBarWidth","immediate","handler","achievedMaxPoints","setTimeout","methods","nextTick","meterBar","$refs","offsetHeight","percentageCorrect","urlForIcon","iconName","ASSETS_URL","feedbackSortedByScore","map","sort","a","b","percentage","round","message","task","canvasWrapperRef","canvasRef","selectedCell","solutionGrid","userInputGrid","taskSubmitted","showSolutions","placedWords","canvasSize","onMounted","initializeGrids","updateCanvasSize","drawGrid","onBeforeUnmount","removeEventListener","gridSize","size","length","cellSize","Math","floor","fontSize","maxScore","score","result","showCheckButton","wrapper","clientWidth","clientHeight","onClickCheck","onClickRetry","onClickShowSolutions","Array","from","createWordPath","cell","letter","directionalDeltas","dx","dy","i","toUpperCase","canvas","error","ctx","getContext","clearRect","fillCell","strokeStyle","strokeRect","fillStyle","fillRect","font","textAlign","textBaseline","fillText","onPointerDownCanvas","cellCoordinates","getCellCoordinatesUnderCursor","selectableWords","some","onKeyDownCanvas","match","indexOfCellInWord","currentWordIndex","includes","preventDefault","wordAbove","wordBelow","wordToTheLeft","wordToTheRight","shiftKey","onClickHint","focus","rect","getBoundingClientRect","clientX","left","clientY","top","cellX","cellY","ref_key","_normalizeStyle","onPointerdown","onKeydown","FeedbackElement","_hoisted_13","_component_studip_wysiwyg","_resolveComponent","_component_feedback_editor","addBlank","instructions","template","onEditTemplate","distratorInstructions","distractors","instantFeedback","alphabeticOrder","retryAllowed","showSolutionsAllowed","updateShowSolutionsAllowed","allBlanksMustBeFilledForSolutions","disabled","fillInAllBlanksMessage","updateFeedback","updateResultMessage","for","localResultMessage","emitUpdatedResultMessage","feedbackList","emitUpdatedFeedback","titleForDeleteButtonForFeedback","removeFeedback","addFeedback","emits","feedbacks","newFeedback","feedbackToRemove","$emit","components","StudipWysiwyg","FeedbackEditor","wysiwygEl","wysiwyg","$el","editor","getEditor","selection","model","document","start","getFirstPosition","end","getLastPosition","change","writer","insertText","updatedFeedback","taskDraft","updatedResultMessage","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","_component_FeedbackElement","parsedTemplate","innerHTML","text","userInputs","classForFilledBlank","getAnswerById","editable","onDragstart","startDragUsedAnswer","onDrop","onDropBlank","onDragover","onClickFilledBlank","onDragenter","onDragEnter","onDragleave","onDragLeave","onClickBlank","submittedAnswerIsCorrect","showFillInAllTheBlanksMessage","fillInAllTheBlanksMessage","showResults","correctAnswers","onClickCheckButton","showSolutionsButton","onClickSolutionsButton","showRetryButton","onClickRetryButton","onDropUnusedAnswers","unusedAnswers","answer","clickedAnswerId","startDragUnusedAnswer","onClickUnusedAnswer","submittedAnswers","userWantsToSeeSolutions","draggedAnswerId","draggedSourceId","blank","submittedAnswerId","submittedAnswer","isAnswerCorrect","userAnswer","updateAttempt","points","blanks","success","getElement","elementId","dragEvent","answerId","dataTransfer","dropEffect","effectAllowed","property","draggedAnswer","previousBlank","backgroundColor","answers","removePTags","splitTemplate","cleanTemplate","uuidv4","splitString","parsedDistractors","distractor","trim","distractorAnswers","randomizedAnswers","random","sortedAnswers","localeCompare","blanksFilled","keys","allBlanksAreFilled","allAnswersAreCorrect","every","inputHasChanged","isEqual","caseSensitive","acceptTypos","autoCorrect","readonly","autocorrect","classForInput","onBlur","onKeyup","_withKeys","onEnter","ref_for","solutions","showExtraButtons","showSolutionButton","onClickShowSolution","onClickTryAgain","dljs","require","isAnswerCorrectWithTypo","distance","autoGrowTextField","input","computedStyles","getComputedStyle","computedFontSize","getPropertyValue","computedFontFamily","computedPadding","parseInt","minEm","minPx","rightPadEm","rightPadPx","static_min_pad","tmp","createElement","tmpStyles","position","padding","entries","parentElement","append","parentWidth","wrapperElement","remove","taskEditableAfterCheck","resetTask","resetBlankWidths","handleFilledBlank","focusNextBlank","currentIndex","indexOf","nextInput","uploadRequestPromise","accept","onInputChange","errors","selectedFolderId","uploadFolderName","folders","getFolders","userId","lernmoduleUploads","f","attributes","rootFolder","errorMessage","newFolder","createFolder","parentFolderId","folderType","mapGetters","relatedFolders","USER_ID","userObject","loadedUserFolders","userFolders","parent","relationship","folder","mapActions","_loadRelatedFolders","loadRelatedFolders","params","getUserFolders","options","warn","fileInput","file","files","createFile","fileData","then","fileRef","catch","findTheHotspotsEditorStateSymbol","_withScopeId","n","_pushScopeId","_popScopeId","_component_LazyImage","hotspots","hotspot","selectedHotspotId","uid","getHotspotStyle","onClickHotspot","onPointerdownHotspot","onPointermove","onPointermoveHotspot","onPointerup","onPointerupHotspot","resizeHandles","handle","onPointerdownResizeHandle","onPointermoveResizeHandle","onPointerupResizeHandle","fileIdToUrl","image","file_id","altText","onClickBackground","selectedHotspot","dragState","viewer","hidden","checked","correct","changeHotspotCorrectness","deleteSelectedHotspot","setHotspotFeedback","isLoaded","_mergeProps","onLoad","onError","$attrs","enqueueImageLoad","requestQueueStore","enqueue","async","img","Image","Promise","resolve","reject","onload","onerror","useLazyLoading","LERNMODULE_LAZYLOADING","halfViewportHeight","innerHeight","observer","IntersectionObserver","entry","isIntersecting","unobserve","disconnect","rootMargin","threshold","observe","findTheHotspotsViewerStateSymbol","LazyImage","popperInstance","h","destroy","$nextTick","hotspotElement","getElementById","tooltipElement","selectedHotspotTooltip","createPopper","placement","modifiers","offset","selectHotspot","wrapperRect","clickX","clickY","clickBackground","clickHotspot","hotspotId","dragId","pointerStartPos","hotspotStartPos","setPointerCapture","pointerId","releasePointerCapture","rootRect","root","hotspotEl","currentTarget","clientDx","dxFraction","xFraction","hotspotWidth","minX","maxX","clampedXFraction","clientDy","dyFraction","yFraction","hotspotHeight","minY","maxY","clampedYFraction","dragHotspot","update","hotspotStartSize","xInitial","yInitial","widthInitial","heightInitial","newX","newWidth","newY","newHeight","dxPointerPixels","dxPointer","dyPointerPixels","dyPointer","filteredHeight","filteredWidth","filteredX","filteredY","newHeightPixels","newWidthPixels","minPixelDimension","isOffscreenX","isOffscreenY","resizeHotspot","borderRadius","viewBox","xmlns","fill","stroke","rx","cx","cy","r","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","_hoisted_22","limitHotspotsToFind","hotspotsToFind","limitClicks","allowedClicks","imageWithHotspotsRef","numberOfCorrectHotspots","numberOfHotspotsToFind","numberOfClicksAllowed","updateAllowedClicksInTaskDefinition","updateHotspotsToFindInTaskDefinition","onImageUploaded","addRectangularHotspot","imgEl","querySelector","imageWidthPixels","imageHeightPixels","hotspotWidthPercent","hotspotHeightPercent","smallestDim","hotspotHeightPixels","hotspotWidthPixels","newHotspot","addEllipseHotspot","removeAllHotspots","deleteImage","deleteHotspot","ImageWithHotspots","FileUpload","onFileUploaded","feedbackWhenClickingBackground","feedbackWhenClickingHotspotAgain","resetViewerState","clickHistory","clicks","clickedHotspots","at","click","pulse","incorrect","wordsInputMessage","userInput","lastValidInput","numbersInputMessage","clearMessages","onInputWords","wordArray","longestWord","tooLongWord","tooManyWords","onInputSize","num","characters","onInputAlphabet","alphabet","resetAlphabet","resetAlphabetToUsedLetters","Set","showWordList","directions","w","s","ne","se","nw","sw","wordListTitle","timer","WordSearch","grid","selectedCells","correctCells","solutionCoordinates","foundWords","timerStarted","timerInterval","initializeGrid","onPointerdownOutsideCanvas","onPointerupOutsideCanvas","disabledDirections","char","taskCompleted","startTimer","setInterval","stopTimer","clearInterval","randomLetter","randomIndex","resetSelectedCells","resetCorrectCells","cols","rows","dictionary","maxWords","backwardsProbability","upperCase","diacritics","ws","coord","onPointerdownCanvas","endSelection","getCellUnderCursor","startCell","currentCell","onPointermoveCanvas","getDirection","xCoordinate","yCoordinate","coordinatesAreValid","onPointerupCanvas","getSelectedWord","reversedSelectedWord","reverse","isWordFound","markSelectedWordCorrect","isNewWord","endCell","xCell","yCell","startX","startY","padStart","_component_SelectVideo","_component_TabComponent","_component_AddInteractions","_component_ConfigureTravisGo","_component_TabsComponent","settings","travisGoSettings","onUpdate","updateTravisGoSettings","_component_LmbTaskInteraction","_component_OverlayInteraction","errorLoadingVideo","selectedInteractionId","selectInteraction","interactions","interaction","progressBarInteractionMarkerStyle","onClickInteractionMarker","printInteractionType","interactionForPopper","selectedInteraction","activateInteraction","editInteraction","deleteInteraction","visibleInteractions","onPointerDownInteraction","onPointerMoveInteraction","onPointerUpInteraction","onActivateInteraction","onPointerDownResizeHandle","onPointerMoveResizeHandle","onPointerUpResizeHandle","_Transition","activeInteraction","closeInteraction","printTaskType","_resolveDynamicComponent","viewerForTaskType","overlaySchema_v1","startTime","endTime","pauseWhenVisible","optional","overlaySchema_v2","omit","extend","v","content_wysiwyg","overlaySchema","union","transform","hasOwn","val_v1","val_v1_rest","val_v2","lmbTaskInteractionSchema","lazy","taskDefinitionSchemaMinusInteractiveVideo","interactiveVideoInteractionSchema","refine","noVideoSchema","youtubeVideoSchema","url","studipFileVideoSchema_v1","wysiwygUploadedFileSchema","studipFileVideoSchema_v2","studipFileVideoSchema","urlParams","URLSearchParams","videoSchema","travisGoSettingsSchema","enabled","projectTitle","projectDescription","interactiveVideoTaskSchema","video","autoplay","startAt","disableNavigation","iconForInteraction","iconForTaskType","permissionsSchema","mayEdit","mayDelete","travisGoPostTypeSchema","travisGoPostEditableKeys","video_id","video_type","start_time","coerce","end_time","nullable","contents","post_type","travisGoPostSchema","mk_user_id","mkdate","datetime","chdate","meta","permissions","travisGoCommentEditableKeys","post_id","travisGoCommentSchema","interactiveVideoEditorStateSymbol","OverlayInteraction","LmbTaskInteraction","timeupdate","time","metadataChange","payload","player","playedTime","isPlaying","progressBarParameters","widthPixels","xOffsetPixels","progressBarObserver","videoInfoPromise","fileRefById","timeAndVisibleInteractions","loadVideoInfo","videoInfo","initializePlayer","newTime","newVisibleInteractions","oldTime","oldVisibleInteractions","isPlayingForward","newlyVisibleInteractionWithPause","pause","interactionElement","selectedInteractionTooltip","loadFileRef","onPlayerReady","fileRefsSchema","mime_type","download_url","videoUrl","videoType","videoJsContainer","dispose","playerElement","classList","add","appendChild","videojs","techOrder","sources","controls","controlBar","children","volumePanel","inline","muted","on","currentTime","paused","play","duration","enforceDisabledNavigation","abs","progressBarEls","getElementsByClassName","progressHolder","ResizeObserver","rootLeft","progressHolderLeft","interactionId","mouseStartPos","interactionStartPos","interactionStartSize","xPointer","resizeOverlay","interactionEl","interactionWidth","interactionHeight","dragInteraction","progressPercentage","timeOffsetPx","focusInteraction","focusVisible","one","delta","difference","beforeUnmount","onDragoverCapture","onDragOverTimeline","onPointerDownAxis","axisScale","point","formatVideoTimestamp","major","interactionMarkerStyle","onClickInteraction","onWheel","onContextmenu","timelineInteractionStyle","viewportEnd","onPointerDownInteractionStart","onPointerMoveInteractionStart","onPointerUpInteractionStart","onPointerDownInteractionEnd","onPointerMoveInteractionEnd","onPointerUpInteractionEnd","onDragStartTimeMarker","positionForTimeMarker","zoomTransform","viewportWidthEm","viewportWidthSeconds","viewportStart","getEmValueFromElement","pixelValue","parentNode","parentFontSize","parseFloat","elementFontSize","pixelValueOfOneEm","timestampSeconds","showCentiseconds","separator","hours","minutes","seconds","centiseconds","twoDigits","toLocaleString","minimumIntegerDigits","maximumFractionDigits","short","long","concat","videoMetadata","t","k","recomputeViewportWidth","timelineAxis","dragTimeline","dSeconds","pixelsToSeconds","translate","constrainZoomTranslate","dragBehavior","drag","button","select","timeline","isWithinViewport","isBeingDragged","secondsPerEm","secondsToTimelinePercentage","scale","deltaT","zoom","viewportStart0","viewportWidth0","exp","newK","viewportWidth1","viewportStart1","xCoordinateToTime","deltaY","pixelsToEm","pixels","NaN","axis","widthInEm","fraction","clampedTime","startDeltaT","startPercent","endDeltaT","endPercent","interactionLength","interactionStartTime","interactionDuration","mouseDx","secondsPerPixel","maxTime","secondsClamped","dragInteractionTimeline","movementX","timeClamped","resizeInteractionTimeline","emitTimelineSeekThrottled","throttle","_component_VideoTimeInput","_component_StudipWysiwyg","inputStartTime","inputStartTimeFormatError","invalid","inputStartTimeErrors","inputEndTime","inputEndTimeFormatError","inputEndTimeErrors","_KeepAlive","editorForTaskType","showViewerAboveEditor","onBlurUserInput","formatSeconds","parsedUserInput","timeRegexCentiseconds","centisecondsMatch","exec","timeRegexHhMmSs","hhMmSsMatch","VideoTimeInput","forbiddenToNestInteractiveVideos","notAnOverlayError","interactionNotFoundError","postCouldNotBeParsedError","couldNotLoadPostsError","couldNotSendPostError","videoPlayer","videoTimeline","selectedInteractionProperties","taskTypes","performEditForEditedLmbInteraction","newDefinition","videoTask","interactionIndex","selectionId","scrollIntoView","behavior","block","onVideoMetadataChange","onTimeUpdate","onTimelineSeek","onClickZoomIn","onClickZoomOut","onClickPlay","onClickPause","insertOverlay","insertLmbTaskInteraction","newTask","prompt","confirmed","confirm","info","VideoPlayer","onTimeupdate","onMetadataChange","interactionType","taskType","VideoTimeline","onDeleteInteraction","SelectedInteractionProperties","_component_FileUpload","_component_FilePicker","_component_VideoPlayer","onUploadStudipVideo","selectedFileId","onSelectFile","updateCurrentFile","onSaveUploadedFile","youtubeUrlInput","onSaveYoutubeVideo","href","fileDetailsUrl","selectedFile","deleteVideo","startPositionInputError","onClickUseCurrentTime","_component_FolderPicker","_component_translate","allowUserFolders","unchoose","currentValue","selectFile","_vShow","canBeEmpty","changeSelection","context","label","textOptGroupCourse","loadedCourseFolders","textOptGroupUser","filterCourseFolders","allowHomeworkFolders","validatedParents","Map","validateParentFolder","isValid","relationships","parentId","has","hiddenParentFolderValidation","parentFolder","Boolean","coursewareBlockStore","studipContext","courseObject","getCourseFolders","confirmSelectedFolder","FolderPicker","mimeType","isImage","isVideo","isAudio","isDocument","relatedFileRefs","relatedTermOfUse","loadRelatedFileRefs","filterFiles","loadArray","filterFile","fileTermsOfUse","videoConditions","condition","audioConditions","officeConditions","URLHelper","getURL","file_name","getFolderFiles","include","fileRefs","oldValue","FilePicker","emit","modelSettings","updateSettings","ConfigureTravisGo","SelectVideo","AddInteractions","shouldCollapse","tooltip","navigationItems","_component_studip_icon","shape","_toHandlers","linkEvents","IconLoader","constructor","baseUrl","useCache","_classPrivateMethodInitSpec","_IconLoader_brand","_classPrivateFieldInitSpec","_cacheKey","_baseUrl","_useCache","_promises","_classPrivateFieldSet","_assertClassBrand","_initialState","load","_classPrivateFieldGet","containsUrl","test","promise","response","fetch","ok","status","statusText","isSvg","headers","content","svg","blob","reader","FileReader","readAsDataURL","delete","_getStorage","setItem","sessionStorage","localStorage","cached","getItem","defaultLoader","ariaRole","attrs","useAttrs","iconAttrs","cssClass","computedStyle","allAttrs","shapeName","iconLoader","IconContent","baseAttrs","_normalizeProps","_guardReactiveProps","StudipIcon","items","collapseAt","open","events","apply","emitArguments","close","ActionMenu","closeAll","post","comments","clickTimestamp","startEditingPost","deletePost","postId","deleteComment","clickPostAuthorName","clickCommentAuthorName","comment","contentsPurified","DOMPurify","sanitize","USE_PROFILES","html","userById","getters","postAuthor","postAuthorFormattedName","userUrl","user","username","postAuthorUrl","commentAuthorName","commentEditorInput","commentEditorInputElement","isCommenting","startCommentingPost","inputEl","collapsedParents","querySelectorAll","contains","submitComment","createComment","Report","dispatch","editedCommentId","isEditingComment","startEditingComment","cancelEditingComment","submitEditedComment","updateComment","postActionMenuItems","deletePostAction","action_id","startEditingPostAction","commentActionMenuItems","deleteAction","startEditingAction","onClickTimestamp","StudipActionMenu","onDeletePost","onStartEditingPost","onStartCommentingPost","numberOfComments","onDeleteComment","onStartEditingComment","onClickPostTimestamp","seekVideo","searchUserComments","getUserById","searchInput","searchPostAuthor","searchCommentAuthor","editedPostId","postWysiwygInput","startTimeInput","endTimeInput","postTypeInput","postWysiwygInputElement","editing","view","setSelection","createPositionAt","getRoot","resetPostEditor","onClickStartTime","clearStartTime","onClickEndTime","clearEndTime","loadCurrentUser","loadPostsError","loadPosts","taskSaveLocation","rawPosts","postParseResults","successes","rawVal","parsed","safeParse","parsedPosts","erroredPosts","filteredAndSortedPosts","postMatchesSearch","toSorted","query","author","texts","canonicalQuery","canonicalize","commentsForPost","commentMatchesSearch","str","replaceAll","parsedComments","flatMap","record","parsedComment","erroredComments","participantsIds","postUserIds","commentUserIds","urlForUserId","createPostError","cancelSearch","createPost","updatePost","submitNewPost","res","submitEditedPost","insertHtmlComment","ErrorMessage","TravisGoPostComponent","onClickPostAuthorName","onClickCommentAuthorName","odd","addSolution","_component_feedback_element","isMarked","onWordKeydown","onWordKeyup","classForWord","markedWords","clear","code","sanitizeText","splitBySolutions","finalSplit","part","templateElement","_component_MemoryEditorCard","cards","card","selectedCardIndex","selectCard","listEntryText","deleteCard","addCard","updateCard","squareLayout","flipside","deleteFlipsideImage","onFlipsideImageUploaded","_component_MultimediaElement","second","first","onClickDeleteImage","onInputAltText","onUploadImage","addSecondImage","MultimediaElement","MemoryEditorCard","beforeMount","updatedCard","_component_MemoryViewerCard","gridTemplateColumns","gridTemplateRows","onClickCard","isPlayable","amountOfFlips","amountOfPairsSolved","totalAmountOfPairs","_component_lazy_image","flipped","solved","MemoryViewerCard","firstFlippedCardId","firstFlippedCardMatchingCardId","matchingCardId","firstCard","getCardById","resetAllUnsolvedCardsExcept","exceptionId","resetCards","shuffleCards","card1","card2","cardId","createCard","amountOfCardsSolved","gameIsOver","columns","ceil","sqrt","secondCard","original","duplicate","_component_PairingEditorPair","_component_PairingEditorCard","_component_FeedbackEditor","pairs","pair","selectedPairIndex","onClickPair","onClickAddPair","addPairButtonBackgroundImage","selectedPair","draggableElement","onElementChanged","onChangeDraggableElement","targetElement","onChangeTargetElement","onClickDeletePair","multimediaElement","onClickRemoveImage","onInputContent","elementChanged","createNewLernmoduleMultimediaElement","onChangeType","selectedType","updatedElement","newAltText","field","newContent","PairingEditorPair","PairingEditorCard","backgroundImage","_component_PairingViewerTargetElement","onDropOnInteractiveElements","draggableElements","draggableElementId","isDraggableElementUsed","startDragElement","onDragend","endDragElement","onClickDraggableElement","draggedElementId","immovable","elementIdInteractedWith","outlined","elementsDraggedOntoTargets","getElementDraggedOntoTarget","isCorrect","showResult","onDropOnTargetElement","startDragTargetElement","endDragTargetElement","onClickTargetElement","draggableImage","targetImage","PairingViewerTargetElement","originalScore","targetId","targetElementId","setData","userDraggedElementId","otherTargetId","getData","elementsById","usedElementId","pair1","pair2","question","onEditQuestion","removeAnswer","onInputAnswerCorrect","feedbackSelected","feedbackNotSelected","addAnswer","canAnswerMultiple","randomOrder","answerIndex","answerToRemoveIndex","classForAnswer","selectedAnswers","isSubmitted","selectedAnswer","_vModelRadio","onClickShowSolutionsButton","answer1","answer2","reachedMaxPoints","_component_SequencingEditorCard","resumeAllowed","resumeButton","cardIndex","SequencingEditorCard","tabIndex","getAriaLabel","dragged","cardInteractedWith","isShowingResults","isCardInCorrectPosition","startDragCard","onDrag","endDragCard","onDragOver","isShowingSolutions","showResumeButton","onClickResumeButton","screenReaderAnnouncement","fromIndex","toIndex","moveInArray","currentlySelectedIndex","previouslySelectedIndex","moveFocus","buttonRef","cardToCheck","noImageSchema","imageFileSchema","imageSchema","feedbackSchema","rectangleHotspotSchema","ellipseHotspotSchema","hotspotSchema","findTheHotspotsTaskSchema","fileId","audioElementSchema","textElementSchema","multimediaElementSchema","dragTheWordsTaskSchema","findTheWordsTaskSchema","fillInTheBlanksTaskSchema","markTheWordsTaskSchema","defaultFeedback","memoryCardSchema","memoryTaskSchema","pairSchema","pairingTaskSchema","questionAnswerSchema","questionTaskSchema","sequencingTaskSchema","taskDefinitionSchema","discriminatedUnion","taskTypeSchema","CrosswordViewer","DragTheWordsViewer","InteractiveVideoViewer","FillInTheBlanksViewer","FindTheHotspotsViewer","FindTheWordsViewer","MarkTheWordsViewer","MemoryViewer","PairingViewer","QuestionViewer","SequencingViewer","CrosswordEditor","DragTheWordsEditor","InteractiveVideoEditor","FillInTheBlanksEditor","FindTheHotspotsEditor","FindTheWordsEditor","MarkTheWordsEditor","MemoryEditor","PairingEditor","QuestionEditor","SequencingEditor","httpClient","axios","create","baseURL","termId","formData","FormData","request","location","description","downloads","filesize","links","self","unknown","saveTask","moduleName","infoText","module_id","block_id","saveRoute","token","CSRF_TOKEN","parsedTaskDefinition","method","body","json","updateAttemptRoute","sleep","ms","setAutoFreeze","TaskEditorModule","VuexModule","_defineProperty","undoRedoStack","undoRedoIndex","hasUnsavedChanges","serverTaskDefinition","serverModuleName","serverInfotext","infotext","canUndo","canRedo","undo","currentState","inputElements","redo","nextState","initializeCourseware","initializeMessage","initializeNonCourseware","module","customdata","isArray","cause","startedSaving","saveStatus","saveSuccess","saveFailure","nonFatalErrors","commit","saveResult","currentUndoRedoState","shouldMergeEdits","slice","setModuleName","setInfoText","__decorate","Mutation","Action","Module","CoursewareBlockModule","setShowEditorUI","state","showEditorUI","saveBlock","postMessage","cancelEditing","setContext","RequestQueueModule","addToQueue","queue","incrementActive","active","decrementActive","processQueue","maxConcurrent","shift","delay","filterQueryString","obj","encodeURIComponent","getOptionsQuery","optionsObject","relatedResourceUrl","builtUrl","related","extractData","extractErrorResponse","Resource","api","all","where","queryString","partialRecord","assign","requestData","createRelated","updateRelationships","records","patch","createRelationships","removeRelationships","STATUS_INITIAL","STATUS_LOADING","STATUS_ERROR","STATUS_SUCCESS","storeRecord","newRecord","existingRecord","getResourceIdentifier","resource","getRelationshipType","storeIncluded","included","relatedRecord","action","allRecords","primaryRecord","relationshipName","relatedIds","matches","criteria","handleError","errorResponse","initialState","filtered","page","lastCreated","lastMeta","resourceModule","resourceName","client","ResourceClient","getRelationshipIndex","parentResourceIdentifier","namespaced","mutations","REPLACE_ALL_RECORDS","REPLACE_ALL_RELATED","SET_STATUS","STORE_RECORD","STORE_RECORDS","newRecords","STORE_PAGE","STORE_META","STORE_ERROR","STORE_RELATED","resetRelated","relationshipIndex","ids","STORE_FILTERED","matchedIds","STORE_LAST_CREATED","REMOVE_RECORD","SET_LINKS","RESET_STATE","actions","loadAll","loadById","results","loadWhere","loadPage","loadNextPage","next","loadPreviousPage","prev","loadRelated","paramsToStore","relatedRecords","recordData","oldRecord","byId","entity","relationshipObject","isNonEmptyArray","isObject","storeRelated","removeRecord","resetState","addRelated","relatedItems","setRelated","removeRelated","removeAllRelated","isLoading","isError","hasPrevious","hasNext","mapResourceModules","names","acc","createStore","modules","coursewareBlock","requestQueue","getModule","updateValue","forceSoftBreaks","removeWrappingPTag","disableAutoformat","fallbackActive","ckeInit","initCKE","textAreaElement","studip_wysiwyg","ckeditor","currentData","getAdjustedCkeditorData","evt","execute","stop","priority","autoformat","plugins","isEnabled","hasHtmlMarker","markAsHtml"],"sourceRoot":""}