(self["webpackChunkvue101"]=self["webpackChunkvue101"]||[]).push([[996],{3139:function(e,t,n){"use strict";n.d(t,{c:function(){return i}});const i=Symbol("Task editor injected dependencies")},7778:function(e,t,n){"use strict";n.d(t,{N:function(){return i}});const i={mounted(e){e.setAttribute("draggable","false");const t=e=>{e.setAttribute("draggable","false"),e.childNodes.forEach((e=>{e instanceof HTMLElement&&t(e)}))};t(e)}}},9539:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var i=n(2859);const o={mounted(e,t,n,o){const u=a(e);function c(){const e=s(t),n=r(i.SL,e),o=l(n);u.value=o.toString()}u.setAttribute("data-undo-focus-id",s(t).join(".")),e.addEventListener("input",(a=>{const l=s(t),[r,...u]=l,c=n.el.value,p=JSON.parse(JSON.stringify(i.SL.taskDefinition));d(p,u,c),i.SL.performEdit({newTaskDefinition:p,undoBatch:l.join(".")}),console.log(e,t,n,o,a,l,c)})),i.M_.watch((()=>{const e=s(t);return r(i.SL,e)}),(()=>c())),c()}};function s(e){if("string"!==typeof e.value)throw new Error(u+e.value);const t=e.value.split("."),n=t[0];if("taskDefinition"!==n)throw new Error(c+e.value);return t}function a(e){if(e instanceof HTMLInputElement||e instanceof HTMLTextAreaElement||e instanceof HTMLSelectElement)return e;throw new Error(m)}function l(e){if("string"!==typeof e&&"number"!==typeof e&&"boolean"!==typeof e)throw new Error(p+typeof e);return e}function r(e,t){return t.reduce(((e,n)=>{if(!Object.prototype.hasOwnProperty.call(e,n))throw new Error(h+t.join("."));return e[n]}),e)}function d(e,t,n){const[i,...o]=[t.pop(),...t];if(void 0===i)throw new Error("Path has no last element");const s=o.reduce(((e,t)=>e[t]),e);s[i]=n}const u="The value supplied to v-model-undoable must be a string. Example: <select v-model-undoable=\"'taskDefinition.task_type'\">\nYou supplied the following value: ",c='The string supplied to v-model-undoable must be a path which begins with "taskDefinition", and the path must be wrapped in two sets of quotes. \nExample usage: <select v-model-undoable="\'taskDefinition.task_type\'">\nYou supplied the following string: ',p="The value bound with v-model-undoable must be a string, number or boolean.  Other datatypes are not currently supported.  The value found is of type ",h="No field was found in the store under the given path.  Did you make a typo?  Path: ",m="v-model-undoable can only be used on <input>, <textarea> and <select> elements"},7576:function(e,t,n){"use strict";n.d(t,{w:function(){return o}});var i=n(4638);function o(e,t){return(0,i.o_)("Diese Aufgabe konnte nicht geladen werden. Beim Einlesen von task_json ist ein Fehler aufgetreten. Fehler: ")+"\n"+e+"\ntask_json: "+JSON.stringify(t,null,2)}},4638:function(e,t,n){"use strict";n.d(t,{o_:function(){return r},jb:function(){return c},qz:function(){return u},Il:function(){return d},TA:function(){return l}});var i=n(6366),o=JSON.parse('{"en":{"%{ amountOfPairsSolved } von %{ totalAmountOfPairs }":"%{ amountOfPairsSolved } of %{ totalAmountOfPairs }","%{ interaction } löschen":"Delete %{ interaction }","%{ interactionType } einfügen":"Insert %{ interactionType }","%{ time } Sekunden":"%{ time } Seconds","1. Video auswählen":"1. Select video","2. Interaktionen hinzufügen":"2. Add interactions","Abbrechen":"Cancel","Abspielen":"Play","Aktuelle Position setzen":"Set to current position","Alle Lücken müssen ausgefüllt sein, um Lösungen anzuzeigen":"All of the blanks must be filled in order to show the solutions","Anfangen um":"Start at","Antworten alphabetisch sortieren":"Sort answers alphabetically","Aufgabenbeschreibung":"Task description","Aufgabentyp auswählen:":"Select task type:","Aufgedeckte Paare:":"Pairs revealed:","Automatisch abspielen":"Auto-play","Bearbeiten":"Edit","Beim Speichern ist ein Fehler aufgetreten.":"An error occurred while saving.","Benutzerdefiniertes Feedback für beliebige Punktebereiche:":"User-defined feedback for arbitrary point ranges:","Bild":"Image","Bild Löschen":"Delete image","Das eingegebene Wert muss größer als 0 sein.":"The value entered must be greater than 0.","Datei":"File","Datei wird hochgeladen":"File is being uploaded","Dateibereich dieser Veranstaltung":"This course\'s file area","Der Startpunkt muss vor dem Endpunkt sein.":"The start point must be before the end point.","Die Startposition muss der Syntax HH;MM;SS oder HH;MM;SS;SS entsprechen.":"The start position must be entered using the syntax HH;MM;SS or HH;MM;SS;SS.","Drag the Words":"Drag the Words","Drag The Words":"Drag The Words","Einblendung":"Overlay","Einstellungen":"Settings","Ende":"End","Entferne den Feedback-Bereich, der ab %{ percentage }% anfängt.":"Remove the feedback range starting at %{ percentage }%.","Ergebnismitteilung (mögliche Variablen :correct und :total):":"Result message (possible variables :correct and :total):","Feedback":"Feedback","Fill in the Blanks":"Fill in the Blanks","Fill In The Blanks":"Fill In The Blanks","Find The Words":"Find The Words","Gespeichert":"Saved","Groß- und Kleinschreibung beachten":"Case sensitive","Grunddaten":"Basic data","Hinweis und Feedback":"Hint and feedback","Hochgeladenes Video: ":"Uploaded video: ","Interactive Video":"Interactive Video","Interaktion":"Interaction","Karte":"Card","Karte hinzufügen":"Add card","Karte löschen":"Delete card","Kein Ordner ist ausgewählt. Die Datei kann nicht hochgeladen werden.":"No folder is selected. The file can\'t be uploaded.","Lade ein Video hoch oder füge einen Link zu einem Youtube-Video ein.":"Upload a video or paste in a link to a Youtube video.","Löschen":"Delete","Lücke hinzufügen":"Add gap","Mark the Words":"Mark the Words","Mark The Words":"Mark The Words","Mehrere Versuche erlauben":"Allow multiple attempts","Memory":"Memory","Mitteilung":"Notification","Modifiziert":"Modified","Navigation deaktivieren":"Disable navigation","Neue Antwort":"New answer","Neuer Bereich":"New range","Neues Video hochladen":"Upload new video","Nicht deaktiviert":"Not deactivated","Ordner-Filter":"Folder filter","Paar":"Pair","Pairing":"Pairing","Pausieren":"Pause","Persönlicher Dateibereich":"Personal file area","Question":"Question","Richtiges Wort markieren":"Mark correct word","Schließen":"Close","Speichern":"Save","Start":"Start","Stud.IP-Video":"Stud.IP Video","Text":"Text","Titel":"Title","Typ":"Type","Übernehmen":"Apply","Vergrößern":"Zoom in","Verkleinern":"Zoom out","Video löschen":"Delete video","Video pausieren":"Pause video","Vorhandenes Video auswählen":"Use existing video","Vorschau":"Preview","Vorspulen deaktiviert":"Forwards navigation disabled","Vorspulen und Rückspulen deaktiviert":"Forwards and backwards navigation disabled","Wird gespeichert...":"Saving...","Wort hinzufügen":"Add word","Youtube-URL":"Youtube URL","Youtube-Video":"Youtube video","Youtube-Video: ":"Youtube video: ","Zu %{ interaction } springen":"Jump to %{ interaction }","Rückgängig":{"Im Sinne von undo/redo":"Undo"},"Wiederherstellen":{"Im Sinne von undo/redo":"Redo"}}}'),s=n(8626);const a=Object.values(window.STUDIP.INSTALLED_LANGUAGES).find((e=>e.selected)),l=(0,i.cj)({availableLanguages:{en:"English",de:"Deutsch"},defaultLanguage:a?.path??"de",translations:o}),r=(0,s.memoize)(l.$gettext,((...e)=>JSON.stringify(e))),d=(0,s.memoize)(l.$pgettext,((...e)=>JSON.stringify(e))),u=((0,s.memoize)(l.$npgettext,((...e)=>JSON.stringify(e))),(0,s.memoize)(l.$ngettext,((...e)=>JSON.stringify(e)))),c=(0,s.memoize)(l.interpolate,((...e)=>JSON.stringify(e)))},5019:function(e,t,n){"use strict";n.d(t,{WV:function(){return ih},GQ:function(){return Pp},Ql:function(){return Mp},u1:function(){return ah},eI:function(){return th},b1:function(){return oh},_N:function(){return sh},cW:function(){return qp},hw:function(){return Yp},Lu:function(){return Zp},hj:function(){return nh}});var i=n(794),o=n(6377),s=n(4638),a=n(6768),l=n(5130),r=n(4232),d=n(144),u=n(3139);const c=o.z.enum(["across","down"]),p=o.z.object({uuid:o.z.string(),hint:o.z.string(),solution:o.z.string(),x:o.z.number(),y:o.z.number(),direction:c}),h=o.z.object({task_type:o.z.literal("Crossword"),words:o.z.array(p),colorEmptyCells:o.z.boolean(),strings:o.z.object({checkButton:o.z.string(),retryButton:o.z.string(),solutionsButton:o.z.string(),resultMessage:o.z.string()})});var m=n(8626);const k=["aria-labelledby"];function g(e,t,n,i,o,s){return(0,a.bo)(((0,a.uX)(),(0,a.CE)("div",{role:"tabpanel",class:(0,r.C4)(["cw-tab cw-tabs-content",{"cw-tab-active":e.isActive}]),"aria-labelledby":e.buttonSelector},[(0,a.RG)(e.$slots,"default")],10,k)),[[l.aG,e.isActive]])}var f=(0,a.pM)({inject:["activeTabHash","addTab"],props:{title:{type:String,required:!0},icon:{type:String,required:!1,default:""}},data(){return{hash:"",isActive:!1}},created(){this.hash="#"+this.title.toLowerCase().replace(/ /g,"-"),this.addTab({title:this.title,hash:this.hash,icon:this.icon})},watch:{activeTabHash(){this.isActive=this.activeTabHash===this.hash}},computed:{buttonSelector(){return"#"+this.hash}}}),v=n(1241);const b=(0,v.A)(f,[["render",g]]);var w=b;const y={class:"tabs cw-tabs"},A={role:"tablist",class:"tab-buttons cw-tabs-nav"},T=["onClick","aria-selected","aria-controls","id"];function C(e,t,n,i,o,s){return(0,a.uX)(),(0,a.CE)("div",y,[(0,a.Lk)("div",A,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.tabs,(t=>((0,a.uX)(),(0,a.CE)("button",{key:t.title,onClick:n=>e.activeTabHash=t.hash,class:(0,r.C4)({"is-active":t.hash===e.activeTabHash,[`cw-tabs-nav-icon-text-${t.icon}`]:""!==t.icon&&""!==t.name,[`cw-tabs-nav-icon-solo-${t.icon}`]:""!==t.icon&&""===t.name}),"aria-selected":t.hash===e.activeTabHash,"aria-controls":t.hash,id:"#"+t.hash,tabindex:0},(0,r.v_)(t.title),11,T)))),128))]),(0,a.RG)(e.$slots,"default")])}var E=(0,a.pM)({data(){return{activeTabHash:"",tabs:[]}},provide(){return{addTab:e=>{const t=this.tabs.push(e);1===t&&(this.activeTabHash=e.hash)},activeTabHash:(0,a.EW)((()=>this.activeTabHash))}}});const D=(0,v.A)(E,[["render",C]]);var I=D,S=n(7256),x=n(1527),L=n.n(x);const B={class:"stud5p-task"},R={class:"word-list-and-word-details-container"},_={class:"word-list-container"},F=["onClick"],M=["onUpdate:modelValue","onInput","placeholder"],P=["onUpdate:modelValue","onInput","placeholder"],z=["onClick","title"],W={class:"word-details"},U={value:"across"},V={value:"down"},X={key:1},O={key:0,style:{flexBasis:"50%",flexGrow:0,flexShrink:0}};var Q=(0,a.pM)({props:{taskDefinition:{type:Object,required:!0}},setup(e){const t=e,n=(0,a.WQ)(u.c),o=(L(),window.STUDIP.LernmoduleVueJS.LERNMODULE_DEBUG),p=(0,d.KR)(),h=(0,d.KR)((0,m.cloneDeep)(t.taskDefinition)),k=(0,a.EW)({get(){return h.value.words},set(e){h.value.words=e,g()}});function g(e){console.log("update task definition"),n.performEdit({newTaskDefinition:(0,m.cloneDeep)(h.value),undoBatch:e??{}})}function f(e){h.value=(0,S.Ay)(h.value,(t=>{const n=t.words.findIndex((t=>t.uuid===e));if(-1===n)throw new Error("No word with id "+e+" found.");t.words.splice(n,1)})),g()}function v(){const e={uuid:(0,i.A)(),hint:"",solution:"",direction:"across",x:0,y:0};h.value=(0,S.Ay)(h.value,(t=>{t.words.push(e)})),g()}function b(e){p.value=h.value.words.find((t=>t.uuid===e))}function y(e,t){h.value=(0,S.Ay)(h.value,(n=>{const i=n.words.findIndex((t=>t.uuid===e));if(-1===i)throw new Error("No word with id "+e+" found.");n.words[i].hint=t})),g("hint")}function A(e,t){h.value=(0,S.Ay)(h.value,(n=>{const i=n.words.findIndex((t=>t.uuid===e));if(-1===i)throw new Error("No word with id "+e+" found.");n.words[i].solution=t})),g("solution")}function T(e,t){h.value=(0,S.Ay)(h.value,(n=>{const i=n.words.findIndex((t=>t.uuid===e));if(-1===i)throw new Error("No word with id "+e+" found.");n.words[i].x=t})),g("x-coordinate")}function C(e,t){h.value=(0,S.Ay)(h.value,(n=>{const i=n.words.findIndex((t=>t.uuid===e));if(-1===i)throw new Error("No word with id "+e+" found.");n.words[i].y=t})),g("y-coordinate")}function E(e,t){const n=t.target.value;console.log(n),h.value=(0,S.Ay)(h.value,(t=>{const i=t.words.findIndex((t=>t.uuid===e));if(-1===i)throw new Error("No word with id "+e+" found.");"across"===n?t.words[i].direction=c.Enum.across:"down"===n&&(t.words[i].direction=c.Enum.down)})),g("direction")}return(0,a.wB)((()=>t.taskDefinition),((e,t)=>{h.value=(0,m.cloneDeep)(e)}),{deep:!0}),(t,n)=>((0,a.uX)(),(0,a.CE)("div",B,[(0,a.Lk)("form",{class:"default",onSubmit:n[17]||(n[17]=(0,l.D$)((()=>{}),["prevent"]))},[(0,a.Lk)("fieldset",null,[(0,a.Lk)("legend",null,(0,r.v_)((0,d.R1)(s.o_)("Crossword")),1),(0,a.bF)(I,null,{default:(0,a.k6)((()=>[(0,a.bF)(w,{title:(0,d.R1)(s.o_)("Wörter eingeben"),icon:"content",class:"tab-component"},{default:(0,a.k6)((()=>[(0,a.Lk)("div",R,[(0,a.Lk)("div",_,[(0,a.bF)((0,d.R1)(L()),{modelValue:(0,d.R1)(k),"onUpdate:modelValue":n[0]||(n[0]=e=>(0,d.i9)(k)?k.value=e:null),"item-key":"uuid",class:"word-list",filter:"input,button",preventOnFilter:!1},{item:(0,a.k6)((({element:e})=>[(0,a.Lk)("div",{class:(0,r.C4)(["word",{"selected-word":p.value?.uuid===e.uuid}]),onClick:t=>b(e.uuid)},[(0,a.bo)((0,a.Lk)("input",{type:"text","onUpdate:modelValue":t=>e.hint=t,onInput:t=>y(e.uuid,e.hint),placeholder:(0,d.R1)(s.o_)("Hinweis")},null,40,M),[[l.Jo,e.hint]]),(0,a.bo)((0,a.Lk)("input",{type:"text","onUpdate:modelValue":t=>e.solution=t,onInput:t=>A(e.uuid,e.solution),placeholder:(0,d.R1)(s.o_)("Lösung")},null,40,P),[[l.Jo,e.solution]]),(0,a.Lk)("button",{type:"button",class:"small-button trash",onClick:t=>f(e.uuid),title:(0,d.R1)(s.o_)("Dieses Wort löschen")},null,8,z)],10,F)])),_:1},8,["modelValue"]),(0,a.Lk)("button",{type:"button",class:"button",onClick:v},(0,r.v_)((0,d.R1)(s.o_)("Neues Wort hinzufügen")),1)]),(0,a.Lk)("div",W,[(0,a.Lk)("fieldset",null,[(0,a.Lk)("legend",null,(0,r.v_)((0,d.R1)(s.o_)("Wort bearbeiten")),1),p.value?((0,a.uX)(),(0,a.CE)(a.FK,{key:0},[(0,a.Lk)("label",null,[(0,a.eW)((0,r.v_)((0,d.R1)(s.o_)("Richtung"))+" ",1),(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":n[1]||(n[1]=e=>p.value.direction=e),onChange:n[2]||(n[2]=e=>E(p.value.uuid,e))},[(0,a.Lk)("option",U,(0,r.v_)((0,d.R1)(s.o_)("Waagerecht")),1),(0,a.Lk)("option",V,(0,r.v_)((0,d.R1)(s.o_)("Senkrecht")),1)],544),[[l.u1,p.value.direction]])]),(0,a.Lk)("label",null,[(0,a.eW)((0,r.v_)((0,d.R1)(s.o_)("Spalte"))+" ",1),(0,a.bo)((0,a.Lk)("input",{type:"number","onUpdate:modelValue":n[3]||(n[3]=e=>p.value.x=e),min:"0",max:"100",step:"1",onInput:n[4]||(n[4]=e=>T(p.value.uuid,p.value.x)),placeholder:"x"},null,544),[[l.Jo,p.value.x,void 0,{number:!0}]])]),(0,a.Lk)("label",null,[(0,a.eW)((0,r.v_)((0,d.R1)(s.o_)("Reihe"))+" ",1),(0,a.bo)((0,a.Lk)("input",{type:"number","onUpdate:modelValue":n[5]||(n[5]=e=>p.value.y=e),min:"0",max:"100",step:"1",onInput:n[6]||(n[6]=e=>C(p.value.uuid,p.value.y)),placeholder:"y"},null,544),[[l.Jo,p.value.y,void 0,{number:!0}]])])],64)):((0,a.uX)(),(0,a.CE)("p",X,(0,r.v_)((0,d.R1)(s.o_)("Bitte wählen Sie ein Wort aus, um es zu bearbeiten.")),1))])])])])),_:1},8,["title"]),(0,a.bF)(w,{title:(0,d.R1)(s.o_)("Einstellungen"),icon:"settings",class:"tab-component"},{default:(0,a.k6)((()=>[(0,a.Lk)("label",null,[(0,a.eW)((0,r.v_)((0,d.R1)(s.o_)("Leere Felder einfärben:"))+" ",1),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":n[7]||(n[7]=e=>h.value.colorEmptyCells=e),onChange:n[8]||(n[8]=e=>g("taskDefinition.colorEmptyCells")),type:"checkbox"},null,544),[[l.lH,h.value.colorEmptyCells]])])])),_:1},8,["title"]),(0,a.bF)(w,{title:(0,d.R1)(s.o_)("Beschriftungen"),icon:"",class:"tab-component"},{default:(0,a.k6)((()=>[(0,a.Lk)("label",null,[(0,a.eW)((0,r.v_)((0,d.R1)(s.o_)("Text für Überprüfen-Button:"))+" ",1),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":n[9]||(n[9]=e=>h.value.strings.checkButton=e),onInput:n[10]||(n[10]=e=>g("taskDefinition.strings.checkButton")),type:"text"},null,544),[[l.Jo,h.value.strings.checkButton]])]),(0,a.Lk)("label",null,[(0,a.eW)((0,r.v_)((0,d.R1)(s.o_)("Text für Wiederholen-Button:"))+" ",1),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":n[11]||(n[11]=e=>h.value.strings.retryButton=e),onInput:n[12]||(n[12]=e=>g("taskDefinition.strings.retryButton")),type:"text"},null,544),[[l.Jo,h.value.strings.retryButton]])]),(0,a.Lk)("label",null,[(0,a.eW)((0,r.v_)((0,d.R1)(s.o_)("Text für Lösungen-Button:"))+" ",1),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":n[13]||(n[13]=e=>h.value.strings.solutionsButton=e),onInput:n[14]||(n[14]=e=>g("taskDefinition.strings.solutionsButton")),type:"text"},null,544),[[l.Jo,h.value.strings.solutionsButton]])])])),_:1},8,["title"]),(0,a.bF)(w,{title:(0,d.R1)(s.o_)("Feedback"),class:"tab-component"},{default:(0,a.k6)((()=>[(0,a.Lk)("label",null,[(0,a.eW)((0,r.v_)((0,d.R1)(s.o_)("Ergebnismitteilung (mögliche Variablen :correct und :total):"))+" ",1),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":n[15]||(n[15]=e=>h.value.strings.resultMessage=e),onInput:n[16]||(n[16]=e=>g("taskDefinition.strings.resultMessage")),type:"text"},null,544),[[l.Jo,h.value.strings.resultMessage]])])])),_:1},8,["title"]),(0,d.R1)(o)?((0,a.uX)(),(0,a.Wv)(w,{key:0,title:"Task Definition (debug)",icon:"visibility-visible"},{default:(0,a.k6)((()=>[(0,d.R1)(o)?((0,a.uX)(),(0,a.CE)("pre",O,(0,r.v_)({taskDefinition:e.taskDefinition}),1)):(0,a.Q3)("",!0)])),_:1},8,["title"])):(0,a.Q3)("",!0)])),_:1})])],32)]))}});const H=(0,v.A)(Q,[["__scopeId","data-v-39cea382"]]);var j=H,N="data:image/png;base64,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";const $={class:"feedback-container"},K={class:"meter-container"},G={class:"meter-background"},J={class:"meter-bar",ref:"meterBar"},q=["alt"],Y=["textContent"],Z=["textContent"];function ee(e,t,n,i,o,s){const l=(0,a.gN)("disable-drag");return(0,a.bo)(((0,a.uX)(),(0,a.CE)("div",$,[(0,a.Lk)("div",K,[(0,a.Lk)("div",G,[(0,a.Lk)("div",J,null,512),e.starVisible?((0,a.uX)(),(0,a.CE)("img",{key:0,class:"star-symbol",src:N,width:"38",height:"38",alt:e.$gettext("Ein goldener Stern, der den Abschluss der Aufgabe mit perfekter Leistung anzeigt")},null,8,q)):(0,a.Q3)("",!0)]),e.resultMessage?((0,a.uX)(),(0,a.CE)("div",{key:0,class:"result-text",textContent:(0,r.v_)(e.resultMessage)},null,8,Y)):(0,a.Q3)("",!0)]),e.feedbackMessage?((0,a.uX)(),(0,a.CE)("div",{key:0,class:"feedback-text",textContent:(0,r.v_)(e.feedbackMessage)},null,8,Z)):(0,a.Q3)("",!0)])),[[l]])}var te=(0,a.pM)({name:"FeedbackElement",props:{achievedPoints:Number,maxPoints:Number,resultMessage:String,feedback:Object},data(){return{starVisible:!1}},mounted(){this.adjustBarWidth()},watch:{achievedPoints:{immediate:!0,handler:function(){this.adjustBarWidth(),this.achievedMaxPoints?setTimeout((()=>{this.starVisible=!0}),350):this.starVisible=!1}}},methods:{async adjustBarWidth(){await(0,a.dY)();const e=this.$refs.meterBar;e&&(e.offsetHeight,e.style.width=`${this.percentageCorrect}%`)},urlForIcon(e){return window.STUDIP.ASSETS_URL+"images/icons/blue/"+e+".svg"}},computed:{feedbackSortedByScore(){return this.feedback?this.feedback.map((e=>e)).sort(((e,t)=>t.percentage-e.percentage)):[]},feedbackMessage(){if("undefined"===typeof this.achievedPoints||"undefined"===typeof this.maxPoints)return;const e=(0,m.round)(this.achievedPoints/this.maxPoints*100);for(const t of this.feedbackSortedByScore)if(e>=t.percentage)return t.message},percentageCorrect(){return this.achievedPoints&&this.maxPoints?(0,m.round)(this.achievedPoints/this.maxPoints*100):0},achievedMaxPoints(){return this.achievedPoints===this.maxPoints}}});const ne=(0,v.A)(te,[["render",ee],["__scopeId","data-v-7585ad83"]]);var ie=ne;const oe={class:"stud5p-task"},se={key:0,class:"canvas-and-hints-list-container"},ae=["width","height"],le={class:"hint-list"},re=["onClick"],de={key:1},ue={class:"feedback-and-button-container"},ce={class:"feedback-container"},pe={class:"button-panel"},he=["textContent"],me=["textContent"],ke=["textContent"];var ge=(0,a.pM)({props:{task:{type:Object,required:!0}},setup(e){const t=e,n=window.STUDIP.LernmoduleVueJS.LERNMODULE_DEBUG,i=(0,d.KR)(null),o=(0,d.KR)(null),u=(0,d.KR)(),c=(0,d.KR)(),p=(0,d.KR)([]),h=(0,d.KR)([]),m=(0,d.KR)(!1),k=(0,d.KR)(!1),g=(0,d.KR)([]),f=(0,d.KR)(0);(0,a.sV)((()=>{L(),D(),R(),window.addEventListener("resize",D)})),(0,a.xo)((()=>{window.removeEventListener("resize",D)}));const v=(0,a.EW)((()=>{let e=0;return y.value.forEach((t=>{"across"===t.direction?t.x+t.solution.length>e&&(e=t.x+t.solution.length):"down"===t.direction&&t.y+t.solution.length>e&&(e=t.y+t.solution.length)})),n&&console.log("Grid size is",e,"x",e),e})),b=(0,a.EW)((()=>v.value>0?Math.floor(f.value/v.value):0)),w=(0,a.EW)((()=>b.value>0?Math.floor(b.value/2):0)),y=(0,a.EW)((()=>t.task?.words?t.task.words:[])),A=(0,a.EW)((()=>{let e=0;for(let t=0;t<v.value;t++)for(let n=0;n<v.value;n++)p.value[t][n]&&e++;return e})),T=(0,a.EW)((()=>{let e=0;for(let t=0;t<v.value;t++)for(let n=0;n<v.value;n++)p.value[t][n]&&h.value[t][n]===p.value[t][n]&&e++;return e})),C=(0,a.EW)((()=>{let e=t.task.strings.resultMessage.replace(":correct",T.value.toString());return e=e.replace(":total",A.value.toString()),e})),E=(0,a.EW)((()=>!m.value));function D(){const e=i.value;e&&(f.value=Math.floor(Math.min(e.clientWidth,e.clientHeight)))}function I(){m.value=!0,u.value=void 0,c.value=void 0}function S(){m.value=!1,k.value=!1,u.value=void 0,L(),R()}function x(){k.value=!0,u.value=void 0,c.value=void 0,R()}function L(){c.value=void 0,u.value=void 0,p.value=Array.from({length:v.value},(()=>Array.from({length:v.value},(()=>"")))),h.value=Array.from({length:v.value},(()=>Array.from({length:v.value},(()=>"")))),g.value=y.value.map((e=>({...e,path:B(e)})));for(const e of g.value)for(const t of e.path)p.value[t.x][t.y]=t.letter}function B(e){let t=[];const n={across:{dx:1,dy:0},down:{dx:0,dy:1}},{dx:i,dy:o}=n[e.direction],s=e.solution.length;for(let a=0;a<s;a++){const n=e.x+i*a,s=e.y+o*a;t.push({x:n,y:s,letter:e.solution[a].toUpperCase()})}return t}function R(){const e=o.value;if(!e)return void console.error("No Canvas");const n=e.getContext("2d");if(n){n.clearRect(0,0,e.width,e.height),c.value?.path.forEach((e=>{z(e,"rgba(140, 180, 255, 0.13)")})),u.value&&z(u.value,"rgba(140, 180, 255, 0.34)");for(let e=0;e<v.value;e++)for(let i=0;i<v.value;i++)p.value[e][i]?(n.strokeStyle="gainsboro",n.strokeRect(e*b.value,i*b.value,b.value,b.value)):t.task?.colorEmptyCells&&(n.fillStyle="rgba(129,129,129,0.1)",n.fillRect(e*b.value,i*b.value,b.value,b.value)),m.value&&!k.value&&h.value[e][i]&&(h.value[e][i]===p.value[e][i]?(n.fillStyle="#9dd8bb",n.fillRect(e*b.value,i*b.value,b.value,b.value)):(n.fillStyle="#f7d0d0",n.fillRect(e*b.value,i*b.value,b.value,b.value))),n.font="bold "+w.value+"px calibri",n.textAlign="center",n.textBaseline="middle",k.value?(n.fillStyle="#404040",n.fillText(p.value[e][i],e*b.value+b.value/2,i*b.value+b.value/2)):(n.fillStyle="#404040",n.fillText(h.value[e][i],e*b.value+b.value/2,i*b.value+b.value/2))}}function _(e){if(m.value)return;const t=P(e);if(t&&(""!==p.value[t.x][t.y]?u.value={x:t.x,y:t.y,letter:p.value[t.x][t.y]}:(u.value=void 0,c.value=void 0),u.value&&void 0!==u.value.x&&void 0!==u.value.y)){const e=g.value.filter((e=>e.path.some((e=>e.x===u.value.x&&e.y===u.value.y))));e&&(1===e.length?c.value=e[0]:2===e.length&&(c.value===e[0]?c.value=e[1]:c.value=e[0]))}}function F(e){if(!m.value)if(u.value){if(e.key.match(/^[a-zA-Z]$/)){if(h.value[u.value.x][u.value.y]=e.key.toUpperCase(),c.value){const e=c.value.path.findIndex((e=>e.x===u.value.x&&e.y===u.value.y));if(e<c.value.path.length-1)u.value=c.value.path[e+1];else if(e===c.value.path.length-1){const e=g.value.findIndex((e=>e.uuid==c.value?.uuid));e<g.value.length-1&&(c.value=g.value[e+1],u.value=c.value.path[0])}}}else if("Backspace"===e.key){if(h.value[u.value.x][u.value.y]="",c.value){const e=c.value.path.findIndex((e=>e.x===u.value.x&&e.y===u.value.y));e>0&&(u.value=c.value.path[e-1])}}else if("Delete"===e.key){if(h.value[u.value.x][u.value.y]="",c.value){const e=c.value.path.findIndex((e=>e.x===u.value.x&&e.y===u.value.y));e<c.value.path.length-1&&(u.value=c.value.path[e+1])}}else if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(e.key)){if(e.preventDefault(),c.value){const t=c.value.path.findIndex((e=>e.x===u.value.x&&e.y===u.value.y));if("across"===c.value.direction){if("ArrowLeft"===e.key)t>0?u.value=c.value.path[t-1]:0===t&&(u.value=c.value.path[c.value.path.length-1]);else if("ArrowRight"===e.key)t<c.value.path.length-1?u.value=c.value.path[t+1]:t===c.value.path.length-1&&(u.value=c.value.path[0]);else if("ArrowUp"===e.key){const e=g.value.find((e=>e.path.some((e=>e.x===u.value.x&&e.y===u.value.y-1))));e&&(c.value=e,u.value=e.path.find((e=>e.x===u.value.x&&e.y===u.value.y-1)))}else if("ArrowDown"===e.key){const e=g.value.find((e=>e.path.some((e=>e.x===u.value.x&&e.y===u.value.y+1))));e&&(c.value=e,u.value=e.path.find((e=>e.x===u.value.x&&e.y===u.value.y+1)))}}else if("down"===c.value.direction)if("ArrowUp"===e.key)t>0?u.value=c.value.path[t-1]:0===t&&(u.value=c.value.path[c.value.path.length-1]);else if("ArrowDown"===e.key)t<c.value.path.length-1?u.value=c.value.path[t+1]:t===c.value.path.length-1&&(u.value=c.value.path[0]);else if("ArrowLeft"===e.key){const e=g.value.find((e=>e.path.some((e=>e.x===u.value.x-1&&e.y===u.value.y))));e&&(c.value=e,u.value=e.path.find((e=>e.x===u.value.x-1&&e.y===u.value.y)))}else if("ArrowRight"===e.key){const e=g.value.find((e=>e.path.some((e=>e.x===u.value.x+1&&e.y===u.value.y))));e&&(c.value=e,u.value=e.path.find((e=>e.x===u.value.x+1&&e.y===u.value.y)))}}}else if("Tab"===e.key){e.preventDefault();const t=g.value.findIndex((e=>e===c.value));e.shiftKey?c.value=t>0?g.value[t-1]:g.value[g.value.length-1]:t<g.value.length-1?c.value=g.value[t+1]:c.value=g.value[0],u.value=c.value?.path[0]}}else["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Tab"].includes(e.key)&&(e.preventDefault(),c.value=g.value[0],u.value=c.value.path[0])}function M(e){n&&console.log("Clicked on hint:",e.hint),m.value||(c.value=g.value.find((t=>t.uuid===e.uuid)),u.value=c.value?.path[0],o.value?.focus())}function P(e){if(!o.value)return;const t=o.value.getBoundingClientRect(),n=e.clientX-t.left,i=e.clientY-t.top,s=Math.max(0,Math.min(Math.floor(n/b.value),v.value-1)),a=Math.max(0,Math.min(Math.floor(i/b.value),v.value-1));return{x:s,y:a}}function z(e,t){if(e.x<0||e.x>v.value-1||e.y<0||e.y>v.value-1)return;if(!o.value)return;const n=o.value.getContext("2d");n&&(n.fillStyle=t,n.fillRect(e.x*b.value,e.y*b.value,b.value,b.value))}return(0,a.wB)((()=>t.task),(()=>{L(),o.value&&o.value.getContext("2d")&&o.value?.getContext("2d")?.clearRect(0,0,o.value.width,o.value.height),R()}),{deep:!0}),(0,a.wB)((()=>h.value),(()=>{R()}),{deep:!0}),(0,a.wB)((()=>u.value),(()=>{R(),n&&console.log("selected cell:",u.value?.x,u.value?.y)}),{deep:!0}),(0,a.wB)((()=>c.value),(()=>{R(),n&&console.log("selected word:",c.value?.solution)}),{deep:!0}),(n,u)=>((0,a.uX)(),(0,a.CE)("div",oe,[t.task?.words.length>0?((0,a.uX)(),(0,a.CE)("div",se,[(0,a.Lk)("div",{ref_key:"canvasWrapperRef",ref:i,class:"canvas-wrapper"},[(0,a.Lk)("canvas",{ref_key:"canvasRef",ref:o,tabindex:"0",width:f.value,height:f.value,style:(0,r.Tr)({width:f.value+"px",height:f.value+"px"}),onPointerdown:u[0]||(u[0]=(0,l.D$)((e=>_(e)),["stop"])),onKeydown:u[1]||(u[1]=(0,l.D$)((e=>F(e)),["stop"])),class:"canvas"},null,44,ae)],512),(0,a.Lk)("div",le,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.task?.words,(e=>((0,a.uX)(),(0,a.CE)("div",{key:e.uuid,onClick:t=>M(e),class:(0,r.C4)(["hint",{"selected-hint":c.value?.uuid===e.uuid}])},(0,r.v_)(e.hint),11,re)))),128))])])):((0,a.uX)(),(0,a.CE)("div",de,(0,r.v_)((0,d.R1)(s.o_)("Fügen Sie Wörter hinzu um ein Kreuzworträtsel zu erstellen.")),1)),(0,a.Lk)("div",ue,[(0,a.Lk)("div",ce,[m.value?((0,a.uX)(),(0,a.Wv)(ie,{key:0,achievedPoints:(0,d.R1)(T),maxPoints:(0,d.R1)(A),"result-message":(0,d.R1)(C)},null,8,["achievedPoints","maxPoints","result-message"])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",pe,[(0,d.R1)(E)?((0,a.uX)(),(0,a.CE)("button",{key:0,textContent:(0,r.v_)(e.task.strings.checkButton),onClick:I,type:"button",class:"stud5p-button"},null,8,he)):(0,a.Q3)("",!0),m.value?((0,a.uX)(),(0,a.CE)("button",{key:1,textContent:(0,r.v_)(e.task.strings.retryButton),onClick:S,type:"button",class:"stud5p-button"},null,8,me)):(0,a.Q3)("",!0),m.value&&!k.value?((0,a.uX)(),(0,a.CE)("button",{key:2,textContent:(0,r.v_)(e.task.strings.solutionsButton),onClick:x,type:"button",class:"stud5p-button"},null,8,ke)):(0,a.Q3)("",!0)])])]))}});const fe=(0,v.A)(ge,[["__scopeId","data-v-04ae3bd4"]]);var ve=fe;const be={class:"stud5p-task"},we={class:"default"},ye={class:"h5pEditorTopPanel"},Ae=["data-tooltip"],Te={style:{"margin-top":"1.5ex"}},Ce=["data-tooltip"],Ee={class:"collapsable collapsed"},De=["disabled"],Ie={class:"collapsable collapsed"},Se=["disabled"],xe=["disabled"],Le=["disabled"],Be=["disabled"];function Re(e,t,n,i,o,s){const d=(0,a.g2)("studip-wysiwyg"),u=(0,a.g2)("feedback-editor");return(0,a.uX)(),(0,a.CE)("div",be,[(0,a.Lk)("form",we,[(0,a.Lk)("fieldset",null,[(0,a.Lk)("legend",null,(0,r.v_)(e.$gettext("Drag the Words")),1),(0,a.Lk)("div",ye,[(0,a.Lk)("button",{onClick:t[0]||(t[0]=(...t)=>e.addBlank&&e.addBlank(...t)),class:"button add-blank",type:"button"},(0,r.v_)(e.$gettext("Lücke hinzufügen")),1),(0,a.Lk)("div",{class:"tooltip tooltip-icon","data-tooltip":e.instructions},null,8,Ae)]),(0,a.bF)(d,{modelValue:e.modelTaskDefinition.template,"onUpdate:modelValue":e.onEditTemplate,ref:"wysiwyg","force-soft-breaks":"","remove-wrapping-p-tag":"","disable-autoformat":""},null,8,["modelValue","onUpdate:modelValue"]),(0,a.Lk)("label",Te,[(0,a.eW)((0,r.v_)(e.$gettext("Irreführende Antworten"))+" ",1),(0,a.Lk)("span",{class:"tooltip tooltip-icon","data-tooltip":e.distratorInstructions},null,8,Ce),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=t=>e.modelTaskDefinition.distractors=t),onInput:t[2]||(t[2]=t=>e.updateTaskDefinition("taskDefinition.distractors")),type:"text"},null,544),[[l.Jo,e.modelTaskDefinition.distractors]])])]),(0,a.Lk)("fieldset",Ee,[(0,a.Lk)("legend",null,(0,r.v_)(e.$gettext("Einstellungen")),1),(0,a.Lk)("label",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[3]||(t[3]=t=>e.modelTaskDefinition.instantFeedback=t),onChange:t[4]||(t[4]=(...t)=>e.updateTaskDefinition&&e.updateTaskDefinition(...t)),type:"checkbox"},null,544),[[l.lH,e.modelTaskDefinition.instantFeedback]]),(0,a.eW)(" "+(0,r.v_)(e.$gettext("Lücken automatisch prüfen")),1)]),(0,a.Lk)("label",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[5]||(t[5]=t=>e.modelTaskDefinition.alphabeticOrder=t),onChange:t[6]||(t[6]=(...t)=>e.updateTaskDefinition&&e.updateTaskDefinition(...t)),type:"checkbox"},null,544),[[l.lH,e.modelTaskDefinition.alphabeticOrder]]),(0,a.eW)(" "+(0,r.v_)(e.$gettext("Antworten alphabetisch sortieren")),1)]),(0,a.Lk)("label",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[7]||(t[7]=t=>e.modelTaskDefinition.retryAllowed=t),onChange:t[8]||(t[8]=(...t)=>e.updateTaskDefinition&&e.updateTaskDefinition(...t)),type:"checkbox"},null,544),[[l.lH,e.modelTaskDefinition.retryAllowed]]),(0,a.eW)(" "+(0,r.v_)(e.$gettext("Mehrere Versuche erlauben")),1)]),(0,a.Lk)("label",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[9]||(t[9]=t=>e.modelTaskDefinition.showSolutionsAllowed=t),onChange:t[10]||(t[10]=(...t)=>e.updateShowSolutionsAllowed&&e.updateShowSolutionsAllowed(...t)),type:"checkbox"},null,544),[[l.lH,e.modelTaskDefinition.showSolutionsAllowed]]),(0,a.eW)(" "+(0,r.v_)(e.$gettext("Lösungen anzeigen erlauben")),1)]),(0,a.Lk)("label",{class:(0,r.C4)({"setting-disabled":!e.modelTaskDefinition.showSolutionsAllowed})},[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[11]||(t[11]=t=>e.modelTaskDefinition.allBlanksMustBeFilledForSolutions=t),onChange:t[12]||(t[12]=(...t)=>e.updateShowSolutionsAllowed&&e.updateShowSolutionsAllowed(...t)),disabled:!e.modelTaskDefinition.showSolutionsAllowed,type:"checkbox"},null,40,De),[[l.lH,e.modelTaskDefinition.allBlanksMustBeFilledForSolutions]]),(0,a.eW)(" "+(0,r.v_)(e.$gettext("Lösungen nur anzeigen, wenn alle Lücken ausgefüllt sind")),1)],2)]),(0,a.Lk)("fieldset",Ie,[(0,a.Lk)("legend",null,(0,r.v_)(e.$gettext("Beschriftungen")),1),(0,a.Lk)("label",{class:(0,r.C4)({"setting-disabled":e.modelTaskDefinition.instantFeedback})},[(0,a.eW)((0,r.v_)(e.$gettext("Text für Überprüfen-Button:"))+" ",1),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[13]||(t[13]=t=>e.modelTaskDefinition.strings.checkButton=t),onInput:t[14]||(t[14]=t=>e.updateTaskDefinition("taskDefinition.strings.checkButton")),disabled:e.modelTaskDefinition.instantFeedback,type:"text"},null,40,Se),[[l.Jo,e.modelTaskDefinition.strings.checkButton]])],2),(0,a.Lk)("label",{class:(0,r.C4)({"setting-disabled":!e.modelTaskDefinition.retryAllowed})},[(0,a.eW)((0,r.v_)(e.$gettext("Text für Wiederholen-Button:"))+" ",1),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[15]||(t[15]=t=>e.modelTaskDefinition.strings.retryButton=t),onInput:t[16]||(t[16]=t=>e.updateTaskDefinition("taskDefinition.strings.retryButton")),disabled:!e.modelTaskDefinition.retryAllowed,type:"text"},null,40,xe),[[l.Jo,e.modelTaskDefinition.strings.retryButton]])],2),(0,a.Lk)("label",{class:(0,r.C4)({"setting-disabled":!e.modelTaskDefinition.showSolutionsAllowed})},[(0,a.eW)((0,r.v_)(e.$gettext("Text für Lösungen-Button:"))+" ",1),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[17]||(t[17]=t=>e.modelTaskDefinition.strings.solutionsButton=t),onInput:t[18]||(t[18]=t=>e.updateTaskDefinition("taskDefinition.strings.solutionsButton")),disabled:!e.modelTaskDefinition.showSolutionsAllowed,type:"text"},null,40,Le),[[l.Jo,e.modelTaskDefinition.strings.solutionsButton]])],2),(0,a.Lk)("label",{class:(0,r.C4)({"setting-disabled":!e.modelTaskDefinition.showSolutionsAllowed||!e.modelTaskDefinition.allBlanksMustBeFilledForSolutions})},[(0,a.eW)((0,r.v_)(e.$gettext("Hinweis, wenn nicht alle Lücken ausgefüllt sind:"))+" ",1),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[19]||(t[19]=t=>e.modelTaskDefinition.strings.fillInAllBlanksMessage=t),onInput:t[20]||(t[20]=t=>e.updateTaskDefinition("taskDefinition.strings.fillInAllBlanksMessage")),disabled:!e.modelTaskDefinition.showSolutionsAllowed||!e.modelTaskDefinition.allBlanksMustBeFilledForSolutions,type:"text"},null,40,Be),[[l.Jo,e.modelTaskDefinition.strings.fillInAllBlanksMessage]])],2)]),(0,a.bF)(u,{feedback:e.modelTaskDefinition.feedback,"result-message":e.modelTaskDefinition.strings.resultMessage,"onUpdate:feedback":e.updateFeedback,"onUpdate:resultMessage":e.updateResultMessage},null,8,["feedback","result-message","onUpdate:feedback","onUpdate:resultMessage"])])])}var _e=n(8688);const Fe={class:"collapsable collapsed"},Me={key:0},Pe={for:"feedback-container"},ze={id:"feedback-container",class:"feedback-container"},We={class:"feedback-percentages-child"},Ue=["onUpdate:modelValue","onInput"],Ve={class:"feedback-messages-child"},Xe=["onUpdate:modelValue","onInput"],Oe=["title","onClick"],Qe=["src","alt"];function He(e,t,n,i,o,s){return(0,a.uX)(),(0,a.CE)("fieldset",Fe,[(0,a.Lk)("legend",null,(0,r.v_)(e.$gettext("Feedback")),1),e.localResultMessage?((0,a.uX)(),(0,a.CE)("label",Me,[(0,a.eW)((0,r.v_)(e.$gettext("Ergebnismitteilung (mögliche Variablen :correct und :total):"))+" ",1),(0,a.bo)((0,a.Lk)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=t=>e.localResultMessage=t),onInput:t[1]||(t[1]=(...t)=>e.emitUpdatedResultMessage&&e.emitUpdatedResultMessage(...t))},null,544),[[l.Jo,e.localResultMessage]])])):(0,a.Q3)("",!0),(0,a.Lk)("label",Pe,(0,r.v_)(e.$gettext("Benutzerdefiniertes Feedback für beliebige Punktebereiche:")),1),(0,a.Lk)("div",ze,[(0,a.Lk)("div",We,[(0,a.Lk)("label",null,(0,r.v_)(e.$gettext("Ab Prozent")),1),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.feedbackList,((t,n)=>(0,a.bo)(((0,a.uX)(),(0,a.CE)("input",{key:n,type:"number",min:"0",max:"100","onUpdate:modelValue":t=>e.feedbackList[n].percentage=t,onInput:t=>e.emitUpdatedFeedback(`feedbackList[${n}].percentage`)},null,40,Ue)),[[l.Jo,e.feedbackList[n].percentage]]))),128))]),(0,a.Lk)("div",Ve,[(0,a.Lk)("label",null,(0,r.v_)(e.$gettext("Mitteilung")),1),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.feedbackList,((t,n)=>((0,a.uX)(),(0,a.CE)("div",{class:"feedback-messages-child-subdivision",key:n},[(0,a.bo)((0,a.Lk)("input",{type:"text","onUpdate:modelValue":t=>e.feedbackList[n].message=t,onInput:t=>e.emitUpdatedFeedback(`feedbackList[${n}].message`)},null,40,Xe),[[l.Jo,e.feedbackList[n].message]]),(0,a.Lk)("button",{type:"button",title:e.titleForDeleteButtonForFeedback(t),class:"remove-feedback-button",onClick:n=>e.removeFeedback(t)},[(0,a.Lk)("img",{src:e.urlForIcon("trash"),alt:e.$gettext("Trash can icon in a button used to delete a feedback interval"),width:"16",height:"16"},null,8,Qe)],8,Oe)])))),128))])]),(0,a.Lk)("button",{type:"button",class:"button",onClick:t[2]||(t[2]=(...t)=>e.addFeedback&&e.addFeedback(...t))},(0,r.v_)(e.$gettext("Neuer Bereich")),1)])}var je=(0,a.pM)({name:"FeedbackEditor",props:{feedback:{type:Array,required:!0},resultMessage:{type:String,required:!1}},emits:{["update:feedback"](e,t){return!0},["update:result-message"](e){return!0}},data(){return{feedbackList:(0,m.cloneDeep)(this.feedback),localResultMessage:this.resultMessage||""}},watch:{feedback:{immediate:!0,handler:function(){this.feedbackList=(0,m.cloneDeep)(this.feedback)}},resultMessage:{immediate:!0,handler:function(){this.localResultMessage=this.resultMessage||""}}},methods:{$gettext:s.o_,titleForDeleteButtonForFeedback(e){return this.$gettext("Entferne den Feedback-Bereich, der ab %{ percentage }% anfängt.",{percentage:e.percentage.toString()})},addFeedback(){const e={percentage:25,message:"Feedback"};this.feedbackList.push(e),this.emitUpdatedFeedback()},removeFeedback(e){this.feedbackList=this.feedbackList.filter((t=>t!==e)),this.emitUpdatedFeedback()},emitUpdatedFeedback(e={}){this.$emit("update:feedback",(0,m.cloneDeep)(this.feedbackList),e)},emitUpdatedResultMessage(){this.$emit("update:result-message",this.localResultMessage)},urlForIcon(e){return window.STUDIP.ASSETS_URL+"images/icons/blue/"+e+".svg"}}});const Ne=(0,v.A)(je,[["render",He],["__scopeId","data-v-85a4403a"]]);var $e=Ne,Ke=(0,a.pM)({name:"DragTheWordsEditor",setup(){return{taskEditor:(0,a.WQ)(u.c)}},components:{StudipWysiwyg:_e.A,FeedbackEditor:$e},props:{taskDefinition:{type:Object,required:!0}},data(){return{modelTaskDefinition:(0,m.cloneDeep)(this.taskDefinition)}},watch:{taskDefinition:{immediate:!0,handler:function(){this.modelTaskDefinition=(0,m.cloneDeep)(this.taskDefinition)}}},computed:{instructions(){return(0,s.o_)("Um eine Lücke zu erstellen, setzen Sie ein Sternchen (*) vor und hinter das korrekte Wort oder markieren Sie das Wort und klicken Sie auf den Button „Lücke hinzufügen“. Sie können auch einen Tooltip hinzufügen, indem Sie einen Doppelpunkt (:) vor den Tooltip-Text schreiben.")},distratorInstructions(){return(0,s.o_)("Geben Sie falsche Antworten als Distraktoren ein. Verwenden Sie das gleiche Sternchen (*)-Schema wie im Text.")}},methods:{$gettext:s.o_,addBlank(){const e=this.$refs.wysiwyg?.$el,t=window.STUDIP.wysiwyg.getEditor(e);if(!t)throw console.error("getEditor(wysiwygEl) returned: ",t),new Error("Could not get reference to wysiwyg editor");const n=t.model.document.selection,i=n.getFirstPosition(),o=n.getLastPosition();if(!i||!o)throw console.error("selection start: ",i," selection end: ",o),new Error("Could not get selection in editor");t.model.change((e=>{e.insertText("*",o),e.insertText("*",i)}))},onEditTemplate(e){this.taskEditor.performEdit({newTaskDefinition:(0,S.Ay)(this.modelTaskDefinition,(t=>{t.template=e})),undoBatch:"taskDefinition.template"})},updateTaskDefinition(e){this.taskEditor.performEdit({newTaskDefinition:(0,m.cloneDeep)(this.modelTaskDefinition),undoBatch:e??{}})},updateShowSolutionsAllowed(){this.modelTaskDefinition.showSolutionsAllowed||(this.modelTaskDefinition.allBlanksMustBeFilledForSolutions=!1),this.updateTaskDefinition()},updateFeedback(e){this.taskEditor.performEdit({newTaskDefinition:(0,S.Ay)(this.modelTaskDefinition,(t=>{t.feedback=e})),undoBatch:"taskDefinition.feedback"})},updateResultMessage(e){this.taskEditor.performEdit({newTaskDefinition:(0,S.Ay)(this.modelTaskDefinition,(t=>{t.strings.resultMessage=e})),undoBatch:"taskDefinition.strings.resultMessage"})},urlForIcon(e){return window.STUDIP.ASSETS_URL+"images/icons/blue/"+e+".svg"}}});const Ge=(0,v.A)(Ke,[["render",Re]]);var Je=Ge;const qe={class:"stud5p-task"},Ye={class:"text-and-answers-container"},Ze={class:"text-and-feedback-container"},et={class:"drag-the-words-text"},tt=["innerHTML"],nt=["title","draggable","onDragstart","onDrop","onClick"],it=["onDrop","onClick"],ot={key:2},st=["data-tooltip"],at={key:3,class:"stud5p-solution"},lt={class:"feedback-and-button-container"},rt=["textContent"],dt={class:"button-panel"},ut=["textContent"],ct=["textContent"],pt=["textContent"],ht=["draggable","onDragstart","onClick"];function mt(e,t,n,i,o,s){const d=(0,a.g2)("FeedbackElement");return(0,a.uX)(),(0,a.CE)("div",qe,[(0,a.Lk)("div",Ye,[(0,a.Lk)("div",Ze,[(0,a.Lk)("div",et,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.parsedTemplate,(n=>((0,a.uX)(),(0,a.CE)(a.FK,{key:n.uuid},["staticText"===n.type?((0,a.uX)(),(0,a.CE)("span",{key:0,class:"static-text",innerHTML:n.text},null,8,tt)):"blank"===n.type?((0,a.uX)(),(0,a.CE)(a.FK,{key:1},[e.userInputs[n.uuid]?((0,a.uX)(),(0,a.CE)("span",{key:0,class:(0,r.C4)(["blank filled",e.classForFilledBlank(n)]),title:e.getAnswerById(e.userInputs[n.uuid])?.text,draggable:e.editable,onDragstart:t=>e.startDragUsedAnswer(t,n,e.userInputs[n.uuid]),onDrop:t=>e.onDropBlank(t,n),onDragover:t[0]||(t[0]=(0,l.D$)((()=>{}),["prevent"])),onClick:t=>e.onClickFilledBlank(n)},(0,r.v_)(e.getAnswerById(e.userInputs[n.uuid])?.text),43,nt)):((0,a.uX)(),(0,a.CE)("span",{key:1,class:"blank",onDrop:t=>e.onDropBlank(t,n),onDragenter:t[1]||(t[1]=t=>e.onDragEnter(t)),onDragleave:t[2]||(t[2]=t=>e.onDragLeave(t)),onDragover:t[3]||(t[3]=(0,l.D$)((()=>{}),["prevent"])),onClick:t=>e.onClickBlank(n)}," ​ ",40,it)),n.hint?((0,a.uX)(),(0,a.CE)("label",ot,[(0,a.Lk)("span",{class:"tooltip tooltip-icon","data-tooltip":n.hint},null,8,st)])):(0,a.Q3)("",!0),e.showSolutions&&!e.submittedAnswerIsCorrect(n)?((0,a.uX)(),(0,a.CE)("span",at,(0,r.v_)(n.solution),1)):(0,a.Q3)("",!0)],64)):(0,a.Q3)("",!0)],64)))),128))]),(0,a.Lk)("div",lt,[e.showFillInAllTheBlanksMessage?((0,a.uX)(),(0,a.CE)("div",{key:0,class:"stud5p-message",textContent:(0,r.v_)(e.fillInAllTheBlanksMessage)},null,8,rt)):(0,a.Q3)("",!0),e.showResults?((0,a.uX)(),(0,a.Wv)(d,{key:1,"achieved-points":e.correctAnswers,"max-points":e.maxPoints,feedback:e.task.feedback,"result-message":e.resultMessage},null,8,["achieved-points","max-points","feedback","result-message"])):(0,a.Q3)("",!0),(0,a.Lk)("div",dt,[e.showCheckButton?((0,a.uX)(),(0,a.CE)("button",{key:0,textContent:(0,r.v_)(e.task.strings.checkButton),onClick:t[4]||(t[4]=(...t)=>e.onClickCheckButton&&e.onClickCheckButton(...t)),type:"button",class:"stud5p-button"},null,8,ut)):(0,a.Q3)("",!0),e.showSolutionsButton?((0,a.uX)(),(0,a.CE)("button",{key:1,textContent:(0,r.v_)(e.task.strings.solutionsButton),onClick:t[5]||(t[5]=(...t)=>e.onClickSolutionsButton&&e.onClickSolutionsButton(...t)),type:"button",class:"stud5p-button"},null,8,ct)):(0,a.Q3)("",!0),e.showRetryButton?((0,a.uX)(),(0,a.CE)("button",{key:2,textContent:(0,r.v_)(e.task.strings.retryButton),onClick:t[6]||(t[6]=(...t)=>e.onClickRetryButton&&e.onClickRetryButton(...t)),type:"button",class:"stud5p-button"},null,8,pt)):(0,a.Q3)("",!0)])])]),(0,a.Lk)("div",{class:"unused-answers-list",onDrop:t[7]||(t[7]=t=>e.onDropUnusedAnswers(t)),onDragover:t[8]||(t[8]=(0,l.D$)((()=>{}),["prevent"]))},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.unusedAnswers,(t=>((0,a.uX)(),(0,a.CE)("span",{key:t.uuid,class:(0,r.C4)(["unused-answer",{disabled:!this.editable,selected:t.uuid===this.clickedAnswerId}]),draggable:e.editable,onDragstart:n=>e.startDragUnusedAnswer(n,t),onClick:n=>e.onClickUnusedAnswer(t)},(0,r.v_)(t.text),43,ht)))),128))],32)])])}var kt=(0,a.pM)({name:"DragTheWordsViewer",components:{FeedbackElement:ie},props:{task:{type:Object,required:!0}},data(){return{userInputs:{},submittedAnswers:null,userWantsToSeeSolutions:!1,draggedAnswerId:void 0,draggedSourceId:void 0,clickedAnswerId:void 0,editable:!0}},methods:{$gettext:s.o_,submittedAnswerIsCorrect(e){const t=this.submittedAnswers?.[e.uuid];if(!t)return!1;const n=this.getAnswerById(t)?.text;return!!n&&this.isAnswerCorrect(n,e.solution)},isAnswerCorrect(e,t){return e===t},updateAttempt(){const e={};this.blanks.forEach(((t,n)=>{e[`${n} - ${t.solution}`]=this.submittedAnswerIsCorrect(t)?1:0})),this.$emit("updateAttempt",{points:e,success:this.correctAnswers===this.blanks.length})},getElement(e){const t=this.parsedTemplate.find((t=>t.uuid===e));if(!t)throw new Error("The given element does not exist in parsedTemplate: "+e);return t},startDragUsedAnswer(e,t,n){if(!this.editable)return;e.dataTransfer&&(e.dataTransfer.dropEffect="move",e.dataTransfer.effectAllowed="move");const i=this.getAnswerById(n);console.log("Dragging answer: ",i,"From blank: ",t);for(const o in this.userInputs)console.log(o);this.draggedAnswerId=n},startDragUnusedAnswer(e,t){e.dataTransfer&&(e.dataTransfer.dropEffect="move",e.dataTransfer.effectAllowed="move",console.log("Dragging answer: ",t),this.draggedAnswerId=t.uuid)},onDropBlank(e,t){if(!this.draggedAnswerId)throw new Error("Dragged answer id is undefined");console.log("Dropped answer :",this.draggedAnswer,"on blank: ",t);const n=this.blanks.find((e=>this.userInputs[e.uuid]===this.draggedAnswerId));n&&delete this.userInputs[n.uuid],this.userInputs[t.uuid]=this.draggedAnswerId,this.draggedAnswerId=void 0},onDropUnusedAnswers(e){if(e.preventDefault(),!this.draggedAnswer)throw new Error("draggedAnswer is undefined");const t=this.blanks.find((e=>this.userInputs[e.uuid]===this.draggedAnswerId));t&&delete this.userInputs[t.uuid]},onDragEnter(e){const t=e.target;t&&(t.style.backgroundColor="#80b4ed")},onDragLeave(e){const t=e.target;t&&(t.style.backgroundColor="")},onClickCheckButton(){this.submittedAnswers={...this.userInputs},this.editable=!1},onClickSolutionsButton(){this.userWantsToSeeSolutions=!0},onClickRetryButton(){this.userWantsToSeeSolutions=!1,this.userInputs={},this.submittedAnswers=null,this.editable=!0},classForFilledBlank(e){return this.submittedAnswers||this.task.instantFeedback?(this.task.instantFeedback&&(this.submittedAnswers={...this.userInputs}),this.userInputs?.[e.uuid]?this.submittedAnswerIsCorrect(e)?"correct disabled":"incorrect disabled":""):""},getAnswerById(e){return this.answers.find((t=>t.uuid===e))},onClickUnusedAnswer(e){console.log("Clicked answer:",e),this.editable&&(this.clickedAnswerId=e.uuid)},onClickBlank(e){console.log("Clicked blank:",e),this.clickedAnswerId&&(this.userInputs[e.uuid]=this.clickedAnswerId,this.clickedAnswerId=void 0)},onClickFilledBlank(e){console.log("Clicked filled blank:",e),this.editable&&e&&delete this.userInputs[e.uuid]},removePTags(e){return e.replace(/<\/?p>/g,"")}},computed:{splitTemplate(){const e=this.removePTags(this.task.template);return e.split(/\*([^*]*)\*/)},parsedTemplate(){return this.splitTemplate.map(((e,t)=>{if(t%2===0)return{type:"staticText",text:e,uuid:(0,i.A)()};{let t=e.split(":"),n=t[0],o=t[1];return{type:"blank",solution:n,hint:o,uuid:(0,i.A)()}}}))},parsedDistractors(){const e=(this.task.distractors.match(/\*(.*?)\*/g)||[]).map((e=>e.replace(/\*/g,"").trim()));return e},blanks(){return this.parsedTemplate.filter((e=>"blank"===e.type))},answers(){const e=this.blanks.map((e=>({uuid:(0,i.A)(),text:e.solution}))),t=this.parsedDistractors.map((e=>({uuid:(0,i.A)(),text:e})));return[...e,...t]},draggedAnswer(){return this.draggedAnswerId?this.getAnswerById(this.draggedAnswerId):void 0},randomizedAnswers(){return this.answers.map((e=>({value:e,sort:Math.random()}))).sort(((e,t)=>e.sort-t.sort)).map((({value:e})=>e))},sortedAnswers(){return this.answers.map((e=>e)).sort(((e,t)=>e.text.localeCompare(t.text)))},blanksFilled(){return this.submittedAnswers?Object.keys(this.submittedAnswers).length:0},allBlanksAreFilled(){return this.blanksFilled==this.blanks.length},correctAnswers(){return this.blanks.filter((e=>this.submittedAnswerIsCorrect(e))).length},allAnswersAreCorrect(){return this.blanks.every((e=>this.submittedAnswerIsCorrect(e)))},maxPoints(){return this.blanks.length},unusedAnswers(){return this.task.alphabeticOrder?this.sortedAnswers.filter((e=>!Object.values(this.userInputs).includes(e.uuid))):this.randomizedAnswers.filter((e=>!Object.values(this.userInputs).includes(e.uuid)))},inputHasChanged(){return!(0,m.isEqual)(this.submittedAnswers,this.userInputs)},showCheckButton(){return(null===this.submittedAnswers||this.inputHasChanged)&&!this.task.instantFeedback},showSolutionsButton(){return this.task.showSolutionsAllowed&&!this.showSolutions&&this.showResults&&!this.allAnswersAreCorrect},showRetryButton(){return this.task.retryAllowed&&this.showResults&&!this.allAnswersAreCorrect&&null!==this.submittedAnswers},showSolutions(){return this.userWantsToSeeSolutions&&(this.allBlanksAreFilled||!this.task.allBlanksMustBeFilledForSolutions)},showFillInAllTheBlanksMessage(){return this.task.allBlanksMustBeFilledForSolutions&&this.userWantsToSeeSolutions&&!this.allBlanksAreFilled&&!this.inputHasChanged},showResults(){return!(null===this.submittedAnswers)&&!this.showFillInAllTheBlanksMessage&&(!this.task.instantFeedback||this.allBlanksAreFilled)&&!this.inputHasChanged},resultMessage(){let e=this.task.strings.resultMessage.replace(":correct",this.correctAnswers.toString());return e=e.replace(":total",this.blanks.length.toString()),e},fillInAllTheBlanksMessage(){return this.task.strings.fillInAllBlanksMessage?this.task.strings.fillInAllBlanksMessage:(0,s.o_)("Alle Lücken müssen ausgefüllt sein, um Lösungen anzuzeigen")}}});const gt=(0,v.A)(kt,[["render",mt],["__scopeId","data-v-501f9f22"]]);var ft=gt;const vt={class:"stud5p-task"},bt={class:"default"},wt={class:"fill-in-the-blanks-editor-top-panel"},yt=["data-tooltip"],At={class:"collapsable collapsed"},Tt=["disabled"],Ct={class:"collapsable collapsed"},Et=["disabled"],Dt=["disabled"],It=["disabled"],St=["disabled"];function xt(e,t,n,i,o,s){const d=(0,a.g2)("studip-wysiwyg"),u=(0,a.g2)("feedback-editor");return(0,a.uX)(),(0,a.CE)("div",vt,[(0,a.Lk)("form",bt,[(0,a.Lk)("fieldset",null,[(0,a.Lk)("legend",null,(0,r.v_)(e.$gettext("Fill in the Blanks")),1),(0,a.Lk)("div",wt,[(0,a.Lk)("button",{onClick:t[0]||(t[0]=(...t)=>e.addBlank&&e.addBlank(...t)),class:"button add-blank",type:"button"},(0,r.v_)(e.$gettext("Lücke hinzufügen")),1),(0,a.Lk)("div",{class:"tooltip tooltip-icon","data-tooltip":e.instructions},null,8,yt)]),(0,a.bF)(d,{modelValue:e.modelTaskDefinition.template,"onUpdate:modelValue":e.onEditTemplate,ref:"wysiwyg","force-soft-breaks":"","remove-wrapping-p-tag":"","disable-autoformat":""},null,8,["modelValue","onUpdate:modelValue"])]),(0,a.Lk)("fieldset",At,[(0,a.Lk)("legend",null,(0,r.v_)(e.$gettext("Einstellungen")),1),(0,a.Lk)("label",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=t=>e.modelTaskDefinition.caseSensitive=t),onChange:t[2]||(t[2]=(...t)=>e.updateTaskDefinition&&e.updateTaskDefinition(...t)),type:"checkbox"},null,544),[[l.lH,e.modelTaskDefinition.caseSensitive]]),(0,a.eW)(" "+(0,r.v_)(e.$gettext("Groß- und Kleinschreibung beachten")),1)]),(0,a.Lk)("label",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[3]||(t[3]=t=>e.modelTaskDefinition.acceptTypos=t),onChange:t[4]||(t[4]=(...t)=>e.updateTaskDefinition&&e.updateTaskDefinition(...t)),type:"checkbox"},null,544),[[l.lH,e.modelTaskDefinition.acceptTypos]]),(0,a.eW)(" "+(0,r.v_)(e.$gettext("Rechtschreib- und Tippfehler ignorieren")),1)]),(0,a.Lk)("label",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[5]||(t[5]=t=>e.modelTaskDefinition.autoCorrect=t),onChange:t[6]||(t[6]=(...t)=>e.updateTaskDefinition&&e.updateTaskDefinition(...t)),type:"checkbox"},null,544),[[l.lH,e.modelTaskDefinition.autoCorrect]]),(0,a.eW)(" "+(0,r.v_)(e.$gettext("Lücken automatisch prüfen")),1)]),(0,a.Lk)("label",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[7]||(t[7]=t=>e.modelTaskDefinition.retryAllowed=t),onChange:t[8]||(t[8]=(...t)=>e.updateTaskDefinition&&e.updateTaskDefinition(...t)),type:"checkbox"},null,544),[[l.lH,e.modelTaskDefinition.retryAllowed]]),(0,a.eW)(" "+(0,r.v_)(e.$gettext("Mehrere Versuche erlauben")),1)]),(0,a.Lk)("label",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[9]||(t[9]=t=>e.modelTaskDefinition.showSolutionsAllowed=t),onChange:t[10]||(t[10]=(...t)=>e.updateShowSolutionsAllowed&&e.updateShowSolutionsAllowed(...t)),type:"checkbox"},null,544),[[l.lH,e.modelTaskDefinition.showSolutionsAllowed]]),(0,a.eW)(" "+(0,r.v_)(e.$gettext("Lösungen anzeigen erlauben")),1)]),(0,a.Lk)("label",{class:(0,r.C4)({"setting-disabled":!e.modelTaskDefinition.showSolutionsAllowed})},[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[11]||(t[11]=t=>e.modelTaskDefinition.allBlanksMustBeFilledForSolutions=t),onChange:t[12]||(t[12]=(...t)=>e.updateTaskDefinition&&e.updateTaskDefinition(...t)),disabled:!e.modelTaskDefinition.showSolutionsAllowed,type:"checkbox"},null,40,Tt),[[l.lH,e.modelTaskDefinition.allBlanksMustBeFilledForSolutions]]),(0,a.eW)(" "+(0,r.v_)(e.$gettext("Lösungen nur anzeigen, wenn alle Lücken ausgefüllt sind")),1)],2)]),(0,a.Lk)("fieldset",Ct,[(0,a.Lk)("legend",null,(0,r.v_)(e.$gettext("Beschriftungen")),1),(0,a.Lk)("label",{class:(0,r.C4)({"setting-disabled":e.modelTaskDefinition.autoCorrect})},[(0,a.eW)((0,r.v_)(e.$gettext("Text für Überprüfen-Button:"))+" ",1),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[13]||(t[13]=t=>e.modelTaskDefinition.strings.checkButton=t),onInput:t[14]||(t[14]=t=>e.updateTaskDefinition("taskDefinition.strings.checkButton")),disabled:e.modelTaskDefinition.autoCorrect,type:"text"},null,40,Et),[[l.Jo,e.modelTaskDefinition.strings.checkButton]])],2),(0,a.Lk)("label",{class:(0,r.C4)({"setting-disabled":!e.modelTaskDefinition.retryAllowed})},[(0,a.eW)((0,r.v_)(e.$gettext("Text für Wiederholen-Button:"))+" ",1),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[15]||(t[15]=t=>e.modelTaskDefinition.strings.retryButton=t),onInput:t[16]||(t[16]=t=>e.updateTaskDefinition("taskDefinition.strings.retryButton")),disabled:!e.modelTaskDefinition.retryAllowed,type:"text"},null,40,Dt),[[l.Jo,e.modelTaskDefinition.strings.retryButton]])],2),(0,a.Lk)("label",{class:(0,r.C4)({"setting-disabled":!e.modelTaskDefinition.showSolutionsAllowed})},[(0,a.eW)((0,r.v_)(e.$gettext("Text für Lösungen-Button:"))+" ",1),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[17]||(t[17]=t=>e.modelTaskDefinition.strings.solutionsButton=t),onInput:t[18]||(t[18]=t=>e.updateTaskDefinition("taskDefinition.strings.solutionsButton")),disabled:!e.modelTaskDefinition.showSolutionsAllowed,type:"text"},null,40,It),[[l.Jo,e.modelTaskDefinition.strings.solutionsButton]])],2),(0,a.Lk)("label",{class:(0,r.C4)({"setting-disabled":!e.modelTaskDefinition.showSolutionsAllowed||!e.modelTaskDefinition.allBlanksMustBeFilledForSolutions})},[(0,a.eW)((0,r.v_)(e.$gettext("Hinweis, wenn nicht alle Lücken ausgefüllt sind:"))+" ",1),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[19]||(t[19]=t=>e.modelTaskDefinition.strings.fillInAllBlanksMessage=t),onInput:t[20]||(t[20]=t=>e.updateTaskDefinition("taskDefinition.strings.fillInAllBlanksMessage")),disabled:!e.modelTaskDefinition.showSolutionsAllowed||!e.modelTaskDefinition.allBlanksMustBeFilledForSolutions,type:"text"},null,40,St),[[l.Jo,e.modelTaskDefinition.strings.fillInAllBlanksMessage]])],2)]),(0,a.bF)(u,{feedback:e.modelTaskDefinition.feedback,"result-message":e.modelTaskDefinition.strings.resultMessage,"onUpdate:feedback":e.updateFeedback,"onUpdate:resultMessage":e.updateResultMessage},null,8,["feedback","result-message","onUpdate:feedback","onUpdate:resultMessage"])])])}var Lt=(0,a.pM)({name:"FillInTheBlanksEditor",setup(){return{taskEditor:(0,a.WQ)(u.c)}},components:{StudipWysiwyg:_e.A,FeedbackEditor:$e},props:{taskDefinition:{type:Object,required:!0}},data(){return{modelTaskDefinition:(0,m.cloneDeep)(this.taskDefinition)}},watch:{taskDefinition:{immediate:!0,handler:function(){this.modelTaskDefinition=(0,m.cloneDeep)(this.taskDefinition)}}},computed:{instructions(){return(0,s.o_)("Um eine Lücke zu erstellen, setzen Sie ein Sternchen (*) vor und hinter das korrekte Wort oder markieren Sie das Wort und klicken Sie auf den Button „Lücke hinzufügen“. Sie können auch einen Tooltip hinzufügen, indem Sie einen Doppelpunkt (:) vor den Tooltip-Text schreiben.")}},methods:{$gettext:s.o_,addBlank(){const e=this.$refs.wysiwyg?.$el,t=window.STUDIP.wysiwyg.getEditor(e);if(!t)throw console.error("getEditor(wysiwygEl) returned: ",t),new Error("Could not get reference to wysiwyg editor");const n=t.model.document.selection,i=n.getFirstPosition(),o=n.getLastPosition();if(!i||!o)throw console.error("selection start: ",i," selection end: ",o),new Error("Could not get selection in editor");t.model.change((e=>{e.insertText("*",o),e.insertText("*",i)}))},onEditTemplate(e){this.taskEditor.performEdit({newTaskDefinition:(0,S.Ay)(this.modelTaskDefinition,(t=>{t.template=e})),undoBatch:"taskDefinition.template"})},updateTaskDefinition(e){console.log("update task definition"),this.taskEditor.performEdit({newTaskDefinition:(0,m.cloneDeep)(this.modelTaskDefinition),undoBatch:e??{}})},updateShowSolutionsAllowed(){this.modelTaskDefinition.showSolutionsAllowed||(this.modelTaskDefinition.allBlanksMustBeFilledForSolutions=!1),this.updateTaskDefinition()},updateFeedback(e){this.taskEditor.performEdit({newTaskDefinition:(0,S.Ay)(this.modelTaskDefinition,(t=>{t.feedback=e})),undoBatch:"taskDefinition.feedback"})},updateResultMessage(e){this.taskEditor.performEdit({newTaskDefinition:(0,S.Ay)(this.modelTaskDefinition,(t=>{t.strings.resultMessage=e})),undoBatch:"taskDefinition.strings.resultMessage"})},urlForIcon(e){return window.STUDIP.ASSETS_URL+"images/icons/blue/"+e+".svg"}}});const Bt=(0,v.A)(Lt,[["render",xt],["__scopeId","data-v-7715379e"]]);var Rt=Bt;const _t={class:"stud5p-task",ref:"wrapperElement"},Ft={class:"fill-in-the-blanks-text"},Mt=["innerHTML"],Pt=["onUpdate:modelValue","readonly","disabled"],zt={key:0},Wt=["data-tooltip"],Ut={key:1,class:"stud5p-solution"},Vt={class:"feedback-and-button-container"},Xt=["textContent"],Ot={class:"button-panel"},Qt=["textContent"],Ht=["textContent"],jt=["textContent"];function Nt(e,t,n,i,o,s){const d=(0,a.g2)("FeedbackElement");return(0,a.uX)(),(0,a.CE)("div",_t,[(0,a.Lk)("div",Ft,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.parsedTemplate,(n=>((0,a.uX)(),(0,a.CE)(a.FK,{key:n.uuid},["staticText"===n.type?((0,a.uX)(),(0,a.CE)("span",{key:0,innerHTML:n.text},null,8,Mt)):"blank"===n.type?((0,a.uX)(),(0,a.CE)(a.FK,{key:1},[(0,a.bo)((0,a.Lk)("input",{type:"text","onUpdate:modelValue":t=>e.userInputs[n.uuid]=t,readonly:!e.editable,disabled:!e.editable,class:(0,r.C4)(["blank",{autocorrect:e.task.autoCorrect},e.classForInput(n)]),onBlur:t[0]||(t[0]=(...t)=>e.onBlur&&e.onBlur(...t)),onKeyup:t[1]||(t[1]=(0,l.jR)((t=>e.onEnter(t)),["enter"])),onInput:t[2]||(t[2]=(...t)=>e.onInput&&e.onInput(...t)),ref_for:!0,ref:"blanks"},null,42,Pt),[[l.Jo,e.userInputs[n.uuid]]]),n.hint?((0,a.uX)(),(0,a.CE)("label",zt,[(0,a.Lk)("span",{class:"tooltip tooltip-icon","data-tooltip":n.hint},null,8,Wt)])):(0,a.Q3)("",!0),!e.showSolutions||e.showFillInAllTheBlanksMessage||e.submittedAnswerIsCorrect(n)?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("span",Ut,(0,r.v_)(n.solutions[0]),1))],64)):(0,a.Q3)("",!0)],64)))),128))]),(0,a.Lk)("div",Vt,[e.showFillInAllTheBlanksMessage?((0,a.uX)(),(0,a.CE)("div",{key:0,class:"stud5p-message",textContent:(0,r.v_)(e.fillInAllTheBlanksMessage)},null,8,Xt)):(0,a.Q3)("",!0),e.showResults?((0,a.uX)(),(0,a.Wv)(d,{key:1,achievedPoints:e.correctAnswers,maxPoints:e.maxPoints,feedback:e.task.feedback,resultMessage:e.resultMessage},null,8,["achievedPoints","maxPoints","feedback","resultMessage"])):(0,a.Q3)("",!0),(0,a.Lk)("div",Ot,[e.showCheckButton?((0,a.uX)(),(0,a.CE)("button",{key:0,textContent:(0,r.v_)(e.task.strings.checkButton),onClick:t[3]||(t[3]=t=>e.onClickCheck(!1)),type:"button",class:"stud5p-button",ref:"checkButton"},null,8,Qt)):(0,a.Q3)("",!0),e.showExtraButtons?((0,a.uX)(),(0,a.CE)(a.FK,{key:1},[e.showSolutionButton?((0,a.uX)(),(0,a.CE)("button",{key:0,textContent:(0,r.v_)(e.task.strings.solutionsButton),onClick:t[4]||(t[4]=(...t)=>e.onClickShowSolution&&e.onClickShowSolution(...t)),type:"button",class:"stud5p-button"},null,8,Ht)):(0,a.Q3)("",!0),e.showRetryButton?((0,a.uX)(),(0,a.CE)("button",{key:1,textContent:(0,r.v_)(e.task.strings.retryButton),onClick:t[5]||(t[5]=(...t)=>e.onClickTryAgain&&e.onClickTryAgain(...t)),type:"button",class:"stud5p-button"},null,8,jt)):(0,a.Q3)("",!0)],64)):(0,a.Q3)("",!0)])])],512)}const $t=n(4302);var Kt=(0,a.pM)({name:"FillInTheBlanksViewer",components:{FeedbackElement:ie},props:{task:{type:Object,required:!0}},data(){return{userInputs:{},submittedAnswers:null,showSolutions:!1,editable:!0}},methods:{$gettext:s.o_,submittedAnswerIsCorrect(e){const t=e,n=this.submittedAnswers?.[t.uuid];return!!n&&t.solutions.some((e=>this.isAnswerCorrect(n,e)))},isAnswerCorrect(e,t){return this.task.caseSensitive?this.task.acceptTypos?this.isAnswerCorrectWithTypo(e,t):e===t:this.task.acceptTypos?this.isAnswerCorrectWithTypo(e.toLowerCase(),t.toLowerCase()):e.toLowerCase()===t.toLowerCase()},isAnswerCorrectWithTypo(e,t){if(e===t)return!0;const n=$t.distance(e,t);return e.length>3&&n<=1||e.length>9&&n<=2},updateAttempt(){const e={};this.blanks.forEach(((t,n)=>{e[`${n} - ${t.solutions[0]}`]=this.submittedAnswerIsCorrect(t)?1:0})),this.$emit("updateAttempt",{points:e,success:this.correctAnswers===this.blanks.length})},autoGrowTextField(e){const t=window.getComputedStyle(e,null),n=t.getPropertyValue("font-size"),i=t.getPropertyValue("font-family"),o=t.getPropertyValue("padding"),s=parseInt(n,10),a=6,l=s*a,r=3.25,d=s*r,u=.5*s;setTimeout((()=>{const t=document.createElement("div");t.textContent=e.value;const s={position:"absolute","white-space":"nowrap","font-size":n,"font-family":i,padding:o,width:"initial"};for(const[e,n]of Object.entries(s))t.style[e]=n;e.parentElement.append(t);const a=t.clientWidth,r=this.$refs.wrapperElement.clientWidth;t.remove(),e.style.width=a<=l?(l+u).toString()+"px":a+d>=r?(r-d).toString()+"px":(a+u).toString()+"px"}),1)},onClickCheck(e){this.submittedAnswers={...this.userInputs},this.updateAttempt(),this.editable=e},onClickShowSolution(){this.showSolutions=!0},onClickTryAgain(){this.resetTask(),this.resetBlankWidths()},resetTask(){this.showSolutions=!1,this.userInputs={},this.submittedAnswers=null,this.editable=!0},resetBlankWidths(){this.$refs.blanks.forEach((e=>{this.autoGrowTextField(e)}))},onBlur(){this.handleFilledBlank()},onEnter(e){this.handleFilledBlank(),this.focusNextBlank(e.target)},handleFilledBlank(){this.showSolutions=!1,this.task.autoCorrect&&this.onClickCheck(!0)},focusNextBlank(e){const t=this.$refs.blanks,n=t.indexOf(e);if(-1!==n&&n<t.length-1){const e=t[n+1];e.focus()}else this.showCheckButton&&this.$refs.checkButton.focus()},onInput(e){this.autoGrowTextField(e.target)},classForInput(e){return this.submittedAnswers?void 0!=this.submittedAnswers?.[e.uuid]?this.submittedAnswerIsCorrect(e)?"correct":"incorrect":this.task.autoCorrect?"autocorrect":"autocorrect incorrect":""},urlForIcon(e){return window.STUDIP.ASSETS_URL+"images/icons/blue/"+e+".svg"},removePTags(e){return e.replace(/<\/?p>/g,"")}},computed:{splitTemplate(){const e=this.removePTags(this.task.template);return e.split(/\*([^*]+)\*/)},parsedTemplate(){return this.splitTemplate.map(((e,t)=>{if(t%2===0)return{type:"staticText",text:e,uuid:(0,i.A)()};{let t=e.split(":"),n=t[0].split("/"),o=t[1];return{type:"blank",solutions:n,hint:o,uuid:(0,i.A)()}}}))},blanks(){return this.parsedTemplate.filter((e=>"blank"===e.type))},blanksFilled(){return this.submittedAnswers?Object.keys(this.submittedAnswers).length:0},allBlanksAreFilled(){return this.blanksFilled==this.blanks.length},correctAnswers(){return this.blanks.filter((e=>this.submittedAnswerIsCorrect(e))).length},allAnswersAreCorrect(){return this.blanks.every((e=>this.submittedAnswerIsCorrect(e)))},maxPoints(){return this.blanks.length},inputHasChanged(){return!(0,m.isEqual)(this.submittedAnswers,this.userInputs)},showExtraButtons(){return this.task.autoCorrect?!!this.allBlanksAreFilled&&(null!==this.submittedAnswers&&!this.inputHasChanged&&!this.allAnswersAreCorrect):null!==this.submittedAnswers&&!this.inputHasChanged&&!this.allAnswersAreCorrect},showCheckButton(){return(null===this.submittedAnswers||this.inputHasChanged)&&!this.task.autoCorrect},showSolutionButton(){return this.task.showSolutionsAllowed&&this.showResults&&!this.showSolutions},showRetryButton(){return this.task.retryAllowed&&null!==this.submittedAnswers},showFillInAllTheBlanksMessage(){return this.task.allBlanksMustBeFilledForSolutions&&this.showSolutions&&!this.allBlanksAreFilled&&!this.inputHasChanged},showResults(){return!(null===this.submittedAnswers)&&!this.showFillInAllTheBlanksMessage&&(!this.task.autoCorrect||this.allBlanksAreFilled)&&!this.inputHasChanged},resultMessage(){let e=this.task.strings.resultMessage.replace(":correct",this.correctAnswers.toString());return e=e.replace(":total",this.blanks.length.toString()),e},feedbackSortedByScore(){return this.task.feedback.map((e=>e)).sort(((e,t)=>t.percentage-e.percentage))},fillInAllTheBlanksMessage(){return this.task.strings.fillInAllBlanksMessage?this.task.strings.fillInAllBlanksMessage:(0,s.o_)("Alle Lücken müssen ausgefüllt sein, um Lösungen anzuzeigen")}}});const Gt=(0,v.A)(Kt,[["render",Nt],["__scopeId","data-v-991d4d3e"]]);var Jt=Gt;const qt={key:0},Yt={key:1},Zt=["accept"];function en(e,t,n,i,o,s){return e.uploadRequestPromise?((0,a.uX)(),(0,a.CE)("span",qt,(0,r.v_)(e.$gettext("Datei wird hochgeladen")),1)):((0,a.uX)(),(0,a.CE)("div",Yt,[(0,a.Lk)("input",{ref:"fileInput",type:"file",accept:e.accept,onChange:t[0]||(t[0]=(...t)=>e.onInputChange&&e.onInputChange(...t))},null,40,Zt),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.errors,(e=>((0,a.uX)(),(0,a.CE)("p",{class:"validation-error",key:e},(0,r.v_)(e),1)))),128))]))}var tn=n(782),nn=n(550),on=(0,a.pM)({name:"FileUpload",emits:["fileUploaded"],props:{accept:{type:String,required:!1,default:"image/*"}},data(){return{uploadRequestPromise:void 0,selectedFolderId:void 0,errors:[],uploadFolderName:"Lernmodule Uploads"}},async mounted(){const e=await(0,nn.aq)({userId:this.userId}),t=e.find((e=>e.attributes.name===this.uploadFolderName));if(t)console.log("Found",this.uploadFolderName,"folder."),this.selectedFolderId=t.id;else{console.log("Folder",this.uploadFolderName,"not found. Trying to create it under the user's root folder.");try{const t=e.find((e=>"RootFolder"===e.attributes["folder-type"]));if(!t){const e=(0,s.o_)("Das Stammverzeichnis des Benutzers konnte nicht gefunden werden. Es können keine Dateien hochgeladen werden.");return this.errors.push(e),void console.error(e)}t&&console.log("Found user root folder",t.attributes.name,"("+t.attributes["folder-type"]+")");const n=await(0,nn.vV)({userId:this.userId,name:this.uploadFolderName,parentFolderId:t.id,folderType:"PublicFolder"});n&&console.log("Created folder",n.attributes.name,"in folder",t.attributes.name),this.selectedFolderId=n.id}catch(n){const e=(0,s.o_)("Das Verzeichnis"+this.uploadFolderName+"konnte nicht erstellt werden. Es können keine Dateien hochgeladen werden.");this.errors.push(e),console.error(e,n)}}},computed:{...(0,tn.L8)({relatedFolders:"folders/related"}),userId(){return window.STUDIP.USER_ID},userObject(){return{type:"users",id:`${this.userId}`}},loadedUserFolders(){let e=[],t=this.relatedFolders({parent:this.userObject,relationship:"folders"})??[];return t.forEach((t=>{"PublicFolder"===t.attributes["folder-type"]&&e.push(t)})),e}},methods:{$gettext:s.o_,...(0,tn.i0)({_loadRelatedFolders:"folders/loadRelated"}),loadRelatedFolders(e){return this._loadRelatedFolders(e)},async getUserFolders(){const e=this.userObject,t="folders",n={"page[limit]":1e4};return await this.loadRelatedFolders({parent:e,relationship:t,options:n})},onInputChange(e){if(this.uploadRequestPromise)return void console.warn("FileUpload: onInputChange fired while uploadRequestPromise is already defined.");const t=this.$refs.fileInput,n=t.files?.item(0);if(n){if(!this.selectedFolderId){const e=(0,s.o_)("Kein Ordner ist ausgewählt. Die Datei kann nicht hochgeladen werden.");return console.error(e),void this.errors.push(e)}this.errors=[],this.uploadRequestPromise=(0,nn.x3)({file:{attributes:{name:n.name}},fileData:n,folder:{id:this.selectedFolderId}}).then((e=>{this.$emit("fileUploaded",e),this.uploadRequestPromise=void 0,this.errors=[]})).catch((e=>{console.error(e),this.errors.push(e),this.uploadRequestPromise=void 0}))}else console.warn("FileUpload: onInputChange fired, but input.files[] is empty.")}}});const sn=(0,v.A)(on,[["render",en]]);var an=sn;const ln=Symbol("Find The Hotspots Editor state"),rn=e=>((0,a.Qi)("data-v-4179f505"),e=e(),(0,a.jt)(),e),dn={class:"image-and-hotspots-container",ref:"root"},un=["id","onClick","onPointerdown","onPointermove","onPointerup"],cn=["onPointerdown","onPointermove","onPointerup"],pn={key:0,style:{flexBasis:"50%",flexGrow:0,flexShrink:0}},hn={key:1,style:{flexBasis:"50%",flexGrow:0,flexShrink:0}},mn={style:{display:"flex","margin-bottom":"0","align-items":"flex-start"}},kn={style:{display:"flex","margin-bottom":"0","align-items":"center"}},gn=["checked"],fn=["title"],vn=["value","title"],bn=rn((()=>(0,a.Lk)("div",{class:"arrow","data-popper-arrow":""},null,-1)));function wn(e,t,n,i,o,s){const d=(0,a.g2)("LazyImage");return(0,a.uX)(),(0,a.CE)("div",{class:(0,r.C4)(["image-and-hotspots-container-wrapper",{debug:e.debug}]),ref:"wrapper"},[(0,a.Lk)("div",dn,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.hotspots,(t=>((0,a.uX)(),(0,a.CE)("button",{key:t.uuid,type:"button",class:(0,r.C4)(["hotspot",{"invisible-hotspot":!e.editor,selected:e.editor?.selectedHotspotId.value===t.uuid}]),id:`hotspot-${e.uid}-${t.uuid}`,style:(0,r.Tr)(e.getHotspotStyle(t)),onClick:n=>e.onClickHotspot(n,t),onPointerdown:n=>e.onPointerdownHotspot(n,t),onPointermove:n=>e.onPointermoveHotspot(n,t),onPointerup:n=>e.onPointerupHotspot(n,t)},[e.editor?((0,a.uX)(!0),(0,a.CE)(a.FK,{key:0},(0,a.pI)(e.resizeHandles,(n=>((0,a.uX)(),(0,a.CE)("div",{key:n,class:(0,r.C4)(["resize-handle",n]),onPointerdown:(0,l.D$)((i=>e.onPointerdownResizeHandle(i,n,t)),["stop"]),onPointermove:(0,l.D$)((i=>e.onPointermoveResizeHandle(i,n,t)),["stop"]),onPointerup:(0,l.D$)((i=>e.onPointerupResizeHandle(i,n,t)),["stop"])},null,42,cn)))),128)):(0,a.Q3)("",!0)],46,un)))),128)),(0,a.bF)(d,{src:e.fileIdToUrl(e.image.file_id),alt:e.image.altText,onClick:e.onClickBackground,class:"hotspots-image"},null,8,["src","alt","onClick"])],512),e.debug&&e.editor?((0,a.uX)(),(0,a.CE)("pre",pn,(0,r.v_)({selectedHotspot:e.selectedHotspot,dragState:e.dragState}),1)):(0,a.Q3)("",!0),e.debug&&e.viewer?((0,a.uX)(),(0,a.CE)("pre",hn,(0,r.v_)({selectedHotspot:e.selectedHotspot,dragState:e.dragState}),1)):(0,a.Q3)("",!0),e.editor?((0,a.uX)(),(0,a.CE)("div",{key:2,ref:"selectedHotspotTooltip",class:(0,r.C4)(["selected-hotspot-tooltip",{hidden:!e.selectedHotspot}])},[(0,a.Lk)("div",mn,[(0,a.Lk)("label",kn,[(0,a.Lk)("input",{checked:e.selectedHotspot?.correct,type:"checkbox",onChange:t[0]||(t[0]=t=>e.editor.changeHotspotCorrectness(t.target.checked))},null,40,gn),(0,a.eW)(" "+(0,r.v_)(e.$gettext("Korrekt")),1)]),(0,a.Lk)("button",{type:"button",class:"small-button trash",style:{"margin-left":"auto"},onClick:t[1]||(t[1]=t=>e.editor.deleteSelectedHotspot()),title:e.$gettext("Diesen Hotspot löschen")},null,8,fn)]),(0,a.Lk)("label",null,[(0,a.eW)((0,r.v_)(e.$gettext("Feedback:"))+" ",1),(0,a.Lk)("input",{value:e.selectedHotspot?.feedback,onInput:t[2]||(t[2]=t=>e.editor.setHotspotFeedback(t.target.value)),type:"text",title:e.$gettext("Feedback bei Klick auf diesen Hotspot")},null,40,vn)]),bn],2)):(0,a.Q3)("",!0)],2)}const yn=["src","alt"],An={key:1,class:"placeholder"};function Tn(e,t,n,i,o,s){const l=(0,a.gN)("disable-drag");return e.isLoaded?(0,a.bo)(((0,a.uX)(),(0,a.CE)("img",(0,a.v6)({key:0,src:e.src,alt:e.alt,onLoad:t[0]||(t[0]=(...t)=>e.onLoad&&e.onLoad(...t)),onError:t[1]||(t[1]=(...t)=>e.onError&&e.onError(...t)),class:"lazy-image"},e.$attrs),null,16,yn)),[[l]]):((0,a.uX)(),(0,a.CE)("span",An))}var Cn=n(2859),En=(0,a.pM)({name:"LazyImage",props:{src:{type:String,required:!0},alt:{type:String,default:""}},watch:{src:function(){this.enqueueImageLoad()}},data(){return{isLoaded:!1}},methods:{onLoad(){console.log(`Image loaded: ${this.src}`)},onError(){console.error(`Failed to load image: ${this.src}`)},enqueueImageLoad(){Cn.OJ.enqueue((async()=>{try{const e=new Image;e.src=this.src,await new Promise(((t,n)=>{e.onload=()=>{t()},e.onerror=()=>n(new Error(`Failed to load image: ${this.src}`))})),this.isLoaded=!0}catch(e){console.error(e)}}))}},computed:{useLazyLoading(){return window.STUDIP.LernmoduleVueJS.LERNMODULE_LAZYLOADING}},mounted(){if(this.useLazyLoading){const e=window.innerHeight/2+"px",t=new IntersectionObserver((([e])=>{e.isIntersecting&&(this.enqueueImageLoad(),t.unobserve(e.target),t.disconnect())}),{rootMargin:e,threshold:.01});t.observe(this.$el)}else this.enqueueImageLoad()}});const Dn=(0,v.A)(En,[["render",Tn],["__scopeId","data-v-35ea3852"]]);var In=Dn;const Sn=Symbol("Find The Hotspots Viewer state");var xn=n(3221),Ln=(0,a.pM)({name:"ImageWithHotspots",components:{LazyImage:In},setup(){return{editor:(0,a.WQ)(ln,void 0),viewer:(0,a.WQ)(Sn,void 0)}},props:{hotspots:{type:Object,required:!0},image:{type:Object,required:!0}},data(){return{popperInstance:void 0,dragState:void 0}},computed:{debug(){return window.STUDIP.LernmoduleVueJS.LERNMODULE_DEBUG&&!1},uid(){return(0,i.A)()},selectedHotspot(){return this.hotspots.find((e=>e.uuid===this.editor?.selectedHotspotId.value))},resizeHandles(){return["left","top-left","top","top-right","right","bottom-right","bottom","bottom-left"]}},watch:{selectedHotspot:{immediate:!0,handler:function(e){this.popperInstance?.destroy(),e&&this.$nextTick((()=>{const t=document.getElementById(`hotspot-${this.uid}-${e.uuid}`),n=this.$refs.selectedHotspotTooltip;this.popperInstance=(0,xn.n4)(t,n,{placement:"top",modifiers:[{name:"offset",options:{offset:[0,14]}}]})}))}}},methods:{$gettext:s.o_,fileIdToUrl:Mp,onClickBackground(e){if(this.editor)this.editor?.selectHotspot(void 0);else if(this.viewer){const t=this.$refs.wrapper.getBoundingClientRect();let n=e.clientX-t.left,i=e.clientY-t.top;this.viewer.clickBackground(n,i)}},onClickHotspot(e,t){if(console.log("onClickHotspot",t),this.editor)this.editor?.selectHotspot(t.uuid);else if(this.viewer){const n=this.$refs.wrapper.getBoundingClientRect();let i=e.clientX-n.left,o=e.clientY-n.top;this.viewer.clickHotspot(t.uuid,i,o)}},onPointerdownHotspot(e,t){console.log("onPointerDownHotspot"),this.editor&&(this.editor.selectHotspot(t.uuid),this.dragState={type:"dragHotspot",hotspotId:t.uuid,dragId:(0,i.A)(),pointerStartPos:[e.clientX,e.clientY],hotspotStartPos:[t.x,t.y]},e.target.setPointerCapture(e.pointerId))},onPointerupHotspot(e,t){console.log("onPointerUpHotspot"),this.dragState=void 0,e.target.releasePointerCapture(e.pointerId)},onPointermoveHotspot(e,t){if("dragHotspot"===this.dragState?.type&&this.dragState.hotspotId===t.uuid){const t=this.$refs.root.getBoundingClientRect(),n=e.currentTarget,i=e.clientX-this.dragState.pointerStartPos[0],o=i/t.width,s=this.dragState.hotspotStartPos[0]+o,a=n.clientWidth/t.width,l=.05-a,r=.95,d=Math.min(r,Math.max(l,s)),u=e.clientY-this.dragState.pointerStartPos[1],c=u/t.height,p=this.dragState.hotspotStartPos[1]+c,h=n.clientHeight/t.height,m=.05-h,k=.95,g=Math.min(k,Math.max(m,p)),f=this.dragState.hotspotId;this.editor?.dragHotspot(this.dragState.dragId,f,d,g),this.popperInstance?.update()}},onPointerdownResizeHandle(e,t,n){console.log("onPointerDownResizeHandle"),this.editor&&(this.editor.selectHotspot(n.uuid),this.dragState={type:"resizeHotspot",dragId:(0,i.A)(),hotspotId:n.uuid,pointerStartPos:[e.clientX,e.clientY],hotspotStartPos:[n.x,n.y],hotspotStartSize:[n.width,n.height],handle:t},e.target.setPointerCapture(e.pointerId))},onPointerupResizeHandle(e,t,n){console.log("onPointerUpResizeHandle"),this.dragState=void 0,e.target.releasePointerCapture(e.pointerId)},onPointermoveResizeHandle(e,t,n){if("resizeHotspot"===this.dragState?.type&&this.dragState.hotspotId===n.uuid){const i=this.$refs.root.getBoundingClientRect(),{hotspotStartPos:[o,s],hotspotStartSize:[a,l]}=this.dragState;let r=o,d=a,u=s,c=l;const p=e.clientX-this.dragState.pointerStartPos[0],h=p/i.width,m=e.clientY-this.dragState.pointerStartPos[1],k=m/i.height;"left"===t||"top-left"===t||"bottom-left"===t?h>a?(r=o+a,d=h-a):(r=o+h,d=a-h):"right"!==t&&"top-right"!==t&&"bottom-right"!==t||(-h>a?(r=o+a+h,d=-h-a):(r=o,d=a+h)),"top-left"===t||"top"===t||"top-right"===t?k>l?(u=s+l,c=k-l):(u=s+k,c=l-k):"bottom-left"!==t&&"bottom"!==t&&"bottom-right"!==t||(-k>l?(u=s+l+k,c=-k-l):(u=s,c=l+k));let g=n.height,f=n.width,v=n.x,b=n.y;const w=c*i.height,y=d*i.width,A=20;w>A&&(g=c,b=u),y>A&&(f=d,v=r);const T=v>.95||v+f<.05,C=b>.95||b+g<.05;T&&(v=n.x,f=n.width),C&&(b=n.y,g=n.height),this.editor.resizeHotspot(this.dragState.dragId,n.uuid,v,b,f,g),this.popperInstance?.update()}},getHotspotStyle(e){return"rectangle"===e.type?{left:100*e.x+"%",top:100*e.y+"%",width:100*e.width+"%",height:100*e.height+"%"}:{left:100*e.x+"%",top:100*e.y+"%",width:100*e.width+"%",height:100*e.height+"%",borderRadius:"50%"}}}});const Bn=(0,v.A)(Ln,[["render",wn],["__scopeId","data-v-4179f505"]]);var Rn=Bn;const _n=e=>((0,a.Qi)("data-v-46a54772"),e=e(),(0,a.jt)(),e),Fn={class:"stud5p-task"},Mn={class:"default"},Pn={key:0,class:"find-the-hotspots-editor"},zn={class:"button-bar"},Wn=["title"],Un=_n((()=>(0,a.Lk)("svg",{width:"20",height:"20",viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg"},[(0,a.Lk)("rect",{x:"1",y:"1",width:"30",height:"30",fill:"none",stroke:"currentColor","stroke-width":"2px",rx:"2"})],-1))),Vn=[Un],Xn=["title"],On=_n((()=>(0,a.Lk)("svg",{width:"20",height:"20",viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg"},[(0,a.Lk)("circle",{cx:"16",cy:"16",r:"15",fill:"none",stroke:"currentColor","stroke-width":"2px"})],-1))),Qn=[On],Hn={key:1},jn={class:"collapsable collapsed"},Nn={style:{"margin-bottom":"0",width:"fit-content"}},$n={style:{display:"flex","align-items":"center",gap:"0.25em"}},Kn=["disabled","max"],Gn={style:{width:"fit-content"}},Jn={style:{display:"flex","align-items":"center",gap:"0.25em"}},qn=["disabled","min"],Yn={key:1},Zn={class:"collapsable collapsed"},ei={class:"collapsable collapsed"},ti={key:0,style:{flexBasis:"50%",flexGrow:0,flexShrink:0}};var ni=(0,a.pM)({props:{taskDefinition:{type:Object,required:!0}},setup(e){const t=e,n=(0,a.WQ)(u.c),o=window.STUDIP.LernmoduleVueJS.LERNMODULE_DEBUG,c=(0,d.KR)((0,m.cloneDeep)(t.taskDefinition)),p=(0,d.KR)(void 0),h=(0,d.KR)(!1),k=(0,d.KR)(null),g=(0,d.KR)(!1),f=(0,d.KR)(null),v=(0,d.KR)();(0,a.Gt)(ln,{selectedHotspotId:p,selectHotspot:M,deleteSelectedHotspot:B,changeHotspotCorrectness:_,setHotspotFeedback:F,dragHotspot:P,resizeHotspot:z});const b=(0,a.EW)((()=>c.value.hotspots.filter((e=>e.correct)).length)),w=(0,a.EW)((()=>c.value.hotspotsToFind)),y=(0,a.EW)((()=>c.value.allowedClicks));function A(e){console.log("update task definition"),n.performEdit({newTaskDefinition:(0,m.cloneDeep)(c.value),undoBatch:e??{}})}function T(){g.value?(f.value&&f.value>=(w.value?w.value:b.value)||(f.value=Math.max(w.value?w.value:b.value,1)),c.value=(0,S.Ay)(c.value,(e=>{e.allowedClicks=f.value}))):(f.value=null,c.value=(0,S.Ay)(c.value,(e=>{e.allowedClicks=0}))),A()}function C(){h.value?(k.value&&k.value<=b.value||(k.value=Math.max(b.value,1)),c.value=(0,S.Ay)(c.value,(e=>{e.hotspotsToFind=k.value?k.value:b.value}))):(k.value=null,c.value=(0,S.Ay)(c.value,(e=>{e.hotspotsToFind=0}))),A(),T()}function E(e){c.value=(0,S.Ay)(c.value,(t=>{t.image={uuid:(0,i.A)(),type:"image",file_id:e.id,altText:""}})),A()}function D(){const e=document.querySelector(".hotspots-image"),t=e?e.clientWidth:10,n=e?e.clientHeight:10;let o,s;const a=.3,l=t>n?"height":"width";if("height"===l){s=a;const e=s*n;o=e/t}else{o=a;const e=o*t;s=e/n}const r={uuid:(0,i.A)(),type:"rectangle",x:.5-o/2,y:.5-s/2,width:o,height:s,correct:!0,feedback:""};c.value=(0,S.Ay)(c.value,(e=>{e.hotspots.push(r)})),A(),M(r.uuid)}function I(){const e=document.querySelector(".hotspots-image"),t=e?e.clientWidth:10,n=e?e.clientHeight:10;let o,s;const a=.3,l=t>n?"height":"width";if("height"===l){s=a;const e=s*n;o=e/t}else{o=a;const e=o*t;s=e/n}const r={uuid:(0,i.A)(),type:"ellipse",x:.5-o/2,y:.5-s/2,width:o,height:s,correct:!0,feedback:""};c.value=(0,S.Ay)(c.value,(e=>{e.hotspots.push(r)})),A(),M(r.uuid)}function x(){c.value=(0,S.Ay)(c.value,(e=>{e.hotspots=[]})),A()}function L(){c.value=(0,S.Ay)(c.value,(e=>{e.image={type:"none"},e.hotspots=[]})),A()}function B(){p.value?R(p.value):console.error("Called deleteSelectedHotspot, but selectedHotspotId is undefined")}function R(e){c.value=(0,S.Ay)(c.value,(t=>{const n=t.hotspots.findIndex((t=>t.uuid===e));if(-1===n)throw new Error("No hotspot with id "+e+" found.");t.hotspots.splice(n,1)})),A()}function _(e){p.value?(c.value=(0,S.Ay)(c.value,(t=>{const n=t.hotspots.find((e=>e.uuid===p.value));n&&(n.correct=e)})),A()):console.error("Called deleteSelectedHotspot, but selectedHotspotId is undefined")}function F(e){console.log("setHotspotFeedback",e),p.value?(c.value=(0,S.Ay)(c.value,(t=>{const n=t.hotspots.find((e=>e.uuid===p.value));n&&(n.feedback=e)})),A("task.hotspots.feedback"+p.value)):console.error("Called setHotspotFeedback, but selectedHotspot is undefined")}function M(e){p.value=e}function P(e,t,n,i){c.value=(0,S.Ay)(c.value,(e=>{const o=e.hotspots.find((e=>e.uuid===t));if(!o)throw new Error(`Hotspot with id ${t} not found`);o.x=n,o.y=i})),A(e)}function z(e,t,n,i,o,s){c.value=(0,S.Ay)(c.value,(e=>{const a=e.hotspots.find((e=>e.uuid===t));if(!a)throw new Error(`Hotspot with id ${t} not found`);a.x=n,a.y=i,a.width=o,a.height=s})),A(e)}return(0,a.wB)((()=>t.taskDefinition),((e,t)=>{c.value=(0,m.cloneDeep)(e)}),{deep:!0}),(0,a.wB)(b,(e=>{h.value=!1,g.value=!1,C()})),(t,n)=>((0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.Lk)("div",Fn,[(0,a.Lk)("form",Mn,[(0,a.Lk)("fieldset",null,[(0,a.Lk)("legend",null,(0,r.v_)((0,d.R1)(s.o_)("Find the Hotspots")),1),"image"===e.taskDefinition.image.type?((0,a.uX)(),(0,a.CE)("div",Pn,[(0,a.Lk)("div",zn,[(0,a.Lk)("button",{onClick:D,type:"button",class:"hotspot-button",title:(0,d.R1)(s.o_)("Rechteckigen Hotspot hinzufügen")},Vn,8,Wn),(0,a.Lk)("button",{onClick:I,type:"button",class:"hotspot-button",title:(0,d.R1)(s.o_)("Runden Hotspot hinzufügen")},Qn,8,Xn),(0,a.Lk)("button",{onClick:x,type:"button",class:"hotspot-button"},(0,r.v_)((0,d.R1)(s.o_)("Alle Hotspots entfernen")),1),(0,a.Lk)("button",{onClick:L,type:"button",class:"hotspot-button"},(0,r.v_)((0,d.R1)(s.o_)("Bild löschen")),1)]),(0,a.bF)(Rn,{ref_key:"imageWithHotspotsRef",ref:v,hotspots:e.taskDefinition.hotspots,image:e.taskDefinition.image},null,8,["hotspots","image"])])):((0,a.uX)(),(0,a.CE)("label",Hn,[(0,a.eW)((0,r.v_)((0,d.R1)(s.o_)("Neues Bild hochladen"))+" ",1),(0,a.bF)(an,{onFileUploaded:E,accept:"image/*"})]))]),(0,a.Lk)("fieldset",jn,[(0,a.Lk)("legend",null,(0,r.v_)((0,d.R1)(s.o_)("Einstellungen")),1),(0,d.R1)(b)?((0,a.uX)(),(0,a.CE)(a.FK,{key:0},[(0,a.Lk)("label",Nn,[(0,a.Lk)("span",$n,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":n[0]||(n[0]=e=>h.value=e),onChange:C,type:"checkbox"},null,544),[[l.lH,h.value]]),(0,a.eW)(" "+(0,r.v_)((0,d.R1)(s.o_)("Anzahl zu findender Hotspots begrenzen auf:"))+" ",1),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":n[1]||(n[1]=e=>k.value=e),style:{"margin-bottom":"0.25em",width:"4em",padding:"0 0.25em 0 0.25em"},disabled:!h.value,class:(0,r.C4)({"setting-disabled":!h.value}),onChange:C,type:"number",min:1,max:(0,d.R1)(b)},null,42,Kn),[[l.Jo,k.value]])])]),(0,a.Lk)("label",Gn,[(0,a.Lk)("span",Jn,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":n[2]||(n[2]=e=>g.value=e),onChange:T,type:"checkbox"},null,544),[[l.lH,g.value]]),(0,a.eW)(" "+(0,r.v_)((0,d.R1)(s.o_)("Anzahl erlaubter Klicks begrenzen auf: "))+" ",1),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":n[3]||(n[3]=e=>f.value=e),style:{"margin-bottom":"0.25em",width:"4em",padding:"0 0.25em 0 0.25em"},disabled:!g.value,class:(0,r.C4)({"setting-disabled":!g.value}),onChange:T,type:"number",min:Math.max(c.value.hotspotsToFind?c.value.hotspotsToFind:(0,d.R1)(b),1)},null,42,qn),[[l.Jo,f.value]])])])],64)):((0,a.uX)(),(0,a.CE)("label",Yn,(0,r.v_)((0,d.R1)(s.o_)("Fügen Sie mindestens einen korrekten Hotspot hinzu.")),1))]),(0,a.Lk)("fieldset",Zn,[(0,a.Lk)("legend",null,(0,r.v_)((0,d.R1)(s.o_)("Beschriftungen")),1),(0,a.Lk)("label",null,[(0,a.eW)((0,r.v_)((0,d.R1)(s.o_)("Text für Wiederholen-Button:"))+" ",1),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":n[4]||(n[4]=e=>c.value.strings.retryButton=e),onInput:n[5]||(n[5]=e=>A("taskDefinition.strings.retryButton")),type:"text"},null,544),[[l.Jo,c.value.strings.retryButton]])])]),(0,a.Lk)("fieldset",ei,[(0,a.Lk)("legend",null,(0,r.v_)((0,d.R1)(s.o_)("Feedback")),1),(0,a.Lk)("label",null,[(0,a.eW)((0,r.v_)((0,d.R1)(s.o_)("Ergebnismitteilung (mögliche Variablen :correct und :total):"))+" ",1),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":n[6]||(n[6]=e=>c.value.strings.resultMessage=e),onInput:n[7]||(n[7]=e=>A("taskDefinition.strings.resultMessage")),type:"text"},null,544),[[l.Jo,c.value.strings.resultMessage]])]),(0,a.Lk)("label",null,[(0,a.eW)((0,r.v_)((0,d.R1)(s.o_)("Feedback, wenn in den leeren Bereich geklickt wurde:"))+" ",1),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":n[8]||(n[8]=e=>c.value.strings.feedbackWhenClickingBackground=e),onInput:n[9]||(n[9]=e=>A("taskDefinition.strings.feedbackWhenClickingBackground")),type:"text"},null,544),[[l.Jo,c.value.strings.feedbackWhenClickingBackground]])]),(0,a.Lk)("label",null,[(0,a.eW)((0,r.v_)((0,d.R1)(s.o_)("Feedback, wenn auf einen bereits gefundenen Hotspot geklickt wurde:"))+" ",1),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":n[10]||(n[10]=e=>c.value.strings.feedbackWhenClickingHotspotAgain=e),onInput:n[11]||(n[11]=e=>A("taskDefinition.strings.feedbackWhenClickingHotspotAgain")),type:"text"},null,544),[[l.Jo,c.value.strings.feedbackWhenClickingHotspotAgain]])])])])]),(0,d.R1)(o)?((0,a.uX)(),(0,a.CE)("pre",ti,(0,r.v_)({numberOfCorrectHotspots:(0,d.R1)(b),limitHotspotsToFind:h.value,hotspotsToFind:k.value,limitClicks:g.value,allowedClicks:f.value,numberOfClicksAllowed:(0,d.R1)(y),numberOfHotspotsToFind:(0,d.R1)(w)}),1)):(0,a.Q3)("",!0)],64))}});const ii=(0,v.A)(ni,[["__scopeId","data-v-46a54772"]]);var oi=ii;const si={class:"stud5p-task"},ai={style:{position:"relative"}},li={class:"feedback-and-button-container"},ri={class:"feedback-container"},di={class:"feedback-text"},ui={class:"button-panel"},ci=["textContent"];var pi=(0,a.pM)({props:{task:{type:Object,required:!0}},emits:["updateAttempt"],setup(e){const t=e;(0,a.Gt)(Sn,{clickHotspot:g,clickBackground:f}),(0,a.wB)((()=>t.task),(()=>{k()}),{deep:!0});const n=(0,d.KR)([]),i=(0,d.KR)(0),o=(0,d.KR)(0),s=(0,d.KR)([]),l=(0,a.EW)((()=>o.value>0)),u=(0,a.EW)((()=>t.task?.hotspotsToFind>0?t.task?.hotspotsToFind:t.task.hotspots.filter((e=>e.correct)).length)),c=(0,a.EW)((()=>t.task.allowedClicks>0?i.value<u.value&&o.value<t.task?.allowedClicks:i.value<u.value)),p=(0,a.EW)((()=>{let e=t.task.strings.resultMessage.replace(":correct",i.value.toString());return e=e.replace(":total",u.value.toString()),e})),h=(0,a.EW)((()=>n.value.at(-1)?.feedback)),m=(0,a.EW)((()=>!c.value));function k(){i.value=0,o.value=0,s.value=[],n.value=[]}function g(e,a,l){if(!c.value)return;if(console.log("Viewer: Clicked hotspot with id",e),!e)return void console.error("No id for clicked hotspot.");const r=t.task.hotspots.find((t=>t.uuid===e));if(r)if(s.value.includes(e)&&r.correct){const i=n.value.findIndex((t=>t.hotspot===e));if(-1!==i){const e=n.value[i];e.x=a,e.y=l,e.feedback=t.task.strings.feedbackWhenClickingHotspotAgain,n.value.splice(i,1),n.value.push(e)}}else{s.value?.push(e),o.value++,r.correct&&i.value++;const t={x:a,y:l,hotspot:e,correct:r.correct,feedback:r.feedback};n.value.push(t)}else console.error("No hotspot for given id:",e)}function f(e,i){if(!c.value)return;console.log("Viewer: Clicked background"),o.value++;const s={x:e,y:i,hotspot:"",correct:!1,feedback:t.task?.strings.feedbackWhenClickingBackground};n.value.push(s)}function v(){k()}return(t,o)=>((0,a.uX)(),(0,a.CE)("div",si,[(0,a.Lk)("div",ai,[(0,a.bF)(Rn,{hotspots:e.task.hotspots,image:e.task.image},null,8,["hotspots","image"]),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(n.value,((e,t)=>((0,a.uX)(),(0,a.CE)("span",{key:`${e.x}-${e.y}`,class:(0,r.C4)(["click-indicator",{pulse:t===n.value.length-1,correct:e.correct,incorrect:!e.correct}]),style:(0,r.Tr)({left:e.x-16+"px",top:e.y-16+"px"})},(0,r.v_)(e.correct?"✔":"✖"),7)))),128))]),(0,a.Lk)("div",li,[(0,a.Lk)("div",ri,[(0,d.R1)(l)?((0,a.uX)(),(0,a.Wv)(ie,{key:0,achievedPoints:i.value,maxPoints:(0,d.R1)(u),"result-message":(0,d.R1)(p)},null,8,["achievedPoints","maxPoints","result-message"])):(0,a.Q3)("",!0),(0,a.Lk)("div",di,(0,r.v_)((0,d.R1)(h)),1)]),(0,a.Lk)("div",ui,[(0,d.R1)(m)?((0,a.uX)(),(0,a.CE)("button",{key:0,textContent:(0,r.v_)(e.task.strings.retryButton),onClick:v,type:"button",class:"stud5p-button"},null,8,ci)):(0,a.Q3)("",!0)])])]))}});const hi=(0,v.A)(pi,[["__scopeId","data-v-bb237ee8"]]);var mi=hi;const ki={class:"stud5p-task"},gi=["textContent"],fi=["textContent"],vi={class:"collapsable collapsed"},bi={class:"collapsable collapsed"},wi={class:"collapsable collapsed"};var yi=(0,a.pM)({props:{taskDefinition:{type:Object,required:!0}},setup(e){const t=e,n=(0,a.WQ)(u.c),i=(window.STUDIP.LernmoduleVueJS.LERNMODULE_DEBUG,(0,d.KR)((0,m.cloneDeep)(t.taskDefinition))),o=(0,d.KR)(""),c=(0,d.KR)(i.value.words),p=(0,d.KR)(i.value.words),h=(0,d.KR)(""),k=(0,a.EW)((()=>t.taskDefinition?.words?t.taskDefinition.words.split(",").filter((e=>e.trim())).map((e=>e.trim().toUpperCase())):[]));function g(){o.value="",h.value=""}function f(e){let t=e.split(",").filter((e=>e.trim())).map((e=>e.trim().toUpperCase())),a=0;for(const n of t)n.length>a&&(a=n.length);const l=a>20,r=t.length>20;return l?(o.value=(0,s.o_)("Wörter dürfen nicht länger als 20 Zeichen sein."),void(c.value=p.value)):r?(o.value=(0,s.o_)("Es dürfen maximal 20 Wörter eingegeben werden."),void(c.value=p.value)):(o.value="",p.value=e,i.value=(0,S.Ay)(i.value,(t=>{t.words=e})),a>i.value.size&&(h.value="",i.value=(0,S.Ay)(i.value,(e=>{e.size=a}))),console.log("update task definition"),void n.performEdit({newTaskDefinition:(0,m.cloneDeep)(i.value)}))}function v(e){let t=0;for(const i of k.value)console.log(i,i.length),i.length>t&&(t=i.length);let n=Number(e);n>20&&(console.log(n),n=20),n<t?(n=t,h.value=(0,s.o_)("Minimum %{ characters } da ein Wort mit %{ characters } Zeichen existiert",{characters:n.toString()})):h.value="",i.value=(0,S.Ay)(i.value,(e=>{e.size=n})),A("size")}function b(e){i.value=(0,S.Ay)(i.value,(t=>{t.alphabet=e})),A("alphabet")}function w(){i.value=(0,S.Ay)(i.value,(e=>{e.alphabet="abcdefghijklmnopqrstuvwxyz"})),A()}function y(){i.value=(0,S.Ay)(i.value,(e=>{e.alphabet=Array.from(new Set(e.words.toLowerCase().replace(/[\s,]/g,"").split(""))).join("")})),A()}function A(e){console.log("update task definition"),n.performEdit({newTaskDefinition:(0,m.cloneDeep)(i.value),undoBatch:e??{}})}return(0,a.wB)((()=>t.taskDefinition),((e,t)=>{i.value=(0,m.cloneDeep)(e)}),{deep:!0}),(e,t)=>((0,a.uX)(),(0,a.CE)("div",ki,[(0,a.Lk)("form",{class:"default",onSubmit:t[26]||(t[26]=(0,l.D$)((()=>{}),["prevent"]))},[(0,a.Lk)("fieldset",null,[(0,a.Lk)("legend",null,(0,r.v_)((0,d.R1)(s.o_)("Find the Words")),1),(0,a.Lk)("label",null,[(0,a.eW)((0,r.v_)((0,d.R1)(s.o_)("Zu findende Wörter:"))+" ",1),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>c.value=e),onInput:t[1]||(t[1]=e=>f(e.target.value)),type:"text"},null,544),[[l.Jo,c.value]]),(0,a.Lk)("p",{textContent:(0,r.v_)(o.value)},null,8,gi)]),(0,a.Lk)("label",null,[(0,a.eW)((0,r.v_)((0,d.R1)(s.o_)("Feldgröße:"))+" ",1),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>i.value.size=e),onChange:t[3]||(t[3]=e=>v(e.target.value)),onBlur:t[4]||(t[4]=e=>g()),min:"6",max:"20",type:"number"},null,544),[[l.Jo,i.value.size]]),(0,a.Lk)("p",{textContent:(0,r.v_)(h.value)},null,8,fi)]),(0,a.Lk)("label",null,[(0,a.eW)((0,r.v_)((0,d.R1)(s.o_)("Zeichen, mit denen die Tafel aufgefüllt wird:"))+" ",1),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[5]||(t[5]=e=>i.value.alphabet=e),onInput:t[6]||(t[6]=e=>b(e.target.value)),type:"text"},null,544),[[l.Jo,i.value.alphabet]]),(0,a.Lk)("button",{type:"button",class:"button",style:{"white-space":"normal"},onClick:w},(0,r.v_)((0,d.R1)(s.o_)("Zurücksetzen auf A - Z")),1),(0,a.Lk)("button",{type:"button",class:"button",style:{"white-space":"normal"},onClick:y},(0,r.v_)((0,d.R1)(s.o_)("Buchstaben der Lösungswörter")),1)])]),(0,a.Lk)("fieldset",vi,[(0,a.Lk)("legend",null,(0,r.v_)((0,d.R1)(s.o_)("Einstellungen")),1),(0,a.Lk)("label",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[7]||(t[7]=e=>i.value.showWordList=e),onChange:A,type:"checkbox"},null,544),[[l.lH,i.value.showWordList]]),(0,a.eW)(" "+(0,r.v_)((0,d.R1)(s.o_)("Wortliste anzeigen")),1)]),(0,a.Lk)("fieldset",null,[(0,a.Lk)("legend",null,(0,r.v_)((0,d.R1)(s.o_)("Wortrichtungen")),1),(0,a.Lk)("label",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[8]||(t[8]=e=>i.value.directions.e=e),onChange:A,type:"checkbox"},null,544),[[l.lH,i.value.directions.e]]),(0,a.eW)(" "+(0,r.v_)((0,d.R1)(s.o_)("Horizontal nach rechts")),1)]),(0,a.Lk)("label",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[9]||(t[9]=e=>i.value.directions.w=e),onChange:A,type:"checkbox"},null,544),[[l.lH,i.value.directions.w]]),(0,a.eW)(" "+(0,r.v_)((0,d.R1)(s.o_)("Horizontal nach links")),1)]),(0,a.Lk)("label",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[10]||(t[10]=e=>i.value.directions.s=e),onChange:A,type:"checkbox"},null,544),[[l.lH,i.value.directions.s]]),(0,a.eW)(" "+(0,r.v_)((0,d.R1)(s.o_)("Vertikal nach unten")),1)]),(0,a.Lk)("label",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[11]||(t[11]=e=>i.value.directions.n=e),onChange:A,type:"checkbox"},null,544),[[l.lH,i.value.directions.n]]),(0,a.eW)(" "+(0,r.v_)((0,d.R1)(s.o_)("Vertikal nach oben")),1)]),(0,a.Lk)("label",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[12]||(t[12]=e=>i.value.directions.ne=e),onChange:A,type:"checkbox"},null,544),[[l.lH,i.value.directions.ne]]),(0,a.eW)(" "+(0,r.v_)((0,d.R1)(s.o_)("Diagonal nach oben rechts")),1)]),(0,a.Lk)("label",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[13]||(t[13]=e=>i.value.directions.se=e),onChange:A,type:"checkbox"},null,544),[[l.lH,i.value.directions.se]]),(0,a.eW)(" "+(0,r.v_)((0,d.R1)(s.o_)("Diagonal nach unten rechts")),1)]),(0,a.Lk)("label",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[14]||(t[14]=e=>i.value.directions.nw=e),onChange:A,type:"checkbox"},null,544),[[l.lH,i.value.directions.nw]]),(0,a.eW)(" "+(0,r.v_)((0,d.R1)(s.o_)("Diagonal nach oben links")),1)]),(0,a.Lk)("label",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[15]||(t[15]=e=>i.value.directions.sw=e),onChange:A,type:"checkbox"},null,544),[[l.lH,i.value.directions.sw]]),(0,a.eW)(" "+(0,r.v_)((0,d.R1)(s.o_)("Diagonal nach unten links")),1)])])]),(0,a.Lk)("fieldset",bi,[(0,a.Lk)("legend",null,(0,r.v_)((0,d.R1)(s.o_)("Beschriftungen")),1),(0,a.Lk)("label",null,[(0,a.eW)((0,r.v_)((0,d.R1)(s.o_)("Titel der Wortliste:"))+" ",1),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[16]||(t[16]=e=>i.value.strings.wordListTitle=e),onInput:t[17]||(t[17]=e=>A("taskDefinition.strings.wordListTitle")),type:"text"},null,544),[[l.Jo,i.value.strings.wordListTitle]])]),(0,a.Lk)("label",null,[(0,a.eW)((0,r.v_)((0,d.R1)(s.o_)("Text für Überprüfen-Button:"))+" ",1),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[18]||(t[18]=e=>i.value.strings.checkButton=e),onInput:t[19]||(t[19]=e=>A("taskDefinition.strings.checkButton")),type:"text"},null,544),[[l.Jo,i.value.strings.checkButton]])]),(0,a.Lk)("label",null,[(0,a.eW)((0,r.v_)((0,d.R1)(s.o_)("Text für Wiederholen-Button:"))+" ",1),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[20]||(t[20]=e=>i.value.strings.retryButton=e),onInput:t[21]||(t[21]=e=>A("taskDefinition.strings.retryButton")),type:"text"},null,544),[[l.Jo,i.value.strings.retryButton]])]),(0,a.Lk)("label",null,[(0,a.eW)((0,r.v_)((0,d.R1)(s.o_)("Text für Zeitanzeige:"))+" ",1),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[22]||(t[22]=e=>i.value.strings.timer=e),onInput:t[23]||(t[23]=e=>A("taskDefinition.strings.timer")),type:"text"},null,544),[[l.Jo,i.value.strings.timer]])])]),(0,a.Lk)("fieldset",wi,[(0,a.Lk)("legend",null,(0,r.v_)((0,d.R1)(s.o_)("Feedback")),1),(0,a.Lk)("label",null,[(0,a.eW)((0,r.v_)((0,d.R1)(s.o_)("Ergebnismitteilung (mögliche Variablen :correct und :total):"))+" ",1),(0,a.bo)((0,a.Lk)("input",{type:"text","onUpdate:modelValue":t[24]||(t[24]=e=>i.value.strings.resultMessage=e),onInput:t[25]||(t[25]=e=>A("taskDefinition.strings.resultMessage"))},null,544),[[l.Jo,i.value.strings.resultMessage]])])])],32)]))}});const Ai=yi;var Ti=Ai;const Ci=e=>((0,a.Qi)("data-v-6073d89c"),e=e(),(0,a.jt)(),e),Ei={class:"stud5p-task"},Di={class:"canvas-and-word-list-container"},Ii=["width","height"],Si={key:0,class:"word-list"},xi=["textContent"],Li=["title"],Bi={class:"time-container"},Ri=Ci((()=>(0,a.Lk)("span",null,"⏲",-1))),_i=["textContent"],Fi=["textContent"],Mi={class:"feedback-and-button-container"},Pi={class:"feedback-container"},zi={class:"button-panel"},Wi=["textContent"],Ui=["textContent"],Vi=["textContent"],Xi={key:1};var Oi=(0,a.pM)({props:{task:{type:Object,required:!0}},setup(e){const t=e,o=n(1293),u=(0,d.KR)(null);let c=[],p=[],h=[],m=[];const k=(0,d.KR)([]),g=(0,d.KR)(),f=(0,d.KR)(!1),v=(0,d.KR)(!1),b=(0,d.KR)(0);let w=!1,y=null;(0,a.sV)((()=>{X(),O(),document.addEventListener("pointerdown",$),document.addEventListener("pointerup",K)})),(0,a.xo)((()=>{document.removeEventListener("pointerdown",$),document.removeEventListener("pointerup",K)}));const A=(0,a.EW)((()=>t.task?.size)),T=(0,a.EW)((()=>42)),C=(0,a.EW)((()=>A.value*T.value)),E=(0,a.EW)((()=>t.task?.words?t.task.words.split(",").filter((e=>e.trim())).map((e=>e.trim().toUpperCase())):[])),D=(0,a.EW)((()=>{let e=[];return t.task?.directions&&(t.task.directions.n||e.push("N"),t.task.directions.ne||e.push("NE"),t.task.directions.e||e.push("E"),t.task.directions.se||e.push("SE"),t.task.directions.s||e.push("S"),t.task.directions.sw||e.push("SW"),t.task.directions.w||e.push("W"),t.task.directions.nw||e.push("NW")),e})),I=(0,a.EW)((()=>t.task?.alphabet?t.task.alphabet.toUpperCase().split("").filter((e=>e.match(/[0-9\p{L}]/u))):[])),S=(0,a.EW)((()=>k.value.length)),x=(0,a.EW)((()=>E.value.length)),L=(0,a.EW)((()=>S.value===x.value||f.value)),B=(0,a.EW)((()=>{let e=t.task.strings.resultMessage.replace(":correct",S.value.toString());return e=e.replace(":total",x.value.toString()),e})),R=(0,a.EW)((()=>!L.value));function _(){w=!0,y=setInterval((()=>{b.value++}),1e3)}function F(){null!==y&&(clearInterval(y),y=null),w=!1}function M(){f.value=!0,F()}function P(){f.value=!1,v.value=!1,b.value=0,m=[],F(),X(),O()}function z(){v.value=!0,O()}function W(){if(I.value.length>0){const e=Math.floor(Math.random()*I.value.length);return I.value[e]}return""}function U(){p=[];for(let e=0;e<A.value;e++){p[e]=[];for(let t=0;t<A.value;t++)p[e][t]=!1}}function V(){h=[];for(let e=0;e<A.value;e++){h[e]=[];for(let t=0;t<A.value;t++)h[e][t]=!1}}function X(){U(),V(),k.value=[],m=[];const e={cols:A.value,rows:A.value,disabledDirections:D.value,dictionary:E.value,maxWords:E.value.length,backwardsProbability:.3,upperCase:!0,diacritics:!0};let t=new o(e),n=1;while(t.words.length!==E.value.length&&n<=10)console.log("Es konnten nicht alle Wörter untergebracht werden. Versuche es bis zu 10 mal erneut:",n+". Versuch"),t=new o(e),n++;t.words.forEach((e=>{m.push(...e.path)})),c=[];for(let i=0;i<A.value;i++){c[i]=[];for(let e=0;e<A.value;e++)m.some((t=>t.x===i&&t.y===e))?c[i][e]=t.grid[e][i]:c[i][e]=W()}}function O(){const e=u.value;if(!e)return void console.error("No Canvas");const t=e.getContext("2d");if(t){t.clearRect(0,0,e.width,e.height),t.font="bold 26px calibri",t.textAlign="center",t.textBaseline="middle";for(let e=0;e<A.value;e++)for(let n=0;n<A.value;n++)h[e][n]&&Y(e,n,"#d4f6e6"),!v.value&&p[e][n]&&Y(e,n,"rgba(140, 180, 255, 0.34)"),v.value&&m.some((t=>t.x===e&&t.y===n))&&!h[e][n]&&Y(e,n,"rgba(140, 180, 255, 0.34)"),t.strokeStyle="gainsboro",t.strokeRect(e*T.value,n*T.value,T.value,T.value),t.fillStyle="#404040",t.fillText(c[e][n],e*T.value+T.value/2,n*T.value+T.value/2)}}function Q(e){if(!L.value)if(w||(console.log("Starting timer"),_()),g.value)G();else{const{cellX:t,cellY:n}=H(e);g.value={dragId:(0,i.A)(),startCell:[t,n],currentCell:[t,n],direction:void 0},U(),p[t][n]=!0,O()}}function H(e){const t=u.value,n=t.getBoundingClientRect(),i=e.clientX-n.left,o=e.clientY-n.top,s=Math.max(0,Math.min(Math.floor(i/T.value),A.value-1)),a=Math.max(0,Math.min(Math.floor(o/T.value),A.value-1));return{cellX:s,cellY:a}}function j(e){if(g.value){const{cellX:t,cellY:n}=H(e),i=ee(g.value.startCell[0],g.value.startCell[1],t,n);if(U(),p[g.value.startCell[0]][g.value.startCell[1]]=!0,"left"===i)for(let e=g.value.startCell[0];e>=t;e--)p[e][g.value.startCell[1]]=!0;else if("right"===i)for(let e=g.value.startCell[0];e<=t;e++)p[e][g.value.startCell[1]]=!0;else if("up"===i)for(let e=g.value.startCell[1];e>=n;e--)p[g.value.startCell[0]][e]=!0;else if("down"===i)for(let e=g.value.startCell[1];e<=n;e++)p[g.value.startCell[0]][e]=!0;else if("up-right"===i)for(let e=g.value.startCell[1];e>=n;e--){const t=g.value.startCell[0]-(e-g.value.startCell[1]);J(t,e)&&(p[t][e]=!0)}else if("up-left"===i)for(let e=g.value.startCell[1];e>=n;e--){const t=g.value.startCell[0]+(e-g.value.startCell[1]);J(t,e)&&(p[t][e]=!0)}else if("down-left"===i)for(let e=g.value.startCell[1];e<=n;e++){const t=g.value.startCell[0]-(e-g.value.startCell[1]);J(t,e)&&(p[t][e]=!0)}else if("down-right"===i)for(let e=g.value.startCell[1];e<=n;e++){const t=g.value.startCell[0]+(e-g.value.startCell[1]);J(t,e)&&(p[t][e]=!0)}g.value={dragId:g.value.dragId,startCell:g.value.startCell,currentCell:[t,n],direction:i},O()}}function N(e){if(g.value){const{cellX:t,cellY:n}=H(e);g.value.startCell[0]==t&&g.value.startCell[1]==n||G()}}function $(e){g.value&&G()}function K(e){g.value&&G()}function G(){const e=q(),t=e.split("").reverse().join("");console.log("Selected:",e,t);const n=E.value.includes(e)||E.value.includes(t);n&&Z();const i=!k.value.includes(e)&&!k.value.includes(t);n&&i&&(E.value.includes(e)?(console.log("Found:",e),k.value.push(e)):(console.log("Found:",t),k.value.push(t))),g.value=void 0,O()}function J(e,t){return!(e<0||e>=A.value||t<0||t>=A.value)}function q(){let e="";const t=g.value?.startCell,n=g.value?.currentCell,i=g.value?.direction;if(t&&n)if("left"===i)for(let o=t[0];o>=n[0];o--)e+=c[o][t[1]];else if("right"===i)for(let o=t[0];o<=n[0];o++)e+=c[o][t[1]];else if("up"===i)for(let o=t[1];o>=n[1];o--)e+=c[t[0]][o];else if("down"===i)for(let o=t[1];o<=n[1];o++)e+=c[t[0]][o];else if("up-left"===i)for(let o=0;o<=t[1]-n[1];o++){const n=t[0]-o,i=t[1]-o;if(!J(n,i))break;e+=c[n][i]}else if("up-right"===i)for(let o=0;o<=t[1]-n[1];o++){const n=t[0]+o,i=t[1]-o;if(!J(n,i))break;e+=c[n][i]}else if("down-left"===i)for(let o=0;o<=n[1]-t[1];o++){const n=t[0]-o,i=t[1]+o;if(!J(n,i))break;e+=c[n][i]}else if("down-right"===i)for(let o=0;o<=n[1]-t[1];o++){const n=t[0]+o,i=t[1]+o;if(!J(n,i))break;e+=c[n][i]}else e=c[t[0]][t[1]];return e}function Y(e,t,n){if(e<0||e>A.value-1||t<0||t>A.value-1)return;const i=u.value,o=i.getContext("2d");o&&(o.fillStyle=n,o.fillRect(e*T.value,t*T.value,T.value,T.value))}function Z(){for(let e=0;e<A.value;e++)for(let t=0;t<A.value;t++)h[e][t]||(h[e][t]=p[e][t]);U()}function ee(e,t,n,i){const o=n-e,s=i-t;if(0===o){if(s>0)return"down";if(s<0)return"up"}else{if(0!==s)return o>=1&&s>=1?"down-right":o<=-1&&s>=1?"down-left":o>=1&&s<=-1?"up-right":o<=-1&&s<=-1?"up-left":void 0;if(o>0)return"right";if(o<0)return"left"}}return(0,a.wB)((()=>t.task),(()=>{X(),O()}),{deep:!0}),(0,a.wB)((()=>L.value),(e=>{e&&F()})),(t,n)=>((0,a.uX)(),(0,a.CE)("div",Ei,[(0,d.R1)(E).length>0?((0,a.uX)(),(0,a.CE)(a.FK,{key:0},[(0,a.Lk)("div",Di,[(0,a.Lk)("canvas",{ref_key:"canvasRef",ref:u,width:(0,d.R1)(C),height:(0,d.R1)(C),onPointerdown:n[0]||(n[0]=(0,l.D$)((e=>Q(e)),["stop"])),onPointermove:n[1]||(n[1]=(0,l.D$)((e=>j(e)),["stop"])),onPointerup:n[2]||(n[2]=(0,l.D$)((e=>N(e)),["stop"]))},null,40,Ii),e.task.showWordList?((0,a.uX)(),(0,a.CE)("div",Si,[(0,a.Lk)("h2",{class:"word-list-title",textContent:(0,r.v_)(e.task.strings.wordListTitle)},null,8,xi),(0,a.Lk)("ul",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)((0,d.R1)(E),(e=>((0,a.uX)(),(0,a.CE)("li",{key:e,title:e,class:(0,r.C4)(["word",{"found-word":k.value.includes(e)}])},(0,r.v_)(e),11,Li)))),128))])])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",Bi,[Ri,(0,a.Lk)("span",{class:"time-info",textContent:(0,r.v_)(e.task.strings.timer)},null,8,_i),(0,a.Lk)("span",{textContent:(0,r.v_)(Math.floor(b.value/60)+":"+(b.value%60).toString().padStart(2,"0"))},null,8,Fi)]),(0,a.Lk)("div",Mi,[(0,a.Lk)("div",Pi,[(0,d.R1)(L)?((0,a.uX)(),(0,a.Wv)(ie,{key:0,achievedPoints:(0,d.R1)(S),maxPoints:(0,d.R1)(x),"result-message":(0,d.R1)(B)},null,8,["achievedPoints","maxPoints","result-message"])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",zi,[(0,d.R1)(R)?((0,a.uX)(),(0,a.CE)("button",{key:0,textContent:(0,r.v_)(e.task.strings.checkButton),onClick:M,type:"button",class:"stud5p-button"},null,8,Wi)):(0,a.Q3)("",!0),(0,d.R1)(L)?((0,a.uX)(),(0,a.CE)("button",{key:1,textContent:(0,r.v_)(e.task.strings.retryButton),onClick:P,type:"button",class:"stud5p-button"},null,8,Ui)):(0,a.Q3)("",!0),f.value&&!v.value?((0,a.uX)(),(0,a.CE)("button",{key:2,textContent:(0,r.v_)(e.task.strings.solutionsButton),onClick:z,type:"button",class:"stud5p-button"},null,8,Vi)):(0,a.Q3)("",!0)])])],64)):((0,a.uX)(),(0,a.CE)("div",Xi,(0,r.v_)((0,d.R1)(s.o_)("Fügen Sie Wörter hinzu um ein Find the Words Rätsel zu erstellen.")),1))]))}});const Qi=(0,v.A)(Oi,[["__scopeId","data-v-6073d89c"]]);var Hi=Qi;function ji(e,t,n,i,o,s){const l=(0,a.g2)("SelectVideo"),r=(0,a.g2)("TabComponent"),d=(0,a.g2)("AddInteractions"),u=(0,a.g2)("ConfigureTravisGo"),c=(0,a.g2)("TabsComponent");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)(c,null,{default:(0,a.k6)((()=>[(0,a.bF)(r,{title:e.$gettext("1. Video auswählen"),icon:"video2"},{default:(0,a.k6)((()=>[(0,a.bF)(l,{"task-definition":e.taskDefinition},null,8,["task-definition"])])),_:1},8,["title"]),(0,a.bF)(r,{title:e.$gettext("2. Interaktionen hinzufügen"),icon:"content"},{default:(0,a.k6)((()=>[(0,a.bF)(d,{"task-definition":e.taskDefinition},null,8,["task-definition"])])),_:1},8,["title"]),(0,a.bF)(r,{title:e.$gettext("3. Travis Go konfigurieren"),icon:"visibility-visible"},{default:(0,a.k6)((()=>[(0,a.bF)(u,{settings:e.taskDefinition.travisGoSettings,onUpdate:e.updateTravisGoSettings},null,8,["settings","onUpdate"])])),_:1},8,["title"])])),_:1}),(0,a.Q3)("",!0)],64)}const Ni=e=>((0,a.Qi)("data-v-571a793f"),e=e(),(0,a.jt)(),e),$i={key:0},Ki={style:{"white-space":"pre"}},Gi={ref:"videoJsContainer"},Ji=["onClick","title"],qi=["title"],Yi=["title"],Zi=["title"],eo=Ni((()=>(0,a.Lk)("div",{class:"arrow","data-popper-arrow":""},null,-1))),to={class:"active-interaction"};function no(e,t,n,i,o,s){const d=(0,a.g2)("LmbTaskInteraction"),u=(0,a.g2)("OverlayInteraction");return(0,a.uX)(),(0,a.CE)(a.FK,null,[e.errorLoadingVideo?((0,a.uX)(),(0,a.CE)("p",$i,[(0,a.eW)((0,r.v_)(e.$gettext("Das Video konnte nicht geladen werden. Grund: "))+" ",1),(0,a.Lk)("span",Ki,(0,r.v_)(e.errorLoadingVideo),1)])):(0,a.Q3)("",!0),(0,a.Lk)("div",{class:(0,r.C4)(["video-player-root",{"drag-in-progress":!!e.dragState}]),ref:"root"},[(0,a.Lk)("div",Gi,null,512),e.selectedInteractionId?((0,a.uX)(),(0,a.CE)("div",{key:0,class:"cancel-selection-overlay",onClick:t[0]||(t[0]=t=>e.editor.selectInteraction(void 0))})):(0,a.Q3)("",!0),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.task.interactions,(t=>((0,a.uX)(),(0,a.CE)("button",{class:"progress-bar-interaction-marker",key:t.id,style:(0,r.Tr)(e.progressBarInteractionMarkerStyle(t)),onClick:n=>e.onClickInteractionMarker(t),title:e.$gettext("Zu %{ interaction } springen",{interaction:e.printInteractionType(t)})},null,12,Ji)))),128)),e.editor?((0,a.uX)(),(0,a.CE)("div",{key:1,ref:"selectedInteractionTooltip",class:(0,r.C4)(["selected-interaction-tooltip",{hidden:!e.interactionForPopper}])},["lmbTask"===e.selectedInteraction?.type?((0,a.uX)(),(0,a.CE)("button",{key:0,type:"button",class:"small-button visibility-visible",onClick:t[1]||(t[1]=t=>e.activateInteraction(e.selectedInteraction)),title:e.$gettext("Vorschau")},null,8,qi)):(0,a.Q3)("",!0),(0,a.Lk)("button",{type:"button",class:"small-button edit",onClick:t[2]||(t[2]=t=>e.selectedInteraction&&e.editInteraction(e.selectedInteraction)),title:e.$gettext("Bearbeiten")},null,8,Yi),(0,a.Lk)("button",{type:"button",class:"small-button trash",onClick:t[3]||(t[3]=t=>e.selectedInteractionId&&e.editor?.deleteInteraction(e.selectedInteractionId)),title:e.$gettext("Löschen")},null,8,Zi),eo],2)):(0,a.Q3)("",!0),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.visibleInteractions,(t=>((0,a.uX)(),(0,a.CE)(a.FK,{key:t.id},["lmbTask"===t.type?((0,a.uX)(),(0,a.Wv)(d,{key:0,id:`interaction-${e.uid}-${t.id}`,class:"video-player-interaction",style:(0,r.Tr)({left:100*t.x+"%",top:100*t.y+"%"}),interaction:t,onClick:n=>e.editor?.selectInteraction(t.id),onPointerdown:n=>e.onPointerDownInteraction(n,t),onPointermove:n=>e.onPointerMoveInteraction(n,t),onPointerup:n=>e.onPointerUpInteraction(n,t),onActivateInteraction:e.activateInteraction},null,8,["id","style","interaction","onClick","onPointerdown","onPointermove","onPointerup","onActivateInteraction"])):"overlay"===t.type?((0,a.uX)(),(0,a.Wv)(u,{key:1,id:`interaction-${e.uid}-${t.id}`,class:"video-player-interaction",style:(0,r.Tr)({left:100*t.x+"%",top:100*t.y+"%",width:100*t.width+"%",height:100*t.height+"%"}),interaction:t,onClick:n=>e.editor?.selectInteraction(t.id),onPointerdown:n=>e.onPointerDownInteraction(n,t),onPointermove:n=>e.onPointerMoveInteraction(n,t),onPointerup:n=>e.onPointerUpInteraction(n,t),onPointerDownResizeHandle:e.onPointerDownResizeHandle,onPointerMoveResizeHandle:e.onPointerMoveResizeHandle,onPointerUpResizeHandle:e.onPointerUpResizeHandle},null,8,["id","style","interaction","onClick","onPointerdown","onPointermove","onPointerup","onPointerDownResizeHandle","onPointerMoveResizeHandle","onPointerUpResizeHandle"])):(0,a.Q3)("",!0)],64)))),128)),(0,a.bF)(l.eB,{name:"fade"},{default:(0,a.k6)((()=>["lmbTask"===e.activeInteraction?.type?((0,a.uX)(),(0,a.CE)("div",{key:0,class:"active-interaction-container",onClick:t[5]||(t[5]=(0,l.D$)(((...t)=>e.closeInteraction&&e.closeInteraction(...t)),["self"]))},[(0,a.Lk)("div",to,[(0,a.Lk)("h1",null,(0,r.v_)(e.printTaskType(e.activeInteraction.taskDefinition.task_type)),1),((0,a.uX)(),(0,a.Wv)((0,a.$y)(e.viewerForTaskType(e.activeInteraction.taskDefinition.task_type)),{task:e.activeInteraction.taskDefinition},null,8,["task"])),(0,a.Lk)("button",{type:"button",class:"button cancel",onClick:t[4]||(t[4]=(...t)=>e.closeInteraction&&e.closeInteraction(...t))},(0,r.v_)(e.$gettext("Schließen")),1)])])):(0,a.Q3)("",!0)])),_:1})],2)],64)}var io=n(3055),oo=(n(3456),n(4253));const so=o.z.object({type:o.z.literal("overlay"),id:o.z.string(),startTime:o.z.number(),endTime:o.z.number(),x:o.z.number(),y:o.z.number(),width:o.z.number(),height:o.z.number(),text:o.z.string(),pauseWhenVisible:o.z.boolean().optional().default(!0)}),ao=so.omit({text:!0}).extend({v:o.z.literal(2),content_wysiwyg:o.z.string()}),lo=o.z.union([so,ao]).transform((e=>{if(Object.hasOwn(e,"v"))return e;{const t=e,{text:n,...i}=t,o={v:2,content_wysiwyg:n,...i};return console.log("Migrating from overlaySchema_v1 to overlaySchema_v2","v1:",t,"v2:",o),o}})),ro=o.z.object({type:o.z.literal("lmbTask"),id:o.z.string(),startTime:o.z.number(),endTime:o.z.number(),x:o.z.number(),y:o.z.number(),taskDefinition:o.z.lazy((()=>Yp)),pauseWhenVisible:o.z.boolean().optional().default(!0)}),uo=o.z.union([lo,ro]).refine((e=>e.endTime>e.startTime),{message:"endTime cannot be earlier than startTime",path:["endTime"]}),co=o.z.object({type:o.z.literal("none")}),po=o.z.object({type:o.z.literal("youtube"),url:o.z.string()}),ho=o.z.object({type:o.z.literal("studipFileReference"),file:oo.zq}),mo=o.z.object({v:o.z.literal(2),type:o.z.literal("studipFileReference"),file_id:o.z.string()}),ko=o.z.union([ho,mo]).transform((e=>{if(Object.hasOwn(e,"v"))return e;{const t=e,n=new URLSearchParams(t.file.url),i=n.get("file_id");if(!i)throw new Error(`Could not migrate studip file reference schema v1 to v2. The query param "file_id" was not found in the string file.url: "${t.file.url}"`);const o={v:2,type:"studipFileReference",file_id:i};return console.log("Migrating from studipFileVideoSchema_v1 to studipFileVideoSchema_v2","v1:",t,"v2:",o),o}})),go=o.z.union([co,po,ko]),fo=o.z.object({enabled:o.z.boolean(),projectTitle:o.z.string(),projectDescription:o.z.string()}),vo=o.z.object({task_type:o.z.literal("InteractiveVideo"),video:go,autoplay:o.z.boolean().optional().default(!1),startAt:o.z.number().optional().default(0),disableNavigation:o.z.union([o.z.literal("not disabled"),o.z.literal("forward disabled"),o.z.literal("forward and backward disabled")]).default("not disabled"),interactions:o.z.array(uo),travisGoSettings:fo.optional().default((()=>({enabled:!1,projectTitle:"",projectDescription:""})))});function bo(e){switch(e.type){case"lmbTask":return oh(e.taskDefinition.task_type);case"overlay":return(0,s.o_)("Einblendung")}}function wo(e){switch(e.type){case"overlay":return"item";case"lmbTask":return ah(e.taskDefinition.task_type)}}const yo=o.z.object({mayEdit:o.z.boolean(),mayDelete:o.z.boolean()}),Ao=o.z.union([o.z.literal("meta"),o.z.literal("image"),o.z.literal("audio"),o.z.literal("text")]),To={video_id:o.z.string(),video_type:o.z.enum(["lernmodule_module","cw_blocks"]),start_time:o.z.coerce.number(),end_time:o.z.coerce.number().nullable(),contents:o.z.string(),post_type:Ao},Co=o.z.object({attributes:o.z.object({id:o.z.string(),mk_user_id:o.z.string(),mkdate:o.z.string().datetime({offset:!0}),chdate:o.z.string().datetime({offset:!0}),...To}),meta:o.z.object({permissions:yo})}),Eo=(o.z.object(To),o.z.object({id:o.z.string(),attributes:o.z.object({start_time:o.z.coerce.number(),end_time:o.z.coerce.number().nullable(),contents:o.z.string(),post_type:Ao})}),{post_id:o.z.string(),contents:o.z.string()}),Do=o.z.object({attributes:o.z.object({id:o.z.string(),mk_user_id:o.z.string(),mkdate:o.z.string().datetime({offset:!0}),chdate:o.z.string().datetime({offset:!0}),...Eo}),meta:o.z.object({permissions:yo})}),Io=(o.z.object({attributes:o.z.object(Eo)}),o.z.object({id:o.z.string(),attributes:o.z.object({contents:o.z.string()})}),Symbol("Interactive Video Editor state")),So=e=>((0,a.Qi)("data-v-75680916"),e=e(),(0,a.jt)(),e),xo=["data-hover-tooltip"],Lo={class:"interaction-label"},Bo=So((()=>(0,a.Lk)("div",{class:"icon-circle-border"},null,-1)));function Ro(e,t,n,i,o,s){return(0,a.uX)(),(0,a.CE)("button",{type:"button",class:(0,r.C4)(["lmb-task-interaction",{selected:e.editor?.selectedInteractionId.value===e.interaction.id,editor:!!e.editor}]),"data-hover-tooltip":e.printTaskType(e.interaction.taskDefinition.task_type),onClick:t[0]||(t[0]=t=>!this.editor&&e.$emit("activateInteraction",e.interaction))},[(0,a.Lk)("div",Lo,(0,r.v_)(e.printTaskType(e.interaction.taskDefinition.task_type)),1),Bo,(0,a.Lk)("div",{class:(0,r.C4)(["icon-circle button no-hover-effect",e.iconForTaskType(e.interaction.taskDefinition.task_type)])},null,2)],10,xo)}var _o=(0,a.pM)({name:"LmbTaskInteraction",methods:{iconForTaskType:ah,printTaskType:oh},setup(){return{editor:(0,a.WQ)(Io,void 0)}},props:{interaction:{type:Object,required:!0}}});const Fo=(0,v.A)(_o,[["render",Ro],["__scopeId","data-v-75680916"]]);var Mo=Fo;const Po=["data-hover-tooltip"],zo=["onPointerdown","onPointermove","onPointerup"],Wo=["innerHTML"];function Uo(e,t,n,i,o,s){return(0,a.uX)(),(0,a.CE)("div",{class:(0,r.C4)(["overlay",{selected:e.editor?.selectedInteractionId.value===e.interaction.id,editor:!!e.editor}]),"data-hover-tooltip":e.$gettext("Einblendung")},[e.editor?((0,a.uX)(!0),(0,a.CE)(a.FK,{key:0},(0,a.pI)(e.resizeHandles,(t=>((0,a.uX)(),(0,a.CE)("div",{key:t,class:(0,r.C4)(["resize-handle",t]),onPointerdown:(0,l.D$)((n=>e.onPointerDownResizeHandle(n,t)),["stop"]),onPointermove:(0,l.D$)((n=>e.onPointerMoveResizeHandle(n,t)),["stop"]),onPointerup:(0,l.D$)((n=>e.onPointerUpResizeHandle(n,t)),["stop"])},null,42,zo)))),128)):(0,a.Q3)("",!0),(0,a.Lk)("div",{class:"overlay-content",innerHTML:e.interaction.content_wysiwyg},null,8,Wo)],10,Po)}var Vo=(0,a.pM)({name:"OverlayInteraction",methods:{$gettext:s.o_,onPointerDownResizeHandle(e,t){this.$emit("pointerDownResizeHandle",{event:e,handle:t,interaction:this.interaction})},onPointerMoveResizeHandle(e,t){this.$emit("pointerMoveResizeHandle",{event:e,handle:t,interaction:this.interaction})},onPointerUpResizeHandle(e,t){this.$emit("pointerUpResizeHandle",{event:e,handle:t,interaction:this.interaction})}},setup(){return{editor:(0,a.WQ)(Io,void 0)}},data(){return{resizeHandles:["left","top-left","top","top-right","right","bottom-right","bottom","bottom-left"]}},props:{interaction:{type:Object,required:!0}}});const Xo=(0,v.A)(Vo,[["render",Uo],["__scopeId","data-v-69424511"]]);var Oo=Xo;let Qo;n(1027);var Ho=(0,a.pM)({name:"VideoPlayer",components:{OverlayInteraction:Oo,LmbTaskInteraction:Mo},setup(){return{editor:(0,a.WQ)(Io,void 0)}},props:{task:{type:Object,required:!0}},emits:{timeupdate(e){return!0},metadataChange(e){return!0}},data(){return{player:null,time:0,playedTime:0,isPlaying:!1,dragState:void 0,activeInteraction:void 0,progressBarParameters:{widthPixels:1,xOffsetPixels:0},progressBarObserver:void 0,videoInfoPromise:Promise.resolve({type:"none"}),errorLoadingVideo:void 0}},computed:{...(0,tn.L8)({fileRefById:"file-refs/byId"}),uid(){return(0,i.A)()},interactionForPopper(){return this.selectedInteraction&&this.visibleInteractions.includes(this.selectedInteraction)?this.selectedInteraction:void 0},selectedInteraction(){return this.task.interactions.find((e=>e.id===this.selectedInteractionId))},selectedInteractionId(){return this.editor?.selectedInteractionId.value},visibleInteractions(){return this.task.interactions.filter((e=>e.startTime<=this.time&&e.endTime>this.time))},timeAndVisibleInteractions(){return[this.time,this.visibleInteractions]}},watch:{"task.video":{handler(e){console.log("video prop changed",e),this.videoInfoPromise=this.loadVideoInfo(e),this.videoInfoPromise.catch((e=>{console.error("Error while loading video.",e),this.errorLoadingVideo=e})),this.videoInfoPromise.then((e=>{this.initializePlayer(e),this.errorLoadingVideo=void 0}))},immediate:!0},timeAndVisibleInteractions([e,t],[n,i]){const o=this.isPlaying&&e>n,s=t.find((e=>!i.includes(e)&&e.pauseWhenVisible));o&&s&&(console.log("pausing for interaction: ",s),this.player.pause())},interactionForPopper:{immediate:!0,handler:function(e){Qo?.destroy(),e&&this.$nextTick((()=>{const t=document.getElementById(`interaction-${this.uid}-${e.id}`),n=this.$refs.selectedInteractionTooltip;Qo=(0,xn.n4)(t,n,{placement:"top",modifiers:[{name:"offset",options:{offset:[0,8]}}]})}))}}},methods:{printInteractionType:bo,$gettext:s.o_,printTaskType:oh,viewerForTaskType:nh,...(0,tn.i0)({loadFileRef:"file-refs/loadById"}),onPlayerReady(){console.log("player ready")},async loadVideoInfo(e){switch(e.type){case"youtube":case"none":return e;case"studipFileReference":{await this.loadFileRef({id:e.file_id});const t=nn.ME.parse(this.fileRefById({id:e.file_id}));return{...e,mime_type:t.attributes["mime-type"],download_url:t.meta["download-url"]}}}},videoUrl(e){switch(e.type){case"youtube":return e.url;case"studipFileReference":return e.download_url;default:return""}},videoType(e){switch(e.type){case"youtube":return"video/youtube";case"studipFileReference":return e.mime_type;default:return""}},initializePlayer(e){if(!this.$refs.videoJsContainer)return void console.warn("initializePlayer called but $refs.videoJsContainer is undefined. Returning early without doing anything.");this.progressBarObserver?.disconnect(),this.player?.dispose();const t=document.createElement("video-js");t.classList.add("video-js","vjs-fluid"),this.$refs.videoJsContainer.appendChild(t),this.player=(0,io["default"])(t,{techOrder:["html5","youtube"],sources:[{src:this.videoUrl(e),type:this.videoType(e)}],controls:!0,controlBar:{children:["playToggle","progressControl","currentTimeDisplay","timeDivider","durationDisplay","volumePanel","fullscreenToggle"],volumePanel:{inline:!1}},autoplay:this.task.autoplay&&!this.editor,muted:this.task.autoplay&&!this.editor},this.onPlayerReady),this.player.on("timeupdate",(()=>{const e=this.player.currentTime();e&&(this.$emit("timeupdate",e),this.time=e,this.isPlaying&&!this.player.paused()&&(this.playedTime=Math.max(this.playedTime,e)))})),this.player.on("loadedmetadata",(()=>{this.playedTime=this.task.startAt,this.player.currentTime(this.task.startAt),this.task.autoplay&&!this.editor&&this.player.play(),this.$emit("metadataChange",{length:this.player.duration()??1})})),this.player.on("playing",(()=>{this.isPlaying=!0})),this.player.on(["waiting","pause"],(()=>{this.isPlaying=!1}));const n=()=>{"forward disabled"===this.task.disableNavigation?this.player.currentTime()-this.playedTime>.5&&this.player.currentTime(this.playedTime):"forward and backward disabled"===this.task.disableNavigation&&Math.abs(this.player.currentTime()-this.playedTime)>.5&&this.player.currentTime(this.playedTime)};this.player.on("seeking",(()=>{this.editor||n()})),this.player.on("seeked",(()=>{this.editor||n()}));const i=t.getElementsByClassName("vjs-progress-holder"),o=i.item(0);o?(this.progressBarObserver=new ResizeObserver((e=>{const t=this.$refs.root,n=t.getBoundingClientRect().x,i=o.getBoundingClientRect().x,s=i-n;this.progressBarParameters.xOffsetPixels=s,this.progressBarParameters.widthPixels=o.clientWidth})),this.progressBarObserver.observe(o)):console.error("no progress holder found")},activateInteraction(e){this.activeInteraction=e,this.player.pause()},closeInteraction(){this.activeInteraction=void 0},editInteraction(e){this.editor.editInteraction(e.id)},onPointerDownResizeHandle(e){if(!this.editor)return;const{event:t,handle:n,interaction:i}=e;this.editor.selectInteraction(i.id),this.dragState={type:"resizeInteraction",interactionId:i.id,mouseStartPos:[t.clientX,t.clientY],interactionStartPos:[i.x,i.y],interactionStartSize:[i.width,i.height],handle:n},t.target.setPointerCapture(t.pointerId)},onPointerUpResizeHandle(e){this.dragState=void 0,e.event.target.releasePointerCapture(e.event.pointerId)},onPointerMoveResizeHandle(e){const{event:t,handle:n,interaction:i}=e;if("resizeInteraction"===this.dragState?.type&&this.dragState.interactionId===i.id){const e=this.$refs.root.getBoundingClientRect(),{interactionStartPos:[o,s],interactionStartSize:[a,l]}=this.dragState;let r=o,d=a,u=s,c=l;const p=t.clientX/e.width,h=t.clientX-this.dragState.mouseStartPos[0],m=h/e.width,k=(t.clientY,e.height,t.clientY-this.dragState.mouseStartPos[1]),g=k/e.height;"left"===n||"top-left"===n||"bottom-left"===n?p>o+a?(r=o+a,d=p-r):(r=o+m,d=a-m):"right"!==n&&"top-right"!==n&&"bottom-right"!==n||(p<o?(r=p,d=o-p):(r=o,d=a+m)),"top-left"===n||"top"===n||"top-right"===n?g>l?(u=s+l,c=g-l):(u=s+g,c=l-g):"bottom-left"!==n&&"bottom"!==n&&"bottom-right"!==n||(-g>l?(u=s+l+g,c=-g-l):(u=s,c=l+g));let f=i.height,v=i.width,b=i.x,w=i.y;c>.05&&(f=c,w=u),d>.05&&(v=d,b=r);const y=b>.95||b+v<.05,A=w>.9||w+f<.05;y&&(b=i.x,v=i.width),A&&(w=i.y,f=i.height),this.editor.resizeOverlay(i.id,b,w,v,f,this.dragState),Qo?.update()}},onPointerDownInteraction(e,t){this.editor&&(this.editor.selectInteraction(t.id),this.dragState={type:"dragInteraction",interactionId:t.id,mouseStartPos:[e.clientX,e.clientY],interactionStartPos:[t.x,t.y]},e.target.setPointerCapture(e.pointerId))},onPointerUpInteraction(e,t){this.dragState=void 0,e.target.releasePointerCapture(e.pointerId)},onPointerMoveInteraction(e,t){if("dragInteraction"===this.dragState?.type&&this.dragState.interactionId===t.id){const t=this.$refs.root.getBoundingClientRect(),n=e.currentTarget,i=e.clientX-this.dragState.mouseStartPos[0],o=i/t.width,s=this.dragState.interactionStartPos[0]+o,a=n.clientWidth/t.width,l=.05-a,r=.95,d=Math.min(r,Math.max(l,s)),u=e.clientY-this.dragState.mouseStartPos[1],c=u/t.height,p=this.dragState.interactionStartPos[1]+c,h=n.clientHeight/t.height,m=.05-h,k=.9,g=Math.min(k,Math.max(m,p)),f=this.dragState.interactionId;this.editor?.dragInteraction(f,d,g,this.dragState),Qo?.update()}},progressBarInteractionMarkerStyle(e){const t=e.startTime/(this.player?.duration()??1),n=this.progressBarParameters.widthPixels*t;return{left:`calc(${this.progressBarParameters.xOffsetPixels}px +\n        ${n}px - 0.25em)`}},onClickInteractionMarker(e){this.editor?.selectInteraction(e.id);const t=()=>{const t=document.getElementById(`interaction-${this.uid}-${e.id}`);t.focus({focusVisible:!0})};this.visibleInteractions.includes(e)?t():this.player.one("seeked",(()=>{this.$nextTick(t)}));const n=.2,i=this.player.currentTime()-e.startTime;(i<0||i>n)&&this.player.currentTime(e.startTime+n/2)}},beforeUnmount(){this.progressBarObserver?.disconnect()}});const jo=(0,v.A)(Ho,[["render",no],["__scopeId","data-v-571a793f"]]);var No=jo;const $o={class:"tick-label"},Ko=["onClick","title"],Go={class:"timeline-interactions"},Jo=["title"],qo={class:"overflow-container"},Yo=["onClick","onPointerdown","onPointermove","onPointerup"],Zo={class:"timeline-interaction-label"},es=["title","onClick"],ts=["onPointerdown","onPointermove","onPointerup"],ns=["onPointerdown","onPointermove","onPointerup"],is={style:{"white-space":"pre-wrap",display:"none"}};function os(e,t,n,i,o,s){return(0,a.uX)(),(0,a.CE)("div",{ref:"root",class:"timeline-root",onDragoverCapture:t[6]||(t[6]=(...t)=>e.onDragOverTimeline&&e.onDragOverTimeline(...t))},[(0,a.Lk)("div",{class:"timeline-axis",ref:"timelineAxis",onPointerdown:t[1]||(t[1]=(...t)=>e.onPointerDownAxis&&e.onPointerDownAxis(...t))},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.axisScale,((t,n)=>((0,a.uX)(),(0,a.CE)("div",{class:"tick",key:n},[(0,a.Lk)("div",$o,(0,r.v_)(n%5===0?e.formatVideoTimestamp(t):" "),1),(0,a.Lk)("div",{class:(0,r.C4)(["tick-line",{major:n%5===0}])},null,2)])))),128)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.visibleInteractions,(n=>((0,a.uX)(),(0,a.CE)("button",{key:n.id,class:"interaction-marker",style:(0,r.Tr)(e.interactionMarkerStyle(n)),onPointerdown:t[0]||(t[0]=(0,l.D$)((()=>{}),["stop"])),onClick:(0,l.D$)((t=>{e.onClickInteraction(n),e.$emit("timelineSeek",n.startTime+.1)}),["stop"]),title:e.$gettext("Zu %{ interaction } springen",{interaction:e.printInteractionType(n)})},null,44,Ko)))),128))],544),(0,a.Lk)("div",{class:(0,r.C4)(["timeline",{"pan-timeline":"panTimeline"===this.dragState?.type}]),ref:"timeline",onPointerdown:t[3]||(t[3]=(0,l.D$)(((...t)=>e.onPointerDownAxis&&e.onPointerDownAxis(...t)),["self"])),onWheel:t[4]||(t[4]=(...t)=>e.onWheel&&e.onWheel(...t)),onContextmenu:t[5]||(t[5]=(0,l.D$)((()=>{}),["prevent"]))},[(0,a.Lk)("div",Go,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.visibleInteractions,(t=>((0,a.uX)(),(0,a.CE)("div",{key:t.id,class:(0,r.C4)(["timeline-interaction",{selected:e.selectedInteractionId===t.id}]),style:(0,r.Tr)(e.timelineInteractionStyle(t)),title:e.printInteractionType(t)},[(0,a.Lk)("div",qo,[(0,a.Lk)("button",{type:"button",class:(0,r.C4)(["button select-interaction",e.iconForInteraction(t)]),onClick:(0,l.D$)((n=>e.onClickInteraction(t)),["stop"]),onPointerdown:n=>e.onPointerDownInteraction(n,t),onPointermove:n=>e.onPointerMoveInteraction(n,t),onPointerup:n=>e.onPointerUpInteraction(n,t)},[(0,a.Lk)("span",Zo,(0,r.v_)(e.printInteractionType(t)),1)],42,Yo),t.endTime<e.viewportEnd?((0,a.uX)(),(0,a.CE)("button",{key:0,type:"button",class:"small-button trash delete-interaction",title:e.$gettext("Löschen"),onClick:n=>e.$emit("deleteInteraction",t.id)},null,8,es)):(0,a.Q3)("",!0)]),(0,a.Lk)("div",{class:"interaction-drag-handle start",onPointerdown:n=>e.onPointerDownInteractionStart(n,t),onPointermove:n=>e.onPointerMoveInteractionStart(n,t),onPointerup:n=>e.onPointerUpInteractionStart(n,t)},null,40,ts),(0,a.Lk)("div",{class:"interaction-drag-handle end",onPointerdown:n=>e.onPointerDownInteractionEnd(n,t),onPointermove:n=>e.onPointerMoveInteractionEnd(n,t),onPointerup:n=>e.onPointerUpInteractionEnd(n,t)},null,40,ns)],14,Jo)))),128))]),(0,a.Lk)("div",{class:"time-marker",draggable:"true",onDragstart:t[2]||(t[2]=(...t)=>e.onDragStartTimeMarker&&e.onDragStartTimeMarker(...t)),style:(0,r.Tr)({left:e.positionForTimeMarker})},null,36)],34),(0,a.Lk)("div",is,(0,r.v_)({zoomTransform:e.zoomTransform,viewportWidthEm:e.viewportWidthEm,viewportWidthSeconds:e.viewportWidthSeconds,viewportStart:e.viewportStart,viewportEnd:e.viewportEnd,dragState:e.dragState}),1)],544)}
/**
 * Get the equivalent EM value on a given element with a given pixel value.
 *
 * Normally the number of pixel specified should come from the element itself (e.g. element.style.height) since EM is
 * relative.
 *
 * @param {Object} element - The HTML element.
 * @param {Number} pixelValue - The number of pixel to convert in EM on this specific element.
 * @author Nicolas Bouvrette
 * @license CC BY-SA 3.0 https://stackoverflow.com/a/34540037/7359454
 * Adapted by Ann Yanich
 *
 * @returns {Boolean|undefined} The EM value, or undefined if unable to convert.
 */
function ss(e,t){if(e.parentNode){const n=parseFloat(window.getComputedStyle(e.parentNode).fontSize),i=parseFloat(window.getComputedStyle(e).fontSize),o=i/n*i;return t/o}}var as=n(9673),ls=n(2831);function rs(e,t=!0,n=";"){let i=0,o=0,s=0,a=0;while(e>=3600)i++,e-=3600;while(e>=60)o++,e-=60;while(e>=1)s++,e-=1;function l(e){return e.toLocaleString("de-DE",{minimumIntegerDigits:2,maximumFractionDigits:0})}a=Math.floor(100*e);const r=`${l(i)}${n}${l(o)}${n}${l(s)}`;if(t){const e=r.concat(`${n}${l(a)}`);return e}return r}var ds=(0,a.pM)({name:"VideoTimeline",setup(){return{editor:(0,a.WQ)(Io)}},props:{currentTime:{type:Number,required:!0},videoMetadata:{type:Object,required:!0},task:{type:Object,required:!0},selectedInteractionId:{type:String,required:!1}},data(){return{dragState:void 0,zoomTransform:{t:0,k:1},viewportWidthEm:1}},mounted(){const e=new IntersectionObserver((()=>this.recomputeViewportWidth()));e.observe(this.$refs.timelineAxis);const t=e=>{const t=this.pixelsToSeconds(e.dx),n=this.zoomTransform.t-t;this.zoomTransform.t=this.constrainZoomTranslate(n)},n=(0,ls.A)().filter((e=>0!==e.button)).on("start",(()=>{this.dragState={type:"panTimeline"}})).on("drag",t).on("end",(()=>{this.dragState=void 0}));(0,as.A)(this.$refs.timeline).call(n)},watch:{currentTime(e){(e<this.viewportStart||e>this.viewportEnd)&&(this.zoomTransform.t=this.constrainZoomTranslate(e-.5))}},computed:{visibleInteractions(){const e=[];for(let t of this.task.interactions){const n=t.startTime<this.viewportEnd&&t.endTime>this.viewportStart,i=("interaction"===this.dragState?.type||"interactionStart"===this.dragState?.type||"interactionEnd"===this.dragState?.type)&&this.dragState.id===t.id;(n||i)&&e.push(t)}return e},viewportWidthSeconds(){const e=.5/this.zoomTransform.k;return this.viewportWidthEm*e},viewportStart(){return this.zoomTransform.t},viewportEnd(){return this.viewportStart+this.viewportWidthSeconds},positionForTimeMarker(){return`${this.secondsToTimelinePercentage(this.currentTime)}%`},axisScale(){const e=25,t=this.viewportStart,n=this.viewportEnd,i=[];for(let o=0;o<e;o++)i.push(t+(n-t)/e*o);return i.push(n),i}},methods:{iconForInteraction:wo,printInteractionType:bo,$gettext:s.o_,secondsToTimelinePercentage(e){const t=e-this.viewportStart;return t/this.viewportWidthSeconds*100},interactionMarkerStyle(e){return{left:`${this.secondsToTimelinePercentage(e.startTime)}%`}},zoom(e,t){t||(t=(this.viewportStart+this.viewportEnd)/2);const n=this.zoomTransform.t,i=this.viewportWidthSeconds,o=Math.exp(e),s=this.zoomTransform.k*o;this.zoomTransform.k=Math.max(.005,Math.min(5,s));const a=this.viewportWidthSeconds,l=t-(t-n)/i*a;this.zoomTransform.t=this.constrainZoomTranslate(l)},onWheel(e){e.preventDefault();const t=this.xCoordinateToTime(e.clientX),n=-e.deltaY/1e3;this.zoom(n,t)},constrainZoomTranslate(e){return Math.max(0,Math.min(this.videoMetadata.length,e))},pixelsToEm(e){const t=this.$refs.timelineAxis;return t?ss(this.$refs.timelineAxis,e)??NaN:1},recomputeViewportWidth(){const e=this.$refs.timelineAxis;if(!e)return void console.warn("recomputeViewportWidth: timelineAxis is null");const t=e.getBoundingClientRect(),n=this.pixelsToEm(t.width);this.viewportWidthEm=n},formatVideoTimestamp:rs,pixelsToSeconds(e){const t=this.$refs.timelineAxis.getBoundingClientRect(),n=e/t.width;return n*this.viewportWidthSeconds},xCoordinateToTime(e){const t=this.$refs.timelineAxis.getBoundingClientRect(),n=e-t.left,i=n/t.width,o=this.viewportStart+i*this.viewportWidthSeconds,s=Math.min(this.videoMetadata.length,Math.max(0,o));return s},timelineInteractionStyle(e){const t=e.startTime-this.viewportStart,n=t/this.viewportWidthSeconds*100,i=e.endTime-this.viewportStart,o=i/this.viewportWidthSeconds*100;return{left:`${n}%`,width:o-n+"%"}},onClickInteraction(e){this.$emit("clickInteraction",e)},onPointerDownInteraction(e,t){if(0!==e.button)return;const n=t.endTime-t.startTime;this.dragState={type:"interaction",id:t.id,mouseStartPos:[e.clientX,e.clientY],interactionStartTime:t.startTime,interactionDuration:n},e.target.setPointerCapture(e.pointerId),this.editor.selectInteraction(t.id)},onPointerMoveInteraction(e,t){if("interaction"===this.dragState?.type&&this.dragState.id===t.id){const t=e.clientX-this.dragState.mouseStartPos[0],n=this.$refs.timelineAxis.getBoundingClientRect(),i=this.viewportWidthSeconds/n.width,o=t*i,s=this.dragState.interactionStartTime+o,a=this.videoMetadata.length-this.dragState.interactionDuration,l=Math.max(0,Math.min(a,s)),r=this.dragState.id;this.editor.dragInteractionTimeline(r,l,this.dragState)}},onPointerUpInteraction(e,t){this.dragState=void 0,e.target.releasePointerCapture(e.pointerId)},onPointerDownInteractionStart(e,t){this.dragState={type:"interactionStart",id:t.id,time:t.startTime},e.target.setPointerCapture(e.pointerId)},onPointerDownInteractionEnd(e,t){this.dragState={type:"interactionEnd",id:t.id,time:t.endTime},e.target.setPointerCapture(e.pointerId)},onPointerMoveInteractionStart(e,t){if("interactionStart"===this.dragState?.type&&this.dragState.id===t.id){const n=this.pixelsToSeconds(e.movementX);this.dragState.time+=n;const i=Math.max(0,Math.min(t.endTime-1,this.dragState.time));this.editor.resizeInteractionTimeline(t.id,"start",i,this.dragState)}},onPointerMoveInteractionEnd(e,t){if("interactionEnd"===this.dragState?.type&&this.dragState.id===t.id){const n=this.pixelsToSeconds(e.movementX);this.dragState.time+=n;const i=Math.max(t.startTime+1,Math.min(this.videoMetadata.length,this.dragState.time));this.editor.resizeInteractionTimeline(t.id,"end",i,this.dragState)}},onPointerUpInteractionStart(e,t){this.dragState=void 0,e.target.releasePointerCapture(e.pointerId)},onPointerUpInteractionEnd(e,t){this.dragState=void 0,e.target.releasePointerCapture(e.pointerId)},onPointerDownAxis(e){const t=this.xCoordinateToTime(e.clientX);this.$emit("timelineSeek",t)},onDragStartTimeMarker(e){this.dragState={type:"timeMarker"}},onDragOverTimeline(e){if("timeMarker"===this.dragState?.type){e.preventDefault();const t=this.xCoordinateToTime(e.clientX);this.emitTimelineSeekThrottled(t)}},emitTimelineSeekThrottled:(0,m.throttle)((function(e){this.$emit("timelineSeek",e)}),100)}});const us=(0,v.A)(ds,[["render",os],["__scopeId","data-v-7caf349f"]]);var cs=us;const ps={class:"selected-interaction-properties"},hs={key:0,class:"default"},ms={class:"collapsable"},ks={class:"start-and-end-time-inputs"};function gs(e,t,n,i,o,s){const d=(0,a.g2)("VideoTimeInput"),u=(0,a.g2)("StudipWysiwyg");return(0,a.uX)(),(0,a.CE)("div",ps,[(0,a.Lk)("h3",null,(0,r.v_)(e.$gettext("Interaktion"))+' "'+(0,r.v_)(e.printInteractionType(e.selectedInteraction))+'" ',1),e.selectedInteraction?((0,a.uX)(),(0,a.CE)("form",hs,[(0,a.Lk)("fieldset",ms,[(0,a.Lk)("legend",null,(0,r.v_)(e.$gettext("Einstellungen")),1),(0,a.Lk)("div",ks,[(0,a.Lk)("label",null,[(0,a.eW)((0,r.v_)(e.$gettext("Start"))+" ",1),(0,a.bF)(d,{modelValue:e.inputStartTime,"onUpdate:modelValue":t[0]||(t[0]=t=>e.inputStartTime=t),"onUpdate:error":t[1]||(t[1]=t=>e.inputStartTimeFormatError=t),class:(0,r.C4)(["time-input",{invalid:e.inputStartTimeErrors.length>0}]),"aria-invalid":e.inputStartTimeErrors.length>0},null,8,["modelValue","class","aria-invalid"])]),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.inputStartTimeErrors,(e=>((0,a.uX)(),(0,a.CE)("p",{class:"validation-error",key:e},(0,r.v_)(e),1)))),128)),(0,a.Lk)("label",null,[(0,a.eW)((0,r.v_)(e.$gettext("Ende"))+" ",1),(0,a.bF)(d,{modelValue:e.inputEndTime,"onUpdate:modelValue":t[2]||(t[2]=t=>e.inputEndTime=t),"onUpdate:error":t[3]||(t[3]=t=>e.inputEndTimeFormatError=t),class:(0,r.C4)(["time-input",{invalid:e.inputEndTimeErrors.length>0}]),"aria-invalid":e.inputEndTimeErrors.length>0},null,8,["modelValue","class","aria-invalid"])])]),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.inputEndTimeErrors,(e=>((0,a.uX)(),(0,a.CE)("p",{class:"validation-error",key:e},(0,r.v_)(e),1)))),128)),(0,a.Lk)("label",null,[(0,a.bo)((0,a.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[4]||(t[4]=t=>e.selectedInteraction.pauseWhenVisible=t)},null,512),[[l.lH,e.selectedInteraction.pauseWhenVisible]]),(0,a.eW)(" "+(0,r.v_)(e.$gettext("Video pausieren")),1)])])])):(0,a.Q3)("",!0),"overlay"===e.selectedInteraction.type?((0,a.uX)(),(0,a.Wv)(a.PR,{key:1},[(0,a.Lk)("div",null,[((0,a.uX)(),(0,a.Wv)(u,{key:`${e.selectedInteraction.id}-overlay-wysiwyg`,modelValue:e.selectedInteraction.content_wysiwyg,"onUpdate:modelValue":t[5]||(t[5]=t=>e.selectedInteraction.content_wysiwyg=t)},null,8,["modelValue"]))])],1024)):"lmbTask"===e.selectedInteraction.type?((0,a.uX)(),(0,a.CE)(a.FK,{key:2},[((0,a.uX)(),(0,a.Wv)(a.PR,null,[((0,a.uX)(),(0,a.Wv)((0,a.$y)(e.editorForTaskType(e.selectedInteraction.taskDefinition.task_type)),{key:`${e.selectedInteraction.id}-editor`,taskDefinition:e.selectedInteraction.taskDefinition},null,8,["taskDefinition"]))],1024)),e.showViewerAboveEditor(e.selectedInteraction.taskDefinition.task_type)?((0,a.uX)(),(0,a.CE)(a.FK,{key:0},[(0,a.Lk)("h3",null,(0,r.v_)(e.$gettext("Vorschau")),1),((0,a.uX)(),(0,a.Wv)(a.PR,null,[((0,a.uX)(),(0,a.Wv)((0,a.$y)(e.viewerForTaskType(e.selectedInteraction.taskDefinition.task_type)),{class:"lmb-task-preview",key:`${e.selectedInteraction.id}-viewer`,task:e.selectedInteraction.taskDefinition},null,8,["task"]))],1024))],64)):(0,a.Q3)("",!0)],64)):(0,a.Q3)("",!0)])}function fs(e,t,n,i,o,s){return(0,a.bo)(((0,a.uX)(),(0,a.CE)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=t=>e.userInput=t),onBlur:t[1]||(t[1]=(...t)=>e.onBlurUserInput&&e.onBlurUserInput(...t))},null,544)),[[l.Jo,e.userInput]])}var vs=(0,a.pM)({name:"VideoTimeInput",props:{modelValue:{type:Number,required:!0}},data(){return{userInput:""}},watch:{modelValue:{immediate:!0,handler(e){this.userInput=this.formatSeconds(e)}},parsedUserInput(){this.parsedUserInput instanceof Error?this.$emit("update:error",this.parsedUserInput):this.$emit("update:error",void 0)}},methods:{onBlurUserInput(){this.parsedUserInput instanceof Error?(this.userInput=this.formatSeconds(this.modelValue),this.$emit("update:error",void 0)):(this.$emit("update:modelValue",this.parsedUserInput),this.$emit("update:error",void 0))},formatSeconds(e){let t=0,n=0,i=0,o=0;while(e>=3600)e-=3600,t+=1;while(e>=60)e-=60,n+=1;while(e>=1)e-=1,i+=1;function s(e){return e.toLocaleString("de-DE",{minimumIntegerDigits:2,maximumFractionDigits:0})}o=Math.floor(100*e);let a=`${s(t)};${s(n)};${s(i)};${s(o)}`;return a}},computed:{parsedUserInput(){const e=/^(\d?\d)[;:](\d?\d)[;:](\d?\d)[;:](\d?\d)$/,t=e.exec(this.userInput);if(t)return 3600*parseInt(t[1])+60*parseInt(t[2])+parseInt(t[3])+parseInt(t[4])/100;const n=/^(?:(?:([0-9]?\d)[;:])?([0-5]?\d)[:;])?([0-5]?\d)$/,i=n.exec(this.userInput);return i&&4===i.length?i[1]?3600*parseInt(i[1])+60*parseInt(i[2])+parseInt(i[3]):i[2]?60*parseInt(i[2])+parseInt(i[3]):parseInt(i[3]):new Error((0,s.o_)("Die Startposition muss der Syntax HH;MM;SS oder HH;MM;SS;SS entsprechen."))}}});const bs=(0,v.A)(vs,[["render",fs]]);var ws=bs,ys=(0,a.pM)({name:"SelectedInteractionProperties",components:{VideoTimeInput:ws,StudipWysiwyg:_e.A},setup(){return{editor:(0,a.WQ)(Io)}},props:{selectedInteraction:{type:Object,required:!0}},data(){return{inputStartTime:0,inputStartTimeFormatError:void 0,inputEndTime:1,inputEndTimeFormatError:void 0}},methods:{showViewerAboveEditor:sh,viewerForTaskType:nh,$gettext:s.o_,printInteractionType:bo,editorForTaskType:ih},watch:{inputStartTime(e){0===this.inputStartTimeErrors.length&&(this.selectedInteraction.startTime=e),0===this.inputEndTimeErrors.length&&(this.selectedInteraction.endTime=this.inputEndTime)},"selectedInteraction.startTime":{handler:function(e){this.inputStartTime=e},immediate:!0},inputEndTime(e){0===this.inputEndTimeErrors.length&&(this.selectedInteraction.endTime=e,0===this.inputStartTimeErrors.length&&(this.selectedInteraction.startTime=this.inputStartTime))},"selectedInteraction.endTime":{handler:function(e){this.inputEndTime=e},immediate:!0}},computed:{inputStartTimeErrors(){const e=[];return this.inputStartTimeFormatError&&e.push(this.inputStartTimeFormatError.message),this.inputStartTime<0&&e.push((0,s.o_)("Das eingegebene Wert muss größer als 0 sein.")),this.inputStartTime>=this.selectedInteraction.endTime&&e.push((0,s.o_)("Der Startpunkt muss vor dem Endpunkt sein.")),e},inputEndTimeErrors(){const e=[];return this.inputEndTimeFormatError&&e.push(this.inputEndTimeFormatError.message),this.inputEndTime<0&&e.push((0,s.o_)("Das eingegebene Wert muss größer als 0 sein.")),this.inputEndTime<=this.selectedInteraction.startTime&&e.push((0,s.o_)("Der Startpunkt muss vor dem Endpunkt sein.")),e}}});const As=(0,v.A)(ys,[["render",gs],["__scopeId","data-v-1c1c37d6"]]);var Ts=As;const Cs={forbiddenToNestInteractiveVideos:(0,s.o_)("Es ist nicht erlaubt, ein Interactive Video in ein anderes Interactive Video einzufügen."),notAnOverlayError:(0,s.o_)("Die ausgeführte Aktion ist nur für Overlay-Elemente gültig."),interactionNotFoundError:(0,s.o_)("Es wurde keine Interaktion mit der angegebenen ID gefunden."),postCouldNotBeParsedError:(0,s.o_)("Dieser Post konnte nicht geladen werden."),couldNotLoadPostsError:(0,s.o_)("Die Posts unter dem Video konnten nicht geladen werden."),couldNotSendPostError:(0,s.o_)("Ihr Post konnte nicht gepostet werden."),postTypeTooltip:(0,s.o_)("Fokus, worauf sich der Post im Video bezieht")};var Es=Cs;const Ds={class:"add-interactions-root"},Is={class:"toolbar-under-video"},Ss={class:"insert-interactions-buttons"},xs=["title"],Ls=["onClick","title"],Bs={class:"video-controls"},Rs=["title"],_s=["title"],Fs=["title"],Ms=["title"];var Ps=(0,a.pM)({props:{taskDefinition:{type:Object,required:!0}},setup(e){const t=e,n=(0,d.KR)(0),o=(0,d.KR)({length:1}),l=(0,d.KR)(void 0),c=(0,d.KR)(void 0),p=(0,d.KR)(void 0),h=(0,d.KR)(void 0),k=["DragTheWords","FillInTheBlanks","FindTheHotspots","FindTheWords","MarkTheWords","Memory","Pairing","Question","Sequencing"];(0,a.Gt)(Io,{selectInteraction:b,selectedInteractionId:l,editInteraction:w,dragInteraction:R,resizeOverlay:_,deleteInteraction:B,dragInteractionTimeline:F,resizeInteractionTimeline:M}),(0,a.Gt)(u.c,{performEdit:f});const g=(0,a.WQ)(u.c);function f(e){const n=(0,S.Ay)(t.taskDefinition,(t=>{const n=t.interactions.findIndex((e=>e.id===l.value));if(-1===n)throw new Error("cant find selected interaction in interactions array");const i=t.interactions[n];if("lmbTask"!==i.type)throw new Error("Selected interaction is not of type lmbTask");i.taskDefinition=e.newTaskDefinition})),i=(0,m.isEqual)(e.undoBatch,{})?{}:{type:"editedLmbInteractionTask",interactionId:l.value,undoBatch:e.undoBatch};g.performEdit({newTaskDefinition:n,undoBatch:i})}const v=(0,a.EW)((()=>t.taskDefinition.interactions.find((e=>e.id===l.value))));function b(e){l.value=e}function w(e){l.value=e,(0,a.dY)((()=>{const e=h.value?.$el;e.scrollIntoView({behavior:"smooth",block:"start"})}))}function y(e){o.value=e}function A(e){n.value=e}function T(e){c.value.player.currentTime(e)}function C(){p.value.zoom(.18)}function E(){p.value.zoom(-.18)}function D(){c.value.player.play()}function I(){c.value.player.pause()}function x(){const e={type:"overlay",v:2,id:(0,i.A)(),startTime:n.value,endTime:Math.min(o.value.length,n.value+10),x:.4,y:.4,width:.2,height:.2,content_wysiwyg:(0,s.o_)("Einblendung"),pauseWhenVisible:!0};g.performEdit({newTaskDefinition:(0,S.Ay)(t.taskDefinition,(t=>{t.interactions.push(e)}))}),l.value=e.id}function L(e){if("InteractiveVideo"===e)throw new Error(Es.forbiddenToNestInteractiveVideos);const s=th(e),a={type:"lmbTask",id:(0,i.A)(),taskDefinition:s,startTime:n.value,endTime:Math.min(o.value.length,n.value+10),x:.5,y:.5,pauseWhenVisible:!0};g.performEdit({newTaskDefinition:(0,S.Ay)(t.taskDefinition,(e=>{e.interactions.push(a)}))}),l.value=a.id}function B(e){console.log("deleteInteraction",e);const n=t.taskDefinition.interactions.find((t=>t.id===e));if(!n)throw new Error(Es.interactionNotFoundError);const i=(0,s.o_)("%{ interaction } löschen",{interaction:bo(n)}),o=window.confirm(i);if(!o)return void console.info("Delete prompt canceled by user");const a=t.taskDefinition.interactions.findIndex((t=>t.id===e));if(-1===a)throw new Error(Es.interactionNotFoundError);g.performEdit({newTaskDefinition:(0,S.Ay)(t.taskDefinition,(e=>{e.interactions.splice(a,1)}))})}function R(e,n,i,o){g.performEdit({newTaskDefinition:(0,S.Ay)(t.taskDefinition,(t=>{const o=t.interactions.find((t=>t.id===e));if(!o)throw new Error(`Interaction with id ${e} not found`);o.x=n,o.y=i})),undoBatch:o})}function _(e,n,i,o,s,a){g.performEdit({newTaskDefinition:(0,S.Ay)(t.taskDefinition,(t=>{const a=t.interactions.find((t=>t.id===e));if(!a)throw new Error(`Interaction with id ${e} not found`);if("overlay"!==a.type)throw new Error(Es.notAnOverlayError);a.x=n,a.y=i,a.width=o,a.height=s})),undoBatch:a})}function F(e,n,i){g.performEdit({newTaskDefinition:(0,S.Ay)(t.taskDefinition,(t=>{const i=t.interactions.find((t=>t.id===e));if(!i)throw new Error(`Interaction with id ${e} not found`);const o=i.endTime-i.startTime;i.endTime=n+o,i.startTime=n})),undoBatch:i})}function M(e,n,i,o){g.performEdit({newTaskDefinition:(0,S.Ay)(t.taskDefinition,(t=>{const o=t.interactions.find((t=>t.id===e));if(!o)throw new Error(`Interaction with id ${e} not found`);"start"===n?o.startTime=i:o.endTime=i})),undoBatch:o})}return(t,i)=>((0,a.uX)(),(0,a.CE)("div",Ds,[(0,a.bF)(No,{ref_key:"videoPlayer",ref:c,task:e.taskDefinition,onTimeupdate:A,onMetadataChange:y,onClickInteraction:i[0]||(i[0]=e=>b(e.id))},null,8,["task"]),(0,a.Lk)("div",Is,[(0,a.Lk)("div",Ss,[(0,a.Lk)("button",{type:"button",class:"button item",onClick:x,title:(0,d.R1)(s.o_)("%{ interactionType } einfügen",{interactionType:(0,d.R1)(s.o_)("Einblendung")})},null,8,xs),((0,a.uX)(),(0,a.CE)(a.FK,null,(0,a.pI)(k,(e=>(0,a.Lk)("button",{key:e,type:"button",class:(0,r.C4)(["button",(0,d.R1)(ah)(e)]),onClick:t=>L(e),title:(0,d.R1)(s.o_)("%{ interactionType } einfügen",{interactionType:(0,d.R1)(oh)(e)})},null,10,Ls))),64))]),(0,a.Lk)("div",Bs,[(0,a.Lk)("button",{type:"button",class:"button zoom-in",title:(0,d.R1)(s.o_)("Vergrößern"),onClick:C},null,8,Rs),(0,a.Lk)("button",{type:"button",class:"button zoom-out",title:(0,d.R1)(s.o_)("Verkleinern"),onClick:E},null,8,_s),(0,a.Lk)("button",{type:"button",class:"button play",title:(0,d.R1)(s.o_)("Abspielen"),onClick:D},null,8,Fs),(0,a.Lk)("button",{type:"button",class:"button pause",title:(0,d.R1)(s.o_)("Pausieren"),onClick:I},null,8,Ms)])]),(0,a.bF)(cs,{class:"video-timeline",ref_key:"videoTimeline",ref:p,task:e.taskDefinition,currentTime:n.value,videoMetadata:o.value,selectedInteractionId:l.value,onTimelineSeek:T,onClickInteraction:i[1]||(i[1]=e=>b(e.id)),onDeleteInteraction:B},null,8,["task","currentTime","videoMetadata","selectedInteractionId"]),((0,a.uX)(),(0,a.Wv)(a.PR,null,[(0,d.R1)(v)?((0,a.uX)(),(0,a.Wv)(Ts,{ref_key:"selectedInteractionProperties",ref:h,selectedInteraction:(0,d.R1)(v),key:(0,d.R1)(v).id},null,8,["selectedInteraction"])):(0,a.Q3)("",!0)],1024))]))}});const zs=(0,v.A)(Ps,[["__scopeId","data-v-39de7364"]]);var Ws=zs;const Us=e=>((0,a.Qi)("data-v-a420e4fa"),e=e(),(0,a.jt)(),e),Vs={class:"picker"},Xs={class:"default"},Os=Us((()=>(0,a.Lk)("br",null,null,-1))),Qs={class:"bottom-actions"},Hs={class:"default"},js={class:"bottom-actions"},Ns={key:1,class:"video-preview"},$s={key:0},Ks=["href"],Gs={key:1},Js=["href"],qs={class:"video-preview-actions"},Ys={class:"form default"},Zs=Us((()=>(0,a.Lk)("button",{type:"submit",disabled:"",style:{display:"none"},"aria-hidden":"true"},null,-1))),ea={class:"start-at-setting"},ta={class:"start-at-setting-flex"},na={key:0,class:"errors"};function ia(e,t,n,i,o,s){const d=(0,a.g2)("FileUpload"),u=(0,a.g2)("FilePicker"),c=(0,a.g2)("VideoPlayer"),p=(0,a.g2)("VideoTimeInput");return(0,a.uX)(),(0,a.CE)(a.FK,null,["none"===e.taskDefinition.video.type?((0,a.uX)(),(0,a.CE)(a.FK,{key:0},[(0,a.Lk)("p",null,(0,r.v_)(e.$gettext("Lade ein Video hoch oder füge einen Link zu einem Youtube-Video ein.")),1),(0,a.Lk)("div",Vs,[(0,a.Lk)("form",Xs,[(0,a.Lk)("fieldset",null,[(0,a.Lk)("legend",null,(0,r.v_)(e.$gettext("Stud.IP-Video")),1),(0,a.Lk)("label",null,[(0,a.eW)((0,r.v_)(e.$gettext("Neues Video hochladen"))+" ",1),Os,(0,a.bF)(d,{onFileUploaded:e.onUploadStudipVideo,accept:"video/*"},null,8,["onFileUploaded"])]),(0,a.Lk)("label",null,[(0,a.eW)((0,r.v_)(e.$gettext("Vorhandenes Video auswählen"))+" ",1),(0,a.bF)(u,{modelValue:e.selectedFileId,"onUpdate:modelValue":t[0]||(t[0]=t=>e.selectedFileId=t),"is-video":"",onSelectFile:e.updateCurrentFile},null,8,["modelValue","onSelectFile"])]),(0,a.Lk)("div",Qs,[(0,a.Lk)("button",{type:"button",class:"button accept",onClick:t[1]||(t[1]=(...t)=>e.onSaveUploadedFile&&e.onSaveUploadedFile(...t))},(0,r.v_)(e.$gettext("Übernehmen")),1)])])]),(0,a.Lk)("form",Hs,[(0,a.Lk)("fieldset",null,[(0,a.Lk)("legend",null,(0,r.v_)(e.$gettext("Youtube-Video")),1),(0,a.Lk)("label",null,[(0,a.eW)((0,r.v_)(e.$gettext("Youtube-URL"))+" ",1),(0,a.bo)((0,a.Lk)("input",{class:"youtube-url-input",type:"text","onUpdate:modelValue":t[2]||(t[2]=t=>e.youtubeUrlInput=t)},null,512),[[l.Jo,e.youtubeUrlInput]])]),(0,a.Lk)("div",js,[(0,a.Lk)("button",{type:"submit",class:"button accept",onClick:t[3]||(t[3]=(...t)=>e.onSaveYoutubeVideo&&e.onSaveYoutubeVideo(...t))},(0,r.v_)(e.$gettext("Übernehmen")),1)])])])])],64)):(0,a.Q3)("",!0),"none"!==e.taskDefinition.video.type?((0,a.uX)(),(0,a.CE)("div",Ns,[(0,a.bF)(c,{ref:"videoPlayer",task:e.taskDefinition,class:"video-player",onTimeupdate:e.onTimeUpdate},null,8,["task","onTimeupdate"]),"youtube"===e.taskDefinition.video.type?((0,a.uX)(),(0,a.CE)("p",$s,[(0,a.eW)((0,r.v_)(e.$gettext("Youtube-Video: "))+" ",1),(0,a.Lk)("a",{href:e.taskDefinition.video.url,target:"_blank"},(0,r.v_)(e.taskDefinition.video.url),9,Ks)])):"studipFileReference"===e.taskDefinition.video.type?((0,a.uX)(),(0,a.CE)("p",Gs,[(0,a.eW)((0,r.v_)(e.$gettext("Hochgeladenes Video: "))+" ",1),(0,a.Lk)("a",{href:e.fileDetailsUrl(e.taskDefinition.video.file_id),target:"_blank"},[e.selectedFile?((0,a.uX)(),(0,a.CE)(a.FK,{key:0},[(0,a.eW)((0,r.v_)(e.selectedFile.name),1)],64)):((0,a.uX)(),(0,a.CE)(a.FK,{key:1},[(0,a.eW)((0,r.v_)(e.taskDefinition.video.file_id),1)],64))],8,Js)])):(0,a.Q3)("",!0),(0,a.Lk)("div",qs,[(0,a.Lk)("button",{class:"button trash",onClick:t[4]||(t[4]=(...t)=>e.deleteVideo&&e.deleteVideo(...t))},(0,r.v_)(e.$gettext("Video löschen")),1)])])):(0,a.Q3)("",!0),(0,a.Lk)("form",Ys,[Zs,(0,a.Lk)("fieldset",null,[(0,a.Lk)("legend",null,(0,r.v_)(e.$gettext("Einstellungen")),1),(0,a.Lk)("label",null,[(0,a.bo)((0,a.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[5]||(t[5]=t=>e.modelTaskDefinition.autoplay=t),onInput:t[6]||(t[6]=(...t)=>e.updateTaskDefinition&&e.updateTaskDefinition(...t))},null,544),[[l.lH,e.modelTaskDefinition.autoplay]]),(0,a.eW)(" "+(0,r.v_)(e.$gettext("Automatisch abspielen")),1)]),(0,a.Lk)("div",ea,[(0,a.Lk)("div",ta,[(0,a.Lk)("label",null,[(0,a.eW)((0,r.v_)(e.$gettext("Anfangen um"))+" ",1),(0,a.bF)(p,{class:(0,r.C4)({invalid:!!e.startPositionInputError}),"aria-invalid":!!e.startPositionInputError,modelValue:e.modelTaskDefinition.startAt,"onUpdate:modelValue":t[7]||(t[7]=t=>e.modelTaskDefinition.startAt=t),onInput:t[8]||(t[8]=t=>e.updateTaskDefinition("inputStartAt")),"onUpdate:error":t[9]||(t[9]=t=>e.startPositionInputError=t)},null,8,["class","aria-invalid","modelValue"])]),(0,a.Lk)("button",{type:"button",class:"button",onClick:t[10]||(t[10]=(...t)=>e.onClickUseCurrentTime&&e.onClickUseCurrentTime(...t))},(0,r.v_)(e.$gettext("Aktuelle Position setzen")),1)]),e.startPositionInputError?((0,a.uX)(),(0,a.CE)("div",na,(0,r.v_)(e.startPositionInputError),1)):(0,a.Q3)("",!0)]),(0,a.Q3)("",!0)])])],64)}const oa={class:"cw-file-chooser"},sa={value:""},aa=(0,a.eW)("Keine Auswahl"),la=["value"],ra={disabled:""},da=(0,a.eW)("Keine Dateien vorhanden");function ua(e,t,n,i,o,s){const d=(0,a.g2)("FolderPicker"),u=(0,a.g2)("translate");return(0,a.uX)(),(0,a.CE)("div",oa,[(0,a.Lk)("label",null,[(0,a.eW)((0,r.v_)(e.$gettext("Ordner-Filter"))+" ",1),(0,a.bF)(d,{allowUserFolders:"",unchoose:"",modelValue:e.selectedFolderId,"onUpdate:modelValue":t[0]||(t[0]=t=>e.selectedFolderId=t)},null,8,["modelValue"])]),(0,a.Lk)("label",null,[(0,a.eW)((0,r.v_)(e.$gettext("Datei"))+" ",1),(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t[1]||(t[1]=t=>e.currentValue=t),onChange:t[2]||(t[2]=(...t)=>e.selectFile&&e.selectFile(...t))},[(0,a.bo)((0,a.Lk)("option",sa,[(0,a.bF)(u,null,{default:(0,a.k6)((()=>[aa])),_:1})],512),[[l.aG,e.canBeEmpty]]),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.files,((e,t)=>((0,a.uX)(),(0,a.CE)("option",{key:t,value:e.id},(0,r.v_)(e.name),9,la)))),128)),(0,a.bo)((0,a.Lk)("option",ra,[(0,a.bF)(u,null,{default:(0,a.k6)((()=>[da])),_:1})],512),[[l.aG,0===e.files.length]])],544),[[l.u1,e.currentValue]])])])}const ca={key:0,value:""},pa=(0,a.eW)("kein Ordner ausgewählt"),ha=["label"],ma=["value"],ka=["label"],ga=["value"];function fa(e,t,n,i,o,s){const d=(0,a.g2)("translate");return(0,a.bo)(((0,a.uX)(),(0,a.CE)("select",{"onUpdate:modelValue":t[0]||(t[0]=t=>e.currentValue=t),onChange:t[1]||(t[1]=(...t)=>e.changeSelection&&e.changeSelection(...t))},[e.unchoose?((0,a.uX)(),(0,a.CE)("option",ca,[(0,a.bF)(d,null,{default:(0,a.k6)((()=>[pa])),_:1})])):(0,a.Q3)("",!0),"courses"===e.context.type?((0,a.uX)(),(0,a.CE)("optgroup",{key:1,label:e.textOptGroupCourse},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.loadedCourseFolders,(e=>((0,a.uX)(),(0,a.CE)("option",{key:e.id,value:e.id},(0,r.v_)(e.attributes.name),9,ma)))),128))],8,ha)):(0,a.Q3)("",!0),e.allowUserFolders?((0,a.uX)(),(0,a.CE)("optgroup",{key:2,label:e.textOptGroupUser},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.loadedUserFolders,(e=>((0,a.uX)(),(0,a.CE)("option",{key:e.id,value:e.id},(0,r.v_)(e.attributes.name),9,ga)))),128))],8,ka)):(0,a.Q3)("",!0)],544)),[[l.u1,e.currentValue]])}function va(e,{allowHomeworkFolders:t}){const n=new Map;return e.filter((e=>{if(i(e))switch(e.attributes["folder-type"]){case"HiddenFolder":if(1===e.attributes["data-content"]["download_allowed"])return!0;break;case"HomeworkFolder":if(t)return!0;break;default:return!0}}));function i(t){let i=!0;if(t?.relationships?.parent){let s=t.relationships.parent.data.id;if(n.has(s))i=n.get(s);else{let t=e.find((e=>e.id===s));t&&(i=o(t),n.set(s,i))}}return i}function o(e){return"HiddenFolder"!==e.attributes["folder-type"]&&(!e?.relationships?.parent||i(e))}}var ba=(0,a.pM)({name:"FolderPicker",props:{value:{type:String,required:!1,default:""},allowUserFolders:{type:Boolean,default:!1},allowHomeworkFolders:{type:Boolean,default:!1},unchoose:{type:Boolean,default:!1}},data(){return{currentValue:"",textOptGroupCourse:this.$gettext("Dateibereich dieser Veranstaltung"),textOptGroupUser:this.$gettext("Persönlicher Dateibereich")}},computed:{...(0,tn.L8)({relatedFolders:"folders/related"}),context(){return Cn.Nl.studipContext},userId(){return window.STUDIP.USER_ID},courseObject(){return{type:"courses",id:`${this.context.id}`}},userObject(){return{type:"users",id:`${this.userId}`}},loadedCourseFolders(){return va(this.relatedFolders({parent:this.courseObject,relationship:"folders"})??[],{allowHomeworkFolders:this.allowHomeworkFolders})},loadedUserFolders(){let e=[],t=this.relatedFolders({parent:this.userObject,relationship:"folders"})??[];return t.forEach((t=>{"PublicFolder"===t.attributes["folder-type"]&&e.push(t)})),e}},methods:{...(0,tn.i0)({_loadRelatedFolders:"folders/loadRelated"}),loadRelatedFolders(e){return this._loadRelatedFolders(e)},changeSelection(){this.$emit("input",this.currentValue)},getCourseFolders(){const e=this.courseObject,t="folders",n={"page[limit]":1e4};return this.loadRelatedFolders({parent:e,relationship:t,options:n})},getUserFolders(){const e=this.userObject,t="folders",n={"page[limit]":1e4};return this.loadRelatedFolders({parent:e,relationship:t,options:n})},confirmSelectedFolder(){const e=this.loadedUserFolders.concat(this.loadedCourseFolders);let t=e.find((e=>e.id===this.currentValue));""!==this.currentValue&&void 0===t&&(this.currentValue="",this.changeSelection())}},async mounted(){if(this.currentValue=this.value,"users"!==this.context.type)try{await this.getCourseFolders()}catch(e){console.error("Error loading course folders: ",e)}try{await this.getUserFolders()}catch(e){console.error("Error loading user folders: ",e)}this.confirmSelectedFolder()},watch:{value(){this.currentValue=this.value}}});const wa=(0,v.A)(ba,[["render",fa]]);var ya=wa,Aa=(0,a.pM)({name:"FilePicker",components:{FolderPicker:ya},props:{value:String,mimeType:{type:String,default:""},isImage:{type:Boolean,default:!1},isVideo:{type:Boolean,default:!1},isAudio:{type:Boolean,default:!1},isDocument:{type:Boolean,default:!1},canBeEmpty:{type:Boolean,default:!1}},data(){return{currentValue:"",selectedFolderId:"",files:[]}},computed:{...(0,tn.L8)({fileRefById:"file-refs/byId",relatedFileRefs:"file-refs/related",relatedTermOfUse:"terms-of-use/related"}),userId(){return window.STUDIP.USER_ID}},methods:{$gettext:s.o_,...(0,tn.i0)({loadFileRef:"file-refs/loadById",loadRelatedFileRefs:"file-refs/loadRelated"}),selectFile(){this.$emit("selectFile",this.files.find((e=>e.id===this.currentValue)))},filterFiles(e){const t=e=>{let t=this.relatedTermOfUse({parent:e,relationship:"terms-of-use"});if(null!==t&&0!==t.attributes["download-condition"])return!1;if(""!==this.mimeType&&this.mimeType!==e.attributes["mime-type"])return!1;if(this.isImage&&!e.attributes["mime-type"].includes("image"))return!1;const n=["video/mp4","video/ogg","video/webm"];if(this.isVideo&&!n.some((t=>e.attributes["mime-type"].includes(t))))return!1;const i=["audio/wav","audio/ogg","audio/webm","audio/flac","audio/mpeg","audio/x-m4a","audio/mp4"];if(this.isAudio&&!i.some((t=>e.attributes["mime-type"].includes(t))))return!1;const o=["application/pdf"];return!(this.isDocument&&!o.some((t=>e.attributes["mime-type"].includes(t))))};return e.filter(t).map((e=>({id:e.id,name:e.attributes.name,mime_type:e.attributes["mime-type"],download_url:window.STUDIP.URLHelper.getURL("sendfile.php",{type:0,file_id:e.id,file_name:e.attributes.name},!0)})))},async getFolderFiles(){const e={type:"folders",id:`${this.selectedFolderId}`},t="file-refs",n={include:"terms-of-use","page[limit]":1e4};await this.loadRelatedFileRefs({parent:e,relationship:t,options:n});const i=this.relatedFileRefs({parent:e,relationship:t});this.files=this.filterFiles(i)}},async mounted(){if(console.log("mounted"),this.value){try{await this.loadFileRef({id:this.value})}catch(e){return void console.error("loadfileRef threw an error. File picker will not be initialized to show the selected file.",e)}const t=this.fileRefById({id:this.value});t&&(this.selectedFolderId=t.relationships.parent.data.id,this.currentValue=this.value??"")}},watch:{selectedFolderId(){""!==this.selectedFolderId&&this.getFolderFiles()},value(e,t){""===e&&(this.selectedFolderId="",this.currentValue="")}}});const Ta=(0,v.A)(Aa,[["render",ua]]);var Ca=Ta,Ea=(0,a.pM)({name:"SelectVideo",props:{taskDefinition:{type:Object,required:!0}},setup(){return{taskEditor:(0,a.WQ)(u.c)}},data(){return{modelTaskDefinition:(0,m.cloneDeep)(this.taskDefinition),youtubeUrlInput:"",startPositionInputError:void 0,currentTime:0,selectedFolderId:"",selectedFile:void 0,selectedFileId:""}},watch:{taskDefinition:{immediate:!0,handler:function(){this.modelTaskDefinition=(0,m.cloneDeep)(this.taskDefinition)}},"taskDefinition.video":{immediate:!0,handler:async function(e){switch(e.type){case"none":break;case"studipFileReference":if(void 0===this.selectedFile||this.selectedFile.id!==e.file_id){await this.loadFileRef({id:e.file_id});const t=nn.ME.parse(this.fileRefById({id:e.file_id}));this.selectedFile={id:e.file_id,name:t.attributes.name,mime_type:t.attributes["mime-type"],download_url:t.meta["download-url"]}}break;case"youtube":this.youtubeUrlInput=e.url}}}},computed:{...(0,tn.L8)({fileRefById:"file-refs/byId"})},methods:{fileDetailsUrl:Pp,fileIdToUrl:Mp,$gettext:s.o_,...(0,tn.i0)({loadFileRef:"file-refs/loadById"}),updateTaskDefinition(e){this.taskEditor.performEdit({newTaskDefinition:(0,m.cloneDeep)(this.modelTaskDefinition),undoBatch:e??{}})},onTimeUpdate(e){this.currentTime=e},onClickUseCurrentTime(){this.modelTaskDefinition.startAt=this.currentTime,this.updateTaskDefinition("inputStartAt")},updateCurrentFile(e){this.selectedFile=e,this.selectedFileId=e.id},onSaveYoutubeVideo(){this.modelTaskDefinition.video={type:"youtube",url:this.youtubeUrlInput},this.updateTaskDefinition()},onSaveUploadedFile(){if(!this.selectedFile)throw new Error("No selected file");this.modelTaskDefinition.video={v:2,type:"studipFileReference",file_id:this.selectedFile.id},this.updateTaskDefinition()},deleteVideo(){this.modelTaskDefinition.video={type:"none"},this.updateTaskDefinition()},onUploadStudipVideo(e){this.modelTaskDefinition.video={v:2,type:"studipFileReference",file_id:e.id},this.updateTaskDefinition(),this.selectedFile={id:e.id,name:e.attributes.name,mime_type:e.attributes["mime-type"],download_url:e.meta["download-url"]}}},components:{VideoTimeInput:ws,FileUpload:an,VideoPlayer:No,FilePicker:Ca}});const Da=(0,v.A)(Ea,[["render",ia],["__scopeId","data-v-a420e4fa"]]);var Ia=Da;const Sa={class:"default travis-go-settings"};var xa=(0,a.pM)({props:{settings:{type:Object,required:!0}},emits:{update(e){return!0}},setup(e,{emit:t}){const n=e,i=(0,d.KR)((0,m.cloneDeep)(n.settings));function o(e={}){t("update",{settings:i.value,undoBatch:e})}return(0,a.wB)((()=>n.settings),(e=>{i.value=(0,m.cloneDeep)(e)}),{deep:!0}),(e,t)=>((0,a.uX)(),(0,a.CE)("form",Sa,[(0,a.Lk)("label",null,[(0,a.bo)((0,a.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[0]||(t[0]=e=>i.value.enabled=e),onChange:o},null,544),[[l.lH,i.value.enabled]]),(0,a.eW)(" "+(0,r.v_)(e.$gettext('"Travis Go"-Funktionalität enablen')),1)]),i.value.enabled?((0,a.uX)(),(0,a.CE)(a.FK,{key:0},[(0,a.Lk)("label",null,[(0,a.eW)((0,r.v_)(e.$gettext("Projekttitel"))+" ",1),(0,a.bo)((0,a.Lk)("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=e=>i.value.projectTitle=e),onInput:t[2]||(t[2]=e=>o("editProjectTitle"))},null,544),[[l.Jo,i.value.projectTitle]])]),(0,a.Lk)("label",null,[(0,a.eW)((0,r.v_)(e.$gettext("Projektbeschreibung"))+" ",1),(0,a.bo)((0,a.Lk)("input",{type:"text","onUpdate:modelValue":t[3]||(t[3]=e=>i.value.projectDescription=e),onInput:t[4]||(t[4]=e=>o("editProjectDescription"))},null,544),[[l.Jo,i.value.projectDescription]])])],64)):(0,a.Q3)("",!0)]))}});const La=(0,v.A)(xa,[["__scopeId","data-v-9bf42a86"]]);var Ba=La,Ra=(0,a.pM)({name:"InteractiveVideoEditor",setup(){return{taskEditor:(0,a.WQ)(u.c)}},methods:{$gettext:s.o_,updateTravisGoSettings(e){this.taskEditor.performEdit({newTaskDefinition:(0,S.Ay)(this.taskDefinition,(t=>{t.travisGoSettings=e.settings})),undoBatch:e.undoBatch})}},props:{taskDefinition:{type:Object,required:!0}},computed:{},components:{ConfigureTravisGo:Ba,SelectVideo:Ia,AddInteractions:Ws,TabComponent:w,TabsComponent:I}});const _a=(0,v.A)(Ra,[["render",ji]]);var Fa=_a,Ma=(n(8255),n(8353));const Pa={key:0,class:"action-menu"},za=["title"],Wa=(0,a.Lk)("span",null,null,-1),Ua=(0,a.Lk)("span",null,null,-1),Va=(0,a.Lk)("span",null,null,-1),Xa=[Wa,Ua,Va],Oa={class:"action-menu-content"},Qa={class:"action-menu-title"},Ha={class:"action-menu-list"},ja={key:1,class:"action-menu-no-icon"},Na={key:1,class:"action-menu-no-icon"},$a=(0,a.Lk)("span",{class:"action-menu-no-icon"},null,-1),Ka=["name"],Ga={key:1};function Ja(e,t,n,i,o,s){const l=(0,a.g2)("studip-icon");return s.shouldCollapse?((0,a.uX)(),(0,a.CE)("div",Pa,[(0,a.Lk)("button",{class:"action-menu-icon",title:s.tooltip,"aria-expanded":"false"},Xa,8,za),(0,a.Lk)("div",Oa,[(0,a.Lk)("div",Qa,(0,r.v_)(n.title),1),(0,a.Lk)("ul",Ha,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(s.navigationItems,(e=>((0,a.uX)(),(0,a.CE)("li",{key:e.id,class:(0,r.C4)(["action-menu-item",{"action-menu-item-disabled":e.disabled}])},[e.disabled?((0,a.uX)(),(0,a.CE)("label",(0,a.v6)({key:0,"aria-disabled":"true"},e.attributes),[e.icon?((0,a.uX)(),(0,a.Wv)(l,{key:0,shape:e.icon,role:"inactive",class:"action-menu-item-icon"},null,8,["shape"])):((0,a.uX)(),(0,a.CE)("span",ja)),(0,a.eW)(" "+(0,r.v_)(e.label),1)],16)):"link"===e.type?((0,a.uX)(),(0,a.CE)("a",(0,a.v6)({key:1},e.attributes,(0,a.Tb)(s.linkEvents(e))),[e.icon?((0,a.uX)(),(0,a.Wv)(l,{key:0,shape:e.icon,class:"action-menu-item-icon"},null,8,["shape"])):((0,a.uX)(),(0,a.CE)("span",Na)),(0,a.eW)(" "+(0,r.v_)(e.label),1)],16)):e.icon?((0,a.uX)(),(0,a.CE)("label",(0,a.v6)({key:2,class:"undecorated"},(0,a.Tb)(s.linkEvents(e)),{tabindex:"0"}),[(0,a.bF)(l,(0,a.v6)({shape:e.icon,name:e.name,class:"action-menu-item-icon"},e.attributes),null,16,["shape","name"]),(0,a.eW)(" "+(0,r.v_)(e.label),1)],16)):((0,a.uX)(),(0,a.CE)(a.FK,{key:3},[$a,(0,a.Lk)("button",(0,a.v6)({name:e.name},e.attributes,(0,a.Tb)(s.linkEvents(e))),(0,r.v_)(e.label),17,Ka)],64))],2)))),128))])])])):((0,a.uX)(),(0,a.CE)("div",Ga,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(s.navigationItems,(e=>((0,a.uX)(),(0,a.CE)(a.FK,null,[e.disabled?((0,a.uX)(),(0,a.CE)("label",(0,a.v6)({key:0,key:e.id,"aria-disabled":"true"},e.attributes),[(0,a.bF)(l,{shape:e.icon,title:e.label,role:"inactive",class:"action-menu-item-icon"},null,8,["shape","title"])],16)):((0,a.uX)(),(0,a.CE)("a",(0,a.v6)({key:1,key:e.id},e.attributes,(0,a.Tb)(s.linkEvents(e))),[(0,a.bF)(l,{shape:e.icon,title:e.label,class:"action-menu-item-icon"},null,8,["shape","title"])],16))],64)))),256))]))}var qa=n(2109),Ya=n(9132);function Za(e,t){return e.get(tl(e,t))}function el(e,t,n){return e.set(tl(e,t),n),n}function tl(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var nl=new WeakMap,il=new WeakMap,ol=new WeakMap,sl=new WeakMap,al=new WeakMap,ll=new WeakSet;class rl{constructor(e,t="off"){(0,qa.A)(this,ll),(0,Ya.A)(this,nl,"studip/icons"),(0,Ya.A)(this,il,void 0),(0,Ya.A)(this,ol,"off"),(0,Ya.A)(this,sl,void 0),(0,Ya.A)(this,al,void 0),el(il,this,e),el(ol,this,t),el(sl,this,new Map(tl(ll,this,ul).call(this))),el(al,this,new Map)}async load(e){if(Za(sl,this).has(e))return JSON.parse(Za(sl,this).get(e));if(Za(al,this).has(e))return Za(al,this).get(e);const t=e=>/\bhttps?:\/\/[^\s]+/i.test(e),n=t(e)?e:`${Za(il,this)}images/icons/blue/${e}.svg`,i=(async()=>{try{const t=await fetch(n);if(!t.ok)throw new Error(`IconLoader: HTTP ${t.status} ${t.statusText}`);const i={isSvg:t.headers.get("Content-Type")?.includes("image/svg+xml")??!1,content:""};if(i.isSvg){let e=await t.text();e=e.replace(/fill="(?!none)[^"]+"/g,'fill="currentColor"'),e=e.replace(/(width|height)="[^"]+"/g,""),i.content=e}else{const e=await t.blob();i.content=await new Promise((t=>{const n=new FileReader;n.onload=()=>t(n.result),n.readAsDataURL(e)}))}return this.store(e,i),i}catch(t){return console.error(`IconLoader: Fehler beim Laden von ${e}`,t),{isSvg:!0,content:""}}finally{Za(al,this).delete(e)}})();return Za(al,this).set(e,i),i}store(e,t){Za(sl,this).set(e,JSON.stringify(t)),tl(ll,this,dl).call(this)?.setItem(Za(nl,this),JSON.stringify([...Za(sl,this)]))}}function dl(){return"off"===Za(ol,this)?null:"session"===Za(ol,this)?sessionStorage:localStorage}function ul(){const e=tl(ll,this,dl).call(this)?.getItem(Za(nl,this));if(!e)return[];try{return JSON.parse(e)}catch{return[]}}const cl=new rl(window.STUDIP.ASSETS_URL,"session");var pl=cl;const hl={key:0,class:"icon-button undecorated"},ml={key:0};var kl=(0,a.pM)({props:{ariaRole:null,name:null,role:{default:"clickable"},shape:null,size:{default:null},inline:{type:Boolean,default:!1},text:null},setup(e){const t=e,n=(0,d.KR)(!1),i=(0,d.KR)(""),o=(0,a.OA)(),s=(0,a.EW)((()=>({ariaRole:t.ariaRole,class:u.value,content:i.value,isSvg:n.value,style:c.value}))),l=(0,a.EW)((()=>({...o,...s.value}))),u=(0,a.EW)((()=>["studip-icon",t.inline?"studip-icon-inline":"",`icon-role-${t.role}`,`icon-shape-${p.value}`])),c=(0,a.EW)((()=>t.size?{width:`${t.size}px`,height:`${t.size}px`}:{})),p=(0,a.EW)((()=>{const e=e=>/\bhttps?:\/\/\S+/i.test(e);return e(t.shape)?t.shape.split("/").pop()?.replace(".svg","")??"":t.shape}));(0,a.wB)((()=>t.shape),(async e=>{const t=await pl.load(e);n.value=t.isSvg,i.value=t.content}),{immediate:!0});const h=(0,a.pM)({props:{isSvg:Boolean,content:String,ariaRole:String,cssClass:String,computedStyle:Object},setup(e,{attrs:t}){const n={class:e.cssClass,role:e.ariaRole,style:e.computedStyle,...t};return()=>e.isSvg?(0,a.h)("div",{innerHTML:e.content,...n}):(0,a.h)("img",{src:e.content,...n})}});return(t,n)=>e.name?((0,a.uX)(),(0,a.CE)("label",hl,[(0,a.Lk)("input",(0,a.v6)({type:"submit",hidden:""},(0,d.R1)(o)),null,16),(0,a.bF)((0,d.R1)(h),(0,r._B)((0,a.Ng)((0,d.R1)(s))),null,16),e.text?((0,a.uX)(),(0,a.CE)("span",ml,(0,r.v_)(e.text),1)):(0,a.Q3)("",!0)])):((0,a.uX)(),(0,a.Wv)((0,d.R1)(h),(0,r._B)((0,a.v6)({key:1},(0,d.R1)(l))),null,16))}});const gl=kl;var fl=gl,vl={name:"studip-action-menu",components:{StudipIcon:fl},props:{items:Array,collapseAt:{default:null},context:{type:String,default:""},title:{type:String,default(){return(0,s.o_)("Aktionen")}}},data(){return{open:!1}},methods:{linkEvents(e){let t={};return e.emit&&(t.click=t=>{t.preventDefault(),this.$emit.apply(this,[e.emit].concat(e.emitArguments??[])),this.close()}),t},close(){window.STUDIP.ActionMenu.closeAll()}},computed:{navigationItems(){return this.items.map((e=>(e.type=e.type??"link",e.attributes=e.attributes??{},"link"===e.type&&(e.attributes.href=e.url??"#"),e)))},shouldCollapse(){const e=this.collapseAt??4;return!1!==e&&(!0===e||Number.parseInt(e)<=this.items.length)},tooltip(){return this.context?this.$gettextInterpolate(this.$gettext("%{title} für %{context}"),{title:this.title,context:this.context}):this.title}}};const bl=(0,v.A)(vl,[["render",Ja]]);var wl=bl;const yl=e=>((0,a.Qi)("data-v-021d655d"),e=e(),(0,a.jt)(),e),Al=["data-post-type"],Tl={class:"travis-go-post-heading"},Cl=(0,a.eW)(" ["),El={class:"video-timestamp"},Dl={key:0},Il=(0,a.eW)(" — "),Sl=yl((()=>(0,a.Lk)("span",null,null,-1))),xl=(0,a.eW)("] "),Ll={class:"travis-go-post-contents-container"},Bl=["innerHTML"],Rl={key:0,class:"travis-go-comments"},_l={class:"collapsable collapsed"},Fl={class:"travis-go-comments-list"},Ml=["onClick"],Pl=["placeholder"],zl=["disabled"];var Wl=(0,a.pM)({props:{post:{type:Object,required:!0},comments:{type:Object,required:!0}},emits:{clickTimestamp(e){return!0},startEditingPost(e){return!0},deletePost(e){return!0},deleteComment(e){return!0},clickPostAuthorName(e){return!0},clickPostType(e){return!0},clickCommentAuthorName(e){return!0}},setup(e,{emit:t}){const n=e,i=(0,a.EW)((()=>Ma.A.sanitize(n.post?.attributes.contents,{USE_PROFILES:{html:!0}})));function o(e){return Cn.M_.getters["users/byId"]({id:e})}const u=(0,a.EW)((()=>o(n.post?.attributes.mk_user_id))),c=(0,a.EW)((()=>u.value?.attributes?.["formatted-name"]));function p(e){const t=e?.attributes?.["username"];return t?window.STUDIP.URLHelper.getURL("dispatch.php/profile",{username:t}):""}const h=(0,a.EW)((()=>p(u.value)));function m(e){return o(e.attributes.mk_user_id)?.attributes["formatted-name"]??(0,s.o_)("Unbekannt")}const k=(0,d.KR)(""),g=(0,d.KR)(),f=(0,d.KR)(!1);function v(){f.value=!0,(0,a.dY)((()=>{const e=g.value,t=[...document.querySelectorAll("fieldset.collapsable.collapsed")].filter((t=>t.contains(e)));t.forEach((e=>e.classList.remove("collapsed"))),e.focus()}))}async function b(){try{await w({attributes:{post_id:n.post.attributes.id,contents:k.value}}),k.value=""}catch(e){window.STUDIP.Report.error((0,s.o_)("Dein Kommentar konnte nicht abgeschickt werden."),[JSON.stringify(e,null,2)]),console.error(e)}}async function w(e){return await Cn.M_.dispatch("lernmodule-plugin/travis-go-comments/create",e)}const y=(0,d.KR)(),A=(0,a.EW)((()=>void 0!==y.value));function T(e){y.value=e.attributes.id,k.value=e.attributes.contents,g.value.focus()}function C(){y.value=void 0,k.value=""}async function E(){try{if(!y.value)throw new Error((0,s.o_)("Das bearbeitete Comment ID ist undefined oder leer."));await D({id:y.value,attributes:{contents:k.value}}),y.value=void 0,k.value=""}catch(e){window.STUDIP.Report.error((0,s.o_)("Dein Kommentar konnte nicht abgeschickt werden."),[JSON.stringify(e,null,2)]),console.error(e)}}async function D(e){return await Cn.M_.dispatch("lernmodule-plugin/travis-go-comments/update",e)}function I(){const e={action_id:"1",label:(0,s.o_)("Löschen"),icon:"trash",emit:"deletePost"},t={action_id:"2",label:(0,s.o_)("Bearbeiten"),icon:"edit",emit:"startEditingPost"};return[...n.post.meta.permissions.mayDelete?[e]:[],...n.post.meta.permissions.mayEdit?[t]:[],{action_id:"3",label:(0,s.o_)("Kommentieren"),icon:"comment",emit:"startCommentingPost"},{action_id:"3",type:"link",label:(0,s.o_)("Nutzerprofil öffnen"),icon:"share",url:h.value}]}function S(e){const t={action_id:"1",label:(0,s.o_)("Löschen"),icon:"trash",emit:"deleteComment"},n={action_id:"2",label:(0,s.o_)("Bearbeiten"),icon:"edit",emit:"startEditingComment"};return[...e.meta.permissions.mayDelete?[t]:[],...e.meta.permissions.mayEdit?[n]:[],{action_id:"3",type:"link",label:(0,s.o_)("Nutzerprofil öffnen"),icon:"share",url:p(o(e.attributes.mk_user_id))}]}function x(e){t("deletePost",e)}function L(e){t("startEditingPost",e)}function B(e){t("deleteComment",e)}function R(e){t("clickTimestamp",e)}return(t,n)=>((0,a.uX)(),(0,a.CE)("div",{class:"travis-go-post","data-post-type":e.post.attributes.post_type},[(0,a.Lk)("h4",Tl,[Cl,(0,a.Lk)("span",El,[(0,a.Lk)("a",{href:"#",onClick:n[0]||(n[0]=(0,l.D$)((t=>R(e.post.attributes.start_time)),["prevent"]))},(0,r.v_)((0,d.R1)(rs)(e.post.attributes.start_time,!1,":")),1),e.post.attributes.end_time?((0,a.uX)(),(0,a.CE)("span",Dl,[Il,(0,a.Lk)("a",{href:"#",onClick:n[1]||(n[1]=(0,l.D$)((t=>R(e.post.attributes.end_time)),["prevent"]))},(0,r.v_)((0,d.R1)(rs)(e.post.attributes.end_time,!1,":")),1)])):(0,a.Q3)("",!0)]),(0,a.Lk)("a",{href:"#",onClick:n[2]||(n[2]=(0,l.D$)((n=>t.$emit("clickPostType",e.post)),["prevent"])),class:"post-type"},(0,r.v_)(e.post.attributes.post_type),1),Sl,(0,a.Lk)("a",{href:"#",onClick:n[3]||(n[3]=(0,l.D$)((n=>t.$emit("clickPostAuthorName",e.post)),["prevent"]))},"@"+(0,r.v_)((0,d.R1)(c)),1),xl,(0,a.bF)(wl,{title:(0,d.R1)(s.o_)("Aktionen"),items:I(),collapseAt:!0,class:"travis-go-post-action-menu",onDeletePost:n[4]||(n[4]=t=>x(e.post.attributes.id)),onStartEditingPost:n[5]||(n[5]=t=>L(e.post)),onStartCommentingPost:v},null,8,["title","items"])]),(0,a.Lk)("div",Ll,[(0,a.Lk)("p",{class:"travis-go-post-contents",innerHTML:(0,d.R1)(i)},null,8,Bl),f.value||e.comments.length>0?((0,a.uX)(),(0,a.CE)("section",Rl,[(0,a.Lk)("form",{class:"default",onSubmit:n[8]||(n[8]=(0,l.D$)((()=>{}),["prevent"]))},[(0,a.Lk)("fieldset",_l,[(0,a.Lk)("legend",null,[e.comments.length>0?((0,a.uX)(),(0,a.CE)(a.FK,{key:0},[(0,a.eW)((0,r.v_)((0,d.R1)(s.jb)((0,d.R1)(s.qz)("%{ numberOfComments } Kommentar","%{ numberOfComments } Kommentare",e.comments.length),{numberOfComments:e.comments.length})),1)],64)):((0,a.uX)(),(0,a.CE)(a.FK,{key:1},[(0,a.eW)((0,r.v_)((0,d.R1)(s.o_)("Kommentieren")),1)],64))]),(0,a.Lk)("div",Fl,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.comments,(e=>((0,a.uX)(),(0,a.CE)("p",{class:"travis-go-comment",key:e.attributes.id},[(0,a.Lk)("a",{class:"travis-go-comment-author",href:"#",onClick:(0,l.D$)((n=>t.$emit("clickCommentAuthorName",e)),["prevent"])},"@"+(0,r.v_)(m(e)),9,Ml),(0,a.eW)(" "+(0,r.v_)(e.attributes.contents)+" ",1),S(e).length>0?((0,a.uX)(),(0,a.Wv)(wl,{key:0,title:(0,d.R1)(s.o_)("Aktionen"),items:S(e),collapseAt:!0,class:"travis-go-comment-action-menu",onDeleteComment:t=>B(e.attributes.id),onStartEditingComment:t=>T(e)},null,8,["title","items","onDeleteComment","onStartEditingComment"])):(0,a.Q3)("",!0)])))),128))]),(0,a.Lk)("div",null,[(0,a.Lk)("form",{class:"comment-editor",onSubmit:n[7]||(n[7]=(0,l.D$)((e=>(0,d.R1)(A)?E():b()),["prevent"]))},[(0,a.bo)((0,a.Lk)("input",{type:"text",placeholder:(0,d.R1)(s.o_)("Schreibe einen Kommentar..."),"onUpdate:modelValue":n[6]||(n[6]=e=>k.value=e),ref_key:"commentEditorInputElement",ref:g},null,8,Pl),[[l.Jo,k.value]]),(0,d.R1)(A)?((0,a.uX)(),(0,a.CE)("button",{key:0,type:"button",class:"button cancel cancel-editing-comment-button",onClick:C},(0,r.v_)((0,d.R1)(s.o_)("Zurücksetzen")),1)):(0,a.Q3)("",!0),(0,a.Lk)("button",{class:"button accept send-comment-button",type:"submit",disabled:0===k.value.trim().length},(0,r.v_)((0,d.R1)(A)?(0,d.R1)(s.o_)("Aktualisieren"):(0,d.R1)(s.o_)("Abschicken")),9,zl)],32)])])],32)])):(0,a.Q3)("",!0)])],8,Al))}});const Ul=(0,v.A)(Wl,[["__scopeId","data-v-021d655d"]]);var Vl=Ul,Xl=n(5951);const Ol=e=>((0,a.Qi)("data-v-2c77950b"),e=e(),(0,a.jt)(),e),Ql={key:0,class:"travis-go-main"},Hl={class:"travis-go-left-column"},jl={class:"annotation-controls"},Nl=["onClick"],$l=["onClick"],Kl={value:"image"},Gl=Ol((()=>(0,a.Lk)("option",{value:"audio"},"Audio",-1))),Jl=Ol((()=>(0,a.Lk)("option",{value:"text"},"Text",-1))),ql=Ol((()=>(0,a.Lk)("option",{value:"meta"},"Meta",-1))),Yl=["data-tooltip"],Zl=["disabled"],er={class:"travis-go-participants-list"},tr=["href"],nr={class:"travis-go-right-column"},ir={class:"search-bar"},or=["placeholder"],sr=["title"],ar=Ol((()=>(0,a.Lk)("button",{class:"button h5p-search"},null,-1))),lr={class:"project-title-and-description"},rr={class:"travis-go-posts"};var dr=(0,a.pM)({props:{task:{type:Object,required:!0}},setup(e){const t=e,n=window.STUDIP.LernmoduleVueJS.LERNMODULE_DEBUG,i=(0,d.KR)(void 0);function o(e){b(e)}function u(e){const t=H(e);if(!t)throw new Error("User not found by id "+e);j.value="@"+t.attributes.username}function c(e){u(e.attributes.mk_user_id)}function p(e){j.value=e.attributes.post_type}function h(e){u(e.attributes.mk_user_id)}async function m(e){const t=(0,s.o_)("Kommentar löschen"),n=window.confirm(t);if(n)try{await Cn.M_.dispatch("lernmodule-plugin/travis-go-comments/delete",{id:e}),window.STUDIP.Report.success((0,s.o_)("Der Kommentar wurde gelöscht."))}catch(i){window.STUDIP.Report.error((0,s.o_)("Der Kommentar konnte nicht gelöscht werden."),[JSON.stringify(i,null,2)]),console.error(i)}else console.info("Delete prompt canceled by user")}const k=(0,d.KR)();function g(e){if(""!==N.value||void 0!==A.value||void 0!==E.value){const e=confirm((0,s.o_)("Die Inhalte des Post-Editors werden gelöscht."));if(!e)return}k.value=e.attributes.id,N.value=e.attributes.contents,K.value=e.attributes.post_type,A.value=e.attributes.start_time,E.value=e.attributes.end_time??void 0,(0,a.dY)((()=>{const e=$.value.$el,t=window.STUDIP.wysiwyg.getEditor(e);t.editing.view.focus(),t.model.change((e=>{e.setSelection(e.createPositionAt(t.model.document.getRoot(),"end"))}))}))}function f(){if(""!==N.value||void 0!==A.value||void 0!==E.value){const e=confirm((0,s.o_)("Die Inhalte des Post-Editors werden gelöscht."));if(!e)return}k.value=void 0,N.value="",K.value="text",A.value=void 0,E.value=void 0}async function v(e){const t=(0,s.o_)("Post löschen"),n=window.confirm(t);if(n)try{await Cn.M_.dispatch("lernmodule-plugin/travis-go-posts/delete",{id:e}),window.STUDIP.Report.success((0,s.o_)("Der Post wurde gelöscht."))}catch(i){window.STUDIP.Report.error((0,s.o_)("Der Post konnte nicht gelöscht werden."),[JSON.stringify(i,null,2)]),console.error(i)}else console.info("Delete prompt canceled by user")}function b(e){i.value.player.currentTime(e)}const w=(0,d.KR)(0);function y(e){w.value=e}const A=(0,d.KR)();function T(){void 0!==A.value?b(A.value):(A.value=w.value,void 0!==E.value&&E.value<A.value&&(E.value=void 0))}function C(){A.value=void 0}const E=(0,d.KR)();function D(){E.value?b(E.value):(E.value=w.value,void 0!==A.value&&E.value<A.value&&(A.value=void 0))}function I(){E.value=void 0}function S(){Cn.M_.dispatch("users/loadById",{id:window.STUDIP.USER_ID})}const x=(0,d.KR)();function L(){if(!Cn.SL.taskSaveLocation)throw new Error("taskEditorStore.taskSaveLocation is missing.");Cn.M_.dispatch("lernmodule-plugin/travis-go-posts/loadWhere",{filter:{video_id:Cn.SL.taskSaveLocation.id,video_type:Cn.SL.taskSaveLocation.type},options:{include:"user,comments,comments.user","fields[users]":"formatted-name,username"}}).then((e=>console.log("result of travis-go-posts/loadAll",e))).catch((e=>{x.value=e,console.error("error",e)}))}const B=(0,a.EW)((()=>Cn.M_.getters["lernmodule-plugin/travis-go-posts/all"])),R=(0,a.EW)((()=>{const e=[],t=[];for(let n of B.value){const i=Co.safeParse(n);i.success?t.push(i.data):e.push(i)}return[t,e]})),_=(0,a.EW)((()=>R.value[0])),F=(0,a.EW)((()=>R.value[1])),M=(0,a.EW)((()=>_.value.filter((e=>P(e,j.value))).toSorted(((e,t)=>e.attributes.start_time-t.attributes.start_time))));function P(e,t){if(t){const n=H(e.attributes.mk_user_id),i=[e.attributes.contents,e.attributes.post_type,n?.attributes.username??"",n?.attributes["formatted-name"]??""],o=W(t),s=X(e);return i.some((e=>W(e).includes(o)))||s.some((e=>z(e,o)))}return!0}function z(e,t){const n=H(e.attributes.mk_user_id),i=[e.attributes.contents,n?.attributes.username??"",n?.attributes["formatted-name"]??""];return i.some((e=>W(e).includes(t)))}function W(e){return e.toLowerCase().replaceAll(/[.,/#!$%^&@*;:{}=\-_`~()]/g,"").trim()}const U=(0,a.EW)((()=>Cn.M_.getters["lernmodule-plugin/travis-go-comments/all"].flatMap((e=>{const t=Do.safeParse(e);return t.success?t.data:[]})))),V=(0,a.EW)((()=>Cn.M_.getters["lernmodule-plugin/travis-go-comments/all"].flatMap((e=>{const t=Do.safeParse(e);return t.success?[]:{record:e,error:t.error}}))));function X(e){return U.value.filter((t=>t.attributes.post_id===e.attributes.id))}(0,a.wB)((()=>V.value),(()=>{0!==V.value.length&&(console.error(`${V.value} Comment(s) could not be loaded`),console.error(V.value))}));const O=(0,a.EW)((()=>{const e=_.value.map((e=>e.attributes.mk_user_id)),t=U.value.filter((e=>_.value.some((t=>t.attributes.id===e.attributes.post_id)))).map((e=>e.attributes.mk_user_id));return[...new Set(e.concat(t))]}));function Q(e){const t=H(e);return t?window.STUDIP.URLHelper.getURL("dispatch.php/profile",{username:t.attributes.username}):""}function H(e){return Cn.M_.getters["users/byId"]({id:e})}(0,a.sV)((()=>{L(),S()}));const j=(0,d.KR)(""),N=(0,d.KR)(""),$=(0,d.KR)(),K=(0,d.KR)("image"),G=(0,d.KR)();function J(e){e.value&&void 0===A.value&&(A.value=w.value)}function q(){j.value=""}async function Y(e){return await Cn.M_.dispatch("lernmodule-plugin/travis-go-posts/create",e)}async function Z(e){return await Cn.M_.dispatch("lernmodule-plugin/travis-go-posts/update",e)}function ee(){if(console.log("submitNewPost"),!t.task)throw new Error("task not provided");if(!Cn.SL.taskSaveLocation)throw new Error("taskEditorStore.taskSaveLocation is missing.");const e=Y({attributes:{contents:N.value,post_type:K.value,start_time:A.value??0,end_time:E.value??null,video_id:Cn.SL.taskSaveLocation.id,video_type:Cn.SL.taskSaveLocation.type}}).then((e=>{console.log("result of create post",e),N.value="",A.value=void 0,E.value=void 0,G.value=void 0})).catch((e=>{console.error("error",e),G.value=e,window.STUDIP.Report.error((0,s.o_)("Der Post konnte nicht gepostet werden."),[JSON.stringify(e,null,2)])}));return e}function te(){if(console.log("submitNewPost"),!t.task)throw new Error("task not provided");if(!Cn.SL.taskSaveLocation)throw new Error("taskEditorStore.taskSaveLocation is missing.");if(void 0===k.value)throw new Error("editedPostId is undefined");const e=Z({id:k.value,attributes:{contents:N.value,post_type:K.value,start_time:A.value??0,end_time:E.value??null}}).then((e=>{console.log("result of update post",e),k.value=void 0,N.value="",A.value=void 0,E.value=void 0,G.value=void 0})).catch((e=>{console.error("error",e),G.value=e,window.STUDIP.Report.error((0,s.o_)("Der Post konnte nicht geupdated werden."),[JSON.stringify(e,null,2)])}));return e}return(t,u)=>e.task.travisGoSettings.enabled?((0,a.uX)(),(0,a.CE)("div",Ql,[(0,a.Lk)("div",Hl,[(0,a.bF)(No,{onTimeupdate:y,task:e.task,ref_key:"videoPlayer",ref:i},null,8,["task"]),(0,a.Lk)("div",jl,[(0,a.Lk)("button",{class:"button date time-input",onClick:T},[void 0!==A.value?((0,a.uX)(),(0,a.CE)(a.FK,{key:0},[(0,a.eW)((0,r.v_)((0,d.R1)(rs)(A.value,!1,":"))+" ",1),(0,a.Lk)("button",{class:"small-button cancel",onClick:(0,l.D$)(C,["stop"])},null,8,Nl)],64)):((0,a.uX)(),(0,a.CE)(a.FK,{key:1},[(0,a.eW)((0,r.v_)((0,d.R1)(s.o_)("Start")),1)],64))]),(0,a.Lk)("button",{class:"button date time-input",onClick:D},[void 0!==E.value?((0,a.uX)(),(0,a.CE)(a.FK,{key:0},[(0,a.eW)((0,r.v_)((0,d.R1)(rs)(E.value,!1,":"))+" ",1),(0,a.Lk)("button",{class:"small-button cancel",onClick:(0,l.D$)(I,["stop"])},null,8,$l)],64)):((0,a.uX)(),(0,a.CE)(a.FK,{key:1},[(0,a.eW)((0,r.v_)((0,d.R1)(s.o_)("End")),1)],64))]),(0,a.bo)((0,a.Lk)("select",{class:"post-type-input","onUpdate:modelValue":u[0]||(u[0]=e=>K.value=e)},[(0,a.Lk)("option",Kl,(0,r.v_)((0,d.R1)(s.o_)("Bild")),1),Gl,Jl,ql],512),[[l.u1,K.value]]),(0,a.Lk)("div",{class:"tooltip tooltip-icon","data-tooltip":(0,d.R1)(Es).postTypeTooltip},null,8,Yl)]),(0,a.bF)(_e.A,{insertHtmlComment:"",modelValue:N.value,"onUpdate:modelValue":u[1]||(u[1]=e=>N.value=e),ref_key:"postWysiwygInputElement",ref:$,onFocus:J},null,8,["modelValue"]),void 0!==k.value?((0,a.uX)(),(0,a.CE)("button",{key:0,onClick:f,type:"button",class:"button"},(0,r.v_)((0,d.R1)(s.o_)("Zurücksetzen")),1)):(0,a.Q3)("",!0),(0,a.Lk)("button",{onClick:u[2]||(u[2]=e=>void 0!==k.value?te():ee()),class:"button",disabled:0===N.value.trim().length},(0,r.v_)(void 0!==k.value?(0,d.R1)(s.o_)("Post updaten"):(0,d.R1)(s.o_)("Post abschicken")),9,Zl),G.value?((0,a.uX)(),(0,a.Wv)(Xl.A,{key:1,style:{"max-height":"unset"},error:(0,d.R1)(n)?`${(0,d.R1)(Es).couldNotSendPostError} Error: ${JSON.stringify(G.value,null,2)}`:(0,d.R1)(Es).couldNotSendPostError},null,8,["error"])):(0,a.Q3)("",!0),(0,a.Lk)("div",er,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)((0,d.R1)(O),(e=>((0,a.uX)(),(0,a.CE)("a",{key:e,href:Q(e)},(0,r.v_)(H(e)?.attributes["formatted-name"]),9,tr)))),128))])]),(0,a.Lk)("div",nr,[(0,a.Lk)("nav",ir,[(0,a.bo)((0,a.Lk)("input",{type:"text",role:"searchbox",placeholder:(0,d.R1)(s.o_)("Suche"),"onUpdate:modelValue":u[3]||(u[3]=e=>j.value=e)},null,8,or),[[l.Jo,j.value]]),""!==j.value?((0,a.uX)(),(0,a.CE)("button",{key:0,class:"button h5p-search cancel",title:(0,d.R1)(s.o_)("Suche zurücksetzen"),onClick:q},null,8,sr)):(0,a.Q3)("",!0),ar]),(0,a.Lk)("section",lr,[(0,a.Lk)("h3",null,(0,r.v_)((0,d.R1)(s.o_)("Projekttitel")),1),(0,a.Lk)("p",null,(0,r.v_)(e.task.travisGoSettings.projectTitle),1),(0,a.Lk)("h3",null,(0,r.v_)((0,d.R1)(s.o_)("Projektbeschreibung")),1),(0,a.Lk)("p",null,(0,r.v_)(e.task.travisGoSettings.projectDescription),1)]),(0,a.Lk)("section",rr,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)((0,d.R1)(M),((e,t)=>((0,a.uX)(),(0,a.Wv)(Vl,{key:e.attributes.id,post:e,comments:X(e),onClickTimestamp:o,onStartEditingPost:g,onDeletePost:v,onDeleteComment:m,onClickPostAuthorName:c,onClickPostType:p,onClickCommentAuthorName:h,class:(0,r.C4)({odd:t%2===0})},null,8,["post","comments","class"])))),128)),(0,a.Q3)("",!0)]),x.value?((0,a.uX)(),(0,a.Wv)(Xl.A,{key:0,error:(0,d.R1)(n)?`${(0,d.R1)(Es).couldNotLoadPostsError} Error: ${JSON.stringify(x.value,null,2)}`:(0,d.R1)(Es).couldNotLoadPostsError},null,8,["error"])):(0,a.Q3)("",!0),(0,d.R1)(F).length>0?((0,a.uX)(),(0,a.Wv)(Xl.A,{key:1,error:`${(0,d.R1)(F).length} post(s) could not be loaded`},null,8,["error"])):(0,a.Q3)("",!0),(0,d.R1)(V).length>0?((0,a.uX)(),(0,a.Wv)(Xl.A,{key:2,error:`${(0,d.R1)(V).length} comment(s) could not be loaded`},null,8,["error"])):(0,a.Q3)("",!0)])])):((0,a.uX)(),(0,a.Wv)(No,{key:1,onTimeupdate:y,task:e.task,ref_key:"videoPlayer",ref:i},null,8,["task"]))}});const ur=(0,v.A)(dr,[["__scopeId","data-v-2c77950b"]]);var cr=ur;const pr={class:"stud5p-task"},hr={class:"default"},mr={class:"h5pEditorTopPanel"},kr=["data-tooltip"],gr={class:"collapsable collapsed"},fr={class:"collapsable collapsed"},vr=["disabled"],br=["disabled"];function wr(e,t,n,i,o,s){const d=(0,a.g2)("studip-wysiwyg"),u=(0,a.g2)("feedback-editor");return(0,a.uX)(),(0,a.CE)("div",pr,[(0,a.Lk)("form",hr,[(0,a.Lk)("fieldset",null,[(0,a.Lk)("legend",null,(0,r.v_)(e.$gettext("Mark the Words")),1),(0,a.Lk)("div",mr,[(0,a.Lk)("button",{onClick:t[0]||(t[0]=(...t)=>e.addSolution&&e.addSolution(...t)),class:"button add-blank",type:"button"},(0,r.v_)(e.$gettext("Richtiges Wort markieren")),1),(0,a.Lk)("div",{class:"tooltip tooltip-icon","data-tooltip":e.instructions},null,8,kr)]),(0,a.bF)(d,{modelValue:e.modelTaskDefinition.template,"onUpdate:modelValue":e.onEditTemplate,ref:"wysiwyg","force-soft-breaks":"","remove-wrapping-p-tag":"","disable-autoformat":""},null,8,["modelValue","onUpdate:modelValue"])]),(0,a.Lk)("fieldset",gr,[(0,a.Lk)("legend",null,(0,r.v_)(e.$gettext("Einstellungen")),1),(0,a.Lk)("label",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=t=>e.modelTaskDefinition.retryAllowed=t),onChange:t[2]||(t[2]=(...t)=>e.updateTaskDefinition&&e.updateTaskDefinition(...t)),type:"checkbox"},null,544),[[l.lH,e.modelTaskDefinition.retryAllowed]]),(0,a.eW)(" "+(0,r.v_)(e.$gettext("Mehrere Versuche erlauben")),1)]),(0,a.Lk)("label",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[3]||(t[3]=t=>e.modelTaskDefinition.showSolutionsAllowed=t),onChange:t[4]||(t[4]=(...t)=>e.updateTaskDefinition&&e.updateTaskDefinition(...t)),type:"checkbox"},null,544),[[l.lH,e.modelTaskDefinition.showSolutionsAllowed]]),(0,a.eW)(" "+(0,r.v_)(e.$gettext("Lösungen anzeigen erlauben")),1)])]),(0,a.Lk)("fieldset",fr,[(0,a.Lk)("legend",null,(0,r.v_)(e.$gettext("Beschriftungen")),1),(0,a.Lk)("label",null,[(0,a.eW)((0,r.v_)(e.$gettext("Text für Überprüfen-Button:"))+" ",1),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[5]||(t[5]=t=>e.modelTaskDefinition.strings.checkButton=t),onInput:t[6]||(t[6]=t=>e.updateTaskDefinition("taskDefinition.strings.checkButton")),type:"text"},null,544),[[l.Jo,e.modelTaskDefinition.strings.checkButton]])]),(0,a.Lk)("label",{class:(0,r.C4)({"setting-disabled":!e.modelTaskDefinition.retryAllowed})},[(0,a.eW)((0,r.v_)(e.$gettext("Text für Wiederholen-Button:"))+" ",1),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[7]||(t[7]=t=>e.modelTaskDefinition.strings.retryButton=t),onInput:t[8]||(t[8]=t=>e.updateTaskDefinition("taskDefinition.strings.retryButton")),disabled:!e.modelTaskDefinition.retryAllowed,type:"text"},null,40,vr),[[l.Jo,e.modelTaskDefinition.strings.retryButton]])],2),(0,a.Lk)("label",{class:(0,r.C4)({"setting-disabled":!e.modelTaskDefinition.showSolutionsAllowed})},[(0,a.eW)((0,r.v_)(e.$gettext("Text für Lösungen-Button:"))+" ",1),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[9]||(t[9]=t=>e.modelTaskDefinition.strings.solutionsButton=t),onInput:t[10]||(t[10]=t=>e.updateTaskDefinition("taskDefinition.strings.solutionsButton")),disabled:!e.modelTaskDefinition.showSolutionsAllowed,type:"text"},null,40,br),[[l.Jo,e.modelTaskDefinition.strings.solutionsButton]])],2)]),(0,a.bF)(u,{feedback:e.modelTaskDefinition.feedback,"result-message":e.modelTaskDefinition.strings.resultMessage,"onUpdate:feedback":e.updateFeedback,"onUpdate:resultMessage":e.updateResultMessage},null,8,["feedback","result-message","onUpdate:feedback","onUpdate:resultMessage"])])])}var yr=(0,a.pM)({name:"MarkTheWordsEditor",setup(){return{taskEditor:(0,a.WQ)(u.c)}},components:{FeedbackEditor:$e,StudipWysiwyg:_e.A},props:{taskDefinition:{type:Object,required:!0}},data(){return{modelTaskDefinition:(0,m.cloneDeep)(this.taskDefinition)}},watch:{taskDefinition:{immediate:!0,handler:function(){this.modelTaskDefinition=(0,m.cloneDeep)(this.taskDefinition)}}},methods:{$gettext:s.o_,addSolution(){const e=this.$refs.wysiwyg?.$el,t=window.STUDIP.wysiwyg.getEditor(e);if(!t)throw console.error("getEditor(wysiwygEl) returned: ",t),new Error("Could not get reference to wysiwyg editor");const n=t.model.document.selection,i=n.getFirstPosition(),o=n.getLastPosition();if(!i||!o)throw console.error("selection start: ",i," selection end: ",o),new Error("Could not get selection in editor");t.model.change((e=>{e.insertText("*",o),e.insertText("*",i)}))},urlForIcon(e){return window.STUDIP.ASSETS_URL+"images/icons/blue/"+e+".svg"},onEditTemplate(e){this.taskEditor.performEdit({newTaskDefinition:(0,S.Ay)(this.modelTaskDefinition,(t=>{t.template=e})),undoBatch:"taskDefinition.template"})},updateTaskDefinition(e){this.taskEditor.performEdit({newTaskDefinition:(0,m.cloneDeep)(this.modelTaskDefinition),undoBatch:e??{}})},updateFeedback(e){this.taskEditor.performEdit({newTaskDefinition:(0,S.Ay)(this.modelTaskDefinition,(t=>{t.feedback=e})),undoBatch:"taskDefinition.feedback"})},updateResultMessage(e){this.taskEditor.performEdit({newTaskDefinition:(0,S.Ay)(this.modelTaskDefinition,(t=>{t.strings.resultMessage=e})),undoBatch:"taskDefinition.strings.resultMessage"})}},computed:{instructions(){return(0,s.o_)("Markieren Sie ein Wort als Lösung, indem Sie ein Sternchen (*) vor und hinter dem Wort setzen oder markieren Sie ein Wort und klicken Sie den „Richtiges Wort markieren“–Button.")}}});const Ar=(0,v.A)(yr,[["render",wr]]);var Tr=Ar;const Cr={class:"stud5p-task"},Er={class:"mark-the-words-text"},Dr=["aria-pressed","onClick","onKeydown","onKeyup","innerHTML"],Ir=["aria-pressed","onClick","onKeydown","onKeyup","innerHTML"],Sr=["innerHTML"],xr={key:3},Lr={key:4,class:"space"},Br={class:"feedback-and-button-container"},Rr={class:"button-panel"},_r=["textContent"],Fr=["textContent"],Mr=["textContent"],Pr={key:0},zr=(0,a.eW)(" Marked words: "),Wr=(0,a.eW)(" template: "),Ur=(0,a.eW)(" Split template: "),Vr=(0,a.eW)(" Parsed template: ");function Xr(e,t,n,i,o,s){const l=(0,a.g2)("feedback-element");return(0,a.uX)(),(0,a.CE)("div",Cr,[(0,a.Lk)("div",Er,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.parsedTemplate,(t=>((0,a.uX)(),(0,a.CE)(a.FK,{key:t.uuid},["solution"===t.type?((0,a.uX)(),(0,a.CE)("span",{key:0,tabindex:"0",role:"button","aria-pressed":e.isMarked(t),onClick:n=>e.onClickWord(t),onKeydown:n=>e.onWordKeydown(n,t),onKeyup:n=>e.onWordKeyup(n,t),class:(0,r.C4)(["no-break",e.classForWord(t)]),innerHTML:t.text},null,42,Dr)):"word"===t.type?((0,a.uX)(),(0,a.CE)("span",{key:1,tabindex:"0",role:"button","aria-pressed":e.isMarked(t),onClick:n=>e.onClickWord(t),onKeydown:n=>e.onWordKeydown(n,t),onKeyup:n=>e.onWordKeyup(n,t),class:(0,r.C4)(["no-break",e.classForWord(t)]),innerHTML:t.text},null,42,Ir)):"punctuation"===t.type?((0,a.uX)(),(0,a.CE)("span",{key:2,innerHTML:t.text},null,8,Sr)):"line-break"===t.type?((0,a.uX)(),(0,a.CE)("br",xr)):"space"===t.type?((0,a.uX)(),(0,a.CE)("pre",Lr," ")):(0,a.Q3)("",!0)],64)))),128))]),(0,a.Lk)("div",Br,[e.showResults?((0,a.uX)(),(0,a.Wv)(l,{key:0,"achieved-points":e.score,"max-points":e.maxScore,feedback:e.task.feedback,"result-message":e.resultMessage},null,8,["achieved-points","max-points","feedback","result-message"])):(0,a.Q3)("",!0),(0,a.Lk)("div",Rr,[e.showCheckButton?((0,a.uX)(),(0,a.CE)("button",{key:0,textContent:(0,r.v_)(e.task.strings.checkButton),onClick:t[0]||(t[0]=(...t)=>e.onClickCheck&&e.onClickCheck(...t)),type:"button",class:"stud5p-button"},null,8,_r)):(0,a.Q3)("",!0),e.showSolutionsButton?((0,a.uX)(),(0,a.CE)("button",{key:1,textContent:(0,r.v_)(e.task.strings.solutionsButton),onClick:t[1]||(t[1]=(...t)=>e.onClickShowSolutions&&e.onClickShowSolutions(...t)),type:"button",class:"stud5p-button"},null,8,Fr)):(0,a.Q3)("",!0),e.showRetryButton?((0,a.uX)(),(0,a.CE)("button",{key:2,textContent:(0,r.v_)(e.task.strings.retryButton),onClick:t[2]||(t[2]=(...t)=>e.onClickRetry&&e.onClickRetry(...t)),type:"button",class:"stud5p-button"},null,8,Mr)):(0,a.Q3)("",!0)])]),e.debug?((0,a.uX)(),(0,a.CE)("div",Pr,[zr,(0,a.Lk)("pre",null,(0,r.v_)(e.markedWords),1),Wr,(0,a.Lk)("pre",null,(0,r.v_)(e.task.template),1),Ur,(0,a.Lk)("pre",null,(0,r.v_)(e.splitTemplate),1),Vr,(0,a.Lk)("pre",null,(0,r.v_)(e.parsedTemplate),1)])):(0,a.Q3)("",!0)])}var Or=(0,a.pM)({name:"MarkTheWordsViewer",props:{task:{type:Object,required:!0}},components:{FeedbackElement:ie},data(){return{markedWords:new Set,showResults:!1,showSolutions:!1,debug:!1}},methods:{onClickCheck(){this.showResults=!0},onClickShowSolutions(){this.showSolutions=!0},onClickRetry(){this.showResults=!1,this.showSolutions=!1,this.markedWords.clear()},onClickWord(e){this.showResults||(this.isMarked(e)?this.markedWords.delete(e):this.markedWords.add(e))},onWordKeydown(e,t){"Space"===e.code?e.preventDefault():"Enter"!==e.code&&"Return"!==e.code||(e.preventDefault(),this.onClickWord(t))},onWordKeyup(e,t){"Space"===e.code&&(e.preventDefault(),this.onClickWord(t))},classForWord(e){return this.showResults?this.isMarked(e)?"solution"===e.type?"correct-answer":"incorrect-answer":this.showSolutions&&"solution"===e.type?"solution":"static-word-no-hover":this.isMarked(e)?"marked-word":"static-word"},isMarked(e){return this.markedWords.has(e)},sanitizeText(e){return e.replace(/<\/?p>/g,"").replace(/&nbsp;/g," ")}},computed:{splitTemplate(){const e=this.sanitizeText(this.task.template),t=e.split(/(\*[^*]+\*)/g),n=t.flatMap((e=>/^\*[^*]+\*$/.test(e)?e:e.split(/(<br\s*\/?>|\s+|[.,!?;:()–—])/g).filter(Boolean)));return n},parsedTemplate(){let e=[];return this.splitTemplate.forEach((t=>{if(/^\*[^*]+\*$/.test(t)){const n=t.replace(/\*/g,"");e.push({type:"solution",uuid:(0,i.A)(),text:n})}else/^\s+$/.test(t)?e.push({type:"space",uuid:(0,i.A)()}):/^<br\s*\/?>$/.test(t)?e.push({type:"line-break",uuid:(0,i.A)()}):/[.,!?;:()–—]/.test(t)?e.push({type:"punctuation",uuid:(0,i.A)(),text:t}):e.push({type:"word",uuid:(0,i.A)(),text:t})})),e},showCheckButton(){return!this.showResults},showRetryButton(){return this.task.retryAllowed&&this.showResults&&!this.allAnswersAreCorrect},showSolutionsButton(){return this.task.showSolutionsAllowed&&this.showResults&&!this.showSolutions&&!this.allAnswersAreCorrect},score(){let e=0;for(const t of this.markedWords)"solution"===t.type?e++:e--;return e<0&&(e=0),e},maxScore(){let e=0;for(const t of this.parsedTemplate)"solution"===t.type&&e++;return e},resultMessage(){let e=this.task.strings.resultMessage.replace(":correct",this.score.toString());return e=e.replace(":total",this.maxScore.toString()),e},allAnswersAreCorrect(){return this.score===this.maxScore}}});const Qr=(0,v.A)(Or,[["render",Xr],["__scopeId","data-v-8fc7d02c"]]);var Hr=Qr;const jr={class:"stud5p-task"},Nr={class:"default"},$r={class:"memory-editor"},Kr={class:"cards-list"},Gr=["onClick"],Jr=["textContent"],qr=["onClick","aria-label"],Yr=["src"],Zr={key:0,class:"edited-memory-card"},ed={key:1,class:"no-card-selected-placeholder"},td={class:"collapsable collapsed"},nd={key:0,class:"flipside-image-and-button-container"},id={class:"collapsable collapsed"},od=["disabled"],sd={class:"collapsable collapsed"};function ad(e,t,n,i,o,s){const d=(0,a.g2)("MemoryEditorCard"),u=(0,a.g2)("LazyImage"),c=(0,a.g2)("FileUpload");return(0,a.uX)(),(0,a.CE)("div",jr,[(0,a.Lk)("form",Nr,[(0,a.Lk)("fieldset",$r,[(0,a.Lk)("legend",null,(0,r.v_)(e.$gettext("Memory")),1),(0,a.Lk)("div",Kr,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.modelTaskDefinition.cards,((t,n)=>((0,a.uX)(),(0,a.CE)("div",{key:t.uuid,class:(0,r.C4)({"cards-list-item":!0,"selected-card":n===e.selectedCardIndex}),onClick:t=>e.selectCard(n)},[(0,a.Lk)("div",{textContent:(0,r.v_)(e.listEntryText(n,t)),class:"list-entry-text"},null,8,Jr),(0,a.Lk)("button",{type:"button",class:"flex-child-element remove-card-button",onClick:(0,l.D$)((t=>e.deleteCard(n)),["stop"]),"aria-label":e.$pgettext("Karte im Memory Spiel","Karte löschen")},[(0,a.Lk)("img",{src:e.urlForIcon("trash"),alt:""},null,8,Yr)],8,qr)],10,Gr)))),128)),(0,a.Lk)("button",{type:"button",class:"button add add-card-button",onClick:t[0]||(t[0]=(...t)=>e.addCard&&e.addCard(...t))},(0,r.v_)(e.$gettext("Karte hinzufügen")),1)]),e.modelTaskDefinition.cards[e.selectedCardIndex]?((0,a.uX)(),(0,a.CE)("div",Zr,[(0,a.bF)(d,{card:e.modelTaskDefinition.cards[e.selectedCardIndex],"onUpdate:card":e.updateCard},null,8,["card","onUpdate:card"])])):((0,a.uX)(),(0,a.CE)("fieldset",ed,[(0,a.Lk)("legend",null,(0,r.v_)(e.$gettext("Keine Karte ausgewählt")),1)]))]),(0,a.Lk)("fieldset",td,[(0,a.Lk)("legend",null,(0,r.v_)(e.$gettext("Einstellungen")),1),(0,a.Lk)("label",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=t=>e.modelTaskDefinition.retryAllowed=t),onChange:t[2]||(t[2]=(...t)=>e.updateTaskDefinition&&e.updateTaskDefinition(...t)),type:"checkbox"},null,544),[[l.lH,e.modelTaskDefinition.retryAllowed]]),(0,a.eW)(" "+(0,r.v_)(e.$gettext("Mehrere Versuche erlauben")),1)]),(0,a.Lk)("label",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[3]||(t[3]=t=>e.modelTaskDefinition.squareLayout=t),onChange:t[4]||(t[4]=(...t)=>e.updateTaskDefinition&&e.updateTaskDefinition(...t)),type:"checkbox"},null,544),[[l.lH,e.modelTaskDefinition.squareLayout]]),(0,a.eW)(" "+(0,r.v_)(e.$gettext("Karten in einem Quadrat positionieren")),1)]),(0,a.Lk)("label",null,[(0,a.eW)((0,r.v_)(e.$gettext("Rückseite"))+" ",1),e.modelTaskDefinition.flipside&&e.modelTaskDefinition.flipside.file_id?((0,a.uX)(),(0,a.CE)("span",nd,[(0,a.bF)(u,{src:e.fileIdToUrl(e.modelTaskDefinition.flipside.file_id),alt:e.modelTaskDefinition.flipside.altText,class:"flipside-image"},null,8,["src","alt"]),(0,a.Lk)("button",{onClick:t[5]||(t[5]=(...t)=>e.deleteFlipsideImage&&e.deleteFlipsideImage(...t)),type:"button",class:"button delete-flipside-image-button"},(0,r.v_)(e.$gettext("Bild Löschen")),1)])):((0,a.uX)(),(0,a.Wv)(c,{key:1,onFileUploaded:e.onFlipsideImageUploaded},null,8,["onFileUploaded"]))])]),(0,a.Lk)("fieldset",id,[(0,a.Lk)("legend",null,(0,r.v_)(e.$gettext("Beschriftungen")),1),(0,a.Lk)("label",{class:(0,r.C4)({"setting-disabled":!e.modelTaskDefinition.retryAllowed})},[(0,a.eW)((0,r.v_)(e.$gettext("Text für Wiederholen-Button:"))+" ",1),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[6]||(t[6]=t=>e.modelTaskDefinition.strings.retryButton=t),onInput:t[7]||(t[7]=t=>e.updateTaskDefinition("taskDefinition.strings.retryButton")),disabled:!e.modelTaskDefinition.retryAllowed,type:"text"},null,40,od),[[l.Jo,e.modelTaskDefinition.strings.retryButton]])],2)]),(0,a.Lk)("fieldset",sd,[(0,a.Lk)("legend",null,(0,r.v_)(e.$gettext("Feedback")),1),(0,a.Lk)("label",null,[(0,a.eW)((0,r.v_)(e.$gettext("Ergebnismitteilung:"))+" ",1),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[8]||(t[8]=t=>e.modelTaskDefinition.strings.resultMessage=t),onInput:t[9]||(t[9]=t=>e.updateTaskDefinition("taskDefinition.strings.resultMessage")),type:"text"},null,544),[[l.Jo,e.modelTaskDefinition.strings.resultMessage]])])])])])}const ld={class:"memory-editor-card"},rd={key:0,class:"image-memory-card-container"},dd={class:"multimedia-element-wrapper"},ud={style:{"align-self":"stretch"}},cd=["value"],pd={key:0,id:"secondImage",class:"image-memory-card-container"},hd={class:"multimedia-element-wrapper"},md={style:{"align-self":"stretch"}},kd=["value"];function gd(e,t,n,i,o,s){const l=(0,a.g2)("MultimediaElement"),d=(0,a.g2)("FileUpload");return(0,a.uX)(),(0,a.CE)("fieldset",ld,[(0,a.Lk)("legend",null,(0,r.v_)(e.$gettext("Karte")),1),(0,a.Lk)("label",null,(0,r.v_)(e.$gettext(e.card.second?"Erstes Bild":"Bild")),1),"image"===e.card.first.type&&e.card.first.file_id?((0,a.uX)(),(0,a.CE)("div",rd,[(0,a.Lk)("div",dd,[(0,a.bF)(l,{element:e.card.first},null,8,["element"])]),(0,a.Lk)("button",{type:"button",onClick:t[0]||(t[0]=t=>e.onClickDeleteImage("first")),class:"button trash settings-item"},(0,r.v_)(e.$gettext("Bild löschen")),1),(0,a.Lk)("label",ud,[(0,a.eW)((0,r.v_)(e.$gettext("Bildbeschreibung"))+" ",1),(0,a.Lk)("input",{type:"text",value:e.card.first.altText,onInput:t[1]||(t[1]=t=>e.onInputAltText(t,"first")),class:"settings-item"},null,40,cd)])])):((0,a.uX)(),(0,a.Wv)(d,{key:1,onFileUploaded:t[2]||(t[2]=t=>e.onUploadImage(t,"first"))})),e.card.second?((0,a.uX)(),(0,a.CE)(a.FK,{key:2},[(0,a.Lk)("label",null,(0,r.v_)(e.$gettext("Zweites Bild")),1),"image"===e.card.second.type&&e.card.second.file_id?((0,a.uX)(),(0,a.CE)("div",pd,[(0,a.Lk)("div",hd,[(0,a.bF)(l,{element:e.card.second,class:"multimedia-element"},null,8,["element"])]),(0,a.Lk)("button",{type:"button",onClick:t[3]||(t[3]=t=>e.onClickDeleteImage("second")),class:"button trash settings-item"},(0,r.v_)(e.$gettext("Bild löschen")),1),(0,a.Lk)("label",md,[(0,a.eW)((0,r.v_)(e.$gettext("Bildbeschreibung"))+" ",1),(0,a.Lk)("input",{type:"text",value:e.card.second.altText,onInput:t[4]||(t[4]=t=>e.onInputAltText(t,"second")),class:"settings-item"},null,40,kd)])])):((0,a.uX)(),(0,a.Wv)(d,{key:1,onFileUploaded:t[5]||(t[5]=t=>e.onUploadImage(t,"second"))}))],64)):e.card.first.file_id?((0,a.uX)(),(0,a.CE)("button",{key:3,type:"button",onClick:t[6]||(t[6]=(...t)=>e.addSecondImage&&e.addSecondImage(...t)),class:"button add-image-button"},(0,r.v_)(e.$gettext("Zweites Bild hinzufügen")),1)):(0,a.Q3)("",!0)])}const fd={class:"multimedia-element"},vd={key:0,class:"image-element-wrapper"},bd={key:1,class:"image-element-placeholder"},wd={key:1,class:"text-element"};function yd(e,t,n,i,o,s){const l=(0,a.g2)("LazyImage"),d=(0,a.gN)("disable-drag");return(0,a.bo)(((0,a.uX)(),(0,a.CE)("span",fd,["image"===e.element.type?((0,a.uX)(),(0,a.CE)("span",vd,[e.element.file_id?((0,a.uX)(),(0,a.Wv)(l,{key:0,src:e.fileIdToUrl(e.element.file_id),alt:e.element.altText,class:"image-element"},null,8,["src","alt"])):((0,a.uX)(),(0,a.CE)("span",bd))])):"text"===e.element.type?((0,a.uX)(),(0,a.CE)("span",wd,[(0,a.Lk)("span",null,(0,r.v_)(e.element.content),1)])):(0,a.Q3)("",!0)])),[[d]])}var Ad=(0,a.pM)({name:"MultimediaElement",components:{LazyImage:In},props:{element:{type:Object,required:!0}},methods:{fileIdToUrl:Mp}});const Td=(0,v.A)(Ad,[["render",yd],["__scopeId","data-v-20c78112"]]);var Cd=Td,Ed=(0,a.pM)({name:"MemoryEditorCard",components:{MultimediaElement:Cd,FileUpload:an},props:{card:{type:Object,required:!0}},methods:{$gettext:s.o_,onUploadImage(e,t){this.$emit("update:card",{...this.card,[t]:{...this.card[t],file_id:e.id}})},onInputAltText(e,t){const n=e.target.value;this.$emit("update:card",{...this.card,[t]:{...this.card[t],altText:n}},this.card[t]?.uuid+".altText")},addSecondImage(){this.$emit("update:card",{...this.card,second:{uuid:(0,i.A)(),type:"image",file_id:"",altText:""}})},onClickDeleteImage(e){"first"===e?this.$emit("update:card",{...this.card,first:{...this.card.first,file_id:""}}):this.$emit("update:card",{...this.card,second:void 0})}}});const Dd=(0,v.A)(Ed,[["render",gd],["__scopeId","data-v-de915fa4"]]);var Id=Dd,Sd=(0,a.pM)({name:"MemoryEditor",setup(){return{taskEditor:(0,a.WQ)(u.c)}},components:{LazyImage:In,MemoryEditorCard:Id,FileUpload:an},props:{taskDefinition:{type:Object,required:!0}},data(){return{selectedCardIndex:-1,modelTaskDefinition:(0,m.cloneDeep)(this.taskDefinition)}},watch:{taskDefinition:{immediate:!0,handler:function(){this.modelTaskDefinition=(0,m.cloneDeep)(this.taskDefinition)}}},beforeMount(){this.taskDefinition.cards.length>0&&(this.selectedCardIndex=0)},methods:{fileIdToUrl:Mp,$gettext:s.o_,$pgettext:s.Il,updateTaskDefinition(e){this.taskEditor.performEdit({newTaskDefinition:(0,m.cloneDeep)(this.modelTaskDefinition),undoBatch:e??{}})},urlForIcon(e){return window.STUDIP.ASSETS_URL+"images/icons/blue/"+e+".svg"},selectCard(e){this.selectedCardIndex=e},listEntryText(e,t){let n=e+1+". ";return n+=(0,s.o_)("Paar"),n},addCard(){this.modelTaskDefinition=(0,S.Ay)(this.modelTaskDefinition,(e=>{e.cards.push({uuid:(0,i.A)(),first:{uuid:(0,i.A)(),type:"image",file_id:"",altText:""}})})),this.taskEditor.performEdit({newTaskDefinition:this.modelTaskDefinition,undoBatch:{}}),this.selectedCardIndex=this.modelTaskDefinition.cards.length-1},deleteCard(e){this.modelTaskDefinition=(0,S.Ay)(this.modelTaskDefinition,(t=>{t.cards.splice(e,1)})),this.updateTaskDefinition(),e<=this.selectedCardIndex&&(this.selectedCardIndex=this.selectedCardIndex-1)},updateCard(e,t){this.modelTaskDefinition=(0,S.Ay)(this.modelTaskDefinition,(t=>{t.cards[this.selectedCardIndex]=e})),this.updateTaskDefinition(t)},onFlipsideImageUploaded(e){const t=(0,S.Ay)(this.modelTaskDefinition,(t=>{t.flipside={uuid:(0,i.A)(),type:"image",file_id:e.id,altText:""}}));this.taskEditor.performEdit({newTaskDefinition:t,undoBatch:{}})},deleteFlipsideImage(){const e=(0,S.Ay)(this.modelTaskDefinition,(e=>{e.flipside=void 0}));this.taskEditor.performEdit({newTaskDefinition:e,undoBatch:{}})}}});const xd=(0,v.A)(Sd,[["render",ad],["__scopeId","data-v-e3fd84b0"]]);var Ld=xd;const Bd={class:"stud5p-task"},Rd={key:0,style:{display:"flex","flex-direction":"column","align-items":"flex-start",gap:"0.25em","padding-top":"1em","padding-bottom":"0.5em"}},_d=["textContent"],Fd=["textContent"],Md=["textContent"],Pd=["textContent"],zd=["textContent"],Wd=["textContent"],Ud={key:0,class:"result-message"},Vd={class:"button-panel"},Xd=["textContent"];function Od(e,t,n,i,o,s){const l=(0,a.g2)("MemoryViewerCard");return(0,a.uX)(),(0,a.CE)("div",Bd,[(0,a.Lk)("div",{class:"memory-grid",style:(0,r.Tr)({gridTemplateColumns:e.gridTemplateColumns,gridTemplateRows:e.gridTemplateRows})},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(this.cards,(t=>((0,a.uX)(),(0,a.Wv)(l,{key:t.id,card:t,flipside:e.task.flipside,onClick:n=>e.onClickCard(t)},null,8,["card","flipside","onClick"])))),128))],4),e.isPlayable?((0,a.uX)(),(0,a.CE)("div",Rd,[(0,a.Lk)("div",null,[(0,a.Lk)("span",{class:"memory-info-header",textContent:(0,r.v_)(e.$gettext("Zeit:"))},null,8,_d),(0,a.Lk)("span",{textContent:(0,r.v_)(" "+e.$gettext("%{ time } Sekunden",{time:this.timer.toString()}))},null,8,Fd)]),(0,a.Lk)("div",null,[(0,a.Lk)("span",{class:"memory-info-header",textContent:(0,r.v_)(e.$gettext("Umgedrehte Karten:"))},null,8,Md),(0,a.Lk)("span",{textContent:(0,r.v_)(" "+this.amountOfFlips.toString())},null,8,Pd)]),(0,a.Lk)("div",null,[(0,a.Lk)("span",{class:"memory-info-header",textContent:(0,r.v_)(e.$gettext("Aufgedeckte Paare:"))},null,8,zd),(0,a.Lk)("span",{textContent:(0,r.v_)(" "+e.$gettext("%{ amountOfPairsSolved } von %{ totalAmountOfPairs }",{amountOfPairsSolved:this.amountOfPairsSolved.toString(),totalAmountOfPairs:this.totalAmountOfPairs.toString()}))},null,8,Wd)]),e.showResults?((0,a.uX)(),(0,a.CE)("div",Ud,(0,r.v_)(this.resultMessage),1)):(0,a.Q3)("",!0)])):(0,a.Q3)("",!0),(0,a.Lk)("div",Vd,[e.showRetryButton?((0,a.uX)(),(0,a.CE)("button",{key:0,textContent:(0,r.v_)(this.task.strings.retryButton),onClick:t[0]||(t[0]=(...t)=>e.onClickTryAgain&&e.onClickTryAgain(...t)),type:"button",class:"stud5p-button"},null,8,Xd)):(0,a.Q3)("",!0)])])}var Qd="data:image/png;base64,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";const Hd={class:"memory-card-back"},jd=["alt"];function Nd(e,t,n,i,o,s){const l=(0,a.g2)("MultimediaElement"),d=(0,a.g2)("lazy-image"),u=(0,a.gN)("disable-drag");return(0,a.bo)(((0,a.uX)(),(0,a.CE)("button",{type:"button",class:(0,r.C4)(["memory-card no-select",{flipped:e.card.flipped}])},[(0,a.Lk)("span",{class:(0,r.C4)(["memory-card-front",{"solved-card":e.card.solved}])},[(0,a.bF)(l,{element:e.card},null,8,["element"])],2),(0,a.Lk)("span",Hd,[e.flipside?((0,a.uX)(),(0,a.Wv)(d,{key:0,src:e.fileIdToUrl(e.flipside.file_id),alt:e.flipside.altText,class:"memory-card-back-image"},null,8,["src","alt"])):((0,a.uX)(),(0,a.CE)("img",{key:1,src:Qd,alt:e.$gettext("Rückseite einer Memory Karte."),class:"memory-card-back-image"},null,8,jd))])],2)),[[u]])}var $d=(0,a.pM)({name:"MemoryViewerCard",components:{MultimediaElement:Cd,LazyImage:In},props:{card:{type:Object,required:!0},flipside:{type:Object,required:!1}},computed:{},methods:{$gettext:s.o_,fileIdToUrl:Mp}});const Kd=(0,v.A)($d,[["render",Nd],["__scopeId","data-v-6a6f67ea"]]);var Gd=Kd,Jd=(0,a.pM)({name:"MemoryViewer",components:{MemoryViewerCard:Gd},emits:["updateAttempt"],props:{task:{type:Object,required:!0}},data(){return{cards:[],firstFlippedCardId:void 0,firstFlippedCardMatchingCardId:void 0,amountOfFlips:0,timer:0,timerStarted:!1,timerInterval:null}},methods:{$gettext:s.o_,onClickCard(e){if(!e.flipped)if(e.flipped=!0,this.timerStarted||this.startTimer(),this.amountOfFlips++,this.firstFlippedCardId){if(e.matchingCardId===this.firstFlippedCardMatchingCardId){e.solved=!0;const t=this.getCardById(this.firstFlippedCardId);t.solved=!0}this.firstFlippedCardId=void 0,this.firstFlippedCardMatchingCardId=void 0}else this.resetAllUnsolvedCardsExcept(e.uuid),this.firstFlippedCardId=e.uuid,this.firstFlippedCardMatchingCardId=e.matchingCardId},startTimer(){this.timerStarted=!0,this.timerInterval=setInterval((()=>{this.timer++}),1e3)},stopTimer(){null!==this.timerInterval&&(clearInterval(this.timerInterval),this.timerInterval=null),this.timerStarted=!1},resetAllUnsolvedCardsExcept(e){for(const t of this.cards)t.solved||t.uuid===e||(t.flipped=!1)},onClickTryAgain(){this.amountOfFlips=0,this.timer=0,this.firstFlippedCardId=void 0,this.resetCards(),this.shuffleCards()},resetCards(){for(const e of this.cards)e.flipped=!1,e.solved=!1},shuffleCards(){this.cards=this.cards.map((e=>({card:e,sort:Math.random()}))).sort(((e,t)=>e.sort-t.sort)).map((({card:e})=>e))},getCardById(e){const t=this.cards.find((t=>t.uuid===e));if(!t)throw new Error("No card found with the given ID: "+e);return t},createCard(e,t){return{uuid:e.uuid,type:e.type,file_id:"text"!==e.type?e.file_id:void 0,altText:"text"!==e.type?e.altText:void 0,content:"text"===e.type?e.content:void 0,flipped:!1,solved:!1,matchingCardId:t}}},computed:{totalAmountOfPairs(){return this.task.cards.length},isPlayable(){for(const e of this.task.cards)if(("image"===e.first.type||"audio"===e.first.type)&&e.first.file_id)return!0;return!1},amountOfPairsSolved(){let e=0;for(const t of this.cards)t.solved&&e++;return e/2},gameIsOver(){return this.totalAmountOfPairs>0&&this.amountOfPairsSolved===this.totalAmountOfPairs},showResults(){return this.gameIsOver},showRetryButton(){return this.gameIsOver},resultMessage(){return this.task.strings.resultMessage},gridTemplateColumns(){if(this.task.squareLayout){const e=Math.ceil(Math.sqrt(this.cards.length));return`repeat(${e}, 1fr)`}return"repeat(auto-fill, minmax(12em, 1fr))"},gridTemplateRows(){if(this.task.squareLayout){const e=Math.ceil(this.cards.length/Math.ceil(Math.sqrt(this.cards.length)));return`repeat(${e}, 1fr)`}return"auto"}},watch:{task:{handler(){console.log("watcher for this.task"),this.firstFlippedCardId=void 0,this.amountOfFlips=0,this.cards=this.task.cards.flatMap((e=>{if(e.second){const t=this.createCard(e.first,e.uuid),n=this.createCard(e.second,e.uuid);return[t,n]}{const t=this.createCard(e.first,e.uuid),n=this.createCard({...e.first,uuid:(0,i.A)()},e.uuid);return[t,n]}})),this.shuffleCards()},immediate:!0},gameIsOver(e){e&&this.stopTimer()}}});const qd=(0,v.A)(Jd,[["render",Od],["__scopeId","data-v-180b5606"]]);var Yd=qd;const Zd={class:"stud5p-task"},eu={class:"default"},tu={class:"pairing-editor"},nu={class:"pairs-overview"},iu={key:0,class:"selected-pair"},ou={class:"remove-pair-button-container"},su=["textContent"],au={class:"collapsable collapsed"},lu={class:"collapsable collapsed"},ru=["disabled"],du=["disabled"];function uu(e,t,n,i,o,s){const d=(0,a.g2)("PairingEditorPair"),u=(0,a.g2)("PairingEditorCard"),c=(0,a.g2)("FeedbackEditor");return(0,a.uX)(),(0,a.CE)("div",Zd,[(0,a.Lk)("form",eu,[(0,a.Lk)("fieldset",tu,[(0,a.Lk)("legend",null,(0,r.v_)(e.$gettext("Pairing")),1),(0,a.Lk)("div",nu,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.modelTaskDefinition.pairs,((t,n)=>((0,a.uX)(),(0,a.Wv)(d,{key:t.uuid,class:(0,r.C4)({selected:n===e.selectedPairIndex}),pair:e.modelTaskDefinition.pairs[n],onClick:t=>e.onClickPair(n)},null,8,["class","pair","onClick"])))),128)),(0,a.Lk)("button",{type:"button",class:"add-pair-button",onClick:t[0]||(t[0]=t=>e.onClickAddPair()),style:(0,r.Tr)(e.addPairButtonBackgroundImage)},null,4)]),e.selectedPair?((0,a.uX)(),(0,a.CE)("fieldset",iu,[(0,a.Lk)("legend",null,(0,r.v_)(e.$gettext("Paar")),1),(0,a.bF)(u,{title:e.$gettext("Karte 1"),"multimedia-element":e.selectedPair.draggableElement,onElementChanged:e.onChangeDraggableElement},null,8,["title","multimedia-element","onElementChanged"]),(0,a.bF)(u,{title:e.$gettext("Karte 2"),"multimedia-element":e.selectedPair.targetElement,onElementChanged:e.onChangeTargetElement},null,8,["title","multimedia-element","onElementChanged"]),(0,a.Lk)("div",ou,[(0,a.Lk)("button",{type:"button",onClick:t[1]||(t[1]=t=>e.onClickDeletePair(e.selectedPairIndex)),textContent:(0,r.v_)(e.$gettext("Paar löschen")),class:"button trash remove-pair-button"},null,8,su)])])):(0,a.Q3)("",!0)]),(0,a.Lk)("fieldset",au,[(0,a.Lk)("legend",null,(0,r.v_)(e.$gettext("Einstellungen")),1),(0,a.Lk)("label",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[2]||(t[2]=t=>e.modelTaskDefinition.retryAllowed=t),onChange:t[3]||(t[3]=(...t)=>e.updateTaskDefinition&&e.updateTaskDefinition(...t)),type:"checkbox"},null,544),[[l.lH,e.modelTaskDefinition.retryAllowed]]),(0,a.eW)(" "+(0,r.v_)(e.$gettext("Mehrere Versuche erlauben")),1)]),(0,a.Lk)("label",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[4]||(t[4]=t=>e.modelTaskDefinition.showSolutionsAllowed=t),onChange:t[5]||(t[5]=(...t)=>e.updateTaskDefinition&&e.updateTaskDefinition(...t)),type:"checkbox"},null,544),[[l.lH,e.modelTaskDefinition.showSolutionsAllowed]]),(0,a.eW)(" "+(0,r.v_)(e.$gettext("Lösungen anzeigen erlauben")),1)])]),(0,a.Lk)("fieldset",lu,[(0,a.Lk)("legend",null,(0,r.v_)(e.$gettext("Beschriftungen")),1),(0,a.Lk)("label",null,[(0,a.eW)((0,r.v_)(e.$gettext("Text für Überprüfen-Button:"))+" ",1),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[6]||(t[6]=t=>e.modelTaskDefinition.strings.checkButton=t),onInput:t[7]||(t[7]=t=>e.updateTaskDefinition("taskDefinition.strings.checkButton")),type:"text"},null,544),[[l.Jo,e.modelTaskDefinition.strings.checkButton]])]),(0,a.Lk)("label",{class:(0,r.C4)({"setting-disabled":!e.modelTaskDefinition.retryAllowed})},[(0,a.eW)((0,r.v_)(e.$gettext("Text für Wiederholen-Button:"))+" ",1),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[8]||(t[8]=t=>e.modelTaskDefinition.strings.retryButton=t),onInput:t[9]||(t[9]=t=>e.updateTaskDefinition("taskDefinition.strings.retryButton")),disabled:!e.modelTaskDefinition.retryAllowed,type:"text"},null,40,ru),[[l.Jo,e.modelTaskDefinition.strings.retryButton]])],2),(0,a.Lk)("label",{class:(0,r.C4)({"setting-disabled":!e.modelTaskDefinition.showSolutionsAllowed})},[(0,a.eW)((0,r.v_)(e.$gettext("Text für Lösungen-Button:"))+" ",1),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[10]||(t[10]=t=>e.modelTaskDefinition.strings.solutionsButton=t),onInput:t[11]||(t[11]=t=>e.updateTaskDefinition("taskDefinition.strings.solutionsButton")),disabled:!e.modelTaskDefinition.showSolutionsAllowed,type:"text"},null,40,du),[[l.Jo,e.modelTaskDefinition.strings.solutionsButton]])],2)]),(0,a.bF)(c,{feedback:e.modelTaskDefinition.feedback,"result-message":e.modelTaskDefinition.strings.resultMessage,"onUpdate:feedback":e.updateFeedback,"onUpdate:resultMessage":e.updateResultMessage},null,8,["feedback","result-message","onUpdate:feedback","onUpdate:resultMessage"])])])}const cu={type:"button",class:"pairing-editor-pair"},pu={class:"pair-element"},hu={class:"pair-element"};function mu(e,t,n,i,o,s){const l=(0,a.g2)("MultimediaElement");return(0,a.uX)(),(0,a.CE)("button",cu,[(0,a.Lk)("span",pu,[e.pair.draggableElement?((0,a.uX)(),(0,a.Wv)(l,{key:0,element:e.pair.draggableElement},null,8,["element"])):(0,a.Q3)("",!0)]),(0,a.Lk)("span",hu,[e.pair.targetElement?((0,a.uX)(),(0,a.Wv)(l,{key:0,element:e.pair.targetElement},null,8,["element"])):(0,a.Q3)("",!0)])])}var ku=(0,a.pM)({name:"PairingEditorPair",components:{MultimediaElement:Cd},props:{pair:{type:Object,required:!0}},methods:{$gettext:s.o_}});const gu=(0,v.A)(ku,[["render",mu],["__scopeId","data-v-c8b6ce94"]]);var fu=gu;const vu={class:"pairing-editor-card"},bu={key:0,class:"multimedia-element-container"},wu={class:"multimedia-element-wrapper"},yu=["textContent"],Au={key:1,class:"pairing-file-upload"},Tu={style:{"align-self":"stretch"}},Cu=["value"],Eu={key:1},Du={style:{"align-self":"stretch"}},Iu=["value"];function Su(e,t,n,i,o,s){const l=(0,a.g2)("MultimediaElement"),d=(0,a.g2)("FileUpload");return(0,a.uX)(),(0,a.CE)("fieldset",vu,[(0,a.Lk)("legend",null,(0,r.v_)(e.title),1),"image"==e.multimediaElement.type?((0,a.uX)(),(0,a.CE)("div",bu,[e.multimediaElement.file_id?((0,a.uX)(),(0,a.CE)(a.FK,{key:0},[(0,a.Lk)("div",wu,[(0,a.bF)(l,{element:e.multimediaElement},null,8,["element"])]),(0,a.Lk)("button",{type:"button",onClick:t[0]||(t[0]=t=>e.onClickRemoveImage()),textContent:(0,r.v_)(e.$gettext("Bild löschen")),class:"button trash element-pair-settings-item"},null,8,yu)],64)):((0,a.uX)(),(0,a.CE)("div",Au,[(0,a.bF)(d,{onFileUploaded:t[1]||(t[1]=t=>e.onUploadImage(t))})])),(0,a.Lk)("label",Tu,[(0,a.eW)((0,r.v_)(e.$gettext("Bildbeschreibung"))+" ",1),(0,a.Lk)("input",{type:"text",value:e.multimediaElement.altText,onInput:t[2]||(t[2]=t=>e.onInputAltText(t)),class:"element-pair-settings-item"},null,40,Cu)])])):"text"==e.multimediaElement.type?((0,a.uX)(),(0,a.CE)("div",Eu,[(0,a.Lk)("label",Du,[(0,a.eW)((0,r.v_)(e.$gettext("Inhalt"))+" ",1),(0,a.Lk)("textarea",{type:"text",value:e.multimediaElement.content,onInput:t[3]||(t[3]=t=>e.onInputContent(t)),class:"element-pair-settings-item"},null,40,Iu)])])):(0,a.Q3)("",!0)])}var xu=(0,a.pM)({name:"PairingEditorCard",components:{FileUpload:an,MultimediaElement:Cd},props:{title:{type:String,required:!0},multimediaElement:{type:Object,required:!0}},emits:{elementChanged(e){return!0}},data(){return{}},methods:{$gettext:s.o_,createNewLernmoduleMultimediaElement(e){switch(e){case"image":return{uuid:(0,i.A)(),type:e,file_id:"",altText:""};case"audio":return{uuid:(0,i.A)(),type:e,file_id:"",altText:""};case"text":return{uuid:(0,i.A)(),type:e,content:""};default:throw new Error((0,s.o_)("Ungültiges MultimediaElementType: ")+e)}},onChangeType(e){const t=e.target,n=t.value;this.$emit("elementChanged",{updatedElement:this.createNewLernmoduleMultimediaElement(n)})},onClickRemoveImage(){this.$emit("elementChanged",{updatedElement:{...this.multimediaElement,file_id:""}})},onUploadImage(e){const t={...this.multimediaElement,file_id:e.id};this.$emit("elementChanged",{updatedElement:t})},onInputAltText(e){const t=e.target,n=t.value,i={...this.multimediaElement,altText:n};this.$emit("elementChanged",{updatedElement:i,undoBatch:{field:"altText",uuid:this.multimediaElement.uuid}})},onInputContent(e){const t=e.target,n=t.value,i={...this.multimediaElement,content:n};this.$emit("elementChanged",{updatedElement:i,undoBatch:{field:"content",uuid:this.multimediaElement.uuid}})}},computed:{}});const Lu=(0,v.A)(xu,[["render",Su],["__scopeId","data-v-5df590ee"]]);var Bu=Lu,Ru=(0,a.pM)({name:"PairingEditor",setup(){return{taskEditor:(0,a.WQ)(u.c)}},components:{PairingEditorPair:fu,PairingEditorCard:Bu,FeedbackEditor:$e},props:{taskDefinition:{type:Object,required:!0}},data(){return{modelTaskDefinition:(0,m.cloneDeep)(this.taskDefinition),selectedPairIndex:-1}},watch:{taskDefinition:{immediate:!0,handler:function(){this.modelTaskDefinition=(0,m.cloneDeep)(this.taskDefinition)}}},beforeMount(){this.taskDefinition.pairs.length>0&&(this.selectedPairIndex=0)},methods:{fileIdToUrl:Mp,$gettext:s.o_,urlForIcon(e){return window.STUDIP.ASSETS_URL+"images/icons/blue/"+e+".svg"},updateTaskDefinition(e){this.taskEditor.performEdit({newTaskDefinition:(0,m.cloneDeep)(this.modelTaskDefinition),undoBatch:e??{}})},onClickPair(e){this.selectedPairIndex=e},onClickAddPair(){this.modelTaskDefinition=(0,S.Ay)(this.modelTaskDefinition,(e=>{e.pairs.push({uuid:(0,i.A)(),draggableElement:{uuid:(0,i.A)(),type:"image",file_id:"",altText:""},targetElement:{uuid:(0,i.A)(),type:"image",file_id:"",altText:""}})})),this.updateTaskDefinition(),this.selectedPairIndex=this.modelTaskDefinition.pairs.length-1},onClickDeletePair(e){this.modelTaskDefinition=(0,S.Ay)(this.modelTaskDefinition,(t=>{t.pairs.splice(e,1)})),this.updateTaskDefinition(),0===this.modelTaskDefinition.pairs.length?this.selectedPairIndex=-1:e<=this.selectedPairIndex&&(this.selectedPairIndex=Math.max(0,this.selectedPairIndex-1))},onChangeDraggableElement(e){this.modelTaskDefinition=(0,S.Ay)(this.modelTaskDefinition,(t=>{t.pairs[this.selectedPairIndex].draggableElement=e.updatedElement})),this.updateTaskDefinition(e.undoBatch)},onChangeTargetElement(e){this.modelTaskDefinition=(0,S.Ay)(this.modelTaskDefinition,(t=>{t.pairs[this.selectedPairIndex].targetElement=e.updatedElement})),this.updateTaskDefinition(e.undoBatch)},updateFeedback(e){this.taskEditor.performEdit({newTaskDefinition:(0,S.Ay)(this.modelTaskDefinition,(t=>{t.feedback=e})),undoBatch:"taskDefinition.feedback"})},updateResultMessage(e){this.taskEditor.performEdit({newTaskDefinition:(0,S.Ay)(this.modelTaskDefinition,(t=>{t.strings.resultMessage=e})),undoBatch:"taskDefinition.strings.resultMessage"})}},computed:{debug:()=>window.STUDIP.LernmoduleVueJS.LERNMODULE_DEBUG,selectedPair(){return this.modelTaskDefinition.pairs[this.selectedPairIndex]},addPairButtonBackgroundImage(){return{backgroundImage:`url(${this.urlForIcon("add")})`}}}});const _u=(0,v.A)(Ru,[["render",uu],["__scopeId","data-v-70d5756a"]]);var Fu=_u;const Mu={class:"stud5p-task"},Pu={class:"pairing-columns"},zu=["draggable","onDragstart","onClick"],Wu={class:"targetElementsColumn"},Uu={class:"feedback-and-button-container"},Vu={class:"button-panel"},Xu=["textContent"],Ou=["textContent"],Qu=["textContent"];function Hu(e,t,n,i,o,s){const d=(0,a.g2)("MultimediaElement"),u=(0,a.g2)("PairingViewerTargetElement"),c=(0,a.g2)("FeedbackElement");return(0,a.uX)(),(0,a.CE)("div",Mu,[(0,a.Lk)("div",Pu,[(0,a.Lk)("div",{class:"draggableElementsColumn",draggable:"false",onDragover:t[1]||(t[1]=(0,l.D$)((()=>{}),["prevent"])),onDragenter:t[2]||(t[2]=(0,l.D$)((()=>{}),["prevent"])),onDrop:t[3]||(t[3]=t=>e.onDropOnInteractiveElements(t))},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.draggableElements,(n=>((0,a.uX)(),(0,a.CE)("button",{type:"button",key:n,draggable:!e.isDraggableElementUsed(n)&&!e.showResults,onDragstart:t=>e.startDragElement(t,n),onDragend:t[0]||(t[0]=t=>e.endDragElement()),onClick:t=>e.onClickDraggableElement(n),class:(0,r.C4)(["draggableElement",{disabled:e.isDraggableElementUsed(n)||e.draggedElementId===n,immovable:e.showResults,selected:e.elementIdInteractedWith===n}])},[(0,a.bF)(d,{element:e.getElementById(n),ref_for:!0,ref:"draggableImages"},null,8,["element"])],42,zu)))),128))],32),(0,a.Lk)("div",Wu,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.task.pairs,(n=>((0,a.uX)(),(0,a.Wv)(u,{class:(0,r.C4)({outlined:!e.elementsDraggedOntoTargets.hasOwnProperty(n.targetElement.uuid)&&(e.draggedElementId||e.elementIdInteractedWith)}),"draggable-image":e.getElementDraggedOntoTarget(n.targetElement.uuid),"target-image":e.getElementById(n.targetElement.uuid),isCorrect:e.isAnswerCorrect(n.targetElement.uuid),showResult:e.showResults,key:n.uuid,onDrop:t=>e.onDropOnTargetElement(t,n.targetElement.uuid),onDragstart:t=>e.startDragTargetElement(t,n.targetElement.uuid),onDragend:t[4]||(t[4]=t=>e.endDragTargetElement()),onDragover:t[5]||(t[5]=(0,l.D$)((()=>{}),["prevent"])),onDragenter:t[6]||(t[6]=(0,l.D$)((()=>{}),["prevent"])),onClick:t=>e.onClickTargetElement(n.targetElement.uuid)},null,8,["class","draggable-image","target-image","isCorrect","showResult","onDrop","onDragstart","onClick"])))),128))])]),(0,a.Lk)("div",Uu,[e.showResults?((0,a.uX)(),(0,a.Wv)(c,{key:0,achievedPoints:e.correctAnswers,maxPoints:e.maxPoints,resultMessage:e.resultMessage,feedback:e.task.feedback},null,8,["achievedPoints","maxPoints","resultMessage","feedback"])):(0,a.Q3)("",!0),(0,a.Lk)("div",Vu,[e.showCheckButton?((0,a.uX)(),(0,a.CE)("button",{key:0,textContent:(0,r.v_)(e.task.strings.checkButton),onClick:t[7]||(t[7]=t=>e.onClickCheck()),type:"button",class:"stud5p-button"},null,8,Xu)):(0,a.Q3)("",!0),e.showSolutionsButton?((0,a.uX)(),(0,a.CE)("button",{key:1,textContent:(0,r.v_)(e.task.strings.solutionsButton),onClick:t[8]||(t[8]=t=>e.onClickShowSolution()),type:"button",class:"stud5p-button"},null,8,Ou)):(0,a.Q3)("",!0),e.showRetryButton?((0,a.uX)(),(0,a.CE)("button",{key:2,textContent:(0,r.v_)(e.task.strings.retryButton),onClick:t[9]||(t[9]=t=>e.onClickTryAgain()),type:"button",class:"stud5p-button"},null,8,Qu)):(0,a.Q3)("",!0)])])])}const ju={class:"image-container back"},Nu=["draggable"];function $u(e,t,n,i,o,s){const l=(0,a.g2)("MultimediaElement");return(0,a.uX)(),(0,a.CE)("button",{type:"button",class:(0,r.C4)(["grid-square",{"two-images":!!this.draggableImage,"one-image":!this.draggableImage,correct:this.isCorrect,incorrect:!this.isCorrect,showResult:this.showResult}])},[this.draggableImage?((0,a.uX)(),(0,a.CE)(a.FK,{key:0},[(0,a.Lk)("div",ju,[(0,a.bF)(l,{element:e.targetImage,class:(0,r.C4)(["image",{correct:this.isCorrect,incorrect:!this.isCorrect,showResult:this.showResult}])},null,8,["element","class"])]),(0,a.Lk)("div",{class:"image-container front",draggable:!this.showResult},[(0,a.bF)(l,{element:e.draggableImage,class:(0,r.C4)(["image",{correct:this.isCorrect,incorrect:!this.isCorrect,showResult:this.showResult}])},null,8,["element","class"])],8,Nu)],64)):((0,a.uX)(),(0,a.Wv)(l,{key:1,element:e.targetImage},null,8,["element"]))],2)}var Ku=(0,a.pM)({name:"TargetImage",components:{MultimediaElement:Cd},props:{draggableImage:{type:Object,required:!1},targetImage:{type:Object,required:!0},isCorrect:{type:Boolean,required:!1},showResult:{type:Boolean,required:!1}},computed:{},methods:{fileIdToUrl:Mp}});const Gu=(0,v.A)(Ku,[["render",$u],["__scopeId","data-v-315196fa"]]);var Ju=Gu,qu=(0,a.pM)({name:"PairingViewer",components:{MultimediaElement:Cd,PairingViewerTargetElement:Ju,FeedbackElement:ie},props:{task:{type:Object,required:!0}},emits:["updateAttempt"],data(){return{elementIdInteractedWith:void 0,draggedElementId:void 0,elementsDraggedOntoTargets:{},showResults:!1,showSolutions:!1,originalScore:null}},methods:{fileIdToUrl:Mp,isAnswerCorrect(e){const t=this.elementsDraggedOntoTargets[e];if(!t)return!1;const n=this.task.pairs.find((t=>t.targetElement.uuid===e));if(!n)throw new Error("could not find the pair to which the target id "+e+" belongs");return n.draggableElement.uuid===t},getElementDraggedOntoTarget(e){const t=this.elementsDraggedOntoTargets[e];return t?this.getElementById(t):void 0},startDragElement(e,t){this.isDraggableElementUsed(t)||(console.log("Dragging element:",t),this.elementIdInteractedWith=t,this.draggedElementId=t,e.dataTransfer.dropEffect="move",e.dataTransfer.effectAllowed="move")},endDragElement(){this.elementIdInteractedWith=void 0,this.draggedElementId=void 0},startDragTargetElement(e,t){e.dataTransfer.dropEffect="move",e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("targetId",t);const n=this.elementsDraggedOntoTargets[t];n&&(this.elementIdInteractedWith=n,console.log("Dragging element:",this.elementIdInteractedWith,"from target element",t))},endDragTargetElement(){this.elementIdInteractedWith=void 0,this.draggedElementId=void 0},onDropOnTargetElement(e,t){if(!this.elementIdInteractedWith)return;const n=e.dataTransfer?.getData("targetId");n&&delete this.elementsDraggedOntoTargets[n],this.elementsDraggedOntoTargets[t]=this.elementIdInteractedWith,console.log("Dropped element:",this.elementIdInteractedWith,"on target:",t),this.elementIdInteractedWith=void 0,this.draggedElementId=void 0},getElementById(e){const t=this.elementsById[e];if(!t)throw new Error("No element found with the given ID: "+e);return t},onClickTargetElement(e){if(console.log("Clicked on target element",e),this.showResults)return;const t=this.elementsDraggedOntoTargets[e];t&&delete this.elementsDraggedOntoTargets[e],this.elementIdInteractedWith&&(this.elementsDraggedOntoTargets[e]=this.elementIdInteractedWith,this.elementIdInteractedWith=void 0)},isDraggableElementUsed(e){return Object.values(this.elementsDraggedOntoTargets).includes(e)},onClickDraggableElement(e){this.isDraggableElementUsed(e)||this.showResults||(console.log("Clicked on element:",e),this.elementIdInteractedWith=e)},onDropOnInteractiveElements(e){if(!this.elementIdInteractedWith)return;const t=e.dataTransfer?.getData("targetId");t&&delete this.elementsDraggedOntoTargets[t],console.log("Returned element:",this.elementIdInteractedWith),this.elementIdInteractedWith=void 0},onClickCheck(){this.showResults=!0,this.originalScore=this.correctAnswers},onClickShowSolution(){this.showSolutions=!0,this.task.pairs.forEach((e=>{this.elementsDraggedOntoTargets[e.targetElement.uuid]=e.draggableElement.uuid}))},onClickTryAgain(){this.showResults=!1,this.showSolutions=!1,this.elementsDraggedOntoTargets={},this.originalScore=null}},computed:{draggableElements(){return this.task.pairs.map((e=>({pair:e,sort:Math.random()}))).sort(((e,t)=>e.sort-t.sort)).map((({pair:e})=>e.draggableElement.uuid))},elementsById(){const e={};for(const t of this.task.pairs)e[t.draggableElement.uuid]=t.draggableElement,e[t.targetElement.uuid]=t.targetElement;return e},correctAnswers(){if(this.showSolutions&&null!==this.originalScore)return this.originalScore;let e=0;for(const t of this.task.pairs)this.isAnswerCorrect(t.targetElement.uuid)&&e++;return e},maxPoints(){return this.task.pairs.length},resultMessage(){let e=this.task.strings.resultMessage.replace(":correct",this.correctAnswers.toString());return e=e.replace(":total",this.maxPoints.toString()),e},showCheckButton(){return!this.showResults},showRetryButton(){return this.task.retryAllowed&&this.showResults&&!this.allAnswersAreCorrect},showSolutionsButton(){return this.task.showSolutionsAllowed&&this.showResults&&!this.showSolutions&&!this.allAnswersAreCorrect},allAnswersAreCorrect(){return this.correctAnswers===this.maxPoints}}});const Yu=(0,v.A)(qu,[["render",Hu],["__scopeId","data-v-96ded43e"]]);var Zu=Yu;const ec={class:"stud5p-task"},tc={class:"default"},nc={class:"answer-title"},ic=["title","aria-label","onClick"],oc=["src"],sc={class:"answer-row"},ac=["checked","onInput"],lc=["onUpdate:modelValue","onInput"],rc={class:"collapsable collapsed feedback"},dc=["onUpdate:modelValue","onInput"],uc=["onUpdate:modelValue","onInput"],cc=["onUpdate:modelValue","onInput"],pc={class:"collapsable collapsed"},hc={class:"collapsable collapsed"},mc=["disabled"],kc=["disabled"];function gc(e,t,n,i,o,s){const d=(0,a.g2)("studip-wysiwyg"),u=(0,a.g2)("feedback-editor");return(0,a.uX)(),(0,a.CE)("div",ec,[(0,a.Lk)("form",tc,[(0,a.Lk)("fieldset",null,[(0,a.Lk)("legend",null,(0,r.v_)(e.$gettext("Question")),1),(0,a.Lk)("label",null,[(0,a.bF)(d,{modelValue:e.taskDefinition.question,"onUpdate:modelValue":e.onEditQuestion,"force-soft-breaks":"","remove-wrapping-p-tag":"","disable-autoformat":""},null,8,["modelValue","onUpdate:modelValue"])]),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.modelTaskDefinition.answers,((t,n)=>((0,a.uX)(),(0,a.CE)("fieldset",{key:t.uuid,class:"answer collapsable collapsed"},[(0,a.Lk)("legend",nc,[(0,a.eW)((0,r.v_)(t.text)+" ",1),(0,a.Lk)("button",{title:e.$gettext("Antwort löschen"),"aria-label":e.$gettext("Antwort löschen"),onClick:t=>e.removeAnswer(n),type:"button",class:"button-with-icon"},[(0,a.Lk)("img",{src:e.urlForIcon("trash"),alt:""},null,8,oc)],8,ic)]),(0,a.Lk)("div",sc,[(0,a.Lk)("input",{checked:e.taskDefinition.answers[n].correct,onInput:t=>e.onInputAnswerCorrect(t,n),type:"checkbox"},null,40,ac),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t=>e.modelTaskDefinition.answers[n].text=t,onInput:t=>e.updateTaskDefinition(`taskDefinition.answers[${n}].text`),type:"text"},null,40,lc),[[l.Jo,e.modelTaskDefinition.answers[n].text]])]),(0,a.Lk)("fieldset",rc,[(0,a.Lk)("legend",null,(0,r.v_)(e.$gettext("Hinweis und Feedback")),1),(0,a.Lk)("label",null,[(0,a.Lk)("span",null,(0,r.v_)(e.$gettext("Hinweis:")),1),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t=>e.modelTaskDefinition.answers[n].strings.hint=t,onInput:t=>e.updateTaskDefinition(`taskDefinition.answers[${n}].strings.hint`),type:"text"},null,40,dc),[[l.Jo,e.modelTaskDefinition.answers[n].strings.hint]])]),(0,a.Lk)("label",null,[(0,a.Lk)("span",null,(0,r.v_)(e.$gettext("Feedback, wenn ausgewählt:")),1),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t=>e.modelTaskDefinition.answers[n].strings.feedbackSelected=t,onInput:t=>e.updateTaskDefinition(`taskDefinition.answers[${n}].strings.feedbackSelected`),type:"text"},null,40,uc),[[l.Jo,e.modelTaskDefinition.answers[n].strings.feedbackSelected]])]),(0,a.Lk)("label",null,[(0,a.Lk)("span",null,(0,r.v_)(e.$gettext("Feedback, wenn nicht ausgewählt:")),1),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t=>e.modelTaskDefinition.answers[n].strings.feedbackNotSelected=t,onInput:t=>e.updateTaskDefinition(`taskDefinition.answers[${n}].strings.feedbackNotSelected`),type:"text"},null,40,cc),[[l.Jo,e.modelTaskDefinition.answers[n].strings.feedbackNotSelected]])])])])))),128)),(0,a.Lk)("button",{onClick:t[0]||(t[0]=(...t)=>e.addAnswer&&e.addAnswer(...t)),type:"button",class:"button"},(0,r.v_)(e.$gettext("Neue Antwort")),1)]),(0,a.Lk)("fieldset",pc,[(0,a.Lk)("legend",null,(0,r.v_)(e.$gettext("Einstellungen")),1),(0,a.Lk)("label",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=t=>e.modelTaskDefinition.canAnswerMultiple=t),onChange:t[2]||(t[2]=(...t)=>e.updateTaskDefinition&&e.updateTaskDefinition(...t)),type:"checkbox"},null,544),[[l.lH,e.modelTaskDefinition.canAnswerMultiple]]),(0,a.eW)(" "+(0,r.v_)(e.$gettext("Mehrfachauswahl erlauben")),1)]),(0,a.Lk)("label",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[3]||(t[3]=t=>e.modelTaskDefinition.randomOrder=t),onChange:t[4]||(t[4]=(...t)=>e.updateTaskDefinition&&e.updateTaskDefinition(...t)),type:"checkbox"},null,544),[[l.lH,e.modelTaskDefinition.randomOrder]]),(0,a.eW)(" "+(0,r.v_)(e.$gettext("Antworten in zufälliger Reihenfolge anzeigen")),1)]),(0,a.Lk)("label",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[5]||(t[5]=t=>e.modelTaskDefinition.retryAllowed=t),onChange:t[6]||(t[6]=(...t)=>e.updateTaskDefinition&&e.updateTaskDefinition(...t)),type:"checkbox"},null,544),[[l.lH,e.modelTaskDefinition.retryAllowed]]),(0,a.eW)(" "+(0,r.v_)(e.$gettext("Mehrere Versuche erlauben")),1)]),(0,a.Lk)("label",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[7]||(t[7]=t=>e.modelTaskDefinition.showSolutionsAllowed=t),onChange:t[8]||(t[8]=(...t)=>e.updateTaskDefinition&&e.updateTaskDefinition(...t)),type:"checkbox"},null,544),[[l.lH,e.modelTaskDefinition.showSolutionsAllowed]]),(0,a.eW)(" "+(0,r.v_)(e.$gettext("Lösungen anzeigen erlauben")),1)])]),(0,a.Lk)("fieldset",hc,[(0,a.Lk)("legend",null,(0,r.v_)(e.$gettext("Beschriftungen")),1),(0,a.Lk)("label",null,[(0,a.eW)((0,r.v_)(e.$gettext("Text für Überprüfen-Button:"))+" ",1),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[9]||(t[9]=t=>e.modelTaskDefinition.strings.checkButton=t),onInput:t[10]||(t[10]=t=>e.updateTaskDefinition("taskDefinition.strings.checkButton")),type:"text"},null,544),[[l.Jo,e.modelTaskDefinition.strings.checkButton]])]),(0,a.Lk)("label",{class:(0,r.C4)({"setting-disabled":!e.modelTaskDefinition.retryAllowed})},[(0,a.eW)((0,r.v_)(e.$gettext("Text für Wiederholen-Button:"))+" ",1),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[11]||(t[11]=t=>e.modelTaskDefinition.strings.retryButton=t),onInput:t[12]||(t[12]=t=>e.updateTaskDefinition("taskDefinition.strings.retryButton")),disabled:!e.modelTaskDefinition.retryAllowed,type:"text"},null,40,mc),[[l.Jo,e.modelTaskDefinition.strings.retryButton]])],2),(0,a.Lk)("label",{class:(0,r.C4)({"setting-disabled":!e.modelTaskDefinition.showSolutionsAllowed})},[(0,a.eW)((0,r.v_)(e.$gettext("Text für Lösungen-Button:"))+" ",1),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[13]||(t[13]=t=>e.modelTaskDefinition.strings.solutionsButton=t),onInput:t[14]||(t[14]=t=>e.updateTaskDefinition("taskDefinition.strings.solutionsButton")),disabled:!e.modelTaskDefinition.showSolutionsAllowed,type:"text"},null,40,kc),[[l.Jo,e.modelTaskDefinition.strings.solutionsButton]])],2)]),(0,a.bF)(u,{feedback:e.modelTaskDefinition.feedback,"result-message":e.modelTaskDefinition.strings.resultMessage,"onUpdate:feedback":e.updateFeedback,"onUpdate:resultMessage":e.updateResultMessage},null,8,["feedback","result-message","onUpdate:feedback","onUpdate:resultMessage"])])])}var fc=(0,a.pM)({name:"QuestionEditor",setup(){return{taskEditor:(0,a.WQ)(u.c)}},components:{FeedbackEditor:$e,StudipWysiwyg:_e.A},props:{taskDefinition:{type:Object,required:!0}},data(){return{modelTaskDefinition:(0,m.cloneDeep)(this.taskDefinition)}},watch:{taskDefinition:{immediate:!0,handler:function(){this.modelTaskDefinition=(0,m.cloneDeep)(this.taskDefinition)}}},methods:{$gettext:s.o_,onInputAnswerCorrect(e,t){const n=e.target.checked;this.taskEditor.performEdit({newTaskDefinition:(0,S.Ay)(this.taskDefinition,(e=>{e.answers[t].correct=n})),undoBatch:{}})},onEditQuestion(e){this.taskEditor.performEdit({newTaskDefinition:(0,S.Ay)(this.taskDefinition,(t=>{t.question=e})),undoBatch:"taskDefinition.question"})},updateTaskDefinition(e){this.taskEditor.performEdit({newTaskDefinition:(0,m.cloneDeep)(this.modelTaskDefinition),undoBatch:e??{}})},addAnswer(){this.taskEditor.performEdit({newTaskDefinition:(0,S.Ay)(this.taskDefinition,(e=>{e.answers.push({uuid:(0,i.A)(),text:this.$gettext("Neue Antwort"),correct:!0,strings:{hint:"",feedbackSelected:"",feedbackNotSelected:""}})}))})},removeAnswer(e){this.taskEditor.performEdit({newTaskDefinition:(0,S.Ay)(this.taskDefinition,(t=>{t.answers.splice(e,1)})),undoBatch:{}})},urlForIcon(e){return window.STUDIP.ASSETS_URL+"images/icons/blue/"+e+".svg"},updateFeedback(e,t){this.taskEditor.performEdit({newTaskDefinition:(0,S.Ay)(this.taskDefinition,(t=>{t.feedback=e})),undoBatch:t})},updateResultMessage(e){this.taskEditor.performEdit({newTaskDefinition:(0,S.Ay)(this.taskDefinition,(t=>{t.strings.resultMessage=e})),undoBatch:"taskDefinition.strings.resultMessage"})}}});const vc=(0,v.A)(fc,[["render",gc],["__scopeId","data-v-3555d82a"]]);var bc=vc;const wc={class:"stud5p-task"},yc=["innerHTML"],Ac=["value","onUpdate:modelValue","disabled"],Tc=["data-tooltip"],Cc={key:0,class:"answer-feedback"},Ec={key:1,class:"answer-feedback"},Dc=["value","disabled"],Ic=["data-tooltip"],Sc={key:0,class:"answer-feedback"},xc={key:1,class:"answer-feedback"},Lc={class:"feedback-and-button-container"},Bc={class:"button-panel"},Rc=["textContent"],_c=["textContent"],Fc=["textContent"];function Mc(e,t,n,i,o,s){const d=(0,a.g2)("FeedbackElement");return(0,a.uX)(),(0,a.CE)("div",wc,[(0,a.Lk)("div",null,[(0,a.Lk)("div",{innerHTML:this.task.question},null,8,yc),e.task.canAnswerMultiple?((0,a.uX)(!0),(0,a.CE)(a.FK,{key:0},(0,a.pI)(e.answers,(t=>((0,a.uX)(),(0,a.CE)(a.FK,{key:t.uuid},[(0,a.Lk)("label",{class:(0,r.C4)(e.classForAnswer(t))},[(0,a.bo)((0,a.Lk)("input",{type:"checkbox",class:"answer-checkbox",value:t.text,"onUpdate:modelValue":n=>e.selectedAnswers[t.text]=n,disabled:e.isSubmitted},null,8,Ac),[[l.lH,e.selectedAnswers[t.text]]]),(0,a.eW)(" "+(0,r.v_)(t.text),1),t.strings.hint&&!e.isSubmitted?((0,a.uX)(),(0,a.CE)("span",{key:0,class:"tooltip tooltip-icon answer-tooltip","data-tooltip":t.strings.hint},null,8,Tc)):(0,a.Q3)("",!0)],2),e.isSubmitted?((0,a.uX)(),(0,a.CE)(a.FK,{key:0},[t.strings.feedbackSelected&&e.selectedAnswers[t.text]?((0,a.uX)(),(0,a.CE)("div",Cc,(0,r.v_)(t.strings.feedbackSelected),1)):t.strings.feedbackNotSelected&&!e.selectedAnswers[t.text]?((0,a.uX)(),(0,a.CE)("div",Ec,(0,r.v_)(t.strings.feedbackNotSelected),1)):(0,a.Q3)("",!0)],64)):(0,a.Q3)("",!0)],64)))),128)):((0,a.uX)(!0),(0,a.CE)(a.FK,{key:1},(0,a.pI)(e.answers,((n,i)=>((0,a.uX)(),(0,a.CE)(a.FK,{key:i},[(0,a.Lk)("label",{class:(0,r.C4)(e.classForAnswer(n))},[(0,a.bo)((0,a.Lk)("input",{type:"radio",class:"answer-radiobutton",value:n,"onUpdate:modelValue":t[0]||(t[0]=t=>e.selectedAnswer=t),disabled:e.isSubmitted},null,8,Dc),[[l.XL,e.selectedAnswer]]),(0,a.eW)(" "+(0,r.v_)(n.text)+" ",1),n.strings.hint&&!e.isSubmitted?((0,a.uX)(),(0,a.CE)("span",{key:0,class:"tooltip tooltip-icon answer-tooltip","data-tooltip":n.strings.hint},null,8,Ic)):(0,a.Q3)("",!0)],2),e.isSubmitted?((0,a.uX)(),(0,a.CE)(a.FK,{key:0},[n.strings.feedbackSelected&&e.selectedAnswer==n?((0,a.uX)(),(0,a.CE)("div",Sc,(0,r.v_)(n.strings.feedbackSelected),1)):n.strings.feedbackNotSelected&&e.selectedAnswer!==n?((0,a.uX)(),(0,a.CE)("div",xc,(0,r.v_)(n.strings.feedbackNotSelected),1)):(0,a.Q3)("",!0)],64)):(0,a.Q3)("",!0)],64)))),128))]),(0,a.Lk)("div",Lc,[e.isSubmitted?((0,a.uX)(),(0,a.Wv)(d,{key:0,"achieved-points":e.points,"max-points":e.maxPoints,"result-message":e.resultMessage,feedback:e.task.feedback},null,8,["achieved-points","max-points","result-message","feedback"])):(0,a.Q3)("",!0),(0,a.Lk)("div",Bc,[e.showCheckButton?((0,a.uX)(),(0,a.CE)("button",{key:0,textContent:(0,r.v_)(this.task.strings.checkButton),onClick:t[1]||(t[1]=(...t)=>e.onClickCheckButton&&e.onClickCheckButton(...t)),type:"button",class:"stud5p-button"},null,8,Rc)):(0,a.Q3)("",!0),e.showRetryButton?((0,a.uX)(),(0,a.CE)("button",{key:1,textContent:(0,r.v_)(this.task.strings.retryButton),onClick:t[2]||(t[2]=(...t)=>e.onClickRetryButton&&e.onClickRetryButton(...t)),type:"button",class:"stud5p-button"},null,8,_c)):(0,a.Q3)("",!0),e.showSolutionsButton?((0,a.uX)(),(0,a.CE)("button",{key:2,textContent:(0,r.v_)(this.task.strings.solutionsButton),onClick:t[3]||(t[3]=(...t)=>e.onClickShowSolutionsButton&&e.onClickShowSolutionsButton(...t)),type:"button",class:"stud5p-button"},null,8,Fc)):(0,a.Q3)("",!0)])])])}var Pc=(0,a.pM)({name:"QuestionViewer",props:{task:{type:Object,required:!0}},components:{FeedbackElement:ie},data(){return{selectedAnswers:{},selectedAnswer:{},isSubmitted:!1,showSolutions:!1}},methods:{$gettext:s.o_,onClickCheckButton(){this.isSubmitted=!0},onClickRetryButton(){this.isSubmitted=!1,this.showSolutions=!1,this.selectedAnswers={},this.selectedAnswer=void 0},onClickShowSolutionsButton(){this.showSolutions=!0},classForAnswer(e){return this.showSolutions&&e.correct?"answer correct":this.isSubmitted?this.task.canAnswerMultiple?this.selectedAnswers[e.text]?e.correct?"answer correct":"answer incorrect":"answer submitted":this.selectedAnswer===e?e.correct?"answer correct":"answer incorrect":"answer submitted":"answer unsubmitted"}},computed:{answers(){return this.task.randomOrder?this.task.answers.map((e=>({answer:e,sort:Math.random()}))).sort(((e,t)=>e.sort-t.sort)).map((({answer:e})=>e)):this.task.answers},maxPoints(){if(this.task.canAnswerMultiple){let e=0;return this.task.answers.forEach((t=>{t.correct&&e++})),e}return 1},points(){if(this.task.canAnswerMultiple){let e=0;return this.task.answers.forEach((t=>{this.selectedAnswers[t.text]&&(t.correct?e++:e--)})),e<0&&(e=0),e}return this.selectedAnswer&&this.selectedAnswer.correct?1:0},reachedMaxPoints(){return this.points===this.maxPoints},showCheckButton(){return!this.isSubmitted},showRetryButton(){return this.task.retryAllowed&&this.isSubmitted&&!this.reachedMaxPoints},showSolutionsButton(){return this.task.showSolutionsAllowed&&this.isSubmitted&&!this.showSolutions&&!this.reachedMaxPoints},resultMessage(){if(!this.task.strings.resultMessage)return"";let e=this.task.strings.resultMessage.replace(":correct",this.points.toString());return e=e.replace(":total",this.maxPoints.toString()),e}}});const zc=(0,v.A)(Pc,[["render",Mc],["__scopeId","data-v-46775c00"]]);var Wc=zc;const Uc={class:"stud5p-task"},Vc={class:"default"},Xc={class:"sequencing-editor"},Oc={class:"cards-list"},Qc=["onClick"],Hc=["textContent"],jc=["onClick","aria-label"],Nc=["src"],$c={key:1,class:"no-card-selected-placeholder"},Kc={class:"collapsable collapsed"},Gc={class:"collapsable collapsed"},Jc=["disabled"],qc=["disabled"],Yc=["disabled"];function Zc(e,t,n,i,o,s){const d=(0,a.g2)("SequencingEditorCard"),u=(0,a.g2)("FeedbackEditor");return(0,a.uX)(),(0,a.CE)("div",Uc,[(0,a.Lk)("form",Vc,[(0,a.Lk)("fieldset",Xc,[(0,a.Lk)("legend",null,(0,r.v_)(e.$gettext("Sequencing")),1),(0,a.Lk)("div",Oc,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.modelTaskDefinition.cards,((t,n)=>((0,a.uX)(),(0,a.CE)("div",{key:t.uuid,class:(0,r.C4)({"cards-list-item":!0,"selected-card":n===e.selectedCardIndex}),onClick:t=>e.selectCard(n)},[(0,a.Lk)("div",{textContent:(0,r.v_)(e.listEntryText(n,t)),class:"list-entry-text"},null,8,Hc),(0,a.Lk)("button",{type:"button",class:"remove-card-button",onClick:(0,l.D$)((t=>e.deleteCard(n)),["stop"]),"aria-label":e.$gettext("Karte löschen")},[(0,a.Lk)("img",{src:e.urlForIcon("trash"),alt:""},null,8,Nc)],8,jc)],10,Qc)))),128)),(0,a.Lk)("button",{type:"button",class:"button add add-card-button",onClick:t[0]||(t[0]=(...t)=>e.addCard&&e.addCard(...t))},(0,r.v_)(e.$gettext("Karte hinzufügen")),1)]),e.modelTaskDefinition.cards[e.selectedCardIndex]?((0,a.uX)(),(0,a.Wv)(d,{key:0,card:e.modelTaskDefinition.cards[e.selectedCardIndex],"card-index":e.selectedCardIndex},null,8,["card","card-index"])):((0,a.uX)(),(0,a.CE)("fieldset",$c,[(0,a.Lk)("legend",null,(0,r.v_)(e.$gettext("Keine Karte ausgewählt")),1)]))]),(0,a.Lk)("fieldset",Kc,[(0,a.Lk)("legend",null,(0,r.v_)(e.$gettext("Einstellungen")),1),(0,a.Lk)("label",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=t=>e.modelTaskDefinition.retryAllowed=t),onChange:t[2]||(t[2]=(...t)=>e.updateTaskDefinition&&e.updateTaskDefinition(...t)),type:"checkbox"},null,544),[[l.lH,e.modelTaskDefinition.retryAllowed]]),(0,a.eW)(" "+(0,r.v_)(e.$gettext("Mehrere Versuche erlauben")),1)]),(0,a.Lk)("label",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[3]||(t[3]=t=>e.modelTaskDefinition.resumeAllowed=t),onChange:t[4]||(t[4]=(...t)=>e.updateTaskDefinition&&e.updateTaskDefinition(...t)),type:"checkbox"},null,544),[[l.lH,e.modelTaskDefinition.resumeAllowed]]),(0,a.eW)(" "+(0,r.v_)(e.$gettext("Fortsetzen des aktuellen Spielstands erlauben")),1)]),(0,a.Lk)("label",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[5]||(t[5]=t=>e.modelTaskDefinition.showSolutionsAllowed=t),onChange:t[6]||(t[6]=(...t)=>e.updateTaskDefinition&&e.updateTaskDefinition(...t)),type:"checkbox"},null,544),[[l.lH,e.modelTaskDefinition.showSolutionsAllowed]]),(0,a.eW)(" "+(0,r.v_)(e.$gettext("Lösungen anzeigen erlauben")),1)])]),(0,a.Lk)("fieldset",Gc,[(0,a.Lk)("legend",null,(0,r.v_)(e.$gettext("Beschriftungen")),1),(0,a.Lk)("label",null,[(0,a.eW)((0,r.v_)(e.$gettext("Text für Überprüfen-Button:"))+" ",1),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[7]||(t[7]=t=>e.modelTaskDefinition.strings.checkButton=t),onInput:t[8]||(t[8]=t=>e.updateTaskDefinition("taskDefinition.strings.checkButton")),type:"text"},null,544),[[l.Jo,e.modelTaskDefinition.strings.checkButton]])]),(0,a.Lk)("label",{class:(0,r.C4)({"setting-disabled":!e.modelTaskDefinition.retryAllowed})},[(0,a.eW)((0,r.v_)(e.$gettext("Text für Wiederholen-Button:"))+" ",1),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[9]||(t[9]=t=>e.modelTaskDefinition.strings.retryButton=t),onInput:t[10]||(t[10]=t=>e.updateTaskDefinition("taskDefinition.strings.retryButton")),disabled:!e.modelTaskDefinition.retryAllowed,type:"text"},null,40,Jc),[[l.Jo,e.modelTaskDefinition.strings.retryButton]])],2),(0,a.Lk)("label",{class:(0,r.C4)({"setting-disabled":!e.modelTaskDefinition.resumeAllowed})},[(0,a.eW)((0,r.v_)(e.$gettext("Text für Fortsetzen-Button:"))+" ",1),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[11]||(t[11]=t=>e.modelTaskDefinition.strings.resumeButton=t),onInput:t[12]||(t[12]=t=>e.updateTaskDefinition("taskDefinition.strings.resumeButton")),disabled:!e.modelTaskDefinition.resumeAllowed,type:"text"},null,40,qc),[[l.Jo,e.modelTaskDefinition.strings.resumeButton]])],2),(0,a.Lk)("label",{class:(0,r.C4)({"setting-disabled":!e.modelTaskDefinition.showSolutionsAllowed})},[(0,a.eW)((0,r.v_)(e.$gettext("Text für Lösungen-Button:"))+" ",1),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[13]||(t[13]=t=>e.modelTaskDefinition.strings.solutionsButton=t),onInput:t[14]||(t[14]=t=>e.updateTaskDefinition("taskDefinition.strings.solutionsButton")),disabled:!e.modelTaskDefinition.showSolutionsAllowed,type:"text"},null,40,Yc),[[l.Jo,e.modelTaskDefinition.strings.solutionsButton]])],2)]),(0,a.bF)(u,{feedback:e.modelTaskDefinition.feedback,"result-message":e.modelTaskDefinition.strings.resultMessage,"onUpdate:feedback":e.updateFeedback,"onUpdate:resultMessage":e.updateResultMessage},null,8,["feedback","result-message","onUpdate:feedback","onUpdate:resultMessage"])])])}const ep={class:"sequencing-editor-card"},tp={key:0,class:"image-card-container"},np={class:"multimedia-element-wrapper"},ip={style:{"align-self":"stretch"}},op=["value"];function sp(e,t,n,i,o,s){const l=(0,a.g2)("MultimediaElement"),d=(0,a.g2)("FileUpload");return(0,a.uX)(),(0,a.CE)("fieldset",ep,[(0,a.Lk)("legend",null,(0,r.v_)(e.$gettext("Karte")),1),(0,a.Lk)("label",null,(0,r.v_)(e.$gettext("Bild")),1),"image"==e.card.type&&e.card.file_id?((0,a.uX)(),(0,a.CE)("div",tp,[(0,a.Lk)("div",np,[(0,a.bF)(l,{element:e.card},null,8,["element"])]),(0,a.Lk)("button",{type:"button",onClick:t[0]||(t[0]=(...t)=>e.onClickDeleteImage&&e.onClickDeleteImage(...t)),class:"button trash settings-item"},(0,r.v_)(e.$gettext("Bild löschen")),1),(0,a.Lk)("label",ip,[(0,a.eW)((0,r.v_)(e.$gettext("Bildbeschreibung"))+" ",1),(0,a.Lk)("input",{type:"text",value:e.card.altText,onInput:t[1]||(t[1]=(...t)=>e.onInputAltText&&e.onInputAltText(...t)),class:"settings-item"},null,40,op)])])):((0,a.uX)(),(0,a.Wv)(d,{key:1,onFileUploaded:e.onUploadImage},null,8,["onFileUploaded"]))])}var ap=(0,a.pM)({name:"SequencingEditorCard",components:{MultimediaElement:Cd,FileUpload:an},setup(){return{taskEditor:(0,a.WQ)(u.c)}},props:{card:{type:Object,required:!0},cardIndex:{type:Number,required:!0}},data(){return{debug:!1}},methods:{fileIdToUrl:Mp,$gettext:s.o_,onUploadImage(e){const t=(0,S.Ay)(this.taskDefinition,(t=>{"image"===t.cards[this.cardIndex].type&&(t.cards[this.cardIndex].file_id=e.id)}));this.taskEditor.performEdit({newTaskDefinition:t,undoBatch:{}})},onInputAltText(e){const t=e.target.value,n=(0,S.Ay)(this.taskDefinition,(e=>{"image"===e.cards[this.cardIndex].type&&(e.cards[this.cardIndex].altText=t)}));this.taskEditor.performEdit({newTaskDefinition:n,undoBatch:{type:"EditedImageAltText"}})},onClickDeleteImage(){const e=(0,S.Ay)(this.taskDefinition,(e=>{"image"===e.cards[this.cardIndex].type&&(e.cards[this.cardIndex].file_id="")}));this.taskEditor.performEdit({newTaskDefinition:e,undoBatch:{}})},onChangeType(e){const t=e.target,n=t.value,i=(0,S.Ay)(this.taskDefinition,(e=>{e.cards[this.cardIndex].type=n}));this.taskEditor.performEdit({newTaskDefinition:i,undoBatch:{}})},createNewLernmoduleMultimediaElement(e){switch(e){case"image":return{uuid:(0,i.A)(),type:e,file_id:"",altText:""};case"audio":return{uuid:(0,i.A)(),type:e,file_id:"",altText:""};case"text":return{uuid:(0,i.A)(),type:e,content:""};default:throw new Error((0,s.o_)("Ungültiges MultimediaElementType: ")+e)}}},computed:{taskDefinition:()=>Cn.SL.taskDefinition}});const lp=(0,v.A)(ap,[["render",sp],["__scopeId","data-v-20dc9589"]]);var rp=lp,dp=(0,a.pM)({name:"SequencingEditor",components:{SequencingEditorCard:rp,FeedbackEditor:$e},setup(){return{taskEditor:(0,a.WQ)(u.c)}},props:{taskDefinition:{type:Object,required:!0}},data(){return{selectedCardIndex:-1,modelTaskDefinition:(0,m.cloneDeep)(this.taskDefinition)}},watch:{taskDefinition:{immediate:!0,handler:function(){this.modelTaskDefinition=(0,m.cloneDeep)(this.taskDefinition)}}},beforeMount(){this.modelTaskDefinition.cards.length>0&&(this.selectedCardIndex=0)},methods:{$gettext:s.o_,urlForIcon(e){return window.STUDIP.ASSETS_URL+"images/icons/blue/"+e+".svg"},updateTaskDefinition(e){this.taskEditor.performEdit({newTaskDefinition:(0,m.cloneDeep)(this.modelTaskDefinition),undoBatch:e??{}})},selectCard(e){this.selectedCardIndex=e},addCard(){this.modelTaskDefinition=(0,S.Ay)(this.modelTaskDefinition,(e=>{e.cards.push({type:"image",uuid:(0,i.A)(),file_id:"",altText:""})})),this.updateTaskDefinition(),this.selectedCardIndex=this.modelTaskDefinition.cards.length-1},deleteCard(e){this.modelTaskDefinition=(0,S.Ay)(this.modelTaskDefinition,(t=>{t.cards.splice(e,1)})),this.updateTaskDefinition(),e<=this.selectedCardIndex&&(this.selectedCardIndex=this.selectedCardIndex-1)},listEntryText(e,t){let n=e+1+". ";return"image"===t.type&&""!=t.altText?n+=t.altText:n+=(0,s.o_)("Bild"),n},updateFeedback(e){this.taskEditor.performEdit({newTaskDefinition:(0,S.Ay)(this.modelTaskDefinition,(t=>{t.feedback=e})),undoBatch:"taskDefinition.feedback"})},updateResultMessage(e){this.taskEditor.performEdit({newTaskDefinition:(0,S.Ay)(this.modelTaskDefinition,(t=>{t.strings.resultMessage=e})),undoBatch:"taskDefinition.strings.resultMessage"})}}});const up=(0,v.A)(dp,[["render",Zc],["__scopeId","data-v-79b0e546"]]);var cp=up;const pp={class:"stud5p-task"},hp={class:"card-row",tabIndex:"-1"},mp=["aria-label","draggable","onDragstart","onDrag","onDragend","onDragover","onClick","onKeydown"],kp={class:"image-wrapper"},gp={class:"feedback-and-button-container"},fp={class:"button-panel"},vp=["textContent"],bp=["textContent"],wp=["textContent"],yp=["textContent"],Ap={"aria-live":"polite","aria-atomic":"true",style:{position:"absolute",width:"1px",height:"1px",overflow:"hidden"}};function Tp(e,t,n,i,o,s){const d=(0,a.g2)("MultimediaElement"),u=(0,a.g2)("FeedbackElement");return(0,a.uX)(),(0,a.CE)("div",pp,[(0,a.Lk)("div",hp,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.cards,((n,i)=>((0,a.uX)(),(0,a.CE)("button",{type:"button","aria-label":e.getAriaLabel(n,i),key:n.uuid,ref_for:!0,ref:"card-"+i,class:(0,r.C4)(["card",{dragged:e.cardInteractedWith===n,disabled:e.isShowingResults,correct:e.isShowingResults&&e.isCardInCorrectPosition(n),incorrect:e.isShowingResults&&!e.isCardInCorrectPosition(n)}]),draggable:!e.isShowingResults,onDragstart:t=>e.startDragCard(n,t),onDrag:t=>e.onDrag(n),onDragend:t=>e.endDragCard(n),onDragover:t=>e.onDragOver(n),onClick:t=>e.onClickCard(n),onKeydown:t=>e.onKeydown(n,t)},[(0,a.Lk)("span",kp,[(0,a.bF)(d,{element:n},null,8,["element"])]),(0,a.Lk)("span",{class:"image-description",onDragover:t[0]||(t[0]=(0,l.D$)((()=>{}),["prevent"])),onDragenter:t[1]||(t[1]=(0,l.D$)((()=>{}),["prevent"]))},(0,r.v_)(n.altText),33)],42,mp)))),128))]),(0,a.Lk)("div",gp,[e.isShowingResults&&!e.isShowingSolutions?((0,a.uX)(),(0,a.Wv)(u,{key:0,achievedPoints:e.correctAnswers,maxPoints:e.maxPoints,resultMessage:e.resultMessage,feedback:e.task.feedback},null,8,["achievedPoints","maxPoints","resultMessage","feedback"])):(0,a.Q3)("",!0),(0,a.Lk)("div",fp,[e.showCheckButton?((0,a.uX)(),(0,a.CE)("button",{key:0,textContent:(0,r.v_)(e.task.strings.checkButton),onClick:t[2]||(t[2]=(...t)=>e.onClickCheckButton&&e.onClickCheckButton(...t)),type:"button",class:"stud5p-button"},null,8,vp)):(0,a.Q3)("",!0),e.showRetryButton?((0,a.uX)(),(0,a.CE)("button",{key:1,textContent:(0,r.v_)(e.task.strings.retryButton),onClick:t[3]||(t[3]=(...t)=>e.onClickRetryButton&&e.onClickRetryButton(...t)),type:"button",class:"stud5p-button"},null,8,bp)):(0,a.Q3)("",!0),e.showResumeButton?((0,a.uX)(),(0,a.CE)("button",{key:2,textContent:(0,r.v_)(e.task.strings.resumeButton),onClick:t[4]||(t[4]=(...t)=>e.onClickResumeButton&&e.onClickResumeButton(...t)),type:"button",class:"stud5p-button"},null,8,wp)):(0,a.Q3)("",!0),e.showSolutionsButton?((0,a.uX)(),(0,a.CE)("button",{key:3,textContent:(0,r.v_)(e.task.strings.solutionsButton),onClick:t[5]||(t[5]=(...t)=>e.onClickSolutionsButton&&e.onClickSolutionsButton(...t)),type:"button",class:"stud5p-button"},null,8,yp)):(0,a.Q3)("",!0)])]),(0,a.Lk)("div",Ap,(0,r.v_)(e.screenReaderAnnouncement),1)])}var Cp=(0,a.pM)({name:"SequencingViewer",components:{MultimediaElement:Cd,FeedbackElement:ie},props:{task:{type:Object,required:!0}},emits:["updateAttempt"],data(){return{cards:[],cardInteractedWith:void 0,isShowingResults:!1,isShowingSolutions:!1,screenReaderAnnouncement:""}},methods:{fileIdToUrl:Mp,$gettext:s.o_,startDragCard(e,t){console.log("Starting to drag card",e.uuid),this.cardInteractedWith=e},onDrag(e){console.log("Dragging card",e.uuid)},endDragCard(e){console.log("Ending to drag card",e.uuid),this.cardInteractedWith=void 0},onDragOver(e){if(this.cardInteractedWith&&this.cardInteractedWith!=e){const t=this.cards.indexOf(this.cardInteractedWith),n=this.cards.indexOf(e);console.log("Dragging card",this.cardInteractedWith?.uuid,"(",t,") over target",e.uuid,"(",n,")"),this.moveInArray(t,n)}},onClickCard(e){if(!this.isShowingSolutions&&!this.isShowingResults)if(this.cardInteractedWith){const t=this.cards.indexOf(this.cardInteractedWith),n=this.cards.indexOf(e);this.moveInArray(t,n),this.cardInteractedWith=void 0}else this.cardInteractedWith=e},onKeydown(e,t){if(this.isShowingResults||this.isShowingSolutions)return;const n=this.cards.indexOf(e),i=this.cardInteractedWith?this.cards.indexOf(this.cardInteractedWith):-1;switch(t.key){case"Enter":case" ":t.preventDefault(),this.cardInteractedWith&&this.cardInteractedWith!==e?(this.moveInArray(i,n),this.screenReaderAnnouncement=this.$gettext("Moved %1 to position %2.").replace("%1",this.cardInteractedWith.uuid).replace("%2",String(n+1)),this.cardInteractedWith=void 0,this.moveFocus(n)):(this.cardInteractedWith=this.cardInteractedWith?void 0:e,this.screenReaderAnnouncement=this.cardInteractedWith?`Selected ${e.uuid} on position ${n+1} for moving.`:"Selection cleared.");break;case"Escape":this.cardInteractedWith=void 0,this.screenReaderAnnouncement="Selection canceled.";break}},moveFocus(e){this.$nextTick((()=>{const t=this.$refs[`card-${e}`];t&&t[0]&&t[0].focus()}))},getAriaLabel(e,t){return this.isShowingResults?`${e.uuid} on position ${t+1} is ${this.isCardInCorrectPosition(e)?"correct":"not correct"}`:`${e.uuid} on position ${t+1}`},moveInArray(e,t){let n=this.cards[e];this.cards.splice(e,1),this.cards.splice(t,0,n)},isCardInCorrectPosition(e){const t=this.cards.findIndex((t=>t.uuid===e.uuid));return-1!==t&&this.task.cards[t].uuid===e.uuid},onClickCheckButton(){this.isShowingResults=!0,this.screenReaderAnnouncement=this.resultMessage},onClickSolutionsButton(){this.isShowingSolutions=!0,this.resetCards()},onClickResumeButton(){this.isShowingResults=!1},onClickRetryButton(){this.isShowingResults=!1,this.isShowingSolutions=!1,this.shuffleCards()},shuffleCards(){this.cards=this.cards.map((e=>({card:e,sort:Math.random()}))).sort(((e,t)=>e.sort-t.sort)).map((({card:e})=>e))},resetCards(){this.cards=this.task.cards}},computed:{showCheckButton(){return!this.isShowingResults},showRetryButton(){return this.task.retryAllowed&&this.isShowingResults},showResumeButton(){return this.task.resumeAllowed&&this.isShowingResults&&!this.isShowingSolutions&&!this.allAnswersAreCorrect},showSolutionsButton(){return this.task.showSolutionsAllowed&&this.isShowingResults&&!this.isShowingSolutions&&!this.allAnswersAreCorrect},correctAnswers(){let e=0;for(let t=0;t<this.task.cards.length;t++)this.task.cards[t].uuid===this.cards[t].uuid&&e++;return e},maxPoints(){return this.task.cards.length},allAnswersAreCorrect(){return this.correctAnswers===this.maxPoints},resultMessage(){let e=this.task.strings.resultMessage.replace(":correct",this.correctAnswers.toString());return e=e.replace(":total",this.maxPoints.toString()),e}},watch:{task:{handler(){console.log("watcher for this.task"),this.cards=[...this.task.cards],this.shuffleCards()},immediate:!0}}});const Ep=(0,v.A)(Cp,[["render",Tp],["__scopeId","data-v-7ac5812a"]]);var Dp=Ep;const Ip=o.z.object({type:o.z.literal("none")}),Sp=o.z.object({uuid:o.z.string(),type:o.z.literal("image"),file_id:o.z.string(),altText:o.z.string()}),xp=o.z.union([Ip,Sp]),Lp=o.z.object({percentage:o.z.number(),message:o.z.string()}),Bp=o.z.object({uuid:o.z.string(),type:o.z.literal("rectangle"),x:o.z.number(),y:o.z.number(),width:o.z.number(),height:o.z.number(),correct:o.z.boolean().default(!0),feedback:o.z.string().default("")}),Rp=o.z.object({uuid:o.z.string(),type:o.z.literal("ellipse"),x:o.z.number(),y:o.z.number(),width:o.z.number(),height:o.z.number(),correct:o.z.boolean().default(!0),feedback:o.z.string().default("")}),_p=o.z.union([Bp,Rp]),Fp=o.z.object({task_type:o.z.literal("FindTheHotspots"),image:xp,hotspots:o.z.array(_p),allowedClicks:o.z.number().default(0),hotspotsToFind:o.z.number().default(0),strings:o.z.object({retryButton:o.z.string(),resultMessage:o.z.string(),feedbackWhenClickingBackground:o.z.string().default(""),feedbackWhenClickingHotspotAgain:o.z.string().default("Du hast diesen Hotspot bereits gefunden.")}),feedback:o.z.array(Lp)});function Mp(e){return""===e?"":window.STUDIP.URLHelper.getURL("sendfile.php",{file_id:e})}function Pp(e){return window.STUDIP.URLHelper.getURL(`dispatch.php/file/details/${e}`)}const zp=o.z.object({uuid:o.z.string(),type:o.z.literal("audio"),file_id:o.z.string(),altText:o.z.string()}),Wp=o.z.object({uuid:o.z.string(),type:o.z.literal("text"),content:o.z.string()}),Up=o.z.union([Sp,zp,Wp]),Vp=o.z.object({task_type:o.z.literal("DragTheWords"),template:o.z.string(),distractors:o.z.string().optional().default(""),retryAllowed:o.z.boolean(),showSolutionsAllowed:o.z.boolean(),instantFeedback:o.z.boolean(),allBlanksMustBeFilledForSolutions:o.z.boolean(),alphabeticOrder:o.z.boolean(),strings:o.z.object({checkButton:o.z.string(),retryButton:o.z.string(),solutionsButton:o.z.string(),fillInAllBlanksMessage:o.z.string(),resultMessage:o.z.string()}),feedback:o.z.array(Lp)}),Xp=o.z.object({task_type:o.z.literal("FindTheWords"),words:o.z.string(),size:o.z.number().optional().default(12),alphabet:o.z.string(),showWordList:o.z.boolean().default(!0),directions:o.z.object({n:o.z.boolean(),ne:o.z.boolean(),e:o.z.boolean(),se:o.z.boolean(),s:o.z.boolean(),sw:o.z.boolean(),w:o.z.boolean(),nw:o.z.boolean()}).optional(),strings:o.z.object({checkButton:o.z.string().default(""),retryButton:o.z.string(),solutionsButton:o.z.string(),resultMessage:o.z.string(),wordListTitle:o.z.string().default("Wörter"),timer:o.z.string()})}),Op=o.z.object({task_type:o.z.literal("FillInTheBlanks"),template:o.z.string(),retryAllowed:o.z.boolean(),showSolutionsAllowed:o.z.boolean(),caseSensitive:o.z.boolean(),autoCorrect:o.z.boolean(),allBlanksMustBeFilledForSolutions:o.z.boolean(),acceptTypos:o.z.boolean(),strings:o.z.object({checkButton:o.z.string(),retryButton:o.z.string(),solutionsButton:o.z.string(),fillInAllBlanksMessage:o.z.string(),resultMessage:o.z.string()}),feedback:o.z.array(Lp)}),Qp=o.z.object({task_type:o.z.literal("MarkTheWords"),template:o.z.string(),retryAllowed:o.z.boolean(),showSolutionsAllowed:o.z.boolean(),strings:o.z.object({checkButton:o.z.string(),retryButton:o.z.string(),solutionsButton:o.z.string(),resultMessage:o.z.string()}),feedback:o.z.array(Lp).default((()=>eh()))}),Hp=o.z.object({uuid:o.z.string(),first:Up,second:Up.optional()}),jp=o.z.object({task_type:o.z.literal("Memory"),cards:o.z.array(Hp),squareLayout:o.z.boolean(),flipside:Sp.optional(),retryAllowed:o.z.boolean(),strings:o.z.object({retryButton:o.z.string(),resultMessage:o.z.string()})}),Np=o.z.object({uuid:o.z.string(),draggableElement:Up,targetElement:Up}),$p=o.z.object({task_type:o.z.literal("Pairing"),pairs:o.z.array(Np),retryAllowed:o.z.boolean().optional().default(!0),showSolutionsAllowed:o.z.boolean().optional().default(!0),strings:o.z.object({checkButton:o.z.string(),retryButton:o.z.string(),solutionsButton:o.z.string(),resultMessage:o.z.string()}),feedback:o.z.array(Lp)}),Kp=o.z.object({uuid:o.z.string().optional().default((0,i.A)()),text:o.z.string(),correct:o.z.boolean(),strings:o.z.object({hint:o.z.string(),feedbackSelected:o.z.string(),feedbackNotSelected:o.z.string()})}),Gp=o.z.object({task_type:o.z.literal("Question"),question:o.z.string(),answers:o.z.array(Kp),canAnswerMultiple:o.z.boolean(),retryAllowed:o.z.boolean(),randomOrder:o.z.boolean(),showSolutionsAllowed:o.z.boolean(),strings:o.z.object({checkButton:o.z.string(),retryButton:o.z.string(),solutionsButton:o.z.string(),resultMessage:o.z.string().optional()}),feedback:o.z.array(Lp).default((()=>eh()))}),Jp=o.z.object({task_type:o.z.literal("Sequencing"),cards:o.z.array(Up),retryAllowed:o.z.boolean().optional().default(!0),resumeAllowed:o.z.boolean().optional().default(!0),showSolutionsAllowed:o.z.boolean().optional().default(!0),strings:o.z.object({checkButton:o.z.string(),retryButton:o.z.string(),resumeButton:o.z.string().optional().default((0,s.o_)("Fortsetzen")),solutionsButton:o.z.string(),resultMessage:o.z.string()}),feedback:o.z.array(Lp)}),qp=o.z.discriminatedUnion("task_type",[h,Vp,Op,Fp,Xp,vo,Qp,jp,$p,Gp,Jp]),Yp=o.z.discriminatedUnion("task_type",[h,Vp,Op,Fp,Xp,Qp,jp,$p,Gp,Jp]),Zp=o.z.union([h.shape.task_type,Vp.shape.task_type,Op.shape.task_type,Fp.shape.task_type,Xp.shape.task_type,vo.shape.task_type,Qp.shape.task_type,jp.shape.task_type,$p.shape.task_type,Gp.shape.task_type,Jp.shape.task_type]);function eh(){return[{percentage:0,message:"Versuchen Sie es noch einmal."},{percentage:50,message:"Gut."},{percentage:75,message:"Sehr gut."},{percentage:100,message:"Perfekt!"}]}function th(e){switch(e){case"Crossword":return{task_type:"Crossword",words:[{uuid:(0,i.A)(),hint:"Frucht mit gleichnamiger Farbe.",solution:"Orange",x:4,y:1,direction:"across"},{uuid:(0,i.A)(),hint:"Krummes Obst mit gelber Schale.",solution:"Banane",x:6,y:0,direction:"down"},{uuid:(0,i.A)(),hint:"Kleine rote Steinfrucht mit Stiel.",solution:"Kirsche",x:0,y:5,direction:"across"},{uuid:(0,i.A)(),hint:"Unsinn / Milchprodukt.",solution:"Quark",x:4,y:3,direction:"across"},{uuid:(0,i.A)(),hint:"Erworben.",solution:"Gekauft",x:8,y:1,direction:"down"}],colorEmptyCells:!1,strings:{checkButton:"Überprüfen",retryButton:"Erneut versuchen",solutionsButton:"Lösungen anzeigen",resultMessage:":correct von :total Felder richtig ausgefüllt."}};case"DragTheWords":return{task_type:"DragTheWords",template:"Drag the *words* to the matching *gaps*.",distractors:"",retryAllowed:!0,showSolutionsAllowed:!0,instantFeedback:!1,allBlanksMustBeFilledForSolutions:!1,alphabeticOrder:!1,strings:{checkButton:"Antworten überprüfen",retryButton:"Erneut versuchen",solutionsButton:"Lösungen anzeigen",fillInAllBlanksMessage:"Alle Lücken müssen ausgefüllt sein, um Lösungen anzuzeigen.",resultMessage:":correct von :total Lücken richtig ausgefüllt."},feedback:eh()};case"InteractiveVideo":return{task_type:"InteractiveVideo",interactions:[],video:{type:"none"},autoplay:!1,startAt:0,disableNavigation:"not disabled",travisGoSettings:{enabled:!1,projectTitle:(0,s.o_)("Projekttitel"),projectDescription:(0,s.o_)("Projektbeschreibung")}};case"FillInTheBlanks":return{task_type:"FillInTheBlanks",template:"Hier entsteht der *Lücken*text.",retryAllowed:!0,showSolutionsAllowed:!0,caseSensitive:!0,autoCorrect:!1,allBlanksMustBeFilledForSolutions:!1,acceptTypos:!1,strings:{checkButton:"Antworten überprüfen",retryButton:"Erneut versuchen",solutionsButton:"Lösungen anzeigen",fillInAllBlanksMessage:"Alle Lücken müssen ausgefüllt sein, um Lösungen anzuzeigen.",resultMessage:":correct von :total Lücken richtig ausgefüllt."},feedback:eh()};case"FindTheHotspots":return{task_type:"FindTheHotspots",image:{type:"none"},hotspots:[],allowedClicks:0,hotspotsToFind:0,strings:{retryButton:"Erneut versuchen",resultMessage:":correct von :total Hotspots gefunden.",feedbackWhenClickingBackground:"Hier ist kein Hotspot.",feedbackWhenClickingHotspotAgain:"Du hast diesen Hotspot bereits gefunden."},feedback:eh()};case"FindTheWords":return{task_type:"FindTheWords",words:"Apfel, Banane, Orange",size:12,alphabet:"abcdefghijklmnopqrstuvwxyz",showWordList:!0,directions:{n:!1,ne:!0,e:!0,se:!0,s:!0,sw:!1,w:!1,nw:!1},strings:{checkButton:"Überprüfen",retryButton:"Erneut versuchen",solutionsButton:"Lösungen anzeigen",resultMessage:":correct von :total Wörter gefunden.",wordListTitle:"Wörter",timer:"Zeit:"}};case"MarkTheWords":return{task_type:"MarkTheWords",template:"*The* moon is our natural satellite, *i.e.* it revolves around the *Earth!*",retryAllowed:!0,showSolutionsAllowed:!0,strings:{checkButton:"Antworten überprüfen",retryButton:"Erneut versuchen",solutionsButton:"Lösungen anzeigen",resultMessage:":correct von :total Wörtern richtig ausgewählt."},feedback:eh()};case"Memory":return{task_type:"Memory",cards:[{uuid:(0,i.A)(),first:{type:"image",uuid:(0,i.A)(),file_id:"",altText:""}}],retryAllowed:!0,squareLayout:!0,strings:{retryButton:"Erneut versuchen",resultMessage:"Gut gemacht!"}};case"Pairing":return{task_type:"Pairing",pairs:[{uuid:(0,i.A)(),draggableElement:{uuid:(0,i.A)(),type:"image",file_id:"",altText:""},targetElement:{uuid:(0,i.A)(),type:"image",file_id:"",altText:""}}],retryAllowed:!0,showSolutionsAllowed:!0,strings:{checkButton:"Antworten überprüfen",retryButton:"Erneut versuchen",solutionsButton:"Lösungen anzeigen",resultMessage:":correct von :total Bildern richtig zugeordnet."},feedback:eh()};case"Question":return{task_type:"Question",question:"Wie nennt man die strukturell abgrenzbaren Bereiche einer Zelle?",answers:[{uuid:(0,i.A)(),text:"Organellen",correct:!0,strings:{hint:"",feedbackSelected:"",feedbackNotSelected:""}},{uuid:(0,i.A)(),text:"Mitochondrien",correct:!1,strings:{hint:"",feedbackSelected:"",feedbackNotSelected:""}},{uuid:(0,i.A)(),text:"Ribosomen",correct:!1,strings:{hint:"",feedbackSelected:"",feedbackNotSelected:""}},{uuid:(0,i.A)(),text:"Plasma",correct:!1,strings:{hint:"",feedbackSelected:"",feedbackNotSelected:""}}],canAnswerMultiple:!0,retryAllowed:!0,randomOrder:!0,showSolutionsAllowed:!0,strings:{checkButton:"Antworten überprüfen",retryButton:"Erneut versuchen",solutionsButton:"Lösungen anzeigen",resultMessage:":correct/:total"},feedback:eh()};case"Sequencing":return{task_type:"Sequencing",cards:[{type:"image",uuid:(0,i.A)(),file_id:"",altText:""}],retryAllowed:!0,resumeAllowed:!0,showSolutionsAllowed:!0,strings:{checkButton:"Reihenfolge überprüfen",retryButton:"Erneut versuchen",resumeButton:"Fortsetzen",solutionsButton:"Lösungen anzeigen",resultMessage:":correct von :total Elementen richtig sortiert."},feedback:eh()};default:throw new Error("Unimplemented type: "+e)}}function nh(e){switch(e){case"Crossword":return ve;case"DragTheWords":return ft;case"InteractiveVideo":return cr;case"FillInTheBlanks":return Jt;case"FindTheHotspots":return mi;case"FindTheWords":return Hi;case"MarkTheWords":return Hr;case"Memory":return Yd;case"Pairing":return Zu;case"Question":return Wc;case"Sequencing":return Dp;default:throw new Error("Unimplemented task type: "+e)}}function ih(e){switch(e){case"Crossword":return j;case"DragTheWords":return Je;case"InteractiveVideo":return Fa;case"FillInTheBlanks":return Rt;case"FindTheHotspots":return oi;case"FindTheWords":return Ti;case"MarkTheWords":return Tr;case"Memory":return Ld;case"Pairing":return Fu;case"Question":return bc;case"Sequencing":return cp;default:throw new Error("Unimplemented task type: "+e)}}function oh(e){switch(e){case"Crossword":return(0,s.o_)("Crossword");case"DragTheWords":return(0,s.o_)("Drag The Words");case"InteractiveVideo":return(0,s.o_)("Interactive Video");case"FillInTheBlanks":return(0,s.o_)("Fill In The Blanks");case"FindTheHotspots":return(0,s.o_)("Find The Hotspots");case"FindTheWords":return(0,s.o_)("Find The Words");case"MarkTheWords":return(0,s.o_)("Mark The Words");case"Memory":return(0,s.o_)("Memory");case"Pairing":return(0,s.o_)("Pairing");case"Question":return(0,s.o_)("Question");case"Sequencing":return(0,s.o_)("Sequencing")}}function sh(e){switch(e){case"InteractiveVideo":return!1;default:return!0}}function ah(e){switch(e){case"DragTheWords":return"tan3";case"InteractiveVideo":return"file-video";case"FillInTheBlanks":return"file-office";case"FindTheWords":return"tan3";case"MarkTheWords":return"tan3";case"Memory":return"tan3";case"Pairing":return"copy";case"Question":return"question";case"Sequencing":return"picture"}return"question"}},550:function(e,t,n){"use strict";n.d(t,{ME:function(){return d},aq:function(){return l},ok:function(){return s},vV:function(){return r},x3:function(){return a}});var i=n(8355),o=n(6377);const s=i.A.create({baseURL:window.STUDIP.URLHelper.getURL("jsonapi.php/v1",{},!0),headers:{"Content-Type":"application/vnd.api+json"}});async function a({file:e,fileData:t,folder:n}){const i=e?.relationships?.["terms-of-use"]?.data?.id??null,o=new FormData;o.append("file",t,e.attributes.name),i&&o.append("term-id",i);const a=`folders/${n.id}/file-refs`,l=await s.post(a,o,{headers:{"Content-Type":"multipart/form-data"}}),r=await s.get(l.headers.location),u=r.data.data;return d.parse(u)}async function l({userId:e}){const t=`users/${e}/folders`,n=await s.get(t,{headers:{"Content-Type":"application/vnd.api+json"}});return n.data.data}async function r({userId:e,name:t,parentFolderId:n,folderType:i}){const o=`users/${e}/folders`,a={data:{type:"folders",attributes:{"folder-type":i,name:t},relationships:{parent:{data:{type:"folders",id:n}}}}},l=await s.post(o,a,{headers:{"Content-Type":"application/vnd.api+json"}});return l.data.data}const d=o.z.object({type:o.z.literal("file-refs"),id:o.z.string(),attributes:o.z.object({name:o.z.string(),mkdate:o.z.string(),chdate:o.z.string(),description:o.z.string(),downloads:o.z.number(),filesize:o.z.number(),"is-downloadable":o.z.boolean(),"is-editable":o.z.boolean(),"is-readable":o.z.boolean(),"is-writable":o.z.boolean(),"mime-type":o.z.string()}),links:o.z.object({self:o.z.string()}),meta:o.z.object({"download-url":o.z.string()}),relationships:o.z.unknown()})},4253:function(e,t,n){"use strict";n.d(t,{Pf:function(){return a},fd:function(){return s},zq:function(){return l}});var i=n(5019),o=n(6377);async function s(e,t,n,o,s){const a=window.STUDIP.LernmoduleVueJS.saveRoute,l=window.STUDIP.CSRF_TOKEN,r=new FormData,d=i.cW.parse(e);return r.append("task_definition",JSON.stringify(d)),r.append("module_id",o),r.append("name",t),r.append("infotext",n),s&&r.append("block_id",s),r.append(l.name,l.value),fetch(a,{method:"POST",body:r}).then((e=>{if(!e.ok)throw new Error(e.statusText);return e.json()}))}async function a(e,t){const n=window.STUDIP.LernmoduleVueJS.updateAttemptRoute,i=new FormData,o=window.STUDIP.CSRF_TOKEN;return i.append(o.name,o.value),Object.entries(e).forEach((([e,t])=>{i.append(`message[points][${e}]`,t.toString())})),t&&i.append("message[success]","true"),fetch(n,{method:"POST",body:i}).then((e=>{if(!e.ok)throw new Error(e.statusText)}))}const l=o.z.object({name:o.z.string(),type:o.z.string(),url:o.z.string()})},2859:function(e,t,n){"use strict";n.d(t,{Nl:function(){return X},OJ:function(){return O},M_:function(){return U},SL:function(){return V}});var i=n(782),o=n(6063),s=n(3772),a=n(5019),l=n(8626),r=n(4253),d=n(7256),u=n(7576),c=function(e,t,n,i){var o,s=arguments.length,a=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a};function p(e){return new Promise((t=>setTimeout(t,e)))}(0,d.ht)(!1);let h=class extends o.hw{constructor(...e){super(...e),(0,s.A)(this,"saveStatus",{status:"saved"}),(0,s.A)(this,"fatalErrors",[]),(0,s.A)(this,"nonFatalErrors",[]),(0,s.A)(this,"serverTaskDefinition",[]),(0,s.A)(this,"serverModuleName",""),(0,s.A)(this,"serverInfotext",""),(0,s.A)(this,"moduleName",""),(0,s.A)(this,"infotext",""),(0,s.A)(this,"taskSaveLocation",null),(0,s.A)(this,"undoRedoStack",[{taskDefinition:(0,a.eI)("FillInTheBlanks"),undoBatch:{}}]),(0,s.A)(this,"undoRedoIndex",0)}get taskDefinition(){return this.undoRedoStack[this.undoRedoIndex].taskDefinition}get hasUnsavedChanges(){return!(0,l.isEqual)(this.taskDefinition,this.serverTaskDefinition)||this.serverModuleName!==this.moduleName||this.serverInfotext!==this.infotext}get canUndo(){return this.undoRedoIndex>0}get canRedo(){return this.undoRedoIndex<this.undoRedoStack.length-1}undo(){if(this.undoRedoIndex>0){const e=this.undoRedoStack[this.undoRedoIndex];this.undoRedoIndex--;const t=document.querySelectorAll(`[data-undo-focus-id="${e.undoBatch}"]`);if(t.length>0){const e=t.item(0),n=[...document.querySelectorAll("fieldset.collapsable.collapsed")].filter((t=>t.contains(e)));n.forEach((e=>e.classList.remove("collapsed"))),e.focus()}}}redo(){if(this.undoRedoIndex<this.undoRedoStack.length-1){this.undoRedoIndex++;const e=this.undoRedoStack[this.undoRedoIndex],t=document.querySelectorAll(`[data-undo-focus-id="${e.undoBatch}"]`);if(t.length>0){const e=t.item(0),n=[...document.querySelectorAll("fieldset.collapsable.collapsed")].filter((t=>t.contains(e)));n.forEach((e=>e.classList.remove("collapsed"))),e.focus()}}}initializeCourseware(e){console.info("initializeCourseware()",e),this.serverTaskDefinition=e.task_json,this.undoRedoStack=[{taskDefinition:this.serverTaskDefinition,undoBatch:{}}],this.taskSaveLocation={type:"cw_blocks",id:e.initializeMessage.block.id}}initializeNonCourseware(){if(window.STUDIP.LernmoduleVueJS.module.customdata&&!(0,l.isArray)(window.STUDIP.LernmoduleVueJS.module.customdata)){try{this.serverTaskDefinition=a.cW.parse(window.STUDIP.LernmoduleVueJS.module.customdata)}catch(e){const t=(0,u.w)(e,window.STUDIP.LernmoduleVueJS.module.customdata);throw console.error(t,e),console.error("task_json: ",window.STUDIP.LernmoduleVueJS.module.customdata),new Error(t,{cause:e})}this.undoRedoStack=[{taskDefinition:this.serverTaskDefinition,undoBatch:{}}]}this.serverModuleName=window.STUDIP.LernmoduleVueJS.module.name,this.serverInfotext=window.STUDIP.LernmoduleVueJS.infotext,this.moduleName=window.STUDIP.LernmoduleVueJS.module.name,this.infotext=window.STUDIP.LernmoduleVueJS.infotext,this.taskSaveLocation={type:"lernmodule_module",id:window.STUDIP.LernmoduleVueJS.module.module_id}}startedSaving(){this.saveStatus={status:"saving"}}saveSuccess(e){this.saveStatus={status:"saved"},this.serverTaskDefinition=e.taskDefinition,this.serverModuleName=e.moduleName,this.serverInfotext=e.infotext}saveFailure(e){this.saveStatus={status:"error",error:e},this.nonFatalErrors.push("The task could not be saved.  Check the console for more details. "),console.log(e)}async saveTask(){if("saving"!==this.saveStatus.status){this.context.commit("startedSaving");try{const e=await(0,r.fd)(this.taskDefinition,this.moduleName,this.infotext,window.STUDIP.LernmoduleVueJS.module.module_id,window.STUDIP.LernmoduleVueJS.block_id);await p(500),this.context.commit("saveSuccess",e)}catch(e){this.context.commit("saveFailure",{error:e})}}}performEdit(e){e.undoBatch||(e.undoBatch={});const t=this.undoRedoStack[this.undoRedoIndex];if((0,l.isEqual)(t.taskDefinition,e.newTaskDefinition))return;const n=!(0,l.isEqual)(e.undoBatch,{})&&(0,l.isEqual)(e.undoBatch,t.undoBatch);n?(t.taskDefinition=e.newTaskDefinition,this.undoRedoStack=this.undoRedoStack.slice(0,this.undoRedoIndex+1)):(this.undoRedoStack=this.undoRedoStack.slice(0,this.undoRedoIndex+1).concat([{taskDefinition:e.newTaskDefinition,undoBatch:e.undoBatch}]),this.undoRedoIndex+=1)}setModuleName(e){this.moduleName=e}setInfoText(e){this.infotext=e}};c([o.sM],h.prototype,"undo",null),c([o.sM],h.prototype,"redo",null),c([o.sM],h.prototype,"initializeCourseware",null),c([o.sM],h.prototype,"initializeNonCourseware",null),c([o.sM],h.prototype,"startedSaving",null),c([o.sM],h.prototype,"saveSuccess",null),c([o.sM],h.prototype,"saveFailure",null),c([o.rc],h.prototype,"saveTask",null),c([o.sM],h.prototype,"performEdit",null),c([o.sM],h.prototype,"setModuleName",null),c([o.sM],h.prototype,"setInfoText",null),h=c([(0,o.nV)({name:"taskEditor"})],h);var m=function(e,t,n,i){var o,s=arguments.length,a=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a};let k=class extends o.hw{constructor(...e){super(...e),(0,s.A)(this,"showEditorUI",!1),(0,s.A)(this,"studipContext",{id:"",type:""})}setShowEditorUI(e){this.showEditorUI=e}saveBlock(){console.log("coursewareBlockStore: saveBlock() mutation called");const e=JSON.parse(JSON.stringify(V.taskDefinition));window.parent.postMessage({type:"SaveCoursewareBlock",taskDefinition:e})}cancelEditing(){console.log("coursewareBlockStore: cancelEditing() mutation called"),window.parent.postMessage({type:"CancelEditingCoursewareBlock"})}setContext(e){this.studipContext=e}};m([o.sM],k.prototype,"setShowEditorUI",null),m([o.sM],k.prototype,"saveBlock",null),m([o.sM],k.prototype,"cancelEditing",null),m([o.sM],k.prototype,"setContext",null),k=m([(0,o.nV)({name:"coursewareBlock"})],k);var g=function(e,t,n,i){var o,s=arguments.length,a=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a};let f=class extends o.hw{constructor(...e){super(...e),(0,s.A)(this,"queue",[]),(0,s.A)(this,"active",0),(0,s.A)(this,"maxConcurrent",6),(0,s.A)(this,"delay",0)}addToQueue(e){this.queue.push(e)}incrementActive(){this.active++}decrementActive(){this.active--}async processQueue(){if(this.active>=this.maxConcurrent)return void console.debug(`Max concurrent limit reached (${this.maxConcurrent}). Active requests: ${this.active}. Queue length: ${this.queue.length}`);if(0===this.queue.length)return void console.debug(`Queue is empty. Active requests: ${this.active}`);const e=this.queue.shift();if(e){this.context.commit("incrementActive");try{await e()}finally{this.context.commit("decrementActive"),this.delay&&await new Promise((e=>setTimeout(e,this.delay))),await this.processQueue()}}}async enqueue(e){this.context.commit("addToQueue",e),await this.processQueue()}};g([o.sM],f.prototype,"addToQueue",null),g([o.sM],f.prototype,"incrementActive",null),g([o.sM],f.prototype,"decrementActive",null),g([o.rc],f.prototype,"processQueue",null),g([o.rc],f.prototype,"enqueue",null),f=g([(0,o.nV)({name:"requestQueue"})],f);var v=n(550);function b(e){return Object.keys(e).map((t=>`filter[${t}]=${encodeURIComponent(e[t])}`)).join("&")}const w=(e={})=>Object.keys(e).filter((t=>"undefined"!==typeof e[t])).map((t=>`${t}=${encodeURIComponent(e[t])}`)).join("&"),y=({parent:e,relationship:t})=>{const n=`${e.type}/${e.id}/${t}`;return e.relationships&&Object.keys(e.relationships).includes(t)?e.relationships[t].links?.related??n:n},A=e=>e.data,T=e=>{throw e&&e.response?e.response:e};class C{constructor({name:e,httpClient:t}){this.name=e,this.api=t}all({options:e={}}={}){let t;return e.url?({url:t}=e):t=`${this.name}?${w(e)}`,this.api.get(t).then(A).catch(T)}find({id:e,options:t}={}){const n=`${this.name}/${e}?${w(t)}`;return this.api.get(n).then(A).catch(T)}where({filter:e,options:t}={}){const n=b(e);return this.api.get(`${this.name}?${n}&${w(t)}`).then(A).catch(T)}related({parent:e,relationship:t=this.name,options:n}){const i=y({parent:e,relationship:t}),o=`${i}?${w(n)}`;return this.api.get(o).then(A).catch(T)}create(e){const t=Object.assign({},e,{type:this.name}),n={data:t};return this.api.post(`${this.name}`,n).then(A).catch(T)}createRelated(e){const t=Object.assign({},e,{type:this.name}),n={data:t};return this.api.post(`${this.name}`,n).then(A).catch(T)}updateRelationships(e,t,n){const i={data:n};return this.api.patch(`${e.type}/${e.id}/relationships/${t}`,i).then(A).catch(T)}createRelationships(e,t,n){const i={data:n};return this.api.post(`${e.type}/${e.id}/relationships/${t}`,i).then(A).catch(T)}removeRelationships(e,t,n){const i={data:n};return this.api.delete(`${e.type}/${e.id}/relationships/${t}`,i).then(A).catch(T)}update(e){const t={data:e};return this.api.patch(`${this.name}/${e.id}`,t).then(A).catch(T)}delete({id:e}){return this.api.delete(`${this.name}/${e}`).catch(T)}}var E=C;const D="INITIAL",I="LOADING",S="ERROR",x="SUCCESS",L=e=>t=>{const n=e.find((e=>e.id===t.id));n?Object.assign(n,t):e.push(t)},B=e=>e?{type:e.type,id:e.id}:e,R=e=>{const t=Array.isArray(e.data)?e.data[0]:e.data;return t&&t.type},_=({dispatch:e},t)=>{if(t.included){t.included.forEach((t=>{const n=`${t.type}/storeRecord`;e(n,t,{root:!0})}));let n=[...t.included];n=Array.isArray(t.data)?[...n,...t.data]:[...n,t.data],n.forEach((t=>{t.relationships&&Object.keys(t.relationships).forEach((n=>{const i=t.relationships[n];if(!i.data||0===i.data.length)return;const o=R(i);let s;Array.isArray(i.data)?s=i.data.map((e=>e.id)):({id:s}=i.data);const a={relatedIds:s,params:{parent:B(t),relationship:n}},l=`${o}/storeRelated`;e(l,a,{root:!0})}))}))}},F=e=>t=>Object.keys(e).every((n=>(0,l.isEqual)(e[n],t[n]))),M=e=>t=>{throw e("SET_STATUS",S),e("STORE_ERROR",t),t},P=()=>({records:[],related:[],filtered:[],page:[],error:null,status:D,links:{},lastCreated:null,lastMeta:null}),z=({name:e,httpClient:t})=>{const n=new E({name:e,httpClient:t}),i=t=>{const{parent:n,relationship:i=e}=t,o=B(n);return{parent:o,relationship:i}};return{namespaced:!0,state:P,mutations:{REPLACE_ALL_RECORDS:(e,t)=>{e.records=t},REPLACE_ALL_RELATED:(e,t)=>{e.related=t},SET_STATUS:(e,t)=>{e.status=t},STORE_RECORD:(e,t)=>{const{records:n}=e;L(n)(t)},STORE_RECORDS:(e,t)=>{const{records:n}=e;t.forEach(L(n))},STORE_PAGE:(e,t)=>{e.page=t.map((({id:e})=>e))},STORE_META:(e,t)=>{e.lastMeta=t},STORE_ERROR:(e,t)=>{e.error=t},STORE_RELATED:(e,{relatedIds:t,params:n,resetRelated:o=!0})=>{const{related:s}=e,a=i(n),l=s.find(F(a));if(l)if(o)l.relatedIds=t;else{const e=new Set([...l.relatedIds,...t]);l.relatedIds=[...e]}else s.push(Object.assign({relatedIds:t},a))},STORE_FILTERED:(e,{matchedIds:t,params:n})=>{const{filtered:i}=e,o=i.find(F(n));o?o.matchedIds=t:i.push(Object.assign({matchedIds:t},n))},STORE_LAST_CREATED:(e,t)=>{e.lastCreated=t},REMOVE_RECORD:(e,t)=>{e.records=e.records.filter((e=>e.id!==t.id))},SET_LINKS:(e,t)=>{e.links=t||{}},RESET_STATE:e=>{Object.assign(e,P())}},actions:{loadAll({commit:e,dispatch:t},{options:i}={}){return e("SET_STATUS",I),n.all({options:i}).then((n=>{e("SET_STATUS",x),e("REPLACE_ALL_RECORDS",n.data),e("STORE_META",n.meta),_({commit:e,dispatch:t},n)})).catch(M(e))},loadById({commit:e,dispatch:t},{id:i,options:o}){return e("SET_STATUS",I),n.find({id:i,options:o}).then((n=>{e("SET_STATUS",x),e("STORE_RECORD",n.data),e("STORE_META",n.meta),_({commit:e,dispatch:t},n)})).catch(M(e))},loadWhere({commit:e,dispatch:t},i){const{filter:o,options:s}=i;return e("SET_STATUS",I),n.where({filter:o,options:s}).then((n=>{e("SET_STATUS",x);const o=n.data,s=o.map((e=>e.id));e("STORE_RECORDS",o),e("STORE_FILTERED",{params:i,matchedIds:s}),e("STORE_META",n.meta),_({commit:e,dispatch:t},n)})).catch(M(e))},loadPage({commit:e,dispatch:t},{options:i}){return e("SET_STATUS",I),n.all({options:i}).then((n=>{e("SET_STATUS",x),e("STORE_RECORDS",n.data),e("STORE_PAGE",n.data),e("STORE_META",n.meta),e("SET_LINKS",n.links),_({commit:e,dispatch:t},n)})).catch(M(e))},loadNextPage({commit:e,state:t,dispatch:i}){const o={url:t.links.next};return n.all({options:o}).then((t=>{e("STORE_RECORDS",t.data),e("STORE_PAGE",t.data),e("SET_LINKS",t.links),e("STORE_META",t.meta),_({commit:e,dispatch:i},t)}))},loadPreviousPage({commit:e,state:t,dispatch:i}){const o={url:t.links.prev};return n.all({options:o}).then((t=>{e("STORE_RECORDS",t.data),e("STORE_PAGE",t.data),e("SET_LINKS",t.links),e("STORE_META",t.meta),_({commit:e,dispatch:i},t)}))},loadRelated({commit:t,dispatch:i},o){const{parent:s,relationship:a=e,options:l,resetRelated:r=!0}=o;t("SET_STATUS",I);const d={...o,relationship:a};return n.related({parent:s,relationship:a,options:l}).then((e=>{if(t("SET_STATUS",x),Array.isArray(e.data)){const n=e.data,i=n.map((e=>e.id));t("STORE_RECORDS",n),t("STORE_RELATED",{params:d,relatedIds:i,resetRelated:r})}else{const n=e.data,i=n.id;t("STORE_RECORDS",[n]),t("STORE_RELATED",{params:d,relatedIds:i})}t("STORE_META",e.meta),_({commit:t,dispatch:i},e)})).catch(M(t))},create({commit:e},t){return n.create(t).then((t=>{e("STORE_RECORD",t.data),e("STORE_LAST_CREATED",t.data)}))},update({commit:e,dispatch:t,getters:i},o){return n.update(o).then((({data:n})=>{const s=i.byId({id:o.id});if(s&&s.relationships)for(const e of Object.entries(s.relationships)){const[n,i]=e,o=R(i),a={relationship:n,parent:B(s)};null!==o&&void 0!==o&&t(`${o}/storeRelated`,{params:a,relatedIds:null},{root:!0})}if(e("STORE_RECORD",n),n.relationships)for(const e of Object.keys(n.relationships)){const i=n.relationships[e],{data:o}=i,s=Array.isArray(o)&&Boolean(o.length),a=Boolean(o&&o.type&&o.id);if(s||a){const s={parent:B(n),relationship:e},a=R(i);let l;l=Array.isArray(o)?o.map((e=>e.id)):o.id,t(`${a}/storeRelated`,{params:s,relatedIds:l},{root:!0})}}}))},delete({commit:e},t){return n.delete(t).then((()=>{e("REMOVE_RECORD",t)}))},storeRecord({commit:e},t){e("STORE_RECORD",t)},storeRelated({commit:e},{relatedIds:t,params:n}){e("STORE_RELATED",{relatedIds:t,params:n})},removeRecord({commit:e},t){e("REMOVE_RECORD",t)},resetState({commit:e}){e("RESET_STATE")},addRelated({getters:t},i){const{parent:o,relationship:s=e,data:a}=i,l=t.related(i).map((e=>e.id)),r=a.filter((e=>!l.includes(e))),d=r.map((e=>({type:s,id:e})));return n.createRelationships(o,s,d)},setRelated({commit:t},i){const{parent:o,relationship:s=e,data:a}=i;return n.updateRelationships(o,s,a).then((()=>{let e;e=Array.isArray(a)?a.map((e=>e.id)):null===a?null:a.id,t("STORE_RELATED",{params:{parent:o,relationship:s},relatedIds:e})}))},removeRelated({commit:t},i){const{parent:o,relationship:s=e,data:a}=i;let l;n.removeRelationships(o,s,a),l=Array.isArray(a)?a.map((e=>e.id)):a.id,t("REMOVE_RELATED",{params:{parent:o,relationship:s},relatedIds:l})},removeAllRelated({commit:t},i){const{parent:o,relationship:s=e}=i;n.updateRelationships(o,s,[]),t("REMOVE_RELATED",{params:{parent:o,relationship:s},relatedIds:[]})}},getters:{isLoading:e=>e.status===I,isError:e=>e.status===S,error:e=>e.error,hasPrevious:e=>!!e.links.prev,hasNext:e=>!!e.links.next,all:e=>e.records,lastCreated:e=>e.lastCreated,byId:e=>({id:t})=>e.records.find((e=>e.id==t)),lastMeta:e=>e.lastMeta,page:e=>e.page.map((t=>e.records.find((e=>e.id===t)))),where:e=>t=>{const n=e.filtered.find(F(t));if(!n)return[];const i=n.matchedIds;return i.map((t=>e.records.find((e=>e.id===t))))},related:e=>t=>{const n=i(t),o=e.related.find(F(n));if(o){if(Array.isArray(o.relatedIds)){const t=o.relatedIds;return t.map((t=>e.records.find((e=>e.id===t)))).filter((e=>void 0!==e))}{const t=o.relatedIds;return e.records.find((e=>t===e.id))}}return null}}}},W=({names:e,httpClient:t})=>e.reduce(((e,n)=>Object.assign({[n]:z({name:n,httpClient:t})},e)),{}),U=(0,i.y$)({modules:{taskEditor:h,coursewareBlock:k,requestQueue:f,...W({names:["courses","course-memberships","courseware-blocks","courseware-block-comments","courseware-block-feedback","courseware-clipboards","courseware-containers","courseware-instances","courseware-public-links","courseware-structural-elements","courseware-structural-element-comments","courseware-structural-element-feedback","courseware-task-feedback","courseware-task-groups","courseware-tasks","courseware-templates","courseware-user-data-fields","courseware-user-progresses","courseware-units","files","file-refs","folders","lti-tools","status-groups","users","institutes","institute-memberships","semesters","sem-classes","sem-types","terms-of-use","user-data-field","studip-properties","lernmodule-plugin/travis-go-posts","lernmodule-plugin/travis-go-comments"],httpClient:v.ok})}}),V=(0,o.f_)(h,U),X=(0,o.f_)(k,U),O=(0,o.f_)(f,U)},5951:function(e,t,n){"use strict";n.d(t,{A:function(){return c}});var i=n(6768),o=n(4232);const s={class:"error-message"};function a(e,t,n,a,l,r){return(0,i.uX)(),(0,i.CE)("div",s,[(0,i.Lk)("p",null,(0,o.v_)(e.$gettext("Es ist ein Fehler aufgetreten!")),1),(0,i.Lk)("p",null,(0,o.v_)(e.error),1)])}var l=n(4638),r=(0,i.pM)({name:"ErrorMessage",methods:{$gettext:l.o_},props:{error:{required:!1}}}),d=n(1241);const u=(0,d.A)(r,[["render",a],["__scopeId","data-v-2efd9bb9"]]);var c=u},8688:function(e,t,n){"use strict";n.d(t,{A:function(){return d}});var i=n(6768);const o=["value"];function s(e,t,n,s,a,l){return(0,i.uX)(),(0,i.CE)("textarea",{value:e.modelValue,ref:"studip_wysiwyg",class:"studip-wysiwyg",onInput:t[0]||(t[0]=t=>e.updateValue(t.target.value))},null,40,o)}var a=(0,i.pM)({name:"studip-wysiwyg",props:{modelValue:String,forceSoftBreaks:{type:Boolean,required:!1,default:!1},removeWrappingPTag:{type:Boolean,required:!1,default:!1},disableAutoformat:{type:Boolean,required:!1,default:!1},insertHtmlComment:{type:Boolean,required:!1,default:!1}},data(){return{fallbackActive:!1}},mounted(){let e=this.initCKE();e||(this.fallbackActive=!0)},watch:{modelValue(e){if(!this.fallbackActive){const t=this.$refs.studip_wysiwyg,n=window.STUDIP.wysiwyg.getEditor(t),i=this.getAdjustedCkeditorData();i!==e&&n.data.set(e)}}},methods:{initCKE(){const e=this.$refs.studip_wysiwyg;return e.onload=t=>{console.info("load");let n=window.STUDIP.wysiwyg.getEditor(e);if(n.model.document.on("change:data",(()=>{let e=this.getAdjustedCkeditorData();this.$emit("update:modelValue",e)})),n.ui.focusTracker.on("change:isFocused",((e,t,n)=>{this.$emit("focus",{event:e,name:t,value:n})})),n.editing.view.document.on("enter",((e,t)=>{this.forceSoftBreaks&&(n.execute("shiftEnter"),t.preventDefault(),e.stop())}),{priority:"high"}),this.disableAutoformat){const e=n.plugins.get("Autoformat");e.isEnabled=!1}},window.STUDIP.wysiwyg.replace(e),!0},updateValue(e){this.fallbackActive&&this.$emit("update:modelValue",e)},getAdjustedCkeditorData(){const e=this.$refs.studip_wysiwyg;let t=window.STUDIP.wysiwyg.getEditor(e),n=t.getData();return this.removeWrappingPTag&&(n=n.replace(/<p>(.*?)/,"$1").replace(/(.*?)<\/p>/,"$1")),this.insertHtmlComment&&(window.STUDIP.wysiwyg.hasHtmlMarker(n)||(n=window.STUDIP.wysiwyg.markAsHtml(n))),n}}}),l=n(1241);const r=(0,l.A)(a,[["render",s]]);var d=r},2141:function(e){"use strict";e.exports="data:application/font-woff;charset=utf-8;base64,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"},542:function(){}}]);
//# sourceMappingURL=chunk-common.js.map