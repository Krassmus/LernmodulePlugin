{"ast":null,"code":"function filterQueryString(obj) {\n  return Object.keys(obj).map(k => `filter[${k}]=${encodeURIComponent(obj[k])}`).join('&');\n}\nconst getOptionsQuery = (optionsObject = {}) => Object.keys(optionsObject).filter(k => typeof optionsObject[k] !== 'undefined').map(k => `${k}=${encodeURIComponent(optionsObject[k])}`).join('&');\nconst relatedResourceUrl = ({\n  parent,\n  relationship\n}) => {\n  const builtUrl = `${parent.type}/${parent.id}/${relationship}`;\n  if (parent.relationships && Object.keys(parent.relationships).includes(relationship)) {\n    return parent.relationships[relationship].links && parent.relationships[relationship].links.related || builtUrl;\n  }\n  return builtUrl;\n};\nconst extractData = response => response.data;\nconst extractErrorResponse = error => {\n  if (error && error.response) {\n    throw error.response;\n  } else {\n    throw error;\n  }\n};\nclass Resource {\n  constructor({\n    name,\n    httpClient\n  }) {\n    this.name = name;\n    this.api = httpClient;\n  }\n  all({\n    options = {}\n  } = {}) {\n    let url;\n    if (options.url) {\n      ({\n        url\n      } = options);\n    } else {\n      url = `${this.name}?${getOptionsQuery(options)}`;\n    }\n    return this.api.get(url).then(extractData).catch(extractErrorResponse);\n  }\n  find({\n    id,\n    options\n  } = {}) {\n    const url = `${this.name}/${id}?${getOptionsQuery(options)}`;\n    return this.api.get(url).then(extractData).catch(extractErrorResponse);\n  }\n  where({\n    filter,\n    options\n  } = {}) {\n    const queryString = filterQueryString(filter);\n    return this.api.get(`${this.name}?${queryString}&${getOptionsQuery(options)}`).then(extractData).catch(extractErrorResponse);\n  }\n  related({\n    parent,\n    relationship = this.name,\n    options\n  }) {\n    const baseUrl = relatedResourceUrl({\n      parent,\n      relationship\n    });\n    const url = `${baseUrl}?${getOptionsQuery(options)}`;\n    return this.api.get(url).then(extractData).catch(extractErrorResponse);\n  }\n  create(partialRecord) {\n    const record = Object.assign({}, partialRecord, {\n      type: this.name\n    });\n    const requestData = {\n      data: record\n    };\n    return this.api.post(`${this.name}`, requestData).then(extractData).catch(extractErrorResponse);\n  }\n  updateRelationships(parent, relationship, records) {\n    // https://jsonapi.org/format/#crud-updating-to-many-relationships\n    const requestData = {\n      data: records\n    };\n    return this.api.patch(`${parent.type}/${parent.id}/relationships/${relationship}`, requestData).then(extractData).catch(extractErrorResponse);\n  }\n  createRelationships(parent, relationship, records) {\n    // https://jsonapi.org/format/#crud-updating-to-many-relationships\n    const requestData = {\n      data: records\n    };\n    return this.api.post(`${parent.type}/${parent.id}/relationships/${relationship}`, requestData).then(extractData).catch(extractErrorResponse);\n  }\n  removeRelationships(parent, relationship, records) {\n    // https://jsonapi.org/format/#crud-updating-to-many-relationships\n    const requestData = {\n      data: records\n    };\n    return this.api.delete(`${parent.type}/${parent.id}/relationships/${relationship}`, requestData).then(extractData).catch(extractErrorResponse);\n  }\n  update(record) {\n    // http://jsonapi.org/faq/#wheres-put\n    const requestData = {\n      data: record\n    };\n    return this.api.patch(`${this.name}/${record.id}`, requestData).then(extractData).catch(extractErrorResponse);\n  }\n  delete({\n    id\n  }) {\n    return this.api.delete(`${this.name}/${id}`).catch(extractErrorResponse);\n  }\n}\nexport default Resource;","map":{"version":3,"names":["filterQueryString","obj","Object","keys","map","k","encodeURIComponent","join","getOptionsQuery","optionsObject","filter","relatedResourceUrl","parent","relationship","builtUrl","type","id","relationships","includes","links","related","extractData","response","data","extractErrorResponse","error","Resource","constructor","name","httpClient","api","all","options","url","get","then","catch","find","where","queryString","baseUrl","create","partialRecord","record","assign","requestData","post","updateRelationships","records","patch","createRelationships","removeRelationships","delete","update"],"sources":["/home/greg/dev/54/node_modules/@elan-ev/reststate-client/src/Resource.js"],"sourcesContent":["function filterQueryString(obj) {\n  return Object.keys(obj)\n    .map(k => `filter[${k}]=${encodeURIComponent(obj[k])}`)\n    .join('&');\n}\n\nconst getOptionsQuery = (optionsObject = {}) =>\n  Object.keys(optionsObject)\n    .filter(k => typeof optionsObject[k] !== 'undefined')\n    .map(k => `${k}=${encodeURIComponent(optionsObject[k])}`)\n    .join('&');\n\nconst relatedResourceUrl = ({ parent, relationship }) => {\n  const builtUrl = `${parent.type}/${parent.id}/${relationship}`;\n\n  if (\n    parent.relationships &&\n    Object.keys(parent.relationships).includes(relationship)\n  ) {\n    return (\n      (parent.relationships[relationship].links &&\n        parent.relationships[relationship].links.related) ||\n      builtUrl\n    );\n  }\n  return builtUrl;\n};\n\nconst extractData = response => response.data;\n\nconst extractErrorResponse = error => {\n  if (error && error.response) {\n    throw error.response;\n  } else {\n    throw error;\n  }\n};\n\nclass Resource {\n  constructor({ name, httpClient }) {\n    this.name = name;\n    this.api = httpClient;\n  }\n\n  all({ options = {} } = {}) {\n    let url;\n\n    if (options.url) {\n      ({ url } = options);\n    } else {\n      url = `${this.name}?${getOptionsQuery(options)}`;\n    }\n\n    return this.api.get(url).then(extractData).catch(extractErrorResponse);\n  }\n\n  find({ id, options } = {}) {\n    const url = `${this.name}/${id}?${getOptionsQuery(options)}`;\n\n    return this.api.get(url).then(extractData).catch(extractErrorResponse);\n  }\n\n  where({ filter, options } = {}) {\n    const queryString = filterQueryString(filter);\n    return this.api\n      .get(`${this.name}?${queryString}&${getOptionsQuery(options)}`)\n      .then(extractData)\n      .catch(extractErrorResponse);\n  }\n\n  related({ parent, relationship = this.name, options }) {\n    const baseUrl = relatedResourceUrl({ parent, relationship });\n    const url = `${baseUrl}?${getOptionsQuery(options)}`;\n    return this.api.get(url).then(extractData).catch(extractErrorResponse);\n  }\n\n  create(partialRecord) {\n    const record = Object.assign({}, partialRecord, { type: this.name });\n    const requestData = { data: record };\n    return this.api\n      .post(`${this.name}`, requestData)\n      .then(extractData)\n      .catch(extractErrorResponse);\n  }\n\n  updateRelationships(parent, relationship, records) {\n    // https://jsonapi.org/format/#crud-updating-to-many-relationships\n    const requestData = { data: records };\n    return this.api\n      .patch(\n        `${parent.type}/${parent.id}/relationships/${relationship}`,\n        requestData,\n      )\n      .then(extractData)\n      .catch(extractErrorResponse);\n  }\n\n  createRelationships(parent, relationship, records) {\n    // https://jsonapi.org/format/#crud-updating-to-many-relationships\n    const requestData = { data: records };\n    return this.api\n      .post(\n        `${parent.type}/${parent.id}/relationships/${relationship}`,\n        requestData,\n      )\n      .then(extractData)\n      .catch(extractErrorResponse);\n  }\n\n  removeRelationships(parent, relationship, records) {\n    // https://jsonapi.org/format/#crud-updating-to-many-relationships\n    const requestData = { data: records };\n    return this.api\n      .delete(\n        `${parent.type}/${parent.id}/relationships/${relationship}`,\n        requestData,\n      )\n      .then(extractData)\n      .catch(extractErrorResponse);\n  }\n\n  update(record) {\n    // http://jsonapi.org/faq/#wheres-put\n    const requestData = { data: record };\n    return this.api\n      .patch(`${this.name}/${record.id}`, requestData)\n      .then(extractData)\n      .catch(extractErrorResponse);\n  }\n\n  delete({ id }) {\n    return this.api.delete(`${this.name}/${id}`).catch(extractErrorResponse);\n  }\n}\n\nexport default Resource;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}