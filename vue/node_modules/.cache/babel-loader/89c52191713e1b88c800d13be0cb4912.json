{"ast":null,"code":"var conventions = require(\"./conventions\");\n\nvar dom = require('./dom');\n\nvar entities = require('./entities');\n\nvar sax = require('./sax');\n\nvar DOMImplementation = dom.DOMImplementation;\nvar NAMESPACE = conventions.NAMESPACE;\nvar ParseError = sax.ParseError;\nvar XMLReader = sax.XMLReader;\n/**\n * Normalizes line ending according to https://www.w3.org/TR/xml11/#sec-line-ends:\n *\n * > XML parsed entities are often stored in computer files which,\n * > for editing convenience, are organized into lines.\n * > These lines are typically separated by some combination\n * > of the characters CARRIAGE RETURN (#xD) and LINE FEED (#xA).\n * >\n * > To simplify the tasks of applications, the XML processor must behave\n * > as if it normalized all line breaks in external parsed entities (including the document entity)\n * > on input, before parsing, by translating all of the following to a single #xA character:\n * >\n * > 1. the two-character sequence #xD #xA\n * > 2. the two-character sequence #xD #x85\n * > 3. the single character #x85\n * > 4. the single character #x2028\n * > 5. any #xD character that is not immediately followed by #xA or #x85.\n *\n * @param {string} input\n * @returns {string}\n */\n\nfunction normalizeLineEndings(input) {\n  return input.replace(/\\r[\\n\\u0085]/g, '\\n').replace(/[\\r\\u0085\\u2028]/g, '\\n');\n}\n/**\n * @typedef Locator\n * @property {number} [columnNumber]\n * @property {number} [lineNumber]\n */\n\n/**\n * @typedef DOMParserOptions\n * @property {DOMHandler} [domBuilder]\n * @property {Function} [errorHandler]\n * @property {(string) => string} [normalizeLineEndings] used to replace line endings before parsing\n * \t\t\t\t\t\tdefaults to `normalizeLineEndings`\n * @property {Locator} [locator]\n * @property {Record<string, string>} [xmlns]\n *\n * @see normalizeLineEndings\n */\n\n/**\n * The DOMParser interface provides the ability to parse XML or HTML source code\n * from a string into a DOM `Document`.\n *\n * _xmldom is different from the spec in that it allows an `options` parameter,\n * to override the default behavior._\n *\n * @param {DOMParserOptions} [options]\n * @constructor\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/API/DOMParser\n * @see https://html.spec.whatwg.org/multipage/dynamic-markup-insertion.html#dom-parsing-and-serialization\n */\n\n\nfunction DOMParser(options) {\n  this.options = options || {\n    locator: {}\n  };\n}\n\nDOMParser.prototype.parseFromString = function (source, mimeType) {\n  var options = this.options;\n  var sax = new XMLReader();\n  var domBuilder = options.domBuilder || new DOMHandler(); //contentHandler and LexicalHandler\n\n  var errorHandler = options.errorHandler;\n  var locator = options.locator;\n  var defaultNSMap = options.xmlns || {};\n  var isHTML = /\\/x?html?$/.test(mimeType); //mimeType.toLowerCase().indexOf('html') > -1;\n\n  var entityMap = isHTML ? entities.HTML_ENTITIES : entities.XML_ENTITIES;\n\n  if (locator) {\n    domBuilder.setDocumentLocator(locator);\n  }\n\n  sax.errorHandler = buildErrorHandler(errorHandler, domBuilder, locator);\n  sax.domBuilder = options.domBuilder || domBuilder;\n\n  if (isHTML) {\n    defaultNSMap[''] = NAMESPACE.HTML;\n  }\n\n  defaultNSMap.xml = defaultNSMap.xml || NAMESPACE.XML;\n  var normalize = options.normalizeLineEndings || normalizeLineEndings;\n\n  if (source && typeof source === 'string') {\n    sax.parse(normalize(source), defaultNSMap, entityMap);\n  } else {\n    sax.errorHandler.error('invalid doc source');\n  }\n\n  return domBuilder.doc;\n};\n\nfunction buildErrorHandler(errorImpl, domBuilder, locator) {\n  if (!errorImpl) {\n    if (domBuilder instanceof DOMHandler) {\n      return domBuilder;\n    }\n\n    errorImpl = domBuilder;\n  }\n\n  var errorHandler = {};\n  var isCallback = errorImpl instanceof Function;\n  locator = locator || {};\n\n  function build(key) {\n    var fn = errorImpl[key];\n\n    if (!fn && isCallback) {\n      fn = errorImpl.length == 2 ? function (msg) {\n        errorImpl(key, msg);\n      } : errorImpl;\n    }\n\n    errorHandler[key] = fn && function (msg) {\n      fn('[xmldom ' + key + ']\\t' + msg + _locator(locator));\n    } || function () {};\n  }\n\n  build('warning');\n  build('error');\n  build('fatalError');\n  return errorHandler;\n} //console.log('#\\n\\n\\n\\n\\n\\n\\n####')\n\n/**\n * +ContentHandler+ErrorHandler\n * +LexicalHandler+EntityResolver2\n * -DeclHandler-DTDHandler\n *\n * DefaultHandler:EntityResolver, DTDHandler, ContentHandler, ErrorHandler\n * DefaultHandler2:DefaultHandler,LexicalHandler, DeclHandler, EntityResolver2\n * @link http://www.saxproject.org/apidoc/org/xml/sax/helpers/DefaultHandler.html\n */\n\n\nfunction DOMHandler() {\n  this.cdata = false;\n}\n\nfunction position(locator, node) {\n  node.lineNumber = locator.lineNumber;\n  node.columnNumber = locator.columnNumber;\n}\n/**\n * @see org.xml.sax.ContentHandler#startDocument\n * @link http://www.saxproject.org/apidoc/org/xml/sax/ContentHandler.html\n */\n\n\nDOMHandler.prototype = {\n  startDocument: function () {\n    this.doc = new DOMImplementation().createDocument(null, null, null);\n\n    if (this.locator) {\n      this.doc.documentURI = this.locator.systemId;\n    }\n  },\n  startElement: function (namespaceURI, localName, qName, attrs) {\n    var doc = this.doc;\n    var el = doc.createElementNS(namespaceURI, qName || localName);\n    var len = attrs.length;\n    appendElement(this, el);\n    this.currentElement = el;\n    this.locator && position(this.locator, el);\n\n    for (var i = 0; i < len; i++) {\n      var namespaceURI = attrs.getURI(i);\n      var value = attrs.getValue(i);\n      var qName = attrs.getQName(i);\n      var attr = doc.createAttributeNS(namespaceURI, qName);\n      this.locator && position(attrs.getLocator(i), attr);\n      attr.value = attr.nodeValue = value;\n      el.setAttributeNode(attr);\n    }\n  },\n  endElement: function (namespaceURI, localName, qName) {\n    var current = this.currentElement;\n    var tagName = current.tagName;\n    this.currentElement = current.parentNode;\n  },\n  startPrefixMapping: function (prefix, uri) {},\n  endPrefixMapping: function (prefix) {},\n  processingInstruction: function (target, data) {\n    var ins = this.doc.createProcessingInstruction(target, data);\n    this.locator && position(this.locator, ins);\n    appendElement(this, ins);\n  },\n  ignorableWhitespace: function (ch, start, length) {},\n  characters: function (chars, start, length) {\n    chars = _toString.apply(this, arguments); //console.log(chars)\n\n    if (chars) {\n      if (this.cdata) {\n        var charNode = this.doc.createCDATASection(chars);\n      } else {\n        var charNode = this.doc.createTextNode(chars);\n      }\n\n      if (this.currentElement) {\n        this.currentElement.appendChild(charNode);\n      } else if (/^\\s*$/.test(chars)) {\n        this.doc.appendChild(charNode); //process xml\n      }\n\n      this.locator && position(this.locator, charNode);\n    }\n  },\n  skippedEntity: function (name) {},\n  endDocument: function () {\n    this.doc.normalize();\n  },\n  setDocumentLocator: function (locator) {\n    if (this.locator = locator) {\n      // && !('lineNumber' in locator)){\n      locator.lineNumber = 0;\n    }\n  },\n  //LexicalHandler\n  comment: function (chars, start, length) {\n    chars = _toString.apply(this, arguments);\n    var comm = this.doc.createComment(chars);\n    this.locator && position(this.locator, comm);\n    appendElement(this, comm);\n  },\n  startCDATA: function () {\n    //used in characters() methods\n    this.cdata = true;\n  },\n  endCDATA: function () {\n    this.cdata = false;\n  },\n  startDTD: function (name, publicId, systemId) {\n    var impl = this.doc.implementation;\n\n    if (impl && impl.createDocumentType) {\n      var dt = impl.createDocumentType(name, publicId, systemId);\n      this.locator && position(this.locator, dt);\n      appendElement(this, dt);\n      this.doc.doctype = dt;\n    }\n  },\n\n  /**\n   * @see org.xml.sax.ErrorHandler\n   * @link http://www.saxproject.org/apidoc/org/xml/sax/ErrorHandler.html\n   */\n  warning: function (error) {\n    console.warn('[xmldom warning]\\t' + error, _locator(this.locator));\n  },\n  error: function (error) {\n    console.error('[xmldom error]\\t' + error, _locator(this.locator));\n  },\n  fatalError: function (error) {\n    throw new ParseError(error, this.locator);\n  }\n};\n\nfunction _locator(l) {\n  if (l) {\n    return '\\n@' + (l.systemId || '') + '#[line:' + l.lineNumber + ',col:' + l.columnNumber + ']';\n  }\n}\n\nfunction _toString(chars, start, length) {\n  if (typeof chars == 'string') {\n    return chars.substr(start, length);\n  } else {\n    //java sax connect width xmldom on rhino(what about: \"? && !(chars instanceof String)\")\n    if (chars.length >= start + length || start) {\n      return new java.lang.String(chars, start, length) + '';\n    }\n\n    return chars;\n  }\n}\n/*\n * @link http://www.saxproject.org/apidoc/org/xml/sax/ext/LexicalHandler.html\n * used method of org.xml.sax.ext.LexicalHandler:\n *  #comment(chars, start, length)\n *  #startCDATA()\n *  #endCDATA()\n *  #startDTD(name, publicId, systemId)\n *\n *\n * IGNORED method of org.xml.sax.ext.LexicalHandler:\n *  #endDTD()\n *  #startEntity(name)\n *  #endEntity(name)\n *\n *\n * @link http://www.saxproject.org/apidoc/org/xml/sax/ext/DeclHandler.html\n * IGNORED method of org.xml.sax.ext.DeclHandler\n * \t#attributeDecl(eName, aName, type, mode, value)\n *  #elementDecl(name, model)\n *  #externalEntityDecl(name, publicId, systemId)\n *  #internalEntityDecl(name, value)\n * @link http://www.saxproject.org/apidoc/org/xml/sax/ext/EntityResolver2.html\n * IGNORED method of org.xml.sax.EntityResolver2\n *  #resolveEntity(String name,String publicId,String baseURI,String systemId)\n *  #resolveEntity(publicId, systemId)\n *  #getExternalSubset(name, baseURI)\n * @link http://www.saxproject.org/apidoc/org/xml/sax/DTDHandler.html\n * IGNORED method of org.xml.sax.DTDHandler\n *  #notationDecl(name, publicId, systemId) {};\n *  #unparsedEntityDecl(name, publicId, systemId, notationName) {};\n */\n\n\n\"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl\".replace(/\\w+/g, function (key) {\n  DOMHandler.prototype[key] = function () {\n    return null;\n  };\n});\n/* Private static helpers treated below as private instance methods, so don't need to add these to the public API; we might use a Relator to also get rid of non-standard public properties */\n\nfunction appendElement(hander, node) {\n  if (!hander.currentElement) {\n    hander.doc.appendChild(node);\n  } else {\n    hander.currentElement.appendChild(node);\n  }\n} //appendChild and setAttributeNS are preformance key\n\n\nexports.__DOMHandler = DOMHandler;\nexports.normalizeLineEndings = normalizeLineEndings;\nexports.DOMParser = DOMParser;","map":{"version":3,"sources":["/home/ann/dev/studip/54/public/plugins_packages/RasmusFuhse/LernmodulePlugin/vue/node_modules/@xmldom/xmldom/lib/dom-parser.js"],"names":["conventions","require","dom","entities","sax","DOMImplementation","NAMESPACE","ParseError","XMLReader","normalizeLineEndings","input","replace","DOMParser","options","locator","prototype","parseFromString","source","mimeType","domBuilder","DOMHandler","errorHandler","defaultNSMap","xmlns","isHTML","test","entityMap","HTML_ENTITIES","XML_ENTITIES","setDocumentLocator","buildErrorHandler","HTML","xml","XML","normalize","parse","error","doc","errorImpl","isCallback","Function","build","key","fn","length","msg","_locator","cdata","position","node","lineNumber","columnNumber","startDocument","createDocument","documentURI","systemId","startElement","namespaceURI","localName","qName","attrs","el","createElementNS","len","appendElement","currentElement","i","getURI","value","getValue","getQName","attr","createAttributeNS","getLocator","nodeValue","setAttributeNode","endElement","current","tagName","parentNode","startPrefixMapping","prefix","uri","endPrefixMapping","processingInstruction","target","data","ins","createProcessingInstruction","ignorableWhitespace","ch","start","characters","chars","_toString","apply","arguments","charNode","createCDATASection","createTextNode","appendChild","skippedEntity","name","endDocument","comment","comm","createComment","startCDATA","endCDATA","startDTD","publicId","impl","implementation","createDocumentType","dt","doctype","warning","console","warn","fatalError","l","substr","java","lang","String","hander","exports","__DOMHandler"],"mappings":"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","sourcesContent":["var conventions = require(\"./conventions\");\nvar dom = require('./dom')\nvar entities = require('./entities');\nvar sax = require('./sax');\n\nvar DOMImplementation = dom.DOMImplementation;\n\nvar NAMESPACE = conventions.NAMESPACE;\n\nvar ParseError = sax.ParseError;\nvar XMLReader = sax.XMLReader;\n\n/**\n * Normalizes line ending according to https://www.w3.org/TR/xml11/#sec-line-ends:\n *\n * > XML parsed entities are often stored in computer files which,\n * > for editing convenience, are organized into lines.\n * > These lines are typically separated by some combination\n * > of the characters CARRIAGE RETURN (#xD) and LINE FEED (#xA).\n * >\n * > To simplify the tasks of applications, the XML processor must behave\n * > as if it normalized all line breaks in external parsed entities (including the document entity)\n * > on input, before parsing, by translating all of the following to a single #xA character:\n * >\n * > 1. the two-character sequence #xD #xA\n * > 2. the two-character sequence #xD #x85\n * > 3. the single character #x85\n * > 4. the single character #x2028\n * > 5. any #xD character that is not immediately followed by #xA or #x85.\n *\n * @param {string} input\n * @returns {string}\n */\nfunction normalizeLineEndings(input) {\n\treturn input\n\t\t.replace(/\\r[\\n\\u0085]/g, '\\n')\n\t\t.replace(/[\\r\\u0085\\u2028]/g, '\\n')\n}\n\n/**\n * @typedef Locator\n * @property {number} [columnNumber]\n * @property {number} [lineNumber]\n */\n\n/**\n * @typedef DOMParserOptions\n * @property {DOMHandler} [domBuilder]\n * @property {Function} [errorHandler]\n * @property {(string) => string} [normalizeLineEndings] used to replace line endings before parsing\n * \t\t\t\t\t\tdefaults to `normalizeLineEndings`\n * @property {Locator} [locator]\n * @property {Record<string, string>} [xmlns]\n *\n * @see normalizeLineEndings\n */\n\n/**\n * The DOMParser interface provides the ability to parse XML or HTML source code\n * from a string into a DOM `Document`.\n *\n * _xmldom is different from the spec in that it allows an `options` parameter,\n * to override the default behavior._\n *\n * @param {DOMParserOptions} [options]\n * @constructor\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/API/DOMParser\n * @see https://html.spec.whatwg.org/multipage/dynamic-markup-insertion.html#dom-parsing-and-serialization\n */\nfunction DOMParser(options){\n\tthis.options = options ||{locator:{}};\n}\n\nDOMParser.prototype.parseFromString = function(source,mimeType){\n\tvar options = this.options;\n\tvar sax =  new XMLReader();\n\tvar domBuilder = options.domBuilder || new DOMHandler();//contentHandler and LexicalHandler\n\tvar errorHandler = options.errorHandler;\n\tvar locator = options.locator;\n\tvar defaultNSMap = options.xmlns||{};\n\tvar isHTML = /\\/x?html?$/.test(mimeType);//mimeType.toLowerCase().indexOf('html') > -1;\n  \tvar entityMap = isHTML ? entities.HTML_ENTITIES : entities.XML_ENTITIES;\n\tif(locator){\n\t\tdomBuilder.setDocumentLocator(locator)\n\t}\n\n\tsax.errorHandler = buildErrorHandler(errorHandler,domBuilder,locator);\n\tsax.domBuilder = options.domBuilder || domBuilder;\n\tif(isHTML){\n\t\tdefaultNSMap[''] = NAMESPACE.HTML;\n\t}\n\tdefaultNSMap.xml = defaultNSMap.xml || NAMESPACE.XML;\n\tvar normalize = options.normalizeLineEndings || normalizeLineEndings;\n\tif (source && typeof source === 'string') {\n\t\tsax.parse(\n\t\t\tnormalize(source),\n\t\t\tdefaultNSMap,\n\t\t\tentityMap\n\t\t)\n\t} else {\n\t\tsax.errorHandler.error('invalid doc source')\n\t}\n\treturn domBuilder.doc;\n}\nfunction buildErrorHandler(errorImpl,domBuilder,locator){\n\tif(!errorImpl){\n\t\tif(domBuilder instanceof DOMHandler){\n\t\t\treturn domBuilder;\n\t\t}\n\t\terrorImpl = domBuilder ;\n\t}\n\tvar errorHandler = {}\n\tvar isCallback = errorImpl instanceof Function;\n\tlocator = locator||{}\n\tfunction build(key){\n\t\tvar fn = errorImpl[key];\n\t\tif(!fn && isCallback){\n\t\t\tfn = errorImpl.length == 2?function(msg){errorImpl(key,msg)}:errorImpl;\n\t\t}\n\t\terrorHandler[key] = fn && function(msg){\n\t\t\tfn('[xmldom '+key+']\\t'+msg+_locator(locator));\n\t\t}||function(){};\n\t}\n\tbuild('warning');\n\tbuild('error');\n\tbuild('fatalError');\n\treturn errorHandler;\n}\n\n//console.log('#\\n\\n\\n\\n\\n\\n\\n####')\n/**\n * +ContentHandler+ErrorHandler\n * +LexicalHandler+EntityResolver2\n * -DeclHandler-DTDHandler\n *\n * DefaultHandler:EntityResolver, DTDHandler, ContentHandler, ErrorHandler\n * DefaultHandler2:DefaultHandler,LexicalHandler, DeclHandler, EntityResolver2\n * @link http://www.saxproject.org/apidoc/org/xml/sax/helpers/DefaultHandler.html\n */\nfunction DOMHandler() {\n    this.cdata = false;\n}\nfunction position(locator,node){\n\tnode.lineNumber = locator.lineNumber;\n\tnode.columnNumber = locator.columnNumber;\n}\n/**\n * @see org.xml.sax.ContentHandler#startDocument\n * @link http://www.saxproject.org/apidoc/org/xml/sax/ContentHandler.html\n */\nDOMHandler.prototype = {\n\tstartDocument : function() {\n    \tthis.doc = new DOMImplementation().createDocument(null, null, null);\n    \tif (this.locator) {\n        \tthis.doc.documentURI = this.locator.systemId;\n    \t}\n\t},\n\tstartElement:function(namespaceURI, localName, qName, attrs) {\n\t\tvar doc = this.doc;\n\t    var el = doc.createElementNS(namespaceURI, qName||localName);\n\t    var len = attrs.length;\n\t    appendElement(this, el);\n\t    this.currentElement = el;\n\n\t\tthis.locator && position(this.locator,el)\n\t    for (var i = 0 ; i < len; i++) {\n\t        var namespaceURI = attrs.getURI(i);\n\t        var value = attrs.getValue(i);\n\t        var qName = attrs.getQName(i);\n\t\t\tvar attr = doc.createAttributeNS(namespaceURI, qName);\n\t\t\tthis.locator &&position(attrs.getLocator(i),attr);\n\t\t\tattr.value = attr.nodeValue = value;\n\t\t\tel.setAttributeNode(attr)\n\t    }\n\t},\n\tendElement:function(namespaceURI, localName, qName) {\n\t\tvar current = this.currentElement\n\t\tvar tagName = current.tagName;\n\t\tthis.currentElement = current.parentNode;\n\t},\n\tstartPrefixMapping:function(prefix, uri) {\n\t},\n\tendPrefixMapping:function(prefix) {\n\t},\n\tprocessingInstruction:function(target, data) {\n\t    var ins = this.doc.createProcessingInstruction(target, data);\n\t    this.locator && position(this.locator,ins)\n\t    appendElement(this, ins);\n\t},\n\tignorableWhitespace:function(ch, start, length) {\n\t},\n\tcharacters:function(chars, start, length) {\n\t\tchars = _toString.apply(this,arguments)\n\t\t//console.log(chars)\n\t\tif(chars){\n\t\t\tif (this.cdata) {\n\t\t\t\tvar charNode = this.doc.createCDATASection(chars);\n\t\t\t} else {\n\t\t\t\tvar charNode = this.doc.createTextNode(chars);\n\t\t\t}\n\t\t\tif(this.currentElement){\n\t\t\t\tthis.currentElement.appendChild(charNode);\n\t\t\t}else if(/^\\s*$/.test(chars)){\n\t\t\t\tthis.doc.appendChild(charNode);\n\t\t\t\t//process xml\n\t\t\t}\n\t\t\tthis.locator && position(this.locator,charNode)\n\t\t}\n\t},\n\tskippedEntity:function(name) {\n\t},\n\tendDocument:function() {\n\t\tthis.doc.normalize();\n\t},\n\tsetDocumentLocator:function (locator) {\n\t    if(this.locator = locator){// && !('lineNumber' in locator)){\n\t    \tlocator.lineNumber = 0;\n\t    }\n\t},\n\t//LexicalHandler\n\tcomment:function(chars, start, length) {\n\t\tchars = _toString.apply(this,arguments)\n\t    var comm = this.doc.createComment(chars);\n\t    this.locator && position(this.locator,comm)\n\t    appendElement(this, comm);\n\t},\n\n\tstartCDATA:function() {\n\t    //used in characters() methods\n\t    this.cdata = true;\n\t},\n\tendCDATA:function() {\n\t    this.cdata = false;\n\t},\n\n\tstartDTD:function(name, publicId, systemId) {\n\t\tvar impl = this.doc.implementation;\n\t    if (impl && impl.createDocumentType) {\n\t        var dt = impl.createDocumentType(name, publicId, systemId);\n\t        this.locator && position(this.locator,dt)\n\t        appendElement(this, dt);\n\t\t\t\t\tthis.doc.doctype = dt;\n\t    }\n\t},\n\t/**\n\t * @see org.xml.sax.ErrorHandler\n\t * @link http://www.saxproject.org/apidoc/org/xml/sax/ErrorHandler.html\n\t */\n\twarning:function(error) {\n\t\tconsole.warn('[xmldom warning]\\t'+error,_locator(this.locator));\n\t},\n\terror:function(error) {\n\t\tconsole.error('[xmldom error]\\t'+error,_locator(this.locator));\n\t},\n\tfatalError:function(error) {\n\t\tthrow new ParseError(error, this.locator);\n\t}\n}\nfunction _locator(l){\n\tif(l){\n\t\treturn '\\n@'+(l.systemId ||'')+'#[line:'+l.lineNumber+',col:'+l.columnNumber+']'\n\t}\n}\nfunction _toString(chars,start,length){\n\tif(typeof chars == 'string'){\n\t\treturn chars.substr(start,length)\n\t}else{//java sax connect width xmldom on rhino(what about: \"? && !(chars instanceof String)\")\n\t\tif(chars.length >= start+length || start){\n\t\t\treturn new java.lang.String(chars,start,length)+'';\n\t\t}\n\t\treturn chars;\n\t}\n}\n\n/*\n * @link http://www.saxproject.org/apidoc/org/xml/sax/ext/LexicalHandler.html\n * used method of org.xml.sax.ext.LexicalHandler:\n *  #comment(chars, start, length)\n *  #startCDATA()\n *  #endCDATA()\n *  #startDTD(name, publicId, systemId)\n *\n *\n * IGNORED method of org.xml.sax.ext.LexicalHandler:\n *  #endDTD()\n *  #startEntity(name)\n *  #endEntity(name)\n *\n *\n * @link http://www.saxproject.org/apidoc/org/xml/sax/ext/DeclHandler.html\n * IGNORED method of org.xml.sax.ext.DeclHandler\n * \t#attributeDecl(eName, aName, type, mode, value)\n *  #elementDecl(name, model)\n *  #externalEntityDecl(name, publicId, systemId)\n *  #internalEntityDecl(name, value)\n * @link http://www.saxproject.org/apidoc/org/xml/sax/ext/EntityResolver2.html\n * IGNORED method of org.xml.sax.EntityResolver2\n *  #resolveEntity(String name,String publicId,String baseURI,String systemId)\n *  #resolveEntity(publicId, systemId)\n *  #getExternalSubset(name, baseURI)\n * @link http://www.saxproject.org/apidoc/org/xml/sax/DTDHandler.html\n * IGNORED method of org.xml.sax.DTDHandler\n *  #notationDecl(name, publicId, systemId) {};\n *  #unparsedEntityDecl(name, publicId, systemId, notationName) {};\n */\n\"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl\".replace(/\\w+/g,function(key){\n\tDOMHandler.prototype[key] = function(){return null}\n})\n\n/* Private static helpers treated below as private instance methods, so don't need to add these to the public API; we might use a Relator to also get rid of non-standard public properties */\nfunction appendElement (hander,node) {\n    if (!hander.currentElement) {\n        hander.doc.appendChild(node);\n    } else {\n        hander.currentElement.appendChild(node);\n    }\n}//appendChild and setAttributeNS are preformance key\n\nexports.__DOMHandler = DOMHandler;\nexports.normalizeLineEndings = normalizeLineEndings;\nexports.DOMParser = DOMParser;\n"]},"metadata":{},"sourceType":"script"}