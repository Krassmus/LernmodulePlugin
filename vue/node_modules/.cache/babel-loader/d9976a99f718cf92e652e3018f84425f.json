{"ast":null,"code":"import _get from \"/home/ann/dev/studip/54/public/plugins_packages/RasmusFuhse/LernmodulePlugin/vue/node_modules/@babel/runtime/helpers/esm/get.js\";\nimport _getPrototypeOf from \"/home/ann/dev/studip/54/public/plugins_packages/RasmusFuhse/LernmodulePlugin/vue/node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js\";\n\nvar _class;\n\nimport \"core-js/modules/es.error.cause.js\";\nimport { D as DOMEvent, J as EventsTarget, V as ViewController, l as listenEvent, o as onDispose, h as signal, p as peek, O as isArray, y as isUndefined, A as isNumber, S as State, P as tick, Q as createContext, v as useContext, C as Component, e as effect, t as isKeyboardEvent, j as computed, R as root, M as unwrap, T as kebabToCamelCase, x as camelToKebabCase, k as isString, i as isKeyboardClick, U as waitIdlePeriod, q as appendTriggerEvent, f as setAttribute, I as deferredPromise, g as getScope, W as provideContext, L as animationFrameThrottle, X as uppercaseFirstChar, a as setStyle, s as scoped, Y as prop, Z as method, _ as noop, $ as ariaBool$1, a0 as isWriteSignal, G as isNull, a1 as hasProvidedContext, u as useState, F as createScope, r as isPointerEvent, a2 as isMouseEvent, a3 as isTouchEvent, a4 as createDisposalBin } from './vidstack-b8ba7e3c.js';\nimport { i as isTrackCaptionKind, T as TextTrackSymbol, a as TextTrack, p as preconnect, g as getRequestCredentials, f as findActiveCue, o as observeActiveTextTrack, b as isCueActive } from './vidstack-dd29a7a5.js';\nimport { L as ListSymbol, a as canOrientScreen, A as AUDIO_EXTENSIONS, l as AUDIO_TYPES, V as VIDEO_EXTENSIONS, m as VIDEO_TYPES, h as isHLSSrc, b as canPlayHLSNatively, i as isHLSSupported, r as round, n as IS_IPHONE, c as canChangeVolume, o as clampNumber, g as IS_SAFARI, j as getNumberOfDecimalPlaces } from './vidstack-e4c46e48.js';\nimport { Q as QualitySymbol, c as coerceToError } from './vidstack-ba5dcbce.js';\nimport { s as setAttributeIfEmpty, h as hasAnimation, r as requestScopedAnimationFrame, d as autoPlacement, o as onPress, e as setARIALabel, i as isElementParent } from './vidstack-b97c0002.js';\nimport 'media-captions';\n\nvar _a$1;\n\nconst GROUPED_LOG = Symbol(\"GROUPED_LOG\");\n\nclass GroupedLog {\n  constructor(logger, level, title, root, parent) {\n    this.logger = logger;\n    this.level = level;\n    this.title = title;\n    this.root = root;\n    this.parent = parent;\n    this[_a$1] = true;\n    this.logs = [];\n  }\n\n  log(...data) {\n    this.logs.push({\n      data\n    });\n    return this;\n  }\n\n  labelledLog(label, ...data) {\n    this.logs.push({\n      label,\n      data\n    });\n    return this;\n  }\n\n  groupStart(title) {\n    return new GroupedLog(this.logger, this.level, title, this.root ?? this, this);\n  }\n\n  groupEnd() {\n    this.parent?.logs.push(this);\n    return this.parent ?? this;\n  }\n\n  dispatch() {\n    return this.logger.dispatch(this.level, this.root ?? this);\n  }\n\n}\n\n_a$1 = GROUPED_LOG;\n\nfunction isGroupedLog(data) {\n  return !!data?.[GROUPED_LOG];\n}\n\nclass Logger {\n  constructor() {\n    this._target = null;\n  }\n\n  error(...data) {\n    return this.dispatch(\"error\", ...data);\n  }\n\n  warn(...data) {\n    return this.dispatch(\"warn\", ...data);\n  }\n\n  info(...data) {\n    return this.dispatch(\"info\", ...data);\n  }\n\n  debug(...data) {\n    return this.dispatch(\"debug\", ...data);\n  }\n\n  errorGroup(title) {\n    return new GroupedLog(this, \"error\", title);\n  }\n\n  warnGroup(title) {\n    return new GroupedLog(this, \"warn\", title);\n  }\n\n  infoGroup(title) {\n    return new GroupedLog(this, \"info\", title);\n  }\n\n  debugGroup(title) {\n    return new GroupedLog(this, \"debug\", title);\n  }\n\n  setTarget(newTarget) {\n    this._target = newTarget;\n  }\n\n  dispatch(level, ...data) {\n    return this._target?.dispatchEvent(new DOMEvent(\"vds-log\", {\n      bubbles: true,\n      composed: true,\n      detail: {\n        level,\n        data\n      }\n    })) || false;\n  }\n\n}\n\nvar _a;\n\nclass List extends EventsTarget {\n  constructor() {\n    super(...arguments);\n    this._items = [];\n    /* @internal */\n\n    this[_a] = false;\n  }\n\n  get length() {\n    return this._items.length;\n  }\n\n  get readonly() {\n    return this[ListSymbol._readonly];\n  }\n  /**\n   * Transform list to an array.\n   */\n\n\n  toArray() {\n    return [...this._items];\n  }\n\n  [(_a = ListSymbol._readonly, Symbol.iterator)]() {\n    return this._items.values();\n  }\n  /* @internal */\n\n\n  [ListSymbol._add](item, trigger) {\n    const index = this._items.length;\n\n    if (!(\"\" + index in this)) {\n      Object.defineProperty(this, index, {\n        get() {\n          return this._items[index];\n        }\n\n      });\n    }\n\n    if (this._items.includes(item)) return;\n\n    this._items.push(item);\n\n    this.dispatchEvent(new DOMEvent(\"add\", {\n      detail: item,\n      trigger\n    }));\n  }\n  /* @internal */\n\n\n  [ListSymbol._remove](item, trigger) {\n    const index = this._items.indexOf(item);\n\n    if (index >= 0) {\n      this[ListSymbol._onRemove]?.(item, trigger);\n\n      this._items.splice(index, 1);\n\n      this.dispatchEvent(new DOMEvent(\"remove\", {\n        detail: item,\n        trigger\n      }));\n    }\n  }\n  /* @internal */\n\n\n  [ListSymbol._reset](trigger) {\n    for (const item of [...this._items]) this[ListSymbol._remove](item, trigger);\n\n    this._items = [];\n\n    this[ListSymbol._setReadonly](false, trigger);\n\n    this[ListSymbol._onReset]?.();\n  }\n  /* @internal */\n\n\n  [ListSymbol._setReadonly](readonly, trigger) {\n    if (this[ListSymbol._readonly] === readonly) return;\n    this[ListSymbol._readonly] = readonly;\n    this.dispatchEvent(new DOMEvent(\"readonly-change\", {\n      detail: readonly,\n      trigger\n    }));\n  }\n\n}\n\nvar key = {\n  fullscreenEnabled: 0,\n  fullscreenElement: 1,\n  requestFullscreen: 2,\n  exitFullscreen: 3,\n  fullscreenchange: 4,\n  fullscreenerror: 5,\n  fullscreen: 6\n};\nvar webkit = ['webkitFullscreenEnabled', 'webkitFullscreenElement', 'webkitRequestFullscreen', 'webkitExitFullscreen', 'webkitfullscreenchange', 'webkitfullscreenerror', '-webkit-full-screen'];\nvar moz = ['mozFullScreenEnabled', 'mozFullScreenElement', 'mozRequestFullScreen', 'mozCancelFullScreen', 'mozfullscreenchange', 'mozfullscreenerror', '-moz-full-screen'];\nvar ms$1 = ['msFullscreenEnabled', 'msFullscreenElement', 'msRequestFullscreen', 'msExitFullscreen', 'MSFullscreenChange', 'MSFullscreenError', '-ms-fullscreen']; // so it doesn't throw if no window or document\n\nvar document$1 = typeof window !== 'undefined' && typeof window.document !== 'undefined' ? window.document : {};\nvar vendor = 'fullscreenEnabled' in document$1 && Object.keys(key) || webkit[0] in document$1 && webkit || moz[0] in document$1 && moz || ms$1[0] in document$1 && ms$1 || [];\nvar fscreen = {\n  requestFullscreen: function (element) {\n    return element[vendor[key.requestFullscreen]]();\n  },\n  requestFullscreenFunction: function (element) {\n    return element[vendor[key.requestFullscreen]];\n  },\n\n  get exitFullscreen() {\n    return document$1[vendor[key.exitFullscreen]].bind(document$1);\n  },\n\n  get fullscreenPseudoClass() {\n    return \":\" + vendor[key.fullscreen];\n  },\n\n  addEventListener: function (type, handler, options) {\n    return document$1.addEventListener(vendor[key[type]], handler, options);\n  },\n  removeEventListener: function (type, handler, options) {\n    return document$1.removeEventListener(vendor[key[type]], handler, options);\n  },\n\n  get fullscreenEnabled() {\n    return Boolean(document$1[vendor[key.fullscreenEnabled]]);\n  },\n\n  set fullscreenEnabled(val) {},\n\n  get fullscreenElement() {\n    return document$1[vendor[key.fullscreenElement]];\n  },\n\n  set fullscreenElement(val) {},\n\n  get onfullscreenchange() {\n    return document$1[(\"on\" + vendor[key.fullscreenchange]).toLowerCase()];\n  },\n\n  set onfullscreenchange(handler) {\n    return document$1[(\"on\" + vendor[key.fullscreenchange]).toLowerCase()] = handler;\n  },\n\n  get onfullscreenerror() {\n    return document$1[(\"on\" + vendor[key.fullscreenerror]).toLowerCase()];\n  },\n\n  set onfullscreenerror(handler) {\n    return document$1[(\"on\" + vendor[key.fullscreenerror]).toLowerCase()] = handler;\n  }\n\n};\nvar fscreen$1 = fscreen;\nconst CAN_FULLSCREEN = fscreen$1.fullscreenEnabled;\n\nclass FullscreenController extends ViewController {\n  constructor() {\n    super(...arguments);\n    /**\n     * Tracks whether we're the active fullscreen event listener. Fullscreen events can only be\n     * listened to globally on the document so we need to know if they relate to the current host\n     * element or not.\n     */\n\n    this._listening = false;\n    this._active = false;\n  }\n\n  get active() {\n    return this._active;\n  }\n\n  get supported() {\n    return CAN_FULLSCREEN;\n  }\n\n  onConnect() {\n    listenEvent(fscreen$1, \"fullscreenchange\", this._onFullscreenChange.bind(this));\n    listenEvent(fscreen$1, \"fullscreenerror\", this._onFullscreenError.bind(this));\n    onDispose(this._onDisconnect.bind(this));\n  }\n\n  async _onDisconnect() {\n    if (CAN_FULLSCREEN) await this.exit();\n  }\n\n  _onFullscreenChange(event) {\n    const active = isFullscreen(this.el);\n    if (active === this._active) return;\n    if (!active) this._listening = false;\n    this._active = active;\n    this.dispatch(\"fullscreen-change\", {\n      detail: active,\n      trigger: event\n    });\n  }\n\n  _onFullscreenError(event) {\n    if (!this._listening) return;\n    this.dispatch(\"fullscreen-error\", {\n      detail: null,\n      trigger: event\n    });\n    this._listening = false;\n  }\n\n  async enter() {\n    try {\n      this._listening = true;\n      if (!this.el || isFullscreen(this.el)) return;\n      assertFullscreenAPI();\n      return fscreen$1.requestFullscreen(this.el);\n    } catch (error) {\n      this._listening = false;\n      throw error;\n    }\n  }\n\n  async exit() {\n    if (!this.el || !isFullscreen(this.el)) return;\n    assertFullscreenAPI();\n    return fscreen$1.exitFullscreen();\n  }\n\n}\n\nfunction canFullscreen() {\n  return CAN_FULLSCREEN;\n}\n\nfunction isFullscreen(host) {\n  if (fscreen$1.fullscreenElement === host) return true;\n\n  try {\n    return host.matches( // @ts-expect-error - `fullscreenPseudoClass` is missing from `@types/fscreen`.\n    fscreen$1.fullscreenPseudoClass);\n  } catch (error) {\n    return false;\n  }\n}\n\nfunction assertFullscreenAPI() {\n  if (CAN_FULLSCREEN) return;\n  throw Error(\"[vidstack] fullscreen API is not enabled or supported in this environment\");\n}\n\nconst CAN_USE_SCREEN_ORIENTATION_API = canOrientScreen();\n\nclass ScreenOrientationController extends ViewController {\n  constructor() {\n    super(...arguments);\n    this._type = signal(getScreenOrientation());\n    this._locked = signal(false);\n  }\n  /**\n   * The current screen orientation type.\n   *\n   * @signal\n   * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/ScreenOrientation}\n   * @see https://w3c.github.io/screen-orientation/#screen-orientation-types-and-locks\n   */\n\n\n  get type() {\n    return this._type();\n  }\n  /**\n   * Whether the screen orientation is currently locked.\n   *\n   * @signal\n   * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/ScreenOrientation}\n   * @see https://w3c.github.io/screen-orientation/#screen-orientation-types-and-locks\n   */\n\n\n  get locked() {\n    return this._locked();\n  }\n  /**\n   * Whether the viewport is in a portrait orientation.\n   *\n   * @signal\n   */\n\n\n  get portrait() {\n    return this._type().startsWith(\"portrait\");\n  }\n  /**\n   * Whether the viewport is in a landscape orientation.\n   *\n   * @signal\n   */\n\n\n  get landscape() {\n    return this._type().startsWith(\"landscape\");\n  }\n  /**\n   * Whether the native Screen Orientation API is available.\n   */\n\n\n  get supported() {\n    return CAN_USE_SCREEN_ORIENTATION_API;\n  }\n\n  onConnect() {\n    if (CAN_USE_SCREEN_ORIENTATION_API) {\n      listenEvent(screen.orientation, \"change\", this._onOrientationChange.bind(this));\n    } else {\n      const query = window.matchMedia(\"(orientation: landscape)\");\n      query.onchange = this._onOrientationChange.bind(this);\n      onDispose(() => query.onchange = null);\n    }\n\n    onDispose(this._onDisconnect.bind(this));\n  }\n\n  async _onDisconnect() {\n    if (CAN_USE_SCREEN_ORIENTATION_API && this._locked()) await this.unlock();\n  }\n\n  _onOrientationChange(event) {\n    this._type.set(getScreenOrientation());\n\n    this.dispatch(\"orientation-change\", {\n      detail: {\n        orientation: peek(this._type),\n        lock: this._currentLock\n      },\n      trigger: event\n    });\n  }\n  /**\n   * Locks the orientation of the screen to the desired orientation type using the\n   * Screen Orientation API.\n   *\n   * @param lockType - The screen lock orientation type.\n   * @throws Error - If screen orientation API is unavailable.\n   * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/Screen/orientation}\n   * @see {@link https://w3c.github.io/screen-orientation}\n   */\n\n\n  async lock(lockType) {\n    if (peek(this._locked) || this._currentLock === lockType) return;\n    assertScreenOrientationAPI();\n    await screen.orientation.lock(lockType);\n\n    this._locked.set(true);\n\n    this._currentLock = lockType;\n  }\n  /**\n   * Unlocks the orientation of the screen to it's default state using the Screen Orientation\n   * API. This method will throw an error if the API is unavailable.\n   *\n   * @throws Error - If screen orientation API is unavailable.\n   * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/Screen/orientation}\n   * @see {@link https://w3c.github.io/screen-orientation}\n   */\n\n\n  async unlock() {\n    if (!peek(this._locked)) return;\n    assertScreenOrientationAPI();\n    this._currentLock = void 0;\n    await screen.orientation.unlock();\n\n    this._locked.set(false);\n  }\n\n}\n\nfunction assertScreenOrientationAPI() {\n  if (CAN_USE_SCREEN_ORIENTATION_API) return;\n  throw Error(\"[vidstack] screen orientation API is not available\");\n}\n\nfunction getScreenOrientation() {\n  if (CAN_USE_SCREEN_ORIENTATION_API) return window.screen.orientation.type;\n  return window.innerWidth >= window.innerHeight ? \"landscape-primary\" : \"portrait-primary\";\n}\n\nclass TimeRange {\n  get length() {\n    return this._ranges.length;\n  }\n\n  constructor(start, end) {\n    if (isArray(start)) {\n      this._ranges = start;\n    } else if (!isUndefined(start) && !isUndefined(end)) {\n      this._ranges = [[start, end]];\n    } else {\n      this._ranges = [];\n    }\n  }\n\n  start(index) {\n    throwIfEmpty(this._ranges.length);\n    throwIfOutOfRange(\"start\", index, this._ranges.length - 1);\n    return this._ranges[index][0] ?? Infinity;\n  }\n\n  end(index) {\n    throwIfEmpty(this._ranges.length);\n    throwIfOutOfRange(\"end\", index, this._ranges.length - 1);\n    return this._ranges[index][1] ?? Infinity;\n  }\n\n}\n\nfunction getTimeRangesStart(range) {\n  if (!range.length) return null;\n  let min = range.start(0);\n\n  for (let i = 1; i < range.length; i++) {\n    const value = range.start(i);\n    if (value < min) min = value;\n  }\n\n  return min;\n}\n\nfunction getTimeRangesEnd(range) {\n  if (!range.length) return null;\n  let max = range.end(0);\n\n  for (let i = 1; i < range.length; i++) {\n    const value = range.end(i);\n    if (value > max) max = value;\n  }\n\n  return max;\n}\n\nfunction throwIfEmpty(length) {\n  if (!length) throw new Error(\"`TimeRanges` object is empty.\");\n}\n\nfunction throwIfOutOfRange(fnName, index, end) {\n  if (!isNumber(index) || index < 0 || index > end) {\n    throw new Error(`Failed to execute '${fnName}' on 'TimeRanges': The index provided (${index}) is non-numeric or out of bounds (0-${end}).`);\n  }\n}\n\nconst mediaState = new State({\n  audioTracks: [],\n  audioTrack: null,\n  autoplay: false,\n  autoplayError: void 0,\n  buffered: new TimeRange(),\n  duration: 0,\n  canLoad: false,\n  canFullscreen: false,\n  canPictureInPicture: false,\n  canPlay: false,\n  controls: false,\n  controlsVisible: false,\n  crossorigin: null,\n  poster: \"\",\n  currentTime: 0,\n  ended: false,\n  error: void 0,\n  fullscreen: false,\n  loop: false,\n  logLevel: \"warn\",\n  mediaType: \"unknown\",\n  muted: false,\n  paused: true,\n  played: new TimeRange(),\n  playing: false,\n  playsinline: false,\n  pictureInPicture: false,\n  preload: \"metadata\",\n  playbackRate: 1,\n  qualities: [],\n  quality: null,\n  autoQuality: false,\n  canSetQuality: true,\n  canSetVolume: false,\n  seekable: new TimeRange(),\n  seeking: false,\n  source: {\n    src: \"\",\n    type: \"\"\n  },\n  sources: [],\n  started: false,\n  title: \"\",\n  textTracks: [],\n  textTrack: null,\n  volume: 1,\n  waiting: false,\n\n  get viewType() {\n    return this.providedViewType !== \"unknown\" ? this.providedViewType : this.inferredViewType;\n  },\n\n  get streamType() {\n    return this.providedStreamType !== \"unknown\" ? this.providedStreamType : this.inferredStreamType;\n  },\n\n  get currentSrc() {\n    return this.source;\n  },\n\n  get bufferedStart() {\n    return getTimeRangesStart(this.buffered) ?? 0;\n  },\n\n  get bufferedEnd() {\n    return getTimeRangesEnd(this.buffered) ?? 0;\n  },\n\n  get seekableStart() {\n    return getTimeRangesStart(this.seekable) ?? 0;\n  },\n\n  get seekableEnd() {\n    return this.canPlay ? getTimeRangesEnd(this.seekable) ?? Infinity : 0;\n  },\n\n  get seekableWindow() {\n    return Math.max(0, this.seekableEnd - this.seekableStart);\n  },\n\n  // ~~ responsive design ~~\n  pointer: \"fine\",\n  orientation: \"landscape\",\n  width: 0,\n  height: 0,\n  mediaWidth: 0,\n  mediaHeight: 0,\n  // ~~ user props ~~\n  userBehindLiveEdge: false,\n  // ~~ live props ~~\n  liveEdgeTolerance: 10,\n  minLiveDVRWindow: 60,\n\n  get canSeek() {\n    return /unknown|on-demand|:dvr/.test(this.streamType) && Number.isFinite(this.seekableWindow) && (!this.live || /:dvr/.test(this.streamType) && this.seekableWindow >= this.minLiveDVRWindow);\n  },\n\n  get live() {\n    return this.streamType.includes(\"live\") || !Number.isFinite(this.duration);\n  },\n\n  get liveEdgeStart() {\n    return this.live && Number.isFinite(this.seekableEnd) ? Math.max(0, (this.liveSyncPosition ?? this.seekableEnd) - this.liveEdgeTolerance) : 0;\n  },\n\n  get liveEdge() {\n    return this.live && (!this.canSeek || !this.userBehindLiveEdge && this.currentTime >= this.liveEdgeStart);\n  },\n\n  get liveEdgeWindow() {\n    return this.live && Number.isFinite(this.seekableEnd) ? this.seekableEnd - this.liveEdgeStart : 0;\n  },\n\n  // ~~ internal props ~~\n  autoplaying: false,\n  inferredViewType: \"unknown\",\n  providedViewType: \"unknown\",\n  providedStreamType: \"unknown\",\n  inferredStreamType: \"unknown\",\n  liveSyncPosition: null\n});\nconst DO_NOT_RESET_ON_SRC_CHANGE = /* @__PURE__ */new Set([\"autoplay\", \"canFullscreen\", \"canLoad\", \"canPictureInPicture\", \"canSetVolume\", \"controls\", \"crossorigin\", \"fullscreen\", \"height\", \"logLevel\", \"loop\", \"mediaHeight\", \"mediaWidth\", \"mediaType\", \"muted\", \"orientation\", \"pictureInPicture\", \"playsinline\", \"pointer\", \"poster\", \"preload\", \"providedStreamType\", \"inferredViewType\", \"providedViewType\", \"source\", \"sources\", \"textTrack\", \"textTracks\", \"title\", \"volume\", \"width\"]);\n\nfunction softResetMediaState($media) {\n  mediaState.reset($media, prop => !DO_NOT_RESET_ON_SRC_CHANGE.has(prop));\n  tick();\n}\n\nconst mediaContext = createContext();\n\nfunction useMediaContext() {\n  return useContext(mediaContext);\n}\n\nclass MediaRemoteControl {\n  constructor(_logger = new Logger()) {\n    this._logger = _logger;\n    this._target = null;\n    this._player = null;\n    this._prevTrackIndex = -1;\n  }\n  /**\n   * Set the target from which to dispatch media requests events from. The events should bubble\n   * up from this target to the `<media-player>` element.\n   *\n   * @example\n   * ```ts\n   * const button = document.querySelector('button');\n   * remote.setTarget(button);\n   * ```\n   */\n\n\n  setTarget(target) {\n    this._target = target;\n    this._logger?.setTarget(target);\n  }\n  /**\n   * Returns the current `<media-player>` element. This method will attempt to find the player by\n   * searching up from either the given `target` or default target set via `remote.setTarget`.\n   *\n   * @example\n   * ```ts\n   * const player = remote.getPlayer();\n   * ```\n   */\n\n\n  getPlayer(target) {\n    if (this._player) return this._player;\n    (target ?? this._target)?.dispatchEvent(new DOMEvent(\"find-media-player\", {\n      detail: player => void (this._player = player),\n      bubbles: true,\n      composed: true\n    }));\n    return this._player;\n  }\n  /**\n   * Set the current `<media-player>` element so the remote can support toggle methods such as\n   * `togglePaused` as they rely on the current media state.\n   */\n\n\n  setPlayer(player) {\n    this._player = player;\n  }\n  /**\n   * Dispatch a request to start the media loading process. This will only work if the media\n   * player has been initialized with a custom loading strategy `<media-player load=\"custom\">`.\n   *\n   * @docs {@link https://www.vidstack.io/docs/player/core-concepts/loading#loading-strategies}\n   */\n\n\n  startLoading(trigger) {\n    this._dispatchRequest(\"media-start-loading\", trigger);\n  }\n  /**\n   * Dispatch a request to begin/resume media playback.\n   */\n\n\n  play(trigger) {\n    this._dispatchRequest(\"media-play-request\", trigger);\n  }\n  /**\n   * Dispatch a request to pause media playback.\n   */\n\n\n  pause(trigger) {\n    this._dispatchRequest(\"media-pause-request\", trigger);\n  }\n  /**\n   * Dispatch a request to set the media volume to mute (0).\n   */\n\n\n  mute(trigger) {\n    this._dispatchRequest(\"media-mute-request\", trigger);\n  }\n  /**\n   * Dispatch a request to unmute the media volume and set it back to it's previous state.\n   */\n\n\n  unmute(trigger) {\n    this._dispatchRequest(\"media-unmute-request\", trigger);\n  }\n  /**\n   * Dispatch a request to enter fullscreen.\n   *\n   * @docs {@link https://www.vidstack.io/docs/player/core-concepts/fullscreen#media-remote}\n   */\n\n\n  enterFullscreen(target, trigger) {\n    this._dispatchRequest(\"media-enter-fullscreen-request\", trigger, target);\n  }\n  /**\n   * Dispatch a request to exit fullscreen.\n   *\n   * @docs {@link https://www.vidstack.io/docs/player/core-concepts/fullscreen#media-remote}\n   */\n\n\n  exitFullscreen(target, trigger) {\n    this._dispatchRequest(\"media-exit-fullscreen-request\", trigger, target);\n  }\n  /**\n   * Dispatch a request to enter picture-in-picture mode.\n   *\n   * @docs {@link https://www.vidstack.io/docs/player/core-concepts/picture-in-picture#media-remote}\n   */\n\n\n  enterPictureInPicture(trigger) {\n    this._dispatchRequest(\"media-enter-pip-request\", trigger);\n  }\n  /**\n   * Dispatch a request to exit picture-in-picture mode.\n   *\n   * @docs {@link https://www.vidstack.io/docs/player/core-concepts/picture-in-picture#media-remote}\n   */\n\n\n  exitPictureInPicture(trigger) {\n    this._dispatchRequest(\"media-exit-pip-request\", trigger);\n  }\n  /**\n   * Notify the media player that a seeking process is happening and to seek to the given `time`.\n   */\n\n\n  seeking(time, trigger) {\n    this._dispatchRequest(\"media-seeking-request\", trigger, time);\n  }\n  /**\n   * Notify the media player that a seeking operation has completed and to seek to the given `time`.\n   * This is generally called after a series of `remote.seeking()` calls.\n   */\n\n\n  seek(time, trigger) {\n    this._dispatchRequest(\"media-seek-request\", trigger, time);\n  }\n\n  seekToLiveEdge(trigger) {\n    this._dispatchRequest(\"media-live-edge-request\", trigger);\n  }\n  /**\n   * Dispatch a request to update the media volume to the given `volume` level which is a value\n   * between 0 and 1.\n   *\n   * @example\n   * ```ts\n   * remote.changeVolume(0); // 0%\n   * remote.changeVolume(0.05); // 5%\n   * remote.changeVolume(0.5); // 50%\n   * remote.changeVolume(0.75); // 70%\n   * remote.changeVolume(1); // 100%\n   * ```\n   */\n\n\n  changeVolume(volume, trigger) {\n    this._dispatchRequest(\"media-volume-change-request\", trigger, Math.max(0, Math.min(1, volume)));\n  }\n  /**\n   * Dispatch a request to change the current audio track.\n   *\n   * @example\n   * ```ts\n   * remote.changeAudioTrack(1); // track at index 1\n   * ```\n   */\n\n\n  changeAudioTrack(index, trigger) {\n    this._dispatchRequest(\"media-audio-track-change-request\", trigger, index);\n  }\n  /**\n   * Dispatch a request to change the video quality. The special value `-1` represents auto quality\n   * selection.\n   *\n   * @example\n   * ```ts\n   * remote.changeQuality(-1); // auto\n   * remote.changeQuality(1); // quality at index 1\n   * ```\n   */\n\n\n  changeQuality(index, trigger) {\n    this._dispatchRequest(\"media-quality-change-request\", trigger, index);\n  }\n  /**\n   * Request auto quality selection.\n   */\n\n\n  requestAutoQuality(trigger) {\n    this.changeQuality(-1, trigger);\n  }\n  /**\n   * Dispatch a request to change the mode of the text track at the given index.\n   *\n   * @example\n   * ```ts\n   * remote.changeTextTrackMode(1, 'showing'); // track at index 1\n   * ```\n   */\n\n\n  changeTextTrackMode(index, mode, trigger) {\n    this._dispatchRequest(\"media-text-track-change-request\", trigger, {\n      index,\n      mode\n    });\n  }\n  /**\n   * Dispatch a request to change the media playback rate.\n   *\n   * @example\n   * ```ts\n   * remote.changePlaybackRate(0.5); // Half the normal speed\n   * remote.changePlaybackRate(1); // Normal speed\n   * remote.changePlaybackRate(1.5); // 50% faster than normal\n   * remote.changePlaybackRate(2); // Double the normal speed\n   * ```\n   */\n\n\n  changePlaybackRate(rate, trigger) {\n    this._dispatchRequest(\"media-rate-change-request\", trigger, rate);\n  }\n  /**\n   * Dispatch a request to resume idle tracking on controls. Refer to for more information.\n   */\n\n\n  resumeControls(trigger) {\n    this._dispatchRequest(\"media-resume-controls-request\", trigger);\n  }\n  /**\n   * Dispatch a request to pause controls idle tracking. Pausing tracking will result in the\n   * controls being visible until `remote.resumeControls()` is called. This method\n   * is generally used when building custom controls and you'd like to prevent the UI from\n   * disappearing.\n   *\n   * @example\n   * ```ts\n   * // Prevent controls hiding while menu is being interacted with.\n   * function onSettingsOpen() {\n   *   remote.pauseControls();\n   * }\n   *\n   * function onSettingsClose() {\n   *   remote.resumeControls();\n   * }\n   * ```\n   */\n\n\n  pauseControls(trigger) {\n    this._dispatchRequest(\"media-pause-controls-request\", trigger);\n  }\n  /**\n   * Dispatch a request to toggle the media playback state.\n   */\n\n\n  togglePaused(trigger) {\n    const player = this.getPlayer(trigger?.target);\n\n    if (!player) {\n      this._noPlayerWarning(this.togglePaused.name);\n\n      return;\n    }\n\n    if (player.state.paused) this.play(trigger);else this.pause(trigger);\n  }\n  /**\n   * Dispatch a request to toggle the controls visibility.\n   */\n\n\n  toggleControls(trigger) {\n    const player = this.getPlayer(trigger?.target);\n\n    if (!player) {\n      this._noPlayerWarning(this.toggleControls.name);\n\n      return;\n    }\n\n    if (!player.controls.showing) {\n      player.controls.show(0, trigger);\n    } else {\n      player.controls.hide(0, trigger);\n    }\n  }\n  /**\n   * Dispatch a request to toggle the media muted state.\n   */\n\n\n  toggleMuted(trigger) {\n    const player = this.getPlayer(trigger?.target);\n\n    if (!player) {\n      this._noPlayerWarning(this.toggleMuted.name);\n\n      return;\n    }\n\n    if (player.state.muted) this.unmute(trigger);else this.mute(trigger);\n  }\n  /**\n   * Dispatch a request to toggle the media fullscreen state.\n   *\n   * @docs {@link https://www.vidstack.io/docs/player/core-concepts/fullscreen#media-remote}\n   */\n\n\n  toggleFullscreen(target, trigger) {\n    const player = this.getPlayer(trigger?.target);\n\n    if (!player) {\n      this._noPlayerWarning(this.toggleFullscreen.name);\n\n      return;\n    }\n\n    if (player.state.fullscreen) this.exitFullscreen(target, trigger);else this.enterFullscreen(target, trigger);\n  }\n  /**\n   * Dispatch a request to toggle the media picture-in-picture mode.\n   *\n   * @docs {@link https://www.vidstack.io/docs/player/core-concepts/picture-in-picture#media-remote}\n   */\n\n\n  togglePictureInPicture(trigger) {\n    const player = this.getPlayer(trigger?.target);\n\n    if (!player) {\n      this._noPlayerWarning(this.togglePictureInPicture.name);\n\n      return;\n    }\n\n    if (player.state.pictureInPicture) this.exitPictureInPicture(trigger);else this.enterPictureInPicture(trigger);\n  }\n  /**\n   * Turn captions off.\n   */\n\n\n  disableCaptions(trigger) {\n    const player = this.getPlayer(trigger?.target);\n\n    if (!player) {\n      this._noPlayerWarning(this.disableCaptions.name);\n\n      return;\n    }\n\n    const tracks = player.state.textTracks,\n          track = player.state.textTrack;\n\n    if (track) {\n      const index = tracks.indexOf(track);\n      this.changeTextTrackMode(index, \"disabled\", trigger);\n    }\n  }\n  /**\n   * Dispatch a request to toggle the current captions mode.\n   */\n\n\n  toggleCaptions(trigger) {\n    const player = this.getPlayer(trigger?.target);\n\n    if (!player) {\n      this._noPlayerWarning(this.toggleCaptions.name);\n\n      return;\n    }\n\n    const tracks = player.state.textTracks,\n          track = player.state.textTrack;\n\n    if (track) {\n      const index = tracks.indexOf(track);\n      this.changeTextTrackMode(index, \"disabled\", trigger);\n      this._prevTrackIndex = index;\n    } else {\n      let index = this._prevTrackIndex;\n\n      if (!tracks[index] || !isTrackCaptionKind(tracks[index])) {\n        index = -1;\n      }\n\n      if (index === -1) {\n        index = tracks.findIndex(track2 => isTrackCaptionKind(track2) && track2.default);\n      }\n\n      if (index === -1) {\n        index = tracks.findIndex(track2 => isTrackCaptionKind(track2));\n      }\n\n      if (index >= 0) this.changeTextTrackMode(index, \"showing\", trigger);\n      this._prevTrackIndex = -1;\n    }\n  }\n\n  _dispatchRequest(type, trigger, detail) {\n    const request = new DOMEvent(type, {\n      bubbles: true,\n      composed: true,\n      detail,\n      trigger\n    });\n    let target = trigger?.target || null;\n    if (target && target instanceof Component) target = target.el;\n    const shouldUsePlayer = !target || target === document || target === window || target === document.body || this._player?.el && target instanceof Node && !this._player.el.contains(target);\n    target = shouldUsePlayer ? this._target ?? this.getPlayer()?.el : target ?? this._target;\n    {\n      this._logger?.debugGroup(`\\u{1F4E8} dispatching \\`${type}\\``).labelledLog(\"Target\", target).labelledLog(\"Player\", this._player).labelledLog(\"Request Event\", request).labelledLog(\"Trigger Event\", trigger).dispatch();\n    }\n\n    if (this._player) {\n      this._player.canPlayQueue._enqueue(type, () => target?.dispatchEvent(request));\n    } else {\n      target?.dispatchEvent(request);\n    }\n  }\n\n  _noPlayerWarning(method) {\n    {\n      console.warn(`[vidstack] attempted to call \\`MediaRemoteControl.${method}\\`() that requires player but failed because remote could not find a parent player element from target`);\n    }\n  }\n\n}\n\nclass MediaPlayerController extends ViewController {}\n\nclass MediaControls extends MediaPlayerController {\n  constructor() {\n    super(...arguments);\n    this._idleTimer = -2;\n    this._pausedTracking = false;\n    this._focusedItem = null;\n    /**\n     * The default amount of delay in milliseconds while media playback is progressing without user\n     * activity to indicate an idle state (i.e., hide controls).\n     *\n     * @defaultValue 2000\n     */\n\n    this.defaultDelay = 2e3;\n  }\n  /**\n   * Whether media controls are currently visible.\n   */\n\n\n  get showing() {\n    return this.$state.controlsVisible();\n  }\n  /**\n   * Show controls.\n   */\n\n\n  show(delay = 0, trigger) {\n    this._clearIdleTimer();\n\n    if (!this._pausedTracking) {\n      this._changeVisibility(true, delay, trigger);\n    }\n  }\n  /**\n   * Hide controls.\n   */\n\n\n  hide(delay = this.defaultDelay, trigger) {\n    this._clearIdleTimer();\n\n    if (!this._pausedTracking) {\n      this._changeVisibility(false, delay, trigger);\n    }\n  }\n  /**\n   * Whether all idle tracking on controls should be paused until resumed again.\n   */\n\n\n  pause(trigger) {\n    this._pausedTracking = true;\n\n    this._clearIdleTimer();\n\n    this._changeVisibility(true, 0, trigger);\n  }\n\n  resume(trigger) {\n    this._pausedTracking = false;\n    if (this.$state.paused()) return;\n\n    this._changeVisibility(false, this.defaultDelay, trigger);\n  }\n\n  onConnect() {\n    effect(this._watchPaused.bind(this));\n\n    const onPlay = this._onPlay.bind(this),\n          onPause = this._onPause.bind(this);\n\n    this.listen(\"can-play\", event => this.show(0, event));\n    this.listen(\"play\", onPlay);\n    this.listen(\"pause\", onPause);\n    this.listen(\"autoplay-fail\", onPause);\n  }\n\n  _watchPaused() {\n    const {\n      paused,\n      started,\n      autoplayError\n    } = this.$state;\n    if (paused() || autoplayError() && !started()) return;\n\n    const onStopIdle = this._onStopIdle.bind(this);\n\n    for (const eventType of [\"pointerup\", \"keydown\"]) {\n      listenEvent(this.el, eventType, onStopIdle);\n    }\n\n    effect(() => {\n      if (this.$state.pointer() === \"fine\") {\n        listenEvent(this.el, \"pointermove\", onStopIdle);\n      }\n    });\n  }\n\n  _onPlay(event) {\n    this.show(0, event);\n    this.hide(this.defaultDelay, event);\n  }\n\n  _onPause(event) {\n    this.show(0, event);\n  }\n\n  _clearIdleTimer() {\n    window.clearTimeout(this._idleTimer);\n    this._idleTimer = -1;\n  }\n\n  _onStopIdle(event) {\n    if (event.MEDIA_GESTURE || this._pausedTracking) return;\n\n    if (isKeyboardEvent(event)) {\n      if (event.key === \"Escape\") {\n        this.el?.focus();\n        this._focusedItem = null;\n      } else if (this._focusedItem) {\n        event.preventDefault();\n        requestAnimationFrame(() => {\n          this._focusedItem?.focus();\n          this._focusedItem = null;\n        });\n      }\n    }\n\n    this.show(0, event);\n    this.hide(this.defaultDelay, event);\n  }\n\n  _changeVisibility(visible, delay, trigger) {\n    if (delay === 0) {\n      this._onChange(visible, trigger);\n\n      return;\n    }\n\n    this._idleTimer = window.setTimeout(() => {\n      if (!this.scope) return;\n\n      this._onChange(visible && !this._pausedTracking, trigger);\n    }, delay);\n  }\n\n  _onChange(visible, trigger) {\n    if (this.$state.controlsVisible() === visible) return;\n    this.$state.controlsVisible.set(visible);\n\n    if (!visible && document.activeElement && this.el?.contains(document.activeElement)) {\n      this._focusedItem = document.activeElement;\n      requestAnimationFrame(() => this.el?.focus());\n    }\n\n    this.dispatch(\"controls-change\", {\n      detail: visible,\n      trigger\n    });\n  }\n\n}\n\nclass NativeTextRenderer {\n  constructor() {\n    this.priority = 0;\n    this._display = true;\n    this._video = null;\n    this._track = null;\n    this._tracks = /* @__PURE__ */new Set();\n  }\n\n  canRender() {\n    return true;\n  }\n\n  attach(video) {\n    this._video = video;\n    video.textTracks.onchange = this._onChange.bind(this);\n  }\n\n  addTrack(track) {\n    this._tracks.add(track);\n\n    this._attachTrack(track);\n  }\n\n  removeTrack(track) {\n    track[TextTrackSymbol._native]?.remove?.();\n    track[TextTrackSymbol._native] = null;\n\n    this._tracks.delete(track);\n  }\n\n  changeTrack(track) {\n    const current = track?.[TextTrackSymbol._native];\n\n    if (current && current.track.mode !== \"showing\") {\n      current.track.mode = \"showing\";\n    }\n\n    this._track = track;\n  }\n\n  setDisplay(display) {\n    this._display = display;\n\n    this._onChange();\n  }\n\n  detach() {\n    if (this._video) this._video.textTracks.onchange = null;\n\n    for (const track of this._tracks) this.removeTrack(track);\n\n    this._tracks.clear();\n\n    this._video = null;\n    this._track = null;\n  }\n\n  _attachTrack(track) {\n    if (!this._video) return;\n\n    const el = track[TextTrackSymbol._native] ??= this._createTrackElement(track);\n\n    if (el instanceof HTMLElement) {\n      this._video.append(el);\n\n      el.track.mode = el.default ? \"showing\" : \"hidden\";\n    }\n  }\n\n  _createTrackElement(track) {\n    const el = document.createElement(\"track\"),\n          isDefault = track.default || track.mode === \"showing\",\n          isSupported = track.src && track.type === \"vtt\";\n    el.id = track.id;\n    el.src = isSupported ? track.src : \"https://cdn.jsdelivr.net/npm/vidstack@next/empty.vtt\";\n    el.label = track.label;\n    el.kind = track.kind;\n    el.default = isDefault;\n    track.language && (el.srclang = track.language);\n\n    if (isDefault && !isSupported) {\n      this._copyCues(track, el.track);\n    }\n\n    return el;\n  }\n\n  _copyCues(track, native) {\n    if (track.src && track.type === \"vtt\" || native.cues?.length) return;\n\n    for (const cue of track.cues) native.addCue(cue);\n  }\n\n  _onChange(event) {\n    for (const track of this._tracks) {\n      const nativeTrack = track[TextTrackSymbol._native]?.track;\n      if (!nativeTrack) continue;\n\n      if (!this._display) {\n        nativeTrack.mode = \"disabled\";\n        continue;\n      }\n\n      const isShowing = nativeTrack.mode === \"showing\";\n      if (isShowing) this._copyCues(track, nativeTrack);\n      track.setMode(isShowing ? \"showing\" : \"disabled\", event);\n    }\n  }\n\n}\n\nclass TextRenderers {\n  constructor(_media) {\n    this._media = _media;\n    this._video = null;\n    this._renderers = [];\n    this._nativeDisplay = false;\n    this._nativeRenderer = null;\n    this._customRenderer = null;\n    const textTracks = _media.textTracks;\n    this._textTracks = textTracks;\n    effect(this._watchControls.bind(this));\n    onDispose(this._detach.bind(this));\n    listenEvent(textTracks, \"add\", this._onAddTrack.bind(this));\n    listenEvent(textTracks, \"remove\", this._onRemoveTrack.bind(this));\n    listenEvent(textTracks, \"mode-change\", this._update.bind(this));\n  }\n\n  _watchControls() {\n    const {\n      $state,\n      $iosControls\n    } = this._media;\n    this._nativeDisplay = $state.controls() || $iosControls();\n\n    this._update();\n  }\n\n  add(renderer) {\n    this._renderers.push(renderer);\n\n    this._update();\n  }\n\n  remove(renderer) {\n    renderer.detach();\n\n    this._renderers.splice(this._renderers.indexOf(renderer), 1);\n\n    this._update();\n  }\n  /* @internal */\n\n\n  _attachVideo(video) {\n    requestAnimationFrame(() => {\n      this._video = video;\n\n      if (video) {\n        this._nativeRenderer = new NativeTextRenderer();\n\n        this._nativeRenderer.attach(video);\n\n        for (const track of this._textTracks) this._addNativeTrack(track);\n      }\n\n      this._update();\n    });\n  }\n\n  _addNativeTrack(track) {\n    if (!isTrackCaptionKind(track)) return;\n    this._nativeRenderer?.addTrack(track);\n  }\n\n  _removeNativeTrack(track) {\n    if (!isTrackCaptionKind(track)) return;\n    this._nativeRenderer?.removeTrack(track);\n  }\n\n  _onAddTrack(event) {\n    this._addNativeTrack(event.detail);\n  }\n\n  _onRemoveTrack(event) {\n    this._removeNativeTrack(event.detail);\n  }\n\n  _update() {\n    if (!this._video) {\n      this._detach();\n\n      return;\n    }\n\n    const currentTrack = this._textTracks.selected;\n\n    if (this._nativeDisplay || currentTrack?.[TextTrackSymbol._nativeHLS]) {\n      this._customRenderer?.changeTrack(null);\n\n      this._nativeRenderer.setDisplay(true);\n\n      this._nativeRenderer.changeTrack(currentTrack);\n\n      return;\n    }\n\n    this._nativeRenderer.setDisplay(false);\n\n    this._nativeRenderer.changeTrack(null);\n\n    if (!currentTrack) {\n      this._customRenderer?.changeTrack(null);\n      return;\n    }\n\n    const customRenderer = this._renderers.sort((a, b) => a.priority - b.priority).find(loader => loader.canRender(currentTrack));\n\n    if (this._customRenderer !== customRenderer) {\n      this._customRenderer?.detach();\n      customRenderer?.attach(this._video);\n      this._customRenderer = customRenderer ?? null;\n    }\n\n    customRenderer?.changeTrack(currentTrack);\n  }\n\n  _detach() {\n    this._nativeRenderer?.detach();\n    this._nativeRenderer = null;\n    this._customRenderer?.detach();\n    this._customRenderer = null;\n  }\n\n}\n\nclass TextTrackList extends List {\n  constructor() {\n    super(...arguments);\n    this._canLoad = false;\n    this._defaults = {};\n    this._onTrackModeChangeBind = this._onTrackModeChange.bind(this);\n  }\n\n  get selected() {\n    const track = this._items.find(t => t.mode === \"showing\" && isTrackCaptionKind(t));\n\n    return track ?? null;\n  }\n\n  add(init, trigger) {\n    const isTrack = init instanceof TextTrack,\n          track = isTrack ? init : new TextTrack(init);\n    if (this._defaults[init.kind] && init.default) delete init.default;\n    track.addEventListener(\"mode-change\", this._onTrackModeChangeBind);\n\n    this[ListSymbol._add](track, trigger);\n\n    track[TextTrackSymbol._crossorigin] = this[TextTrackSymbol._crossorigin];\n    if (this._canLoad) track[TextTrackSymbol._canLoad]();\n\n    if (init.default) {\n      this._defaults[init.kind] = track;\n      track.mode = \"showing\";\n    }\n\n    return this;\n  }\n\n  remove(track, trigger) {\n    if (!this._items.includes(track)) return;\n    if (track === this._defaults[track.kind]) delete this._defaults[track.kind];\n    track.mode = \"disabled\";\n    track[TextTrackSymbol._onModeChange] = null;\n    track.removeEventListener(\"mode-change\", this._onTrackModeChangeBind);\n\n    this[ListSymbol._remove](track, trigger);\n\n    return this;\n  }\n\n  clear(trigger) {\n    for (const track of this._items) this.remove(track, trigger);\n\n    return this;\n  }\n\n  getById(id) {\n    return this._items.find(track => track.id === id) ?? null;\n  }\n\n  getByKind(kind) {\n    const kinds = Array.isArray(kind) ? kind : [kind];\n    return this._items.filter(track => kinds.includes(track.kind));\n  }\n  /* @internal */\n\n\n  [TextTrackSymbol._canLoad]() {\n    if (this._canLoad) return;\n\n    for (const track of this._items) track[TextTrackSymbol._canLoad]();\n\n    this._canLoad = true;\n  }\n\n  _onTrackModeChange(event) {\n    const track = event.detail;\n\n    if (track.mode === \"showing\") {\n      const kinds = isTrackCaptionKind(track) ? [\"captions\", \"subtitles\"] : [track.kind];\n\n      for (const t of this._items) {\n        if (t.mode === \"showing\" && t != track && kinds.includes(t.kind)) {\n          t.mode = \"disabled\";\n        }\n      }\n    }\n\n    this.dispatchEvent(new DOMEvent(\"mode-change\", {\n      detail: event.detail,\n      trigger: event\n    }));\n  }\n\n}\n\nconst SELECTED = Symbol(\"SELECTED\");\n\nclass SelectList extends List {\n  get selected() {\n    return this._items.find(item => item.selected) ?? null;\n  }\n\n  get selectedIndex() {\n    return this._items.findIndex(item => item.selected);\n  }\n  /* @internal */\n\n\n  [ListSymbol._onRemove](item, trigger) {\n    this[ListSymbol._select](item, false, trigger);\n  }\n  /* @internal */\n\n\n  [ListSymbol._add](item, trigger) {\n    item[SELECTED] = false;\n    Object.defineProperty(item, \"selected\", {\n      get() {\n        return this[SELECTED];\n      },\n\n      set: selected => {\n        if (this.readonly) return;\n        this[ListSymbol._onUserSelect]?.();\n\n        this[ListSymbol._select](item, selected);\n      }\n    });\n\n    super[ListSymbol._add](item, trigger);\n  }\n  /* @internal */\n\n\n  [ListSymbol._select](item, selected, trigger) {\n    if (selected === item[SELECTED]) return;\n    const prev = this.selected;\n    item[SELECTED] = selected;\n    const changed = !selected ? prev === item : prev !== item;\n\n    if (changed) {\n      if (prev) prev[SELECTED] = false;\n      this.dispatchEvent(new DOMEvent(\"change\", {\n        detail: {\n          prev,\n          current: this.selected\n        },\n        trigger\n      }));\n    }\n  }\n\n}\n\nclass AudioTrackList extends SelectList {\n  getById(id) {\n    if (id === \"\") return null;\n    return this._items.find(track => track.id === id) ?? null;\n  }\n\n}\n\nconst globalEval = eval;\nconst equalsRE = /:\\s+'?\"?(.*?)'?\"?\\)/g,\n      notRE = /\\s+not\\s+/g,\n      andRE = /\\s+and\\s+/g,\n      orRE = /\\s+or\\s+/g,\n      pxRE = /(\\d)px/g;\n\nclass PlayerQueryList extends EventsTarget {\n  constructor(store, query) {\n    super();\n    this._evaluation = signal(\"true\");\n    this._mediaProps = /* @__PURE__ */new Set();\n    this._mediaMatches = signal(true);\n    this.$matches = computed(() => {\n      let currentEval = this._evaluation();\n\n      if (currentEval === \"never\") return false;\n\n      for (const prop of this._mediaProps) {\n        const value = this._mediaStore[prop](),\n              replaceValue = isString(value) ? `'${value}'` : value + \"\";\n\n        currentEval = currentEval.replace(camelToKebabCase(prop), replaceValue);\n      }\n\n      return globalEval(`!!(${currentEval})`) && this._mediaMatches();\n    });\n    this._query = query;\n    this._mediaStore = store;\n    root(dispose => {\n      effect(this._watchQuery.bind(this));\n      effect(this._watchMatches.bind(this));\n      this._dispose = dispose;\n    });\n  }\n\n  get query() {\n    return unwrap(this._query);\n  }\n\n  get matches() {\n    return this.$matches();\n  }\n\n  _watchQuery() {\n    const query = this.query;\n    if (query === \"\") return;\n\n    if (query === \"never\") {\n      this._evaluation.set(query);\n\n      return;\n    }\n\n    const queryList = query.trim().split(/\\s*,\\s*/g),\n          mediaQueries = queryList.filter(q => q.startsWith(\"@media\")).join(\",\"),\n          playerQueries = queryList.filter(q => !q.startsWith(\"@media\"));\n\n    if (mediaQueries.length) {\n      const mediaQuery = window.matchMedia(mediaQueries),\n            onChange = () => void this._mediaMatches.set(mediaQuery.matches);\n\n      onChange();\n      listenEvent(mediaQuery, \"change\", onChange);\n    }\n\n    if (playerQueries.length) {\n      const evaluation = this._buildQueryEval(playerQueries),\n            validProps = Object.keys(mediaState.record);\n\n      for (const query2 of evaluation.matchAll(/\\(([-a-zA-Z]+)\\s/g)) {\n        const prop = kebabToCamelCase(query2[1]);\n\n        if (validProps.includes(prop)) {\n          this._mediaProps.add(prop);\n        }\n      }\n\n      this._evaluation.set(evaluation);\n    }\n\n    return () => {\n      this._mediaProps.clear();\n\n      this._evaluation.set(\"true\");\n\n      this._mediaMatches.set(true);\n    };\n  }\n\n  _watchMatches() {\n    this.$matches();\n    this.dispatchEvent(new Event(\"change\"));\n  }\n\n  _buildQueryEval(queryList) {\n    return queryList.map(query => \"(\" + query.replace(equalsRE, ' == \"$1\")').replace(notRE, \"!\").replace(andRE, \" && \").replace(orRE, \" || \").replace(pxRE, \"$1\").trim() + \")\").join(\" || \");\n  }\n\n  destroy() {\n    this._dispose();\n  }\n\n}\n\nPlayerQueryList.create = query => {\n  const media = useMediaContext();\n  return new PlayerQueryList(media.$state, query);\n};\n\nclass VideoQualityList extends SelectList {\n  constructor() {\n    super(...arguments);\n    this._auto = false;\n    /**\n     * Configures quality switching:\n     *\n     * - `current`: Trigger an immediate quality level switch. This will abort the current fragment\n     * request if any, flush the whole buffer, and fetch fragment matching with current position\n     * and requested quality level.\n     *\n     * - `next`: Trigger a quality level switch for next fragment. This could eventually flush\n     * already buffered next fragment.\n     *\n     * - `load`: Set quality level for next loaded fragment.\n     *\n     * @see {@link https://vidstack.io/docs/player/core-concepts/quality#switch}\n     * @see {@link https://github.com/video-dev/hls.js/blob/master/docs/API.md#quality-switch-control-api}\n     */\n\n    this.switch = \"current\";\n  }\n  /**\n   * Whether automatic quality selection is enabled.\n   */\n\n\n  get auto() {\n    return this._auto || this.readonly;\n  }\n  /* @internal */\n\n\n  [ListSymbol._onUserSelect]() {\n    this[QualitySymbol._setAuto](false);\n  }\n  /* @internal */\n\n\n  [ListSymbol._onReset](trigger) {\n    this[QualitySymbol._setAuto](false, trigger);\n  }\n  /**\n   * Request automatic quality selection (if supported). This will be a no-op if the list is\n   * `readonly` as that already implies auto-selection.\n   */\n\n\n  autoSelect(trigger) {\n    if (this.readonly || this._auto || !this[QualitySymbol._enableAuto]) return;\n    this[QualitySymbol._enableAuto]?.();\n\n    this[QualitySymbol._setAuto](true, trigger);\n  }\n  /* @internal */\n\n\n  [QualitySymbol._setAuto](auto, trigger) {\n    if (this._auto === auto) return;\n    this._auto = auto;\n    this.dispatchEvent(new DOMEvent(\"auto-change\", {\n      detail: auto,\n      trigger\n    }));\n  }\n\n}\n\nfunction isAudioProvider(provider) {\n  return provider?.$$PROVIDER_TYPE === \"AUDIO\";\n}\n\nfunction isVideoProvider(provider) {\n  return provider?.$$PROVIDER_TYPE === \"VIDEO\";\n}\n\nfunction isHLSProvider(provider) {\n  return provider?.$$PROVIDER_TYPE === \"HLS\";\n}\n\nfunction isHTMLAudioElement(element) {\n  return element instanceof HTMLAudioElement;\n}\n\nfunction isHTMLVideoElement(element) {\n  return element instanceof HTMLVideoElement;\n}\n\nfunction isHTMLMediaElement(element) {\n  return isHTMLAudioElement(element) || isHTMLVideoElement(element);\n}\n\nconst MEDIA_KEY_SHORTCUTS = {\n  togglePaused: \"k Space\",\n  toggleMuted: \"m\",\n  toggleFullscreen: \"f\",\n  togglePictureInPicture: \"i\",\n  toggleCaptions: \"c\",\n  seekBackward: \"j J ArrowLeft\",\n  seekForward: \"l L ArrowRight\",\n  volumeUp: \"ArrowUp\",\n  volumeDown: \"ArrowDown\",\n  speedUp: \">\",\n  slowDown: \"<\"\n};\nconst MODIFIER_KEYS = /* @__PURE__ */new Set([\"Shift\", \"Alt\", \"Meta\", \"Control\"]),\n      BUTTON_SELECTORS = 'button, [role=\"button\"]',\n      IGNORE_SELECTORS = 'input, textarea, select, [contenteditable], [role^=\"menuitem\"]';\n\nclass MediaKeyboardController extends MediaPlayerController {\n  constructor(_media) {\n    super();\n    this._media = _media;\n    this._timeSlider = null;\n  }\n\n  onConnect() {\n    effect(this._onTargetChange.bind(this));\n  }\n\n  _onTargetChange() {\n    const {\n      keyDisabled,\n      keyTarget\n    } = this.$props;\n    if (keyDisabled()) return;\n    const target = keyTarget() === \"player\" ? this.el : document,\n          $active = signal(false);\n\n    if (target === this.el) {\n      this.listen(\"focusin\", () => $active.set(true));\n      this.listen(\"focusout\", event => {\n        if (!this.el.contains(event.target)) $active.set(false);\n      });\n    } else {\n      if (!peek($active)) $active.set(document.querySelector(\"[data-media-player]\") === this.el);\n      listenEvent(document, \"focusin\", event => {\n        const activePlayer = event.composedPath().find(el => el instanceof Element && el.localName === \"media-player\");\n        if (activePlayer !== void 0) $active.set(this.el === activePlayer);\n      });\n    }\n\n    effect(() => {\n      if (!$active()) return;\n      listenEvent(target, \"keyup\", this._onKeyUp.bind(this));\n      listenEvent(target, \"keydown\", this._onKeyDown.bind(this));\n      listenEvent(target, \"keydown\", this._onPreventVideoKeys.bind(this), {\n        capture: true\n      });\n    });\n  }\n\n  _onKeyUp(event) {\n    const focusedEl = document.activeElement;\n\n    if (!event.key || !this.$state.canSeek() || focusedEl?.matches(IGNORE_SELECTORS)) {\n      return;\n    }\n\n    let {\n      method,\n      value\n    } = this._getMatchingMethod(event);\n\n    if (!isString(value) && !isArray(value)) {\n      value?.callback(event);\n      return;\n    }\n\n    if (method?.startsWith(\"seek\")) {\n      event.preventDefault();\n      event.stopPropagation();\n\n      if (this._timeSlider) {\n        this._forwardTimeKeyboardEvent(event, method === \"seekForward\");\n\n        this._timeSlider = null;\n      } else {\n        this._media.remote.seek(this._seekTotal, event);\n\n        this._seekTotal = void 0;\n      }\n    }\n\n    if (method?.startsWith(\"volume\")) {\n      const volumeSlider = this.el.querySelector(\"[data-media-volume-slider]\");\n      volumeSlider?.dispatchEvent(new KeyboardEvent(\"keyup\", {\n        key: method === \"volumeUp\" ? \"Up\" : \"Down\",\n        shiftKey: event.shiftKey,\n        trigger: event\n      }));\n    }\n  }\n\n  _onKeyDown(event) {\n    if (!event.key || MODIFIER_KEYS.has(event.key)) return;\n    const focusedEl = document.activeElement;\n\n    if (focusedEl?.matches(IGNORE_SELECTORS) || isKeyboardClick(event) && focusedEl?.matches(BUTTON_SELECTORS)) {\n      return;\n    }\n\n    let {\n      method,\n      value\n    } = this._getMatchingMethod(event);\n\n    if (!isString(value) && !isArray(value)) {\n      value?.callback(event);\n      return;\n    }\n\n    if (!method && !event.metaKey && /[0-9]/.test(event.key)) {\n      event.preventDefault();\n      event.stopPropagation();\n\n      this._media.remote.seek(this.$state.duration() / 10 * Number(event.key), event);\n\n      return;\n    }\n\n    if (!method) return;\n    event.preventDefault();\n    event.stopPropagation();\n\n    switch (method) {\n      case \"seekForward\":\n      case \"seekBackward\":\n        this._seeking(event, method, method === \"seekForward\");\n\n        break;\n\n      case \"volumeUp\":\n      case \"volumeDown\":\n        const volumeSlider = this.el.querySelector(\"[data-media-volume-slider]\");\n\n        if (volumeSlider) {\n          volumeSlider.dispatchEvent(new KeyboardEvent(\"keydown\", {\n            key: method === \"volumeUp\" ? \"Up\" : \"Down\",\n            shiftKey: event.shiftKey,\n            trigger: event\n          }));\n        } else {\n          const value2 = event.shiftKey ? 0.1 : 0.05;\n\n          this._media.remote.changeVolume(this.$state.volume() + (method === \"volumeUp\" ? +value2 : -value2), event);\n        }\n\n        break;\n\n      case \"toggleFullscreen\":\n        this._media.remote.toggleFullscreen(\"prefer-media\", event);\n\n        break;\n\n      case \"speedUp\":\n      case \"slowDown\":\n        const playbackRate = this.$state.playbackRate();\n\n        this._media.remote.changePlaybackRate(Math.max(0.25, Math.min(2, playbackRate + (method === \"speedUp\" ? 0.25 : -0.25))), event);\n\n        break;\n\n      default:\n        this._media.remote[method]?.(event);\n    }\n  }\n\n  _onPreventVideoKeys(event) {\n    if (isHTMLMediaElement(event.target) && this._getMatchingMethod(event).method) {\n      event.preventDefault();\n    }\n  }\n\n  _getMatchingMethod(event) {\n    const keyShortcuts = { ...this.$props.keyShortcuts(),\n      ...this._media.ariaKeys\n    };\n    const method = Object.keys(keyShortcuts).find(method2 => {\n      const value = keyShortcuts[method2],\n            keys = isArray(value) ? value.join(\" \") : isString(value) ? value : value?.keys;\n      return (isArray(keys) ? keys : keys?.split(\" \"))?.some(keys2 => {\n        return replaceSymbolKeys(keys2).replace(/Control/g, \"Ctrl\").split(\"+\").every(key => MODIFIER_KEYS.has(key) ? event[key.toLowerCase() + \"Key\"] : event.key === key.replace(\"Space\", \" \"));\n      });\n    });\n    return {\n      method,\n      value: method ? keyShortcuts[method] : null\n    };\n  }\n\n  _calcSeekAmount(event, type) {\n    const seekBy = event.shiftKey ? 10 : 5;\n    return this._seekTotal = Math.max(0, Math.min((this._seekTotal ?? this.$state.currentTime()) + (type === \"seekForward\" ? +seekBy : -seekBy), this.$state.duration()));\n  }\n\n  _forwardTimeKeyboardEvent(event, forward) {\n    this._timeSlider?.dispatchEvent(new KeyboardEvent(event.type, {\n      key: !forward ? \"Left\" : \"Right\",\n      shiftKey: event.shiftKey,\n      trigger: event\n    }));\n  }\n\n  _seeking(event, type, forward) {\n    if (!this.$state.canSeek()) return;\n    if (!this._timeSlider) this._timeSlider = this.el.querySelector(\"[data-media-time-slider]\");\n\n    if (this._timeSlider) {\n      this._forwardTimeKeyboardEvent(event, forward);\n    } else {\n      this._media.remote.seeking(this._calcSeekAmount(event, type), event);\n    }\n  }\n\n}\n\nconst SYMBOL_KEY_MAP = [\"!\", \"@\", \"#\", \"$\", \"%\", \"^\", \"&\", \"*\", \"(\", \")\"];\n\nfunction replaceSymbolKeys(key) {\n  return key.replace(/Shift\\+(\\d)/g, (_, num) => SYMBOL_KEY_MAP[num - 1]);\n}\n\nclass ARIAKeyShortcuts extends ViewController {\n  constructor(_shortcut) {\n    super();\n    this._shortcut = _shortcut;\n  }\n\n  onAttach(el) {\n    const {\n      $props,\n      ariaKeys\n    } = useMediaContext(),\n          keys = el.getAttribute(\"aria-keyshortcuts\");\n\n    if (keys) {\n      ariaKeys[this._shortcut] = keys;\n      {\n        onDispose(() => {\n          delete ariaKeys[this._shortcut];\n        });\n      }\n      return;\n    }\n\n    const shortcuts = $props.keyShortcuts()[this._shortcut];\n\n    if (shortcuts) {\n      const keys2 = isArray(shortcuts) ? shortcuts.join(\" \") : isString(shortcuts) ? shortcuts : shortcuts?.keys;\n      el.setAttribute(\"aria-keyshortcuts\", isArray(keys2) ? keys2.join(\" \") : keys2);\n    }\n  }\n\n}\n\nclass AudioProviderLoader {\n  canPlay({\n    src,\n    type\n  }) {\n    return isString(src) ? AUDIO_EXTENSIONS.test(src) || AUDIO_TYPES.has(type) || src.startsWith(\"blob:\") && type === \"audio/object\" : type === \"audio/object\";\n  }\n\n  mediaType() {\n    return \"audio\";\n  }\n\n  async load() {\n    if (!this.target) {\n      throw Error(\"[vidstack] `<audio>` element was not found - did you forget to include `<media-provider>`?\");\n    }\n\n    return new (await import('../providers/vidstack-audio.js')).AudioProvider(this.target);\n  }\n\n}\n\nclass VideoProviderLoader {\n  canPlay(src) {\n    return isString(src.src) ? VIDEO_EXTENSIONS.test(src.src) || VIDEO_TYPES.has(src.type) || src.src.startsWith(\"blob:\") && src.type === \"video/object\" || isHLSSrc(src) && canPlayHLSNatively() : src.type === \"video/object\";\n  }\n\n  mediaType() {\n    return \"video\";\n  }\n\n  async load(context) {\n    if (!this.target) {\n      throw Error(\"[vidstack] `<video>` element was not found - did you forget to include media provider?\");\n    }\n\n    return new (await import('../providers/vidstack-video.js')).VideoProvider(this.target, context);\n  }\n\n}\n\nclass HLSProviderLoader extends VideoProviderLoader {\n  preconnect() {\n    preconnect(\"https://cdn.jsdelivr.net\", \"preconnect\");\n  }\n\n  canPlay(src) {\n    return HLSProviderLoader.supported && isHLSSrc(src);\n  }\n\n  async load(context) {\n    if (!this.target) {\n      throw Error(\"[vidstack] `<video>` element was not found - did you forget to include `<media-provider>`?\");\n    }\n\n    return new (await import('../providers/vidstack-hls.js')).HLSProvider(this.target, context);\n  }\n\n}\n\nHLSProviderLoader.supported = isHLSSupported();\nconst MEDIA_ATTRIBUTES = Symbol(\"MEDIA_ATTRIBUTES\");\nconst mediaAttributes = [\"autoplay\", \"autoplayError\", \"canFullscreen\", \"canPictureInPicture\", \"canLoad\", \"canPlay\", \"canSeek\", \"ended\", \"fullscreen\", \"loop\", \"live\", \"liveEdge\", \"mediaType\", \"muted\", \"paused\", \"pictureInPicture\", \"playing\", \"playsinline\", \"seeking\", \"started\", \"streamType\", \"viewType\", \"waiting\"];\nconst mediaPlayerProps = {\n  autoplay: false,\n  controls: false,\n  currentTime: 0,\n  crossorigin: null,\n  fullscreenOrientation: \"landscape\",\n  load: \"visible\",\n  logLevel: \"warn\",\n  loop: false,\n  muted: false,\n  paused: true,\n  playsinline: false,\n  playbackRate: 1,\n  poster: \"\",\n  preload: \"metadata\",\n  preferNativeHLS: false,\n  src: \"\",\n  controlsDelay: 2e3,\n  viewType: \"unknown\",\n  streamType: \"unknown\",\n  volume: 1,\n  liveEdgeTolerance: 10,\n  minLiveDVRWindow: 60,\n  keyDisabled: false,\n  keyTarget: \"player\",\n  keyShortcuts: MEDIA_KEY_SHORTCUTS,\n  title: \"\"\n};\nconst MEDIA_EVENTS = [\"abort\", \"can-play\", \"can-play-through\", \"duration-change\", \"emptied\", \"ended\", \"error\", \"fullscreen-change\", \"loaded-data\", \"loaded-metadata\", \"load-start\", \"media-type-change\", \"pause\", \"play\", \"playing\", \"progress\", \"seeked\", \"seeking\", \"source-change\", \"sources-change\", \"stalled\", \"started\", \"suspend\", \"stream-type-change\", \"replay\", // 'time-update',\n\"view-type-change\", \"volume-change\", \"waiting\"];\n\nclass MediaEventsLogger extends MediaPlayerController {\n  constructor(_media) {\n    super();\n    this._media = _media;\n  }\n\n  onConnect() {\n    const handler = this._onMediaEvent.bind(this);\n\n    for (const eventType of MEDIA_EVENTS) this.listen(eventType, handler);\n  }\n\n  _onMediaEvent(event) {\n    this._media.logger?.debugGroup(`\\u{1F4E1} dispatching \\`${event.type}\\``).labelledLog(\"Media Store\", { ...this.$state\n    }).labelledLog(\"Event\", event).dispatch();\n  }\n\n}\n\nclass MediaLoadController extends MediaPlayerController {\n  constructor(_callback) {\n    super();\n    this._callback = _callback;\n  }\n\n  async onAttach(el) {\n    const load = this.$props.load();\n\n    if (load === \"eager\") {\n      requestAnimationFrame(this._callback);\n    } else if (load === \"idle\") {\n      waitIdlePeriod(this._callback);\n    } else if (load === \"visible\") {\n      const observer = new IntersectionObserver(entries => {\n        if (!this.scope) return;\n\n        if (entries[0].isIntersecting) {\n          observer.disconnect();\n\n          this._callback();\n        }\n      });\n      observer.observe(el);\n      return observer.disconnect.bind(observer);\n    }\n  }\n\n}\n\nlet seenAutoplayWarning = false;\n\nclass MediaPlayerDelegate {\n  constructor(_handle, _media) {\n    this._handle = _handle;\n    this._media = _media;\n  }\n\n  _dispatch(type, ...init) {\n    this._handle(new DOMEvent(type, init?.[0]));\n  }\n\n  async _ready(info, trigger) {\n    const {\n      $state,\n      logger\n    } = this._media;\n    if (peek($state.canPlay)) return;\n\n    this._dispatch(\"can-play\", {\n      detail: info,\n      trigger\n    });\n\n    tick();\n    {\n      logger?.infoGroup(\"-~-~-~-~-~-~- \\u2705 MEDIA READY -~-~-~-~-~-~-\").labelledLog(\"Media Store\", { ...$state\n      }).labelledLog(\"Trigger Event\", trigger).dispatch();\n    }\n\n    if ($state.canPlay() && $state.autoplay() && !$state.started()) {\n      await this._attemptAutoplay();\n    }\n  }\n\n  async _attemptAutoplay() {\n    const {\n      player,\n      $state\n    } = this._media;\n    $state.autoplaying.set(true);\n\n    try {\n      await player.play();\n\n      this._dispatch(\"autoplay\", {\n        detail: {\n          muted: $state.muted()\n        }\n      });\n    } catch (error) {\n      if (!seenAutoplayWarning) {\n        const muteMsg = !$state.muted() ? \" Attempting with volume muted will most likely resolve the issue.\" : \"\";\n        this._media.logger?.errorGroup(\"autoplay request failed\").labelledLog(\"Message\", `Autoplay was requested but failed most likely due to browser autoplay policies.${muteMsg}`).labelledLog(\"Error\", error).labelledLog(\"See\", \"https://developer.chrome.com/blog/autoplay\").dispatch();\n        seenAutoplayWarning = true;\n      }\n\n      this._dispatch(\"autoplay-fail\", {\n        detail: {\n          muted: $state.muted(),\n          error\n        }\n      });\n    } finally {\n      $state.autoplaying.set(false);\n    }\n  }\n\n}\n\nclass Queue {\n  constructor() {\n    this._queue = /* @__PURE__ */new Map();\n  }\n  /**\n   * Queue the given `item` under the given `key` to be processed at a later time by calling\n   * `serve(key)`.\n   */\n\n\n  _enqueue(key, item) {\n    if (!this._queue.has(key)) this._queue.set(key, /* @__PURE__ */new Set());\n\n    this._queue.get(key).add(item);\n  }\n  /**\n   * Process all items in queue for the given `key`.\n   */\n\n\n  _serve(key, callback) {\n    const items = this._queue.get(key);\n\n    if (items) for (const item of items) callback(item);\n\n    this._queue.delete(key);\n  }\n  /**\n   * Removes all queued items under the given `key`.\n   */\n\n\n  _delete(key) {\n    this._queue.delete(key);\n  }\n  /**\n   * The number of items currently queued under the given `key`.\n   */\n\n\n  _size(key) {\n    return this._queue.get(key)?.size ?? 0;\n  }\n  /**\n   * Clear all items in the queue.\n   */\n\n\n  _reset() {\n    this._queue.clear();\n  }\n\n}\n\nclass MediaRequestContext {\n  constructor() {\n    this._seeking = false;\n    this._looping = false;\n    this._replaying = false;\n    this._queue = new Queue();\n  }\n\n}\n\nclass MediaRequestManager extends MediaPlayerController {\n  constructor(_stateMgr, _request, _media) {\n    super();\n    this._stateMgr = _stateMgr;\n    this._request = _request;\n    this._media = _media;\n    this._wasPIPActive = false;\n    this._provider = _media.$provider;\n    this._controls = new MediaControls();\n    this._fullscreen = new FullscreenController();\n    this._orientation = new ScreenOrientationController();\n  }\n\n  onConnect() {\n    const names = Object.getOwnPropertyNames(Object.getPrototypeOf(this)),\n          handle = this._handleRequest.bind(this);\n\n    for (const name of names) {\n      if (name.startsWith(\"media-\")) {\n        this.listen(name, handle);\n      }\n    }\n\n    this.listen(\"fullscreen-change\", this._onFullscreenChange.bind(this));\n    effect(this._onControlsHideDelayChange.bind(this));\n    effect(this._onFullscreenSupportChange.bind(this));\n    effect(this._onPiPSupportChange.bind(this));\n  }\n\n  _handleRequest(event) {\n    event.stopPropagation();\n    {\n      this._media.logger?.infoGroup(`\\u{1F4EC} received \\`${event.type}\\``).labelledLog(\"Request\", event).dispatch();\n    }\n    if (peek(this._provider)) this[event.type]?.(event);\n  }\n\n  async _play(requestEvent) {\n    const {\n      canPlay,\n      paused,\n      ended,\n      autoplaying,\n      seekableStart\n    } = this.$state;\n    if (!peek(paused)) return;\n\n    try {\n      const provider = peek(this._provider);\n      throwIfNotReadyForPlayback(provider, peek(canPlay));\n\n      if (peek(ended)) {\n        provider.currentTime = seekableStart() + 0.1;\n      }\n\n      return await provider.play();\n    } catch (error) {\n      {\n        this._media.logger?.errorGroup(\"play request failed\").labelledLog(\"Request\", requestEvent).labelledLog(\"Error\", error).dispatch();\n      }\n      const errorEvent = this.createEvent(\"play-fail\", {\n        detail: coerceToError(error)\n      });\n      errorEvent.autoplay = autoplaying();\n\n      this._stateMgr._handle(errorEvent);\n\n      throw error;\n    }\n  }\n\n  async _pause() {\n    const {\n      canPlay,\n      paused\n    } = this.$state;\n    if (peek(paused)) return;\n    const provider = peek(this._provider);\n    throwIfNotReadyForPlayback(provider, peek(canPlay));\n    return provider.pause();\n  }\n\n  _seekToLiveEdge() {\n    const {\n      canPlay,\n      live,\n      liveEdge,\n      canSeek,\n      liveSyncPosition,\n      seekableEnd,\n      userBehindLiveEdge\n    } = this.$state;\n    userBehindLiveEdge.set(false);\n    if (peek(() => !live() || liveEdge() || !canSeek())) return;\n    const provider = peek(this._provider);\n    throwIfNotReadyForPlayback(provider, peek(canPlay));\n    provider.currentTime = liveSyncPosition() ?? seekableEnd() - 2;\n  }\n\n  async _enterFullscreen(target = \"prefer-media\") {\n    const provider = peek(this._provider);\n    const adapter = target === \"prefer-media\" && this._fullscreen.supported || target === \"media\" ? this._fullscreen : provider?.fullscreen;\n    throwIfFullscreenNotSupported(target, adapter);\n    if (adapter.active) return;\n\n    if (peek(this.$state.pictureInPicture)) {\n      this._wasPIPActive = true;\n      await this._exitPictureInPicture();\n    }\n\n    return adapter.enter();\n  }\n\n  async _exitFullscreen(target = \"prefer-media\") {\n    const provider = peek(this._provider);\n    const adapter = target === \"prefer-media\" && this._fullscreen.supported || target === \"media\" ? this._fullscreen : provider?.fullscreen;\n    throwIfFullscreenNotSupported(target, adapter);\n    if (!adapter.active) return;\n    if (this._orientation.locked) await this._orientation.unlock();\n\n    try {\n      const result = await adapter.exit();\n\n      if (this._wasPIPActive && peek(this.$state.canPictureInPicture)) {\n        await this._enterPictureInPicture();\n      }\n\n      return result;\n    } finally {\n      this._wasPIPActive = false;\n    }\n  }\n\n  async _enterPictureInPicture() {\n    this._throwIfPIPNotSupported();\n\n    if (this.$state.pictureInPicture()) return;\n    return await this._provider().pictureInPicture.enter();\n  }\n\n  async _exitPictureInPicture() {\n    this._throwIfPIPNotSupported();\n\n    if (!this.$state.pictureInPicture()) return;\n    return await this._provider().pictureInPicture.exit();\n  }\n\n  _throwIfPIPNotSupported() {\n    if (this.$state.canPictureInPicture()) return;\n    throw Error(`[vidstack] picture-in-picture is not currently available`);\n  }\n\n  _onControlsHideDelayChange() {\n    this._controls.defaultDelay = this.$props.controlsDelay();\n  }\n\n  _onFullscreenSupportChange() {\n    const {\n      canLoad,\n      canFullscreen\n    } = this.$state,\n          supported = this._fullscreen.supported || this._provider()?.fullscreen?.supported || false;\n    if (canLoad() && peek(canFullscreen) === supported) return;\n    canFullscreen.set(supported);\n  }\n\n  _onPiPSupportChange() {\n    const {\n      canLoad,\n      canPictureInPicture\n    } = this.$state,\n          supported = this._provider()?.pictureInPicture?.supported || false;\n    if (canLoad() && peek(canPictureInPicture) === supported) return;\n    canPictureInPicture.set(supported);\n  }\n\n  [\"media-audio-track-change-request\"](event) {\n    if (this._media.audioTracks.readonly) {\n      {\n        this._media.logger?.warnGroup(`[vidstack] attempted to change audio track but it is currently read-only`).labelledLog(\"Event\", event).dispatch();\n      }\n      return;\n    }\n\n    const index = event.detail,\n          track = this._media.audioTracks[index];\n\n    if (track) {\n      this._request._queue._enqueue(\"audioTrack\", event);\n\n      track.selected = true;\n    } else {\n      this._media.logger?.warnGroup(\"[vidstack] failed audio track change request (invalid index)\").labelledLog(\"Audio Tracks\", this._media.audioTracks.toArray()).labelledLog(\"Index\", index).labelledLog(\"Event\", event).dispatch();\n    }\n  }\n\n  async [\"media-enter-fullscreen-request\"](event) {\n    try {\n      this._request._queue._enqueue(\"fullscreen\", event);\n\n      await this._enterFullscreen(event.detail);\n    } catch (error) {\n      this._onFullscreenError(error, event);\n    }\n  }\n\n  async [\"media-exit-fullscreen-request\"](event) {\n    try {\n      this._request._queue._enqueue(\"fullscreen\", event);\n\n      await this._exitFullscreen(event.detail);\n    } catch (error) {\n      this._onFullscreenError(error, event);\n    }\n  }\n\n  async _onFullscreenChange(event) {\n    if (!event.detail) return;\n\n    try {\n      const lockType = peek(this.$props.fullscreenOrientation);\n\n      if (this._orientation.supported && !isUndefined(lockType)) {\n        await this._orientation.lock(lockType);\n      }\n    } catch (error) {\n      {\n        this._media.logger?.errorGroup(\"fullscreen orientation change failed\").labelledLog(\"Event\", event).labelledLog(\"Error\", error).dispatch();\n      }\n    }\n  }\n\n  _onFullscreenError(error, request) {\n    {\n      this._media.logger?.errorGroup(\"fullscreen request failed\").labelledLog(\"Request\", request).labelledLog(\"Error\", error).dispatch();\n    }\n\n    this._stateMgr._handle(this.createEvent(\"fullscreen-error\", {\n      detail: coerceToError(error)\n    }));\n  }\n\n  async [\"media-enter-pip-request\"](event) {\n    try {\n      this._request._queue._enqueue(\"pip\", event);\n\n      await this._enterPictureInPicture();\n    } catch (error) {\n      this._onPictureInPictureError(error, event);\n    }\n  }\n\n  async [\"media-exit-pip-request\"](event) {\n    try {\n      this._request._queue._enqueue(\"pip\", event);\n\n      await this._exitPictureInPicture();\n    } catch (error) {\n      this._onPictureInPictureError(error, event);\n    }\n  }\n\n  _onPictureInPictureError(error, request) {\n    {\n      this._media.logger?.errorGroup(\"pip request failed\").labelledLog(\"Request\", request).labelledLog(\"Error\", error).dispatch();\n    }\n\n    this._stateMgr._handle(this.createEvent(\"picture-in-picture-error\", {\n      detail: coerceToError(error)\n    }));\n  }\n\n  [\"media-live-edge-request\"](event) {\n    const {\n      live,\n      liveEdge,\n      canSeek\n    } = this.$state;\n    if (!live() || liveEdge() || !canSeek()) return;\n\n    this._request._queue._enqueue(\"seeked\", event);\n\n    try {\n      this._seekToLiveEdge();\n    } catch (error) {\n      this._media.logger?.error(\"seek to live edge fail\", error);\n    }\n  }\n\n  [\"media-loop-request\"](event) {\n    window.requestAnimationFrame(async () => {\n      try {\n        this._request._looping = true;\n        this._request._replaying = true;\n        await this._play(event);\n      } catch (e) {\n        this._request._looping = false;\n        this._request._replaying = false;\n      }\n    });\n  }\n\n  async [\"media-pause-request\"](event) {\n    if (this.$state.paused()) return;\n\n    try {\n      this._request._queue._enqueue(\"pause\", event);\n\n      await this._provider().pause();\n    } catch (error) {\n      {\n        this._media.logger?.errorGroup(\"\\u03C0ause request failed\").labelledLog(\"Request\", event).labelledLog(\"Error\", error).dispatch();\n      }\n\n      this._request._queue._delete(\"pause\");\n\n      this._media.logger?.error(\"pause-fail\", error);\n    }\n  }\n\n  async [\"media-play-request\"](event) {\n    if (!this.$state.paused()) return;\n\n    try {\n      this._request._queue._enqueue(\"play\", event);\n\n      await this._play(event);\n    } catch (e) {}\n  }\n\n  [\"media-rate-change-request\"](event) {\n    if (this.$state.playbackRate() === event.detail) return;\n\n    this._request._queue._enqueue(\"rate\", event);\n\n    this._provider().playbackRate = event.detail;\n  }\n\n  [\"media-quality-change-request\"](event) {\n    if (this._media.qualities.readonly) {\n      {\n        this._media.logger?.warnGroup(`[vidstack] attempted to change video quality but it is currently read-only`).labelledLog(\"Event\", event).dispatch();\n      }\n      return;\n    }\n\n    this._request._queue._enqueue(\"quality\", event);\n\n    const index = event.detail;\n\n    if (index < 0) {\n      this._media.qualities.autoSelect(event);\n    } else {\n      const quality = this._media.qualities[index];\n\n      if (quality) {\n        quality.selected = true;\n      } else {\n        this._media.logger?.warnGroup(\"[vidstack] failed quality change request (invalid index)\").labelledLog(\"Qualities\", this._media.qualities.toArray()).labelledLog(\"Index\", index).labelledLog(\"Event\", event).dispatch();\n      }\n    }\n  }\n\n  [\"media-pause-controls-request\"](event) {\n    this._request._queue._enqueue(\"controls\", event);\n\n    this._controls.pause(event);\n  }\n\n  [\"media-resume-controls-request\"](event) {\n    this._request._queue._enqueue(\"controls\", event);\n\n    this._controls.resume(event);\n  }\n\n  [\"media-seek-request\"](event) {\n    const {\n      seekableStart,\n      seekableEnd,\n      ended,\n      canSeek,\n      live,\n      userBehindLiveEdge\n    } = this.$state;\n    if (ended()) this._request._replaying = true;\n    this._request._seeking = false;\n\n    this._request._queue._delete(\"seeking\");\n\n    const boundTime = Math.min(Math.max(seekableStart() + 0.1, event.detail), seekableEnd() - 0.1);\n    if (!Number.isFinite(boundTime) || !canSeek()) return;\n\n    this._request._queue._enqueue(\"seeked\", event);\n\n    this._provider().currentTime = boundTime;\n\n    if (live() && event.isOriginTrusted && Math.abs(seekableEnd() - boundTime) >= 2) {\n      userBehindLiveEdge.set(true);\n    }\n  }\n\n  [\"media-seeking-request\"](event) {\n    this._request._queue._enqueue(\"seeking\", event);\n\n    this.$state.seeking.set(true);\n    this._request._seeking = true;\n  }\n\n  [\"media-start-loading\"](event) {\n    if (this.$state.canLoad()) return;\n\n    this._request._queue._enqueue(\"load\", event);\n\n    this._stateMgr._handle(this.createEvent(\"can-load\"));\n  }\n\n  [\"media-text-track-change-request\"](event) {\n    const {\n      index,\n      mode\n    } = event.detail,\n          track = this._media.textTracks[index];\n\n    if (track) {\n      this._request._queue._enqueue(\"textTrack\", event);\n\n      track.setMode(mode, event);\n    } else {\n      this._media.logger?.warnGroup(\"[vidstack] failed text track change request (invalid index)\").labelledLog(\"Text Tracks\", this._media.textTracks.toArray()).labelledLog(\"Index\", index).labelledLog(\"Event\", event).dispatch();\n    }\n  }\n\n  [\"media-mute-request\"](event) {\n    if (this.$state.muted()) return;\n\n    this._request._queue._enqueue(\"volume\", event);\n\n    this._provider().muted = true;\n  }\n\n  [\"media-unmute-request\"](event) {\n    const {\n      muted,\n      volume\n    } = this.$state;\n    if (!muted()) return;\n\n    this._request._queue._enqueue(\"volume\", event);\n\n    this._media.$provider().muted = false;\n\n    if (volume() === 0) {\n      this._request._queue._enqueue(\"volume\", event);\n\n      this._provider().volume = 0.25;\n    }\n  }\n\n  [\"media-volume-change-request\"](event) {\n    const {\n      muted,\n      volume\n    } = this.$state;\n    const newVolume = event.detail;\n    if (volume() === newVolume) return;\n\n    this._request._queue._enqueue(\"volume\", event);\n\n    this._provider().volume = newVolume;\n\n    if (newVolume > 0 && muted()) {\n      this._request._queue._enqueue(\"volume\", event);\n\n      this._provider().muted = false;\n    }\n  }\n\n}\n\nfunction throwIfNotReadyForPlayback(provider, canPlay) {\n  if (provider && canPlay) return;\n  throw Error(`[vidstack] media is not ready - wait for \\`can-play\\` event.`);\n}\n\nfunction throwIfFullscreenNotSupported(target, fullscreen) {\n  if (fullscreen?.supported) return;\n  throw Error(`[vidstack] fullscreen is not currently available on target \\`${target}\\``);\n}\n\nvar functionDebounce = debounce;\n\nfunction debounce(fn, wait, callFirst) {\n  var timeout = null;\n  var debouncedFn = null;\n\n  var clear = function () {\n    if (timeout) {\n      clearTimeout(timeout);\n      debouncedFn = null;\n      timeout = null;\n    }\n  };\n\n  var flush = function () {\n    var call = debouncedFn;\n    clear();\n\n    if (call) {\n      call();\n    }\n  };\n\n  var debounceWrapper = function () {\n    if (!wait) {\n      return fn.apply(this, arguments);\n    }\n\n    var context = this;\n    var args = arguments;\n    var callNow = callFirst && !timeout;\n    clear();\n\n    debouncedFn = function () {\n      fn.apply(context, args);\n    };\n\n    timeout = setTimeout(function () {\n      timeout = null;\n\n      if (!callNow) {\n        var call = debouncedFn;\n        debouncedFn = null;\n        return call();\n      }\n    }, wait);\n\n    if (callNow) {\n      return debouncedFn();\n    }\n  };\n\n  debounceWrapper.cancel = clear;\n  debounceWrapper.flush = flush;\n  return debounceWrapper;\n}\n\nvar functionThrottle = throttle;\n\nfunction throttle(fn, interval, options) {\n  var timeoutId = null;\n  var throttledFn = null;\n  var leading = options && options.leading;\n  var trailing = options && options.trailing;\n\n  if (leading == null) {\n    leading = true; // default\n  }\n\n  if (trailing == null) {\n    trailing = !leading; //default\n  }\n\n  if (leading == true) {\n    trailing = false; // forced because there should be invocation per call\n  }\n\n  var cancel = function () {\n    if (timeoutId) {\n      clearTimeout(timeoutId);\n      timeoutId = null;\n    }\n  };\n\n  var flush = function () {\n    var call = throttledFn;\n    cancel();\n\n    if (call) {\n      call();\n    }\n  };\n\n  var throttleWrapper = function () {\n    var callNow = leading && !timeoutId;\n    var context = this;\n    var args = arguments;\n\n    throttledFn = function () {\n      return fn.apply(context, args);\n    };\n\n    if (!timeoutId) {\n      timeoutId = setTimeout(function () {\n        timeoutId = null;\n\n        if (trailing) {\n          return throttledFn();\n        }\n      }, interval);\n    }\n\n    if (callNow) {\n      callNow = false;\n      return throttledFn();\n    }\n  };\n\n  throttleWrapper.cancel = cancel;\n  throttleWrapper.flush = flush;\n  return throttleWrapper;\n}\n\nconst TRACKED_EVENT = /* @__PURE__ */new Set([\"autoplay\", \"autoplay-fail\", \"can-load\", \"sources-change\", \"source-change\", \"load-start\", \"abort\", \"error\", \"loaded-metadata\", \"loaded-data\", \"can-play\", \"play\", \"play-fail\", \"pause\", \"playing\", \"seeking\", \"seeked\", \"waiting\"]);\n\nclass MediaStateManager extends MediaPlayerController {\n  constructor(_request, _media) {\n    super();\n    this._request = _request;\n    this._media = _media;\n    this._trackedEvents = /* @__PURE__ */new Map();\n    this._firingWaiting = false;\n    this._isPlayingOnDisconnect = false;\n    this[\"seeking\"] = functionThrottle(event => {\n      const {\n        seeking,\n        currentTime,\n        paused\n      } = this.$state;\n      seeking.set(true);\n      currentTime.set(event.detail);\n\n      this._satisfyRequest(\"seeking\", event);\n\n      if (paused()) {\n        this._waitingTrigger = event;\n\n        this._fireWaiting();\n      }\n    }, 150, {\n      leading: true\n    });\n    this._fireWaiting = functionDebounce(() => {\n      if (!this._waitingTrigger) return;\n      this._firingWaiting = true;\n      const {\n        waiting,\n        playing\n      } = this.$state;\n      waiting.set(true);\n      playing.set(false);\n      const event = this.createEvent(\"waiting\", {\n        trigger: this._waitingTrigger\n      });\n\n      this._trackedEvents.set(\"waiting\", event);\n\n      this.dispatch(event);\n      this._waitingTrigger = void 0;\n      this._firingWaiting = false;\n    }, 300);\n  }\n\n  onAttach(el) {\n    el.setAttribute(\"aria-busy\", \"true\");\n  }\n\n  onConnect(el) {\n    this._addTextTrackListeners();\n\n    this._addQualityListeners();\n\n    this._addAudioTrackListeners();\n\n    this.listen(\"fullscreen-change\", this[\"fullscreen-change\"].bind(this));\n    this.listen(\"fullscreen-error\", this[\"fullscreen-error\"].bind(this));\n\n    this._resumePlaybackOnConnect();\n\n    onDispose(this._pausePlaybackOnDisconnect.bind(this));\n  }\n\n  _handle(event) {\n    if (!this.scope) return;\n    const type = event.type;\n    this[event.type]?.(event);\n    {\n      if (TRACKED_EVENT.has(type)) this._trackedEvents.set(type, event);\n      this.dispatch(event);\n    }\n  }\n\n  _resumePlaybackOnConnect() {\n    if (!this._isPlayingOnDisconnect) return;\n\n    if (this._media.$provider()?.paused) {\n      requestAnimationFrame(() => {\n        if (!this.scope) return;\n\n        this._media.remote.play(new DOMEvent(\"dom-connect\"));\n      });\n    }\n\n    this._isPlayingOnDisconnect = false;\n  }\n\n  _pausePlaybackOnDisconnect() {\n    if (this._isPlayingOnDisconnect) return;\n    this._isPlayingOnDisconnect = !this._media.$state.paused();\n    this._media.$provider()?.pause();\n  }\n\n  _resetTracking() {\n    this._stopWaiting();\n\n    this._request._replaying = false;\n    this._request._looping = false;\n    this._firingWaiting = false;\n    this._waitingTrigger = void 0;\n\n    this._trackedEvents.clear();\n  }\n\n  _satisfyRequest(request, event) {\n    this._request._queue._serve(request, requestEvent => {\n      event.request = requestEvent;\n      appendTriggerEvent(event, requestEvent);\n    });\n  }\n\n  _addTextTrackListeners() {\n    this._onTextTracksChange();\n\n    this._onTextTrackModeChange();\n\n    const textTracks = this._media.textTracks;\n    listenEvent(textTracks, \"add\", this._onTextTracksChange.bind(this));\n    listenEvent(textTracks, \"remove\", this._onTextTracksChange.bind(this));\n    listenEvent(textTracks, \"mode-change\", this._onTextTrackModeChange.bind(this));\n  }\n\n  _addQualityListeners() {\n    const qualities = this._media.qualities;\n    listenEvent(qualities, \"add\", this._onQualitiesChange.bind(this));\n    listenEvent(qualities, \"remove\", this._onQualitiesChange.bind(this));\n    listenEvent(qualities, \"change\", this._onQualityChange.bind(this));\n    listenEvent(qualities, \"auto-change\", this._onAutoQualityChange.bind(this));\n    listenEvent(qualities, \"readonly-change\", this._onCanSetQualityChange.bind(this));\n  }\n\n  _addAudioTrackListeners() {\n    const audioTracks = this._media.audioTracks;\n    listenEvent(audioTracks, \"add\", this._onAudioTracksChange.bind(this));\n    listenEvent(audioTracks, \"remove\", this._onAudioTracksChange.bind(this));\n    listenEvent(audioTracks, \"change\", this._onAudioTrackChange.bind(this));\n  }\n\n  _onTextTracksChange(event) {\n    const {\n      textTracks\n    } = this.$state;\n    textTracks.set(this._media.textTracks.toArray());\n    this.dispatch(\"text-tracks-change\", {\n      detail: textTracks(),\n      trigger: event\n    });\n  }\n\n  _onTextTrackModeChange(event) {\n    if (event) this._satisfyRequest(\"textTrack\", event);\n    const current = this._media.textTracks.selected,\n          {\n      textTrack\n    } = this.$state;\n\n    if (textTrack() !== current) {\n      textTrack.set(current);\n      this.dispatch(\"text-track-change\", {\n        detail: current,\n        trigger: event\n      });\n    }\n  }\n\n  _onAudioTracksChange(event) {\n    const {\n      audioTracks\n    } = this.$state;\n    audioTracks.set(this._media.audioTracks.toArray());\n    this.dispatch(\"audio-tracks-change\", {\n      detail: audioTracks(),\n      trigger: event\n    });\n  }\n\n  _onAudioTrackChange(event) {\n    const {\n      audioTrack\n    } = this.$state;\n    audioTrack.set(this._media.audioTracks.selected);\n\n    this._satisfyRequest(\"audioTrack\", event);\n\n    this.dispatch(\"audio-track-change\", {\n      detail: audioTrack(),\n      trigger: event\n    });\n  }\n\n  _onQualitiesChange(event) {\n    const {\n      qualities\n    } = this.$state;\n    qualities.set(this._media.qualities.toArray());\n    this.dispatch(\"qualities-change\", {\n      detail: qualities(),\n      trigger: event\n    });\n  }\n\n  _onQualityChange(event) {\n    const {\n      quality\n    } = this.$state;\n    quality.set(this._media.qualities.selected);\n\n    this._satisfyRequest(\"quality\", event);\n\n    this.dispatch(\"quality-change\", {\n      detail: quality(),\n      trigger: event\n    });\n  }\n\n  _onAutoQualityChange() {\n    this.$state.autoQuality.set(this._media.qualities.auto);\n  }\n\n  _onCanSetQualityChange() {\n    this.$state.canSetQuality.set(!this._media.qualities.readonly);\n  }\n\n  [\"provider-change\"](event) {\n    const prevProvider = this._media.$provider(),\n          newProvider = event.detail;\n\n    if (prevProvider?.type === newProvider?.type) return;\n    prevProvider?.destroy?.();\n    prevProvider?.scope?.dispose();\n\n    this._media.$provider.set(event.detail);\n\n    if (prevProvider && event.detail === null) this._resetMediaState(event);\n  }\n\n  [\"provider-loader-change\"](event) {\n    {\n      this._media.logger?.infoGroup(`Loader change \\`${event.detail?.constructor.name}\\``).labelledLog(\"Event\", event).dispatch();\n    }\n  }\n\n  [\"autoplay\"](event) {\n    appendTriggerEvent(event, this._trackedEvents.get(\"play\"));\n    appendTriggerEvent(event, this._trackedEvents.get(\"can-play\"));\n    this.$state.autoplayError.set(void 0);\n  }\n\n  [\"autoplay-fail\"](event) {\n    appendTriggerEvent(event, this._trackedEvents.get(\"play-fail\"));\n    appendTriggerEvent(event, this._trackedEvents.get(\"can-play\"));\n    this.$state.autoplayError.set(event.detail);\n\n    this._resetTracking();\n  }\n\n  [\"can-load\"](event) {\n    this.$state.canLoad.set(true);\n\n    this._trackedEvents.set(\"can-load\", event);\n\n    this._satisfyRequest(\"load\", event);\n\n    this._media.textTracks[TextTrackSymbol._canLoad]();\n  }\n\n  [\"media-type-change\"](event) {\n    appendTriggerEvent(event, this._trackedEvents.get(\"source-change\"));\n    const viewType = this.$state.viewType();\n    this.$state.mediaType.set(event.detail);\n    const providedViewType = this.$state.providedViewType(),\n          currentViewType = providedViewType === \"unknown\" ? event.detail : providedViewType;\n\n    if (viewType !== currentViewType) {\n      {\n        setTimeout(() => {\n          requestAnimationFrame(() => {\n            if (!this.scope) return;\n            this.$state.inferredViewType.set(event.detail);\n            this.dispatch(\"view-type-change\", {\n              detail: currentViewType,\n              trigger: event\n            });\n          });\n        }, 0);\n      }\n    }\n  }\n\n  [\"stream-type-change\"](event) {\n    const {\n      streamType,\n      inferredStreamType\n    } = this.$state;\n    appendTriggerEvent(event, this._trackedEvents.get(\"source-change\"));\n    inferredStreamType.set(event.detail);\n    event.detail = streamType();\n  }\n\n  [\"rate-change\"](event) {\n    this.$state.playbackRate.set(event.detail);\n\n    this._satisfyRequest(\"rate\", event);\n  }\n\n  [\"sources-change\"](event) {\n    this.$state.sources.set(event.detail);\n  }\n\n  [\"source-change\"](event) {\n    appendTriggerEvent(event, this._trackedEvents.get(\"sources-change\"));\n\n    this._resetMediaState(event);\n\n    this._trackedEvents.set(event.type, event);\n\n    this.$state.source.set(event.detail);\n    this.el?.setAttribute(\"aria-busy\", \"true\");\n    {\n      this._media.logger?.infoGroup(\"\\u{1F4FC} Media source change\").labelledLog(\"Source\", event.detail).dispatch();\n    }\n  }\n\n  _resetMediaState(event) {\n    this._media.audioTracks[ListSymbol._reset](event);\n\n    this._media.qualities[ListSymbol._reset](event);\n\n    this._resetTracking();\n\n    softResetMediaState(this._media.$state);\n  }\n\n  [\"abort\"](event) {\n    appendTriggerEvent(event, this._trackedEvents.get(\"source-change\"));\n    appendTriggerEvent(event, this._trackedEvents.get(\"can-load\"));\n  }\n\n  [\"load-start\"](event) {\n    appendTriggerEvent(event, this._trackedEvents.get(\"source-change\"));\n  }\n\n  [\"error\"](event) {\n    this.$state.error.set(event.detail);\n    appendTriggerEvent(event, this._trackedEvents.get(\"abort\"));\n  }\n\n  [\"loaded-metadata\"](event) {\n    appendTriggerEvent(event, this._trackedEvents.get(\"load-start\"));\n  }\n\n  [\"loaded-data\"](event) {\n    appendTriggerEvent(event, this._trackedEvents.get(\"load-start\"));\n  }\n\n  [\"can-play\"](event) {\n    if (event.trigger?.type !== \"loadedmetadata\") {\n      appendTriggerEvent(event, this._trackedEvents.get(\"loaded-metadata\"));\n    }\n\n    this._onCanPlayDetail(event.detail);\n\n    this.el?.setAttribute(\"aria-busy\", \"false\");\n  }\n\n  [\"can-play-through\"](event) {\n    this._onCanPlayDetail(event.detail);\n\n    appendTriggerEvent(event, this._trackedEvents.get(\"can-play\"));\n  }\n\n  _onCanPlayDetail(detail) {\n    const {\n      seekable,\n      seekableEnd,\n      buffered,\n      duration,\n      canPlay\n    } = this.$state;\n    seekable.set(detail.seekable);\n    buffered.set(detail.buffered);\n    duration.set(seekableEnd);\n    canPlay.set(true);\n  }\n\n  [\"duration-change\"](event) {\n    const {\n      live,\n      duration\n    } = this.$state,\n          time = event.detail;\n    if (!live()) duration.set(!Number.isNaN(time) ? time : 0);\n  }\n\n  [\"progress\"](event) {\n    const {\n      buffered,\n      seekable,\n      live,\n      duration,\n      seekableEnd\n    } = this.$state,\n          detail = event.detail;\n    buffered.set(detail.buffered);\n    seekable.set(detail.seekable);\n\n    if (live()) {\n      duration.set(seekableEnd);\n      this.dispatch(\"duration-change\", {\n        detail: seekableEnd(),\n        trigger: event\n      });\n    }\n  }\n\n  [\"play\"](event) {\n    const {\n      paused,\n      autoplayError,\n      ended,\n      autoplaying\n    } = this.$state;\n    event.autoplay = autoplaying();\n\n    if (this._request._looping || !paused()) {\n      event.stopImmediatePropagation();\n      return;\n    }\n\n    appendTriggerEvent(event, this._trackedEvents.get(\"waiting\"));\n\n    this._satisfyRequest(\"play\", event);\n\n    paused.set(false);\n    autoplayError.set(void 0);\n\n    if (ended() || this._request._replaying) {\n      this._request._replaying = false;\n      ended.set(false);\n\n      this._handle(this.createEvent(\"replay\", {\n        trigger: event\n      }));\n    }\n  }\n\n  [\"play-fail\"](event) {\n    appendTriggerEvent(event, this._trackedEvents.get(\"play\"));\n\n    this._satisfyRequest(\"play\", event);\n\n    const {\n      paused,\n      playing\n    } = this.$state;\n    paused.set(true);\n    playing.set(false);\n\n    this._resetTracking();\n  }\n\n  [\"playing\"](event) {\n    const playEvent = this._trackedEvents.get(\"play\");\n\n    if (playEvent) {\n      appendTriggerEvent(event, this._trackedEvents.get(\"waiting\"));\n      appendTriggerEvent(event, playEvent);\n    } else {\n      appendTriggerEvent(event, this._trackedEvents.get(\"seeked\"));\n    }\n\n    setTimeout(() => this._resetTracking(), 0);\n    const {\n      paused,\n      playing,\n      seeking,\n      ended\n    } = this.$state;\n    paused.set(false);\n    playing.set(true);\n    seeking.set(false);\n    ended.set(false);\n\n    if (this._request._looping) {\n      event.stopImmediatePropagation();\n      this._request._looping = false;\n      return;\n    }\n\n    this[\"started\"](event);\n  }\n\n  [\"started\"](event) {\n    const {\n      started,\n      live,\n      liveSyncPosition,\n      seekableEnd\n    } = this.$state;\n\n    if (!started()) {\n      if (live()) {\n        const end = liveSyncPosition() ?? seekableEnd() - 2;\n        if (Number.isFinite(end)) this._media.$provider().currentTime = end;\n      }\n\n      started.set(true);\n\n      this._handle(this.createEvent(\"started\", {\n        trigger: event\n      }));\n    }\n  }\n\n  [\"pause\"](event) {\n    if (!this.el?.isConnected) {\n      this._isPlayingOnDisconnect = true;\n    }\n\n    if (this._request._looping) {\n      event.stopImmediatePropagation();\n      return;\n    }\n\n    appendTriggerEvent(event, this._trackedEvents.get(\"seeked\"));\n\n    this._satisfyRequest(\"pause\", event);\n\n    const {\n      paused,\n      playing,\n      seeking\n    } = this.$state;\n    paused.set(true);\n    playing.set(false);\n    seeking.set(false);\n\n    this._resetTracking();\n  }\n\n  [\"time-update\"](event) {\n    const {\n      currentTime,\n      played,\n      waiting\n    } = this.$state,\n          detail = event.detail;\n    currentTime.set(detail.currentTime);\n    played.set(detail.played);\n    waiting.set(false);\n\n    for (const track of this._media.textTracks) {\n      track[TextTrackSymbol._updateActiveCues](detail.currentTime, event);\n    }\n  }\n\n  [\"volume-change\"](event) {\n    const {\n      volume,\n      muted\n    } = this.$state,\n          detail = event.detail;\n    volume.set(detail.volume);\n    muted.set(detail.muted || detail.volume === 0);\n\n    this._satisfyRequest(\"volume\", event);\n  }\n\n  [\"seeked\"](event) {\n    const {\n      seeking,\n      currentTime,\n      paused,\n      duration,\n      ended\n    } = this.$state;\n\n    if (this._request._seeking) {\n      seeking.set(true);\n      event.stopImmediatePropagation();\n    } else if (seeking()) {\n      const waitingEvent = this._trackedEvents.get(\"waiting\");\n\n      appendTriggerEvent(event, waitingEvent);\n\n      if (waitingEvent?.trigger?.type !== \"seeking\") {\n        appendTriggerEvent(event, this._trackedEvents.get(\"seeking\"));\n      }\n\n      if (paused()) this._stopWaiting();\n      seeking.set(false);\n      if (event.detail !== duration()) ended.set(false);\n      currentTime.set(event.detail);\n\n      this._satisfyRequest(\"seeked\", event);\n\n      const origin = event.originEvent;\n\n      if (origin && origin.isTrusted && !/seek/.test(origin.type)) {\n        this[\"started\"](event);\n      }\n    }\n  }\n\n  [\"waiting\"](event) {\n    if (this._firingWaiting || this._request._seeking) return;\n    event.stopImmediatePropagation();\n    this._waitingTrigger = event;\n\n    this._fireWaiting();\n  }\n\n  [\"ended\"](event) {\n    if (this._request._looping) {\n      event.stopImmediatePropagation();\n      return;\n    }\n\n    const {\n      paused,\n      playing,\n      seeking,\n      ended\n    } = this.$state;\n    paused.set(true);\n    playing.set(false);\n    seeking.set(false);\n    ended.set(true);\n\n    this._resetTracking();\n  }\n\n  _stopWaiting() {\n    this._fireWaiting.cancel();\n\n    this.$state.waiting.set(false);\n  }\n\n  [\"fullscreen-change\"](event) {\n    this.$state.fullscreen.set(event.detail);\n\n    this._satisfyRequest(\"fullscreen\", event);\n  }\n\n  [\"fullscreen-error\"](event) {\n    this._satisfyRequest(\"fullscreen\", event);\n  }\n\n  [\"picture-in-picture-change\"](event) {\n    this.$state.pictureInPicture.set(event.detail);\n\n    this._satisfyRequest(\"pip\", event);\n  }\n\n  [\"picture-in-picture-error\"](event) {\n    this._satisfyRequest(\"pip\", event);\n  }\n\n}\n\nclass MediaStateSync extends MediaPlayerController {\n  onSetup() {\n    effect(this._onLogLevelChange.bind(this));\n    effect(this._onAutoplayChange.bind(this));\n    effect(this._onPosterChange.bind(this));\n    effect(this._onLoopChange.bind(this));\n    effect(this._onControlsChange.bind(this));\n    effect(this._onCrossOriginChange.bind(this));\n    effect(this._onPlaysinlineChange.bind(this));\n    effect(this._onLiveToleranceChange.bind(this));\n    effect(this._onLiveChange.bind(this));\n    effect(this._onLiveEdgeChange.bind(this));\n  }\n\n  _onLogLevelChange() {\n    this.$state.logLevel.set(this.$props.logLevel());\n  }\n\n  _onAutoplayChange() {\n    const autoplay = this.$props.autoplay();\n    this.$state.autoplay.set(autoplay);\n    this.dispatch(\"autoplay-change\", {\n      detail: autoplay\n    });\n  }\n\n  _onLoopChange() {\n    const loop = this.$props.loop();\n    this.$state.loop.set(loop);\n    this.dispatch(\"loop-change\", {\n      detail: loop\n    });\n  }\n\n  _onControlsChange() {\n    const controls = this.$props.controls();\n    this.$state.controls.set(controls);\n  }\n\n  _onPosterChange() {\n    const poster = this.$props.poster();\n    this.$state.poster.set(poster);\n    this.dispatch(\"poster-change\", {\n      detail: poster\n    });\n  }\n\n  _onCrossOriginChange() {\n    const crossorigin = this.$props.crossorigin();\n    this.$state.crossorigin.set(crossorigin === true ? \"\" : crossorigin);\n  }\n\n  _onPlaysinlineChange() {\n    const playsinline = this.$props.playsinline();\n    this.$state.playsinline.set(playsinline);\n    this.dispatch(\"playsinline-change\", {\n      detail: playsinline\n    });\n  }\n\n  _onLiveChange() {\n    this.dispatch(\"live-change\", {\n      detail: this.$state.live()\n    });\n  }\n\n  _onLiveToleranceChange() {\n    this.$state.liveEdgeTolerance.set(this.$props.liveEdgeTolerance());\n    this.$state.minLiveDVRWindow.set(this.$props.minLiveDVRWindow());\n  }\n\n  _onLiveEdgeChange() {\n    this.dispatch(\"live-edge-change\", {\n      detail: this.$state.liveEdge()\n    });\n  }\n\n}\n\nconst LOCAL_STORAGE_KEY = \"@vidstack/log-colors\";\nconst savedColors = init();\n\nfunction getLogColor(key) {\n  return savedColors.get(key);\n}\n\nfunction saveLogColor(key, {\n  color = generateColor(),\n  overwrite = false\n} = {}) {\n  if (!savedColors.has(key) || overwrite) {\n    savedColors.set(key, color);\n    localStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify(Object.entries(savedColors)));\n  }\n}\n\nfunction generateColor() {\n  return `hsl(${Math.random() * 360}, 55%, 70%)`;\n}\n\nfunction init() {\n  let colors;\n\n  try {\n    colors = JSON.parse(localStorage.getItem(LOCAL_STORAGE_KEY));\n  } catch {}\n\n  return new Map(Object.entries(colors ?? {}));\n}\n\nconst LogLevelValue = Object.freeze({\n  silent: 0,\n  error: 1,\n  warn: 2,\n  info: 3,\n  debug: 4\n});\nconst LogLevelColor = Object.freeze({\n  silent: \"white\",\n  error: \"hsl(6, 58%, 50%)\",\n  warn: \"hsl(51, 58%, 50%)\",\n  info: \"hsl(219, 58%, 50%)\",\n  debug: \"hsl(280, 58%, 50%)\"\n});\nconst s = 1e3;\nconst m = s * 60;\nconst h = m * 60;\nconst d = h * 24;\n\nfunction ms(val) {\n  const msAbs = Math.abs(val);\n\n  if (msAbs >= d) {\n    return Math.round(val / d) + \"d\";\n  }\n\n  if (msAbs >= h) {\n    return Math.round(val / h) + \"h\";\n  }\n\n  if (msAbs >= m) {\n    return Math.round(val / m) + \"m\";\n  }\n\n  if (msAbs >= s) {\n    return Math.round(val / s) + \"s\";\n  }\n\n  return round(val, 2) + \"ms\";\n}\n\nclass LogPrinter extends ViewController {\n  constructor() {\n    super(...arguments);\n    this._level = \"warn\";\n  }\n  /**\n   * The current log level.\n   */\n\n\n  get logLevel() {\n    return this._level;\n  }\n\n  set logLevel(level) {\n    this._level = level;\n  }\n\n  onConnect() {\n    this.listen(\"vds-log\", event => {\n      event.stopPropagation();\n      const element = event.path?.[0] ?? (event.target instanceof ViewController ? event.target.el : event.target),\n            eventTargetName = element?.$$COMPONENT_NAME?.replace(/^_/, \"\").replace(/Instance$/, \"\") ?? element?.tagName.toLowerCase() ?? \"unknown\";\n      const {\n        level = \"warn\",\n        data\n      } = event.detail ?? {};\n\n      if (LogLevelValue[this._level] < LogLevelValue[level]) {\n        return;\n      }\n\n      saveLogColor(eventTargetName);\n      const hint = data?.length === 1 && isGroupedLog(data[0]) ? data[0].title : isString(data?.[0]) ? data[0] : \"\";\n      console.groupCollapsed(`%c${level.toUpperCase()}%c ${eventTargetName}%c ${hint.slice(0, 50)}${hint.length > 50 ? \"...\" : \"\"}`, `background: ${LogLevelColor[level]}; color: white; padding: 1.5px 2.2px; border-radius: 2px; font-size: 11px;`, `color: ${getLogColor(eventTargetName)}; padding: 4px 0px; font-size: 11px;`, \"color: gray; font-size: 11px; padding-left: 4px;\");\n\n      if (data?.length === 1 && isGroupedLog(data[0])) {\n        if (element) data[0].logs.unshift({\n          label: \"Element\",\n          data: [element]\n        });\n        printGroup(level, data[0]);\n      } else if (data) {\n        print(level, ...data);\n      }\n\n      this._printTimeDiff();\n\n      printStackTrace();\n      console.groupEnd();\n    });\n    onDispose(() => {\n      this._lastLogged = void 0;\n    });\n  }\n\n  _printTimeDiff() {\n    labelledPrint(\"Time since last log\", this._calcLastLogTimeDiff());\n  }\n\n  _calcLastLogTimeDiff() {\n    const time = performance.now();\n    const diff = time - (this._lastLogged ?? (this._lastLogged = performance.now()));\n    this._lastLogged = time;\n    return ms(diff);\n  }\n\n}\n\nfunction print(level, ...data) {\n  console[level](...data);\n}\n\nfunction labelledPrint(label, ...data) {\n  console.log(`%c${label}:`, \"color: gray\", ...data);\n}\n\nfunction printStackTrace() {\n  console.groupCollapsed(\"%cStack Trace\", \"color: gray\");\n  console.trace();\n  console.groupEnd();\n}\n\nfunction printGroup(level, groupedLog) {\n  for (const log of groupedLog.logs) {\n    if (isGroupedLog(log)) {\n      console.groupCollapsed(groupedLog.title);\n      printGroup(level, log);\n      console.groupEnd();\n    } else if (\"label\" in log && !isUndefined(log.label)) {\n      labelledPrint(log.label, ...log.data);\n    } else {\n      print(level, ...log.data);\n    }\n  }\n}\n\nlet $keyboard = signal(false);\n{\n  listenEvent(document, \"pointerdown\", () => {\n    $keyboard.set(false);\n  });\n  listenEvent(document, \"keydown\", e => {\n    if (e.metaKey || e.altKey || e.ctrlKey) return;\n    $keyboard.set(true);\n  });\n}\n\nclass FocusVisibleController extends ViewController {\n  constructor() {\n    super(...arguments);\n    this._focused = signal(false);\n  }\n\n  onConnect(el) {\n    effect(() => {\n      if (!$keyboard()) {\n        this._focused.set(false);\n\n        updateFocusAttr(el, false);\n        this.listen(\"pointerenter\", this._onPointerEnter.bind(this));\n        this.listen(\"pointerleave\", this._onPointerLeave.bind(this));\n        return;\n      }\n\n      const active = document.activeElement === el;\n\n      this._focused.set(active);\n\n      updateFocusAttr(el, active);\n      this.listen(\"focus\", this._onFocus.bind(this));\n      this.listen(\"blur\", this._onBlur.bind(this));\n    });\n  }\n\n  focused() {\n    return this._focused();\n  }\n\n  _onFocus() {\n    this._focused.set(true);\n\n    updateFocusAttr(this.el, true);\n  }\n\n  _onBlur() {\n    this._focused.set(false);\n\n    updateFocusAttr(this.el, false);\n  }\n\n  _onPointerEnter() {\n    updateHoverAttr(this.el, true);\n  }\n\n  _onPointerLeave() {\n    updateHoverAttr(this.el, false);\n  }\n\n}\n\nfunction updateFocusAttr(el, isFocused) {\n  setAttribute(el, \"data-focus\", isFocused);\n  setAttribute(el, \"data-hocus\", isFocused);\n}\n\nfunction updateHoverAttr(el, isHovering) {\n  setAttribute(el, \"data-hocus\", isHovering);\n  setAttribute(el, \"data-hover\", isHovering);\n}\n\nclass RequestQueue {\n  constructor() {\n    this._serving = false;\n    this._pending = deferredPromise();\n    this._queue = /* @__PURE__ */new Map();\n  }\n  /**\n   * The number of callbacks that are currently in queue.\n   */\n\n\n  get _size() {\n    return this._queue.size;\n  }\n  /**\n   * Whether items in the queue are being served immediately, otherwise they're queued to\n   * be processed later.\n   */\n\n\n  get _isServing() {\n    return this._serving;\n  }\n  /**\n   * Waits for the queue to be flushed (ie: start serving).\n   */\n\n\n  async _waitForFlush() {\n    if (this._serving) return;\n    await this._pending.promise;\n  }\n  /**\n   * Queue the given `callback` to be invoked at a later time by either calling the `serve()` or\n   * `start()` methods. If the queue has started serving (i.e., `start()` was already called),\n   * then the callback will be invoked immediately.\n   *\n   * @param key - Uniquely identifies this callback so duplicates are ignored.\n   * @param callback - The function to call when this item in the queue is being served.\n   */\n\n\n  _enqueue(key, callback) {\n    if (this._serving) {\n      callback();\n      return;\n    }\n\n    this._queue.delete(key);\n\n    this._queue.set(key, callback);\n  }\n  /**\n   * Invokes the callback with the given `key` in the queue (if it exists).\n   */\n\n\n  _serve(key) {\n    this._queue.get(key)?.();\n\n    this._queue.delete(key);\n  }\n  /**\n   * Flush all queued items and start serving future requests immediately until `stop()` is called.\n   */\n\n\n  _start() {\n    this._flush();\n\n    this._serving = true;\n    if (this._queue.size > 0) this._flush();\n  }\n  /**\n   * Stop serving requests, they'll be queued until you begin processing again by calling `start()`.\n   */\n\n\n  _stop() {\n    this._serving = false;\n  }\n  /**\n   * Stop serving requests, empty the request queue, and release any promises waiting for the\n   * queue to flush.\n   */\n\n\n  _reset() {\n    this._stop();\n\n    this._queue.clear();\n\n    this._release();\n  }\n\n  _flush() {\n    for (const key of this._queue.keys()) this._serve(key);\n\n    this._release();\n  }\n\n  _release() {\n    this._pending.resolve();\n\n    this._pending = deferredPromise();\n  }\n\n}\n\nvar __defProp$f = Object.defineProperty;\nvar __getOwnPropDesc$f = Object.getOwnPropertyDescriptor;\n\nvar __decorateClass$f = (decorators, target, key, kind) => {\n  var result = kind > 1 ? void 0 : kind ? __getOwnPropDesc$f(target, key) : target;\n\n  for (var i = decorators.length - 1, decorator; i >= 0; i--) if (decorator = decorators[i]) result = (kind ? decorator(target, key, result) : decorator(result)) || result;\n\n  if (kind && result) __defProp$f(target, key, result);\n  return result;\n};\n\nconst _MediaPlayer = (_class = class _MediaPlayer extends Component {\n  constructor() {\n    super();\n    this.canPlayQueue = new RequestQueue();\n\n    this._initState();\n\n    new MediaStateSync();\n    const context = {\n      player: this,\n      scope: getScope(),\n      qualities: new VideoQualityList(),\n      audioTracks: new AudioTrackList(),\n      $provider: signal(null),\n      $props: this.$props,\n      $state: this.$state\n    };\n    {\n      const logPrinter = new LogPrinter();\n      effect(() => {\n        logPrinter.logLevel = this.$props.logLevel();\n      });\n    }\n    context.logger = new Logger();\n    context.remote = new MediaRemoteControl(context.logger);\n    context.remote.setPlayer(this);\n    context.$iosControls = computed(this._isIOSControls.bind(this));\n    context.textTracks = new TextTrackList();\n    context.textTracks[TextTrackSymbol._crossorigin] = this.$state.crossorigin;\n    context.textRenderers = new TextRenderers(context);\n    context.ariaKeys = {};\n    this._media = context;\n    provideContext(mediaContext, context);\n    this.orientation = new ScreenOrientationController();\n    new FocusVisibleController();\n    new MediaKeyboardController(context);\n    new MediaEventsLogger(context);\n    const request = new MediaRequestContext();\n    this._stateMgr = new MediaStateManager(request, context);\n    this._requestMgr = new MediaRequestManager(this._stateMgr, request, context);\n    context.delegate = new MediaPlayerDelegate(this._stateMgr._handle.bind(this._stateMgr), context);\n    new MediaLoadController(this.startLoading.bind(this));\n  }\n\n  get _provider() {\n    return this._media.$provider();\n  }\n\n  onSetup() {\n    this._setupMediaAttributes();\n\n    effect(this._watchCanPlay.bind(this));\n    effect(this._watchMuted.bind(this));\n    effect(this._watchPaused.bind(this));\n    effect(this._watchVolume.bind(this));\n    effect(this._watchCurrentTime.bind(this));\n    effect(this._watchPlaysinline.bind(this));\n    effect(this._watchPlaybackRate.bind(this));\n  }\n\n  onAttach(el) {\n    el.setAttribute(\"data-media-player\", \"\");\n    setAttributeIfEmpty(el, \"tabindex\", \"0\");\n    setAttributeIfEmpty(el, \"role\", \"region\");\n    effect(this._watchTitle.bind(this));\n    effect(this._watchOrientation.bind(this));\n    listenEvent(el, \"find-media-player\", this._onFindPlayer.bind(this));\n  }\n\n  onConnect(el) {\n    if (IS_IPHONE) setAttribute(el, \"data-iphone\", \"\");\n    canChangeVolume().then(this.$state.canSetVolume.set);\n    const pointerQuery = window.matchMedia(\"(pointer: coarse)\");\n\n    this._onPointerChange(pointerQuery);\n\n    pointerQuery.onchange = this._onPointerChange.bind(this);\n    const resize = new ResizeObserver(animationFrameThrottle(this._onResize.bind(this)));\n    resize.observe(el);\n    effect(this._onResize.bind(this));\n    this.dispatch(\"media-player-connect\", {\n      detail: this,\n      bubbles: true,\n      composed: true\n    });\n\n    this._media.logger.setTarget(el);\n\n    onDispose(() => {\n      resize.disconnect();\n      pointerQuery.onchange = null;\n\n      this._media.logger.setTarget(null);\n    });\n  }\n\n  onDestroy() {\n    this._media.player = null;\n\n    this.canPlayQueue._reset();\n  }\n\n  _initState() {\n    const providedProps = {\n      viewType: \"providedViewType\",\n      streamType: \"providedStreamType\"\n    };\n\n    for (const prop2 of Object.keys(this.$props)) {\n      this.$state[providedProps[prop2] ?? prop2]?.set(this.$props[prop2]());\n    }\n\n    effect(this._onProvidedTypesChange.bind(this));\n    this.$state.muted.set(this.$props.muted() || this.$props.volume() === 0);\n  }\n\n  _watchTitle() {\n    const {\n      title\n    } = this.$props,\n          {\n      live,\n      viewType\n    } = this.$state,\n          isLive = live(),\n          type = uppercaseFirstChar(viewType()),\n          typeText = type !== \"Unknown\" ? `${isLive ? \"Live \" : \"\"}${type}` : isLive ? \"Live\" : \"Media\";\n    const newTitle = title();\n\n    if (newTitle) {\n      this.el?.setAttribute(\"data-title\", newTitle);\n      this.el?.removeAttribute(\"title\");\n    }\n\n    const currentTitle = this.el?.getAttribute(\"data-title\") || \"\";\n    this.$state.title.set(currentTitle);\n    setAttribute(this.el, \"aria-label\", currentTitle ? `${typeText} - ${currentTitle}` : typeText + \" Player\");\n  }\n\n  _watchOrientation() {\n    const orientation = this.orientation.landscape ? \"landscape\" : \"portrait\";\n    this.$state.orientation.set(orientation);\n    setAttribute(this.el, \"data-orientation\", orientation);\n\n    this._onResize();\n  }\n\n  _watchCanPlay() {\n    if (this.$state.canPlay() && this._provider) this.canPlayQueue._start();else this.canPlayQueue._stop();\n  }\n\n  _onProvidedTypesChange() {\n    this.$state.providedViewType.set(this.$props.viewType());\n    this.$state.providedStreamType.set(this.$props.streamType());\n  }\n\n  _setupMediaAttributes() {\n    if (_MediaPlayer[MEDIA_ATTRIBUTES]) {\n      this.setAttributes(_MediaPlayer[MEDIA_ATTRIBUTES]);\n      return;\n    }\n\n    const $attrs = {\n      \"data-captions\": function () {\n        const track = this.$state.textTrack();\n        return !!track && isTrackCaptionKind(track);\n      },\n      \"data-ios-controls\": function () {\n        return this._media.$iosControls();\n      },\n      \"data-controls\": function () {\n        return this.controls.showing;\n      },\n      \"data-buffering\": function () {\n        const {\n          canPlay,\n          waiting\n        } = this.$state;\n        return !canPlay() || waiting();\n      },\n      \"data-error\": function () {\n        const {\n          error\n        } = this.$state;\n        return !!error();\n      }\n    };\n    const alias = {\n      canPictureInPicture: \"can-pip\",\n      pictureInPicture: \"pip\"\n    };\n\n    for (const prop2 of mediaAttributes) {\n      const attrName = \"data-\" + (alias[prop2] ?? camelToKebabCase(prop2));\n\n      $attrs[attrName] = function () {\n        return this.$state[prop2]();\n      };\n    }\n\n    delete $attrs.title;\n    _MediaPlayer[MEDIA_ATTRIBUTES] = $attrs;\n    this.setAttributes($attrs);\n  }\n\n  _onFindPlayer(event) {\n    event.detail(this);\n  }\n\n  _onResize() {\n    if (!this.el) return;\n    const width = this.el.clientWidth,\n          height = this.el.clientHeight;\n    this.$state.width.set(width);\n    this.$state.height.set(height);\n    setStyle(this.el, \"--player-width\", width + \"px\");\n    setStyle(this.el, \"--player-height\", height + \"px\");\n  }\n\n  _onPointerChange(queryList) {\n    const pointer = queryList.matches ? \"coarse\" : \"fine\";\n    setAttribute(this.el, \"data-pointer\", pointer);\n    this.$state.pointer.set(pointer);\n\n    this._onResize();\n  }\n\n  _isIOSControls() {\n    return !canFullscreen() && this.$state.mediaType() === \"video\" && (this.$state.controls() && !this.$props.playsinline() || this.$state.fullscreen());\n  }\n\n  get provider() {\n    return this._provider;\n  }\n\n  get controls() {\n    return this._requestMgr._controls;\n  }\n\n  get qualities() {\n    return this._media.qualities;\n  }\n\n  get audioTracks() {\n    return this._media.audioTracks;\n  }\n\n  get textTracks() {\n    return this._media.textTracks;\n  }\n\n  get textRenderers() {\n    return this._media.textRenderers;\n  }\n\n  get paused() {\n    return this._provider?.paused ?? true;\n  }\n\n  set paused(paused) {\n    this._queuePausedUpdate(paused);\n  }\n\n  _watchPaused() {\n    this._queuePausedUpdate(this.$props.paused());\n  }\n\n  _queuePausedUpdate(paused) {\n    if (paused) {\n      this.canPlayQueue._enqueue(\"paused\", () => this._requestMgr._pause());\n    } else this.canPlayQueue._enqueue(\"paused\", () => this._requestMgr._play());\n  }\n\n  get muted() {\n    return this._provider?.muted ?? false;\n  }\n\n  set muted(muted) {\n    this._queueMutedUpdate(muted);\n  }\n\n  _watchMuted() {\n    this._queueMutedUpdate(this.$props.muted());\n  }\n\n  _queueMutedUpdate(muted) {\n    this.canPlayQueue._enqueue(\"muted\", () => this._provider.muted = muted);\n  }\n\n  get currentTime() {\n    return this._provider?.currentTime ?? 0;\n  }\n\n  set currentTime(time) {\n    this._queueCurrentTimeUpdate(time);\n  }\n\n  _watchCurrentTime() {\n    this._queueCurrentTimeUpdate(this.$props.currentTime());\n  }\n\n  _queueCurrentTimeUpdate(time) {\n    this.canPlayQueue._enqueue(\"currentTime\", () => {\n      const adapter = this._provider;\n\n      if (time !== adapter.currentTime) {\n        peek(() => {\n          const boundTime = Math.min(Math.max(this.$state.seekableStart() + 0.1, time), this.$state.seekableEnd() - 0.1);\n          if (Number.isFinite(boundTime)) adapter.currentTime = boundTime;\n        });\n      }\n    });\n  }\n\n  get volume() {\n    return this._provider?.volume ?? 1;\n  }\n\n  set volume(volume) {\n    this._queueVolumeUpdate(volume);\n  }\n\n  _watchVolume() {\n    this._queueVolumeUpdate(this.$props.volume());\n  }\n\n  _queueVolumeUpdate(volume) {\n    const clampedVolume = clampNumber(0, volume, 1);\n\n    this.canPlayQueue._enqueue(\"volume\", () => this._provider.volume = clampedVolume);\n  }\n\n  get playsinline() {\n    return this._provider?.playsinline ?? false;\n  }\n\n  set playsinline(inline) {\n    this._queuePlaysinlineUpdate(inline);\n  }\n\n  _watchPlaysinline() {\n    this._queuePlaysinlineUpdate(this.$props.playsinline());\n  }\n\n  _queuePlaysinlineUpdate(inline) {\n    this.canPlayQueue._enqueue(\"playsinline\", () => this._provider.playsinline = inline);\n  }\n\n  get playbackRate() {\n    return this._provider?.playbackRate ?? 1;\n  }\n\n  set playbackRate(rate) {\n    this._queuePlaybackRateUpdate(rate);\n  }\n\n  _watchPlaybackRate() {\n    this._queuePlaybackRateUpdate(this.$props.playbackRate());\n  }\n\n  _queuePlaybackRateUpdate(rate) {\n    this.canPlayQueue._enqueue(\"rate\", () => this._provider.playbackRate = rate);\n  }\n\n  async play() {\n    return this._requestMgr._play();\n  }\n\n  async pause() {\n    return this._requestMgr._pause();\n  }\n\n  async enterFullscreen(target) {\n    return this._requestMgr._enterFullscreen(target);\n  }\n\n  async exitFullscreen(target) {\n    return this._requestMgr._exitFullscreen(target);\n  }\n\n  enterPictureInPicture() {\n    return this._requestMgr._enterPictureInPicture();\n  }\n\n  exitPictureInPicture() {\n    return this._requestMgr._exitPictureInPicture();\n  }\n\n  seekToLiveEdge() {\n    this._requestMgr._seekToLiveEdge();\n  }\n\n  startLoading() {\n    this._media.delegate._dispatch(\"can-load\");\n  }\n\n  matchQuery(query) {\n    return scoped(() => PlayerQueryList.create(query), this.scope);\n  }\n\n  destroy() {\n    this._media.remote.setPlayer(null);\n\n    this.dispatch(\"destroy\");\n  }\n\n}, _class.props = mediaPlayerProps, _class.state = mediaState, _class);\n\n__decorateClass$f([prop], _MediaPlayer.prototype, \"canPlayQueue\", 2);\n\n__decorateClass$f([prop], _MediaPlayer.prototype, \"provider\", 1);\n\n__decorateClass$f([prop], _MediaPlayer.prototype, \"controls\", 1);\n\n__decorateClass$f([prop], _MediaPlayer.prototype, \"orientation\", 2);\n\n__decorateClass$f([prop], _MediaPlayer.prototype, \"qualities\", 1);\n\n__decorateClass$f([prop], _MediaPlayer.prototype, \"audioTracks\", 1);\n\n__decorateClass$f([prop], _MediaPlayer.prototype, \"textTracks\", 1);\n\n__decorateClass$f([prop], _MediaPlayer.prototype, \"textRenderers\", 1);\n\n__decorateClass$f([prop], _MediaPlayer.prototype, \"paused\", 1);\n\n__decorateClass$f([prop], _MediaPlayer.prototype, \"muted\", 1);\n\n__decorateClass$f([prop], _MediaPlayer.prototype, \"currentTime\", 1);\n\n__decorateClass$f([prop], _MediaPlayer.prototype, \"volume\", 1);\n\n__decorateClass$f([prop], _MediaPlayer.prototype, \"playsinline\", 1);\n\n__decorateClass$f([prop], _MediaPlayer.prototype, \"playbackRate\", 1);\n\n__decorateClass$f([method], _MediaPlayer.prototype, \"play\", 1);\n\n__decorateClass$f([method], _MediaPlayer.prototype, \"pause\", 1);\n\n__decorateClass$f([method], _MediaPlayer.prototype, \"enterFullscreen\", 1);\n\n__decorateClass$f([method], _MediaPlayer.prototype, \"exitFullscreen\", 1);\n\n__decorateClass$f([method], _MediaPlayer.prototype, \"enterPictureInPicture\", 1);\n\n__decorateClass$f([method], _MediaPlayer.prototype, \"exitPictureInPicture\", 1);\n\n__decorateClass$f([method], _MediaPlayer.prototype, \"seekToLiveEdge\", 1);\n\n__decorateClass$f([method], _MediaPlayer.prototype, \"startLoading\", 1);\n\n__decorateClass$f([method], _MediaPlayer.prototype, \"matchQuery\", 1);\n\nlet MediaPlayer = _MediaPlayer;\n\nfunction resolveStreamTypeFromHLSManifest(manifestSrc, requestInit) {\n  return fetch(manifestSrc, requestInit).then(res => res.text()).then(manifest => {\n    const renditionURI = resolveHLSRenditionURI(manifest);\n\n    if (renditionURI) {\n      return resolveStreamTypeFromHLSManifest(/^https?:/.test(renditionURI) ? renditionURI : new URL(renditionURI, manifestSrc).href, requestInit);\n    }\n\n    const streamType = /EXT-X-PLAYLIST-TYPE:\\s*VOD/.test(manifest) ? \"on-demand\" : \"live\";\n\n    if (streamType === \"live\" && resolveTargetDuration(manifest) >= 10 && (/#EXT-X-DVR-ENABLED:\\s*true/.test(manifest) || manifest.includes(\"#EXT-X-DISCONTINUITY\"))) {\n      return \"live:dvr\";\n    }\n\n    return streamType;\n  });\n}\n\nfunction resolveHLSRenditionURI(manifest) {\n  const matches = manifest.match(/#EXT-X-STREAM-INF:[^\\n]+(\\n[^\\n]+)*/g);\n  return matches ? matches[0].split(\"\\n\")[1].trim() : null;\n}\n\nfunction resolveTargetDuration(manifest) {\n  const lines = manifest.split(\"\\n\");\n\n  for (const line of lines) {\n    if (line.startsWith(\"#EXT-X-TARGETDURATION\")) {\n      const duration = parseFloat(line.split(\":\")[1]);\n\n      if (!isNaN(duration)) {\n        return duration;\n      }\n    }\n  }\n\n  return -1;\n}\n\nlet warned = /* @__PURE__ */new Set();\nconst SETUP = Symbol(\"SETUP\");\n\nclass SourceSelection {\n  constructor(_domSources, _media, _loader) {\n    this._domSources = _domSources;\n    this._media = _media;\n    this._loader = _loader;\n    this._initialize = false;\n    const HLS_LOADER = new HLSProviderLoader(),\n          VIDEO_LOADER = new VideoProviderLoader(),\n          AUDIO_LOADER = new AudioProviderLoader();\n    this._loaders = computed(() => {\n      return _media.$props.preferNativeHLS() ? [VIDEO_LOADER, AUDIO_LOADER, HLS_LOADER] : [HLS_LOADER, VIDEO_LOADER, AUDIO_LOADER];\n    });\n    const {\n      $state\n    } = _media;\n    $state.sources.set(normalizeSrc(_media.$props.src()));\n\n    for (const src of $state.sources()) {\n      const loader = this._loaders().find(loader2 => loader2.canPlay(src));\n\n      if (!loader) continue;\n      const mediaType = loader.mediaType(src);\n\n      this._media.$state.source.set(src);\n\n      this._media.$state.mediaType.set(mediaType);\n\n      this._media.$state.inferredViewType.set(mediaType);\n\n      this._loader.set(loader);\n\n      this._initialize = true;\n    }\n  }\n\n  connect() {\n    const loader = this._loader();\n\n    if (this._initialize) {\n      this._notifySourceChange(this._media.$state.source(), loader);\n\n      this._notifyLoaderChange(loader);\n\n      this._initialize = false;\n    }\n\n    effect(this._onSourcesChange.bind(this));\n    effect(this._onSourceChange.bind(this));\n    effect(this._onConnect.bind(this));\n    effect(this._onLoadSource.bind(this));\n  }\n\n  _onSourcesChange() {\n    this._media.delegate._dispatch(\"sources-change\", {\n      detail: [...normalizeSrc(this._media.$props.src()), ...this._domSources()]\n    });\n  }\n\n  _onSourceChange() {\n    const {\n      $state\n    } = this._media;\n\n    const sources = $state.sources(),\n          currentSource = peek($state.source),\n          newSource = this._findNewSource(currentSource, sources),\n          noMatch = sources[0]?.src && !newSource.src && !newSource.type;\n\n    if (noMatch && !warned.has(newSource.src) && !peek(this._loader)) {\n      const source = sources[0];\n      console.warn(`[vidstack] could not find a loader for any of the given media sources, consider providing \\`type\\`:\n\n<media-provider>\n  <source src=\"${source.src}\" type=\"video/mp4\" />\n</media-provider>\"\n\nFalling back to fetching source headers...`);\n      warned.add(newSource.src);\n    }\n\n    if (noMatch) {\n      const {\n        crossorigin\n      } = $state,\n            credentials = getRequestCredentials(crossorigin()),\n            abort = new AbortController();\n      Promise.all(sources.map(source => isString(source.src) && source.type === \"?\" ? fetch(source.src, {\n        method: \"HEAD\",\n        credentials,\n        signal: abort.signal\n      }).then(res => {\n        source.type = res.headers.get(\"content-type\") || \"??\";\n        return source;\n      }).catch(() => source) : source)).then(sources2 => {\n        if (abort.signal.aborted) return;\n\n        this._findNewSource(peek($state.source), sources2);\n\n        tick();\n      });\n      return () => abort.abort();\n    }\n\n    tick();\n  }\n\n  _findNewSource(currentSource, sources) {\n    let newSource = {\n      src: \"\",\n      type: \"\"\n    },\n        newLoader = null;\n\n    for (const src of sources) {\n      const loader = peek(this._loaders).find(loader2 => loader2.canPlay(src));\n\n      if (loader) {\n        newSource = src;\n        newLoader = loader;\n      }\n    }\n\n    if (!isSameSrc(currentSource, newSource)) {\n      this._notifySourceChange(newSource, newLoader);\n    }\n\n    if (newLoader !== peek(this._loader)) {\n      this._notifyLoaderChange(newLoader);\n    }\n\n    return newSource;\n  }\n\n  _notifySourceChange(src, loader) {\n    this._media.delegate._dispatch(\"source-change\", {\n      detail: src\n    });\n\n    this._media.delegate._dispatch(\"media-type-change\", {\n      detail: loader?.mediaType(src) || \"unknown\"\n    });\n  }\n\n  _notifyLoaderChange(loader) {\n    this._media.delegate._dispatch(\"provider-change\", {\n      detail: null\n    });\n\n    loader && peek(() => loader.preconnect?.(this._media));\n\n    this._loader.set(loader);\n\n    this._media.delegate._dispatch(\"provider-loader-change\", {\n      detail: loader\n    });\n  }\n\n  _onConnect() {\n    const provider = this._media.$provider();\n\n    if (!provider || provider[SETUP]) return;\n\n    if (this._media.$state.canLoad()) {\n      scoped(() => provider.setup(this._media), provider.scope);\n      provider[SETUP] = true;\n      return;\n    }\n\n    peek(() => provider.preconnect?.(this._media));\n  }\n\n  _onLoadSource() {\n    const provider = this._media.$provider(),\n          source = this._media.$state.source(),\n          crossorigin = peek(this._media.$state.crossorigin);\n\n    if (isSameSrc(provider?.currentSrc, source)) {\n      return;\n    }\n\n    if (this._media.$state.canLoad()) {\n      const abort = new AbortController();\n\n      if (isHLSSrc(source)) {\n        if (!isHLSSupported()) {\n          resolveStreamTypeFromHLSManifest(source.src, {\n            credentials: getRequestCredentials(crossorigin),\n            signal: abort.signal\n          }).then(streamType => {\n            this._media.delegate._dispatch(\"stream-type-change\", {\n              detail: streamType\n            });\n          }).catch(noop);\n        }\n      } else {\n        this._media.delegate._dispatch(\"stream-type-change\", {\n          detail: \"on-demand\"\n        });\n      }\n\n      peek(() => provider?.loadSource(source, peek(this._media.$state.preload)));\n      return () => abort.abort();\n    }\n\n    try {\n      isString(source.src) && preconnect(new URL(source.src).origin, \"preconnect\");\n    } catch (error) {\n      {\n        this._media.logger?.infoGroup(`Failed to preconnect to source: ${source.src}`).labelledLog(\"Error\", error).dispatch();\n      }\n    }\n  }\n\n}\n\nfunction normalizeSrc(src) {\n  return (isArray(src) ? src : [!isString(src) && \"src\" in src ? src : {\n    src\n  }]).map(({\n    src: src2,\n    type\n  }) => ({\n    src: src2,\n    type: type ?? (!isString(src2) || src2.startsWith(\"blob:\") ? \"video/object\" : \"?\")\n  }));\n}\n\nfunction isSameSrc(a, b) {\n  return a?.src === b?.src && a?.type === b?.type;\n}\n\nclass Tracks {\n  constructor(_domTracks, _media) {\n    this._domTracks = _domTracks;\n    this._media = _media;\n    this._prevTracks = [];\n    effect(this._onTracksChange.bind(this));\n  }\n\n  _onTracksChange() {\n    const newTracks = this._domTracks();\n\n    for (const oldTrack of this._prevTracks) {\n      if (!newTracks.some(t => t.id === oldTrack.id)) {\n        const track = oldTrack.id && this._media.textTracks.getById(oldTrack.id);\n\n        if (track) this._media.textTracks.remove(track);\n      }\n    }\n\n    for (const newTrack of newTracks) {\n      const id = newTrack.id || TextTrack.createId(newTrack);\n\n      if (!this._media.textTracks.getById(id)) {\n        newTrack.id = id;\n\n        this._media.textTracks.add(newTrack);\n      }\n    }\n\n    this._prevTracks = newTracks;\n  }\n\n}\n\nvar __defProp$e = Object.defineProperty;\nvar __getOwnPropDesc$e = Object.getOwnPropertyDescriptor;\n\nvar __decorateClass$e = (decorators, target, key, kind) => {\n  var result = kind > 1 ? void 0 : kind ? __getOwnPropDesc$e(target, key) : target;\n\n  for (var i = decorators.length - 1, decorator; i >= 0; i--) if (decorator = decorators[i]) result = (kind ? decorator(target, key, result) : decorator(result)) || result;\n\n  if (kind && result) __defProp$e(target, key, result);\n  return result;\n};\n\nclass MediaProvider extends Component {\n  constructor() {\n    super(...arguments);\n    this._domSources = signal([]);\n    this._domTracks = signal([]);\n    this._loader = null;\n    this._loadRafId = -1;\n  }\n\n  onSetup() {\n    this._media = useMediaContext();\n    this._sources = new SourceSelection(this._domSources, this._media, this.$state.loader);\n  }\n\n  onAttach(el) {\n    el.setAttribute(\"data-media-provider\", \"\");\n  }\n\n  onConnect(el) {\n    this._sources.connect();\n\n    new Tracks(this._domTracks, this._media);\n    const resize = new ResizeObserver(animationFrameThrottle(this._onResize.bind(this)));\n    resize.observe(el);\n    const mutation = new MutationObserver(this._onMutation.bind(this));\n    mutation.observe(el, {\n      attributes: true,\n      childList: true\n    });\n\n    if (IS_SAFARI) {\n      listenEvent(el, \"touchstart\", e => e.preventDefault(), {\n        passive: false\n      });\n    }\n\n    this._onResize();\n\n    this._onMutation();\n\n    onDispose(() => {\n      resize.disconnect();\n      mutation.disconnect();\n    });\n  }\n\n  load(target) {\n    window.cancelAnimationFrame(this._loadRafId);\n    this._loadRafId = requestAnimationFrame(() => this._runLoader(target));\n    onDispose(() => {\n      window.cancelAnimationFrame(this._loadRafId);\n    });\n  }\n\n  _runLoader(target) {\n    if (!this.scope) return;\n    const loader = this.$state.loader(),\n          {\n      $provider\n    } = this._media;\n    if (this._loader === loader && loader?.target === target && peek($provider)) return;\n\n    this._destroyProvider();\n\n    this._loader = loader;\n    if (loader) loader.target = target || null;\n    if (!loader || !target) return;\n    loader.load(this._media).then(provider => {\n      if (!this.scope) return;\n      if (peek(this.$state.loader) !== loader) return;\n\n      this._media.delegate._dispatch(\"provider-change\", {\n        detail: provider\n      });\n    });\n  }\n\n  onDestroy() {\n    this._loader = null;\n\n    this._destroyProvider();\n  }\n\n  _destroyProvider() {\n    this._media.delegate._dispatch(\"provider-change\", {\n      detail: null\n    });\n  }\n\n  _onResize() {\n    if (!this.el) return;\n    const player = this._media.player,\n          width = this.el.offsetWidth,\n          height = this.el.offsetHeight;\n    if (!player) return;\n    player.$state.mediaWidth.set(width);\n    player.$state.mediaHeight.set(height);\n\n    if (player.el) {\n      setStyle(player.el, \"--media-width\", width + \"px\");\n      setStyle(player.el, \"--media-height\", height + \"px\");\n    }\n  }\n\n  _onMutation() {\n    const sources = [],\n          tracks = [],\n          children = this.el.children;\n\n    for (const el of children) {\n      if (el instanceof HTMLSourceElement) {\n        sources.push({\n          src: el.src,\n          type: el.type\n        });\n      } else if (el instanceof HTMLTrackElement) {\n        tracks.push({\n          id: el.id,\n          src: el.src,\n          kind: el.track.kind,\n          language: el.srclang,\n          label: el.label,\n          default: el.default,\n          type: el.getAttribute(\"data-type\")\n        });\n      }\n    }\n\n    this._domSources.set(sources);\n\n    this._domTracks.set(tracks);\n\n    tick();\n  }\n\n}\n\nMediaProvider.state = new State({\n  loader: null\n});\n\n__decorateClass$e([method], MediaProvider.prototype, \"load\", 1);\n\nclass Controls extends Component {\n  onSetup() {\n    this._media = useMediaContext();\n    effect(this._watchHideDelay.bind(this));\n  }\n\n  onAttach(el) {\n    const {\n      pictureInPicture,\n      fullscreen\n    } = this._media.$state;\n    setStyle(el, \"pointer-events\", \"none\");\n    setAttributeIfEmpty(el, \"role\", \"group\");\n    this.setAttributes({\n      \"data-visible\": this._isShowing.bind(this),\n      \"data-fullscreen\": fullscreen,\n      \"data-pip\": pictureInPicture\n    });\n    effect(() => {\n      this.dispatch(\"change\", {\n        detail: this._isShowing()\n      });\n    });\n    effect(this._hideControls.bind(this));\n    effect(() => {\n      const isFullscreen = fullscreen();\n\n      for (const side of [\"top\", \"right\", \"bottom\", \"left\"]) {\n        setStyle(el, `padding-${side}`, isFullscreen && `env(safe-area-inset-${side})`);\n      }\n    });\n  }\n\n  _hideControls() {\n    if (!this.el) return;\n\n    const {\n      controls\n    } = this._media.$state,\n          isHidden = controls() || this._media.$iosControls();\n\n    setAttribute(this.el, \"aria-hidden\", isHidden ? \"true\" : null);\n    setStyle(this.el, \"display\", isHidden ? \"none\" : null);\n  }\n\n  _watchHideDelay() {\n    const {\n      controls\n    } = this._media.player,\n          {\n      hideDelay\n    } = this.$props;\n    controls.defaultDelay = hideDelay();\n  }\n\n  _isShowing() {\n    const {\n      controlsVisible\n    } = this._media.$state;\n    return controlsVisible();\n  }\n\n}\n\nControls.props = {\n  hideDelay: 2e3\n};\n\nclass Popper extends ViewController {\n  constructor(_delegate) {\n    super();\n    this._delegate = _delegate;\n    this._showTimerId = -1;\n    this._hideRafId = -1;\n    this._stopAnimationEndListener = null;\n    effect(this._watchTrigger.bind(this));\n  }\n\n  onDestroy() {\n    this._stopAnimationEndListener?.();\n    this._stopAnimationEndListener = null;\n  }\n\n  _watchTrigger() {\n    const trigger = this._delegate._trigger();\n\n    if (!trigger) {\n      this.hide();\n      return;\n    }\n\n    const show = this.show.bind(this),\n          hide = this.hide.bind(this);\n\n    this._delegate._listen(trigger, show, hide);\n  }\n\n  show(trigger) {\n    window.cancelAnimationFrame(this._hideRafId);\n    this._hideRafId = -1;\n    this._stopAnimationEndListener?.();\n    this._stopAnimationEndListener = null;\n    this._showTimerId = window.setTimeout(() => {\n      this._showTimerId = -1;\n\n      const content = this._delegate._content();\n\n      if (content) content.style.removeProperty(\"display\");\n      peek(() => this._delegate._onChange(true, trigger));\n    }, this._delegate._showDelay?.() ?? 0);\n  }\n\n  hide(trigger) {\n    window.clearTimeout(this._showTimerId);\n    this._showTimerId = -1;\n    peek(() => this._delegate._onChange(false, trigger));\n    this._hideRafId = requestAnimationFrame(() => {\n      this._hideRafId = -1;\n\n      const content = this._delegate._content();\n\n      if (content) {\n        const isAnimated = hasAnimation(content);\n\n        const onHide = () => {\n          content.style.display = \"none\";\n          this._stopAnimationEndListener = null;\n        };\n\n        if (isAnimated) {\n          this._stopAnimationEndListener?.();\n          const stop = listenEvent(content, \"animationend\", onHide, {\n            once: true\n          });\n          this._stopAnimationEndListener = stop;\n        } else {\n          onHide();\n        }\n      }\n    });\n  }\n\n}\n\nconst tooltipContext = createContext();\nlet id = 0;\n\nclass Tooltip extends Component {\n  constructor() {\n    super();\n    this._id = `media-tooltip-${++id}`;\n    this._trigger = signal(null);\n    this._content = signal(null);\n    new FocusVisibleController();\n    const {\n      showDelay\n    } = this.$props;\n    new Popper({\n      _trigger: this._trigger,\n      _content: this._content,\n      _showDelay: showDelay,\n\n      _listen(trigger, show, hide) {\n        listenEvent(trigger, \"touchstart\", e => e.preventDefault(), {\n          passive: false\n        });\n        listenEvent(trigger, \"focus\", show);\n        listenEvent(trigger, \"blur\", hide);\n        listenEvent(trigger, \"mouseenter\", show);\n        listenEvent(trigger, \"mouseleave\", hide);\n      },\n\n      _onChange: this._onShowingChange.bind(this)\n    });\n  }\n\n  onAttach(el) {\n    el.style.setProperty(\"display\", \"contents\");\n  }\n\n  onSetup() {\n    provideContext(tooltipContext, {\n      _trigger: this._trigger,\n      _content: this._content,\n      _attachTrigger: this._attachTrigger.bind(this),\n      _detachTrigger: this._detachTrigger.bind(this),\n      _attachContent: this._attachContent.bind(this),\n      _detachContent: this._detachContent.bind(this)\n    });\n  }\n\n  _attachTrigger(el) {\n    this._trigger.set(el);\n\n    let tooltipName = el.getAttribute(\"data-media-tooltip\");\n\n    if (tooltipName) {\n      this.el?.setAttribute(`data-media-${tooltipName}-tooltip`, \"\");\n    }\n\n    setAttribute(el, \"data-describedby\", this._id);\n  }\n\n  _detachTrigger(el) {\n    el.removeAttribute(\"data-describedby\");\n    el.removeAttribute(\"aria-describedby\");\n\n    this._trigger.set(null);\n  }\n\n  _attachContent(el) {\n    el.setAttribute(\"id\", this._id);\n    el.style.display = \"none\";\n    setAttributeIfEmpty(el, \"role\", \"tooltip\");\n\n    this._content.set(el);\n  }\n\n  _detachContent(el) {\n    el.removeAttribute(\"id\");\n    el.removeAttribute(\"role\");\n\n    this._content.set(null);\n  }\n\n  _onShowingChange(isShowing) {\n    const trigger = this._trigger(),\n          content = this._content();\n\n    if (trigger) {\n      setAttribute(trigger, \"aria-describedby\", isShowing ? this._id : null);\n    }\n\n    for (const el of [this.el, trigger, content]) {\n      el && setAttribute(el, \"data-visible\", isShowing);\n    }\n  }\n\n}\n\nTooltip.props = {\n  showDelay: 500\n};\n\nclass TooltipContent extends Component {\n  constructor() {\n    super();\n    new FocusVisibleController();\n    const {\n      placement\n    } = this.$props;\n    this.setAttributes({\n      \"data-placement\": placement\n    });\n  }\n\n  onAttach(el) {\n    this._attach(el);\n\n    Object.assign(el.style, {\n      position: \"absolute\",\n      top: 0,\n      left: 0,\n      width: \"max-content\"\n    });\n  }\n\n  onConnect(el) {\n    this._attach(el);\n\n    const tooltip = useContext(tooltipContext);\n    onDispose(() => tooltip._detachContent(el));\n    onDispose(requestScopedAnimationFrame(() => {\n      if (!this.connectScope) return;\n      effect(this._watchPlacement.bind(this));\n    }));\n  }\n\n  _attach(el) {\n    const tooltip = useContext(tooltipContext);\n\n    tooltip._attachContent(el);\n  }\n\n  _watchPlacement() {\n    const {\n      placement,\n      offset: mainOffset,\n      alignOffset\n    } = this.$props;\n    return autoPlacement(this.el, this._getTrigger(), placement(), {\n      offsetVarName: \"media-tooltip\",\n      xOffset: alignOffset(),\n      yOffset: mainOffset()\n    });\n  }\n\n  _getTrigger() {\n    return useContext(tooltipContext)._trigger();\n  }\n\n}\n\nTooltipContent.props = {\n  placement: \"top center\",\n  offset: 0,\n  alignOffset: 0\n};\n\nclass ToggleButtonController extends ViewController {\n  constructor(_delegate) {\n    super();\n    this._delegate = _delegate;\n    new FocusVisibleController();\n\n    if (_delegate._keyShortcut) {\n      new ARIAKeyShortcuts(_delegate._keyShortcut);\n    }\n  }\n\n  onSetup() {\n    const {\n      disabled\n    } = this.$props;\n    this.setAttributes({\n      \"data-pressed\": this._delegate._isPressed,\n      \"aria-pressed\": this._isARIAPressed.bind(this),\n      \"aria-disabled\": () => disabled() ? \"true\" : null\n    });\n  }\n\n  onAttach(el) {\n    setAttributeIfEmpty(el, \"tabindex\", \"0\");\n    setAttributeIfEmpty(el, \"role\", \"button\");\n  }\n\n  onConnect(el) {\n    onPress(el, this._onMaybePress.bind(this));\n  }\n\n  _isARIAPressed() {\n    return ariaBool$1(this._delegate._isPressed());\n  }\n\n  _onPressed(event) {\n    if (isWriteSignal(this._delegate._isPressed)) {\n      this._delegate._isPressed.set(p => !p);\n    }\n  }\n\n  _onMaybePress(event) {\n    const disabled = this.$props.disabled() || this.el.hasAttribute(\"data-disabled\");\n\n    if (disabled) {\n      event.stopImmediatePropagation();\n      return;\n    }\n\n    event.preventDefault();\n\n    (this._delegate._onPress ?? this._onPressed).call(this, event);\n  }\n\n}\n\nToggleButtonController.props = {\n  disabled: false\n};\nvar __defProp$d = Object.defineProperty;\nvar __getOwnPropDesc$d = Object.getOwnPropertyDescriptor;\n\nvar __decorateClass$d = (decorators, target, key, kind) => {\n  var result = kind > 1 ? void 0 : kind ? __getOwnPropDesc$d(target, key) : target;\n\n  for (var i = decorators.length - 1, decorator; i >= 0; i--) if (decorator = decorators[i]) result = (kind ? decorator(target, key, result) : decorator(result)) || result;\n\n  if (kind && result) __defProp$d(target, key, result);\n  return result;\n};\n\nclass ToggleButton extends Component {\n  constructor() {\n    super();\n    this._pressed = signal(false);\n    new ToggleButtonController({\n      _isPressed: this._pressed\n    });\n  }\n\n  get pressed() {\n    return this._pressed();\n  }\n\n}\n\nToggleButton.props = {\n  disabled: false,\n  defaultPressed: false\n};\n\n__decorateClass$d([prop], ToggleButton.prototype, \"pressed\", 1);\n\nclass PlayButton extends Component {\n  constructor() {\n    super();\n    new ToggleButtonController({\n      _isPressed: this._isPressed.bind(this),\n      _keyShortcut: \"togglePaused\",\n      _onPress: this._onPress.bind(this)\n    });\n  }\n\n  onSetup() {\n    this._media = useMediaContext();\n    const {\n      paused,\n      ended\n    } = this._media.$state;\n    this.setAttributes({\n      \"data-paused\": paused,\n      \"data-ended\": ended\n    });\n  }\n\n  onAttach(el) {\n    el.setAttribute(\"data-media-tooltip\", \"play\");\n    setARIALabel(el, this._getLabel.bind(this));\n  }\n\n  _onPress(event) {\n    const remote = this._media.remote;\n    this._isPressed() ? remote.pause(event) : remote.play(event);\n  }\n\n  _isPressed() {\n    const {\n      paused\n    } = this._media.$state;\n    return !paused();\n  }\n\n  _getLabel() {\n    const {\n      paused\n    } = this._media.$state;\n    return paused() ? \"Play\" : \"Pause\";\n  }\n\n}\n\nPlayButton.props = ToggleButtonController.props;\n\nfunction ariaBool(value) {\n  return value ? \"true\" : \"false\";\n}\n\nfunction $ariaBool(signal) {\n  return () => ariaBool(signal());\n}\n\nclass CaptionButton extends Component {\n  constructor() {\n    super();\n    new ToggleButtonController({\n      _isPressed: this._isPressed.bind(this),\n      _keyShortcut: \"toggleCaptions\",\n      _onPress: this._onPress.bind(this)\n    });\n  }\n\n  onSetup() {\n    this._media = useMediaContext();\n    this.setAttributes({\n      \"data-active\": this._isPressed.bind(this),\n      \"data-supported\": () => !this._isHidden(),\n      \"aria-hidden\": $ariaBool(this._isHidden.bind(this))\n    });\n  }\n\n  onAttach(el) {\n    el.setAttribute(\"data-media-tooltip\", \"caption\");\n    setARIALabel(el, this._getLabel.bind(this));\n  }\n\n  _onPress(event) {\n    this._media.remote.toggleCaptions(event);\n  }\n\n  _isPressed() {\n    const {\n      textTrack\n    } = this._media.$state,\n          track = textTrack();\n    return !!track && isTrackCaptionKind(track);\n  }\n\n  _isHidden() {\n    const {\n      textTracks\n    } = this._media.$state;\n    return textTracks().filter(isTrackCaptionKind).length == 0;\n  }\n\n  _getLabel() {\n    const {\n      textTrack\n    } = this._media.$state;\n    return textTrack() ? \"Closed-Captions Off\" : \"Closed-Captions On\";\n  }\n\n}\n\nCaptionButton.props = ToggleButtonController.props;\n\nclass FullscreenButton extends Component {\n  constructor() {\n    super();\n    new ToggleButtonController({\n      _isPressed: this._isPressed.bind(this),\n      _keyShortcut: \"toggleFullscreen\",\n      _onPress: this._onPress.bind(this)\n    });\n  }\n\n  onSetup() {\n    this._media = useMediaContext();\n\n    const {\n      fullscreen\n    } = this._media.$state,\n          isSupported = this._isSupported.bind(this);\n\n    this.setAttributes({\n      \"data-active\": fullscreen,\n      \"data-supported\": isSupported,\n      \"aria-hidden\": $ariaBool(() => !isSupported())\n    });\n  }\n\n  onAttach(el) {\n    el.setAttribute(\"data-media-tooltip\", \"fullscreen\");\n    setARIALabel(el, this._getLabel.bind(this));\n  }\n\n  _onPress(event) {\n    const remote = this._media.remote,\n          target = this.$props.target();\n    this._isPressed() ? remote.exitFullscreen(target, event) : remote.enterFullscreen(target, event);\n  }\n\n  _isPressed() {\n    const {\n      fullscreen\n    } = this._media.$state;\n    return fullscreen();\n  }\n\n  _isSupported() {\n    const {\n      canFullscreen\n    } = this._media.$state;\n    return canFullscreen();\n  }\n\n  _getLabel() {\n    const {\n      fullscreen\n    } = this._media.$state;\n    return fullscreen() ? \"Exit Fullscreen\" : \"Enter Fullscreen\";\n  }\n\n}\n\nFullscreenButton.props = { ...ToggleButtonController.props,\n  target: \"prefer-media\"\n};\n\nclass MuteButton extends Component {\n  constructor() {\n    super();\n    new ToggleButtonController({\n      _isPressed: this._isPressed.bind(this),\n      _keyShortcut: \"toggleMuted\",\n      _onPress: this._onPress.bind(this)\n    });\n  }\n\n  onSetup() {\n    this._media = useMediaContext();\n    this.setAttributes({\n      \"data-muted\": this._isPressed.bind(this),\n      \"data-state\": this._getState.bind(this)\n    });\n  }\n\n  onAttach(el) {\n    el.setAttribute(\"data-media-mute-button\", \"\");\n    el.setAttribute(\"data-media-tooltip\", \"mute\");\n    setARIALabel(el, this._getLabel.bind(this));\n  }\n\n  _onPress(event) {\n    const remote = this._media.remote;\n    this._isPressed() ? remote.unmute(event) : remote.mute(event);\n  }\n\n  _isPressed() {\n    const {\n      muted,\n      volume\n    } = this._media.$state;\n    return muted() || volume() === 0;\n  }\n\n  _getLabel() {\n    return this._isPressed() ? \"Unmute\" : \"Mute\";\n  }\n\n  _getState() {\n    const {\n      muted,\n      volume\n    } = this._media.$state,\n          $volume = volume();\n    if (muted() || $volume === 0) return \"muted\";else if ($volume >= 0.5) return \"high\";else if ($volume < 0.5) return \"low\";\n  }\n\n}\n\nMuteButton.props = ToggleButtonController.props;\n\nclass PIPButton extends Component {\n  constructor() {\n    super();\n    new ToggleButtonController({\n      _isPressed: this._isPressed.bind(this),\n      _keyShortcut: \"togglePictureInPicture\",\n      _onPress: this._onPress.bind(this)\n    });\n  }\n\n  onSetup() {\n    this._media = useMediaContext();\n\n    const {\n      pictureInPicture\n    } = this._media.$state,\n          isSupported = this._isSupported.bind(this);\n\n    this.setAttributes({\n      \"data-active\": pictureInPicture,\n      \"data-supported\": isSupported,\n      \"aria-hidden\": $ariaBool(() => !isSupported())\n    });\n  }\n\n  onAttach(el) {\n    el.setAttribute(\"data-media-tooltip\", \"pip\");\n    setARIALabel(el, this._getLabel.bind(this));\n  }\n\n  _onPress(event) {\n    const remote = this._media.remote;\n    this._isPressed() ? remote.exitPictureInPicture(event) : remote.enterPictureInPicture(event);\n  }\n\n  _isPressed() {\n    const {\n      pictureInPicture\n    } = this._media.$state;\n    return pictureInPicture();\n  }\n\n  _isSupported() {\n    const {\n      canPictureInPicture\n    } = this._media.$state;\n    return canPictureInPicture();\n  }\n\n  _getLabel() {\n    const {\n      pictureInPicture\n    } = this._media.$state;\n    return pictureInPicture() ? \"Exit Picture In Picture\" : \"Enter Picture In Picture\";\n  }\n\n}\n\nPIPButton.props = ToggleButtonController.props;\n\nclass SeekButton extends Component {\n  constructor() {\n    super();\n    new FocusVisibleController();\n  }\n\n  onSetup() {\n    this._media = useMediaContext();\n\n    const {\n      seeking\n    } = this._media.$state,\n          {\n      seconds\n    } = this.$props,\n          isSupported = this._isSupported.bind(this);\n\n    this.setAttributes({\n      seconds,\n      \"data-seeking\": seeking,\n      \"data-supported\": isSupported,\n      \"aria-hidden\": $ariaBool(() => !isSupported())\n    });\n  }\n\n  onAttach(el) {\n    setAttributeIfEmpty(el, \"tabindex\", \"0\");\n    setAttributeIfEmpty(el, \"role\", \"button\");\n    el.setAttribute(\"data-media-tooltip\", \"seek\");\n    setARIALabel(el, this._getLabel.bind(this));\n  }\n\n  onConnect(el) {\n    onPress(el, this._onPress.bind(this));\n  }\n\n  _isSupported() {\n    const {\n      canSeek\n    } = this._media.$state;\n    return canSeek();\n  }\n\n  _getLabel() {\n    const {\n      seconds\n    } = this.$props;\n    return `Seek ${seconds() > 0 ? \"forward\" : \"backward\"} ${seconds()} seconds`;\n  }\n\n  _onPress(event) {\n    const {\n      seconds,\n      disabled\n    } = this.$props;\n    if (disabled()) return;\n    const {\n      currentTime\n    } = this._media.$state,\n          seekTo = currentTime() + seconds();\n\n    this._media.remote.seek(seekTo, event);\n  }\n\n}\n\nSeekButton.props = {\n  disabled: false,\n  seconds: 30\n};\n\nclass LiveButton extends Component {\n  constructor() {\n    super();\n    new FocusVisibleController();\n  }\n\n  onSetup() {\n    this._media = useMediaContext();\n\n    const {\n      disabled\n    } = this.$props,\n          {\n      live,\n      liveEdge\n    } = this._media.$state,\n          isHidden = () => !live();\n\n    this.setAttributes({\n      \"data-edge\": liveEdge,\n      \"data-hidden\": isHidden,\n      \"aria-disabled\": $ariaBool(disabled),\n      \"aria-hidden\": $ariaBool(isHidden)\n    });\n  }\n\n  onAttach(el) {\n    setAttributeIfEmpty(el, \"tabindex\", \"0\");\n    setAttributeIfEmpty(el, \"role\", \"button\");\n    el.setAttribute(\"data-media-tooltip\", \"live\");\n  }\n\n  onConnect(el) {\n    onPress(el, this._onPress.bind(this));\n  }\n\n  _onPress(event) {\n    const {\n      disabled\n    } = this.$props,\n          {\n      liveEdge\n    } = this._media.$state;\n    if (disabled() || liveEdge()) return;\n\n    this._media.remote.seekToLiveEdge(event);\n  }\n\n}\n\nLiveButton.props = {\n  disabled: false\n};\nconst sliderState = new State({\n  min: 0,\n  max: 100,\n  value: 0,\n  pointerValue: 0,\n  focused: false,\n  dragging: false,\n  pointing: false,\n\n  get active() {\n    return this.dragging || this.focused || this.pointing;\n  },\n\n  get fillRate() {\n    return calcRate(this.min, this.max, this.value);\n  },\n\n  get fillPercent() {\n    return this.fillRate * 100;\n  },\n\n  get pointerRate() {\n    return calcRate(this.min, this.max, this.pointerValue);\n  },\n\n  get pointerPercent() {\n    return this.pointerRate * 100;\n  }\n\n});\n\nfunction calcRate(min, max, value) {\n  const range = max - min,\n        offset = value - min;\n  return range > 0 ? offset / range : 0;\n}\n\nfunction getClampedValue(min, max, value, step) {\n  return clampNumber(min, round(value, getNumberOfDecimalPlaces(step)), max);\n}\n\nfunction getValueFromRate(min, max, rate, step) {\n  const boundRate = clampNumber(0, rate, 1),\n        range = max - min,\n        fill = range * boundRate,\n        stepRatio = fill / step,\n        steps = step * stepRatio;\n  return min + steps;\n}\n\nconst SliderKeyDirection = {\n  Left: -1,\n  ArrowLeft: -1,\n  Up: 1,\n  ArrowUp: 1,\n  Right: 1,\n  ArrowRight: 1,\n  Down: -1,\n  ArrowDown: -1\n};\n\nclass SliderEventsController extends ViewController {\n  constructor(_delegate, _media) {\n    super();\n    this._delegate = _delegate;\n    this._media = _media;\n    this._provider = null;\n    this._touchX = null;\n    this._touchStartValue = null;\n    this._onDocumentPointerMove = functionThrottle(event => {\n      this._updatePointerValue(this._getPointerValue(event), event);\n    }, 20, {\n      leading: true\n    });\n  }\n\n  onConnect() {\n    effect(this._attachEventListeners.bind(this));\n    effect(this._attachPointerListeners.bind(this));\n\n    if (this._delegate._swipeGesture) {\n      const provider = this._media.player.el?.querySelector(\"media-provider,[data-media-provider]\");\n\n      if (provider) {\n        this._provider = provider;\n        listenEvent(provider, \"touchstart\", this._onTouchStart.bind(this), {\n          passive: true\n        });\n        listenEvent(provider, \"touchmove\", this._onTouchMove.bind(this), {\n          passive: true\n        });\n      }\n    }\n  }\n\n  _onTouchStart(event) {\n    this._touchX = event.touches[0].clientX;\n  }\n\n  _onTouchMove(event) {\n    if (isNull(this._touchX)) return;\n    event.preventDefault();\n    if (this.$state.dragging()) return;\n    const diff = event.touches[0].clientX - this._touchX;\n\n    if (Math.abs(diff) > 20) {\n      this._touchX = event.touches[0].clientX;\n      this._touchStartValue = this.$state.value();\n\n      this._onStartDragging(this._touchStartValue, event);\n    }\n  }\n\n  _attachEventListeners() {\n    if (this._delegate._isDisabled()) return;\n    this.listen(\"focus\", this._onFocus.bind(this));\n    this.listen(\"pointerenter\", this._onPointerEnter.bind(this));\n    this.listen(\"pointermove\", this._onPointerMove.bind(this));\n    this.listen(\"pointerleave\", this._onPointerLeave.bind(this));\n    this.listen(\"pointerdown\", this._onPointerDown.bind(this));\n    this.listen(\"keydown\", this._onKeyDown.bind(this));\n    this.listen(\"keyup\", this._onKeyUp.bind(this));\n  }\n\n  _attachPointerListeners() {\n    if (this._delegate._isDisabled() || !this.$state.dragging()) return;\n    listenEvent(document, \"pointerup\", this._onDocumentPointerUp.bind(this));\n    listenEvent(document, \"pointermove\", this._onDocumentPointerMove.bind(this));\n\n    if (IS_SAFARI) {\n      listenEvent(document, \"touchmove\", this._onDocumentTouchMove.bind(this), {\n        passive: false\n      });\n    }\n  }\n\n  _onFocus() {\n    this._updatePointerValue(this.$state.value());\n  }\n\n  _updateValue(newValue, trigger) {\n    const {\n      value,\n      min,\n      max,\n      dragging\n    } = this.$state;\n    const clampedValue = Math.max(min(), Math.min(newValue, max()));\n    value.set(clampedValue);\n    const event = this.createEvent(\"value-change\", {\n      detail: clampedValue,\n      trigger\n    });\n    this.dispatch(event);\n    this._delegate._onValueChange?.(event);\n\n    if (dragging()) {\n      const event2 = this.createEvent(\"drag-value-change\", {\n        detail: clampedValue,\n        trigger\n      });\n      this.dispatch(event2);\n      this._delegate._onDragValueChange?.(event2);\n    }\n  }\n\n  _updatePointerValue(value, trigger) {\n    const {\n      pointerValue,\n      dragging\n    } = this.$state;\n    pointerValue.set(value);\n    this.dispatch(\"pointer-value-change\", {\n      detail: value,\n      trigger\n    });\n\n    if (dragging()) {\n      this._updateValue(value, trigger);\n    }\n  }\n\n  _getPointerValue(event) {\n    let thumbPositionRate,\n        rect = this.el.getBoundingClientRect(),\n        {\n      min,\n      max\n    } = this.$state;\n\n    if (this.$props.orientation() === \"vertical\") {\n      const {\n        bottom: trackBottom,\n        height: trackHeight\n      } = rect;\n      thumbPositionRate = (trackBottom - event.clientY) / trackHeight;\n    } else {\n      if (this._touchX && isNumber(this._touchStartValue)) {\n        const {\n          width\n        } = this._provider.getBoundingClientRect(),\n              rate = (event.clientX - this._touchX) / width,\n              range = max() - min(),\n              diff = range * Math.abs(rate);\n\n        thumbPositionRate = (rate < 0 ? this._touchStartValue - diff : this._touchStartValue + diff) / range;\n      } else {\n        const {\n          left: trackLeft,\n          width: trackWidth\n        } = rect;\n        thumbPositionRate = (event.clientX - trackLeft) / trackWidth;\n      }\n    }\n\n    return Math.max(min(), Math.min(max(), this._delegate._roundValue(getValueFromRate(min(), max(), thumbPositionRate, this._delegate._getStep()))));\n  }\n\n  _onPointerEnter(event) {\n    this.$state.pointing.set(true);\n  }\n\n  _onPointerMove(event) {\n    const {\n      dragging\n    } = this.$state;\n    if (dragging()) return;\n\n    this._updatePointerValue(this._getPointerValue(event), event);\n  }\n\n  _onPointerLeave(event) {\n    this.$state.pointing.set(false);\n  }\n\n  _onPointerDown(event) {\n    if (event.button !== 0) return;\n\n    const value = this._getPointerValue(event);\n\n    this._onStartDragging(value, event);\n\n    this._updatePointerValue(value, event);\n  }\n\n  _onStartDragging(value, trigger) {\n    const {\n      dragging\n    } = this.$state;\n    if (dragging()) return;\n    dragging.set(true);\n\n    this._media.remote.pauseControls(trigger);\n\n    const event = this.createEvent(\"drag-start\", {\n      detail: value,\n      trigger\n    });\n    this.dispatch(event);\n    this._delegate._onDragStart?.(event);\n  }\n\n  _onStopDragging(value, trigger) {\n    const {\n      dragging\n    } = this.$state;\n    if (!dragging()) return;\n    dragging.set(false);\n\n    this._media.remote.resumeControls(trigger);\n\n    const event = this.createEvent(\"drag-end\", {\n      detail: value,\n      trigger\n    });\n    this.dispatch(event);\n    this._delegate._onDragEnd?.(event);\n    this._touchX = null;\n    this._touchStartValue = null;\n  }\n\n  _onKeyDown(event) {\n    const {\n      key\n    } = event,\n          {\n      min,\n      max\n    } = this.$state;\n    let newValue;\n\n    if (key === \"Home\" || key === \"PageUp\") {\n      newValue = min();\n    } else if (key === \"End\" || key === \"PageDown\") {\n      newValue = max();\n    } else if (!event.metaKey && /[0-9]/.test(key)) {\n      newValue = (max() - min()) / 10 * Number(key);\n    }\n\n    if (!isUndefined(newValue)) {\n      this._updatePointerValue(newValue, event);\n\n      this._updateValue(newValue, event);\n\n      return;\n    }\n\n    const value = this._getKeyValue(event);\n\n    if (isUndefined(value)) return;\n    const repeat = key === this._lastDownKey;\n    if (!this.$state.dragging() && repeat) this._onStartDragging(value, event);\n\n    this._updatePointerValue(value, event);\n\n    if (!repeat) this._updateValue(value, event);\n    this._lastDownKey = key;\n  }\n\n  _onKeyUp(event) {\n    this._lastDownKey = \"\";\n    const {\n      dragging,\n      value\n    } = this.$state;\n    if (!dragging()) return;\n    const newValue = this._getKeyValue(event) ?? value();\n\n    this._updatePointerValue(newValue);\n\n    this._onStopDragging(newValue, event);\n  }\n\n  _getKeyValue(event) {\n    const {\n      key,\n      shiftKey\n    } = event,\n          isValidKey = Object.keys(SliderKeyDirection).includes(key);\n    if (!isValidKey) return;\n    event.preventDefault();\n    event.stopPropagation();\n    const {\n      shiftKeyMultiplier\n    } = this.$props;\n\n    const {\n      value,\n      min,\n      max\n    } = this.$state,\n          step = this._delegate._getStep(),\n          keyStep = this._delegate._getKeyStep();\n\n    const modifiedStep = !shiftKey ? keyStep : keyStep * shiftKeyMultiplier(),\n          direction = Number(SliderKeyDirection[key]),\n          diff = modifiedStep * direction,\n          steps = (value() + diff) / step;\n    return Math.max(min(), Math.min(max(), Number((step * steps).toFixed(3))));\n  } // -------------------------------------------------------------------------------------------\n  // Document (Pointer Events)\n  // -------------------------------------------------------------------------------------------\n\n\n  _onDocumentPointerUp(event) {\n    if (event.button !== 0) return;\n\n    const value = this._getPointerValue(event);\n\n    this._updatePointerValue(value, event);\n\n    this._onStopDragging(value, event);\n  }\n\n  _onDocumentTouchMove(event) {\n    event.preventDefault();\n  }\n\n}\n\nconst sliderValueFormatContext = createContext(() => ({}));\nconst sliderContext = createContext();\n\nclass SliderController extends ViewController {\n  constructor(_delegate) {\n    super();\n    this._delegate = _delegate;\n    this._updateSliderVars = animationFrameThrottle((fillPercent, pointerPercent) => {\n      this.el?.style.setProperty(\"--slider-fill\", fillPercent + \"%\");\n      this.el?.style.setProperty(\"--slider-pointer\", pointerPercent + \"%\");\n    });\n  }\n\n  onSetup() {\n    this._media = useMediaContext();\n    const focus = new FocusVisibleController();\n    focus.attach(this);\n    this.$state.focused = focus.focused.bind(focus);\n\n    if (!hasProvidedContext(sliderValueFormatContext)) {\n      provideContext(sliderValueFormatContext, {\n        default: \"value\"\n      });\n    }\n\n    provideContext(sliderContext, {\n      _orientation: this.$props.orientation,\n      _disabled: this._delegate._isDisabled,\n      _preview: signal(null)\n    });\n    effect(this._watchValue.bind(this));\n    effect(this._watchDisabled.bind(this));\n\n    this._setupAttrs();\n\n    new SliderEventsController(this._delegate, this._media).attach(this);\n  }\n\n  onAttach(el) {\n    setAttributeIfEmpty(el, \"role\", \"slider\");\n    setAttributeIfEmpty(el, \"tabindex\", \"0\");\n    setAttributeIfEmpty(el, \"autocomplete\", \"off\");\n    effect(this._watchCSSVars.bind(this));\n  } // -------------------------------------------------------------------------------------------\n  // Watch\n  // -------------------------------------------------------------------------------------------\n\n\n  _watchValue() {\n    const {\n      dragging,\n      value,\n      min,\n      max\n    } = this.$state;\n    if (peek(dragging)) return;\n    value.set(getClampedValue(min(), max(), value(), this._delegate._getStep()));\n  }\n\n  _watchDisabled() {\n    if (!this._delegate._isDisabled()) return;\n    const {\n      dragging,\n      pointing\n    } = this.$state;\n    dragging.set(false);\n    pointing.set(false);\n  } // -------------------------------------------------------------------------------------------\n  // ARIA\n  // -------------------------------------------------------------------------------------------\n\n\n  _getARIADisabled() {\n    return ariaBool$1(this._delegate._isDisabled());\n  } // -------------------------------------------------------------------------------------------\n  // Attributes\n  // -------------------------------------------------------------------------------------------\n\n\n  _setupAttrs() {\n    const {\n      orientation\n    } = this.$props,\n          {\n      dragging,\n      active,\n      pointing\n    } = this.$state;\n    this.setAttributes({\n      \"data-dragging\": dragging,\n      \"data-pointing\": pointing,\n      \"data-active\": active,\n      \"aria-disabled\": this._getARIADisabled.bind(this),\n      \"aria-valuemin\": this.$state.min,\n      \"aria-valuemax\": this.$state.max,\n      \"aria-valuenow\": this._delegate._getARIAValueNow,\n      \"aria-valuetext\": this._delegate._getARIAValueText,\n      \"aria-orientation\": orientation\n    });\n  }\n\n  _watchCSSVars() {\n    const {\n      fillPercent,\n      pointerPercent\n    } = this.$state;\n\n    this._updateSliderVars(round(fillPercent(), 3), round(pointerPercent(), 3));\n  }\n\n}\n\nSliderController.props = {\n  disabled: false,\n  step: 1,\n  keyStep: 1,\n  orientation: \"horizontal\",\n  shiftKeyMultiplier: 5\n};\n\nclass Slider extends Component {\n  constructor() {\n    super();\n    new SliderController({\n      _getStep: this.$props.step,\n      _getKeyStep: this.$props.keyStep,\n      _roundValue: Math.round,\n      _isDisabled: this.$props.disabled,\n      _getARIAValueNow: this._getARIAValueNow.bind(this),\n      _getARIAValueText: this._getARIAValueText.bind(this)\n    });\n  }\n\n  onSetup() {\n    effect(this._watchMinMax.bind(this));\n  } // -------------------------------------------------------------------------------------------\n  // Props\n  // -------------------------------------------------------------------------------------------\n\n\n  _getARIAValueNow() {\n    const {\n      value\n    } = this.$state;\n    return Math.round(value());\n  }\n\n  _getARIAValueText() {\n    const {\n      value,\n      max\n    } = this.$state;\n    return round(value() / max() * 100, 2) + \"%\";\n  } // -------------------------------------------------------------------------------------------\n  // Watch\n  // -------------------------------------------------------------------------------------------\n\n\n  _watchMinMax() {\n    const {\n      min,\n      max\n    } = this.$props;\n    this.$state.min.set(min());\n    this.$state.max.set(max());\n  }\n\n}\n\nSlider.props = { ...SliderController.props,\n  min: 0,\n  max: 100,\n  value: 0\n};\nSlider.state = sliderState;\nconst cache = /* @__PURE__ */new Map(),\n      pending = /* @__PURE__ */new Set(),\n      registry = /* @__PURE__ */new Set();\n\nclass ThumbnailsLoader {\n  constructor($src, _media) {\n    this.$src = $src;\n    this._media = _media;\n    this.$cues = signal([]);\n    effect(this._onLoadCues.bind(this));\n    registry.add(this);\n    onDispose(() => registry.delete(this));\n  }\n\n  static create(src) {\n    const media = useMediaContext();\n    return new ThumbnailsLoader(src, media);\n  }\n\n  _onLoadCues() {\n    const {\n      canLoad\n    } = this._media.$state;\n    if (!canLoad()) return;\n    const controller = new AbortController(),\n          {\n      crossorigin\n    } = this._media.$state;\n    const src = this.$src();\n    if (!src) return;\n\n    if (cache.has(src)) {\n      const cues = cache.get(src);\n      cache.delete(src);\n      cache.set(src, cues);\n\n      if (cache.size > 30) {\n        const firstKey = cache.keys().next().value;\n        cache.delete(firstKey);\n      }\n\n      this.$cues.set(cache.get(src));\n    } else if (!pending.has(src)) {\n      pending.add(src);\n      import('media-captions').then(({\n        parseResponse\n      }) => {\n        parseResponse(fetch(src, {\n          signal: controller.signal,\n          credentials: getRequestCredentials(crossorigin())\n        })).then(({\n          cues\n        }) => {\n          this.$cues.set(cues);\n\n          for (const t of registry) {\n            if (peek(t.$src) === src) t.$cues.set(cues);\n          }\n\n          cache.set(src, cues);\n          pending.delete(src);\n        }).catch(noop);\n      });\n    }\n\n    return () => {\n      controller.abort();\n      this.$cues.set([]);\n    };\n  }\n\n}\n\nclass Thumbnail extends Component {\n  constructor() {\n    super(...arguments);\n    this._styleResets = [];\n    this._requestResize = animationFrameThrottle(this._resize.bind(this));\n  }\n\n  onSetup() {\n    this._media = useMediaContext();\n    this._thumbnails = ThumbnailsLoader.create(this.$props.src);\n    this.setAttributes({\n      \"data-loading\": this._isLoading.bind(this),\n      \"data-error\": this._hasError.bind(this),\n      \"data-hidden\": this.$state.hidden,\n      \"aria-hidden\": $ariaBool(this.$state.hidden)\n    });\n  }\n\n  onConnect(el) {\n    effect(this._watchImg.bind(this));\n    effect(this._watchHidden.bind(this));\n    effect(this._onLoadStart.bind(this));\n    effect(this._onFindActiveCue.bind(this));\n    effect(this._onResolveThumbnail.bind(this));\n  }\n\n  _watchImg() {\n    const img = this.$state.img();\n    if (!img) return;\n    listenEvent(img, \"load\", this._onLoaded.bind(this));\n    listenEvent(img, \"error\", this._onError.bind(this));\n  }\n\n  _onLoadStart() {\n    const {\n      src,\n      loading,\n      error\n    } = this.$state;\n    src();\n    loading.set(true);\n    error.set(null);\n  }\n\n  _onLoaded() {\n    const {\n      loading,\n      error\n    } = this.$state;\n    loading.set(false);\n    error.set(null);\n\n    this._requestResize();\n  }\n\n  _onError(event) {\n    const {\n      loading,\n      error\n    } = this.$state;\n    loading.set(false);\n    error.set(event);\n  }\n\n  _isLoading() {\n    const {\n      loading,\n      hidden\n    } = this.$state;\n    return !hidden() && loading();\n  }\n\n  _hasError() {\n    const {\n      error\n    } = this.$state;\n    return !isNull(error());\n  }\n\n  _watchHidden() {\n    const {\n      hidden\n    } = this.$state,\n          {\n      duration\n    } = this._media.$state,\n          cues = this._thumbnails.$cues();\n\n    hidden.set(this._hasError() || !Number.isFinite(duration()) || cues.length === 0);\n  }\n\n  _getTime() {\n    return this.$props.time();\n  }\n\n  _onFindActiveCue() {\n    const time = this._getTime(),\n          {\n      activeCue\n    } = this.$state,\n          {\n      duration\n    } = this._media.$state,\n          cues = this._thumbnails.$cues();\n\n    if (!cues || !Number.isFinite(duration())) {\n      activeCue.set(null);\n      return;\n    }\n\n    activeCue.set(findActiveCue(cues, time));\n  }\n\n  _onResolveThumbnail() {\n    const {\n      activeCue\n    } = this.$state,\n          cue = activeCue(),\n          baseURL = peek(this.$props.src);\n\n    if (!baseURL || !cue) {\n      this.$state.src.set(\"\");\n\n      this._resetStyles();\n\n      return;\n    }\n\n    const [src, coords = \"\"] = (cue.text || \"\").split(\"#\");\n    this.$state.coords.set(this._resolveThumbnailCoords(coords));\n\n    if (!peek(this.$state.coords)) {\n      this._resetStyles();\n\n      return;\n    }\n\n    this.$state.src.set(this._resolveThumbnailSrc(src, baseURL));\n\n    this._requestResize();\n  }\n\n  _resolveThumbnailSrc(src, baseURL) {\n    return /^https?:/.test(src) ? src : new URL(src, baseURL).href;\n  }\n\n  _resolveThumbnailCoords(coords) {\n    const [props, values] = coords.split(\"=\"),\n          resolvedCoords = {},\n          coordValues = values?.split(\",\");\n    if (!props || !values) return null;\n\n    for (let i = 0; i < props.length; i++) resolvedCoords[props[i]] = +coordValues[i];\n\n    return resolvedCoords;\n  }\n\n  _resize() {\n    if (!this.scope) return;\n    const img = this.$state.img(),\n          coords = this.$state.coords();\n    if (!img || !coords || !this.el) return;\n    const {\n      w,\n      h,\n      x,\n      y\n    } = coords,\n          {\n      maxWidth,\n      maxHeight,\n      minWidth,\n      minHeight\n    } = getComputedStyle(this.el),\n          minRatio = Math.max(parseInt(minWidth) / w, parseInt(minHeight) / h),\n          maxRatio = Math.min(parseInt(maxWidth) / w, parseInt(maxHeight) / h),\n          scale = maxRatio < 1 ? maxRatio : minRatio > 1 ? minRatio : 1;\n\n    this._style(this.el, \"--thumbnail-width\", `${w * scale}px`);\n\n    this._style(this.el, \"--thumbnail-height\", `${h * scale}px`);\n\n    this._style(img, \"width\", `${img.naturalWidth * scale}px`);\n\n    this._style(img, \"height\", `${img.naturalHeight * scale}px`);\n\n    this._style(img, \"transform\", `translate(-${x * scale}px, -${y * scale}px)`);\n\n    this._style(img, \"max-width\", \"none\");\n  }\n\n  _style(el, name, value) {\n    el.style.setProperty(name, value);\n\n    this._styleResets.push(() => el.style.removeProperty(name));\n  }\n\n  _resetStyles() {\n    for (const reset of this._styleResets) reset();\n\n    this._styleResets = [];\n  }\n\n}\n\nThumbnail.props = {\n  src: \"\",\n  time: 0\n};\nThumbnail.state = new State({\n  src: \"\",\n  img: null,\n  coords: null,\n  activeCue: null,\n  loading: false,\n  error: null,\n  hidden: false\n});\nvar __defProp$c = Object.defineProperty;\nvar __getOwnPropDesc$c = Object.getOwnPropertyDescriptor;\n\nvar __decorateClass$c = (decorators, target, key, kind) => {\n  var result = kind > 1 ? void 0 : kind ? __getOwnPropDesc$c(target, key) : target;\n\n  for (var i = decorators.length - 1, decorator; i >= 0; i--) if (decorator = decorators[i]) result = (kind ? decorator(target, key, result) : decorator(result)) || result;\n\n  if (kind && result) __defProp$c(target, key, result);\n  return result;\n};\n\nclass SliderVideo extends Component {\n  get video() {\n    return this.$state.video();\n  }\n\n  onSetup() {\n    this._media = useMediaContext();\n    this._slider = useState(Slider.state);\n    this.setAttributes({\n      \"data-loading\": this._isLoading.bind(this),\n      \"data-hidden\": this.$state.hidden,\n      \"data-error\": this._hasError.bind(this),\n      \"aria-hidden\": $ariaBool(this.$state.hidden)\n    });\n  }\n\n  onAttach(el) {\n    effect(this._watchVideo.bind(this));\n    effect(this._watchSrc.bind(this));\n    effect(this._watchHidden.bind(this));\n    effect(this._onSrcChange.bind(this));\n    effect(this._onUpdateTime.bind(this));\n  }\n\n  _watchVideo() {\n    const video = this.$state.video();\n    if (!video) return;\n    if (video.readyState >= 2) this._onCanPlay();\n    listenEvent(video, \"canplay\", this._onCanPlay.bind(this));\n    listenEvent(video, \"error\", this._onError.bind(this));\n  }\n\n  _watchSrc() {\n    const {\n      src\n    } = this.$state,\n          {\n      canLoad\n    } = this._media.$state;\n    src.set(canLoad() ? this.$props.src() : null);\n  }\n\n  _isLoading() {\n    const {\n      canPlay,\n      hidden\n    } = this.$state;\n    return !canPlay() && !hidden();\n  }\n\n  _hasError() {\n    const {\n      error\n    } = this.$state;\n    return !isNull(error);\n  }\n\n  _watchHidden() {\n    const {\n      src,\n      hidden\n    } = this.$state,\n          {\n      canLoad,\n      duration\n    } = this._media.$state;\n    hidden.set(canLoad() && (!src() || this._hasError() || !Number.isFinite(duration())));\n  }\n\n  _onSrcChange() {\n    const {\n      src,\n      canPlay,\n      error\n    } = this.$state;\n    src();\n    canPlay.set(false);\n    error.set(null);\n  }\n\n  _onCanPlay(event) {\n    const {\n      canPlay,\n      error\n    } = this.$state;\n    canPlay.set(true);\n    error.set(null);\n    this.dispatch(\"can-play\", {\n      trigger: event\n    });\n  }\n\n  _onError(event) {\n    const {\n      canPlay,\n      error\n    } = this.$state;\n    canPlay.set(false);\n    error.set(event);\n    this.dispatch(\"error\", {\n      trigger: event\n    });\n  }\n\n  _onUpdateTime() {\n    const {\n      video,\n      canPlay\n    } = this.$state,\n          {\n      duration\n    } = this._media.$state,\n          {\n      pointerRate\n    } = this._slider,\n          media = video(),\n          canUpdate = canPlay() && media && Number.isFinite(duration()) && Number.isFinite(pointerRate());\n\n    if (canUpdate) {\n      media.currentTime = pointerRate() * duration();\n    }\n  }\n\n}\n\nSliderVideo.props = {\n  src: null\n};\nSliderVideo.state = new State({\n  video: null,\n  src: null,\n  canPlay: false,\n  error: null,\n  hidden: false\n});\n\n__decorateClass$c([prop], SliderVideo.prototype, \"video\", 1);\n\nfunction padNumberWithZeroes(num, expectedLength) {\n  const str = String(num);\n  const actualLength = str.length;\n  const shouldPad = actualLength < expectedLength;\n\n  if (shouldPad) {\n    const padLength = expectedLength - actualLength;\n    const padding = `0`.repeat(padLength);\n    return `${padding}${num}`;\n  }\n\n  return str;\n}\n\nfunction parseTime(duration) {\n  const hours = Math.trunc(duration / 3600);\n  const minutes = Math.trunc(duration % 3600 / 60);\n  const seconds = Math.trunc(duration % 60);\n  const fraction = Number((duration - Math.trunc(duration)).toPrecision(3));\n  return {\n    hours,\n    minutes,\n    seconds,\n    fraction\n  };\n}\n\nfunction formatTime(duration, shouldPadHours = null, shouldPadMinutes = null, shouldAlwaysShowHours = false) {\n  const {\n    hours,\n    minutes,\n    seconds\n  } = parseTime(duration),\n        paddedHours = shouldPadHours ? padNumberWithZeroes(hours, 2) : hours,\n        paddedMinutes = shouldPadMinutes || isNull(shouldPadMinutes) && duration >= 3600 ? padNumberWithZeroes(minutes, 2) : minutes,\n        paddedSeconds = padNumberWithZeroes(seconds, 2);\n\n  if (hours > 0 || shouldAlwaysShowHours) {\n    return `${paddedHours}:${paddedMinutes}:${paddedSeconds}`;\n  }\n\n  return `${paddedMinutes}:${paddedSeconds}`;\n}\n\nfunction formatSpokenTime(duration) {\n  const spokenParts = [];\n  const {\n    hours,\n    minutes,\n    seconds\n  } = parseTime(duration);\n\n  if (hours > 0) {\n    spokenParts.push(`${hours} hour`);\n  }\n\n  if (minutes > 0) {\n    spokenParts.push(`${minutes} min`);\n  }\n\n  if (seconds > 0 || spokenParts.length === 0) {\n    spokenParts.push(`${seconds} sec`);\n  }\n\n  return spokenParts.join(\" \");\n}\n\nvar __defProp$b = Object.defineProperty;\nvar __getOwnPropDesc$b = Object.getOwnPropertyDescriptor;\n\nvar __decorateClass$b = (decorators, target, key, kind) => {\n  var result = kind > 1 ? void 0 : kind ? __getOwnPropDesc$b(target, key) : target;\n\n  for (var i = decorators.length - 1, decorator; i >= 0; i--) if (decorator = decorators[i]) result = (kind ? decorator(target, key, result) : decorator(result)) || result;\n\n  if (kind && result) __defProp$b(target, key, result);\n  return result;\n};\n\nclass SliderValue extends Component {\n  onSetup() {\n    this._slider = useState(Slider.state);\n    this._format = useContext(sliderValueFormatContext);\n    this._text = computed(this.getValueText.bind(this));\n  }\n\n  getValueText() {\n    const {\n      type,\n      format,\n      decimalPlaces,\n      padHours,\n      padMinutes,\n      showHours\n    } = this.$props,\n          {\n      value: sliderValue,\n      pointerValue,\n      min,\n      max\n    } = this._slider,\n          _format = format() ?? this._format.default;\n\n    const value = type() === \"current\" ? sliderValue() : pointerValue();\n\n    if (_format === \"percent\") {\n      const range = max() - min();\n      const percent = value / range * 100;\n      return (this._format.percent ?? round)(percent, decimalPlaces()) + \"\\uFE6A\";\n    } else if (_format === \"time\") {\n      return (this._format.time ?? formatTime)(value, padHours(), padMinutes(), showHours());\n    } else {\n      return this._format.value?.(value) ?? value.toFixed(2);\n    }\n  }\n\n}\n\nSliderValue.props = {\n  type: \"pointer\",\n  format: null,\n  showHours: false,\n  padHours: null,\n  padMinutes: null,\n  decimalPlaces: 2\n};\n\n__decorateClass$b([method], SliderValue.prototype, \"getValueText\", 1);\n\nclass SliderPreview extends Component {\n  onSetup() {\n    this._slider = useContext(sliderContext);\n    const {\n      active\n    } = useState(Slider.state);\n    this.setAttributes({\n      \"data-visible\": active\n    });\n  }\n\n  onAttach(el) {\n    Object.assign(el.style, {\n      position: \"absolute\",\n      top: 0,\n      left: 0,\n      width: \"max-content\"\n    });\n  }\n\n  onConnect(el) {\n    const {\n      _preview\n    } = this._slider;\n\n    _preview.set(el);\n\n    onDispose(() => _preview.set(null));\n    effect(this._updatePlacement.bind(this));\n    const resize = new ResizeObserver(this._updatePlacement.bind(this));\n    resize.observe(el);\n    onDispose(() => resize.disconnect());\n  }\n\n  _updatePlacement() {\n    const {\n      _disabled,\n      _orientation\n    } = this._slider;\n    if (_disabled()) return;\n    const el = this.el,\n          {\n      offset,\n      noClamp\n    } = this.$props;\n    updateSliderPreviewPlacement(el, {\n      clamp: !noClamp(),\n      offset: offset(),\n      orientation: _orientation()\n    });\n  }\n\n}\n\nSliderPreview.props = {\n  offset: 0,\n  noClamp: false\n};\n\nfunction updateSliderPreviewPlacement(el, {\n  clamp,\n  offset,\n  orientation\n}) {\n  const {\n    width,\n    height\n  } = el.getBoundingClientRect(),\n        styles = {\n    top: null,\n    right: null,\n    bottom: null,\n    left: null\n  };\n  styles[orientation === \"horizontal\" ? \"bottom\" : \"left\"] = `calc(100% + var(--media-slider-preview-offset, ${offset}px))`;\n\n  if (orientation === \"horizontal\") {\n    const widthHalf = width / 2;\n\n    if (!clamp) {\n      styles.left = `calc(var(--slider-pointer) - ${widthHalf}px)`;\n    } else {\n      const leftClamp = `max(0px, calc(var(--slider-pointer) - ${widthHalf}px))`,\n            rightClamp = `calc(100% - ${width}px)`;\n      styles.left = `min(${leftClamp}, ${rightClamp})`;\n    }\n  } else {\n    const heightHalf = height / 2;\n\n    if (!clamp) {\n      styles.bottom = `calc(var(--slider-pointer) - ${heightHalf}px)`;\n    } else {\n      const topClamp = `max(${heightHalf}px, calc(var(--slider-pointer) - ${heightHalf}px))`,\n            bottomClamp = `calc(100% - ${height}px)`;\n      styles.bottom = `min(${topClamp}, ${bottomClamp})`;\n    }\n  }\n\n  Object.assign(el.style, styles);\n}\n\nclass VolumeSlider extends Component {\n  constructor() {\n    super(...arguments);\n    this._throttleVolumeChange = functionThrottle(this._onVolumeChange.bind(this), 25);\n  }\n\n  onSetup() {\n    this._media = useMediaContext();\n    provideContext(sliderValueFormatContext, {\n      default: \"percent\"\n    });\n    new SliderController({\n      _getStep: this.$props.step,\n      _getKeyStep: this.$props.keyStep,\n      _isDisabled: this.$props.disabled,\n      _roundValue: Math.round,\n      _getARIAValueNow: this._getARIAValueNow.bind(this),\n      _getARIAValueText: this._getARIAValueText.bind(this),\n      _onDragValueChange: this._onDragValueChange.bind(this),\n      _onValueChange: this._onValueChange.bind(this)\n    }).attach(this);\n    effect(this._watchVolume.bind(this));\n  }\n\n  onAttach(el) {\n    el.setAttribute(\"data-media-volume-slider\", \"\");\n    setAttributeIfEmpty(el, \"aria-label\", \"Volume\");\n    const {\n      canSetVolume\n    } = this._media.$state;\n    this.setAttributes({\n      \"data-supported\": canSetVolume,\n      \"aria-hidden\": $ariaBool(() => !canSetVolume())\n    });\n  }\n\n  _getARIAValueNow() {\n    const {\n      value\n    } = this.$state;\n    return Math.round(value());\n  }\n\n  _getARIAValueText() {\n    const {\n      value,\n      max\n    } = this.$state;\n    return round(value() / max() * 100, 2) + \"%\";\n  }\n\n  _watchVolume() {\n    const {\n      muted,\n      volume\n    } = this._media.$state;\n    const newValue = muted() ? 0 : volume() * 100;\n    this.$state.value.set(newValue);\n    this.dispatch(\"value-change\", {\n      detail: newValue\n    });\n  }\n\n  _onVolumeChange(event) {\n    if (!event.trigger) return;\n    const mediaVolume = round(event.detail / 100, 3);\n\n    this._media.remote.changeVolume(mediaVolume, event);\n  }\n\n  _onValueChange(event) {\n    this._throttleVolumeChange(event);\n  }\n\n  _onDragValueChange(event) {\n    this._throttleVolumeChange(event);\n  }\n\n}\n\nVolumeSlider.props = { ...SliderController.props,\n  keyStep: 5,\n  shiftKeyMultiplier: 2\n};\nVolumeSlider.state = sliderState;\n\nclass TimeSlider extends Component {\n  constructor() {\n    super();\n    this._chapter = signal(null);\n    this._playingBeforeDragStart = false;\n    new SliderController({\n      _swipeGesture: true,\n      _getStep: this._getStep.bind(this),\n      _getKeyStep: this._getKeyStep.bind(this),\n      _isDisabled: this._isDisabled.bind(this),\n      _roundValue: this._roundValue,\n      _getARIAValueNow: this._getARIAValueNow.bind(this),\n      _getARIAValueText: this._getARIAValueText.bind(this),\n      _onDragStart: this._onDragStart.bind(this),\n      _onDragValueChange: this._onDragValueChange.bind(this),\n      _onDragEnd: this._onDragEnd.bind(this),\n      _onValueChange: this._onValueChange.bind(this)\n    });\n  }\n\n  onSetup() {\n    this._media = useMediaContext();\n    provideContext(sliderValueFormatContext, {\n      default: \"time\",\n      value: this._formatValue.bind(this),\n      time: this._formatTime.bind(this)\n    });\n    this.setAttributes({\n      \"data-chapters\": this._hasChapters.bind(this)\n    });\n    this.setStyles({\n      \"--slider-progress\": this._calcBufferedPercent.bind(this)\n    });\n    effect(this._watchCurrentTime.bind(this));\n    effect(this._watchSeekingThrottle.bind(this));\n  }\n\n  onAttach(el) {\n    el.setAttribute(\"data-media-time-slider\", \"\");\n    setAttributeIfEmpty(el, \"aria-label\", \"Seek\");\n  }\n\n  onConnect(el) {\n    effect(this._watchPreviewing.bind(this));\n    observeActiveTextTrack(this._media.textTracks, \"chapters\", this._chapter.set);\n  }\n\n  _calcBufferedPercent() {\n    const {\n      bufferedEnd,\n      duration\n    } = this._media.$state;\n    return round(Math.min(bufferedEnd() / Math.max(duration(), 1), 1) * 100, 3) + \"%\";\n  }\n\n  _hasChapters() {\n    const {\n      duration\n    } = this._media.$state;\n    return this._chapter()?.cues.length && Number.isFinite(duration()) && duration() > 0;\n  }\n\n  _watchSeekingThrottle() {\n    this._dispatchSeeking = functionThrottle(this._seeking.bind(this), this.$props.seekingRequestThrottle());\n  }\n\n  _watchCurrentTime() {\n    const {\n      currentTime\n    } = this._media.$state,\n          {\n      value,\n      dragging\n    } = this.$state,\n          newValue = this._timeToPercent(currentTime());\n\n    if (!peek(dragging)) {\n      value.set(newValue);\n      this.dispatch(\"value-change\", {\n        detail: newValue\n      });\n    }\n  }\n\n  _watchPreviewing() {\n    const player = this._media.player.el,\n          {\n      _preview\n    } = useContext(sliderContext);\n    player && _preview() && setAttribute(player, \"data-preview\", this.$state.active());\n  }\n\n  _seeking(time, event) {\n    this._media.remote.seeking(time, event);\n  }\n\n  _seek(time, percent, event) {\n    this._dispatchSeeking.cancel();\n\n    const {\n      live\n    } = this._media.$state;\n\n    if (live() && percent >= 99) {\n      this._media.remote.seekToLiveEdge(event);\n\n      return;\n    }\n\n    this._media.remote.seek(time, event);\n  }\n\n  _onDragStart(event) {\n    const {\n      pauseWhileDragging\n    } = this.$props;\n\n    if (pauseWhileDragging()) {\n      const {\n        paused\n      } = this._media.$state;\n      this._playingBeforeDragStart = !paused();\n\n      this._media.remote.pause(event);\n    }\n  }\n\n  _onDragValueChange(event) {\n    this._dispatchSeeking(this._percentToTime(event.detail), event);\n  }\n\n  _onDragEnd(event) {\n    const percent = event.detail;\n\n    this._seek(this._percentToTime(percent), percent, event);\n\n    const {\n      pauseWhileDragging\n    } = this.$props;\n\n    if (pauseWhileDragging() && this._playingBeforeDragStart) {\n      this._media.remote.play(event);\n\n      this._playingBeforeDragStart = false;\n    }\n  }\n\n  _onValueChange(event) {\n    const {\n      dragging\n    } = this.$state;\n    if (dragging() || !event.trigger) return;\n\n    this._onDragEnd(event);\n  } // -------------------------------------------------------------------------------------------\n  // Props\n  // -------------------------------------------------------------------------------------------\n\n\n  _getStep() {\n    const value = this.$props.step() / this._media.$state.duration() * 100;\n    return Number.isFinite(value) ? value : 1;\n  }\n\n  _getKeyStep() {\n    const value = this.$props.keyStep() / this._media.$state.duration() * 100;\n    return Number.isFinite(value) ? value : 1;\n  }\n\n  _roundValue(value) {\n    return round(value, 3);\n  }\n\n  _isDisabled() {\n    const {\n      canSeek\n    } = this._media.$state;\n    return this.$props.disabled() || !canSeek();\n  } // -------------------------------------------------------------------------------------------\n  // ARIA\n  // -------------------------------------------------------------------------------------------\n\n\n  _getARIAValueNow() {\n    const {\n      value\n    } = this.$state;\n    return Math.round(value());\n  }\n\n  _getARIAValueText() {\n    const time = this._percentToTime(this.$state.value()),\n          {\n      duration\n    } = this._media.$state;\n\n    return Number.isFinite(time) ? `${formatSpokenTime(time)} out of ${formatSpokenTime(duration())}` : \"live\";\n  } // -------------------------------------------------------------------------------------------\n  // Format\n  // -------------------------------------------------------------------------------------------\n\n\n  _percentToTime(percent) {\n    const {\n      duration\n    } = this._media.$state;\n    return Math.round(percent / 100 * duration());\n  }\n\n  _timeToPercent(time) {\n    const {\n      liveEdge,\n      duration\n    } = this._media.$state,\n          rate = Math.max(0, Math.min(1, liveEdge() ? 1 : Math.min(time, duration()) / duration()));\n    return Number.isNaN(rate) ? 0 : Number.isFinite(rate) ? rate * 100 : 100;\n  }\n\n  _formatValue(percent) {\n    const time = this._percentToTime(percent),\n          {\n      live,\n      duration\n    } = this._media.$state;\n\n    return Number.isFinite(time) ? (live() ? time - duration() : time).toFixed(0) : \"LIVE\";\n  }\n\n  _formatTime(percent, padHours, padMinutes, showHours) {\n    const time = this._percentToTime(percent),\n          {\n      live,\n      duration\n    } = this._media.$state,\n          value = live() ? time - duration() : time;\n\n    return Number.isFinite(time) ? `${value < 0 ? \"-\" : \"\"}${formatTime(Math.abs(value), padHours, padMinutes, showHours)}` : \"LIVE\";\n  }\n\n}\n\nTimeSlider.props = { ...SliderController.props,\n  step: 0.1,\n  keyStep: 5,\n  shiftKeyMultiplier: 2,\n  pauseWhileDragging: false,\n  seekingRequestThrottle: 100\n};\nTimeSlider.state = sliderState;\nvar __defProp$a = Object.defineProperty;\nvar __getOwnPropDesc$a = Object.getOwnPropertyDescriptor;\n\nvar __decorateClass$a = (decorators, target, key, kind) => {\n  var result = kind > 1 ? void 0 : kind ? __getOwnPropDesc$a(target, key) : target;\n\n  for (var i = decorators.length - 1, decorator; i >= 0; i--) if (decorator = decorators[i]) result = (kind ? decorator(target, key, result) : decorator(result)) || result;\n\n  if (kind && result) __defProp$a(target, key, result);\n  return result;\n};\n\nclass SliderChapters extends Component {\n  constructor() {\n    super(...arguments);\n    this._titleEl = null;\n    this._chapter = null;\n    this._currentTrack = signal(null);\n    this._refs = [];\n    this._cues = [];\n    this._$cues = signal(this._cues);\n    this._activeIndex = signal(-1);\n    this._activePointerIndex = signal(-1);\n    this._bufferedIndex = 0;\n    this._updateBufferedPercent = animationFrameThrottle(bufferedPercent => {\n      let percent;\n\n      for (let i = this._bufferedIndex; i < this._refs.length; i++) {\n        percent = this._calcPercent(this._cues[i], bufferedPercent);\n\n        this._refs[i].style.setProperty(\"--chapter-progress\", percent + \"%\");\n\n        if (percent < 100) {\n          this._bufferedIndex = i;\n          break;\n        }\n      }\n    });\n    this._bufferedPercent = computed(this._calcMediaBufferedPercent.bind(this));\n  }\n\n  get cues() {\n    return this._$cues();\n  }\n\n  get activeCue() {\n    return this._cues[this._activeIndex()] || null;\n  }\n\n  get activePointerCue() {\n    return this._cues[this._activePointerIndex()] || null;\n  }\n\n  onSetup() {\n    this._media = useMediaContext();\n    this._sliderState = useState(TimeSlider.state);\n  }\n\n  onAttach(el) {\n    const onChapterChange = this._onChapterChange.bind(this);\n\n    observeActiveTextTrack(this._media.textTracks, \"chapters\", onChapterChange);\n    effect(this._onTrackChange.bind(this));\n  }\n\n  onConnect() {\n    onDispose(this._reset.bind(this));\n  }\n\n  setRefs(refs) {\n    this._refs = refs;\n    this._updateScope?.dispose();\n\n    if (this._refs.length === 1) {\n      const el = this._refs[0];\n      el.style.width = \"100%\";\n      el.style.setProperty(\"--chapter-fill\", \"var(--slider-fill)\");\n      el.style.setProperty(\"--chapter-progress\", \"var(--slider-progress)\");\n    } else if (this._refs.length > 0) {\n      scoped(() => this._update(), this._updateScope = createScope());\n    }\n  }\n\n  _setTrack(track) {\n    if (peek(this._currentTrack) === track) return;\n\n    this._currentTrack.set(track);\n\n    this._reset();\n\n    this._build();\n  }\n\n  _build() {\n    const track = this._currentTrack();\n\n    if (!track?.cues.length || this._cues.length) return;\n\n    const chapters = this._fillGaps(track.cues);\n\n    this._cues = chapters;\n\n    this._$cues.set(chapters);\n\n    if (chapters[0].startTime === 0) {\n      this._activeIndex.set(0);\n    }\n  }\n\n  _reset() {\n    if (!this._cues.length) return;\n    this._refs = [];\n    this._cues = [];\n\n    this._$cues.set(this._cues);\n\n    this._activeIndex.set(-1);\n\n    this._activePointerIndex.set(-1);\n\n    this._bufferedIndex = 0;\n    this._updateScope?.dispose();\n  }\n\n  _update() {\n    this._updateContainerWidths();\n\n    effect(this._watchFillPercent.bind(this));\n    effect(this._watchPointerPercent.bind(this));\n    effect(this._watchBufferedPercent.bind(this));\n  }\n\n  _getEndTime() {\n    return this._cues[this._cues.length - 1].endTime;\n  }\n\n  _updateContainerWidths() {\n    let cue,\n        endTime = this._getEndTime();\n\n    for (let i = 0; i < this._cues.length; i++) {\n      cue = this._cues[i];\n      this._refs[i].style.width = round((cue.endTime - cue.startTime) / endTime * 100, 3) + \"%\";\n    }\n  }\n\n  _watchFillPercent() {\n    const {\n      liveEdge,\n      ended\n    } = this._media.$state;\n\n    let {\n      fillPercent,\n      value\n    } = this._sliderState,\n        prevActiveIndex = peek(this._activeIndex),\n        currentChapter = this._cues[prevActiveIndex],\n        currentActiveIndex = this._findActiveChapterIndex(currentChapter.startTime <= peek(value) ? prevActiveIndex : 0, fillPercent());\n\n    if (liveEdge() || ended()) {\n      this._updateFillPercents(0, this._cues.length, \"100%\");\n    } else if (currentActiveIndex > prevActiveIndex) {\n      this._updateFillPercents(prevActiveIndex, currentActiveIndex, \"100%\");\n    } else if (currentActiveIndex < prevActiveIndex) {\n      this._updateFillPercents(currentActiveIndex + 1, prevActiveIndex + 1, \"0%\");\n    }\n\n    const percent = liveEdge() ? \"100%\" : this._calcPercent(this._cues[currentActiveIndex], fillPercent()) + \"%\";\n\n    this._updateFillPercent(this._refs[currentActiveIndex], percent);\n\n    this._activeIndex.set(currentActiveIndex);\n  }\n\n  _watchPointerPercent() {\n    let {\n      pointing,\n      pointerPercent\n    } = this._sliderState;\n\n    if (!pointing()) {\n      this._activePointerIndex.set(-1);\n\n      return;\n    }\n\n    const activeIndex = this._findActiveChapterIndex(0, pointerPercent());\n\n    this._activePointerIndex.set(activeIndex);\n  }\n\n  _updateFillPercents(start, end, percent) {\n    for (let i = start; i < end; i++) this._updateFillPercent(this._refs[i], percent);\n  }\n\n  _updateFillPercent(ref, percent) {\n    ref.style.setProperty(\"--chapter-fill\", percent);\n  }\n\n  _findActiveChapterIndex(startIndex, percent) {\n    let chapterPercent = 0;\n\n    for (let i = startIndex; i < this._cues.length; i++) {\n      chapterPercent = this._calcPercent(this._cues[i], percent);\n      if (chapterPercent >= 0 && chapterPercent < 100) return i;\n    }\n\n    return 0;\n  }\n\n  _watchBufferedPercent() {\n    this._updateBufferedPercent(this._bufferedPercent());\n  }\n\n  _calcMediaBufferedPercent() {\n    const {\n      bufferedEnd,\n      duration\n    } = this._media.$state;\n    return round(Math.min(bufferedEnd() / Math.max(duration(), 1), 1), 3) * 100;\n  }\n\n  _calcPercent(cue, percent) {\n    const lastChapter = this._cues[this._cues.length - 1],\n          startPercent = cue.startTime / lastChapter.endTime * 100,\n          endPercent = cue.endTime / lastChapter.endTime * 100;\n    return Math.max(0, round(percent >= endPercent ? 100 : (percent - startPercent) / (endPercent - startPercent) * 100, 3));\n  }\n\n  _fillGaps(cues) {\n    const chapters = [];\n\n    if (cues[0].startTime !== 0) {\n      chapters.push(new window.VTTCue(0, cues[0].startTime, \"\"));\n    }\n\n    for (let i = 0; i < cues.length - 1; i++) {\n      const currentCue = cues[i],\n            nextCue = cues[i + 1];\n      chapters.push(currentCue);\n\n      if (nextCue) {\n        const timeDiff = nextCue.startTime - currentCue.endTime;\n\n        if (timeDiff > 0) {\n          chapters.push(new window.VTTCue(currentCue.endTime, currentCue.endTime + timeDiff, \"\"));\n        }\n      }\n    }\n\n    chapters.push(cues[cues.length - 1]);\n    return chapters;\n  }\n\n  _onChapterChange(track) {\n    this._chapter = track;\n\n    this._onTrackChange();\n  }\n\n  _onTrackChange() {\n    if (!this.scope) return;\n    const {\n      disabled\n    } = this.$props;\n    if (disabled()) return;\n\n    this._setTrack(this._chapter);\n\n    this._titleEl = this._findParentSlider()?.querySelector('[data-part=\"chapter-title\"]') || null;\n    if (this._titleEl) effect(this._onChapterTitleChange.bind(this));\n    return () => {\n      this._setTrack(null);\n\n      if (this._titleEl) {\n        this._titleEl.textContent = \"\";\n        this._titleEl = null;\n      }\n    };\n  }\n\n  _onChapterTitleChange() {\n    const cue = this.activePointerCue || this.activeCue;\n    if (this._titleEl) this._titleEl.textContent = cue?.text || \"\";\n  }\n\n  _findParentSlider() {\n    let node = this.el;\n\n    while (node && node.getAttribute(\"role\") !== \"slider\") {\n      node = node.parentElement;\n    }\n\n    return node;\n  }\n\n}\n\nSliderChapters.props = {\n  disabled: false\n};\n\n__decorateClass$a([prop], SliderChapters.prototype, \"cues\", 1);\n\n__decorateClass$a([prop], SliderChapters.prototype, \"activeCue\", 1);\n\n__decorateClass$a([prop], SliderChapters.prototype, \"activePointerCue\", 1);\n\n__decorateClass$a([method], SliderChapters.prototype, \"setRefs\", 1);\n\nconst menuContext = createContext();\nconst FOCUSABLE_ELEMENTS_SELECTOR = /* @__PURE__ */[\"a[href]\", \"[tabindex]\", \"input\", \"select\", \"button\"].map(selector => `${selector}:not([aria-hidden])`).join(\",\");\nconst VALID_KEYS = /* @__PURE__ */new Set([\"Escape\", \"Tab\", \"ArrowUp\", \"ArrowDown\", \"Home\", \"PageUp\", \"End\", \"PageDown\", \"Enter\", \" \"]);\n\nclass MenuFocusController {\n  constructor(_delegate) {\n    this._delegate = _delegate;\n    this._index = 0;\n    this._el = null;\n    this._elements = [];\n  }\n\n  get _items() {\n    return this._elements;\n  }\n\n  _attachMenu(el) {\n    listenEvent(el, \"focus\", this._onFocus.bind(this));\n    this._el = el;\n    onDispose(() => {\n      this._el = null;\n    });\n    return this;\n  }\n\n  _listen() {\n    if (!this._el) return;\n\n    this._update();\n\n    listenEvent(this._el, \"keyup\", this._onKeyUp.bind(this));\n    listenEvent(this._el, \"keydown\", this._onKeyDown.bind(this));\n    onDispose(() => {\n      this._index = 0;\n      this._elements = [];\n    });\n  }\n\n  _update() {\n    this._index = 0;\n    this._elements = this._getFocusableElements();\n  }\n\n  _scroll(index = this._findActiveIndex()) {\n    const element = this._elements[index],\n          container = this._delegate._getScrollContainer();\n\n    if (element && container) {\n      requestAnimationFrame(() => {\n        container.scrollTop = element.offsetTop - container.offsetHeight / 2 + element.offsetHeight / 2;\n      });\n    }\n  }\n\n  _focusAt(index) {\n    this._index = index;\n    this._elements[index]?.focus();\n\n    this._scroll(index);\n  }\n\n  _findActiveIndex() {\n    return this._elements.findIndex(el => el.getAttribute(\"aria-checked\") === \"true\");\n  }\n\n  _onFocus() {\n    this._update();\n\n    setTimeout(() => {\n      const index = this._findActiveIndex();\n\n      this._focusAt(index >= 0 ? index : 0);\n    }, 100);\n  }\n\n  _onKeyUp(event) {\n    if (!VALID_KEYS.has(event.key)) return;\n    event.stopPropagation();\n    event.preventDefault();\n  }\n\n  _onKeyDown(event) {\n    if (!VALID_KEYS.has(event.key)) return;\n    event.stopPropagation();\n    event.preventDefault();\n\n    switch (event.key) {\n      case \"Escape\":\n        this._delegate._closeMenu(event);\n\n        break;\n\n      case \"Tab\":\n        this._focusAt(this._nextIndex(event.shiftKey ? -1 : 1));\n\n        break;\n\n      case \"ArrowUp\":\n        this._focusAt(this._nextIndex(-1));\n\n        break;\n\n      case \"ArrowDown\":\n        this._focusAt(this._nextIndex(1));\n\n        break;\n\n      case \"Home\":\n      case \"PageUp\":\n        this._focusAt(0);\n\n        break;\n\n      case \"End\":\n      case \"PageDown\":\n        this._focusAt(this._elements.length - 1);\n\n        break;\n    }\n  }\n\n  _nextIndex(delta) {\n    let index = this._index;\n\n    do {\n      index = (index + delta + this._elements.length) % this._elements.length;\n    } while (this._elements[index]?.offsetParent === null);\n\n    return index;\n  }\n\n  _getFocusableElements() {\n    if (!this._el) return [];\n\n    const focusableElements = this._el.querySelectorAll(FOCUSABLE_ELEMENTS_SELECTOR),\n          elements = [];\n\n    const is = node => {\n      return node.getAttribute(\"role\") === \"menu\";\n    };\n\n    for (const el of focusableElements) {\n      if (el instanceof HTMLElement && el.offsetParent !== null && // does not have display: none\n      isElementParent(this._el, el, is)) {\n        elements.push(el);\n      }\n    }\n\n    return elements;\n  }\n\n}\n\nvar __defProp$9 = Object.defineProperty;\nvar __getOwnPropDesc$9 = Object.getOwnPropertyDescriptor;\n\nvar __decorateClass$9 = (decorators, target, key, kind) => {\n  var result = kind > 1 ? void 0 : kind ? __getOwnPropDesc$9(target, key) : target;\n\n  for (var i = decorators.length - 1, decorator; i >= 0; i--) if (decorator = decorators[i]) result = (kind ? decorator(target, key, result) : decorator(result)) || result;\n\n  if (kind && result) __defProp$9(target, key, result);\n  return result;\n};\n\nlet idCount = 0;\n\nclass Menu extends Component {\n  constructor() {\n    super();\n    this._expanded = signal(false);\n    this._disabled = signal(false);\n    this._trigger = signal(null);\n    this._content = signal(null);\n    this._isTriggerDisabled = signal(false);\n    this._submenus = /* @__PURE__ */new Set();\n    this._menuObserver = null;\n    this._removeSubmenuBind = this._removeSubmenu.bind(this);\n    this._onSubmenuOpenBind = this._onSubmenuOpen.bind(this);\n    this._onSubmenuCloseBind = this._onSubmenuClose.bind(this);\n    const {\n      showDelay\n    } = this.$props;\n    this._popper = new Popper({\n      _trigger: this._trigger,\n      _content: this._content,\n      _showDelay: showDelay,\n      _listen: (trigger, show, hide) => {\n        onPress(trigger, event => {\n          if (this._expanded()) hide(event);else show(event);\n        });\n\n        const closeTarget = this._getCloseTarget();\n\n        if (closeTarget) {\n          onPress(closeTarget, event => {\n            event.stopPropagation();\n            hide(event);\n          });\n        }\n      },\n      _onChange: this._onExpandedChange.bind(this)\n    });\n  }\n\n  get triggerElement() {\n    return this._trigger();\n  }\n\n  get contentElement() {\n    return this._content();\n  }\n\n  get isSubmenu() {\n    return !!this._parentMenu;\n  }\n\n  onSetup() {\n    this._media = useMediaContext();\n    const currentIdCount = ++idCount;\n    this._menuId = `media-menu-${currentIdCount}`;\n    this._menuButtonId = `media-menu-button-${currentIdCount}`;\n    this._focus = new MenuFocusController({\n      _getScrollContainer: this._findScrollContainer.bind(this),\n      _closeMenu: this.close.bind(this)\n    });\n\n    if (hasProvidedContext(menuContext)) {\n      this._parentMenu = useContext(menuContext);\n    }\n\n    this.setAttributes({\n      \"data-open\": this._expanded,\n      \"data-submenu\": this.isSubmenu,\n      \"data-disabled\": this._isDisabled.bind(this)\n    });\n    provideContext(menuContext, {\n      _button: this._trigger,\n      _expanded: this._expanded,\n      _hint: signal(\"\"),\n      _disable: this._disable.bind(this),\n      _attachMenuButton: this._attachMenuButton.bind(this),\n      _attachMenuItems: this._attachMenuItems.bind(this),\n      _attachObserver: this._attachObserver.bind(this),\n      _disableMenuButton: this._disableMenuButton.bind(this),\n      _addSubmenu: this._addSubmenu.bind(this)\n    });\n  }\n\n  onAttach(el) {\n    el.style.setProperty(\"display\", \"contents\");\n\n    this._focus._attachMenu(el);\n  }\n\n  onConnect(el) {\n    effect(this._watchExpanded.bind(this));\n    if (this.isSubmenu) this._parentMenu?._addSubmenu(this);\n    requestAnimationFrame(() => {\n      this._onResize();\n    });\n  }\n\n  onDestroy() {\n    this._trigger.set(null);\n\n    this._content.set(null);\n\n    this._menuObserver = null;\n  }\n\n  _watchExpanded() {\n    const expanded = this._isExpanded();\n\n    this._onResize();\n\n    this._updateMenuItemsHidden(expanded);\n\n    if (!expanded) return;\n    effect(() => {\n      const {\n        height\n      } = this._media.$state,\n            content = this._content();\n\n      content && setStyle(content, \"--player-height\", height() + \"px\");\n    });\n\n    this._focus._listen();\n\n    this.listen(\"pointerup\", this._onPointerUp.bind(this));\n    listenEvent(window, \"pointerup\", this._onWindowPointerUp.bind(this));\n  }\n\n  _attachMenuButton(button) {\n    const el = button.el,\n          isMenuItem = this.isSubmenu,\n          isARIADisabled = $ariaBool(this._isDisabled.bind(this));\n    setAttributeIfEmpty(el, \"tabindex\", isMenuItem ? \"-1\" : \"0\");\n    setAttributeIfEmpty(el, \"role\", isMenuItem ? \"menuitem\" : \"button\");\n    setAttribute(el, \"id\", this._menuButtonId);\n    setAttribute(el, \"aria-haspopup\", \"menu\");\n    setAttribute(el, \"aria-expanded\", \"false\");\n    setAttribute(el, \"data-submenu\", this.isSubmenu);\n\n    if (!this.isSubmenu) {\n      this._stopClickPropagation(el);\n    }\n\n    const watchAttrs = () => {\n      setAttribute(el, \"data-open\", this._expanded());\n      setAttribute(el, \"aria-disabled\", isARIADisabled());\n    };\n\n    effect(watchAttrs);\n\n    this._trigger.set(el);\n\n    onDispose(() => {\n      this._trigger.set(null);\n    });\n  }\n\n  _attachMenuItems(items) {\n    const el = items.el;\n    el.style.setProperty(\"display\", \"none\");\n    setAttribute(el, \"id\", this._menuId);\n    setAttributeIfEmpty(el, \"role\", \"menu\");\n    setAttributeIfEmpty(el, \"tabindex\", \"-1\");\n    setAttribute(el, \"data-submenu\", this.isSubmenu);\n\n    this._content.set(el);\n\n    onDispose(() => this._content.set(null));\n\n    if (!this.isSubmenu) {\n      this._stopClickPropagation(el);\n    }\n\n    const watchAttrs = () => {\n      setAttribute(el, \"data-open\", this._expanded());\n    };\n\n    effect(watchAttrs);\n\n    this._focus._attachMenu(el);\n\n    this._updateMenuItemsHidden(false);\n\n    {\n      requestAnimationFrame(this._onResize.bind(this));\n    }\n  }\n\n  _attachObserver(observer) {\n    this._menuObserver = observer;\n  }\n\n  _stopClickPropagation(el) {\n    listenEvent(el, \"click\", e => e.stopPropagation());\n    listenEvent(el, \"pointerup\", e => e.stopPropagation());\n  }\n\n  _updateMenuItemsHidden(expanded) {\n    const content = peek(this._content);\n    if (content) setAttribute(content, \"aria-hidden\", ariaBool$1(!expanded));\n  }\n\n  _disableMenuButton(disabled) {\n    this._isTriggerDisabled.set(disabled);\n  }\n\n  _onExpandedChange(isExpanded, event) {\n    event?.stopPropagation();\n    if (this._expanded() === isExpanded) return;\n\n    if (this._isDisabled()) {\n      if (isExpanded) this._popper.hide(event);\n      return;\n    }\n\n    const trigger = this._trigger(),\n          content = this._content();\n\n    if (trigger) {\n      setAttribute(trigger, \"aria-controls\", isExpanded && this._menuId);\n      setAttribute(trigger, \"aria-expanded\", ariaBool$1(isExpanded));\n    }\n\n    if (content) setAttribute(content, \"aria-labelledby\", isExpanded && this._menuButtonId);\n\n    this._expanded.set(isExpanded);\n\n    this._toggleMediaControls(event);\n\n    tick();\n\n    if (isKeyboardEvent(event)) {\n      if (isExpanded) {\n        content?.focus();\n      } else {\n        trigger?.focus();\n      }\n\n      for (const el of [this.el, content]) {\n        el && el.setAttribute(\"data-keyboard\", \"\");\n      }\n    } else {\n      for (const el of [this.el, content]) {\n        el && el.removeAttribute(\"data-keyboard\");\n      }\n    }\n\n    this.dispatch(isExpanded ? \"open\" : \"close\", {\n      trigger: event\n    });\n\n    if (isExpanded) {\n      if (!this.isSubmenu && this._media.activeMenu !== this) {\n        this._media.activeMenu?.close(event);\n        this._media.activeMenu = this;\n      }\n\n      this._menuObserver?._onOpen?.(event);\n    } else {\n      if (this.isSubmenu) {\n        setTimeout(() => {\n          for (const el of this._submenus) el.close(event);\n        }, 300);\n      } else {\n        this._media.activeMenu = null;\n      }\n\n      this._menuObserver?._onClose?.(event);\n    }\n\n    if (isExpanded && !isKeyboardEvent(event)) {\n      requestAnimationFrame(() => {\n        this._focus._update();\n\n        setTimeout(() => {\n          this._focus._scroll();\n        }, 100);\n      });\n    }\n  }\n\n  _isExpanded() {\n    return !this._isDisabled() && this._expanded();\n  }\n\n  _isDisabled() {\n    return this._disabled() || this._isTriggerDisabled();\n  }\n\n  _disable(disabled) {\n    this._disabled.set(disabled);\n  }\n\n  _onPointerUp(event) {\n    event.stopPropagation();\n  }\n\n  _onWindowPointerUp(event) {\n    if (this.isSubmenu) return setTimeout(this.close.bind(this, event), 800);else this.close(event);\n  }\n\n  _getCloseTarget() {\n    const target = this.el.querySelector('[data-part=\"close-target\"]');\n    return isElementParent(this.el, target, node => node.getAttribute(\"role\") === \"menu\") ? target : null;\n  }\n\n  _findScrollContainer() {\n    if (!this.isSubmenu) {\n      const content = peek(this._content);\n      return content || null;\n    } else {\n      let el = this.el;\n\n      while (el && el.tagName !== \"media-menu\" && el.hasAttribute(\"data-submenu\")) {\n        el = el.parentNode;\n      }\n\n      return el;\n    }\n  }\n\n  _toggleMediaControls(trigger) {\n    if (this.isSubmenu) return;\n    if (this._expanded()) this._media.remote.pauseControls(trigger);else this._media.remote.resumeControls(trigger);\n  }\n\n  _addSubmenu(menu) {\n    this._submenus.add(menu);\n\n    listenEvent(menu, \"open\", this._onSubmenuOpenBind);\n    listenEvent(menu, \"close\", this._onSubmenuCloseBind);\n    onDispose(this._removeSubmenuBind);\n  }\n\n  _removeSubmenu(menu) {\n    this._submenus.delete(menu);\n  }\n\n  _onSubmenuOpen(event) {\n    for (const target of this._submenus) {\n      if (target !== event.target) {\n        for (const el of [target.el, target.triggerElement]) {\n          el?.setAttribute(\"aria-hidden\", \"true\");\n        }\n      }\n    }\n\n    requestAnimationFrame(() => {\n      this._onResize();\n    });\n  }\n\n  _onSubmenuClose() {\n    for (const target of this._submenus) {\n      for (const el of [target.el, target.triggerElement]) {\n        el?.setAttribute(\"aria-hidden\", \"false\");\n      }\n    }\n\n    requestAnimationFrame(() => {\n      this._onResize();\n    });\n  }\n\n  _onResize() {\n    const content = peek(this._content);\n    if (!content || false) return;\n    let {\n      paddingTop,\n      paddingBottom,\n      borderTopWidth,\n      borderBottomWidth\n    } = getComputedStyle(content),\n        height = parseFloat(paddingTop) + parseFloat(paddingBottom) + parseFloat(borderTopWidth) + parseFloat(borderBottomWidth),\n        children = [...content.children];\n\n    for (const child of children) {\n      if (child instanceof HTMLElement && child.style.display === \"contents\") {\n        children.push(...child.children);\n      } else {\n        height += child.offsetHeight || 0;\n      }\n    }\n\n    requestAnimationFrame(() => {\n      if (!content) return;\n      setAttribute(content, \"data-resizing\", \"\");\n      setTimeout(() => {\n        if (content) setAttribute(content, \"data-resizing\", false);\n      }, 400);\n      setStyle(content, \"--menu-height\", height + \"px\");\n    });\n  }\n\n  open(trigger) {\n    if (peek(this._expanded)) return;\n\n    this._popper.show(trigger);\n\n    tick();\n  }\n\n  close(trigger) {\n    if (!peek(this._expanded)) return;\n\n    this._popper.hide(trigger);\n\n    tick();\n  }\n\n}\n\nMenu.props = {\n  showDelay: 0\n};\n\n__decorateClass$9([prop], Menu.prototype, \"triggerElement\", 1);\n\n__decorateClass$9([prop], Menu.prototype, \"contentElement\", 1);\n\n__decorateClass$9([prop], Menu.prototype, \"isSubmenu\", 1);\n\n__decorateClass$9([method], Menu.prototype, \"open\", 1);\n\n__decorateClass$9([method], Menu.prototype, \"close\", 1);\n\nvar __defProp$8 = Object.defineProperty;\nvar __getOwnPropDesc$8 = Object.getOwnPropertyDescriptor;\n\nvar __decorateClass$8 = (decorators, target, key, kind) => {\n  var result = kind > 1 ? void 0 : kind ? __getOwnPropDesc$8(target, key) : target;\n\n  for (var i = decorators.length - 1, decorator; i >= 0; i--) if (decorator = decorators[i]) result = (kind ? decorator(target, key, result) : decorator(result)) || result;\n\n  if (kind && result) __defProp$8(target, key, result);\n  return result;\n};\n\nclass MenuButton extends Component {\n  constructor() {\n    super();\n    new FocusVisibleController();\n  }\n\n  get expanded() {\n    return this._menu?._expanded() ?? false;\n  }\n\n  onSetup() {\n    this._menu = useContext(menuContext);\n  }\n\n  onAttach(el) {\n    this._menu._attachMenuButton(this);\n\n    effect(this._watchDisabled.bind(this));\n  }\n\n  onConnect(el) {\n    const hint = Array.from(el.querySelectorAll('[data-part=\"hint\"]')).pop();\n\n    if (hint) {\n      effect(() => {\n        const text = this._menu._hint();\n\n        if (text) hint.textContent = text;\n      });\n    }\n\n    onPress(el, trigger => {\n      this.dispatch(\"select\", {\n        trigger\n      });\n    });\n  }\n\n  _watchDisabled() {\n    this._menu._disableMenuButton(this.$props.disabled());\n  }\n\n}\n\nMenuButton.props = {\n  disabled: false\n};\n\n__decorateClass$8([prop], MenuButton.prototype, \"expanded\", 1);\n\nclass MenuPortal extends Component {\n  constructor() {\n    super(...arguments);\n    this._target = null;\n  }\n\n  onSetup() {\n    this._media = useMediaContext();\n    provideContext(menuPortalContext, {\n      _attach: this._attachElement.bind(this)\n    });\n  }\n\n  onAttach(el) {\n    el.style.setProperty(\"display\", \"contents\");\n  } // Need this so connect scope is defined.\n\n\n  onConnect(el) {}\n\n  onDestroy() {\n    this._target?.remove();\n    this._target = null;\n  }\n\n  _attachElement(el) {\n    this._portal(false);\n\n    this._target = el;\n    requestScopedAnimationFrame(() => {\n      requestScopedAnimationFrame(() => {\n        if (!this.connectScope) return;\n        effect(this._watchDisabled.bind(this));\n      });\n    });\n  }\n\n  _watchDisabled() {\n    const {\n      fullscreen\n    } = this._media.$state,\n          {\n      disabled\n    } = this.$props,\n          _disabled = disabled();\n\n    this._portal(_disabled === \"fullscreen\" ? !fullscreen() : !_disabled);\n  }\n\n  _portal(shouldPortal) {\n    if (!this._target) return;\n\n    let container = this._getContainer(this.$props.container());\n\n    if (!container) return;\n    const isPortalled = this._target.parentElement === container;\n    setAttribute(this._target, \"data-portal\", shouldPortal);\n\n    if (shouldPortal) {\n      if (!isPortalled) {\n        this._target.remove();\n\n        container.append(this._target);\n      }\n    } else if (isPortalled && this._target.parentElement === container) {\n      this._target.remove();\n\n      this.el?.append(this._target);\n    }\n  }\n\n  _getContainer(selector) {\n    if (selector instanceof HTMLElement) return selector;\n    return selector ? document.querySelector(selector) : document.body;\n  }\n\n}\n\nMenuPortal.props = {\n  container: null,\n  disabled: false\n};\nconst menuPortalContext = createContext();\n\nclass MenuItems extends Component {\n  constructor() {\n    super();\n    new FocusVisibleController();\n    const {\n      placement\n    } = this.$props;\n    this.setAttributes({\n      \"data-placement\": placement\n    });\n  }\n\n  onAttach(el) {\n    this._menu = useContext(menuContext);\n\n    this._menu._attachMenuItems(this);\n\n    if (hasProvidedContext(menuPortalContext)) {\n      const portal = useContext(menuPortalContext);\n\n      if (portal) {\n        provideContext(menuPortalContext, null);\n\n        portal._attach(el);\n\n        onDispose(() => portal._attach(null));\n      }\n    }\n  }\n\n  onConnect(el) {\n    effect(this._watchPlacement.bind(this));\n  }\n\n  _watchPlacement() {\n    if (!this.el) return;\n    const placement = this.$props.placement();\n\n    if (placement) {\n      Object.assign(this.el.style, {\n        position: \"absolute\",\n        top: 0,\n        left: 0,\n        width: \"max-content\"\n      });\n      const {\n        offset: mainOffset,\n        alignOffset\n      } = this.$props;\n      return autoPlacement(this.el, this._getButton(), placement, {\n        offsetVarName: \"media-menu\",\n        xOffset: alignOffset(),\n        yOffset: mainOffset()\n      });\n    } else {\n      this.el.removeAttribute(\"style\");\n      this.el.style.display = \"none\";\n    }\n  }\n\n  _getButton() {\n    return this._menu._button();\n  }\n\n}\n\nMenuItems.props = {\n  placement: null,\n  offset: 0,\n  alignOffset: 0\n};\nconst radioControllerContext = createContext();\n\nclass RadioGroupController extends ViewController {\n  constructor() {\n    super(...arguments);\n    this._group = /* @__PURE__ */new Set();\n    this._value = signal(\"\");\n    this._controller = null;\n    this._onChangeBind = this._onChange.bind(this);\n  }\n\n  get _values() {\n    return Array.from(this._group).map(radio => radio._value());\n  }\n\n  get value() {\n    return this._value();\n  }\n\n  set value(value) {\n    this._onChange(value);\n  }\n\n  onSetup() {\n    provideContext(radioControllerContext, {\n      add: this._addRadio.bind(this),\n      remove: this._removeRadio.bind(this)\n    });\n  }\n\n  onAttach(el) {\n    const isMenuItem = hasProvidedContext(menuContext);\n    if (!isMenuItem) setAttributeIfEmpty(el, \"role\", \"radiogroup\");\n    this.setAttributes({\n      value: this._value\n    });\n  }\n\n  onDestroy() {\n    this._group.clear();\n  }\n\n  _addRadio(radio) {\n    if (this._group.has(radio)) return;\n\n    this._group.add(radio);\n\n    radio._onCheck = this._onChangeBind;\n\n    radio._check(radio._value() === this._value());\n  }\n\n  _removeRadio(radio) {\n    radio._onCheck = null;\n\n    this._group.delete(radio);\n  }\n\n  _onChange(newValue, trigger) {\n    const currentValue = peek(this._value);\n    if (!newValue || newValue === currentValue) return;\n\n    const currentRadio = this._findRadio(currentValue),\n          newRadio = this._findRadio(newValue);\n\n    currentRadio?._check(false, trigger);\n    newRadio?._check(true, trigger);\n\n    this._value.set(newValue);\n\n    this._onValueChange?.(newValue, trigger);\n  }\n\n  _findRadio(newValue) {\n    for (const radio of this._group) {\n      if (newValue === peek(radio._value)) return radio;\n    }\n\n    return null;\n  }\n\n}\n\nvar __defProp$7 = Object.defineProperty;\nvar __getOwnPropDesc$7 = Object.getOwnPropertyDescriptor;\n\nvar __decorateClass$7 = (decorators, target, key, kind) => {\n  var result = kind > 1 ? void 0 : kind ? __getOwnPropDesc$7(target, key) : target;\n\n  for (var i = decorators.length - 1, decorator; i >= 0; i--) if (decorator = decorators[i]) result = (kind ? decorator(target, key, result) : decorator(result)) || result;\n\n  if (kind && result) __defProp$7(target, key, result);\n  return result;\n};\n\nclass RadioGroup extends Component {\n  constructor() {\n    super();\n    this._controller = new RadioGroupController();\n    this._controller._onValueChange = this._onValueChange.bind(this);\n  }\n\n  get values() {\n    return this._controller._values;\n  }\n\n  get value() {\n    return this._controller.value;\n  }\n\n  onSetup() {\n    effect(this._watchValue.bind(this));\n  }\n\n  _watchValue() {\n    this._controller.value = this.$props.value();\n  }\n\n  _onValueChange(value, trigger) {\n    const event = this.createEvent(\"change\", {\n      detail: value,\n      trigger\n    });\n    this.dispatch(event);\n  }\n\n}\n\nRadioGroup.props = {\n  value: \"\"\n};\n\n__decorateClass$7([prop], RadioGroup.prototype, \"values\", 1);\n\n__decorateClass$7([prop], RadioGroup.prototype, \"value\", 1);\n\nvar __defProp$6 = Object.defineProperty;\nvar __getOwnPropDesc$6 = Object.getOwnPropertyDescriptor;\n\nvar __decorateClass$6 = (decorators, target, key, kind) => {\n  var result = kind > 1 ? void 0 : kind ? __getOwnPropDesc$6(target, key) : target;\n\n  for (var i = decorators.length - 1, decorator; i >= 0; i--) if (decorator = decorators[i]) result = (kind ? decorator(target, key, result) : decorator(result)) || result;\n\n  if (kind && result) __defProp$6(target, key, result);\n  return result;\n};\n\nclass Radio extends Component {\n  constructor() {\n    super();\n    this._checked = signal(false);\n    this._controller = {\n      _value: this.$props.value,\n      _check: this._check.bind(this),\n      _onCheck: null\n    };\n    new FocusVisibleController();\n  }\n\n  get checked() {\n    return this._checked();\n  }\n\n  onSetup() {\n    this.setAttributes({\n      value: this.$props.value,\n      \"data-checked\": this._checked,\n      \"aria-checked\": $ariaBool(this._checked)\n    });\n  }\n\n  onAttach(el) {\n    const isMenuItem = hasProvidedContext(menuContext);\n    setAttributeIfEmpty(el, \"tabindex\", isMenuItem ? \"-1\" : \"0\");\n    setAttributeIfEmpty(el, \"role\", isMenuItem ? \"menuitemradio\" : \"radio\");\n    effect(this._watchValue.bind(this));\n  }\n\n  onConnect(el) {\n    this._addToGroup();\n\n    onPress(el, this._onPress.bind(this));\n    onDispose(this._onDisconnect.bind(this));\n  }\n\n  _onDisconnect() {\n    scoped(() => {\n      const group = useContext(radioControllerContext);\n      group.remove(this._controller);\n    }, this.connectScope);\n  }\n\n  _addToGroup() {\n    const group = useContext(radioControllerContext);\n    group.add(this._controller);\n  }\n\n  _watchValue() {\n    const {\n      value\n    } = this.$props,\n          newValue = value();\n\n    if (peek(this._checked)) {\n      this._controller._onCheck?.(newValue);\n    }\n  }\n\n  _onPress(event) {\n    if (peek(this._checked)) return;\n\n    this._onChange(true, event);\n\n    this._onSelect(event);\n\n    this._controller._onCheck?.(peek(this.$props.value), event);\n  }\n\n  _check(value, trigger) {\n    if (peek(this._checked) === value) return;\n\n    this._onChange(value, trigger);\n  }\n\n  _onChange(value, trigger) {\n    this._checked.set(value);\n\n    this.dispatch(\"change\", {\n      detail: value,\n      trigger\n    });\n  }\n\n  _onSelect(trigger) {\n    this.dispatch(\"select\", {\n      trigger\n    });\n  }\n\n}\n\nRadio.props = {\n  value: \"\"\n};\n\n__decorateClass$6([prop], Radio.prototype, \"checked\", 1);\n\nvar __defProp$5 = Object.defineProperty;\nvar __getOwnPropDesc$5 = Object.getOwnPropertyDescriptor;\n\nvar __decorateClass$5 = (decorators, target, key, kind) => {\n  var result = kind > 1 ? void 0 : kind ? __getOwnPropDesc$5(target, key) : target;\n\n  for (var i = decorators.length - 1, decorator; i >= 0; i--) if (decorator = decorators[i]) result = (kind ? decorator(target, key, result) : decorator(result)) || result;\n\n  if (kind && result) __defProp$5(target, key, result);\n  return result;\n};\n\nclass ChaptersRadioGroup extends Component {\n  constructor() {\n    super();\n    this._index = signal(0);\n    this._track = signal(null);\n    this._controller = new RadioGroupController();\n    this._controller._onValueChange = this._onValueChange.bind(this);\n  }\n\n  get value() {\n    return this._controller.value;\n  }\n\n  get disabled() {\n    const track = this._track();\n\n    return !track || !track.cues.length;\n  }\n\n  onSetup() {\n    this._media = useMediaContext();\n\n    if (hasProvidedContext(menuContext)) {\n      this._menu = useContext(menuContext);\n    }\n\n    const {\n      thumbnails\n    } = this.$props;\n    this.setAttributes({\n      \"data-thumbnails\": () => !!thumbnails()\n    });\n  }\n\n  onAttach(el) {\n    this._menu?._attachObserver({\n      _onOpen: this._onOpen.bind(this)\n    });\n  }\n\n  getOptions() {\n    const track = this._track();\n\n    if (!track) return [];\n    return track.cues.map((cue, i) => ({\n      cue,\n      value: i + \"\",\n      label: cue.text,\n      startTime: formatTime(cue.startTime, false),\n      duration: formatSpokenTime(cue.endTime - cue.startTime)\n    }));\n  }\n\n  _onOpen() {\n    peek(() => this._watchCurrentTime());\n  }\n\n  onConnect(el) {\n    effect(this._watchValue.bind(this));\n    effect(this._watchCurrentTime.bind(this));\n    effect(this._watchControllerDisabled.bind(this));\n    observeActiveTextTrack(this._media.textTracks, \"chapters\", this._track.set);\n  }\n\n  _watchValue() {\n    this._controller.value = this._getValue();\n  }\n\n  _watchCurrentTime() {\n    if (!this._menu?._expanded()) return;\n\n    const track = this._track();\n\n    if (!track) {\n      this._index.set(-1);\n\n      return;\n    }\n\n    const {\n      currentTime\n    } = this._media.$state,\n          time = currentTime(),\n          activeCueIndex = track.cues.findIndex(cue => isCueActive(cue, time));\n\n    this._index.set(activeCueIndex);\n\n    if (activeCueIndex >= 0) {\n      const cue = track.cues[activeCueIndex],\n            radio = this.el.querySelector(`[aria-checked='true']`),\n            playedPercent = (time - cue.startTime) / (cue.endTime - cue.startTime) * 100;\n      radio && setStyle(radio, \"--progress\", round(playedPercent, 3) + \"%\");\n    }\n  }\n\n  _watchControllerDisabled() {\n    this._menu?._disable(this.disabled);\n  }\n\n  _getValue() {\n    return this._index() + \"\";\n  }\n\n  _onValueChange(value, trigger) {\n    if (this.disabled || !trigger) return;\n    const index = +value,\n          cues = this._track()?.cues;\n\n    if (isNumber(index) && cues?.[index]) {\n      this._index.set(index);\n\n      this._media.remote.seek(cues[index].startTime, trigger);\n\n      this.dispatch(\"change\", {\n        detail: cues[index],\n        trigger\n      });\n    }\n  }\n\n}\n\nChaptersRadioGroup.props = {\n  thumbnails: \"\"\n};\n\n__decorateClass$5([prop], ChaptersRadioGroup.prototype, \"value\", 1);\n\n__decorateClass$5([prop], ChaptersRadioGroup.prototype, \"disabled\", 1);\n\n__decorateClass$5([method], ChaptersRadioGroup.prototype, \"getOptions\", 1);\n\nvar __defProp$4 = Object.defineProperty;\nvar __getOwnPropDesc$4 = Object.getOwnPropertyDescriptor;\n\nvar __decorateClass$4 = (decorators, target, key, kind) => {\n  var result = kind > 1 ? void 0 : kind ? __getOwnPropDesc$4(target, key) : target;\n\n  for (var i = decorators.length - 1, decorator; i >= 0; i--) if (decorator = decorators[i]) result = (kind ? decorator(target, key, result) : decorator(result)) || result;\n\n  if (kind && result) __defProp$4(target, key, result);\n  return result;\n};\n\nclass AudioRadioGroup extends Component {\n  constructor() {\n    super();\n    this._controller = new RadioGroupController();\n    this._controller._onValueChange = this._onValueChange.bind(this);\n  }\n\n  get value() {\n    return this._controller.value;\n  }\n\n  get disabled() {\n    const {\n      audioTracks\n    } = this._media.$state;\n    return audioTracks().length === 0;\n  }\n\n  onSetup() {\n    this._media = useMediaContext();\n\n    if (hasProvidedContext(menuContext)) {\n      this._menu = useContext(menuContext);\n    }\n  }\n\n  onConnect(el) {\n    effect(this._watchValue.bind(this));\n    effect(this._watchControllerDisabled.bind(this));\n    effect(this._watchHintText.bind(this));\n  }\n\n  getOptions() {\n    const {\n      audioTracks\n    } = this._media.$state;\n    return audioTracks().map(track => ({\n      track,\n      label: track.label,\n      value: track.label.toLowerCase()\n    }));\n  }\n\n  _watchValue() {\n    this._controller.value = this._getValue();\n  }\n\n  _watchHintText() {\n    const {\n      emptyLabel\n    } = this.$props,\n          {\n      audioTrack\n    } = this._media.$state,\n          track = audioTrack();\n    this._menu?._hint.set(track?.label ?? emptyLabel());\n  }\n\n  _watchControllerDisabled() {\n    this._menu?._disable(this.disabled);\n  }\n\n  _getValue() {\n    const {\n      audioTrack\n    } = this._media.$state;\n    const track = audioTrack();\n    return track ? track.label.toLowerCase() : \"\";\n  }\n\n  _onValueChange(value, trigger) {\n    if (this.disabled) return;\n\n    const index = this._media.audioTracks.toArray().findIndex(track => track.label.toLowerCase() === value);\n\n    if (index >= 0) {\n      const track = this._media.audioTracks[index];\n\n      this._media.remote.changeAudioTrack(index, trigger);\n\n      this.dispatch(\"change\", {\n        detail: track,\n        trigger\n      });\n    }\n  }\n\n}\n\nAudioRadioGroup.props = {\n  emptyLabel: \"Default\"\n};\n\n__decorateClass$4([prop], AudioRadioGroup.prototype, \"value\", 1);\n\n__decorateClass$4([prop], AudioRadioGroup.prototype, \"disabled\", 1);\n\n__decorateClass$4([method], AudioRadioGroup.prototype, \"getOptions\", 1);\n\nvar __defProp$3 = Object.defineProperty;\nvar __getOwnPropDesc$3 = Object.getOwnPropertyDescriptor;\n\nvar __decorateClass$3 = (decorators, target, key, kind) => {\n  var result = kind > 1 ? void 0 : kind ? __getOwnPropDesc$3(target, key) : target;\n\n  for (var i = decorators.length - 1, decorator; i >= 0; i--) if (decorator = decorators[i]) result = (kind ? decorator(target, key, result) : decorator(result)) || result;\n\n  if (kind && result) __defProp$3(target, key, result);\n  return result;\n};\n\nclass CaptionsRadioGroup extends Component {\n  constructor() {\n    super();\n    this._controller = new RadioGroupController();\n    this._controller._onValueChange = this._onValueChange.bind(this);\n  }\n\n  get value() {\n    return this._controller.value;\n  }\n\n  get disabled() {\n    const {\n      textTracks\n    } = this._media.$state;\n    return textTracks().filter(isTrackCaptionKind).length === 0;\n  }\n\n  onSetup() {\n    this._media = useMediaContext();\n\n    if (hasProvidedContext(menuContext)) {\n      this._menu = useContext(menuContext);\n    }\n  }\n\n  onConnect(el) {\n    super.onConnect?.(el);\n    effect(this._watchValue.bind(this));\n    effect(this._watchControllerDisabled.bind(this));\n    effect(this._watchHintText.bind(this));\n  }\n\n  getOptions() {\n    const {\n      offLabel\n    } = this.$props,\n          {\n      textTracks\n    } = this._media.$state;\n    return [{\n      value: \"off\",\n      label: offLabel\n    }, ...textTracks().filter(isTrackCaptionKind).map(track => ({\n      track,\n      label: track.label,\n      value: track.label.toLowerCase()\n    }))];\n  }\n\n  _watchValue() {\n    this._controller.value = this._getValue();\n  }\n\n  _watchHintText() {\n    const {\n      offLabel\n    } = this.$props,\n          {\n      textTrack\n    } = this._media.$state,\n          track = textTrack();\n    this._menu?._hint.set(track && isTrackCaptionKind(track) && track.mode === \"showing\" ? track.label : offLabel());\n  }\n\n  _watchControllerDisabled() {\n    this._menu?._disable(this.disabled);\n  }\n\n  _getValue() {\n    const {\n      textTrack\n    } = this._media.$state,\n          track = textTrack();\n    return track && isTrackCaptionKind(track) && track.mode === \"showing\" ? track.label.toLowerCase() : \"off\";\n  }\n\n  _onValueChange(value, trigger) {\n    if (this.disabled) return;\n\n    if (value === \"off\") {\n      const track = this._media.textTracks.selected;\n\n      if (track) {\n        const index2 = this._media.textTracks.toArray().indexOf(track);\n\n        this._media.remote.changeTextTrackMode(index2, \"disabled\", trigger);\n\n        this.dispatch(\"change\", {\n          detail: null,\n          trigger\n        });\n      }\n\n      return;\n    }\n\n    const index = this._media.textTracks.toArray().findIndex(track => track.label.toLowerCase() === value);\n\n    if (index >= 0) {\n      const track = this._media.textTracks[index];\n\n      this._media.remote.changeTextTrackMode(index, \"showing\", trigger);\n\n      this.dispatch(\"change\", {\n        detail: track,\n        trigger\n      });\n    }\n  }\n\n}\n\nCaptionsRadioGroup.props = {\n  offLabel: \"Off\"\n};\n\n__decorateClass$3([prop], CaptionsRadioGroup.prototype, \"value\", 1);\n\n__decorateClass$3([prop], CaptionsRadioGroup.prototype, \"disabled\", 1);\n\n__decorateClass$3([method], CaptionsRadioGroup.prototype, \"getOptions\", 1);\n\nvar __defProp$2 = Object.defineProperty;\nvar __getOwnPropDesc$2 = Object.getOwnPropertyDescriptor;\n\nvar __decorateClass$2 = (decorators, target, key, kind) => {\n  var result = kind > 1 ? void 0 : kind ? __getOwnPropDesc$2(target, key) : target;\n\n  for (var i = decorators.length - 1, decorator; i >= 0; i--) if (decorator = decorators[i]) result = (kind ? decorator(target, key, result) : decorator(result)) || result;\n\n  if (kind && result) __defProp$2(target, key, result);\n  return result;\n};\n\nclass SpeedRadioGroup extends Component {\n  constructor() {\n    super();\n    this._controller = new RadioGroupController();\n    this._controller._onValueChange = this._onValueChange.bind(this);\n  }\n\n  get value() {\n    return this._controller.value;\n  }\n\n  onSetup() {\n    this._media = useMediaContext();\n\n    if (hasProvidedContext(menuContext)) {\n      this._menu = useContext(menuContext);\n    }\n  }\n\n  onConnect(el) {\n    effect(this._watchValue.bind(this));\n    effect(this._watchHintText.bind(this));\n  }\n\n  getOptions() {\n    const {\n      rates,\n      normalLabel\n    } = this.$props;\n    return rates().map(rate => ({\n      label: rate === 1 ? normalLabel : rate + \"\\xD7\",\n      value: rate + \"\"\n    }));\n  }\n\n  _watchValue() {\n    this._controller.value = this._getValue();\n  }\n\n  _watchHintText() {\n    const {\n      normalLabel\n    } = this.$props,\n          {\n      playbackRate\n    } = this._media.$state,\n          rate = playbackRate();\n    this._menu?._hint.set(rate === 1 ? normalLabel() : rate + \"\\xD7\");\n  }\n\n  _getValue() {\n    const {\n      playbackRate\n    } = this._media.$state;\n    return playbackRate() + \"\";\n  }\n\n  _onValueChange(value, trigger) {\n    const rate = +value;\n\n    this._media.remote.changePlaybackRate(rate, trigger);\n\n    this.dispatch(\"change\", {\n      detail: rate,\n      trigger\n    });\n  }\n\n}\n\nSpeedRadioGroup.props = {\n  normalLabel: \"Normal\",\n  rates: [0.25, 0.5, 0.75, 1, 1.25, 1.5, 1.75, 2]\n};\n\n__decorateClass$2([prop], SpeedRadioGroup.prototype, \"value\", 1);\n\n__decorateClass$2([method], SpeedRadioGroup.prototype, \"getOptions\", 1);\n\nvar __defProp$1 = Object.defineProperty;\nvar __getOwnPropDesc$1 = Object.getOwnPropertyDescriptor;\n\nvar __decorateClass$1 = (decorators, target, key, kind) => {\n  var result = kind > 1 ? void 0 : kind ? __getOwnPropDesc$1(target, key) : target;\n\n  for (var i = decorators.length - 1, decorator; i >= 0; i--) if (decorator = decorators[i]) result = (kind ? decorator(target, key, result) : decorator(result)) || result;\n\n  if (kind && result) __defProp$1(target, key, result);\n  return result;\n};\n\nclass QualityRadioGroup extends Component {\n  constructor() {\n    super();\n    this._sortedQualities = computed(() => {\n      const {\n        qualities\n      } = this._media.$state;\n      return [...qualities()].sort((a, b) => b.height === a.height ? b.bitrate - a.bitrate : b.height - a.height);\n    });\n    this._controller = new RadioGroupController();\n    this._controller._onValueChange = this._onValueChange.bind(this);\n  }\n\n  get value() {\n    return this._controller.value;\n  }\n\n  get disabled() {\n    const {\n      canSetQuality,\n      qualities\n    } = this._media.$state;\n    return !canSetQuality() || qualities().length === 0;\n  }\n\n  onSetup() {\n    this._media = useMediaContext();\n\n    if (hasProvidedContext(menuContext)) {\n      this._menu = useContext(menuContext);\n    }\n  }\n\n  onConnect(el) {\n    effect(this._watchValue.bind(this));\n    effect(this._watchControllerDisabled.bind(this));\n    effect(this._watchHintText.bind(this));\n  }\n\n  getOptions() {\n    const {\n      autoLabel,\n      hideBitrate\n    } = this.$props;\n    return [{\n      value: \"auto\",\n      label: autoLabel\n    }, ...this._sortedQualities().map(quality => {\n      const rate = `${round(quality.bitrate / 1e6, 2)} Mbps`;\n      return {\n        quality,\n        label: quality.height + \"p\",\n        value: this._getQualityId(quality),\n        bitrate: () => !hideBitrate() ? rate : null\n      };\n    })];\n  }\n\n  _watchValue() {\n    this._controller.value = this._getValue();\n  }\n\n  _watchHintText() {\n    const {\n      autoLabel\n    } = this.$props,\n          {\n      autoQuality,\n      quality\n    } = this._media.$state,\n          qualityText = quality() ? quality().height + \"p\" : \"\";\n    this._menu?._hint.set(!autoQuality() ? qualityText : autoLabel() + ` (${qualityText})`);\n  }\n\n  _watchControllerDisabled() {\n    const {\n      qualities\n    } = this._media.$state;\n    this._menu?._disable(qualities().length === 0);\n  }\n\n  _onValueChange(value, trigger) {\n    if (this.disabled) return;\n\n    if (value === \"auto\") {\n      this._media.remote.changeQuality(-1, trigger);\n\n      this.dispatch(\"change\", {\n        detail: \"auto\",\n        trigger\n      });\n      return;\n    }\n\n    const {\n      qualities\n    } = this._media.$state,\n          index = peek(qualities).findIndex(quality => this._getQualityId(quality) === value);\n\n    if (index >= 0) {\n      const quality = peek(qualities)[index];\n\n      this._media.remote.changeQuality(index, trigger);\n\n      this.dispatch(\"change\", {\n        detail: quality,\n        trigger\n      });\n    }\n  }\n\n  _getValue() {\n    const {\n      quality,\n      autoQuality\n    } = this._media.$state;\n    if (autoQuality()) return \"auto\";\n    const currentQuality = quality();\n    return currentQuality ? this._getQualityId(currentQuality) : \"auto\";\n  }\n\n  _getQualityId(quality) {\n    return quality.height + \"_\" + quality.bitrate;\n  }\n\n}\n\nQualityRadioGroup.props = {\n  autoLabel: \"Auto\",\n  hideBitrate: false\n};\n\n__decorateClass$1([prop], QualityRadioGroup.prototype, \"value\", 1);\n\n__decorateClass$1([prop], QualityRadioGroup.prototype, \"disabled\", 1);\n\n__decorateClass$1([method], QualityRadioGroup.prototype, \"getOptions\", 1);\n\nclass Gesture extends Component {\n  constructor() {\n    super(...arguments);\n    this._provider = null;\n    this._presses = 0;\n    this._pressTimerId = -1;\n  }\n\n  onSetup() {\n    this._media = useMediaContext();\n    const {\n      event,\n      action\n    } = this.$props;\n    this.setAttributes({\n      event,\n      action\n    });\n  }\n\n  onAttach(el) {\n    el.setAttribute(\"data-media-gesture\", \"\");\n    el.style.setProperty(\"pointer-events\", \"none\");\n  }\n\n  onConnect(el) {\n    this._provider = this._media.player.el?.querySelector(\"[data-media-provider]\");\n    effect(this._attachListener.bind(this));\n  }\n\n  _attachListener() {\n    let eventType = this.$props.event();\n    if (!this._provider || !eventType) return;\n\n    if (/^dbl/.test(eventType)) {\n      eventType = eventType.split(/^dbl/)[1];\n    }\n\n    listenEvent(this._provider, eventType, this._acceptEvent.bind(this));\n  }\n\n  _acceptEvent(event) {\n    if (!this._inBounds(event) || isPointerEvent(event) && (event.button !== 0 || this._media.activeMenu)) {\n      return;\n    }\n\n    event.MEDIA_GESTURE = true;\n    event.preventDefault();\n    const isDblEvent = peek(this.$props.event)?.startsWith(\"dbl\");\n\n    if (!isDblEvent) {\n      if (this._presses === 0) {\n        setTimeout(() => {\n          if (this._presses === 1) this._handleEvent(event);\n        }, 250);\n      }\n    } else if (this._presses === 1) {\n      queueMicrotask(() => this._handleEvent(event));\n      clearTimeout(this._pressTimerId);\n      this._presses = 0;\n      return;\n    }\n\n    if (this._presses === 0) {\n      this._pressTimerId = window.setTimeout(() => {\n        this._presses = 0;\n      }, 275);\n    }\n\n    this._presses++;\n  }\n\n  _handleEvent(event) {\n    this.el.setAttribute(\"data-triggered\", \"\");\n    requestAnimationFrame(() => {\n      if (this._isTopLayer()) {\n        this._performAction(peek(this.$props.action), event);\n      }\n\n      requestAnimationFrame(() => {\n        this.el.removeAttribute(\"data-triggered\");\n      });\n    });\n  }\n  /** Validate event occurred in gesture bounds. */\n\n\n  _inBounds(event) {\n    if (!this.el) return false;\n\n    if (isPointerEvent(event) || isMouseEvent(event) || isTouchEvent(event)) {\n      const touch = isTouchEvent(event) ? event.touches[0] : void 0;\n      const clientX = touch?.clientX ?? event.clientX;\n      const clientY = touch?.clientY ?? event.clientY;\n      const rect = this.el.getBoundingClientRect();\n      const inBounds = clientY >= rect.top && clientY <= rect.bottom && clientX >= rect.left && clientX <= rect.right;\n      return event.type.includes(\"leave\") ? !inBounds : inBounds;\n    }\n\n    return true;\n  }\n  /** Validate gesture has the highest z-index in this triggered group. */\n\n\n  _isTopLayer() {\n    const gestures = this._media.player.el.querySelectorAll(\"[data-media-gesture][data-triggered]\");\n\n    return Array.from(gestures).sort((a, b) => +getComputedStyle(b).zIndex - +getComputedStyle(a).zIndex)[0] === this.el;\n  }\n\n  _performAction(action, trigger) {\n    if (!action) return;\n    const willTriggerEvent = new DOMEvent(\"will-trigger\", {\n      detail: action,\n      cancelable: true,\n      trigger\n    });\n    this.dispatchEvent(willTriggerEvent);\n    if (willTriggerEvent.defaultPrevented) return;\n    const [method, value] = action.replace(/:([a-z])/, \"-$1\").split(\":\");\n\n    if (action.includes(\":fullscreen\")) {\n      this._media.remote.toggleFullscreen(\"prefer-media\", trigger);\n    } else if (action.includes(\"seek:\")) {\n      this._media.remote.seek(peek(this._media.$state.currentTime) + (+value || 0), trigger);\n    } else {\n      this._media.remote[kebabToCamelCase(method)](trigger);\n    }\n\n    this.dispatch(\"trigger\", {\n      detail: action,\n      trigger\n    });\n  }\n\n}\n\nGesture.props = {\n  event: void 0,\n  action: void 0\n};\n\nclass CaptionsTextRenderer {\n  constructor(_renderer) {\n    this._renderer = _renderer;\n    this.priority = 10;\n    this._track = null;\n    this._disposal = createDisposalBin();\n  }\n\n  attach() {}\n\n  canRender() {\n    return true;\n  }\n\n  detach() {\n    this._disposal.empty();\n\n    this._renderer.reset();\n\n    this._track = null;\n  }\n\n  changeTrack(track) {\n    if (!track || this._track === track) return;\n\n    this._disposal.empty();\n\n    if (track.readyState < 2) {\n      this._renderer.reset();\n\n      this._disposal.add(listenEvent(track, \"load\", () => this._changeTrack(track), {\n        once: true\n      }));\n    } else {\n      this._changeTrack(track);\n    }\n\n    this._disposal.add(listenEvent(track, \"add-cue\", event => {\n      this._renderer.addCue(event.detail);\n    }), listenEvent(track, \"remove-cue\", event => {\n      this._renderer.removeCue(event.detail);\n    }));\n\n    this._track = track;\n  }\n\n  _changeTrack(track) {\n    this._renderer.changeTrack({\n      cues: [...track.cues],\n      regions: [...track.regions]\n    });\n  }\n\n}\n\nclass Captions extends Component {\n  onSetup() {\n    this._media = useMediaContext();\n    this.setAttributes({\n      \"aria-hidden\": $ariaBool(this._isHidden.bind(this))\n    });\n  }\n\n  onAttach(el) {\n    el.style.setProperty(\"pointer-events\", \"none\");\n  }\n\n  onConnect(el) {\n    if (this._renderer) {\n      effect(this._watchViewType.bind(this));\n      return;\n    }\n\n    import('media-captions').then(lib => {\n      if (!this.connectScope) return;\n      scoped(() => {\n        this._lib = lib;\n        const {\n          CaptionsRenderer\n        } = this._lib;\n        this._renderer = new CaptionsRenderer(el);\n        this._textRenderer = new CaptionsTextRenderer(this._renderer);\n        effect(this._watchViewType.bind(this));\n      }, this.connectScope);\n    });\n  }\n\n  onDestroy() {\n    if (this._textRenderer) {\n      this._textRenderer.detach();\n\n      this._media.textRenderers.remove(this._textRenderer);\n    }\n\n    this._renderer?.destroy();\n  }\n\n  _isHidden() {\n    const {\n      textTrack\n    } = this._media.$state,\n          track = textTrack();\n    return !track || !isTrackCaptionKind(track);\n  }\n\n  _watchViewType() {\n    const {\n      viewType\n    } = this._media.$state;\n\n    if (viewType() === \"audio\") {\n      return this._setupAudioView();\n    } else {\n      return this._setupVideoView();\n    }\n  }\n\n  _setupAudioView() {\n    effect(this._onTrackChange.bind(this));\n    return () => {\n      this.el.textContent = \"\";\n    };\n  }\n\n  _onTrackChange() {\n    if (this._isHidden()) return;\n    const {\n      textTrack\n    } = this._media.$state;\n\n    this._onCueChange();\n\n    listenEvent(textTrack(), \"cue-change\", this._onCueChange.bind(this));\n    effect(this._onUpdateTimedNodes.bind(this));\n  }\n\n  _onCueChange() {\n    this.el.textContent = \"\";\n    const {\n      currentTime,\n      textTrack\n    } = this._media.$state,\n          time = peek(currentTime),\n          activeCues = peek(textTrack).activeCues;\n    const {\n      renderVTTCueString\n    } = this._lib;\n\n    for (const cue of activeCues) {\n      const cueEl = document.createElement(\"div\");\n      cueEl.setAttribute(\"data-part\", \"cue\");\n      cueEl.innerHTML = renderVTTCueString(cue, time);\n      this.el.append(cueEl);\n    }\n  }\n\n  _onUpdateTimedNodes() {\n    const {\n      currentTime\n    } = this._media.$state,\n          {\n      updateTimedVTTCueNodes\n    } = this._lib;\n    updateTimedVTTCueNodes(this.el, currentTime());\n  }\n\n  _setupVideoView() {\n    effect(this._watchTextDirection.bind(this));\n    effect(this._watchMediaTime.bind(this));\n\n    this._media.textRenderers.add(this._textRenderer);\n\n    return () => {\n      this.el.textContent = \"\";\n\n      this._textRenderer.detach();\n\n      this._media.textRenderers.remove(this._textRenderer);\n    };\n  }\n\n  _watchTextDirection() {\n    this._renderer.dir = this.$props.textDir();\n  }\n\n  _watchMediaTime() {\n    if (this._isHidden()) return;\n    const {\n      currentTime\n    } = this._media.$state;\n    this._renderer.currentTime = currentTime();\n  }\n\n}\n\nCaptions.props = {\n  textDir: \"ltr\"\n};\n\nclass Poster extends Component {\n  onSetup() {\n    this._media = useMediaContext();\n\n    this._watchImgSrc();\n\n    this._watchImgAlt();\n\n    this._watchHidden();\n  }\n\n  onAttach(el) {\n    el.style.setProperty(\"pointer-events\", \"none\");\n    effect(this._watchImg.bind(this));\n    effect(this._watchImgSrc.bind(this));\n    effect(this._watchImgAlt.bind(this));\n    effect(this._watchHidden.bind(this));\n    const {\n      started\n    } = this._media.$state;\n    this.setAttributes({\n      \"data-visible\": () => !started(),\n      \"data-loading\": this._isLoading.bind(this),\n      \"data-error\": this._hasError.bind(this),\n      \"data-hidden\": this.$state.hidden\n    });\n  }\n\n  onConnect(el) {\n    const {\n      canLoad,\n      poster\n    } = this._media.$state;\n    window.requestAnimationFrame(() => {\n      if (!canLoad()) preconnect(poster());\n    });\n    effect(this._onLoadStart.bind(this));\n  }\n\n  _hasError() {\n    const {\n      error\n    } = this.$state;\n    return !isNull(error());\n  }\n\n  _watchHidden() {\n    const {\n      src\n    } = this.$props,\n          {\n      poster\n    } = this._media.$state;\n    this.$state.hidden.set(this._hasError() || !(src() || poster()));\n  }\n\n  _isLoading() {\n    const {\n      loading,\n      hidden\n    } = this.$state;\n    return !hidden() && loading();\n  }\n\n  _watchImg() {\n    const img = this.$state.img();\n    if (!img) return;\n    listenEvent(img, \"load\", this._onLoad.bind(this));\n    listenEvent(img, \"error\", this._onError.bind(this));\n  }\n\n  _watchImgSrc() {\n    const {\n      src: _src\n    } = this.$props,\n          {\n      src\n    } = this.$state,\n          {\n      canLoad,\n      poster\n    } = this._media.$state;\n\n    const _poster = _src() || poster();\n\n    src.set(canLoad() && _poster.length ? _poster : null);\n  }\n\n  _watchImgAlt() {\n    const {\n      src,\n      alt\n    } = this.$state;\n    alt.set(src() ? this.$props.alt() : null);\n  }\n\n  _onLoadStart() {\n    const {\n      loading,\n      error\n    } = this.$state,\n          {\n      canLoad,\n      poster\n    } = this._media.$state;\n    loading.set(canLoad() && !!poster());\n    error.set(null);\n  }\n\n  _onLoad() {\n    const {\n      loading,\n      error\n    } = this.$state;\n    loading.set(false);\n    error.set(null);\n  }\n\n  _onError(event) {\n    const {\n      loading,\n      error\n    } = this.$state;\n    loading.set(false);\n    error.set(event);\n  }\n\n}\n\nPoster.props = {\n  src: void 0,\n  alt: void 0\n};\nPoster.state = new State({\n  img: null,\n  src: null,\n  alt: null,\n  loading: true,\n  error: null,\n  hidden: false\n});\n\nclass Time extends Component {\n  onSetup() {\n    this._media = useMediaContext();\n\n    this._watchTime();\n\n    const {\n      type,\n      remainder\n    } = this.$props;\n    this.setAttributes({\n      \"data-type\": type,\n      \"data-remainder\": remainder\n    });\n  }\n\n  onAttach(el) {\n    effect(this._watchTime.bind(this));\n  }\n\n  _watchTime() {\n    const {\n      type,\n      remainder,\n      padHours,\n      padMinutes,\n      showHours\n    } = this.$props,\n          seconds = this._getSeconds(type()),\n          duration = this._media.$state.duration();\n\n    if (!Number.isFinite(seconds + duration)) {\n      this.$state.timeText.set(\"LIVE\");\n      return;\n    }\n\n    const time = remainder() ? Math.max(0, duration - seconds) : seconds,\n          formattedTime = formatTime(time, padHours(), padMinutes(), showHours());\n    this.$state.timeText.set(formattedTime);\n  }\n\n  _getSeconds(type) {\n    const {\n      bufferedEnd,\n      duration,\n      currentTime\n    } = this._media.$state;\n\n    switch (type) {\n      case \"buffered\":\n        return bufferedEnd();\n\n      case \"duration\":\n        return duration();\n\n      default:\n        return currentTime();\n    }\n  }\n\n}\n\nTime.props = {\n  type: \"current\",\n  showHours: false,\n  padHours: null,\n  padMinutes: null,\n  remainder: false\n};\nTime.state = new State({\n  timeText: \"\"\n});\nvar __defProp = Object.defineProperty;\nvar __getOwnPropDesc = Object.getOwnPropertyDescriptor;\n\nvar __decorateClass = (decorators, target, key, kind) => {\n  var result = kind > 1 ? void 0 : kind ? __getOwnPropDesc(target, key) : target;\n\n  for (var i = decorators.length - 1, decorator; i >= 0; i--) if (decorator = decorators[i]) result = (kind ? decorator(target, key, result) : decorator(result)) || result;\n\n  if (kind && result) __defProp(target, key, result);\n  return result;\n};\n\nclass DefaultLayout extends Component {\n  constructor() {\n    super(...arguments);\n    this.menuContainer = null;\n  }\n\n  get isMatch() {\n    return this._whenQueryList.matches;\n  }\n\n  get isSmallLayout() {\n    return this._whenSmQueryList.matches;\n  }\n\n  onSetup() {\n    const {\n      when,\n      smallWhen,\n      thumbnails,\n      translations,\n      menuGroup,\n      noModal\n    } = this.$props;\n    this._whenQueryList = PlayerQueryList.create(when);\n    this._whenSmQueryList = PlayerQueryList.create(smallWhen);\n    this.setAttributes({\n      \"data-match\": this._whenQueryList.$matches,\n      \"data-size\": () => this._whenSmQueryList.matches ? \"sm\" : null\n    });\n    const self = this;\n    provideContext(defaultLayoutContext, {\n      smQueryList: this._whenSmQueryList,\n      thumbnails,\n      translations,\n      menuGroup,\n      noModal,\n\n      get menuContainer() {\n        return self.menuContainer;\n      }\n\n    });\n  }\n\n}\n\nDefaultLayout.props = {\n  when: \"\",\n  smallWhen: \"\",\n  thumbnails: \"\",\n  customIcons: false,\n  translations: null,\n  menuGroup: \"bottom\",\n  noModal: false\n};\n\n__decorateClass([prop], DefaultLayout.prototype, \"menuContainer\", 2);\n\n__decorateClass([prop], DefaultLayout.prototype, \"isMatch\", 1);\n\n__decorateClass([prop], DefaultLayout.prototype, \"isSmallLayout\", 1);\n\nclass DefaultAudioLayout extends DefaultLayout {}\n\nDefaultAudioLayout.props = { ..._get(_getPrototypeOf(DefaultAudioLayout), \"props\", DefaultAudioLayout),\n  when: \"(view-type: audio)\",\n  smallWhen: \"(width < 576)\"\n};\n\nclass DefaultVideoLayout extends DefaultLayout {}\n\nDefaultVideoLayout.props = { ..._get(_getPrototypeOf(DefaultVideoLayout), \"props\", DefaultVideoLayout),\n  when: \"(view-type: video)\",\n  smallWhen: \"(width < 576) or (height < 380)\"\n};\n\nfunction getDefaultLayoutLang(translations, word) {\n  return translations()?.[word] ?? word;\n}\n\nconst defaultLayoutContext = createContext();\n\nfunction useDefaultLayoutContext() {\n  return useContext(defaultLayoutContext);\n}\n\nexport { LiveButton as $, ARIAKeyShortcuts as A, isHTMLAudioElement as B, isHTMLVideoElement as C, DefaultAudioLayout as D, isHTMLMediaElement as E, FullscreenController as F, sliderContext as G, HLSProviderLoader as H, DefaultLayout as I, defaultLayoutContext as J, getDefaultLayoutLang as K, Logger as L, MediaProvider as M, Controls as N, Tooltip as O, PlayerQueryList as P, TooltipContent as Q, ToggleButton as R, Slider as S, Thumbnail as T, PlayButton as U, VideoQualityList as V, CaptionButton as W, FullscreenButton as X, MuteButton as Y, PIPButton as Z, SeekButton as _, MediaPlayer as a, sliderState as a0, SliderController as a1, SliderVideo as a2, SliderValue as a3, SliderPreview as a4, updateSliderPreviewPlacement as a5, VolumeSlider as a6, TimeSlider as a7, SliderChapters as a8, Menu as a9, MenuButton as aa, MenuPortal as ab, menuPortalContext as ac, MenuItems as ad, RadioGroup as ae, Radio as af, ChaptersRadioGroup as ag, AudioRadioGroup as ah, CaptionsRadioGroup as ai, SpeedRadioGroup as aj, QualityRadioGroup as ak, Gesture as al, Captions as am, Poster as an, Time as ao, ThumbnailsLoader as ap, FocusVisibleController as aq, tooltipContext as ar, useDefaultLayoutContext as b, DefaultVideoLayout as c, formatSpokenTime as d, List as e, formatTime as f, canFullscreen as g, ScreenOrientationController as h, MediaRemoteControl as i, MediaControls as j, MEDIA_KEY_SHORTCUTS as k, mediaState as l, mediaContext as m, TimeRange as n, getTimeRangesStart as o, getTimeRangesEnd as p, TextRenderers as q, TextTrackList as r, softResetMediaState as s, AudioTrackList as t, useMediaContext as u, AudioProviderLoader as v, VideoProviderLoader as w, isAudioProvider as x, isVideoProvider as y, isHLSProvider as z };","map":{"version":3,"sources":["/home/ann/dev/studip/54/public/plugins_packages/RasmusFuhse/LernmodulePlugin/vue/node_modules/vidstack/dist/dev/chunks/vidstack-1c6c4f6e.js"],"names":["D","DOMEvent","J","EventsTarget","V","ViewController","l","listenEvent","o","onDispose","h","signal","p","peek","O","isArray","y","isUndefined","A","isNumber","S","State","P","tick","Q","createContext","v","useContext","C","Component","e","effect","t","isKeyboardEvent","j","computed","R","root","M","unwrap","T","kebabToCamelCase","x","camelToKebabCase","k","isString","i","isKeyboardClick","U","waitIdlePeriod","q","appendTriggerEvent","f","setAttribute","I","deferredPromise","g","getScope","W","provideContext","L","animationFrameThrottle","X","uppercaseFirstChar","a","setStyle","s","scoped","Y","prop","Z","method","_","noop","$","ariaBool$1","a0","isWriteSignal","G","isNull","a1","hasProvidedContext","u","useState","F","createScope","r","isPointerEvent","a2","isMouseEvent","a3","isTouchEvent","a4","createDisposalBin","isTrackCaptionKind","TextTrackSymbol","TextTrack","preconnect","getRequestCredentials","findActiveCue","observeActiveTextTrack","b","isCueActive","ListSymbol","canOrientScreen","AUDIO_EXTENSIONS","AUDIO_TYPES","VIDEO_EXTENSIONS","m","VIDEO_TYPES","isHLSSrc","canPlayHLSNatively","isHLSSupported","round","n","IS_IPHONE","c","canChangeVolume","clampNumber","IS_SAFARI","getNumberOfDecimalPlaces","QualitySymbol","coerceToError","setAttributeIfEmpty","hasAnimation","requestScopedAnimationFrame","d","autoPlacement","onPress","setARIALabel","isElementParent","_a$1","GROUPED_LOG","Symbol","GroupedLog","constructor","logger","level","title","parent","logs","log","data","push","labelledLog","label","groupStart","groupEnd","dispatch","isGroupedLog","Logger","_target","error","warn","info","debug","errorGroup","warnGroup","infoGroup","debugGroup","setTarget","newTarget","dispatchEvent","bubbles","composed","detail","_a","List","arguments","_items","length","readonly","_readonly","toArray","iterator","values","_add","item","trigger","index","Object","defineProperty","get","includes","_remove","indexOf","_onRemove","splice","_reset","_setReadonly","_onReset","key","fullscreenEnabled","fullscreenElement","requestFullscreen","exitFullscreen","fullscreenchange","fullscreenerror","fullscreen","webkit","moz","ms$1","document$1","window","document","vendor","keys","fscreen","element","requestFullscreenFunction","bind","fullscreenPseudoClass","addEventListener","type","handler","options","removeEventListener","Boolean","val","onfullscreenchange","toLowerCase","onfullscreenerror","fscreen$1","CAN_FULLSCREEN","FullscreenController","_listening","_active","active","supported","onConnect","_onFullscreenChange","_onFullscreenError","_onDisconnect","exit","event","isFullscreen","el","enter","assertFullscreenAPI","canFullscreen","host","matches","Error","CAN_USE_SCREEN_ORIENTATION_API","ScreenOrientationController","_type","getScreenOrientation","_locked","locked","portrait","startsWith","landscape","screen","orientation","_onOrientationChange","query","matchMedia","onchange","unlock","set","lock","_currentLock","lockType","assertScreenOrientationAPI","innerWidth","innerHeight","TimeRange","_ranges","start","end","throwIfEmpty","throwIfOutOfRange","Infinity","getTimeRangesStart","range","min","value","getTimeRangesEnd","max","fnName","mediaState","audioTracks","audioTrack","autoplay","autoplayError","buffered","duration","canLoad","canPictureInPicture","canPlay","controls","controlsVisible","crossorigin","poster","currentTime","ended","loop","logLevel","mediaType","muted","paused","played","playing","playsinline","pictureInPicture","preload","playbackRate","qualities","quality","autoQuality","canSetQuality","canSetVolume","seekable","seeking","source","src","sources","started","textTracks","textTrack","volume","waiting","viewType","providedViewType","inferredViewType","streamType","providedStreamType","inferredStreamType","currentSrc","bufferedStart","bufferedEnd","seekableStart","seekableEnd","seekableWindow","Math","pointer","width","height","mediaWidth","mediaHeight","userBehindLiveEdge","liveEdgeTolerance","minLiveDVRWindow","canSeek","test","Number","isFinite","live","liveEdgeStart","liveSyncPosition","liveEdge","liveEdgeWindow","autoplaying","DO_NOT_RESET_ON_SRC_CHANGE","Set","softResetMediaState","$media","reset","has","mediaContext","useMediaContext","MediaRemoteControl","_logger","_player","_prevTrackIndex","target","getPlayer","player","setPlayer","startLoading","_dispatchRequest","play","pause","mute","unmute","enterFullscreen","enterPictureInPicture","exitPictureInPicture","time","seek","seekToLiveEdge","changeVolume","changeAudioTrack","changeQuality","requestAutoQuality","changeTextTrackMode","mode","changePlaybackRate","rate","resumeControls","pauseControls","togglePaused","_noPlayerWarning","name","state","toggleControls","showing","show","hide","toggleMuted","toggleFullscreen","togglePictureInPicture","disableCaptions","tracks","track","toggleCaptions","findIndex","track2","default","request","shouldUsePlayer","body","Node","contains","canPlayQueue","_enqueue","console","MediaPlayerController","MediaControls","_idleTimer","_pausedTracking","_focusedItem","defaultDelay","$state","delay","_clearIdleTimer","_changeVisibility","resume","_watchPaused","onPlay","_onPlay","onPause","_onPause","listen","onStopIdle","_onStopIdle","eventType","clearTimeout","MEDIA_GESTURE","focus","preventDefault","requestAnimationFrame","visible","_onChange","setTimeout","scope","activeElement","NativeTextRenderer","priority","_display","_video","_track","_tracks","canRender","attach","video","addTrack","add","_attachTrack","removeTrack","_native","remove","delete","changeTrack","current","setDisplay","display","detach","clear","_createTrackElement","HTMLElement","append","createElement","isDefault","isSupported","id","kind","language","srclang","_copyCues","native","cues","cue","addCue","nativeTrack","isShowing","setMode","TextRenderers","_media","_renderers","_nativeDisplay","_nativeRenderer","_customRenderer","_textTracks","_watchControls","_detach","_onAddTrack","_onRemoveTrack","_update","$iosControls","renderer","_attachVideo","_addNativeTrack","_removeNativeTrack","currentTrack","selected","_nativeHLS","customRenderer","sort","find","loader","TextTrackList","_canLoad","_defaults","_onTrackModeChangeBind","_onTrackModeChange","init","isTrack","_crossorigin","_onModeChange","getById","getByKind","kinds","Array","filter","SELECTED","SelectList","selectedIndex","_select","_onUserSelect","prev","changed","AudioTrackList","globalEval","eval","equalsRE","notRE","andRE","orRE","pxRE","PlayerQueryList","store","_evaluation","_mediaProps","_mediaMatches","$matches","currentEval","_mediaStore","replaceValue","replace","_query","dispose","_watchQuery","_watchMatches","_dispose","queryList","trim","split","mediaQueries","join","playerQueries","mediaQuery","onChange","evaluation","_buildQueryEval","validProps","record","query2","matchAll","Event","map","destroy","create","media","VideoQualityList","_auto","switch","auto","_setAuto","autoSelect","_enableAuto","isAudioProvider","provider","$$PROVIDER_TYPE","isVideoProvider","isHLSProvider","isHTMLAudioElement","HTMLAudioElement","isHTMLVideoElement","HTMLVideoElement","isHTMLMediaElement","MEDIA_KEY_SHORTCUTS","seekBackward","seekForward","volumeUp","volumeDown","speedUp","slowDown","MODIFIER_KEYS","BUTTON_SELECTORS","IGNORE_SELECTORS","MediaKeyboardController","_timeSlider","_onTargetChange","keyDisabled","keyTarget","$props","$active","querySelector","activePlayer","composedPath","Element","localName","_onKeyUp","_onKeyDown","_onPreventVideoKeys","capture","focusedEl","_getMatchingMethod","callback","stopPropagation","_forwardTimeKeyboardEvent","remote","_seekTotal","volumeSlider","KeyboardEvent","shiftKey","metaKey","_seeking","value2","keyShortcuts","ariaKeys","method2","some","keys2","replaceSymbolKeys","every","_calcSeekAmount","seekBy","forward","SYMBOL_KEY_MAP","num","ARIAKeyShortcuts","_shortcut","onAttach","getAttribute","shortcuts","AudioProviderLoader","load","AudioProvider","VideoProviderLoader","context","VideoProvider","HLSProviderLoader","HLSProvider","MEDIA_ATTRIBUTES","mediaAttributes","mediaPlayerProps","fullscreenOrientation","preferNativeHLS","controlsDelay","MEDIA_EVENTS","MediaEventsLogger","_onMediaEvent","MediaLoadController","_callback","observer","IntersectionObserver","entries","isIntersecting","disconnect","observe","seenAutoplayWarning","MediaPlayerDelegate","_handle","_dispatch","_ready","_attemptAutoplay","muteMsg","Queue","_queue","Map","_serve","items","_delete","_size","size","MediaRequestContext","_looping","_replaying","MediaRequestManager","_stateMgr","_request","_wasPIPActive","_provider","$provider","_controls","_fullscreen","_orientation","names","getOwnPropertyNames","getPrototypeOf","handle","_handleRequest","_onControlsHideDelayChange","_onFullscreenSupportChange","_onPiPSupportChange","_play","requestEvent","throwIfNotReadyForPlayback","errorEvent","createEvent","_pause","_seekToLiveEdge","_enterFullscreen","adapter","throwIfFullscreenNotSupported","_exitPictureInPicture","_exitFullscreen","result","_enterPictureInPicture","_throwIfPIPNotSupported","_onPictureInPictureError","boundTime","isOriginTrusted","abs","newVolume","functionDebounce","debounce","fn","wait","callFirst","timeout","debouncedFn","flush","call","debounceWrapper","apply","args","callNow","cancel","functionThrottle","throttle","interval","timeoutId","throttledFn","leading","trailing","throttleWrapper","TRACKED_EVENT","MediaStateManager","_trackedEvents","_firingWaiting","_isPlayingOnDisconnect","_satisfyRequest","_waitingTrigger","_fireWaiting","_addTextTrackListeners","_addQualityListeners","_addAudioTrackListeners","_resumePlaybackOnConnect","_pausePlaybackOnDisconnect","_resetTracking","_stopWaiting","_onTextTracksChange","_onTextTrackModeChange","_onQualitiesChange","_onQualityChange","_onAutoQualityChange","_onCanSetQualityChange","_onAudioTracksChange","_onAudioTrackChange","prevProvider","newProvider","_resetMediaState","currentViewType","_onCanPlayDetail","isNaN","stopImmediatePropagation","playEvent","isConnected","_updateActiveCues","waitingEvent","origin","originEvent","isTrusted","MediaStateSync","onSetup","_onLogLevelChange","_onAutoplayChange","_onPosterChange","_onLoopChange","_onControlsChange","_onCrossOriginChange","_onPlaysinlineChange","_onLiveToleranceChange","_onLiveChange","_onLiveEdgeChange","LOCAL_STORAGE_KEY","savedColors","getLogColor","saveLogColor","color","generateColor","overwrite","localStorage","setItem","JSON","stringify","random","colors","parse","getItem","LogLevelValue","freeze","silent","LogLevelColor","ms","msAbs","LogPrinter","_level","path","eventTargetName","$$COMPONENT_NAME","tagName","hint","groupCollapsed","toUpperCase","slice","unshift","printGroup","print","_printTimeDiff","printStackTrace","_lastLogged","labelledPrint","_calcLastLogTimeDiff","performance","now","diff","trace","groupedLog","$keyboard","altKey","ctrlKey","FocusVisibleController","_focused","updateFocusAttr","_onPointerEnter","_onPointerLeave","_onFocus","_onBlur","focused","updateHoverAttr","isFocused","isHovering","RequestQueue","_serving","_pending","_isServing","_waitForFlush","promise","_start","_flush","_stop","_release","resolve","__defProp$f","__getOwnPropDesc$f","getOwnPropertyDescriptor","__decorateClass$f","decorators","decorator","_MediaPlayer","_initState","logPrinter","_isIOSControls","textRenderers","_requestMgr","delegate","_setupMediaAttributes","_watchCanPlay","_watchMuted","_watchVolume","_watchCurrentTime","_watchPlaysinline","_watchPlaybackRate","_watchTitle","_watchOrientation","_onFindPlayer","then","pointerQuery","_onPointerChange","resize","ResizeObserver","_onResize","onDestroy","providedProps","prop2","_onProvidedTypesChange","isLive","typeText","newTitle","removeAttribute","currentTitle","setAttributes","$attrs","alias","attrName","clientWidth","clientHeight","_queuePausedUpdate","_queueMutedUpdate","_queueCurrentTimeUpdate","_queueVolumeUpdate","clampedVolume","inline","_queuePlaysinlineUpdate","_queuePlaybackRateUpdate","matchQuery","props","prototype","MediaPlayer","resolveStreamTypeFromHLSManifest","manifestSrc","requestInit","fetch","res","text","manifest","renditionURI","resolveHLSRenditionURI","URL","href","resolveTargetDuration","match","lines","line","parseFloat","warned","SETUP","SourceSelection","_domSources","_loader","_initialize","HLS_LOADER","VIDEO_LOADER","AUDIO_LOADER","_loaders","normalizeSrc","loader2","connect","_notifySourceChange","_notifyLoaderChange","_onSourcesChange","_onSourceChange","_onConnect","_onLoadSource","currentSource","newSource","_findNewSource","noMatch","credentials","abort","AbortController","Promise","all","headers","catch","sources2","aborted","newLoader","isSameSrc","setup","loadSource","src2","Tracks","_domTracks","_prevTracks","_onTracksChange","newTracks","oldTrack","newTrack","createId","__defProp$e","__getOwnPropDesc$e","__decorateClass$e","MediaProvider","_loadRafId","_sources","mutation","MutationObserver","_onMutation","attributes","childList","passive","cancelAnimationFrame","_runLoader","_destroyProvider","offsetWidth","offsetHeight","children","HTMLSourceElement","HTMLTrackElement","Controls","_watchHideDelay","_isShowing","_hideControls","side","isHidden","hideDelay","Popper","_delegate","_showTimerId","_hideRafId","_stopAnimationEndListener","_watchTrigger","_trigger","_listen","content","_content","style","removeProperty","_showDelay","isAnimated","onHide","stop","once","tooltipContext","Tooltip","_id","showDelay","_onShowingChange","setProperty","_attachTrigger","_detachTrigger","_attachContent","_detachContent","tooltipName","TooltipContent","placement","_attach","assign","position","top","left","tooltip","connectScope","_watchPlacement","offset","mainOffset","alignOffset","_getTrigger","offsetVarName","xOffset","yOffset","ToggleButtonController","_keyShortcut","disabled","_isPressed","_isARIAPressed","_onMaybePress","_onPressed","hasAttribute","_onPress","__defProp$d","__getOwnPropDesc$d","__decorateClass$d","ToggleButton","_pressed","pressed","defaultPressed","PlayButton","_getLabel","ariaBool","$ariaBool","CaptionButton","_isHidden","FullscreenButton","_isSupported","MuteButton","_getState","$volume","PIPButton","SeekButton","seconds","seekTo","LiveButton","sliderState","pointerValue","dragging","pointing","fillRate","calcRate","fillPercent","pointerRate","pointerPercent","getClampedValue","step","getValueFromRate","boundRate","fill","stepRatio","steps","SliderKeyDirection","Left","ArrowLeft","Up","ArrowUp","Right","ArrowRight","Down","ArrowDown","SliderEventsController","_touchX","_touchStartValue","_onDocumentPointerMove","_updatePointerValue","_getPointerValue","_attachEventListeners","_attachPointerListeners","_swipeGesture","_onTouchStart","_onTouchMove","touches","clientX","_onStartDragging","_isDisabled","_onPointerMove","_onPointerDown","_onDocumentPointerUp","_onDocumentTouchMove","_updateValue","newValue","clampedValue","_onValueChange","event2","_onDragValueChange","thumbPositionRate","rect","getBoundingClientRect","bottom","trackBottom","trackHeight","clientY","trackLeft","trackWidth","_roundValue","_getStep","button","_onDragStart","_onStopDragging","_onDragEnd","_getKeyValue","repeat","_lastDownKey","isValidKey","shiftKeyMultiplier","keyStep","_getKeyStep","modifiedStep","direction","toFixed","sliderValueFormatContext","sliderContext","SliderController","_updateSliderVars","_disabled","_preview","_watchValue","_watchDisabled","_setupAttrs","_watchCSSVars","_getARIADisabled","_getARIAValueNow","_getARIAValueText","Slider","_watchMinMax","cache","pending","registry","ThumbnailsLoader","$src","$cues","_onLoadCues","controller","firstKey","next","parseResponse","Thumbnail","_styleResets","_requestResize","_resize","_thumbnails","_isLoading","_hasError","hidden","_watchImg","_watchHidden","_onLoadStart","_onFindActiveCue","_onResolveThumbnail","img","_onLoaded","_onError","loading","_getTime","activeCue","baseURL","_resetStyles","coords","_resolveThumbnailCoords","_resolveThumbnailSrc","resolvedCoords","coordValues","w","maxWidth","maxHeight","minWidth","minHeight","getComputedStyle","minRatio","parseInt","maxRatio","scale","_style","naturalWidth","naturalHeight","__defProp$c","__getOwnPropDesc$c","__decorateClass$c","SliderVideo","_slider","_watchVideo","_watchSrc","_onSrcChange","_onUpdateTime","readyState","_onCanPlay","canUpdate","padNumberWithZeroes","expectedLength","str","String","actualLength","shouldPad","padLength","padding","parseTime","hours","trunc","minutes","fraction","toPrecision","formatTime","shouldPadHours","shouldPadMinutes","shouldAlwaysShowHours","paddedHours","paddedMinutes","paddedSeconds","formatSpokenTime","spokenParts","__defProp$b","__getOwnPropDesc$b","__decorateClass$b","SliderValue","_format","_text","getValueText","format","decimalPlaces","padHours","padMinutes","showHours","sliderValue","percent","SliderPreview","_updatePlacement","noClamp","updateSliderPreviewPlacement","clamp","styles","right","widthHalf","leftClamp","rightClamp","heightHalf","topClamp","bottomClamp","VolumeSlider","_throttleVolumeChange","_onVolumeChange","mediaVolume","TimeSlider","_chapter","_playingBeforeDragStart","_formatValue","_formatTime","_hasChapters","setStyles","_calcBufferedPercent","_watchSeekingThrottle","_watchPreviewing","_dispatchSeeking","seekingRequestThrottle","_timeToPercent","_seek","pauseWhileDragging","_percentToTime","__defProp$a","__getOwnPropDesc$a","__decorateClass$a","SliderChapters","_titleEl","_currentTrack","_refs","_cues","_$cues","_activeIndex","_activePointerIndex","_bufferedIndex","_updateBufferedPercent","bufferedPercent","_calcPercent","_bufferedPercent","_calcMediaBufferedPercent","activePointerCue","_sliderState","onChapterChange","_onChapterChange","_onTrackChange","setRefs","refs","_updateScope","_setTrack","_build","chapters","_fillGaps","startTime","_updateContainerWidths","_watchFillPercent","_watchPointerPercent","_watchBufferedPercent","_getEndTime","endTime","prevActiveIndex","currentChapter","currentActiveIndex","_findActiveChapterIndex","_updateFillPercents","_updateFillPercent","activeIndex","ref","startIndex","chapterPercent","lastChapter","startPercent","endPercent","VTTCue","currentCue","nextCue","timeDiff","_findParentSlider","_onChapterTitleChange","textContent","node","parentElement","menuContext","FOCUSABLE_ELEMENTS_SELECTOR","selector","VALID_KEYS","MenuFocusController","_index","_el","_elements","_attachMenu","_getFocusableElements","_scroll","_findActiveIndex","container","_getScrollContainer","scrollTop","offsetTop","_focusAt","_closeMenu","_nextIndex","delta","offsetParent","focusableElements","querySelectorAll","elements","is","__defProp$9","__getOwnPropDesc$9","__decorateClass$9","idCount","Menu","_expanded","_isTriggerDisabled","_submenus","_menuObserver","_removeSubmenuBind","_removeSubmenu","_onSubmenuOpenBind","_onSubmenuOpen","_onSubmenuCloseBind","_onSubmenuClose","_popper","closeTarget","_getCloseTarget","_onExpandedChange","triggerElement","contentElement","isSubmenu","_parentMenu","currentIdCount","_menuId","_menuButtonId","_focus","_findScrollContainer","close","_button","_hint","_disable","_attachMenuButton","_attachMenuItems","_attachObserver","_disableMenuButton","_addSubmenu","_watchExpanded","expanded","_isExpanded","_updateMenuItemsHidden","_onPointerUp","_onWindowPointerUp","isMenuItem","isARIADisabled","_stopClickPropagation","watchAttrs","isExpanded","_toggleMediaControls","activeMenu","_onOpen","_onClose","parentNode","menu","paddingTop","paddingBottom","borderTopWidth","borderBottomWidth","child","open","__defProp$8","__getOwnPropDesc$8","__decorateClass$8","MenuButton","_menu","from","pop","MenuPortal","menuPortalContext","_attachElement","_portal","shouldPortal","_getContainer","isPortalled","MenuItems","portal","_getButton","radioControllerContext","RadioGroupController","_group","_value","_controller","_onChangeBind","_values","radio","_addRadio","_removeRadio","_onCheck","_check","currentValue","currentRadio","_findRadio","newRadio","__defProp$7","__getOwnPropDesc$7","__decorateClass$7","RadioGroup","__defProp$6","__getOwnPropDesc$6","__decorateClass$6","Radio","_checked","checked","_addToGroup","group","_onSelect","__defProp$5","__getOwnPropDesc$5","__decorateClass$5","ChaptersRadioGroup","thumbnails","getOptions","_watchControllerDisabled","_getValue","activeCueIndex","playedPercent","__defProp$4","__getOwnPropDesc$4","__decorateClass$4","AudioRadioGroup","_watchHintText","emptyLabel","__defProp$3","__getOwnPropDesc$3","__decorateClass$3","CaptionsRadioGroup","offLabel","index2","__defProp$2","__getOwnPropDesc$2","__decorateClass$2","SpeedRadioGroup","rates","normalLabel","__defProp$1","__getOwnPropDesc$1","__decorateClass$1","QualityRadioGroup","_sortedQualities","bitrate","autoLabel","hideBitrate","_getQualityId","qualityText","currentQuality","Gesture","_presses","_pressTimerId","action","_attachListener","_acceptEvent","_inBounds","isDblEvent","_handleEvent","queueMicrotask","_isTopLayer","_performAction","touch","inBounds","gestures","zIndex","willTriggerEvent","cancelable","defaultPrevented","CaptionsTextRenderer","_renderer","_disposal","empty","_changeTrack","removeCue","regions","Captions","_watchViewType","lib","_lib","CaptionsRenderer","_textRenderer","_setupAudioView","_setupVideoView","_onCueChange","_onUpdateTimedNodes","activeCues","renderVTTCueString","cueEl","innerHTML","updateTimedVTTCueNodes","_watchTextDirection","_watchMediaTime","dir","textDir","Poster","_watchImgSrc","_watchImgAlt","_onLoad","_src","_poster","alt","Time","_watchTime","remainder","_getSeconds","timeText","formattedTime","__defProp","__getOwnPropDesc","__decorateClass","DefaultLayout","menuContainer","isMatch","_whenQueryList","isSmallLayout","_whenSmQueryList","when","smallWhen","translations","menuGroup","noModal","self","defaultLayoutContext","smQueryList","customIcons","DefaultAudioLayout","DefaultVideoLayout","getDefaultLayoutLang","word","useDefaultLayoutContext","B","E","H","K","N","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","ag","ah","ai","aj","ak","al","am","an","ao","ap","aq","ar","z"],"mappings":"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","sourcesContent":["import { D as DOMEvent, J as EventsTarget, V as ViewController, l as listenEvent, o as onDispose, h as signal, p as peek, O as isArray, y as isUndefined, A as isNumber, S as State, P as tick, Q as createContext, v as useContext, C as Component, e as effect, t as isKeyboardEvent, j as computed, R as root, M as unwrap, T as kebabToCamelCase, x as camelToKebabCase, k as isString, i as isKeyboardClick, U as waitIdlePeriod, q as appendTriggerEvent, f as setAttribute, I as deferredPromise, g as getScope, W as provideContext, L as animationFrameThrottle, X as uppercaseFirstChar, a as setStyle, s as scoped, Y as prop, Z as method, _ as noop, $ as ariaBool$1, a0 as isWriteSignal, G as isNull, a1 as hasProvidedContext, u as useState, F as createScope, r as isPointerEvent, a2 as isMouseEvent, a3 as isTouchEvent, a4 as createDisposalBin } from './vidstack-b8ba7e3c.js';\nimport { i as isTrackCaptionKind, T as TextTrackSymbol, a as TextTrack, p as preconnect, g as getRequestCredentials, f as findActiveCue, o as observeActiveTextTrack, b as isCueActive } from './vidstack-dd29a7a5.js';\nimport { L as ListSymbol, a as canOrientScreen, A as AUDIO_EXTENSIONS, l as AUDIO_TYPES, V as VIDEO_EXTENSIONS, m as VIDEO_TYPES, h as isHLSSrc, b as canPlayHLSNatively, i as isHLSSupported, r as round, n as IS_IPHONE, c as canChangeVolume, o as clampNumber, g as IS_SAFARI, j as getNumberOfDecimalPlaces } from './vidstack-e4c46e48.js';\nimport { Q as QualitySymbol, c as coerceToError } from './vidstack-ba5dcbce.js';\nimport { s as setAttributeIfEmpty, h as hasAnimation, r as requestScopedAnimationFrame, d as autoPlacement, o as onPress, e as setARIALabel, i as isElementParent } from './vidstack-b97c0002.js';\nimport 'media-captions';\n\nvar _a$1;\nconst GROUPED_LOG = Symbol(\"GROUPED_LOG\" );\nclass GroupedLog {\n  constructor(logger, level, title, root, parent) {\n    this.logger = logger;\n    this.level = level;\n    this.title = title;\n    this.root = root;\n    this.parent = parent;\n    this[_a$1] = true;\n    this.logs = [];\n  }\n  static {\n    _a$1 = GROUPED_LOG;\n  }\n  log(...data) {\n    this.logs.push({ data });\n    return this;\n  }\n  labelledLog(label, ...data) {\n    this.logs.push({ label, data });\n    return this;\n  }\n  groupStart(title) {\n    return new GroupedLog(this.logger, this.level, title, this.root ?? this, this);\n  }\n  groupEnd() {\n    this.parent?.logs.push(this);\n    return this.parent ?? this;\n  }\n  dispatch() {\n    return this.logger.dispatch(this.level, this.root ?? this);\n  }\n}\nfunction isGroupedLog(data) {\n  return !!data?.[GROUPED_LOG];\n}\n\nclass Logger {\n  constructor() {\n    this._target = null;\n  }\n  error(...data) {\n    return this.dispatch(\"error\", ...data);\n  }\n  warn(...data) {\n    return this.dispatch(\"warn\", ...data);\n  }\n  info(...data) {\n    return this.dispatch(\"info\", ...data);\n  }\n  debug(...data) {\n    return this.dispatch(\"debug\", ...data);\n  }\n  errorGroup(title) {\n    return new GroupedLog(this, \"error\", title);\n  }\n  warnGroup(title) {\n    return new GroupedLog(this, \"warn\", title);\n  }\n  infoGroup(title) {\n    return new GroupedLog(this, \"info\", title);\n  }\n  debugGroup(title) {\n    return new GroupedLog(this, \"debug\", title);\n  }\n  setTarget(newTarget) {\n    this._target = newTarget;\n  }\n  dispatch(level, ...data) {\n    return this._target?.dispatchEvent(\n      new DOMEvent(\"vds-log\", {\n        bubbles: true,\n        composed: true,\n        detail: { level, data }\n      })\n    ) || false;\n  }\n}\n\nvar _a;\nclass List extends EventsTarget {\n  constructor() {\n    super(...arguments);\n    this._items = [];\n    /* @internal */\n    this[_a] = false;\n  }\n  get length() {\n    return this._items.length;\n  }\n  get readonly() {\n    return this[ListSymbol._readonly];\n  }\n  /**\n   * Transform list to an array.\n   */\n  toArray() {\n    return [...this._items];\n  }\n  [(_a = ListSymbol._readonly, Symbol.iterator)]() {\n    return this._items.values();\n  }\n  /* @internal */\n  [ListSymbol._add](item, trigger) {\n    const index = this._items.length;\n    if (!(\"\" + index in this)) {\n      Object.defineProperty(this, index, {\n        get() {\n          return this._items[index];\n        }\n      });\n    }\n    if (this._items.includes(item))\n      return;\n    this._items.push(item);\n    this.dispatchEvent(new DOMEvent(\"add\", { detail: item, trigger }));\n  }\n  /* @internal */\n  [ListSymbol._remove](item, trigger) {\n    const index = this._items.indexOf(item);\n    if (index >= 0) {\n      this[ListSymbol._onRemove]?.(item, trigger);\n      this._items.splice(index, 1);\n      this.dispatchEvent(new DOMEvent(\"remove\", { detail: item, trigger }));\n    }\n  }\n  /* @internal */\n  [ListSymbol._reset](trigger) {\n    for (const item of [...this._items])\n      this[ListSymbol._remove](item, trigger);\n    this._items = [];\n    this[ListSymbol._setReadonly](false, trigger);\n    this[ListSymbol._onReset]?.();\n  }\n  /* @internal */\n  [ListSymbol._setReadonly](readonly, trigger) {\n    if (this[ListSymbol._readonly] === readonly)\n      return;\n    this[ListSymbol._readonly] = readonly;\n    this.dispatchEvent(new DOMEvent(\"readonly-change\", { detail: readonly, trigger }));\n  }\n}\n\nvar key = {\r\n    fullscreenEnabled: 0,\r\n    fullscreenElement: 1,\r\n    requestFullscreen: 2,\r\n    exitFullscreen: 3,\r\n    fullscreenchange: 4,\r\n    fullscreenerror: 5,\r\n    fullscreen: 6\r\n};\r\nvar webkit = [\r\n    'webkitFullscreenEnabled',\r\n    'webkitFullscreenElement',\r\n    'webkitRequestFullscreen',\r\n    'webkitExitFullscreen',\r\n    'webkitfullscreenchange',\r\n    'webkitfullscreenerror',\r\n    '-webkit-full-screen',\r\n];\r\nvar moz = [\r\n    'mozFullScreenEnabled',\r\n    'mozFullScreenElement',\r\n    'mozRequestFullScreen',\r\n    'mozCancelFullScreen',\r\n    'mozfullscreenchange',\r\n    'mozfullscreenerror',\r\n    '-moz-full-screen',\r\n];\r\nvar ms$1 = [\r\n    'msFullscreenEnabled',\r\n    'msFullscreenElement',\r\n    'msRequestFullscreen',\r\n    'msExitFullscreen',\r\n    'MSFullscreenChange',\r\n    'MSFullscreenError',\r\n    '-ms-fullscreen',\r\n];\r\n// so it doesn't throw if no window or document\r\nvar document$1 = typeof window !== 'undefined' && typeof window.document !== 'undefined' ? window.document : {};\r\nvar vendor = (('fullscreenEnabled' in document$1 && Object.keys(key)) ||\r\n    (webkit[0] in document$1 && webkit) ||\r\n    (moz[0] in document$1 && moz) ||\r\n    (ms$1[0] in document$1 && ms$1) ||\r\n    []);\r\nvar fscreen = {\r\n    requestFullscreen: function (element) { return element[vendor[key.requestFullscreen]](); },\r\n    requestFullscreenFunction: function (element) { return element[vendor[key.requestFullscreen]]; },\r\n    get exitFullscreen() { return document$1[vendor[key.exitFullscreen]].bind(document$1); },\r\n    get fullscreenPseudoClass() { return \":\" + vendor[key.fullscreen]; },\r\n    addEventListener: function (type, handler, options) { return document$1.addEventListener(vendor[key[type]], handler, options); },\r\n    removeEventListener: function (type, handler, options) { return document$1.removeEventListener(vendor[key[type]], handler, options); },\r\n    get fullscreenEnabled() { return Boolean(document$1[vendor[key.fullscreenEnabled]]); },\r\n    set fullscreenEnabled(val) { },\r\n    get fullscreenElement() { return document$1[vendor[key.fullscreenElement]]; },\r\n    set fullscreenElement(val) { },\r\n    get onfullscreenchange() { return document$1[(\"on\" + vendor[key.fullscreenchange]).toLowerCase()]; },\r\n    set onfullscreenchange(handler) { return document$1[(\"on\" + vendor[key.fullscreenchange]).toLowerCase()] = handler; },\r\n    get onfullscreenerror() { return document$1[(\"on\" + vendor[key.fullscreenerror]).toLowerCase()]; },\r\n    set onfullscreenerror(handler) { return document$1[(\"on\" + vendor[key.fullscreenerror]).toLowerCase()] = handler; },\r\n};\n\nvar fscreen$1 = fscreen;\n\nconst CAN_FULLSCREEN = fscreen$1.fullscreenEnabled;\nclass FullscreenController extends ViewController {\n  constructor() {\n    super(...arguments);\n    /**\n     * Tracks whether we're the active fullscreen event listener. Fullscreen events can only be\n     * listened to globally on the document so we need to know if they relate to the current host\n     * element or not.\n     */\n    this._listening = false;\n    this._active = false;\n  }\n  get active() {\n    return this._active;\n  }\n  get supported() {\n    return CAN_FULLSCREEN;\n  }\n  onConnect() {\n    listenEvent(fscreen$1, \"fullscreenchange\", this._onFullscreenChange.bind(this));\n    listenEvent(fscreen$1, \"fullscreenerror\", this._onFullscreenError.bind(this));\n    onDispose(this._onDisconnect.bind(this));\n  }\n  async _onDisconnect() {\n    if (CAN_FULLSCREEN)\n      await this.exit();\n  }\n  _onFullscreenChange(event) {\n    const active = isFullscreen(this.el);\n    if (active === this._active)\n      return;\n    if (!active)\n      this._listening = false;\n    this._active = active;\n    this.dispatch(\"fullscreen-change\", { detail: active, trigger: event });\n  }\n  _onFullscreenError(event) {\n    if (!this._listening)\n      return;\n    this.dispatch(\"fullscreen-error\", { detail: null, trigger: event });\n    this._listening = false;\n  }\n  async enter() {\n    try {\n      this._listening = true;\n      if (!this.el || isFullscreen(this.el))\n        return;\n      assertFullscreenAPI();\n      return fscreen$1.requestFullscreen(this.el);\n    } catch (error) {\n      this._listening = false;\n      throw error;\n    }\n  }\n  async exit() {\n    if (!this.el || !isFullscreen(this.el))\n      return;\n    assertFullscreenAPI();\n    return fscreen$1.exitFullscreen();\n  }\n}\nfunction canFullscreen() {\n  return CAN_FULLSCREEN;\n}\nfunction isFullscreen(host) {\n  if (fscreen$1.fullscreenElement === host)\n    return true;\n  try {\n    return host.matches(\n      // @ts-expect-error - `fullscreenPseudoClass` is missing from `@types/fscreen`.\n      fscreen$1.fullscreenPseudoClass\n    );\n  } catch (error) {\n    return false;\n  }\n}\nfunction assertFullscreenAPI() {\n  if (CAN_FULLSCREEN)\n    return;\n  throw Error(\n    \"[vidstack] fullscreen API is not enabled or supported in this environment\" \n  );\n}\n\nconst CAN_USE_SCREEN_ORIENTATION_API = canOrientScreen();\nclass ScreenOrientationController extends ViewController {\n  constructor() {\n    super(...arguments);\n    this._type = signal(getScreenOrientation());\n    this._locked = signal(false);\n  }\n  /**\n   * The current screen orientation type.\n   *\n   * @signal\n   * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/ScreenOrientation}\n   * @see https://w3c.github.io/screen-orientation/#screen-orientation-types-and-locks\n   */\n  get type() {\n    return this._type();\n  }\n  /**\n   * Whether the screen orientation is currently locked.\n   *\n   * @signal\n   * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/ScreenOrientation}\n   * @see https://w3c.github.io/screen-orientation/#screen-orientation-types-and-locks\n   */\n  get locked() {\n    return this._locked();\n  }\n  /**\n   * Whether the viewport is in a portrait orientation.\n   *\n   * @signal\n   */\n  get portrait() {\n    return this._type().startsWith(\"portrait\");\n  }\n  /**\n   * Whether the viewport is in a landscape orientation.\n   *\n   * @signal\n   */\n  get landscape() {\n    return this._type().startsWith(\"landscape\");\n  }\n  /**\n   * Whether the native Screen Orientation API is available.\n   */\n  get supported() {\n    return CAN_USE_SCREEN_ORIENTATION_API;\n  }\n  onConnect() {\n    if (CAN_USE_SCREEN_ORIENTATION_API) {\n      listenEvent(screen.orientation, \"change\", this._onOrientationChange.bind(this));\n    } else {\n      const query = window.matchMedia(\"(orientation: landscape)\");\n      query.onchange = this._onOrientationChange.bind(this);\n      onDispose(() => query.onchange = null);\n    }\n    onDispose(this._onDisconnect.bind(this));\n  }\n  async _onDisconnect() {\n    if (CAN_USE_SCREEN_ORIENTATION_API && this._locked())\n      await this.unlock();\n  }\n  _onOrientationChange(event) {\n    this._type.set(getScreenOrientation());\n    this.dispatch(\"orientation-change\", {\n      detail: {\n        orientation: peek(this._type),\n        lock: this._currentLock\n      },\n      trigger: event\n    });\n  }\n  /**\n   * Locks the orientation of the screen to the desired orientation type using the\n   * Screen Orientation API.\n   *\n   * @param lockType - The screen lock orientation type.\n   * @throws Error - If screen orientation API is unavailable.\n   * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/Screen/orientation}\n   * @see {@link https://w3c.github.io/screen-orientation}\n   */\n  async lock(lockType) {\n    if (peek(this._locked) || this._currentLock === lockType)\n      return;\n    assertScreenOrientationAPI();\n    await screen.orientation.lock(lockType);\n    this._locked.set(true);\n    this._currentLock = lockType;\n  }\n  /**\n   * Unlocks the orientation of the screen to it's default state using the Screen Orientation\n   * API. This method will throw an error if the API is unavailable.\n   *\n   * @throws Error - If screen orientation API is unavailable.\n   * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/Screen/orientation}\n   * @see {@link https://w3c.github.io/screen-orientation}\n   */\n  async unlock() {\n    if (!peek(this._locked))\n      return;\n    assertScreenOrientationAPI();\n    this._currentLock = void 0;\n    await screen.orientation.unlock();\n    this._locked.set(false);\n  }\n}\nfunction assertScreenOrientationAPI() {\n  if (CAN_USE_SCREEN_ORIENTATION_API)\n    return;\n  throw Error(\n    \"[vidstack] screen orientation API is not available\" \n  );\n}\nfunction getScreenOrientation() {\n  if (CAN_USE_SCREEN_ORIENTATION_API)\n    return window.screen.orientation.type;\n  return window.innerWidth >= window.innerHeight ? \"landscape-primary\" : \"portrait-primary\";\n}\n\nclass TimeRange {\n  get length() {\n    return this._ranges.length;\n  }\n  constructor(start, end) {\n    if (isArray(start)) {\n      this._ranges = start;\n    } else if (!isUndefined(start) && !isUndefined(end)) {\n      this._ranges = [[start, end]];\n    } else {\n      this._ranges = [];\n    }\n  }\n  start(index) {\n    throwIfEmpty(this._ranges.length);\n    throwIfOutOfRange(\"start\", index, this._ranges.length - 1);\n    return this._ranges[index][0] ?? Infinity;\n  }\n  end(index) {\n    throwIfEmpty(this._ranges.length);\n    throwIfOutOfRange(\"end\", index, this._ranges.length - 1);\n    return this._ranges[index][1] ?? Infinity;\n  }\n}\nfunction getTimeRangesStart(range) {\n  if (!range.length)\n    return null;\n  let min = range.start(0);\n  for (let i = 1; i < range.length; i++) {\n    const value = range.start(i);\n    if (value < min)\n      min = value;\n  }\n  return min;\n}\nfunction getTimeRangesEnd(range) {\n  if (!range.length)\n    return null;\n  let max = range.end(0);\n  for (let i = 1; i < range.length; i++) {\n    const value = range.end(i);\n    if (value > max)\n      max = value;\n  }\n  return max;\n}\nfunction throwIfEmpty(length) {\n  if (!length)\n    throw new Error(\"`TimeRanges` object is empty.\" );\n}\nfunction throwIfOutOfRange(fnName, index, end) {\n  if (!isNumber(index) || index < 0 || index > end) {\n    throw new Error(\n      `Failed to execute '${fnName}' on 'TimeRanges': The index provided (${index}) is non-numeric or out of bounds (0-${end}).`\n    );\n  }\n}\n\nconst mediaState = new State({\n  audioTracks: [],\n  audioTrack: null,\n  autoplay: false,\n  autoplayError: void 0,\n  buffered: new TimeRange(),\n  duration: 0,\n  canLoad: false,\n  canFullscreen: false,\n  canPictureInPicture: false,\n  canPlay: false,\n  controls: false,\n  controlsVisible: false,\n  crossorigin: null,\n  poster: \"\",\n  currentTime: 0,\n  ended: false,\n  error: void 0,\n  fullscreen: false,\n  loop: false,\n  logLevel: \"warn\" ,\n  mediaType: \"unknown\",\n  muted: false,\n  paused: true,\n  played: new TimeRange(),\n  playing: false,\n  playsinline: false,\n  pictureInPicture: false,\n  preload: \"metadata\",\n  playbackRate: 1,\n  qualities: [],\n  quality: null,\n  autoQuality: false,\n  canSetQuality: true,\n  canSetVolume: false,\n  seekable: new TimeRange(),\n  seeking: false,\n  source: { src: \"\", type: \"\" },\n  sources: [],\n  started: false,\n  title: \"\",\n  textTracks: [],\n  textTrack: null,\n  volume: 1,\n  waiting: false,\n  get viewType() {\n    return this.providedViewType !== \"unknown\" ? this.providedViewType : this.inferredViewType;\n  },\n  get streamType() {\n    return this.providedStreamType !== \"unknown\" ? this.providedStreamType : this.inferredStreamType;\n  },\n  get currentSrc() {\n    return this.source;\n  },\n  get bufferedStart() {\n    return getTimeRangesStart(this.buffered) ?? 0;\n  },\n  get bufferedEnd() {\n    return getTimeRangesEnd(this.buffered) ?? 0;\n  },\n  get seekableStart() {\n    return getTimeRangesStart(this.seekable) ?? 0;\n  },\n  get seekableEnd() {\n    return this.canPlay ? getTimeRangesEnd(this.seekable) ?? Infinity : 0;\n  },\n  get seekableWindow() {\n    return Math.max(0, this.seekableEnd - this.seekableStart);\n  },\n  // ~~ responsive design ~~\n  pointer: \"fine\",\n  orientation: \"landscape\",\n  width: 0,\n  height: 0,\n  mediaWidth: 0,\n  mediaHeight: 0,\n  // ~~ user props ~~\n  userBehindLiveEdge: false,\n  // ~~ live props ~~\n  liveEdgeTolerance: 10,\n  minLiveDVRWindow: 60,\n  get canSeek() {\n    return /unknown|on-demand|:dvr/.test(this.streamType) && Number.isFinite(this.seekableWindow) && (!this.live || /:dvr/.test(this.streamType) && this.seekableWindow >= this.minLiveDVRWindow);\n  },\n  get live() {\n    return this.streamType.includes(\"live\") || !Number.isFinite(this.duration);\n  },\n  get liveEdgeStart() {\n    return this.live && Number.isFinite(this.seekableEnd) ? Math.max(0, (this.liveSyncPosition ?? this.seekableEnd) - this.liveEdgeTolerance) : 0;\n  },\n  get liveEdge() {\n    return this.live && (!this.canSeek || !this.userBehindLiveEdge && this.currentTime >= this.liveEdgeStart);\n  },\n  get liveEdgeWindow() {\n    return this.live && Number.isFinite(this.seekableEnd) ? this.seekableEnd - this.liveEdgeStart : 0;\n  },\n  // ~~ internal props ~~\n  autoplaying: false,\n  inferredViewType: \"unknown\",\n  providedViewType: \"unknown\",\n  providedStreamType: \"unknown\",\n  inferredStreamType: \"unknown\",\n  liveSyncPosition: null\n});\nconst DO_NOT_RESET_ON_SRC_CHANGE = /* @__PURE__ */ new Set([\n  \"autoplay\",\n  \"canFullscreen\",\n  \"canLoad\",\n  \"canPictureInPicture\",\n  \"canSetVolume\",\n  \"controls\",\n  \"crossorigin\",\n  \"fullscreen\",\n  \"height\",\n  \"logLevel\",\n  \"loop\",\n  \"mediaHeight\",\n  \"mediaWidth\",\n  \"mediaType\",\n  \"muted\",\n  \"orientation\",\n  \"pictureInPicture\",\n  \"playsinline\",\n  \"pointer\",\n  \"poster\",\n  \"preload\",\n  \"providedStreamType\",\n  \"inferredViewType\",\n  \"providedViewType\",\n  \"source\",\n  \"sources\",\n  \"textTrack\",\n  \"textTracks\",\n  \"title\",\n  \"volume\",\n  \"width\"\n]);\nfunction softResetMediaState($media) {\n  mediaState.reset($media, (prop) => !DO_NOT_RESET_ON_SRC_CHANGE.has(prop));\n  tick();\n}\n\nconst mediaContext = createContext();\nfunction useMediaContext() {\n  return useContext(mediaContext);\n}\n\nclass MediaRemoteControl {\n  constructor(_logger = new Logger() ) {\n    this._logger = _logger;\n    this._target = null;\n    this._player = null;\n    this._prevTrackIndex = -1;\n  }\n  /**\n   * Set the target from which to dispatch media requests events from. The events should bubble\n   * up from this target to the `<media-player>` element.\n   *\n   * @example\n   * ```ts\n   * const button = document.querySelector('button');\n   * remote.setTarget(button);\n   * ```\n   */\n  setTarget(target) {\n    this._target = target;\n    this._logger?.setTarget(target);\n  }\n  /**\n   * Returns the current `<media-player>` element. This method will attempt to find the player by\n   * searching up from either the given `target` or default target set via `remote.setTarget`.\n   *\n   * @example\n   * ```ts\n   * const player = remote.getPlayer();\n   * ```\n   */\n  getPlayer(target) {\n    if (this._player)\n      return this._player;\n    (target ?? this._target)?.dispatchEvent(\n      new DOMEvent(\"find-media-player\", {\n        detail: (player) => void (this._player = player),\n        bubbles: true,\n        composed: true\n      })\n    );\n    return this._player;\n  }\n  /**\n   * Set the current `<media-player>` element so the remote can support toggle methods such as\n   * `togglePaused` as they rely on the current media state.\n   */\n  setPlayer(player) {\n    this._player = player;\n  }\n  /**\n   * Dispatch a request to start the media loading process. This will only work if the media\n   * player has been initialized with a custom loading strategy `<media-player load=\"custom\">`.\n   *\n   * @docs {@link https://www.vidstack.io/docs/player/core-concepts/loading#loading-strategies}\n   */\n  startLoading(trigger) {\n    this._dispatchRequest(\"media-start-loading\", trigger);\n  }\n  /**\n   * Dispatch a request to begin/resume media playback.\n   */\n  play(trigger) {\n    this._dispatchRequest(\"media-play-request\", trigger);\n  }\n  /**\n   * Dispatch a request to pause media playback.\n   */\n  pause(trigger) {\n    this._dispatchRequest(\"media-pause-request\", trigger);\n  }\n  /**\n   * Dispatch a request to set the media volume to mute (0).\n   */\n  mute(trigger) {\n    this._dispatchRequest(\"media-mute-request\", trigger);\n  }\n  /**\n   * Dispatch a request to unmute the media volume and set it back to it's previous state.\n   */\n  unmute(trigger) {\n    this._dispatchRequest(\"media-unmute-request\", trigger);\n  }\n  /**\n   * Dispatch a request to enter fullscreen.\n   *\n   * @docs {@link https://www.vidstack.io/docs/player/core-concepts/fullscreen#media-remote}\n   */\n  enterFullscreen(target, trigger) {\n    this._dispatchRequest(\"media-enter-fullscreen-request\", trigger, target);\n  }\n  /**\n   * Dispatch a request to exit fullscreen.\n   *\n   * @docs {@link https://www.vidstack.io/docs/player/core-concepts/fullscreen#media-remote}\n   */\n  exitFullscreen(target, trigger) {\n    this._dispatchRequest(\"media-exit-fullscreen-request\", trigger, target);\n  }\n  /**\n   * Dispatch a request to enter picture-in-picture mode.\n   *\n   * @docs {@link https://www.vidstack.io/docs/player/core-concepts/picture-in-picture#media-remote}\n   */\n  enterPictureInPicture(trigger) {\n    this._dispatchRequest(\"media-enter-pip-request\", trigger);\n  }\n  /**\n   * Dispatch a request to exit picture-in-picture mode.\n   *\n   * @docs {@link https://www.vidstack.io/docs/player/core-concepts/picture-in-picture#media-remote}\n   */\n  exitPictureInPicture(trigger) {\n    this._dispatchRequest(\"media-exit-pip-request\", trigger);\n  }\n  /**\n   * Notify the media player that a seeking process is happening and to seek to the given `time`.\n   */\n  seeking(time, trigger) {\n    this._dispatchRequest(\"media-seeking-request\", trigger, time);\n  }\n  /**\n   * Notify the media player that a seeking operation has completed and to seek to the given `time`.\n   * This is generally called after a series of `remote.seeking()` calls.\n   */\n  seek(time, trigger) {\n    this._dispatchRequest(\"media-seek-request\", trigger, time);\n  }\n  seekToLiveEdge(trigger) {\n    this._dispatchRequest(\"media-live-edge-request\", trigger);\n  }\n  /**\n   * Dispatch a request to update the media volume to the given `volume` level which is a value\n   * between 0 and 1.\n   *\n   * @example\n   * ```ts\n   * remote.changeVolume(0); // 0%\n   * remote.changeVolume(0.05); // 5%\n   * remote.changeVolume(0.5); // 50%\n   * remote.changeVolume(0.75); // 70%\n   * remote.changeVolume(1); // 100%\n   * ```\n   */\n  changeVolume(volume, trigger) {\n    this._dispatchRequest(\"media-volume-change-request\", trigger, Math.max(0, Math.min(1, volume)));\n  }\n  /**\n   * Dispatch a request to change the current audio track.\n   *\n   * @example\n   * ```ts\n   * remote.changeAudioTrack(1); // track at index 1\n   * ```\n   */\n  changeAudioTrack(index, trigger) {\n    this._dispatchRequest(\"media-audio-track-change-request\", trigger, index);\n  }\n  /**\n   * Dispatch a request to change the video quality. The special value `-1` represents auto quality\n   * selection.\n   *\n   * @example\n   * ```ts\n   * remote.changeQuality(-1); // auto\n   * remote.changeQuality(1); // quality at index 1\n   * ```\n   */\n  changeQuality(index, trigger) {\n    this._dispatchRequest(\"media-quality-change-request\", trigger, index);\n  }\n  /**\n   * Request auto quality selection.\n   */\n  requestAutoQuality(trigger) {\n    this.changeQuality(-1, trigger);\n  }\n  /**\n   * Dispatch a request to change the mode of the text track at the given index.\n   *\n   * @example\n   * ```ts\n   * remote.changeTextTrackMode(1, 'showing'); // track at index 1\n   * ```\n   */\n  changeTextTrackMode(index, mode, trigger) {\n    this._dispatchRequest(\"media-text-track-change-request\", trigger, {\n      index,\n      mode\n    });\n  }\n  /**\n   * Dispatch a request to change the media playback rate.\n   *\n   * @example\n   * ```ts\n   * remote.changePlaybackRate(0.5); // Half the normal speed\n   * remote.changePlaybackRate(1); // Normal speed\n   * remote.changePlaybackRate(1.5); // 50% faster than normal\n   * remote.changePlaybackRate(2); // Double the normal speed\n   * ```\n   */\n  changePlaybackRate(rate, trigger) {\n    this._dispatchRequest(\"media-rate-change-request\", trigger, rate);\n  }\n  /**\n   * Dispatch a request to resume idle tracking on controls. Refer to for more information.\n   */\n  resumeControls(trigger) {\n    this._dispatchRequest(\"media-resume-controls-request\", trigger);\n  }\n  /**\n   * Dispatch a request to pause controls idle tracking. Pausing tracking will result in the\n   * controls being visible until `remote.resumeControls()` is called. This method\n   * is generally used when building custom controls and you'd like to prevent the UI from\n   * disappearing.\n   *\n   * @example\n   * ```ts\n   * // Prevent controls hiding while menu is being interacted with.\n   * function onSettingsOpen() {\n   *   remote.pauseControls();\n   * }\n   *\n   * function onSettingsClose() {\n   *   remote.resumeControls();\n   * }\n   * ```\n   */\n  pauseControls(trigger) {\n    this._dispatchRequest(\"media-pause-controls-request\", trigger);\n  }\n  /**\n   * Dispatch a request to toggle the media playback state.\n   */\n  togglePaused(trigger) {\n    const player = this.getPlayer(trigger?.target);\n    if (!player) {\n      this._noPlayerWarning(this.togglePaused.name);\n      return;\n    }\n    if (player.state.paused)\n      this.play(trigger);\n    else\n      this.pause(trigger);\n  }\n  /**\n   * Dispatch a request to toggle the controls visibility.\n   */\n  toggleControls(trigger) {\n    const player = this.getPlayer(trigger?.target);\n    if (!player) {\n      this._noPlayerWarning(this.toggleControls.name);\n      return;\n    }\n    if (!player.controls.showing) {\n      player.controls.show(0, trigger);\n    } else {\n      player.controls.hide(0, trigger);\n    }\n  }\n  /**\n   * Dispatch a request to toggle the media muted state.\n   */\n  toggleMuted(trigger) {\n    const player = this.getPlayer(trigger?.target);\n    if (!player) {\n      this._noPlayerWarning(this.toggleMuted.name);\n      return;\n    }\n    if (player.state.muted)\n      this.unmute(trigger);\n    else\n      this.mute(trigger);\n  }\n  /**\n   * Dispatch a request to toggle the media fullscreen state.\n   *\n   * @docs {@link https://www.vidstack.io/docs/player/core-concepts/fullscreen#media-remote}\n   */\n  toggleFullscreen(target, trigger) {\n    const player = this.getPlayer(trigger?.target);\n    if (!player) {\n      this._noPlayerWarning(this.toggleFullscreen.name);\n      return;\n    }\n    if (player.state.fullscreen)\n      this.exitFullscreen(target, trigger);\n    else\n      this.enterFullscreen(target, trigger);\n  }\n  /**\n   * Dispatch a request to toggle the media picture-in-picture mode.\n   *\n   * @docs {@link https://www.vidstack.io/docs/player/core-concepts/picture-in-picture#media-remote}\n   */\n  togglePictureInPicture(trigger) {\n    const player = this.getPlayer(trigger?.target);\n    if (!player) {\n      this._noPlayerWarning(this.togglePictureInPicture.name);\n      return;\n    }\n    if (player.state.pictureInPicture)\n      this.exitPictureInPicture(trigger);\n    else\n      this.enterPictureInPicture(trigger);\n  }\n  /**\n   * Turn captions off.\n   */\n  disableCaptions(trigger) {\n    const player = this.getPlayer(trigger?.target);\n    if (!player) {\n      this._noPlayerWarning(this.disableCaptions.name);\n      return;\n    }\n    const tracks = player.state.textTracks, track = player.state.textTrack;\n    if (track) {\n      const index = tracks.indexOf(track);\n      this.changeTextTrackMode(index, \"disabled\", trigger);\n    }\n  }\n  /**\n   * Dispatch a request to toggle the current captions mode.\n   */\n  toggleCaptions(trigger) {\n    const player = this.getPlayer(trigger?.target);\n    if (!player) {\n      this._noPlayerWarning(this.toggleCaptions.name);\n      return;\n    }\n    const tracks = player.state.textTracks, track = player.state.textTrack;\n    if (track) {\n      const index = tracks.indexOf(track);\n      this.changeTextTrackMode(index, \"disabled\", trigger);\n      this._prevTrackIndex = index;\n    } else {\n      let index = this._prevTrackIndex;\n      if (!tracks[index] || !isTrackCaptionKind(tracks[index])) {\n        index = -1;\n      }\n      if (index === -1) {\n        index = tracks.findIndex((track2) => isTrackCaptionKind(track2) && track2.default);\n      }\n      if (index === -1) {\n        index = tracks.findIndex((track2) => isTrackCaptionKind(track2));\n      }\n      if (index >= 0)\n        this.changeTextTrackMode(index, \"showing\", trigger);\n      this._prevTrackIndex = -1;\n    }\n  }\n  _dispatchRequest(type, trigger, detail) {\n    const request = new DOMEvent(type, {\n      bubbles: true,\n      composed: true,\n      detail,\n      trigger\n    });\n    let target = trigger?.target || null;\n    if (target && target instanceof Component)\n      target = target.el;\n    const shouldUsePlayer = !target || target === document || target === window || target === document.body || this._player?.el && target instanceof Node && !this._player.el.contains(target);\n    target = shouldUsePlayer ? this._target ?? this.getPlayer()?.el : target ?? this._target;\n    {\n      this._logger?.debugGroup(`\\u{1F4E8} dispatching \\`${type}\\``).labelledLog(\"Target\", target).labelledLog(\"Player\", this._player).labelledLog(\"Request Event\", request).labelledLog(\"Trigger Event\", trigger).dispatch();\n    }\n    if (this._player) {\n      this._player.canPlayQueue._enqueue(type, () => target?.dispatchEvent(request));\n    } else {\n      target?.dispatchEvent(request);\n    }\n  }\n  _noPlayerWarning(method) {\n    {\n      console.warn(\n        `[vidstack] attempted to call \\`MediaRemoteControl.${method}\\`() that requires player but failed because remote could not find a parent player element from target`\n      );\n    }\n  }\n}\n\nclass MediaPlayerController extends ViewController {\n}\n\nclass MediaControls extends MediaPlayerController {\n  constructor() {\n    super(...arguments);\n    this._idleTimer = -2;\n    this._pausedTracking = false;\n    this._focusedItem = null;\n    /**\n     * The default amount of delay in milliseconds while media playback is progressing without user\n     * activity to indicate an idle state (i.e., hide controls).\n     *\n     * @defaultValue 2000\n     */\n    this.defaultDelay = 2e3;\n  }\n  /**\n   * Whether media controls are currently visible.\n   */\n  get showing() {\n    return this.$state.controlsVisible();\n  }\n  /**\n   * Show controls.\n   */\n  show(delay = 0, trigger) {\n    this._clearIdleTimer();\n    if (!this._pausedTracking) {\n      this._changeVisibility(true, delay, trigger);\n    }\n  }\n  /**\n   * Hide controls.\n   */\n  hide(delay = this.defaultDelay, trigger) {\n    this._clearIdleTimer();\n    if (!this._pausedTracking) {\n      this._changeVisibility(false, delay, trigger);\n    }\n  }\n  /**\n   * Whether all idle tracking on controls should be paused until resumed again.\n   */\n  pause(trigger) {\n    this._pausedTracking = true;\n    this._clearIdleTimer();\n    this._changeVisibility(true, 0, trigger);\n  }\n  resume(trigger) {\n    this._pausedTracking = false;\n    if (this.$state.paused())\n      return;\n    this._changeVisibility(false, this.defaultDelay, trigger);\n  }\n  onConnect() {\n    effect(this._watchPaused.bind(this));\n    const onPlay = this._onPlay.bind(this), onPause = this._onPause.bind(this);\n    this.listen(\"can-play\", (event) => this.show(0, event));\n    this.listen(\"play\", onPlay);\n    this.listen(\"pause\", onPause);\n    this.listen(\"autoplay-fail\", onPause);\n  }\n  _watchPaused() {\n    const { paused, started, autoplayError } = this.$state;\n    if (paused() || autoplayError() && !started())\n      return;\n    const onStopIdle = this._onStopIdle.bind(this);\n    for (const eventType of [\"pointerup\", \"keydown\"]) {\n      listenEvent(this.el, eventType, onStopIdle);\n    }\n    effect(() => {\n      if (this.$state.pointer() === \"fine\") {\n        listenEvent(this.el, \"pointermove\", onStopIdle);\n      }\n    });\n  }\n  _onPlay(event) {\n    this.show(0, event);\n    this.hide(this.defaultDelay, event);\n  }\n  _onPause(event) {\n    this.show(0, event);\n  }\n  _clearIdleTimer() {\n    window.clearTimeout(this._idleTimer);\n    this._idleTimer = -1;\n  }\n  _onStopIdle(event) {\n    if (event.MEDIA_GESTURE || this._pausedTracking)\n      return;\n    if (isKeyboardEvent(event)) {\n      if (event.key === \"Escape\") {\n        this.el?.focus();\n        this._focusedItem = null;\n      } else if (this._focusedItem) {\n        event.preventDefault();\n        requestAnimationFrame(() => {\n          this._focusedItem?.focus();\n          this._focusedItem = null;\n        });\n      }\n    }\n    this.show(0, event);\n    this.hide(this.defaultDelay, event);\n  }\n  _changeVisibility(visible, delay, trigger) {\n    if (delay === 0) {\n      this._onChange(visible, trigger);\n      return;\n    }\n    this._idleTimer = window.setTimeout(() => {\n      if (!this.scope)\n        return;\n      this._onChange(visible && !this._pausedTracking, trigger);\n    }, delay);\n  }\n  _onChange(visible, trigger) {\n    if (this.$state.controlsVisible() === visible)\n      return;\n    this.$state.controlsVisible.set(visible);\n    if (!visible && document.activeElement && this.el?.contains(document.activeElement)) {\n      this._focusedItem = document.activeElement;\n      requestAnimationFrame(() => this.el?.focus());\n    }\n    this.dispatch(\"controls-change\", {\n      detail: visible,\n      trigger\n    });\n  }\n}\n\nclass NativeTextRenderer {\n  constructor() {\n    this.priority = 0;\n    this._display = true;\n    this._video = null;\n    this._track = null;\n    this._tracks = /* @__PURE__ */ new Set();\n  }\n  canRender() {\n    return true;\n  }\n  attach(video) {\n    this._video = video;\n    video.textTracks.onchange = this._onChange.bind(this);\n  }\n  addTrack(track) {\n    this._tracks.add(track);\n    this._attachTrack(track);\n  }\n  removeTrack(track) {\n    track[TextTrackSymbol._native]?.remove?.();\n    track[TextTrackSymbol._native] = null;\n    this._tracks.delete(track);\n  }\n  changeTrack(track) {\n    const current = track?.[TextTrackSymbol._native];\n    if (current && current.track.mode !== \"showing\") {\n      current.track.mode = \"showing\";\n    }\n    this._track = track;\n  }\n  setDisplay(display) {\n    this._display = display;\n    this._onChange();\n  }\n  detach() {\n    if (this._video)\n      this._video.textTracks.onchange = null;\n    for (const track of this._tracks)\n      this.removeTrack(track);\n    this._tracks.clear();\n    this._video = null;\n    this._track = null;\n  }\n  _attachTrack(track) {\n    if (!this._video)\n      return;\n    const el = track[TextTrackSymbol._native] ??= this._createTrackElement(track);\n    if (el instanceof HTMLElement) {\n      this._video.append(el);\n      el.track.mode = el.default ? \"showing\" : \"hidden\";\n    }\n  }\n  _createTrackElement(track) {\n    const el = document.createElement(\"track\"), isDefault = track.default || track.mode === \"showing\", isSupported = track.src && track.type === \"vtt\";\n    el.id = track.id;\n    el.src = isSupported ? track.src : \"https://cdn.jsdelivr.net/npm/vidstack@next/empty.vtt\";\n    el.label = track.label;\n    el.kind = track.kind;\n    el.default = isDefault;\n    track.language && (el.srclang = track.language);\n    if (isDefault && !isSupported) {\n      this._copyCues(track, el.track);\n    }\n    return el;\n  }\n  _copyCues(track, native) {\n    if (track.src && track.type === \"vtt\" || native.cues?.length)\n      return;\n    for (const cue of track.cues)\n      native.addCue(cue);\n  }\n  _onChange(event) {\n    for (const track of this._tracks) {\n      const nativeTrack = track[TextTrackSymbol._native]?.track;\n      if (!nativeTrack)\n        continue;\n      if (!this._display) {\n        nativeTrack.mode = \"disabled\";\n        continue;\n      }\n      const isShowing = nativeTrack.mode === \"showing\";\n      if (isShowing)\n        this._copyCues(track, nativeTrack);\n      track.setMode(isShowing ? \"showing\" : \"disabled\", event);\n    }\n  }\n}\n\nclass TextRenderers {\n  constructor(_media) {\n    this._media = _media;\n    this._video = null;\n    this._renderers = [];\n    this._nativeDisplay = false;\n    this._nativeRenderer = null;\n    this._customRenderer = null;\n    const textTracks = _media.textTracks;\n    this._textTracks = textTracks;\n    effect(this._watchControls.bind(this));\n    onDispose(this._detach.bind(this));\n    listenEvent(textTracks, \"add\", this._onAddTrack.bind(this));\n    listenEvent(textTracks, \"remove\", this._onRemoveTrack.bind(this));\n    listenEvent(textTracks, \"mode-change\", this._update.bind(this));\n  }\n  _watchControls() {\n    const { $state, $iosControls } = this._media;\n    this._nativeDisplay = $state.controls() || $iosControls();\n    this._update();\n  }\n  add(renderer) {\n    this._renderers.push(renderer);\n    this._update();\n  }\n  remove(renderer) {\n    renderer.detach();\n    this._renderers.splice(this._renderers.indexOf(renderer), 1);\n    this._update();\n  }\n  /* @internal */\n  _attachVideo(video) {\n    requestAnimationFrame(() => {\n      this._video = video;\n      if (video) {\n        this._nativeRenderer = new NativeTextRenderer();\n        this._nativeRenderer.attach(video);\n        for (const track of this._textTracks)\n          this._addNativeTrack(track);\n      }\n      this._update();\n    });\n  }\n  _addNativeTrack(track) {\n    if (!isTrackCaptionKind(track))\n      return;\n    this._nativeRenderer?.addTrack(track);\n  }\n  _removeNativeTrack(track) {\n    if (!isTrackCaptionKind(track))\n      return;\n    this._nativeRenderer?.removeTrack(track);\n  }\n  _onAddTrack(event) {\n    this._addNativeTrack(event.detail);\n  }\n  _onRemoveTrack(event) {\n    this._removeNativeTrack(event.detail);\n  }\n  _update() {\n    if (!this._video) {\n      this._detach();\n      return;\n    }\n    const currentTrack = this._textTracks.selected;\n    if (this._nativeDisplay || currentTrack?.[TextTrackSymbol._nativeHLS]) {\n      this._customRenderer?.changeTrack(null);\n      this._nativeRenderer.setDisplay(true);\n      this._nativeRenderer.changeTrack(currentTrack);\n      return;\n    }\n    this._nativeRenderer.setDisplay(false);\n    this._nativeRenderer.changeTrack(null);\n    if (!currentTrack) {\n      this._customRenderer?.changeTrack(null);\n      return;\n    }\n    const customRenderer = this._renderers.sort((a, b) => a.priority - b.priority).find((loader) => loader.canRender(currentTrack));\n    if (this._customRenderer !== customRenderer) {\n      this._customRenderer?.detach();\n      customRenderer?.attach(this._video);\n      this._customRenderer = customRenderer ?? null;\n    }\n    customRenderer?.changeTrack(currentTrack);\n  }\n  _detach() {\n    this._nativeRenderer?.detach();\n    this._nativeRenderer = null;\n    this._customRenderer?.detach();\n    this._customRenderer = null;\n  }\n}\n\nclass TextTrackList extends List {\n  constructor() {\n    super(...arguments);\n    this._canLoad = false;\n    this._defaults = {};\n    this._onTrackModeChangeBind = this._onTrackModeChange.bind(this);\n  }\n  get selected() {\n    const track = this._items.find((t) => t.mode === \"showing\" && isTrackCaptionKind(t));\n    return track ?? null;\n  }\n  add(init, trigger) {\n    const isTrack = init instanceof TextTrack, track = isTrack ? init : new TextTrack(init);\n    if (this._defaults[init.kind] && init.default)\n      delete init.default;\n    track.addEventListener(\"mode-change\", this._onTrackModeChangeBind);\n    this[ListSymbol._add](track, trigger);\n    track[TextTrackSymbol._crossorigin] = this[TextTrackSymbol._crossorigin];\n    if (this._canLoad)\n      track[TextTrackSymbol._canLoad]();\n    if (init.default) {\n      this._defaults[init.kind] = track;\n      track.mode = \"showing\";\n    }\n    return this;\n  }\n  remove(track, trigger) {\n    if (!this._items.includes(track))\n      return;\n    if (track === this._defaults[track.kind])\n      delete this._defaults[track.kind];\n    track.mode = \"disabled\";\n    track[TextTrackSymbol._onModeChange] = null;\n    track.removeEventListener(\"mode-change\", this._onTrackModeChangeBind);\n    this[ListSymbol._remove](track, trigger);\n    return this;\n  }\n  clear(trigger) {\n    for (const track of this._items)\n      this.remove(track, trigger);\n    return this;\n  }\n  getById(id) {\n    return this._items.find((track) => track.id === id) ?? null;\n  }\n  getByKind(kind) {\n    const kinds = Array.isArray(kind) ? kind : [kind];\n    return this._items.filter((track) => kinds.includes(track.kind));\n  }\n  /* @internal */\n  [(TextTrackSymbol._canLoad)]() {\n    if (this._canLoad)\n      return;\n    for (const track of this._items)\n      track[TextTrackSymbol._canLoad]();\n    this._canLoad = true;\n  }\n  _onTrackModeChange(event) {\n    const track = event.detail;\n    if (track.mode === \"showing\") {\n      const kinds = isTrackCaptionKind(track) ? [\"captions\", \"subtitles\"] : [track.kind];\n      for (const t of this._items) {\n        if (t.mode === \"showing\" && t != track && kinds.includes(t.kind)) {\n          t.mode = \"disabled\";\n        }\n      }\n    }\n    this.dispatchEvent(\n      new DOMEvent(\"mode-change\", {\n        detail: event.detail,\n        trigger: event\n      })\n    );\n  }\n}\n\nconst SELECTED = Symbol(\"SELECTED\" );\nclass SelectList extends List {\n  get selected() {\n    return this._items.find((item) => item.selected) ?? null;\n  }\n  get selectedIndex() {\n    return this._items.findIndex((item) => item.selected);\n  }\n  /* @internal */\n  [ListSymbol._onRemove](item, trigger) {\n    this[ListSymbol._select](item, false, trigger);\n  }\n  /* @internal */\n  [ListSymbol._add](item, trigger) {\n    item[SELECTED] = false;\n    Object.defineProperty(item, \"selected\", {\n      get() {\n        return this[SELECTED];\n      },\n      set: (selected) => {\n        if (this.readonly)\n          return;\n        this[ListSymbol._onUserSelect]?.();\n        this[ListSymbol._select](item, selected);\n      }\n    });\n    super[ListSymbol._add](item, trigger);\n  }\n  /* @internal */\n  [ListSymbol._select](item, selected, trigger) {\n    if (selected === item[SELECTED])\n      return;\n    const prev = this.selected;\n    item[SELECTED] = selected;\n    const changed = !selected ? prev === item : prev !== item;\n    if (changed) {\n      if (prev)\n        prev[SELECTED] = false;\n      this.dispatchEvent(\n        new DOMEvent(\"change\", {\n          detail: { prev, current: this.selected },\n          trigger\n        })\n      );\n    }\n  }\n}\n\nclass AudioTrackList extends SelectList {\n  getById(id) {\n    if (id === \"\")\n      return null;\n    return this._items.find((track) => track.id === id) ?? null;\n  }\n}\n\nconst globalEval = eval;\nconst equalsRE = /:\\s+'?\"?(.*?)'?\"?\\)/g, notRE = /\\s+not\\s+/g, andRE = /\\s+and\\s+/g, orRE = /\\s+or\\s+/g, pxRE = /(\\d)px/g;\nclass PlayerQueryList extends EventsTarget {\n  constructor(store, query) {\n    super();\n    this._evaluation = signal(\"true\");\n    this._mediaProps = /* @__PURE__ */ new Set();\n    this._mediaMatches = signal(true);\n    this.$matches = computed(() => {\n      let currentEval = this._evaluation();\n      if (currentEval === \"never\")\n        return false;\n      for (const prop of this._mediaProps) {\n        const value = this._mediaStore[prop](), replaceValue = isString(value) ? `'${value}'` : value + \"\";\n        currentEval = currentEval.replace(camelToKebabCase(prop), replaceValue);\n      }\n      return globalEval(`!!(${currentEval})`) && this._mediaMatches();\n    });\n    this._query = query;\n    this._mediaStore = store;\n    root((dispose) => {\n      effect(this._watchQuery.bind(this));\n      effect(this._watchMatches.bind(this));\n      this._dispose = dispose;\n    });\n  }\n  static {\n    this.create = (query) => {\n      const media = useMediaContext();\n      return new PlayerQueryList(media.$state, query);\n    };\n  }\n  get query() {\n    return unwrap(this._query);\n  }\n  get matches() {\n    return this.$matches();\n  }\n  _watchQuery() {\n    const query = this.query;\n    if (query === \"\")\n      return;\n    if (query === \"never\") {\n      this._evaluation.set(query);\n      return;\n    }\n    const queryList = query.trim().split(/\\s*,\\s*/g), mediaQueries = queryList.filter((q) => q.startsWith(\"@media\")).join(\",\"), playerQueries = queryList.filter((q) => !q.startsWith(\"@media\"));\n    if (mediaQueries.length) {\n      const mediaQuery = window.matchMedia(mediaQueries), onChange = () => void this._mediaMatches.set(mediaQuery.matches);\n      onChange();\n      listenEvent(mediaQuery, \"change\", onChange);\n    }\n    if (playerQueries.length) {\n      const evaluation = this._buildQueryEval(playerQueries), validProps = Object.keys(mediaState.record);\n      for (const query2 of evaluation.matchAll(/\\(([-a-zA-Z]+)\\s/g)) {\n        const prop = kebabToCamelCase(query2[1]);\n        if (validProps.includes(prop)) {\n          this._mediaProps.add(prop);\n        }\n      }\n      this._evaluation.set(evaluation);\n    }\n    return () => {\n      this._mediaProps.clear();\n      this._evaluation.set(\"true\");\n      this._mediaMatches.set(true);\n    };\n  }\n  _watchMatches() {\n    this.$matches();\n    this.dispatchEvent(new Event(\"change\"));\n  }\n  _buildQueryEval(queryList) {\n    return queryList.map(\n      (query) => \"(\" + query.replace(equalsRE, ' == \"$1\")').replace(notRE, \"!\").replace(andRE, \" && \").replace(orRE, \" || \").replace(pxRE, \"$1\").trim() + \")\"\n    ).join(\" || \");\n  }\n  destroy() {\n    this._dispose();\n  }\n}\n\nclass VideoQualityList extends SelectList {\n  constructor() {\n    super(...arguments);\n    this._auto = false;\n    /**\n     * Configures quality switching:\n     *\n     * - `current`: Trigger an immediate quality level switch. This will abort the current fragment\n     * request if any, flush the whole buffer, and fetch fragment matching with current position\n     * and requested quality level.\n     *\n     * - `next`: Trigger a quality level switch for next fragment. This could eventually flush\n     * already buffered next fragment.\n     *\n     * - `load`: Set quality level for next loaded fragment.\n     *\n     * @see {@link https://vidstack.io/docs/player/core-concepts/quality#switch}\n     * @see {@link https://github.com/video-dev/hls.js/blob/master/docs/API.md#quality-switch-control-api}\n     */\n    this.switch = \"current\";\n  }\n  /**\n   * Whether automatic quality selection is enabled.\n   */\n  get auto() {\n    return this._auto || this.readonly;\n  }\n  /* @internal */\n  [(ListSymbol._onUserSelect)]() {\n    this[QualitySymbol._setAuto](false);\n  }\n  /* @internal */\n  [ListSymbol._onReset](trigger) {\n    this[QualitySymbol._setAuto](false, trigger);\n  }\n  /**\n   * Request automatic quality selection (if supported). This will be a no-op if the list is\n   * `readonly` as that already implies auto-selection.\n   */\n  autoSelect(trigger) {\n    if (this.readonly || this._auto || !this[QualitySymbol._enableAuto])\n      return;\n    this[QualitySymbol._enableAuto]?.();\n    this[QualitySymbol._setAuto](true, trigger);\n  }\n  /* @internal */\n  [QualitySymbol._setAuto](auto, trigger) {\n    if (this._auto === auto)\n      return;\n    this._auto = auto;\n    this.dispatchEvent(\n      new DOMEvent(\"auto-change\", {\n        detail: auto,\n        trigger\n      })\n    );\n  }\n}\n\nfunction isAudioProvider(provider) {\n  return provider?.$$PROVIDER_TYPE === \"AUDIO\";\n}\nfunction isVideoProvider(provider) {\n  return provider?.$$PROVIDER_TYPE === \"VIDEO\";\n}\nfunction isHLSProvider(provider) {\n  return provider?.$$PROVIDER_TYPE === \"HLS\";\n}\nfunction isHTMLAudioElement(element) {\n  return element instanceof HTMLAudioElement;\n}\nfunction isHTMLVideoElement(element) {\n  return element instanceof HTMLVideoElement;\n}\nfunction isHTMLMediaElement(element) {\n  return isHTMLAudioElement(element) || isHTMLVideoElement(element);\n}\n\nconst MEDIA_KEY_SHORTCUTS = {\n  togglePaused: \"k Space\",\n  toggleMuted: \"m\",\n  toggleFullscreen: \"f\",\n  togglePictureInPicture: \"i\",\n  toggleCaptions: \"c\",\n  seekBackward: \"j J ArrowLeft\",\n  seekForward: \"l L ArrowRight\",\n  volumeUp: \"ArrowUp\",\n  volumeDown: \"ArrowDown\",\n  speedUp: \">\",\n  slowDown: \"<\"\n};\nconst MODIFIER_KEYS = /* @__PURE__ */ new Set([\"Shift\", \"Alt\", \"Meta\", \"Control\"]), BUTTON_SELECTORS = 'button, [role=\"button\"]', IGNORE_SELECTORS = 'input, textarea, select, [contenteditable], [role^=\"menuitem\"]';\nclass MediaKeyboardController extends MediaPlayerController {\n  constructor(_media) {\n    super();\n    this._media = _media;\n    this._timeSlider = null;\n  }\n  onConnect() {\n    effect(this._onTargetChange.bind(this));\n  }\n  _onTargetChange() {\n    const { keyDisabled, keyTarget } = this.$props;\n    if (keyDisabled())\n      return;\n    const target = keyTarget() === \"player\" ? this.el : document, $active = signal(false);\n    if (target === this.el) {\n      this.listen(\"focusin\", () => $active.set(true));\n      this.listen(\"focusout\", (event) => {\n        if (!this.el.contains(event.target))\n          $active.set(false);\n      });\n    } else {\n      if (!peek($active))\n        $active.set(document.querySelector(\"[data-media-player]\") === this.el);\n      listenEvent(document, \"focusin\", (event) => {\n        const activePlayer = event.composedPath().find((el) => el instanceof Element && el.localName === \"media-player\");\n        if (activePlayer !== void 0)\n          $active.set(this.el === activePlayer);\n      });\n    }\n    effect(() => {\n      if (!$active())\n        return;\n      listenEvent(target, \"keyup\", this._onKeyUp.bind(this));\n      listenEvent(target, \"keydown\", this._onKeyDown.bind(this));\n      listenEvent(target, \"keydown\", this._onPreventVideoKeys.bind(this), { capture: true });\n    });\n  }\n  _onKeyUp(event) {\n    const focusedEl = document.activeElement;\n    if (!event.key || !this.$state.canSeek() || focusedEl?.matches(IGNORE_SELECTORS)) {\n      return;\n    }\n    let { method, value } = this._getMatchingMethod(event);\n    if (!isString(value) && !isArray(value)) {\n      value?.callback(event);\n      return;\n    }\n    if (method?.startsWith(\"seek\")) {\n      event.preventDefault();\n      event.stopPropagation();\n      if (this._timeSlider) {\n        this._forwardTimeKeyboardEvent(event, method === \"seekForward\");\n        this._timeSlider = null;\n      } else {\n        this._media.remote.seek(this._seekTotal, event);\n        this._seekTotal = void 0;\n      }\n    }\n    if (method?.startsWith(\"volume\")) {\n      const volumeSlider = this.el.querySelector(\"[data-media-volume-slider]\");\n      volumeSlider?.dispatchEvent(\n        new KeyboardEvent(\"keyup\", {\n          key: method === \"volumeUp\" ? \"Up\" : \"Down\",\n          shiftKey: event.shiftKey,\n          trigger: event\n        })\n      );\n    }\n  }\n  _onKeyDown(event) {\n    if (!event.key || MODIFIER_KEYS.has(event.key))\n      return;\n    const focusedEl = document.activeElement;\n    if (focusedEl?.matches(IGNORE_SELECTORS) || isKeyboardClick(event) && focusedEl?.matches(BUTTON_SELECTORS)) {\n      return;\n    }\n    let { method, value } = this._getMatchingMethod(event);\n    if (!isString(value) && !isArray(value)) {\n      value?.callback(event);\n      return;\n    }\n    if (!method && !event.metaKey && /[0-9]/.test(event.key)) {\n      event.preventDefault();\n      event.stopPropagation();\n      this._media.remote.seek(this.$state.duration() / 10 * Number(event.key), event);\n      return;\n    }\n    if (!method)\n      return;\n    event.preventDefault();\n    event.stopPropagation();\n    switch (method) {\n      case \"seekForward\":\n      case \"seekBackward\":\n        this._seeking(event, method, method === \"seekForward\");\n        break;\n      case \"volumeUp\":\n      case \"volumeDown\":\n        const volumeSlider = this.el.querySelector(\"[data-media-volume-slider]\");\n        if (volumeSlider) {\n          volumeSlider.dispatchEvent(\n            new KeyboardEvent(\"keydown\", {\n              key: method === \"volumeUp\" ? \"Up\" : \"Down\",\n              shiftKey: event.shiftKey,\n              trigger: event\n            })\n          );\n        } else {\n          const value2 = event.shiftKey ? 0.1 : 0.05;\n          this._media.remote.changeVolume(\n            this.$state.volume() + (method === \"volumeUp\" ? +value2 : -value2),\n            event\n          );\n        }\n        break;\n      case \"toggleFullscreen\":\n        this._media.remote.toggleFullscreen(\"prefer-media\", event);\n        break;\n      case \"speedUp\":\n      case \"slowDown\":\n        const playbackRate = this.$state.playbackRate();\n        this._media.remote.changePlaybackRate(\n          Math.max(0.25, Math.min(2, playbackRate + (method === \"speedUp\" ? 0.25 : -0.25))),\n          event\n        );\n        break;\n      default:\n        this._media.remote[method]?.(event);\n    }\n  }\n  _onPreventVideoKeys(event) {\n    if (isHTMLMediaElement(event.target) && this._getMatchingMethod(event).method) {\n      event.preventDefault();\n    }\n  }\n  _getMatchingMethod(event) {\n    const keyShortcuts = {\n      ...this.$props.keyShortcuts(),\n      ...this._media.ariaKeys\n    };\n    const method = Object.keys(keyShortcuts).find((method2) => {\n      const value = keyShortcuts[method2], keys = isArray(value) ? value.join(\" \") : isString(value) ? value : value?.keys;\n      return (isArray(keys) ? keys : keys?.split(\" \"))?.some((keys2) => {\n        return replaceSymbolKeys(keys2).replace(/Control/g, \"Ctrl\").split(\"+\").every(\n          (key) => MODIFIER_KEYS.has(key) ? event[key.toLowerCase() + \"Key\"] : event.key === key.replace(\"Space\", \" \")\n        );\n      });\n    });\n    return {\n      method,\n      value: method ? keyShortcuts[method] : null\n    };\n  }\n  _calcSeekAmount(event, type) {\n    const seekBy = event.shiftKey ? 10 : 5;\n    return this._seekTotal = Math.max(\n      0,\n      Math.min(\n        (this._seekTotal ?? this.$state.currentTime()) + (type === \"seekForward\" ? +seekBy : -seekBy),\n        this.$state.duration()\n      )\n    );\n  }\n  _forwardTimeKeyboardEvent(event, forward) {\n    this._timeSlider?.dispatchEvent(\n      new KeyboardEvent(event.type, {\n        key: !forward ? \"Left\" : \"Right\",\n        shiftKey: event.shiftKey,\n        trigger: event\n      })\n    );\n  }\n  _seeking(event, type, forward) {\n    if (!this.$state.canSeek())\n      return;\n    if (!this._timeSlider)\n      this._timeSlider = this.el.querySelector(\"[data-media-time-slider]\");\n    if (this._timeSlider) {\n      this._forwardTimeKeyboardEvent(event, forward);\n    } else {\n      this._media.remote.seeking(this._calcSeekAmount(event, type), event);\n    }\n  }\n}\nconst SYMBOL_KEY_MAP = [\"!\", \"@\", \"#\", \"$\", \"%\", \"^\", \"&\", \"*\", \"(\", \")\"];\nfunction replaceSymbolKeys(key) {\n  return key.replace(/Shift\\+(\\d)/g, (_, num) => SYMBOL_KEY_MAP[num - 1]);\n}\n\nclass ARIAKeyShortcuts extends ViewController {\n  constructor(_shortcut) {\n    super();\n    this._shortcut = _shortcut;\n  }\n  onAttach(el) {\n    const { $props, ariaKeys } = useMediaContext(), keys = el.getAttribute(\"aria-keyshortcuts\");\n    if (keys) {\n      ariaKeys[this._shortcut] = keys;\n      {\n        onDispose(() => {\n          delete ariaKeys[this._shortcut];\n        });\n      }\n      return;\n    }\n    const shortcuts = $props.keyShortcuts()[this._shortcut];\n    if (shortcuts) {\n      const keys2 = isArray(shortcuts) ? shortcuts.join(\" \") : isString(shortcuts) ? shortcuts : shortcuts?.keys;\n      el.setAttribute(\"aria-keyshortcuts\", isArray(keys2) ? keys2.join(\" \") : keys2);\n    }\n  }\n}\n\nclass AudioProviderLoader {\n  canPlay({ src, type }) {\n    return isString(src) ? AUDIO_EXTENSIONS.test(src) || AUDIO_TYPES.has(type) || src.startsWith(\"blob:\") && type === \"audio/object\" : type === \"audio/object\";\n  }\n  mediaType() {\n    return \"audio\";\n  }\n  async load() {\n    if (!this.target) {\n      throw Error(\n        \"[vidstack] `<audio>` element was not found - did you forget to include `<media-provider>`?\"\n      );\n    }\n    return new (await import('../providers/vidstack-audio.js')).AudioProvider(this.target);\n  }\n}\n\nclass VideoProviderLoader {\n  canPlay(src) {\n    return isString(src.src) ? VIDEO_EXTENSIONS.test(src.src) || VIDEO_TYPES.has(src.type) || src.src.startsWith(\"blob:\") && src.type === \"video/object\" || isHLSSrc(src) && canPlayHLSNatively() : src.type === \"video/object\";\n  }\n  mediaType() {\n    return \"video\";\n  }\n  async load(context) {\n    if (!this.target) {\n      throw Error(\n        \"[vidstack] `<video>` element was not found - did you forget to include media provider?\"\n      );\n    }\n    return new (await import('../providers/vidstack-video.js')).VideoProvider(this.target, context);\n  }\n}\n\nclass HLSProviderLoader extends VideoProviderLoader {\n  static {\n    this.supported = isHLSSupported();\n  }\n  preconnect() {\n    preconnect(\"https://cdn.jsdelivr.net\", \"preconnect\");\n  }\n  canPlay(src) {\n    return HLSProviderLoader.supported && isHLSSrc(src);\n  }\n  async load(context) {\n    if (!this.target) {\n      throw Error(\n        \"[vidstack] `<video>` element was not found - did you forget to include `<media-provider>`?\"\n      );\n    }\n    return new (await import('../providers/vidstack-hls.js')).HLSProvider(this.target, context);\n  }\n}\n\nconst MEDIA_ATTRIBUTES = Symbol(\"MEDIA_ATTRIBUTES\" );\nconst mediaAttributes = [\n  \"autoplay\",\n  \"autoplayError\",\n  \"canFullscreen\",\n  \"canPictureInPicture\",\n  \"canLoad\",\n  \"canPlay\",\n  \"canSeek\",\n  \"ended\",\n  \"fullscreen\",\n  \"loop\",\n  \"live\",\n  \"liveEdge\",\n  \"mediaType\",\n  \"muted\",\n  \"paused\",\n  \"pictureInPicture\",\n  \"playing\",\n  \"playsinline\",\n  \"seeking\",\n  \"started\",\n  \"streamType\",\n  \"viewType\",\n  \"waiting\"\n];\n\nconst mediaPlayerProps = {\n  autoplay: false,\n  controls: false,\n  currentTime: 0,\n  crossorigin: null,\n  fullscreenOrientation: \"landscape\",\n  load: \"visible\",\n  logLevel: \"warn\" ,\n  loop: false,\n  muted: false,\n  paused: true,\n  playsinline: false,\n  playbackRate: 1,\n  poster: \"\",\n  preload: \"metadata\",\n  preferNativeHLS: false,\n  src: \"\",\n  controlsDelay: 2e3,\n  viewType: \"unknown\",\n  streamType: \"unknown\",\n  volume: 1,\n  liveEdgeTolerance: 10,\n  minLiveDVRWindow: 60,\n  keyDisabled: false,\n  keyTarget: \"player\",\n  keyShortcuts: MEDIA_KEY_SHORTCUTS,\n  title: \"\"\n};\n\nconst MEDIA_EVENTS = [\n  \"abort\",\n  \"can-play\",\n  \"can-play-through\",\n  \"duration-change\",\n  \"emptied\",\n  \"ended\",\n  \"error\",\n  \"fullscreen-change\",\n  \"loaded-data\",\n  \"loaded-metadata\",\n  \"load-start\",\n  \"media-type-change\",\n  \"pause\",\n  \"play\",\n  \"playing\",\n  \"progress\",\n  \"seeked\",\n  \"seeking\",\n  \"source-change\",\n  \"sources-change\",\n  \"stalled\",\n  \"started\",\n  \"suspend\",\n  \"stream-type-change\",\n  \"replay\",\n  // 'time-update',\n  \"view-type-change\",\n  \"volume-change\",\n  \"waiting\"\n] ;\nclass MediaEventsLogger extends MediaPlayerController {\n  constructor(_media) {\n    super();\n    this._media = _media;\n  }\n  onConnect() {\n    const handler = this._onMediaEvent.bind(this);\n    for (const eventType of MEDIA_EVENTS)\n      this.listen(eventType, handler);\n  }\n  _onMediaEvent(event) {\n    this._media.logger?.debugGroup(`\\u{1F4E1} dispatching \\`${event.type}\\``).labelledLog(\"Media Store\", { ...this.$state }).labelledLog(\"Event\", event).dispatch();\n  }\n}\n\nclass MediaLoadController extends MediaPlayerController {\n  constructor(_callback) {\n    super();\n    this._callback = _callback;\n  }\n  async onAttach(el) {\n    const load = this.$props.load();\n    if (load === \"eager\") {\n      requestAnimationFrame(this._callback);\n    } else if (load === \"idle\") {\n      waitIdlePeriod(this._callback);\n    } else if (load === \"visible\") {\n      const observer = new IntersectionObserver((entries) => {\n        if (!this.scope)\n          return;\n        if (entries[0].isIntersecting) {\n          observer.disconnect();\n          this._callback();\n        }\n      });\n      observer.observe(el);\n      return observer.disconnect.bind(observer);\n    }\n  }\n}\n\nlet seenAutoplayWarning = false;\nclass MediaPlayerDelegate {\n  constructor(_handle, _media) {\n    this._handle = _handle;\n    this._media = _media;\n  }\n  _dispatch(type, ...init) {\n    this._handle(new DOMEvent(type, init?.[0]));\n  }\n  async _ready(info, trigger) {\n    const { $state, logger } = this._media;\n    if (peek($state.canPlay))\n      return;\n    this._dispatch(\"can-play\", { detail: info, trigger });\n    tick();\n    {\n      logger?.infoGroup(\"-~-~-~-~-~-~- \\u2705 MEDIA READY -~-~-~-~-~-~-\").labelledLog(\"Media Store\", { ...$state }).labelledLog(\"Trigger Event\", trigger).dispatch();\n    }\n    if ($state.canPlay() && $state.autoplay() && !$state.started()) {\n      await this._attemptAutoplay();\n    }\n  }\n  async _attemptAutoplay() {\n    const { player, $state } = this._media;\n    $state.autoplaying.set(true);\n    try {\n      await player.play();\n      this._dispatch(\"autoplay\", { detail: { muted: $state.muted() } });\n    } catch (error) {\n      if (!seenAutoplayWarning) {\n        const muteMsg = !$state.muted() ? \" Attempting with volume muted will most likely resolve the issue.\" : \"\";\n        this._media.logger?.errorGroup(\"autoplay request failed\").labelledLog(\n          \"Message\",\n          `Autoplay was requested but failed most likely due to browser autoplay policies.${muteMsg}`\n        ).labelledLog(\"Error\", error).labelledLog(\"See\", \"https://developer.chrome.com/blog/autoplay\").dispatch();\n        seenAutoplayWarning = true;\n      }\n      this._dispatch(\"autoplay-fail\", {\n        detail: {\n          muted: $state.muted(),\n          error\n        }\n      });\n    } finally {\n      $state.autoplaying.set(false);\n    }\n  }\n}\n\nclass Queue {\n  constructor() {\n    this._queue = /* @__PURE__ */ new Map();\n  }\n  /**\n   * Queue the given `item` under the given `key` to be processed at a later time by calling\n   * `serve(key)`.\n   */\n  _enqueue(key, item) {\n    if (!this._queue.has(key))\n      this._queue.set(key, /* @__PURE__ */ new Set());\n    this._queue.get(key).add(item);\n  }\n  /**\n   * Process all items in queue for the given `key`.\n   */\n  _serve(key, callback) {\n    const items = this._queue.get(key);\n    if (items)\n      for (const item of items)\n        callback(item);\n    this._queue.delete(key);\n  }\n  /**\n   * Removes all queued items under the given `key`.\n   */\n  _delete(key) {\n    this._queue.delete(key);\n  }\n  /**\n   * The number of items currently queued under the given `key`.\n   */\n  _size(key) {\n    return this._queue.get(key)?.size ?? 0;\n  }\n  /**\n   * Clear all items in the queue.\n   */\n  _reset() {\n    this._queue.clear();\n  }\n}\n\nclass MediaRequestContext {\n  constructor() {\n    this._seeking = false;\n    this._looping = false;\n    this._replaying = false;\n    this._queue = new Queue();\n  }\n}\nclass MediaRequestManager extends MediaPlayerController {\n  constructor(_stateMgr, _request, _media) {\n    super();\n    this._stateMgr = _stateMgr;\n    this._request = _request;\n    this._media = _media;\n    this._wasPIPActive = false;\n    this._provider = _media.$provider;\n    this._controls = new MediaControls();\n    this._fullscreen = new FullscreenController();\n    this._orientation = new ScreenOrientationController();\n  }\n  onConnect() {\n    const names = Object.getOwnPropertyNames(Object.getPrototypeOf(this)), handle = this._handleRequest.bind(this);\n    for (const name of names) {\n      if (name.startsWith(\"media-\")) {\n        this.listen(name, handle);\n      }\n    }\n    this.listen(\"fullscreen-change\", this._onFullscreenChange.bind(this));\n    effect(this._onControlsHideDelayChange.bind(this));\n    effect(this._onFullscreenSupportChange.bind(this));\n    effect(this._onPiPSupportChange.bind(this));\n  }\n  _handleRequest(event) {\n    event.stopPropagation();\n    {\n      this._media.logger?.infoGroup(`\\u{1F4EC} received \\`${event.type}\\``).labelledLog(\"Request\", event).dispatch();\n    }\n    if (peek(this._provider))\n      this[event.type]?.(event);\n  }\n  async _play(requestEvent) {\n    const { canPlay, paused, ended, autoplaying, seekableStart } = this.$state;\n    if (!peek(paused))\n      return;\n    try {\n      const provider = peek(this._provider);\n      throwIfNotReadyForPlayback(provider, peek(canPlay));\n      if (peek(ended)) {\n        provider.currentTime = seekableStart() + 0.1;\n      }\n      return await provider.play();\n    } catch (error) {\n      {\n        this._media.logger?.errorGroup(\"play request failed\").labelledLog(\"Request\", requestEvent).labelledLog(\"Error\", error).dispatch();\n      }\n      const errorEvent = this.createEvent(\"play-fail\", { detail: coerceToError(error) });\n      errorEvent.autoplay = autoplaying();\n      this._stateMgr._handle(errorEvent);\n      throw error;\n    }\n  }\n  async _pause() {\n    const { canPlay, paused } = this.$state;\n    if (peek(paused))\n      return;\n    const provider = peek(this._provider);\n    throwIfNotReadyForPlayback(provider, peek(canPlay));\n    return provider.pause();\n  }\n  _seekToLiveEdge() {\n    const { canPlay, live, liveEdge, canSeek, liveSyncPosition, seekableEnd, userBehindLiveEdge } = this.$state;\n    userBehindLiveEdge.set(false);\n    if (peek(() => !live() || liveEdge() || !canSeek()))\n      return;\n    const provider = peek(this._provider);\n    throwIfNotReadyForPlayback(provider, peek(canPlay));\n    provider.currentTime = liveSyncPosition() ?? seekableEnd() - 2;\n  }\n  async _enterFullscreen(target = \"prefer-media\") {\n    const provider = peek(this._provider);\n    const adapter = target === \"prefer-media\" && this._fullscreen.supported || target === \"media\" ? this._fullscreen : provider?.fullscreen;\n    throwIfFullscreenNotSupported(target, adapter);\n    if (adapter.active)\n      return;\n    if (peek(this.$state.pictureInPicture)) {\n      this._wasPIPActive = true;\n      await this._exitPictureInPicture();\n    }\n    return adapter.enter();\n  }\n  async _exitFullscreen(target = \"prefer-media\") {\n    const provider = peek(this._provider);\n    const adapter = target === \"prefer-media\" && this._fullscreen.supported || target === \"media\" ? this._fullscreen : provider?.fullscreen;\n    throwIfFullscreenNotSupported(target, adapter);\n    if (!adapter.active)\n      return;\n    if (this._orientation.locked)\n      await this._orientation.unlock();\n    try {\n      const result = await adapter.exit();\n      if (this._wasPIPActive && peek(this.$state.canPictureInPicture)) {\n        await this._enterPictureInPicture();\n      }\n      return result;\n    } finally {\n      this._wasPIPActive = false;\n    }\n  }\n  async _enterPictureInPicture() {\n    this._throwIfPIPNotSupported();\n    if (this.$state.pictureInPicture())\n      return;\n    return await this._provider().pictureInPicture.enter();\n  }\n  async _exitPictureInPicture() {\n    this._throwIfPIPNotSupported();\n    if (!this.$state.pictureInPicture())\n      return;\n    return await this._provider().pictureInPicture.exit();\n  }\n  _throwIfPIPNotSupported() {\n    if (this.$state.canPictureInPicture())\n      return;\n    throw Error(\n      `[vidstack] picture-in-picture is not currently available` \n    );\n  }\n  _onControlsHideDelayChange() {\n    this._controls.defaultDelay = this.$props.controlsDelay();\n  }\n  _onFullscreenSupportChange() {\n    const { canLoad, canFullscreen } = this.$state, supported = this._fullscreen.supported || this._provider()?.fullscreen?.supported || false;\n    if (canLoad() && peek(canFullscreen) === supported)\n      return;\n    canFullscreen.set(supported);\n  }\n  _onPiPSupportChange() {\n    const { canLoad, canPictureInPicture } = this.$state, supported = this._provider()?.pictureInPicture?.supported || false;\n    if (canLoad() && peek(canPictureInPicture) === supported)\n      return;\n    canPictureInPicture.set(supported);\n  }\n  [\"media-audio-track-change-request\"](event) {\n    if (this._media.audioTracks.readonly) {\n      {\n        this._media.logger?.warnGroup(`[vidstack] attempted to change audio track but it is currently read-only`).labelledLog(\"Event\", event).dispatch();\n      }\n      return;\n    }\n    const index = event.detail, track = this._media.audioTracks[index];\n    if (track) {\n      this._request._queue._enqueue(\"audioTrack\", event);\n      track.selected = true;\n    } else {\n      this._media.logger?.warnGroup(\"[vidstack] failed audio track change request (invalid index)\").labelledLog(\"Audio Tracks\", this._media.audioTracks.toArray()).labelledLog(\"Index\", index).labelledLog(\"Event\", event).dispatch();\n    }\n  }\n  async [\"media-enter-fullscreen-request\"](event) {\n    try {\n      this._request._queue._enqueue(\"fullscreen\", event);\n      await this._enterFullscreen(event.detail);\n    } catch (error) {\n      this._onFullscreenError(error, event);\n    }\n  }\n  async [\"media-exit-fullscreen-request\"](event) {\n    try {\n      this._request._queue._enqueue(\"fullscreen\", event);\n      await this._exitFullscreen(event.detail);\n    } catch (error) {\n      this._onFullscreenError(error, event);\n    }\n  }\n  async _onFullscreenChange(event) {\n    if (!event.detail)\n      return;\n    try {\n      const lockType = peek(this.$props.fullscreenOrientation);\n      if (this._orientation.supported && !isUndefined(lockType)) {\n        await this._orientation.lock(lockType);\n      }\n    } catch (error) {\n      {\n        this._media.logger?.errorGroup(\"fullscreen orientation change failed\").labelledLog(\"Event\", event).labelledLog(\"Error\", error).dispatch();\n      }\n    }\n  }\n  _onFullscreenError(error, request) {\n    {\n      this._media.logger?.errorGroup(\"fullscreen request failed\").labelledLog(\"Request\", request).labelledLog(\"Error\", error).dispatch();\n    }\n    this._stateMgr._handle(\n      this.createEvent(\"fullscreen-error\", {\n        detail: coerceToError(error)\n      })\n    );\n  }\n  async [\"media-enter-pip-request\"](event) {\n    try {\n      this._request._queue._enqueue(\"pip\", event);\n      await this._enterPictureInPicture();\n    } catch (error) {\n      this._onPictureInPictureError(error, event);\n    }\n  }\n  async [\"media-exit-pip-request\"](event) {\n    try {\n      this._request._queue._enqueue(\"pip\", event);\n      await this._exitPictureInPicture();\n    } catch (error) {\n      this._onPictureInPictureError(error, event);\n    }\n  }\n  _onPictureInPictureError(error, request) {\n    {\n      this._media.logger?.errorGroup(\"pip request failed\").labelledLog(\"Request\", request).labelledLog(\"Error\", error).dispatch();\n    }\n    this._stateMgr._handle(\n      this.createEvent(\"picture-in-picture-error\", {\n        detail: coerceToError(error)\n      })\n    );\n  }\n  [\"media-live-edge-request\"](event) {\n    const { live, liveEdge, canSeek } = this.$state;\n    if (!live() || liveEdge() || !canSeek())\n      return;\n    this._request._queue._enqueue(\"seeked\", event);\n    try {\n      this._seekToLiveEdge();\n    } catch (error) {\n      this._media.logger?.error(\"seek to live edge fail\", error);\n    }\n  }\n  [\"media-loop-request\"](event) {\n    window.requestAnimationFrame(async () => {\n      try {\n        this._request._looping = true;\n        this._request._replaying = true;\n        await this._play(event);\n      } catch (e) {\n        this._request._looping = false;\n        this._request._replaying = false;\n      }\n    });\n  }\n  async [\"media-pause-request\"](event) {\n    if (this.$state.paused())\n      return;\n    try {\n      this._request._queue._enqueue(\"pause\", event);\n      await this._provider().pause();\n    } catch (error) {\n      {\n        this._media.logger?.errorGroup(\"\\u03C0ause request failed\").labelledLog(\"Request\", event).labelledLog(\"Error\", error).dispatch();\n      }\n      this._request._queue._delete(\"pause\");\n      this._media.logger?.error(\"pause-fail\", error);\n    }\n  }\n  async [\"media-play-request\"](event) {\n    if (!this.$state.paused())\n      return;\n    try {\n      this._request._queue._enqueue(\"play\", event);\n      await this._play(event);\n    } catch (e) {\n    }\n  }\n  [\"media-rate-change-request\"](event) {\n    if (this.$state.playbackRate() === event.detail)\n      return;\n    this._request._queue._enqueue(\"rate\", event);\n    this._provider().playbackRate = event.detail;\n  }\n  [\"media-quality-change-request\"](event) {\n    if (this._media.qualities.readonly) {\n      {\n        this._media.logger?.warnGroup(`[vidstack] attempted to change video quality but it is currently read-only`).labelledLog(\"Event\", event).dispatch();\n      }\n      return;\n    }\n    this._request._queue._enqueue(\"quality\", event);\n    const index = event.detail;\n    if (index < 0) {\n      this._media.qualities.autoSelect(event);\n    } else {\n      const quality = this._media.qualities[index];\n      if (quality) {\n        quality.selected = true;\n      } else {\n        this._media.logger?.warnGroup(\"[vidstack] failed quality change request (invalid index)\").labelledLog(\"Qualities\", this._media.qualities.toArray()).labelledLog(\"Index\", index).labelledLog(\"Event\", event).dispatch();\n      }\n    }\n  }\n  [\"media-pause-controls-request\"](event) {\n    this._request._queue._enqueue(\"controls\", event);\n    this._controls.pause(event);\n  }\n  [\"media-resume-controls-request\"](event) {\n    this._request._queue._enqueue(\"controls\", event);\n    this._controls.resume(event);\n  }\n  [\"media-seek-request\"](event) {\n    const { seekableStart, seekableEnd, ended, canSeek, live, userBehindLiveEdge } = this.$state;\n    if (ended())\n      this._request._replaying = true;\n    this._request._seeking = false;\n    this._request._queue._delete(\"seeking\");\n    const boundTime = Math.min(Math.max(seekableStart() + 0.1, event.detail), seekableEnd() - 0.1);\n    if (!Number.isFinite(boundTime) || !canSeek())\n      return;\n    this._request._queue._enqueue(\"seeked\", event);\n    this._provider().currentTime = boundTime;\n    if (live() && event.isOriginTrusted && Math.abs(seekableEnd() - boundTime) >= 2) {\n      userBehindLiveEdge.set(true);\n    }\n  }\n  [\"media-seeking-request\"](event) {\n    this._request._queue._enqueue(\"seeking\", event);\n    this.$state.seeking.set(true);\n    this._request._seeking = true;\n  }\n  [\"media-start-loading\"](event) {\n    if (this.$state.canLoad())\n      return;\n    this._request._queue._enqueue(\"load\", event);\n    this._stateMgr._handle(this.createEvent(\"can-load\"));\n  }\n  [\"media-text-track-change-request\"](event) {\n    const { index, mode } = event.detail, track = this._media.textTracks[index];\n    if (track) {\n      this._request._queue._enqueue(\"textTrack\", event);\n      track.setMode(mode, event);\n    } else {\n      this._media.logger?.warnGroup(\"[vidstack] failed text track change request (invalid index)\").labelledLog(\"Text Tracks\", this._media.textTracks.toArray()).labelledLog(\"Index\", index).labelledLog(\"Event\", event).dispatch();\n    }\n  }\n  [\"media-mute-request\"](event) {\n    if (this.$state.muted())\n      return;\n    this._request._queue._enqueue(\"volume\", event);\n    this._provider().muted = true;\n  }\n  [\"media-unmute-request\"](event) {\n    const { muted, volume } = this.$state;\n    if (!muted())\n      return;\n    this._request._queue._enqueue(\"volume\", event);\n    this._media.$provider().muted = false;\n    if (volume() === 0) {\n      this._request._queue._enqueue(\"volume\", event);\n      this._provider().volume = 0.25;\n    }\n  }\n  [\"media-volume-change-request\"](event) {\n    const { muted, volume } = this.$state;\n    const newVolume = event.detail;\n    if (volume() === newVolume)\n      return;\n    this._request._queue._enqueue(\"volume\", event);\n    this._provider().volume = newVolume;\n    if (newVolume > 0 && muted()) {\n      this._request._queue._enqueue(\"volume\", event);\n      this._provider().muted = false;\n    }\n  }\n}\nfunction throwIfNotReadyForPlayback(provider, canPlay) {\n  if (provider && canPlay)\n    return;\n  throw Error(\n    `[vidstack] media is not ready - wait for \\`can-play\\` event.` \n  );\n}\nfunction throwIfFullscreenNotSupported(target, fullscreen) {\n  if (fullscreen?.supported)\n    return;\n  throw Error(\n    `[vidstack] fullscreen is not currently available on target \\`${target}\\`` \n  );\n}\n\nvar functionDebounce = debounce;\n\nfunction debounce(fn, wait, callFirst) {\n  var timeout = null;\n  var debouncedFn = null;\n\n  var clear = function() {\n    if (timeout) {\n      clearTimeout(timeout);\n\n      debouncedFn = null;\n      timeout = null;\n    }\n  };\n\n  var flush = function() {\n    var call = debouncedFn;\n    clear();\n\n    if (call) {\n      call();\n    }\n  };\n\n  var debounceWrapper = function() {\n    if (!wait) {\n      return fn.apply(this, arguments);\n    }\n\n    var context = this;\n    var args = arguments;\n    var callNow = callFirst && !timeout;\n    clear();\n\n    debouncedFn = function() {\n      fn.apply(context, args);\n    };\n\n    timeout = setTimeout(function() {\n      timeout = null;\n\n      if (!callNow) {\n        var call = debouncedFn;\n        debouncedFn = null;\n\n        return call();\n      }\n    }, wait);\n\n    if (callNow) {\n      return debouncedFn();\n    }\n  };\n\n  debounceWrapper.cancel = clear;\n  debounceWrapper.flush = flush;\n\n  return debounceWrapper;\n}\n\nvar functionThrottle = throttle;\n\nfunction throttle(fn, interval, options) {\n  var timeoutId = null;\n  var throttledFn = null;\n  var leading = (options && options.leading);\n  var trailing = (options && options.trailing);\n\n  if (leading == null) {\n    leading = true; // default\n  }\n\n  if (trailing == null) {\n    trailing = !leading; //default\n  }\n\n  if (leading == true) {\n    trailing = false; // forced because there should be invocation per call\n  }\n\n  var cancel = function() {\n    if (timeoutId) {\n      clearTimeout(timeoutId);\n      timeoutId = null;\n    }\n  };\n\n  var flush = function() {\n    var call = throttledFn;\n    cancel();\n\n    if (call) {\n      call();\n    }\n  };\n\n  var throttleWrapper = function() {\n    var callNow = leading && !timeoutId;\n    var context = this;\n    var args = arguments;\n\n    throttledFn = function() {\n      return fn.apply(context, args);\n    };\n\n    if (!timeoutId) {\n      timeoutId = setTimeout(function() {\n        timeoutId = null;\n\n        if (trailing) {\n          return throttledFn();\n        }\n      }, interval);\n    }\n\n    if (callNow) {\n      callNow = false;\n      return throttledFn();\n    }\n  };\n\n  throttleWrapper.cancel = cancel;\n  throttleWrapper.flush = flush;\n\n  return throttleWrapper;\n}\n\nconst TRACKED_EVENT = /* @__PURE__ */ new Set([\n  \"autoplay\",\n  \"autoplay-fail\",\n  \"can-load\",\n  \"sources-change\",\n  \"source-change\",\n  \"load-start\",\n  \"abort\",\n  \"error\",\n  \"loaded-metadata\",\n  \"loaded-data\",\n  \"can-play\",\n  \"play\",\n  \"play-fail\",\n  \"pause\",\n  \"playing\",\n  \"seeking\",\n  \"seeked\",\n  \"waiting\"\n]);\n\nclass MediaStateManager extends MediaPlayerController {\n  constructor(_request, _media) {\n    super();\n    this._request = _request;\n    this._media = _media;\n    this._trackedEvents = /* @__PURE__ */ new Map();\n    this._firingWaiting = false;\n    this._isPlayingOnDisconnect = false;\n    this[\"seeking\"] = functionThrottle(\n      (event) => {\n        const { seeking, currentTime, paused } = this.$state;\n        seeking.set(true);\n        currentTime.set(event.detail);\n        this._satisfyRequest(\"seeking\", event);\n        if (paused()) {\n          this._waitingTrigger = event;\n          this._fireWaiting();\n        }\n      },\n      150,\n      { leading: true }\n    );\n    this._fireWaiting = functionDebounce(() => {\n      if (!this._waitingTrigger)\n        return;\n      this._firingWaiting = true;\n      const { waiting, playing } = this.$state;\n      waiting.set(true);\n      playing.set(false);\n      const event = this.createEvent(\"waiting\", { trigger: this._waitingTrigger });\n      this._trackedEvents.set(\"waiting\", event);\n      this.dispatch(event);\n      this._waitingTrigger = void 0;\n      this._firingWaiting = false;\n    }, 300);\n  }\n  onAttach(el) {\n    el.setAttribute(\"aria-busy\", \"true\");\n  }\n  onConnect(el) {\n    this._addTextTrackListeners();\n    this._addQualityListeners();\n    this._addAudioTrackListeners();\n    this.listen(\"fullscreen-change\", this[\"fullscreen-change\"].bind(this));\n    this.listen(\"fullscreen-error\", this[\"fullscreen-error\"].bind(this));\n    this._resumePlaybackOnConnect();\n    onDispose(this._pausePlaybackOnDisconnect.bind(this));\n  }\n  _handle(event) {\n    if (!this.scope)\n      return;\n    const type = event.type;\n    this[event.type]?.(event);\n    {\n      if (TRACKED_EVENT.has(type))\n        this._trackedEvents.set(type, event);\n      this.dispatch(event);\n    }\n  }\n  _resumePlaybackOnConnect() {\n    if (!this._isPlayingOnDisconnect)\n      return;\n    if (this._media.$provider()?.paused) {\n      requestAnimationFrame(() => {\n        if (!this.scope)\n          return;\n        this._media.remote.play(new DOMEvent(\"dom-connect\"));\n      });\n    }\n    this._isPlayingOnDisconnect = false;\n  }\n  _pausePlaybackOnDisconnect() {\n    if (this._isPlayingOnDisconnect)\n      return;\n    this._isPlayingOnDisconnect = !this._media.$state.paused();\n    this._media.$provider()?.pause();\n  }\n  _resetTracking() {\n    this._stopWaiting();\n    this._request._replaying = false;\n    this._request._looping = false;\n    this._firingWaiting = false;\n    this._waitingTrigger = void 0;\n    this._trackedEvents.clear();\n  }\n  _satisfyRequest(request, event) {\n    this._request._queue._serve(request, (requestEvent) => {\n      event.request = requestEvent;\n      appendTriggerEvent(event, requestEvent);\n    });\n  }\n  _addTextTrackListeners() {\n    this._onTextTracksChange();\n    this._onTextTrackModeChange();\n    const textTracks = this._media.textTracks;\n    listenEvent(textTracks, \"add\", this._onTextTracksChange.bind(this));\n    listenEvent(textTracks, \"remove\", this._onTextTracksChange.bind(this));\n    listenEvent(textTracks, \"mode-change\", this._onTextTrackModeChange.bind(this));\n  }\n  _addQualityListeners() {\n    const qualities = this._media.qualities;\n    listenEvent(qualities, \"add\", this._onQualitiesChange.bind(this));\n    listenEvent(qualities, \"remove\", this._onQualitiesChange.bind(this));\n    listenEvent(qualities, \"change\", this._onQualityChange.bind(this));\n    listenEvent(qualities, \"auto-change\", this._onAutoQualityChange.bind(this));\n    listenEvent(qualities, \"readonly-change\", this._onCanSetQualityChange.bind(this));\n  }\n  _addAudioTrackListeners() {\n    const audioTracks = this._media.audioTracks;\n    listenEvent(audioTracks, \"add\", this._onAudioTracksChange.bind(this));\n    listenEvent(audioTracks, \"remove\", this._onAudioTracksChange.bind(this));\n    listenEvent(audioTracks, \"change\", this._onAudioTrackChange.bind(this));\n  }\n  _onTextTracksChange(event) {\n    const { textTracks } = this.$state;\n    textTracks.set(this._media.textTracks.toArray());\n    this.dispatch(\"text-tracks-change\", {\n      detail: textTracks(),\n      trigger: event\n    });\n  }\n  _onTextTrackModeChange(event) {\n    if (event)\n      this._satisfyRequest(\"textTrack\", event);\n    const current = this._media.textTracks.selected, { textTrack } = this.$state;\n    if (textTrack() !== current) {\n      textTrack.set(current);\n      this.dispatch(\"text-track-change\", {\n        detail: current,\n        trigger: event\n      });\n    }\n  }\n  _onAudioTracksChange(event) {\n    const { audioTracks } = this.$state;\n    audioTracks.set(this._media.audioTracks.toArray());\n    this.dispatch(\"audio-tracks-change\", {\n      detail: audioTracks(),\n      trigger: event\n    });\n  }\n  _onAudioTrackChange(event) {\n    const { audioTrack } = this.$state;\n    audioTrack.set(this._media.audioTracks.selected);\n    this._satisfyRequest(\"audioTrack\", event);\n    this.dispatch(\"audio-track-change\", {\n      detail: audioTrack(),\n      trigger: event\n    });\n  }\n  _onQualitiesChange(event) {\n    const { qualities } = this.$state;\n    qualities.set(this._media.qualities.toArray());\n    this.dispatch(\"qualities-change\", {\n      detail: qualities(),\n      trigger: event\n    });\n  }\n  _onQualityChange(event) {\n    const { quality } = this.$state;\n    quality.set(this._media.qualities.selected);\n    this._satisfyRequest(\"quality\", event);\n    this.dispatch(\"quality-change\", {\n      detail: quality(),\n      trigger: event\n    });\n  }\n  _onAutoQualityChange() {\n    this.$state.autoQuality.set(this._media.qualities.auto);\n  }\n  _onCanSetQualityChange() {\n    this.$state.canSetQuality.set(!this._media.qualities.readonly);\n  }\n  [\"provider-change\"](event) {\n    const prevProvider = this._media.$provider(), newProvider = event.detail;\n    if (prevProvider?.type === newProvider?.type)\n      return;\n    prevProvider?.destroy?.();\n    prevProvider?.scope?.dispose();\n    this._media.$provider.set(event.detail);\n    if (prevProvider && event.detail === null)\n      this._resetMediaState(event);\n  }\n  [\"provider-loader-change\"](event) {\n    {\n      this._media.logger?.infoGroup(`Loader change \\`${event.detail?.constructor.name}\\``).labelledLog(\"Event\", event).dispatch();\n    }\n  }\n  [\"autoplay\"](event) {\n    appendTriggerEvent(event, this._trackedEvents.get(\"play\"));\n    appendTriggerEvent(event, this._trackedEvents.get(\"can-play\"));\n    this.$state.autoplayError.set(void 0);\n  }\n  [\"autoplay-fail\"](event) {\n    appendTriggerEvent(event, this._trackedEvents.get(\"play-fail\"));\n    appendTriggerEvent(event, this._trackedEvents.get(\"can-play\"));\n    this.$state.autoplayError.set(event.detail);\n    this._resetTracking();\n  }\n  [\"can-load\"](event) {\n    this.$state.canLoad.set(true);\n    this._trackedEvents.set(\"can-load\", event);\n    this._satisfyRequest(\"load\", event);\n    this._media.textTracks[TextTrackSymbol._canLoad]();\n  }\n  [\"media-type-change\"](event) {\n    appendTriggerEvent(event, this._trackedEvents.get(\"source-change\"));\n    const viewType = this.$state.viewType();\n    this.$state.mediaType.set(event.detail);\n    const providedViewType = this.$state.providedViewType(), currentViewType = providedViewType === \"unknown\" ? event.detail : providedViewType;\n    if (viewType !== currentViewType) {\n      {\n        setTimeout(() => {\n          requestAnimationFrame(() => {\n            if (!this.scope)\n              return;\n            this.$state.inferredViewType.set(event.detail);\n            this.dispatch(\"view-type-change\", {\n              detail: currentViewType,\n              trigger: event\n            });\n          });\n        }, 0);\n      }\n    }\n  }\n  [\"stream-type-change\"](event) {\n    const { streamType, inferredStreamType } = this.$state;\n    appendTriggerEvent(event, this._trackedEvents.get(\"source-change\"));\n    inferredStreamType.set(event.detail);\n    event.detail = streamType();\n  }\n  [\"rate-change\"](event) {\n    this.$state.playbackRate.set(event.detail);\n    this._satisfyRequest(\"rate\", event);\n  }\n  [\"sources-change\"](event) {\n    this.$state.sources.set(event.detail);\n  }\n  [\"source-change\"](event) {\n    appendTriggerEvent(event, this._trackedEvents.get(\"sources-change\"));\n    this._resetMediaState(event);\n    this._trackedEvents.set(event.type, event);\n    this.$state.source.set(event.detail);\n    this.el?.setAttribute(\"aria-busy\", \"true\");\n    {\n      this._media.logger?.infoGroup(\"\\u{1F4FC} Media source change\").labelledLog(\"Source\", event.detail).dispatch();\n    }\n  }\n  _resetMediaState(event) {\n    this._media.audioTracks[ListSymbol._reset](event);\n    this._media.qualities[ListSymbol._reset](event);\n    this._resetTracking();\n    softResetMediaState(this._media.$state);\n  }\n  [\"abort\"](event) {\n    appendTriggerEvent(event, this._trackedEvents.get(\"source-change\"));\n    appendTriggerEvent(event, this._trackedEvents.get(\"can-load\"));\n  }\n  [\"load-start\"](event) {\n    appendTriggerEvent(event, this._trackedEvents.get(\"source-change\"));\n  }\n  [\"error\"](event) {\n    this.$state.error.set(event.detail);\n    appendTriggerEvent(event, this._trackedEvents.get(\"abort\"));\n  }\n  [\"loaded-metadata\"](event) {\n    appendTriggerEvent(event, this._trackedEvents.get(\"load-start\"));\n  }\n  [\"loaded-data\"](event) {\n    appendTriggerEvent(event, this._trackedEvents.get(\"load-start\"));\n  }\n  [\"can-play\"](event) {\n    if (event.trigger?.type !== \"loadedmetadata\") {\n      appendTriggerEvent(event, this._trackedEvents.get(\"loaded-metadata\"));\n    }\n    this._onCanPlayDetail(event.detail);\n    this.el?.setAttribute(\"aria-busy\", \"false\");\n  }\n  [\"can-play-through\"](event) {\n    this._onCanPlayDetail(event.detail);\n    appendTriggerEvent(event, this._trackedEvents.get(\"can-play\"));\n  }\n  _onCanPlayDetail(detail) {\n    const { seekable, seekableEnd, buffered, duration, canPlay } = this.$state;\n    seekable.set(detail.seekable);\n    buffered.set(detail.buffered);\n    duration.set(seekableEnd);\n    canPlay.set(true);\n  }\n  [\"duration-change\"](event) {\n    const { live, duration } = this.$state, time = event.detail;\n    if (!live())\n      duration.set(!Number.isNaN(time) ? time : 0);\n  }\n  [\"progress\"](event) {\n    const { buffered, seekable, live, duration, seekableEnd } = this.$state, detail = event.detail;\n    buffered.set(detail.buffered);\n    seekable.set(detail.seekable);\n    if (live()) {\n      duration.set(seekableEnd);\n      this.dispatch(\"duration-change\", {\n        detail: seekableEnd(),\n        trigger: event\n      });\n    }\n  }\n  [\"play\"](event) {\n    const { paused, autoplayError, ended, autoplaying } = this.$state;\n    event.autoplay = autoplaying();\n    if (this._request._looping || !paused()) {\n      event.stopImmediatePropagation();\n      return;\n    }\n    appendTriggerEvent(event, this._trackedEvents.get(\"waiting\"));\n    this._satisfyRequest(\"play\", event);\n    paused.set(false);\n    autoplayError.set(void 0);\n    if (ended() || this._request._replaying) {\n      this._request._replaying = false;\n      ended.set(false);\n      this._handle(this.createEvent(\"replay\", { trigger: event }));\n    }\n  }\n  [\"play-fail\"](event) {\n    appendTriggerEvent(event, this._trackedEvents.get(\"play\"));\n    this._satisfyRequest(\"play\", event);\n    const { paused, playing } = this.$state;\n    paused.set(true);\n    playing.set(false);\n    this._resetTracking();\n  }\n  [\"playing\"](event) {\n    const playEvent = this._trackedEvents.get(\"play\");\n    if (playEvent) {\n      appendTriggerEvent(event, this._trackedEvents.get(\"waiting\"));\n      appendTriggerEvent(event, playEvent);\n    } else {\n      appendTriggerEvent(event, this._trackedEvents.get(\"seeked\"));\n    }\n    setTimeout(() => this._resetTracking(), 0);\n    const { paused, playing, seeking, ended } = this.$state;\n    paused.set(false);\n    playing.set(true);\n    seeking.set(false);\n    ended.set(false);\n    if (this._request._looping) {\n      event.stopImmediatePropagation();\n      this._request._looping = false;\n      return;\n    }\n    this[\"started\"](event);\n  }\n  [\"started\"](event) {\n    const { started, live, liveSyncPosition, seekableEnd } = this.$state;\n    if (!started()) {\n      if (live()) {\n        const end = liveSyncPosition() ?? seekableEnd() - 2;\n        if (Number.isFinite(end))\n          this._media.$provider().currentTime = end;\n      }\n      started.set(true);\n      this._handle(this.createEvent(\"started\", { trigger: event }));\n    }\n  }\n  [\"pause\"](event) {\n    if (!this.el?.isConnected) {\n      this._isPlayingOnDisconnect = true;\n    }\n    if (this._request._looping) {\n      event.stopImmediatePropagation();\n      return;\n    }\n    appendTriggerEvent(event, this._trackedEvents.get(\"seeked\"));\n    this._satisfyRequest(\"pause\", event);\n    const { paused, playing, seeking } = this.$state;\n    paused.set(true);\n    playing.set(false);\n    seeking.set(false);\n    this._resetTracking();\n  }\n  [\"time-update\"](event) {\n    const { currentTime, played, waiting } = this.$state, detail = event.detail;\n    currentTime.set(detail.currentTime);\n    played.set(detail.played);\n    waiting.set(false);\n    for (const track of this._media.textTracks) {\n      track[TextTrackSymbol._updateActiveCues](detail.currentTime, event);\n    }\n  }\n  [\"volume-change\"](event) {\n    const { volume, muted } = this.$state, detail = event.detail;\n    volume.set(detail.volume);\n    muted.set(detail.muted || detail.volume === 0);\n    this._satisfyRequest(\"volume\", event);\n  }\n  [\"seeked\"](event) {\n    const { seeking, currentTime, paused, duration, ended } = this.$state;\n    if (this._request._seeking) {\n      seeking.set(true);\n      event.stopImmediatePropagation();\n    } else if (seeking()) {\n      const waitingEvent = this._trackedEvents.get(\"waiting\");\n      appendTriggerEvent(event, waitingEvent);\n      if (waitingEvent?.trigger?.type !== \"seeking\") {\n        appendTriggerEvent(event, this._trackedEvents.get(\"seeking\"));\n      }\n      if (paused())\n        this._stopWaiting();\n      seeking.set(false);\n      if (event.detail !== duration())\n        ended.set(false);\n      currentTime.set(event.detail);\n      this._satisfyRequest(\"seeked\", event);\n      const origin = event.originEvent;\n      if (origin && origin.isTrusted && !/seek/.test(origin.type)) {\n        this[\"started\"](event);\n      }\n    }\n  }\n  [\"waiting\"](event) {\n    if (this._firingWaiting || this._request._seeking)\n      return;\n    event.stopImmediatePropagation();\n    this._waitingTrigger = event;\n    this._fireWaiting();\n  }\n  [\"ended\"](event) {\n    if (this._request._looping) {\n      event.stopImmediatePropagation();\n      return;\n    }\n    const { paused, playing, seeking, ended } = this.$state;\n    paused.set(true);\n    playing.set(false);\n    seeking.set(false);\n    ended.set(true);\n    this._resetTracking();\n  }\n  _stopWaiting() {\n    this._fireWaiting.cancel();\n    this.$state.waiting.set(false);\n  }\n  [\"fullscreen-change\"](event) {\n    this.$state.fullscreen.set(event.detail);\n    this._satisfyRequest(\"fullscreen\", event);\n  }\n  [\"fullscreen-error\"](event) {\n    this._satisfyRequest(\"fullscreen\", event);\n  }\n  [\"picture-in-picture-change\"](event) {\n    this.$state.pictureInPicture.set(event.detail);\n    this._satisfyRequest(\"pip\", event);\n  }\n  [\"picture-in-picture-error\"](event) {\n    this._satisfyRequest(\"pip\", event);\n  }\n}\n\nclass MediaStateSync extends MediaPlayerController {\n  onSetup() {\n    effect(this._onLogLevelChange.bind(this));\n    effect(this._onAutoplayChange.bind(this));\n    effect(this._onPosterChange.bind(this));\n    effect(this._onLoopChange.bind(this));\n    effect(this._onControlsChange.bind(this));\n    effect(this._onCrossOriginChange.bind(this));\n    effect(this._onPlaysinlineChange.bind(this));\n    effect(this._onLiveToleranceChange.bind(this));\n    effect(this._onLiveChange.bind(this));\n    effect(this._onLiveEdgeChange.bind(this));\n  }\n  _onLogLevelChange() {\n    this.$state.logLevel.set(this.$props.logLevel());\n  }\n  _onAutoplayChange() {\n    const autoplay = this.$props.autoplay();\n    this.$state.autoplay.set(autoplay);\n    this.dispatch(\"autoplay-change\", { detail: autoplay });\n  }\n  _onLoopChange() {\n    const loop = this.$props.loop();\n    this.$state.loop.set(loop);\n    this.dispatch(\"loop-change\", { detail: loop });\n  }\n  _onControlsChange() {\n    const controls = this.$props.controls();\n    this.$state.controls.set(controls);\n  }\n  _onPosterChange() {\n    const poster = this.$props.poster();\n    this.$state.poster.set(poster);\n    this.dispatch(\"poster-change\", { detail: poster });\n  }\n  _onCrossOriginChange() {\n    const crossorigin = this.$props.crossorigin();\n    this.$state.crossorigin.set(crossorigin === true ? \"\" : crossorigin);\n  }\n  _onPlaysinlineChange() {\n    const playsinline = this.$props.playsinline();\n    this.$state.playsinline.set(playsinline);\n    this.dispatch(\"playsinline-change\", { detail: playsinline });\n  }\n  _onLiveChange() {\n    this.dispatch(\"live-change\", { detail: this.$state.live() });\n  }\n  _onLiveToleranceChange() {\n    this.$state.liveEdgeTolerance.set(this.$props.liveEdgeTolerance());\n    this.$state.minLiveDVRWindow.set(this.$props.minLiveDVRWindow());\n  }\n  _onLiveEdgeChange() {\n    this.dispatch(\"live-edge-change\", { detail: this.$state.liveEdge() });\n  }\n}\n\nconst LOCAL_STORAGE_KEY = \"@vidstack/log-colors\";\nconst savedColors = init();\nfunction getLogColor(key) {\n  return savedColors.get(key);\n}\nfunction saveLogColor(key, { color = generateColor(), overwrite = false } = {}) {\n  if (!savedColors.has(key) || overwrite) {\n    savedColors.set(key, color);\n    localStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify(Object.entries(savedColors)));\n  }\n}\nfunction generateColor() {\n  return `hsl(${Math.random() * 360}, 55%, 70%)`;\n}\nfunction init() {\n  let colors;\n  try {\n    colors = JSON.parse(localStorage.getItem(LOCAL_STORAGE_KEY));\n  } catch {\n  }\n  return new Map(Object.entries(colors ?? {}));\n}\n\nconst LogLevelValue = Object.freeze({\n  silent: 0,\n  error: 1,\n  warn: 2,\n  info: 3,\n  debug: 4\n});\nconst LogLevelColor = Object.freeze({\n  silent: \"white\",\n  error: \"hsl(6, 58%, 50%)\",\n  warn: \"hsl(51, 58%, 50%)\",\n  info: \"hsl(219, 58%, 50%)\",\n  debug: \"hsl(280, 58%, 50%)\"\n});\n\nconst s = 1e3;\nconst m = s * 60;\nconst h = m * 60;\nconst d = h * 24;\nfunction ms(val) {\n  const msAbs = Math.abs(val);\n  if (msAbs >= d) {\n    return Math.round(val / d) + \"d\";\n  }\n  if (msAbs >= h) {\n    return Math.round(val / h) + \"h\";\n  }\n  if (msAbs >= m) {\n    return Math.round(val / m) + \"m\";\n  }\n  if (msAbs >= s) {\n    return Math.round(val / s) + \"s\";\n  }\n  return round(val, 2) + \"ms\";\n}\n\nclass LogPrinter extends ViewController {\n  constructor() {\n    super(...arguments);\n    this._level = \"warn\" ;\n  }\n  /**\n   * The current log level.\n   */\n  get logLevel() {\n    return this._level ;\n  }\n  set logLevel(level) {\n    this._level = level;\n  }\n  onConnect() {\n    this.listen(\"vds-log\", (event) => {\n      event.stopPropagation();\n      const element = event.path?.[0] ?? (event.target instanceof ViewController ? event.target.el : event.target), eventTargetName = element?.$$COMPONENT_NAME?.replace(/^_/, \"\").replace(/Instance$/, \"\") ?? element?.tagName.toLowerCase() ?? \"unknown\";\n      const { level = \"warn\", data } = event.detail ?? {};\n      if (LogLevelValue[this._level] < LogLevelValue[level]) {\n        return;\n      }\n      saveLogColor(eventTargetName);\n      const hint = data?.length === 1 && isGroupedLog(data[0]) ? data[0].title : isString(data?.[0]) ? data[0] : \"\";\n      console.groupCollapsed(\n        `%c${level.toUpperCase()}%c ${eventTargetName}%c ${hint.slice(0, 50)}${hint.length > 50 ? \"...\" : \"\"}`,\n        `background: ${LogLevelColor[level]}; color: white; padding: 1.5px 2.2px; border-radius: 2px; font-size: 11px;`,\n        `color: ${getLogColor(eventTargetName)}; padding: 4px 0px; font-size: 11px;`,\n        \"color: gray; font-size: 11px; padding-left: 4px;\"\n      );\n      if (data?.length === 1 && isGroupedLog(data[0])) {\n        if (element)\n          data[0].logs.unshift({ label: \"Element\", data: [element] });\n        printGroup(level, data[0]);\n      } else if (data) {\n        print(level, ...data);\n      }\n      this._printTimeDiff();\n      printStackTrace();\n      console.groupEnd();\n    });\n    onDispose(() => {\n      this._lastLogged = void 0;\n    });\n  }\n  _printTimeDiff() {\n    labelledPrint(\"Time since last log\", this._calcLastLogTimeDiff());\n  }\n  _calcLastLogTimeDiff() {\n    const time = performance.now();\n    const diff = time - (this._lastLogged ?? (this._lastLogged = performance.now()));\n    this._lastLogged = time;\n    return ms(diff);\n  }\n}\nfunction print(level, ...data) {\n  console[level](...data);\n}\nfunction labelledPrint(label, ...data) {\n  console.log(`%c${label}:`, \"color: gray\", ...data);\n}\nfunction printStackTrace() {\n  console.groupCollapsed(\"%cStack Trace\", \"color: gray\");\n  console.trace();\n  console.groupEnd();\n}\nfunction printGroup(level, groupedLog) {\n  for (const log of groupedLog.logs) {\n    if (isGroupedLog(log)) {\n      console.groupCollapsed(groupedLog.title);\n      printGroup(level, log);\n      console.groupEnd();\n    } else if (\"label\" in log && !isUndefined(log.label)) {\n      labelledPrint(log.label, ...log.data);\n    } else {\n      print(level, ...log.data);\n    }\n  }\n}\n\nlet $keyboard = signal(false);\n{\n  listenEvent(document, \"pointerdown\", () => {\n    $keyboard.set(false);\n  });\n  listenEvent(document, \"keydown\", (e) => {\n    if (e.metaKey || e.altKey || e.ctrlKey)\n      return;\n    $keyboard.set(true);\n  });\n}\nclass FocusVisibleController extends ViewController {\n  constructor() {\n    super(...arguments);\n    this._focused = signal(false);\n  }\n  onConnect(el) {\n    effect(() => {\n      if (!$keyboard()) {\n        this._focused.set(false);\n        updateFocusAttr(el, false);\n        this.listen(\"pointerenter\", this._onPointerEnter.bind(this));\n        this.listen(\"pointerleave\", this._onPointerLeave.bind(this));\n        return;\n      }\n      const active = document.activeElement === el;\n      this._focused.set(active);\n      updateFocusAttr(el, active);\n      this.listen(\"focus\", this._onFocus.bind(this));\n      this.listen(\"blur\", this._onBlur.bind(this));\n    });\n  }\n  focused() {\n    return this._focused();\n  }\n  _onFocus() {\n    this._focused.set(true);\n    updateFocusAttr(this.el, true);\n  }\n  _onBlur() {\n    this._focused.set(false);\n    updateFocusAttr(this.el, false);\n  }\n  _onPointerEnter() {\n    updateHoverAttr(this.el, true);\n  }\n  _onPointerLeave() {\n    updateHoverAttr(this.el, false);\n  }\n}\nfunction updateFocusAttr(el, isFocused) {\n  setAttribute(el, \"data-focus\", isFocused);\n  setAttribute(el, \"data-hocus\", isFocused);\n}\nfunction updateHoverAttr(el, isHovering) {\n  setAttribute(el, \"data-hocus\", isHovering);\n  setAttribute(el, \"data-hover\", isHovering);\n}\n\nclass RequestQueue {\n  constructor() {\n    this._serving = false;\n    this._pending = deferredPromise();\n    this._queue = /* @__PURE__ */ new Map();\n  }\n  /**\n   * The number of callbacks that are currently in queue.\n   */\n  get _size() {\n    return this._queue.size;\n  }\n  /**\n   * Whether items in the queue are being served immediately, otherwise they're queued to\n   * be processed later.\n   */\n  get _isServing() {\n    return this._serving;\n  }\n  /**\n   * Waits for the queue to be flushed (ie: start serving).\n   */\n  async _waitForFlush() {\n    if (this._serving)\n      return;\n    await this._pending.promise;\n  }\n  /**\n   * Queue the given `callback` to be invoked at a later time by either calling the `serve()` or\n   * `start()` methods. If the queue has started serving (i.e., `start()` was already called),\n   * then the callback will be invoked immediately.\n   *\n   * @param key - Uniquely identifies this callback so duplicates are ignored.\n   * @param callback - The function to call when this item in the queue is being served.\n   */\n  _enqueue(key, callback) {\n    if (this._serving) {\n      callback();\n      return;\n    }\n    this._queue.delete(key);\n    this._queue.set(key, callback);\n  }\n  /**\n   * Invokes the callback with the given `key` in the queue (if it exists).\n   */\n  _serve(key) {\n    this._queue.get(key)?.();\n    this._queue.delete(key);\n  }\n  /**\n   * Flush all queued items and start serving future requests immediately until `stop()` is called.\n   */\n  _start() {\n    this._flush();\n    this._serving = true;\n    if (this._queue.size > 0)\n      this._flush();\n  }\n  /**\n   * Stop serving requests, they'll be queued until you begin processing again by calling `start()`.\n   */\n  _stop() {\n    this._serving = false;\n  }\n  /**\n   * Stop serving requests, empty the request queue, and release any promises waiting for the\n   * queue to flush.\n   */\n  _reset() {\n    this._stop();\n    this._queue.clear();\n    this._release();\n  }\n  _flush() {\n    for (const key of this._queue.keys())\n      this._serve(key);\n    this._release();\n  }\n  _release() {\n    this._pending.resolve();\n    this._pending = deferredPromise();\n  }\n}\n\nvar __defProp$f = Object.defineProperty;\nvar __getOwnPropDesc$f = Object.getOwnPropertyDescriptor;\nvar __decorateClass$f = (decorators, target, key, kind) => {\n  var result = kind > 1 ? void 0 : kind ? __getOwnPropDesc$f(target, key) : target;\n  for (var i = decorators.length - 1, decorator; i >= 0; i--)\n    if (decorator = decorators[i])\n      result = (kind ? decorator(target, key, result) : decorator(result)) || result;\n  if (kind && result)\n    __defProp$f(target, key, result);\n  return result;\n};\nconst _MediaPlayer = class _MediaPlayer extends Component {\n  constructor() {\n    super();\n    this.canPlayQueue = new RequestQueue();\n    this._initState();\n    new MediaStateSync();\n    const context = {\n      player: this,\n      scope: getScope(),\n      qualities: new VideoQualityList(),\n      audioTracks: new AudioTrackList(),\n      $provider: signal(null),\n      $props: this.$props,\n      $state: this.$state\n    };\n    {\n      const logPrinter = new LogPrinter();\n      effect(() => {\n        logPrinter.logLevel = this.$props.logLevel();\n      });\n    }\n    context.logger = new Logger();\n    context.remote = new MediaRemoteControl(context.logger );\n    context.remote.setPlayer(this);\n    context.$iosControls = computed(this._isIOSControls.bind(this));\n    context.textTracks = new TextTrackList();\n    context.textTracks[TextTrackSymbol._crossorigin] = this.$state.crossorigin;\n    context.textRenderers = new TextRenderers(context);\n    context.ariaKeys = {};\n    this._media = context;\n    provideContext(mediaContext, context);\n    this.orientation = new ScreenOrientationController();\n    new FocusVisibleController();\n    new MediaKeyboardController(context);\n    new MediaEventsLogger(context);\n    const request = new MediaRequestContext();\n    this._stateMgr = new MediaStateManager(request, context);\n    this._requestMgr = new MediaRequestManager(this._stateMgr, request, context);\n    context.delegate = new MediaPlayerDelegate(\n      this._stateMgr._handle.bind(this._stateMgr),\n      context\n    );\n    new MediaLoadController(this.startLoading.bind(this));\n  }\n  static {\n    this.props = mediaPlayerProps;\n  }\n  static {\n    this.state = mediaState;\n  }\n  get _provider() {\n    return this._media.$provider();\n  }\n  onSetup() {\n    this._setupMediaAttributes();\n    effect(this._watchCanPlay.bind(this));\n    effect(this._watchMuted.bind(this));\n    effect(this._watchPaused.bind(this));\n    effect(this._watchVolume.bind(this));\n    effect(this._watchCurrentTime.bind(this));\n    effect(this._watchPlaysinline.bind(this));\n    effect(this._watchPlaybackRate.bind(this));\n  }\n  onAttach(el) {\n    el.setAttribute(\"data-media-player\", \"\");\n    setAttributeIfEmpty(el, \"tabindex\", \"0\");\n    setAttributeIfEmpty(el, \"role\", \"region\");\n    effect(this._watchTitle.bind(this));\n    effect(this._watchOrientation.bind(this));\n    listenEvent(el, \"find-media-player\", this._onFindPlayer.bind(this));\n  }\n  onConnect(el) {\n    if (IS_IPHONE)\n      setAttribute(el, \"data-iphone\", \"\");\n    canChangeVolume().then(this.$state.canSetVolume.set);\n    const pointerQuery = window.matchMedia(\"(pointer: coarse)\");\n    this._onPointerChange(pointerQuery);\n    pointerQuery.onchange = this._onPointerChange.bind(this);\n    const resize = new ResizeObserver(animationFrameThrottle(this._onResize.bind(this)));\n    resize.observe(el);\n    effect(this._onResize.bind(this));\n    this.dispatch(\"media-player-connect\", {\n      detail: this,\n      bubbles: true,\n      composed: true\n    });\n    this._media.logger.setTarget(el);\n    onDispose(() => {\n      resize.disconnect();\n      pointerQuery.onchange = null;\n      this._media.logger.setTarget(null);\n    });\n  }\n  onDestroy() {\n    this._media.player = null;\n    this.canPlayQueue._reset();\n  }\n  _initState() {\n    const providedProps = {\n      viewType: \"providedViewType\",\n      streamType: \"providedStreamType\"\n    };\n    for (const prop2 of Object.keys(this.$props)) {\n      this.$state[providedProps[prop2] ?? prop2]?.set(this.$props[prop2]());\n    }\n    effect(this._onProvidedTypesChange.bind(this));\n    this.$state.muted.set(this.$props.muted() || this.$props.volume() === 0);\n  }\n  _watchTitle() {\n    const { title } = this.$props, { live, viewType } = this.$state, isLive = live(), type = uppercaseFirstChar(viewType()), typeText = type !== \"Unknown\" ? `${isLive ? \"Live \" : \"\"}${type}` : isLive ? \"Live\" : \"Media\";\n    const newTitle = title();\n    if (newTitle) {\n      this.el?.setAttribute(\"data-title\", newTitle);\n      this.el?.removeAttribute(\"title\");\n    }\n    const currentTitle = this.el?.getAttribute(\"data-title\") || \"\";\n    this.$state.title.set(currentTitle);\n    setAttribute(\n      this.el,\n      \"aria-label\",\n      currentTitle ? `${typeText} - ${currentTitle}` : typeText + \" Player\"\n    );\n  }\n  _watchOrientation() {\n    const orientation = this.orientation.landscape ? \"landscape\" : \"portrait\";\n    this.$state.orientation.set(orientation);\n    setAttribute(this.el, \"data-orientation\", orientation);\n    this._onResize();\n  }\n  _watchCanPlay() {\n    if (this.$state.canPlay() && this._provider)\n      this.canPlayQueue._start();\n    else\n      this.canPlayQueue._stop();\n  }\n  _onProvidedTypesChange() {\n    this.$state.providedViewType.set(this.$props.viewType());\n    this.$state.providedStreamType.set(this.$props.streamType());\n  }\n  _setupMediaAttributes() {\n    if (_MediaPlayer[MEDIA_ATTRIBUTES]) {\n      this.setAttributes(_MediaPlayer[MEDIA_ATTRIBUTES]);\n      return;\n    }\n    const $attrs = {\n      \"data-captions\": function() {\n        const track = this.$state.textTrack();\n        return !!track && isTrackCaptionKind(track);\n      },\n      \"data-ios-controls\": function() {\n        return this._media.$iosControls();\n      },\n      \"data-controls\": function() {\n        return this.controls.showing;\n      },\n      \"data-buffering\": function() {\n        const { canPlay, waiting } = this.$state;\n        return !canPlay() || waiting();\n      },\n      \"data-error\": function() {\n        const { error } = this.$state;\n        return !!error();\n      }\n    };\n    const alias = {\n      canPictureInPicture: \"can-pip\",\n      pictureInPicture: \"pip\"\n    };\n    for (const prop2 of mediaAttributes) {\n      const attrName = \"data-\" + (alias[prop2] ?? camelToKebabCase(prop2));\n      $attrs[attrName] = function() {\n        return this.$state[prop2]();\n      };\n    }\n    delete $attrs.title;\n    _MediaPlayer[MEDIA_ATTRIBUTES] = $attrs;\n    this.setAttributes($attrs);\n  }\n  _onFindPlayer(event) {\n    event.detail(this);\n  }\n  _onResize() {\n    if (!this.el)\n      return;\n    const width = this.el.clientWidth, height = this.el.clientHeight;\n    this.$state.width.set(width);\n    this.$state.height.set(height);\n    setStyle(this.el, \"--player-width\", width + \"px\");\n    setStyle(this.el, \"--player-height\", height + \"px\");\n  }\n  _onPointerChange(queryList) {\n    const pointer = queryList.matches ? \"coarse\" : \"fine\";\n    setAttribute(this.el, \"data-pointer\", pointer);\n    this.$state.pointer.set(pointer);\n    this._onResize();\n  }\n  _isIOSControls() {\n    return !canFullscreen() && this.$state.mediaType() === \"video\" && (this.$state.controls() && !this.$props.playsinline() || this.$state.fullscreen());\n  }\n  get provider() {\n    return this._provider;\n  }\n  get controls() {\n    return this._requestMgr._controls;\n  }\n  get qualities() {\n    return this._media.qualities;\n  }\n  get audioTracks() {\n    return this._media.audioTracks;\n  }\n  get textTracks() {\n    return this._media.textTracks;\n  }\n  get textRenderers() {\n    return this._media.textRenderers;\n  }\n  get paused() {\n    return this._provider?.paused ?? true;\n  }\n  set paused(paused) {\n    this._queuePausedUpdate(paused);\n  }\n  _watchPaused() {\n    this._queuePausedUpdate(this.$props.paused());\n  }\n  _queuePausedUpdate(paused) {\n    if (paused) {\n      this.canPlayQueue._enqueue(\"paused\", () => this._requestMgr._pause());\n    } else\n      this.canPlayQueue._enqueue(\"paused\", () => this._requestMgr._play());\n  }\n  get muted() {\n    return this._provider?.muted ?? false;\n  }\n  set muted(muted) {\n    this._queueMutedUpdate(muted);\n  }\n  _watchMuted() {\n    this._queueMutedUpdate(this.$props.muted());\n  }\n  _queueMutedUpdate(muted) {\n    this.canPlayQueue._enqueue(\"muted\", () => this._provider.muted = muted);\n  }\n  get currentTime() {\n    return this._provider?.currentTime ?? 0;\n  }\n  set currentTime(time) {\n    this._queueCurrentTimeUpdate(time);\n  }\n  _watchCurrentTime() {\n    this._queueCurrentTimeUpdate(this.$props.currentTime());\n  }\n  _queueCurrentTimeUpdate(time) {\n    this.canPlayQueue._enqueue(\"currentTime\", () => {\n      const adapter = this._provider;\n      if (time !== adapter.currentTime) {\n        peek(() => {\n          const boundTime = Math.min(\n            Math.max(this.$state.seekableStart() + 0.1, time),\n            this.$state.seekableEnd() - 0.1\n          );\n          if (Number.isFinite(boundTime))\n            adapter.currentTime = boundTime;\n        });\n      }\n    });\n  }\n  get volume() {\n    return this._provider?.volume ?? 1;\n  }\n  set volume(volume) {\n    this._queueVolumeUpdate(volume);\n  }\n  _watchVolume() {\n    this._queueVolumeUpdate(this.$props.volume());\n  }\n  _queueVolumeUpdate(volume) {\n    const clampedVolume = clampNumber(0, volume, 1);\n    this.canPlayQueue._enqueue(\"volume\", () => this._provider.volume = clampedVolume);\n  }\n  get playsinline() {\n    return this._provider?.playsinline ?? false;\n  }\n  set playsinline(inline) {\n    this._queuePlaysinlineUpdate(inline);\n  }\n  _watchPlaysinline() {\n    this._queuePlaysinlineUpdate(this.$props.playsinline());\n  }\n  _queuePlaysinlineUpdate(inline) {\n    this.canPlayQueue._enqueue(\"playsinline\", () => this._provider.playsinline = inline);\n  }\n  get playbackRate() {\n    return this._provider?.playbackRate ?? 1;\n  }\n  set playbackRate(rate) {\n    this._queuePlaybackRateUpdate(rate);\n  }\n  _watchPlaybackRate() {\n    this._queuePlaybackRateUpdate(this.$props.playbackRate());\n  }\n  _queuePlaybackRateUpdate(rate) {\n    this.canPlayQueue._enqueue(\"rate\", () => this._provider.playbackRate = rate);\n  }\n  async play() {\n    return this._requestMgr._play();\n  }\n  async pause() {\n    return this._requestMgr._pause();\n  }\n  async enterFullscreen(target) {\n    return this._requestMgr._enterFullscreen(target);\n  }\n  async exitFullscreen(target) {\n    return this._requestMgr._exitFullscreen(target);\n  }\n  enterPictureInPicture() {\n    return this._requestMgr._enterPictureInPicture();\n  }\n  exitPictureInPicture() {\n    return this._requestMgr._exitPictureInPicture();\n  }\n  seekToLiveEdge() {\n    this._requestMgr._seekToLiveEdge();\n  }\n  startLoading() {\n    this._media.delegate._dispatch(\"can-load\");\n  }\n  matchQuery(query) {\n    return scoped(() => PlayerQueryList.create(query), this.scope);\n  }\n  destroy() {\n    this._media.remote.setPlayer(null);\n    this.dispatch(\"destroy\");\n  }\n};\n__decorateClass$f([\n  prop\n], _MediaPlayer.prototype, \"canPlayQueue\", 2);\n__decorateClass$f([\n  prop\n], _MediaPlayer.prototype, \"provider\", 1);\n__decorateClass$f([\n  prop\n], _MediaPlayer.prototype, \"controls\", 1);\n__decorateClass$f([\n  prop\n], _MediaPlayer.prototype, \"orientation\", 2);\n__decorateClass$f([\n  prop\n], _MediaPlayer.prototype, \"qualities\", 1);\n__decorateClass$f([\n  prop\n], _MediaPlayer.prototype, \"audioTracks\", 1);\n__decorateClass$f([\n  prop\n], _MediaPlayer.prototype, \"textTracks\", 1);\n__decorateClass$f([\n  prop\n], _MediaPlayer.prototype, \"textRenderers\", 1);\n__decorateClass$f([\n  prop\n], _MediaPlayer.prototype, \"paused\", 1);\n__decorateClass$f([\n  prop\n], _MediaPlayer.prototype, \"muted\", 1);\n__decorateClass$f([\n  prop\n], _MediaPlayer.prototype, \"currentTime\", 1);\n__decorateClass$f([\n  prop\n], _MediaPlayer.prototype, \"volume\", 1);\n__decorateClass$f([\n  prop\n], _MediaPlayer.prototype, \"playsinline\", 1);\n__decorateClass$f([\n  prop\n], _MediaPlayer.prototype, \"playbackRate\", 1);\n__decorateClass$f([\n  method\n], _MediaPlayer.prototype, \"play\", 1);\n__decorateClass$f([\n  method\n], _MediaPlayer.prototype, \"pause\", 1);\n__decorateClass$f([\n  method\n], _MediaPlayer.prototype, \"enterFullscreen\", 1);\n__decorateClass$f([\n  method\n], _MediaPlayer.prototype, \"exitFullscreen\", 1);\n__decorateClass$f([\n  method\n], _MediaPlayer.prototype, \"enterPictureInPicture\", 1);\n__decorateClass$f([\n  method\n], _MediaPlayer.prototype, \"exitPictureInPicture\", 1);\n__decorateClass$f([\n  method\n], _MediaPlayer.prototype, \"seekToLiveEdge\", 1);\n__decorateClass$f([\n  method\n], _MediaPlayer.prototype, \"startLoading\", 1);\n__decorateClass$f([\n  method\n], _MediaPlayer.prototype, \"matchQuery\", 1);\nlet MediaPlayer = _MediaPlayer;\n\nfunction resolveStreamTypeFromHLSManifest(manifestSrc, requestInit) {\n  return fetch(manifestSrc, requestInit).then((res) => res.text()).then((manifest) => {\n    const renditionURI = resolveHLSRenditionURI(manifest);\n    if (renditionURI) {\n      return resolveStreamTypeFromHLSManifest(\n        /^https?:/.test(renditionURI) ? renditionURI : new URL(renditionURI, manifestSrc).href,\n        requestInit\n      );\n    }\n    const streamType = /EXT-X-PLAYLIST-TYPE:\\s*VOD/.test(manifest) ? \"on-demand\" : \"live\";\n    if (streamType === \"live\" && resolveTargetDuration(manifest) >= 10 && (/#EXT-X-DVR-ENABLED:\\s*true/.test(manifest) || manifest.includes(\"#EXT-X-DISCONTINUITY\"))) {\n      return \"live:dvr\";\n    }\n    return streamType;\n  });\n}\nfunction resolveHLSRenditionURI(manifest) {\n  const matches = manifest.match(/#EXT-X-STREAM-INF:[^\\n]+(\\n[^\\n]+)*/g);\n  return matches ? matches[0].split(\"\\n\")[1].trim() : null;\n}\nfunction resolveTargetDuration(manifest) {\n  const lines = manifest.split(\"\\n\");\n  for (const line of lines) {\n    if (line.startsWith(\"#EXT-X-TARGETDURATION\")) {\n      const duration = parseFloat(line.split(\":\")[1]);\n      if (!isNaN(duration)) {\n        return duration;\n      }\n    }\n  }\n  return -1;\n}\n\nlet warned = /* @__PURE__ */ new Set() ;\nconst SETUP = Symbol(\"SETUP\" );\nclass SourceSelection {\n  constructor(_domSources, _media, _loader) {\n    this._domSources = _domSources;\n    this._media = _media;\n    this._loader = _loader;\n    this._initialize = false;\n    const HLS_LOADER = new HLSProviderLoader(), VIDEO_LOADER = new VideoProviderLoader(), AUDIO_LOADER = new AudioProviderLoader();\n    this._loaders = computed(() => {\n      return _media.$props.preferNativeHLS() ? [VIDEO_LOADER, AUDIO_LOADER, HLS_LOADER] : [HLS_LOADER, VIDEO_LOADER, AUDIO_LOADER];\n    });\n    const { $state } = _media;\n    $state.sources.set(normalizeSrc(_media.$props.src()));\n    for (const src of $state.sources()) {\n      const loader = this._loaders().find((loader2) => loader2.canPlay(src));\n      if (!loader)\n        continue;\n      const mediaType = loader.mediaType(src);\n      this._media.$state.source.set(src);\n      this._media.$state.mediaType.set(mediaType);\n      this._media.$state.inferredViewType.set(mediaType);\n      this._loader.set(loader);\n      this._initialize = true;\n    }\n  }\n  connect() {\n    const loader = this._loader();\n    if (this._initialize) {\n      this._notifySourceChange(this._media.$state.source(), loader);\n      this._notifyLoaderChange(loader);\n      this._initialize = false;\n    }\n    effect(this._onSourcesChange.bind(this));\n    effect(this._onSourceChange.bind(this));\n    effect(this._onConnect.bind(this));\n    effect(this._onLoadSource.bind(this));\n  }\n  _onSourcesChange() {\n    this._media.delegate._dispatch(\"sources-change\", {\n      detail: [...normalizeSrc(this._media.$props.src()), ...this._domSources()]\n    });\n  }\n  _onSourceChange() {\n    const { $state } = this._media;\n    const sources = $state.sources(), currentSource = peek($state.source), newSource = this._findNewSource(currentSource, sources), noMatch = sources[0]?.src && !newSource.src && !newSource.type;\n    if (noMatch && !warned.has(newSource.src) && !peek(this._loader)) {\n      const source = sources[0];\n      console.warn(\n        `[vidstack] could not find a loader for any of the given media sources, consider providing \\`type\\`:\n\n<media-provider>\n  <source src=\"${source.src}\" type=\"video/mp4\" />\n</media-provider>\"\n\nFalling back to fetching source headers...`\n      );\n      warned.add(newSource.src);\n    }\n    if (noMatch) {\n      const { crossorigin } = $state, credentials = getRequestCredentials(crossorigin()), abort = new AbortController();\n      Promise.all(\n        sources.map(\n          (source) => isString(source.src) && source.type === \"?\" ? fetch(source.src, {\n            method: \"HEAD\",\n            credentials,\n            signal: abort.signal\n          }).then((res) => {\n            source.type = res.headers.get(\"content-type\") || \"??\";\n            return source;\n          }).catch(() => source) : source\n        )\n      ).then((sources2) => {\n        if (abort.signal.aborted)\n          return;\n        this._findNewSource(peek($state.source), sources2);\n        tick();\n      });\n      return () => abort.abort();\n    }\n    tick();\n  }\n  _findNewSource(currentSource, sources) {\n    let newSource = { src: \"\", type: \"\" }, newLoader = null;\n    for (const src of sources) {\n      const loader = peek(this._loaders).find((loader2) => loader2.canPlay(src));\n      if (loader) {\n        newSource = src;\n        newLoader = loader;\n      }\n    }\n    if (!isSameSrc(currentSource, newSource)) {\n      this._notifySourceChange(newSource, newLoader);\n    }\n    if (newLoader !== peek(this._loader)) {\n      this._notifyLoaderChange(newLoader);\n    }\n    return newSource;\n  }\n  _notifySourceChange(src, loader) {\n    this._media.delegate._dispatch(\"source-change\", { detail: src });\n    this._media.delegate._dispatch(\"media-type-change\", {\n      detail: loader?.mediaType(src) || \"unknown\"\n    });\n  }\n  _notifyLoaderChange(loader) {\n    this._media.delegate._dispatch(\"provider-change\", { detail: null });\n    loader && peek(() => loader.preconnect?.(this._media));\n    this._loader.set(loader);\n    this._media.delegate._dispatch(\"provider-loader-change\", { detail: loader });\n  }\n  _onConnect() {\n    const provider = this._media.$provider();\n    if (!provider || provider[SETUP])\n      return;\n    if (this._media.$state.canLoad()) {\n      scoped(() => provider.setup(this._media), provider.scope);\n      provider[SETUP] = true;\n      return;\n    }\n    peek(() => provider.preconnect?.(this._media));\n  }\n  _onLoadSource() {\n    const provider = this._media.$provider(), source = this._media.$state.source(), crossorigin = peek(this._media.$state.crossorigin);\n    if (isSameSrc(provider?.currentSrc, source)) {\n      return;\n    }\n    if (this._media.$state.canLoad()) {\n      const abort = new AbortController();\n      if (isHLSSrc(source)) {\n        if (!isHLSSupported()) {\n          resolveStreamTypeFromHLSManifest(source.src, {\n            credentials: getRequestCredentials(crossorigin),\n            signal: abort.signal\n          }).then((streamType) => {\n            this._media.delegate._dispatch(\"stream-type-change\", {\n              detail: streamType\n            });\n          }).catch(noop);\n        }\n      } else {\n        this._media.delegate._dispatch(\"stream-type-change\", {\n          detail: \"on-demand\"\n        });\n      }\n      peek(() => provider?.loadSource(source, peek(this._media.$state.preload)));\n      return () => abort.abort();\n    }\n    try {\n      isString(source.src) && preconnect(new URL(source.src).origin, \"preconnect\");\n    } catch (error) {\n      {\n        this._media.logger?.infoGroup(`Failed to preconnect to source: ${source.src}`).labelledLog(\"Error\", error).dispatch();\n      }\n    }\n  }\n}\nfunction normalizeSrc(src) {\n  return (isArray(src) ? src : [!isString(src) && \"src\" in src ? src : { src }]).map(\n    ({ src: src2, type }) => ({\n      src: src2,\n      type: type ?? (!isString(src2) || src2.startsWith(\"blob:\") ? \"video/object\" : \"?\")\n    })\n  );\n}\nfunction isSameSrc(a, b) {\n  return a?.src === b?.src && a?.type === b?.type;\n}\n\nclass Tracks {\n  constructor(_domTracks, _media) {\n    this._domTracks = _domTracks;\n    this._media = _media;\n    this._prevTracks = [];\n    effect(this._onTracksChange.bind(this));\n  }\n  _onTracksChange() {\n    const newTracks = this._domTracks();\n    for (const oldTrack of this._prevTracks) {\n      if (!newTracks.some((t) => t.id === oldTrack.id)) {\n        const track = oldTrack.id && this._media.textTracks.getById(oldTrack.id);\n        if (track)\n          this._media.textTracks.remove(track);\n      }\n    }\n    for (const newTrack of newTracks) {\n      const id = newTrack.id || TextTrack.createId(newTrack);\n      if (!this._media.textTracks.getById(id)) {\n        newTrack.id = id;\n        this._media.textTracks.add(newTrack);\n      }\n    }\n    this._prevTracks = newTracks;\n  }\n}\n\nvar __defProp$e = Object.defineProperty;\nvar __getOwnPropDesc$e = Object.getOwnPropertyDescriptor;\nvar __decorateClass$e = (decorators, target, key, kind) => {\n  var result = kind > 1 ? void 0 : kind ? __getOwnPropDesc$e(target, key) : target;\n  for (var i = decorators.length - 1, decorator; i >= 0; i--)\n    if (decorator = decorators[i])\n      result = (kind ? decorator(target, key, result) : decorator(result)) || result;\n  if (kind && result)\n    __defProp$e(target, key, result);\n  return result;\n};\nclass MediaProvider extends Component {\n  constructor() {\n    super(...arguments);\n    this._domSources = signal([]);\n    this._domTracks = signal([]);\n    this._loader = null;\n    this._loadRafId = -1;\n  }\n  static {\n    this.state = new State({\n      loader: null\n    });\n  }\n  onSetup() {\n    this._media = useMediaContext();\n    this._sources = new SourceSelection(this._domSources, this._media, this.$state.loader);\n  }\n  onAttach(el) {\n    el.setAttribute(\"data-media-provider\", \"\");\n  }\n  onConnect(el) {\n    this._sources.connect();\n    new Tracks(this._domTracks, this._media);\n    const resize = new ResizeObserver(animationFrameThrottle(this._onResize.bind(this)));\n    resize.observe(el);\n    const mutation = new MutationObserver(this._onMutation.bind(this));\n    mutation.observe(el, { attributes: true, childList: true });\n    if (IS_SAFARI) {\n      listenEvent(el, \"touchstart\", (e) => e.preventDefault(), { passive: false });\n    }\n    this._onResize();\n    this._onMutation();\n    onDispose(() => {\n      resize.disconnect();\n      mutation.disconnect();\n    });\n  }\n  load(target) {\n    window.cancelAnimationFrame(this._loadRafId);\n    this._loadRafId = requestAnimationFrame(() => this._runLoader(target));\n    onDispose(() => {\n      window.cancelAnimationFrame(this._loadRafId);\n    });\n  }\n  _runLoader(target) {\n    if (!this.scope)\n      return;\n    const loader = this.$state.loader(), { $provider } = this._media;\n    if (this._loader === loader && loader?.target === target && peek($provider))\n      return;\n    this._destroyProvider();\n    this._loader = loader;\n    if (loader)\n      loader.target = target || null;\n    if (!loader || !target)\n      return;\n    loader.load(this._media).then((provider) => {\n      if (!this.scope)\n        return;\n      if (peek(this.$state.loader) !== loader)\n        return;\n      this._media.delegate._dispatch(\"provider-change\", {\n        detail: provider\n      });\n    });\n  }\n  onDestroy() {\n    this._loader = null;\n    this._destroyProvider();\n  }\n  _destroyProvider() {\n    this._media.delegate._dispatch(\"provider-change\", { detail: null });\n  }\n  _onResize() {\n    if (!this.el)\n      return;\n    const player = this._media.player, width = this.el.offsetWidth, height = this.el.offsetHeight;\n    if (!player)\n      return;\n    player.$state.mediaWidth.set(width);\n    player.$state.mediaHeight.set(height);\n    if (player.el) {\n      setStyle(player.el, \"--media-width\", width + \"px\");\n      setStyle(player.el, \"--media-height\", height + \"px\");\n    }\n  }\n  _onMutation() {\n    const sources = [], tracks = [], children = this.el.children;\n    for (const el of children) {\n      if (el instanceof HTMLSourceElement) {\n        sources.push({\n          src: el.src,\n          type: el.type\n        });\n      } else if (el instanceof HTMLTrackElement) {\n        tracks.push({\n          id: el.id,\n          src: el.src,\n          kind: el.track.kind,\n          language: el.srclang,\n          label: el.label,\n          default: el.default,\n          type: el.getAttribute(\"data-type\")\n        });\n      }\n    }\n    this._domSources.set(sources);\n    this._domTracks.set(tracks);\n    tick();\n  }\n}\n__decorateClass$e([\n  method\n], MediaProvider.prototype, \"load\", 1);\n\nclass Controls extends Component {\n  static {\n    this.props = {\n      hideDelay: 2e3\n    };\n  }\n  onSetup() {\n    this._media = useMediaContext();\n    effect(this._watchHideDelay.bind(this));\n  }\n  onAttach(el) {\n    const { pictureInPicture, fullscreen } = this._media.$state;\n    setStyle(el, \"pointer-events\", \"none\");\n    setAttributeIfEmpty(el, \"role\", \"group\");\n    this.setAttributes({\n      \"data-visible\": this._isShowing.bind(this),\n      \"data-fullscreen\": fullscreen,\n      \"data-pip\": pictureInPicture\n    });\n    effect(() => {\n      this.dispatch(\"change\", { detail: this._isShowing() });\n    });\n    effect(this._hideControls.bind(this));\n    effect(() => {\n      const isFullscreen = fullscreen();\n      for (const side of [\"top\", \"right\", \"bottom\", \"left\"]) {\n        setStyle(el, `padding-${side}`, isFullscreen && `env(safe-area-inset-${side})`);\n      }\n    });\n  }\n  _hideControls() {\n    if (!this.el)\n      return;\n    const { controls } = this._media.$state, isHidden = controls() || this._media.$iosControls();\n    setAttribute(this.el, \"aria-hidden\", isHidden ? \"true\" : null);\n    setStyle(this.el, \"display\", isHidden ? \"none\" : null);\n  }\n  _watchHideDelay() {\n    const { controls } = this._media.player, { hideDelay } = this.$props;\n    controls.defaultDelay = hideDelay();\n  }\n  _isShowing() {\n    const { controlsVisible } = this._media.$state;\n    return controlsVisible();\n  }\n}\n\nclass Popper extends ViewController {\n  constructor(_delegate) {\n    super();\n    this._delegate = _delegate;\n    this._showTimerId = -1;\n    this._hideRafId = -1;\n    this._stopAnimationEndListener = null;\n    effect(this._watchTrigger.bind(this));\n  }\n  onDestroy() {\n    this._stopAnimationEndListener?.();\n    this._stopAnimationEndListener = null;\n  }\n  _watchTrigger() {\n    const trigger = this._delegate._trigger();\n    if (!trigger) {\n      this.hide();\n      return;\n    }\n    const show = this.show.bind(this), hide = this.hide.bind(this);\n    this._delegate._listen(trigger, show, hide);\n  }\n  show(trigger) {\n    window.cancelAnimationFrame(this._hideRafId);\n    this._hideRafId = -1;\n    this._stopAnimationEndListener?.();\n    this._stopAnimationEndListener = null;\n    this._showTimerId = window.setTimeout(\n      () => {\n        this._showTimerId = -1;\n        const content = this._delegate._content();\n        if (content)\n          content.style.removeProperty(\"display\");\n        peek(() => this._delegate._onChange(true, trigger));\n      },\n      this._delegate._showDelay?.() ?? 0\n    );\n  }\n  hide(trigger) {\n    window.clearTimeout(this._showTimerId);\n    this._showTimerId = -1;\n    peek(() => this._delegate._onChange(false, trigger));\n    this._hideRafId = requestAnimationFrame(() => {\n      this._hideRafId = -1;\n      const content = this._delegate._content();\n      if (content) {\n        const isAnimated = hasAnimation(content);\n        const onHide = () => {\n          content.style.display = \"none\";\n          this._stopAnimationEndListener = null;\n        };\n        if (isAnimated) {\n          this._stopAnimationEndListener?.();\n          const stop = listenEvent(content, \"animationend\", onHide, { once: true });\n          this._stopAnimationEndListener = stop;\n        } else {\n          onHide();\n        }\n      }\n    });\n  }\n}\n\nconst tooltipContext = createContext();\n\nlet id = 0;\nclass Tooltip extends Component {\n  constructor() {\n    super();\n    this._id = `media-tooltip-${++id}`;\n    this._trigger = signal(null);\n    this._content = signal(null);\n    new FocusVisibleController();\n    const { showDelay } = this.$props;\n    new Popper({\n      _trigger: this._trigger,\n      _content: this._content,\n      _showDelay: showDelay,\n      _listen(trigger, show, hide) {\n        listenEvent(trigger, \"touchstart\", (e) => e.preventDefault(), {\n          passive: false\n        });\n        listenEvent(trigger, \"focus\", show);\n        listenEvent(trigger, \"blur\", hide);\n        listenEvent(trigger, \"mouseenter\", show);\n        listenEvent(trigger, \"mouseleave\", hide);\n      },\n      _onChange: this._onShowingChange.bind(this)\n    });\n  }\n  static {\n    this.props = {\n      showDelay: 500\n    };\n  }\n  onAttach(el) {\n    el.style.setProperty(\"display\", \"contents\");\n  }\n  onSetup() {\n    provideContext(tooltipContext, {\n      _trigger: this._trigger,\n      _content: this._content,\n      _attachTrigger: this._attachTrigger.bind(this),\n      _detachTrigger: this._detachTrigger.bind(this),\n      _attachContent: this._attachContent.bind(this),\n      _detachContent: this._detachContent.bind(this)\n    });\n  }\n  _attachTrigger(el) {\n    this._trigger.set(el);\n    let tooltipName = el.getAttribute(\"data-media-tooltip\");\n    if (tooltipName) {\n      this.el?.setAttribute(`data-media-${tooltipName}-tooltip`, \"\");\n    }\n    setAttribute(el, \"data-describedby\", this._id);\n  }\n  _detachTrigger(el) {\n    el.removeAttribute(\"data-describedby\");\n    el.removeAttribute(\"aria-describedby\");\n    this._trigger.set(null);\n  }\n  _attachContent(el) {\n    el.setAttribute(\"id\", this._id);\n    el.style.display = \"none\";\n    setAttributeIfEmpty(el, \"role\", \"tooltip\");\n    this._content.set(el);\n  }\n  _detachContent(el) {\n    el.removeAttribute(\"id\");\n    el.removeAttribute(\"role\");\n    this._content.set(null);\n  }\n  _onShowingChange(isShowing) {\n    const trigger = this._trigger(), content = this._content();\n    if (trigger) {\n      setAttribute(trigger, \"aria-describedby\", isShowing ? this._id : null);\n    }\n    for (const el of [this.el, trigger, content]) {\n      el && setAttribute(el, \"data-visible\", isShowing);\n    }\n  }\n}\n\nclass TooltipContent extends Component {\n  static {\n    this.props = {\n      placement: \"top center\",\n      offset: 0,\n      alignOffset: 0\n    };\n  }\n  constructor() {\n    super();\n    new FocusVisibleController();\n    const { placement } = this.$props;\n    this.setAttributes({\n      \"data-placement\": placement\n    });\n  }\n  onAttach(el) {\n    this._attach(el);\n    Object.assign(el.style, {\n      position: \"absolute\",\n      top: 0,\n      left: 0,\n      width: \"max-content\"\n    });\n  }\n  onConnect(el) {\n    this._attach(el);\n    const tooltip = useContext(tooltipContext);\n    onDispose(() => tooltip._detachContent(el));\n    onDispose(\n      requestScopedAnimationFrame(() => {\n        if (!this.connectScope)\n          return;\n        effect(this._watchPlacement.bind(this));\n      })\n    );\n  }\n  _attach(el) {\n    const tooltip = useContext(tooltipContext);\n    tooltip._attachContent(el);\n  }\n  _watchPlacement() {\n    const { placement, offset: mainOffset, alignOffset } = this.$props;\n    return autoPlacement(this.el, this._getTrigger(), placement(), {\n      offsetVarName: \"media-tooltip\",\n      xOffset: alignOffset(),\n      yOffset: mainOffset()\n    });\n  }\n  _getTrigger() {\n    return useContext(tooltipContext)._trigger();\n  }\n}\n\nclass ToggleButtonController extends ViewController {\n  constructor(_delegate) {\n    super();\n    this._delegate = _delegate;\n    new FocusVisibleController();\n    if (_delegate._keyShortcut) {\n      new ARIAKeyShortcuts(_delegate._keyShortcut);\n    }\n  }\n  static {\n    this.props = {\n      disabled: false\n    };\n  }\n  onSetup() {\n    const { disabled } = this.$props;\n    this.setAttributes({\n      \"data-pressed\": this._delegate._isPressed,\n      \"aria-pressed\": this._isARIAPressed.bind(this),\n      \"aria-disabled\": () => disabled() ? \"true\" : null\n    });\n  }\n  onAttach(el) {\n    setAttributeIfEmpty(el, \"tabindex\", \"0\");\n    setAttributeIfEmpty(el, \"role\", \"button\");\n  }\n  onConnect(el) {\n    onPress(el, this._onMaybePress.bind(this));\n  }\n  _isARIAPressed() {\n    return ariaBool$1(this._delegate._isPressed());\n  }\n  _onPressed(event) {\n    if (isWriteSignal(this._delegate._isPressed)) {\n      this._delegate._isPressed.set((p) => !p);\n    }\n  }\n  _onMaybePress(event) {\n    const disabled = this.$props.disabled() || this.el.hasAttribute(\"data-disabled\");\n    if (disabled) {\n      event.stopImmediatePropagation();\n      return;\n    }\n    event.preventDefault();\n    (this._delegate._onPress ?? this._onPressed).call(this, event);\n  }\n}\n\nvar __defProp$d = Object.defineProperty;\nvar __getOwnPropDesc$d = Object.getOwnPropertyDescriptor;\nvar __decorateClass$d = (decorators, target, key, kind) => {\n  var result = kind > 1 ? void 0 : kind ? __getOwnPropDesc$d(target, key) : target;\n  for (var i = decorators.length - 1, decorator; i >= 0; i--)\n    if (decorator = decorators[i])\n      result = (kind ? decorator(target, key, result) : decorator(result)) || result;\n  if (kind && result)\n    __defProp$d(target, key, result);\n  return result;\n};\nclass ToggleButton extends Component {\n  constructor() {\n    super();\n    this._pressed = signal(false);\n    new ToggleButtonController({\n      _isPressed: this._pressed\n    });\n  }\n  static {\n    this.props = {\n      disabled: false,\n      defaultPressed: false\n    };\n  }\n  get pressed() {\n    return this._pressed();\n  }\n}\n__decorateClass$d([\n  prop\n], ToggleButton.prototype, \"pressed\", 1);\n\nclass PlayButton extends Component {\n  constructor() {\n    super();\n    new ToggleButtonController({\n      _isPressed: this._isPressed.bind(this),\n      _keyShortcut: \"togglePaused\",\n      _onPress: this._onPress.bind(this)\n    });\n  }\n  static {\n    this.props = ToggleButtonController.props;\n  }\n  onSetup() {\n    this._media = useMediaContext();\n    const { paused, ended } = this._media.$state;\n    this.setAttributes({\n      \"data-paused\": paused,\n      \"data-ended\": ended\n    });\n  }\n  onAttach(el) {\n    el.setAttribute(\"data-media-tooltip\", \"play\");\n    setARIALabel(el, this._getLabel.bind(this));\n  }\n  _onPress(event) {\n    const remote = this._media.remote;\n    this._isPressed() ? remote.pause(event) : remote.play(event);\n  }\n  _isPressed() {\n    const { paused } = this._media.$state;\n    return !paused();\n  }\n  _getLabel() {\n    const { paused } = this._media.$state;\n    return paused() ? \"Play\" : \"Pause\";\n  }\n}\n\nfunction ariaBool(value) {\n  return value ? \"true\" : \"false\";\n}\nfunction $ariaBool(signal) {\n  return () => ariaBool(signal());\n}\n\nclass CaptionButton extends Component {\n  constructor() {\n    super();\n    new ToggleButtonController({\n      _isPressed: this._isPressed.bind(this),\n      _keyShortcut: \"toggleCaptions\",\n      _onPress: this._onPress.bind(this)\n    });\n  }\n  static {\n    this.props = ToggleButtonController.props;\n  }\n  onSetup() {\n    this._media = useMediaContext();\n    this.setAttributes({\n      \"data-active\": this._isPressed.bind(this),\n      \"data-supported\": () => !this._isHidden(),\n      \"aria-hidden\": $ariaBool(this._isHidden.bind(this))\n    });\n  }\n  onAttach(el) {\n    el.setAttribute(\"data-media-tooltip\", \"caption\");\n    setARIALabel(el, this._getLabel.bind(this));\n  }\n  _onPress(event) {\n    this._media.remote.toggleCaptions(event);\n  }\n  _isPressed() {\n    const { textTrack } = this._media.$state, track = textTrack();\n    return !!track && isTrackCaptionKind(track);\n  }\n  _isHidden() {\n    const { textTracks } = this._media.$state;\n    return textTracks().filter(isTrackCaptionKind).length == 0;\n  }\n  _getLabel() {\n    const { textTrack } = this._media.$state;\n    return textTrack() ? \"Closed-Captions Off\" : \"Closed-Captions On\";\n  }\n}\n\nclass FullscreenButton extends Component {\n  constructor() {\n    super();\n    new ToggleButtonController({\n      _isPressed: this._isPressed.bind(this),\n      _keyShortcut: \"toggleFullscreen\",\n      _onPress: this._onPress.bind(this)\n    });\n  }\n  static {\n    this.props = {\n      ...ToggleButtonController.props,\n      target: \"prefer-media\"\n    };\n  }\n  onSetup() {\n    this._media = useMediaContext();\n    const { fullscreen } = this._media.$state, isSupported = this._isSupported.bind(this);\n    this.setAttributes({\n      \"data-active\": fullscreen,\n      \"data-supported\": isSupported,\n      \"aria-hidden\": $ariaBool(() => !isSupported())\n    });\n  }\n  onAttach(el) {\n    el.setAttribute(\"data-media-tooltip\", \"fullscreen\");\n    setARIALabel(el, this._getLabel.bind(this));\n  }\n  _onPress(event) {\n    const remote = this._media.remote, target = this.$props.target();\n    this._isPressed() ? remote.exitFullscreen(target, event) : remote.enterFullscreen(target, event);\n  }\n  _isPressed() {\n    const { fullscreen } = this._media.$state;\n    return fullscreen();\n  }\n  _isSupported() {\n    const { canFullscreen } = this._media.$state;\n    return canFullscreen();\n  }\n  _getLabel() {\n    const { fullscreen } = this._media.$state;\n    return fullscreen() ? \"Exit Fullscreen\" : \"Enter Fullscreen\";\n  }\n}\n\nclass MuteButton extends Component {\n  constructor() {\n    super();\n    new ToggleButtonController({\n      _isPressed: this._isPressed.bind(this),\n      _keyShortcut: \"toggleMuted\",\n      _onPress: this._onPress.bind(this)\n    });\n  }\n  static {\n    this.props = ToggleButtonController.props;\n  }\n  onSetup() {\n    this._media = useMediaContext();\n    this.setAttributes({\n      \"data-muted\": this._isPressed.bind(this),\n      \"data-state\": this._getState.bind(this)\n    });\n  }\n  onAttach(el) {\n    el.setAttribute(\"data-media-mute-button\", \"\");\n    el.setAttribute(\"data-media-tooltip\", \"mute\");\n    setARIALabel(el, this._getLabel.bind(this));\n  }\n  _onPress(event) {\n    const remote = this._media.remote;\n    this._isPressed() ? remote.unmute(event) : remote.mute(event);\n  }\n  _isPressed() {\n    const { muted, volume } = this._media.$state;\n    return muted() || volume() === 0;\n  }\n  _getLabel() {\n    return this._isPressed() ? \"Unmute\" : \"Mute\";\n  }\n  _getState() {\n    const { muted, volume } = this._media.$state, $volume = volume();\n    if (muted() || $volume === 0)\n      return \"muted\";\n    else if ($volume >= 0.5)\n      return \"high\";\n    else if ($volume < 0.5)\n      return \"low\";\n  }\n}\n\nclass PIPButton extends Component {\n  constructor() {\n    super();\n    new ToggleButtonController({\n      _isPressed: this._isPressed.bind(this),\n      _keyShortcut: \"togglePictureInPicture\",\n      _onPress: this._onPress.bind(this)\n    });\n  }\n  static {\n    this.props = ToggleButtonController.props;\n  }\n  onSetup() {\n    this._media = useMediaContext();\n    const { pictureInPicture } = this._media.$state, isSupported = this._isSupported.bind(this);\n    this.setAttributes({\n      \"data-active\": pictureInPicture,\n      \"data-supported\": isSupported,\n      \"aria-hidden\": $ariaBool(() => !isSupported())\n    });\n  }\n  onAttach(el) {\n    el.setAttribute(\"data-media-tooltip\", \"pip\");\n    setARIALabel(el, this._getLabel.bind(this));\n  }\n  _onPress(event) {\n    const remote = this._media.remote;\n    this._isPressed() ? remote.exitPictureInPicture(event) : remote.enterPictureInPicture(event);\n  }\n  _isPressed() {\n    const { pictureInPicture } = this._media.$state;\n    return pictureInPicture();\n  }\n  _isSupported() {\n    const { canPictureInPicture } = this._media.$state;\n    return canPictureInPicture();\n  }\n  _getLabel() {\n    const { pictureInPicture } = this._media.$state;\n    return pictureInPicture() ? \"Exit Picture In Picture\" : \"Enter Picture In Picture\";\n  }\n}\n\nclass SeekButton extends Component {\n  constructor() {\n    super();\n    new FocusVisibleController();\n  }\n  static {\n    this.props = {\n      disabled: false,\n      seconds: 30\n    };\n  }\n  onSetup() {\n    this._media = useMediaContext();\n    const { seeking } = this._media.$state, { seconds } = this.$props, isSupported = this._isSupported.bind(this);\n    this.setAttributes({\n      seconds,\n      \"data-seeking\": seeking,\n      \"data-supported\": isSupported,\n      \"aria-hidden\": $ariaBool(() => !isSupported())\n    });\n  }\n  onAttach(el) {\n    setAttributeIfEmpty(el, \"tabindex\", \"0\");\n    setAttributeIfEmpty(el, \"role\", \"button\");\n    el.setAttribute(\"data-media-tooltip\", \"seek\");\n    setARIALabel(el, this._getLabel.bind(this));\n  }\n  onConnect(el) {\n    onPress(el, this._onPress.bind(this));\n  }\n  _isSupported() {\n    const { canSeek } = this._media.$state;\n    return canSeek();\n  }\n  _getLabel() {\n    const { seconds } = this.$props;\n    return `Seek ${seconds() > 0 ? \"forward\" : \"backward\"} ${seconds()} seconds`;\n  }\n  _onPress(event) {\n    const { seconds, disabled } = this.$props;\n    if (disabled())\n      return;\n    const { currentTime } = this._media.$state, seekTo = currentTime() + seconds();\n    this._media.remote.seek(seekTo, event);\n  }\n}\n\nclass LiveButton extends Component {\n  constructor() {\n    super();\n    new FocusVisibleController();\n  }\n  static {\n    this.props = {\n      disabled: false\n    };\n  }\n  onSetup() {\n    this._media = useMediaContext();\n    const { disabled } = this.$props, { live, liveEdge } = this._media.$state, isHidden = () => !live();\n    this.setAttributes({\n      \"data-edge\": liveEdge,\n      \"data-hidden\": isHidden,\n      \"aria-disabled\": $ariaBool(disabled),\n      \"aria-hidden\": $ariaBool(isHidden)\n    });\n  }\n  onAttach(el) {\n    setAttributeIfEmpty(el, \"tabindex\", \"0\");\n    setAttributeIfEmpty(el, \"role\", \"button\");\n    el.setAttribute(\"data-media-tooltip\", \"live\");\n  }\n  onConnect(el) {\n    onPress(el, this._onPress.bind(this));\n  }\n  _onPress(event) {\n    const { disabled } = this.$props, { liveEdge } = this._media.$state;\n    if (disabled() || liveEdge())\n      return;\n    this._media.remote.seekToLiveEdge(event);\n  }\n}\n\nconst sliderState = new State({\n  min: 0,\n  max: 100,\n  value: 0,\n  pointerValue: 0,\n  focused: false,\n  dragging: false,\n  pointing: false,\n  get active() {\n    return this.dragging || this.focused || this.pointing;\n  },\n  get fillRate() {\n    return calcRate(this.min, this.max, this.value);\n  },\n  get fillPercent() {\n    return this.fillRate * 100;\n  },\n  get pointerRate() {\n    return calcRate(this.min, this.max, this.pointerValue);\n  },\n  get pointerPercent() {\n    return this.pointerRate * 100;\n  }\n});\nfunction calcRate(min, max, value) {\n  const range = max - min, offset = value - min;\n  return range > 0 ? offset / range : 0;\n}\n\nfunction getClampedValue(min, max, value, step) {\n  return clampNumber(min, round(value, getNumberOfDecimalPlaces(step)), max);\n}\nfunction getValueFromRate(min, max, rate, step) {\n  const boundRate = clampNumber(0, rate, 1), range = max - min, fill = range * boundRate, stepRatio = fill / step, steps = step * stepRatio;\n  return min + steps;\n}\n\nconst SliderKeyDirection = {\n  Left: -1,\n  ArrowLeft: -1,\n  Up: 1,\n  ArrowUp: 1,\n  Right: 1,\n  ArrowRight: 1,\n  Down: -1,\n  ArrowDown: -1\n};\nclass SliderEventsController extends ViewController {\n  constructor(_delegate, _media) {\n    super();\n    this._delegate = _delegate;\n    this._media = _media;\n    this._provider = null;\n    this._touchX = null;\n    this._touchStartValue = null;\n    this._onDocumentPointerMove = functionThrottle(\n      (event) => {\n        this._updatePointerValue(this._getPointerValue(event), event);\n      },\n      20,\n      { leading: true }\n    );\n  }\n  onConnect() {\n    effect(this._attachEventListeners.bind(this));\n    effect(this._attachPointerListeners.bind(this));\n    if (this._delegate._swipeGesture) {\n      const provider = this._media.player.el?.querySelector(\n        \"media-provider,[data-media-provider]\"\n      );\n      if (provider) {\n        this._provider = provider;\n        listenEvent(provider, \"touchstart\", this._onTouchStart.bind(this), {\n          passive: true\n        });\n        listenEvent(provider, \"touchmove\", this._onTouchMove.bind(this), {\n          passive: true\n        });\n      }\n    }\n  }\n  _onTouchStart(event) {\n    this._touchX = event.touches[0].clientX;\n  }\n  _onTouchMove(event) {\n    if (isNull(this._touchX))\n      return;\n    event.preventDefault();\n    if (this.$state.dragging())\n      return;\n    const diff = event.touches[0].clientX - this._touchX;\n    if (Math.abs(diff) > 20) {\n      this._touchX = event.touches[0].clientX;\n      this._touchStartValue = this.$state.value();\n      this._onStartDragging(this._touchStartValue, event);\n    }\n  }\n  _attachEventListeners() {\n    if (this._delegate._isDisabled())\n      return;\n    this.listen(\"focus\", this._onFocus.bind(this));\n    this.listen(\"pointerenter\", this._onPointerEnter.bind(this));\n    this.listen(\"pointermove\", this._onPointerMove.bind(this));\n    this.listen(\"pointerleave\", this._onPointerLeave.bind(this));\n    this.listen(\"pointerdown\", this._onPointerDown.bind(this));\n    this.listen(\"keydown\", this._onKeyDown.bind(this));\n    this.listen(\"keyup\", this._onKeyUp.bind(this));\n  }\n  _attachPointerListeners() {\n    if (this._delegate._isDisabled() || !this.$state.dragging())\n      return;\n    listenEvent(document, \"pointerup\", this._onDocumentPointerUp.bind(this));\n    listenEvent(document, \"pointermove\", this._onDocumentPointerMove.bind(this));\n    if (IS_SAFARI) {\n      listenEvent(document, \"touchmove\", this._onDocumentTouchMove.bind(this), {\n        passive: false\n      });\n    }\n  }\n  _onFocus() {\n    this._updatePointerValue(this.$state.value());\n  }\n  _updateValue(newValue, trigger) {\n    const { value, min, max, dragging } = this.$state;\n    const clampedValue = Math.max(min(), Math.min(newValue, max()));\n    value.set(clampedValue);\n    const event = this.createEvent(\"value-change\", { detail: clampedValue, trigger });\n    this.dispatch(event);\n    this._delegate._onValueChange?.(event);\n    if (dragging()) {\n      const event2 = this.createEvent(\"drag-value-change\", { detail: clampedValue, trigger });\n      this.dispatch(event2);\n      this._delegate._onDragValueChange?.(event2);\n    }\n  }\n  _updatePointerValue(value, trigger) {\n    const { pointerValue, dragging } = this.$state;\n    pointerValue.set(value);\n    this.dispatch(\"pointer-value-change\", { detail: value, trigger });\n    if (dragging()) {\n      this._updateValue(value, trigger);\n    }\n  }\n  _getPointerValue(event) {\n    let thumbPositionRate, rect = this.el.getBoundingClientRect(), { min, max } = this.$state;\n    if (this.$props.orientation() === \"vertical\") {\n      const { bottom: trackBottom, height: trackHeight } = rect;\n      thumbPositionRate = (trackBottom - event.clientY) / trackHeight;\n    } else {\n      if (this._touchX && isNumber(this._touchStartValue)) {\n        const { width } = this._provider.getBoundingClientRect(), rate = (event.clientX - this._touchX) / width, range = max() - min(), diff = range * Math.abs(rate);\n        thumbPositionRate = (rate < 0 ? this._touchStartValue - diff : this._touchStartValue + diff) / range;\n      } else {\n        const { left: trackLeft, width: trackWidth } = rect;\n        thumbPositionRate = (event.clientX - trackLeft) / trackWidth;\n      }\n    }\n    return Math.max(\n      min(),\n      Math.min(\n        max(),\n        this._delegate._roundValue(\n          getValueFromRate(min(), max(), thumbPositionRate, this._delegate._getStep())\n        )\n      )\n    );\n  }\n  _onPointerEnter(event) {\n    this.$state.pointing.set(true);\n  }\n  _onPointerMove(event) {\n    const { dragging } = this.$state;\n    if (dragging())\n      return;\n    this._updatePointerValue(this._getPointerValue(event), event);\n  }\n  _onPointerLeave(event) {\n    this.$state.pointing.set(false);\n  }\n  _onPointerDown(event) {\n    if (event.button !== 0)\n      return;\n    const value = this._getPointerValue(event);\n    this._onStartDragging(value, event);\n    this._updatePointerValue(value, event);\n  }\n  _onStartDragging(value, trigger) {\n    const { dragging } = this.$state;\n    if (dragging())\n      return;\n    dragging.set(true);\n    this._media.remote.pauseControls(trigger);\n    const event = this.createEvent(\"drag-start\", { detail: value, trigger });\n    this.dispatch(event);\n    this._delegate._onDragStart?.(event);\n  }\n  _onStopDragging(value, trigger) {\n    const { dragging } = this.$state;\n    if (!dragging())\n      return;\n    dragging.set(false);\n    this._media.remote.resumeControls(trigger);\n    const event = this.createEvent(\"drag-end\", { detail: value, trigger });\n    this.dispatch(event);\n    this._delegate._onDragEnd?.(event);\n    this._touchX = null;\n    this._touchStartValue = null;\n  }\n  _onKeyDown(event) {\n    const { key } = event, { min, max } = this.$state;\n    let newValue;\n    if (key === \"Home\" || key === \"PageUp\") {\n      newValue = min();\n    } else if (key === \"End\" || key === \"PageDown\") {\n      newValue = max();\n    } else if (!event.metaKey && /[0-9]/.test(key)) {\n      newValue = (max() - min()) / 10 * Number(key);\n    }\n    if (!isUndefined(newValue)) {\n      this._updatePointerValue(newValue, event);\n      this._updateValue(newValue, event);\n      return;\n    }\n    const value = this._getKeyValue(event);\n    if (isUndefined(value))\n      return;\n    const repeat = key === this._lastDownKey;\n    if (!this.$state.dragging() && repeat)\n      this._onStartDragging(value, event);\n    this._updatePointerValue(value, event);\n    if (!repeat)\n      this._updateValue(value, event);\n    this._lastDownKey = key;\n  }\n  _onKeyUp(event) {\n    this._lastDownKey = \"\";\n    const { dragging, value } = this.$state;\n    if (!dragging())\n      return;\n    const newValue = this._getKeyValue(event) ?? value();\n    this._updatePointerValue(newValue);\n    this._onStopDragging(newValue, event);\n  }\n  _getKeyValue(event) {\n    const { key, shiftKey } = event, isValidKey = Object.keys(SliderKeyDirection).includes(key);\n    if (!isValidKey)\n      return;\n    event.preventDefault();\n    event.stopPropagation();\n    const { shiftKeyMultiplier } = this.$props;\n    const { value, min, max } = this.$state, step = this._delegate._getStep(), keyStep = this._delegate._getKeyStep();\n    const modifiedStep = !shiftKey ? keyStep : keyStep * shiftKeyMultiplier(), direction = Number(SliderKeyDirection[key]), diff = modifiedStep * direction, steps = (value() + diff) / step;\n    return Math.max(min(), Math.min(max(), Number((step * steps).toFixed(3))));\n  }\n  // -------------------------------------------------------------------------------------------\n  // Document (Pointer Events)\n  // -------------------------------------------------------------------------------------------\n  _onDocumentPointerUp(event) {\n    if (event.button !== 0)\n      return;\n    const value = this._getPointerValue(event);\n    this._updatePointerValue(value, event);\n    this._onStopDragging(value, event);\n  }\n  _onDocumentTouchMove(event) {\n    event.preventDefault();\n  }\n}\n\nconst sliderValueFormatContext = createContext(() => ({}));\n\nconst sliderContext = createContext();\n\nclass SliderController extends ViewController {\n  constructor(_delegate) {\n    super();\n    this._delegate = _delegate;\n    this._updateSliderVars = animationFrameThrottle(\n      (fillPercent, pointerPercent) => {\n        this.el?.style.setProperty(\"--slider-fill\", fillPercent + \"%\");\n        this.el?.style.setProperty(\"--slider-pointer\", pointerPercent + \"%\");\n      }\n    );\n  }\n  static {\n    this.props = {\n      disabled: false,\n      step: 1,\n      keyStep: 1,\n      orientation: \"horizontal\",\n      shiftKeyMultiplier: 5\n    };\n  }\n  onSetup() {\n    this._media = useMediaContext();\n    const focus = new FocusVisibleController();\n    focus.attach(this);\n    this.$state.focused = focus.focused.bind(focus);\n    if (!hasProvidedContext(sliderValueFormatContext)) {\n      provideContext(sliderValueFormatContext, {\n        default: \"value\"\n      });\n    }\n    provideContext(sliderContext, {\n      _orientation: this.$props.orientation,\n      _disabled: this._delegate._isDisabled,\n      _preview: signal(null)\n    });\n    effect(this._watchValue.bind(this));\n    effect(this._watchDisabled.bind(this));\n    this._setupAttrs();\n    new SliderEventsController(this._delegate, this._media).attach(this);\n  }\n  onAttach(el) {\n    setAttributeIfEmpty(el, \"role\", \"slider\");\n    setAttributeIfEmpty(el, \"tabindex\", \"0\");\n    setAttributeIfEmpty(el, \"autocomplete\", \"off\");\n    effect(this._watchCSSVars.bind(this));\n  }\n  // -------------------------------------------------------------------------------------------\n  // Watch\n  // -------------------------------------------------------------------------------------------\n  _watchValue() {\n    const { dragging, value, min, max } = this.$state;\n    if (peek(dragging))\n      return;\n    value.set(getClampedValue(min(), max(), value(), this._delegate._getStep()));\n  }\n  _watchDisabled() {\n    if (!this._delegate._isDisabled())\n      return;\n    const { dragging, pointing } = this.$state;\n    dragging.set(false);\n    pointing.set(false);\n  }\n  // -------------------------------------------------------------------------------------------\n  // ARIA\n  // -------------------------------------------------------------------------------------------\n  _getARIADisabled() {\n    return ariaBool$1(this._delegate._isDisabled());\n  }\n  // -------------------------------------------------------------------------------------------\n  // Attributes\n  // -------------------------------------------------------------------------------------------\n  _setupAttrs() {\n    const { orientation } = this.$props, { dragging, active, pointing } = this.$state;\n    this.setAttributes({\n      \"data-dragging\": dragging,\n      \"data-pointing\": pointing,\n      \"data-active\": active,\n      \"aria-disabled\": this._getARIADisabled.bind(this),\n      \"aria-valuemin\": this.$state.min,\n      \"aria-valuemax\": this.$state.max,\n      \"aria-valuenow\": this._delegate._getARIAValueNow,\n      \"aria-valuetext\": this._delegate._getARIAValueText,\n      \"aria-orientation\": orientation\n    });\n  }\n  _watchCSSVars() {\n    const { fillPercent, pointerPercent } = this.$state;\n    this._updateSliderVars(round(fillPercent(), 3), round(pointerPercent(), 3));\n  }\n}\n\nclass Slider extends Component {\n  static {\n    this.props = {\n      ...SliderController.props,\n      min: 0,\n      max: 100,\n      value: 0\n    };\n  }\n  static {\n    this.state = sliderState;\n  }\n  constructor() {\n    super();\n    new SliderController({\n      _getStep: this.$props.step,\n      _getKeyStep: this.$props.keyStep,\n      _roundValue: Math.round,\n      _isDisabled: this.$props.disabled,\n      _getARIAValueNow: this._getARIAValueNow.bind(this),\n      _getARIAValueText: this._getARIAValueText.bind(this)\n    });\n  }\n  onSetup() {\n    effect(this._watchMinMax.bind(this));\n  }\n  // -------------------------------------------------------------------------------------------\n  // Props\n  // -------------------------------------------------------------------------------------------\n  _getARIAValueNow() {\n    const { value } = this.$state;\n    return Math.round(value());\n  }\n  _getARIAValueText() {\n    const { value, max } = this.$state;\n    return round(value() / max() * 100, 2) + \"%\";\n  }\n  // -------------------------------------------------------------------------------------------\n  // Watch\n  // -------------------------------------------------------------------------------------------\n  _watchMinMax() {\n    const { min, max } = this.$props;\n    this.$state.min.set(min());\n    this.$state.max.set(max());\n  }\n}\n\nconst cache = /* @__PURE__ */ new Map(), pending = /* @__PURE__ */ new Set(), registry = /* @__PURE__ */ new Set();\nclass ThumbnailsLoader {\n  constructor($src, _media) {\n    this.$src = $src;\n    this._media = _media;\n    this.$cues = signal([]);\n    effect(this._onLoadCues.bind(this));\n    registry.add(this);\n    onDispose(() => registry.delete(this));\n  }\n  static create(src) {\n    const media = useMediaContext();\n    return new ThumbnailsLoader(src, media);\n  }\n  _onLoadCues() {\n    const { canLoad } = this._media.$state;\n    if (!canLoad())\n      return;\n    const controller = new AbortController(), { crossorigin } = this._media.$state;\n    const src = this.$src();\n    if (!src)\n      return;\n    if (cache.has(src)) {\n      const cues = cache.get(src);\n      cache.delete(src);\n      cache.set(src, cues);\n      if (cache.size > 30) {\n        const firstKey = cache.keys().next().value;\n        cache.delete(firstKey);\n      }\n      this.$cues.set(cache.get(src));\n    } else if (!pending.has(src)) {\n      pending.add(src);\n      import('media-captions').then(({ parseResponse }) => {\n        parseResponse(\n          fetch(src, {\n            signal: controller.signal,\n            credentials: getRequestCredentials(crossorigin())\n          })\n        ).then(({ cues }) => {\n          this.$cues.set(cues);\n          for (const t of registry) {\n            if (peek(t.$src) === src)\n              t.$cues.set(cues);\n          }\n          cache.set(src, cues);\n          pending.delete(src);\n        }).catch(noop);\n      });\n    }\n    return () => {\n      controller.abort();\n      this.$cues.set([]);\n    };\n  }\n}\n\nclass Thumbnail extends Component {\n  constructor() {\n    super(...arguments);\n    this._styleResets = [];\n    this._requestResize = animationFrameThrottle(this._resize.bind(this));\n  }\n  static {\n    this.props = {\n      src: \"\",\n      time: 0\n    };\n  }\n  static {\n    this.state = new State({\n      src: \"\",\n      img: null,\n      coords: null,\n      activeCue: null,\n      loading: false,\n      error: null,\n      hidden: false\n    });\n  }\n  onSetup() {\n    this._media = useMediaContext();\n    this._thumbnails = ThumbnailsLoader.create(this.$props.src);\n    this.setAttributes({\n      \"data-loading\": this._isLoading.bind(this),\n      \"data-error\": this._hasError.bind(this),\n      \"data-hidden\": this.$state.hidden,\n      \"aria-hidden\": $ariaBool(this.$state.hidden)\n    });\n  }\n  onConnect(el) {\n    effect(this._watchImg.bind(this));\n    effect(this._watchHidden.bind(this));\n    effect(this._onLoadStart.bind(this));\n    effect(this._onFindActiveCue.bind(this));\n    effect(this._onResolveThumbnail.bind(this));\n  }\n  _watchImg() {\n    const img = this.$state.img();\n    if (!img)\n      return;\n    listenEvent(img, \"load\", this._onLoaded.bind(this));\n    listenEvent(img, \"error\", this._onError.bind(this));\n  }\n  _onLoadStart() {\n    const { src, loading, error } = this.$state;\n    src();\n    loading.set(true);\n    error.set(null);\n  }\n  _onLoaded() {\n    const { loading, error } = this.$state;\n    loading.set(false);\n    error.set(null);\n    this._requestResize();\n  }\n  _onError(event) {\n    const { loading, error } = this.$state;\n    loading.set(false);\n    error.set(event);\n  }\n  _isLoading() {\n    const { loading, hidden } = this.$state;\n    return !hidden() && loading();\n  }\n  _hasError() {\n    const { error } = this.$state;\n    return !isNull(error());\n  }\n  _watchHidden() {\n    const { hidden } = this.$state, { duration } = this._media.$state, cues = this._thumbnails.$cues();\n    hidden.set(this._hasError() || !Number.isFinite(duration()) || cues.length === 0);\n  }\n  _getTime() {\n    return this.$props.time();\n  }\n  _onFindActiveCue() {\n    const time = this._getTime(), { activeCue } = this.$state, { duration } = this._media.$state, cues = this._thumbnails.$cues();\n    if (!cues || !Number.isFinite(duration())) {\n      activeCue.set(null);\n      return;\n    }\n    activeCue.set(findActiveCue(cues, time));\n  }\n  _onResolveThumbnail() {\n    const { activeCue } = this.$state, cue = activeCue(), baseURL = peek(this.$props.src);\n    if (!baseURL || !cue) {\n      this.$state.src.set(\"\");\n      this._resetStyles();\n      return;\n    }\n    const [src, coords = \"\"] = (cue.text || \"\").split(\"#\");\n    this.$state.coords.set(this._resolveThumbnailCoords(coords));\n    if (!peek(this.$state.coords)) {\n      this._resetStyles();\n      return;\n    }\n    this.$state.src.set(this._resolveThumbnailSrc(src, baseURL));\n    this._requestResize();\n  }\n  _resolveThumbnailSrc(src, baseURL) {\n    return /^https?:/.test(src) ? src : new URL(src, baseURL).href;\n  }\n  _resolveThumbnailCoords(coords) {\n    const [props, values] = coords.split(\"=\"), resolvedCoords = {}, coordValues = values?.split(\",\");\n    if (!props || !values)\n      return null;\n    for (let i = 0; i < props.length; i++)\n      resolvedCoords[props[i]] = +coordValues[i];\n    return resolvedCoords;\n  }\n  _resize() {\n    if (!this.scope)\n      return;\n    const img = this.$state.img(), coords = this.$state.coords();\n    if (!img || !coords || !this.el)\n      return;\n    const { w, h, x, y } = coords, { maxWidth, maxHeight, minWidth, minHeight } = getComputedStyle(this.el), minRatio = Math.max(parseInt(minWidth) / w, parseInt(minHeight) / h), maxRatio = Math.min(parseInt(maxWidth) / w, parseInt(maxHeight) / h), scale = maxRatio < 1 ? maxRatio : minRatio > 1 ? minRatio : 1;\n    this._style(this.el, \"--thumbnail-width\", `${w * scale}px`);\n    this._style(this.el, \"--thumbnail-height\", `${h * scale}px`);\n    this._style(img, \"width\", `${img.naturalWidth * scale}px`);\n    this._style(img, \"height\", `${img.naturalHeight * scale}px`);\n    this._style(img, \"transform\", `translate(-${x * scale}px, -${y * scale}px)`);\n    this._style(img, \"max-width\", \"none\");\n  }\n  _style(el, name, value) {\n    el.style.setProperty(name, value);\n    this._styleResets.push(() => el.style.removeProperty(name));\n  }\n  _resetStyles() {\n    for (const reset of this._styleResets)\n      reset();\n    this._styleResets = [];\n  }\n}\n\nvar __defProp$c = Object.defineProperty;\nvar __getOwnPropDesc$c = Object.getOwnPropertyDescriptor;\nvar __decorateClass$c = (decorators, target, key, kind) => {\n  var result = kind > 1 ? void 0 : kind ? __getOwnPropDesc$c(target, key) : target;\n  for (var i = decorators.length - 1, decorator; i >= 0; i--)\n    if (decorator = decorators[i])\n      result = (kind ? decorator(target, key, result) : decorator(result)) || result;\n  if (kind && result)\n    __defProp$c(target, key, result);\n  return result;\n};\nclass SliderVideo extends Component {\n  static {\n    this.props = {\n      src: null\n    };\n  }\n  static {\n    this.state = new State({\n      video: null,\n      src: null,\n      canPlay: false,\n      error: null,\n      hidden: false\n    });\n  }\n  get video() {\n    return this.$state.video();\n  }\n  onSetup() {\n    this._media = useMediaContext();\n    this._slider = useState(Slider.state);\n    this.setAttributes({\n      \"data-loading\": this._isLoading.bind(this),\n      \"data-hidden\": this.$state.hidden,\n      \"data-error\": this._hasError.bind(this),\n      \"aria-hidden\": $ariaBool(this.$state.hidden)\n    });\n  }\n  onAttach(el) {\n    effect(this._watchVideo.bind(this));\n    effect(this._watchSrc.bind(this));\n    effect(this._watchHidden.bind(this));\n    effect(this._onSrcChange.bind(this));\n    effect(this._onUpdateTime.bind(this));\n  }\n  _watchVideo() {\n    const video = this.$state.video();\n    if (!video)\n      return;\n    if (video.readyState >= 2)\n      this._onCanPlay();\n    listenEvent(video, \"canplay\", this._onCanPlay.bind(this));\n    listenEvent(video, \"error\", this._onError.bind(this));\n  }\n  _watchSrc() {\n    const { src } = this.$state, { canLoad } = this._media.$state;\n    src.set(canLoad() ? this.$props.src() : null);\n  }\n  _isLoading() {\n    const { canPlay, hidden } = this.$state;\n    return !canPlay() && !hidden();\n  }\n  _hasError() {\n    const { error } = this.$state;\n    return !isNull(error);\n  }\n  _watchHidden() {\n    const { src, hidden } = this.$state, { canLoad, duration } = this._media.$state;\n    hidden.set(canLoad() && (!src() || this._hasError() || !Number.isFinite(duration())));\n  }\n  _onSrcChange() {\n    const { src, canPlay, error } = this.$state;\n    src();\n    canPlay.set(false);\n    error.set(null);\n  }\n  _onCanPlay(event) {\n    const { canPlay, error } = this.$state;\n    canPlay.set(true);\n    error.set(null);\n    this.dispatch(\"can-play\", { trigger: event });\n  }\n  _onError(event) {\n    const { canPlay, error } = this.$state;\n    canPlay.set(false);\n    error.set(event);\n    this.dispatch(\"error\", { trigger: event });\n  }\n  _onUpdateTime() {\n    const { video, canPlay } = this.$state, { duration } = this._media.$state, { pointerRate } = this._slider, media = video(), canUpdate = canPlay() && media && Number.isFinite(duration()) && Number.isFinite(pointerRate());\n    if (canUpdate) {\n      media.currentTime = pointerRate() * duration();\n    }\n  }\n}\n__decorateClass$c([\n  prop\n], SliderVideo.prototype, \"video\", 1);\n\nfunction padNumberWithZeroes(num, expectedLength) {\n  const str = String(num);\n  const actualLength = str.length;\n  const shouldPad = actualLength < expectedLength;\n  if (shouldPad) {\n    const padLength = expectedLength - actualLength;\n    const padding = `0`.repeat(padLength);\n    return `${padding}${num}`;\n  }\n  return str;\n}\nfunction parseTime(duration) {\n  const hours = Math.trunc(duration / 3600);\n  const minutes = Math.trunc(duration % 3600 / 60);\n  const seconds = Math.trunc(duration % 60);\n  const fraction = Number((duration - Math.trunc(duration)).toPrecision(3));\n  return {\n    hours,\n    minutes,\n    seconds,\n    fraction\n  };\n}\nfunction formatTime(duration, shouldPadHours = null, shouldPadMinutes = null, shouldAlwaysShowHours = false) {\n  const { hours, minutes, seconds } = parseTime(duration), paddedHours = shouldPadHours ? padNumberWithZeroes(hours, 2) : hours, paddedMinutes = shouldPadMinutes || isNull(shouldPadMinutes) && duration >= 3600 ? padNumberWithZeroes(minutes, 2) : minutes, paddedSeconds = padNumberWithZeroes(seconds, 2);\n  if (hours > 0 || shouldAlwaysShowHours) {\n    return `${paddedHours}:${paddedMinutes}:${paddedSeconds}`;\n  }\n  return `${paddedMinutes}:${paddedSeconds}`;\n}\nfunction formatSpokenTime(duration) {\n  const spokenParts = [];\n  const { hours, minutes, seconds } = parseTime(duration);\n  if (hours > 0) {\n    spokenParts.push(`${hours} hour`);\n  }\n  if (minutes > 0) {\n    spokenParts.push(`${minutes} min`);\n  }\n  if (seconds > 0 || spokenParts.length === 0) {\n    spokenParts.push(`${seconds} sec`);\n  }\n  return spokenParts.join(\" \");\n}\n\nvar __defProp$b = Object.defineProperty;\nvar __getOwnPropDesc$b = Object.getOwnPropertyDescriptor;\nvar __decorateClass$b = (decorators, target, key, kind) => {\n  var result = kind > 1 ? void 0 : kind ? __getOwnPropDesc$b(target, key) : target;\n  for (var i = decorators.length - 1, decorator; i >= 0; i--)\n    if (decorator = decorators[i])\n      result = (kind ? decorator(target, key, result) : decorator(result)) || result;\n  if (kind && result)\n    __defProp$b(target, key, result);\n  return result;\n};\nclass SliderValue extends Component {\n  static {\n    this.props = {\n      type: \"pointer\",\n      format: null,\n      showHours: false,\n      padHours: null,\n      padMinutes: null,\n      decimalPlaces: 2\n    };\n  }\n  onSetup() {\n    this._slider = useState(Slider.state);\n    this._format = useContext(sliderValueFormatContext);\n    this._text = computed(this.getValueText.bind(this));\n  }\n  getValueText() {\n    const { type, format, decimalPlaces, padHours, padMinutes, showHours } = this.$props, { value: sliderValue, pointerValue, min, max } = this._slider, _format = format() ?? this._format.default;\n    const value = type() === \"current\" ? sliderValue() : pointerValue();\n    if (_format === \"percent\") {\n      const range = max() - min();\n      const percent = value / range * 100;\n      return (this._format.percent ?? round)(percent, decimalPlaces()) + \"\\uFE6A\";\n    } else if (_format === \"time\") {\n      return (this._format.time ?? formatTime)(value, padHours(), padMinutes(), showHours());\n    } else {\n      return this._format.value?.(value) ?? value.toFixed(2);\n    }\n  }\n}\n__decorateClass$b([\n  method\n], SliderValue.prototype, \"getValueText\", 1);\n\nclass SliderPreview extends Component {\n  static {\n    this.props = {\n      offset: 0,\n      noClamp: false\n    };\n  }\n  onSetup() {\n    this._slider = useContext(sliderContext);\n    const { active } = useState(Slider.state);\n    this.setAttributes({\n      \"data-visible\": active\n    });\n  }\n  onAttach(el) {\n    Object.assign(el.style, {\n      position: \"absolute\",\n      top: 0,\n      left: 0,\n      width: \"max-content\"\n    });\n  }\n  onConnect(el) {\n    const { _preview } = this._slider;\n    _preview.set(el);\n    onDispose(() => _preview.set(null));\n    effect(this._updatePlacement.bind(this));\n    const resize = new ResizeObserver(this._updatePlacement.bind(this));\n    resize.observe(el);\n    onDispose(() => resize.disconnect());\n  }\n  _updatePlacement() {\n    const { _disabled, _orientation } = this._slider;\n    if (_disabled())\n      return;\n    const el = this.el, { offset, noClamp } = this.$props;\n    updateSliderPreviewPlacement(el, {\n      clamp: !noClamp(),\n      offset: offset(),\n      orientation: _orientation()\n    });\n  }\n}\nfunction updateSliderPreviewPlacement(el, {\n  clamp,\n  offset,\n  orientation\n}) {\n  const { width, height } = el.getBoundingClientRect(), styles = {\n    top: null,\n    right: null,\n    bottom: null,\n    left: null\n  };\n  styles[orientation === \"horizontal\" ? \"bottom\" : \"left\"] = `calc(100% + var(--media-slider-preview-offset, ${offset}px))`;\n  if (orientation === \"horizontal\") {\n    const widthHalf = width / 2;\n    if (!clamp) {\n      styles.left = `calc(var(--slider-pointer) - ${widthHalf}px)`;\n    } else {\n      const leftClamp = `max(0px, calc(var(--slider-pointer) - ${widthHalf}px))`, rightClamp = `calc(100% - ${width}px)`;\n      styles.left = `min(${leftClamp}, ${rightClamp})`;\n    }\n  } else {\n    const heightHalf = height / 2;\n    if (!clamp) {\n      styles.bottom = `calc(var(--slider-pointer) - ${heightHalf}px)`;\n    } else {\n      const topClamp = `max(${heightHalf}px, calc(var(--slider-pointer) - ${heightHalf}px))`, bottomClamp = `calc(100% - ${height}px)`;\n      styles.bottom = `min(${topClamp}, ${bottomClamp})`;\n    }\n  }\n  Object.assign(el.style, styles);\n}\n\nclass VolumeSlider extends Component {\n  constructor() {\n    super(...arguments);\n    this._throttleVolumeChange = functionThrottle(this._onVolumeChange.bind(this), 25);\n  }\n  static {\n    this.props = {\n      ...SliderController.props,\n      keyStep: 5,\n      shiftKeyMultiplier: 2\n    };\n  }\n  static {\n    this.state = sliderState;\n  }\n  onSetup() {\n    this._media = useMediaContext();\n    provideContext(sliderValueFormatContext, {\n      default: \"percent\"\n    });\n    new SliderController({\n      _getStep: this.$props.step,\n      _getKeyStep: this.$props.keyStep,\n      _isDisabled: this.$props.disabled,\n      _roundValue: Math.round,\n      _getARIAValueNow: this._getARIAValueNow.bind(this),\n      _getARIAValueText: this._getARIAValueText.bind(this),\n      _onDragValueChange: this._onDragValueChange.bind(this),\n      _onValueChange: this._onValueChange.bind(this)\n    }).attach(this);\n    effect(this._watchVolume.bind(this));\n  }\n  onAttach(el) {\n    el.setAttribute(\"data-media-volume-slider\", \"\");\n    setAttributeIfEmpty(el, \"aria-label\", \"Volume\");\n    const { canSetVolume } = this._media.$state;\n    this.setAttributes({\n      \"data-supported\": canSetVolume,\n      \"aria-hidden\": $ariaBool(() => !canSetVolume())\n    });\n  }\n  _getARIAValueNow() {\n    const { value } = this.$state;\n    return Math.round(value());\n  }\n  _getARIAValueText() {\n    const { value, max } = this.$state;\n    return round(value() / max() * 100, 2) + \"%\";\n  }\n  _watchVolume() {\n    const { muted, volume } = this._media.$state;\n    const newValue = muted() ? 0 : volume() * 100;\n    this.$state.value.set(newValue);\n    this.dispatch(\"value-change\", { detail: newValue });\n  }\n  _onVolumeChange(event) {\n    if (!event.trigger)\n      return;\n    const mediaVolume = round(event.detail / 100, 3);\n    this._media.remote.changeVolume(mediaVolume, event);\n  }\n  _onValueChange(event) {\n    this._throttleVolumeChange(event);\n  }\n  _onDragValueChange(event) {\n    this._throttleVolumeChange(event);\n  }\n}\n\nclass TimeSlider extends Component {\n  constructor() {\n    super();\n    this._chapter = signal(null);\n    this._playingBeforeDragStart = false;\n    new SliderController({\n      _swipeGesture: true,\n      _getStep: this._getStep.bind(this),\n      _getKeyStep: this._getKeyStep.bind(this),\n      _isDisabled: this._isDisabled.bind(this),\n      _roundValue: this._roundValue,\n      _getARIAValueNow: this._getARIAValueNow.bind(this),\n      _getARIAValueText: this._getARIAValueText.bind(this),\n      _onDragStart: this._onDragStart.bind(this),\n      _onDragValueChange: this._onDragValueChange.bind(this),\n      _onDragEnd: this._onDragEnd.bind(this),\n      _onValueChange: this._onValueChange.bind(this)\n    });\n  }\n  static {\n    this.props = {\n      ...SliderController.props,\n      step: 0.1,\n      keyStep: 5,\n      shiftKeyMultiplier: 2,\n      pauseWhileDragging: false,\n      seekingRequestThrottle: 100\n    };\n  }\n  static {\n    this.state = sliderState;\n  }\n  onSetup() {\n    this._media = useMediaContext();\n    provideContext(sliderValueFormatContext, {\n      default: \"time\",\n      value: this._formatValue.bind(this),\n      time: this._formatTime.bind(this)\n    });\n    this.setAttributes({\n      \"data-chapters\": this._hasChapters.bind(this)\n    });\n    this.setStyles({\n      \"--slider-progress\": this._calcBufferedPercent.bind(this)\n    });\n    effect(this._watchCurrentTime.bind(this));\n    effect(this._watchSeekingThrottle.bind(this));\n  }\n  onAttach(el) {\n    el.setAttribute(\"data-media-time-slider\", \"\");\n    setAttributeIfEmpty(el, \"aria-label\", \"Seek\");\n  }\n  onConnect(el) {\n    effect(this._watchPreviewing.bind(this));\n    observeActiveTextTrack(this._media.textTracks, \"chapters\", this._chapter.set);\n  }\n  _calcBufferedPercent() {\n    const { bufferedEnd, duration } = this._media.$state;\n    return round(Math.min(bufferedEnd() / Math.max(duration(), 1), 1) * 100, 3) + \"%\";\n  }\n  _hasChapters() {\n    const { duration } = this._media.$state;\n    return this._chapter()?.cues.length && Number.isFinite(duration()) && duration() > 0;\n  }\n  _watchSeekingThrottle() {\n    this._dispatchSeeking = functionThrottle(\n      this._seeking.bind(this),\n      this.$props.seekingRequestThrottle()\n    );\n  }\n  _watchCurrentTime() {\n    const { currentTime } = this._media.$state, { value, dragging } = this.$state, newValue = this._timeToPercent(currentTime());\n    if (!peek(dragging)) {\n      value.set(newValue);\n      this.dispatch(\"value-change\", { detail: newValue });\n    }\n  }\n  _watchPreviewing() {\n    const player = this._media.player.el, { _preview } = useContext(sliderContext);\n    player && _preview() && setAttribute(player, \"data-preview\", this.$state.active());\n  }\n  _seeking(time, event) {\n    this._media.remote.seeking(time, event);\n  }\n  _seek(time, percent, event) {\n    this._dispatchSeeking.cancel();\n    const { live } = this._media.$state;\n    if (live() && percent >= 99) {\n      this._media.remote.seekToLiveEdge(event);\n      return;\n    }\n    this._media.remote.seek(time, event);\n  }\n  _onDragStart(event) {\n    const { pauseWhileDragging } = this.$props;\n    if (pauseWhileDragging()) {\n      const { paused } = this._media.$state;\n      this._playingBeforeDragStart = !paused();\n      this._media.remote.pause(event);\n    }\n  }\n  _onDragValueChange(event) {\n    this._dispatchSeeking(this._percentToTime(event.detail), event);\n  }\n  _onDragEnd(event) {\n    const percent = event.detail;\n    this._seek(this._percentToTime(percent), percent, event);\n    const { pauseWhileDragging } = this.$props;\n    if (pauseWhileDragging() && this._playingBeforeDragStart) {\n      this._media.remote.play(event);\n      this._playingBeforeDragStart = false;\n    }\n  }\n  _onValueChange(event) {\n    const { dragging } = this.$state;\n    if (dragging() || !event.trigger)\n      return;\n    this._onDragEnd(event);\n  }\n  // -------------------------------------------------------------------------------------------\n  // Props\n  // -------------------------------------------------------------------------------------------\n  _getStep() {\n    const value = this.$props.step() / this._media.$state.duration() * 100;\n    return Number.isFinite(value) ? value : 1;\n  }\n  _getKeyStep() {\n    const value = this.$props.keyStep() / this._media.$state.duration() * 100;\n    return Number.isFinite(value) ? value : 1;\n  }\n  _roundValue(value) {\n    return round(value, 3);\n  }\n  _isDisabled() {\n    const { canSeek } = this._media.$state;\n    return this.$props.disabled() || !canSeek();\n  }\n  // -------------------------------------------------------------------------------------------\n  // ARIA\n  // -------------------------------------------------------------------------------------------\n  _getARIAValueNow() {\n    const { value } = this.$state;\n    return Math.round(value());\n  }\n  _getARIAValueText() {\n    const time = this._percentToTime(this.$state.value()), { duration } = this._media.$state;\n    return Number.isFinite(time) ? `${formatSpokenTime(time)} out of ${formatSpokenTime(duration())}` : \"live\";\n  }\n  // -------------------------------------------------------------------------------------------\n  // Format\n  // -------------------------------------------------------------------------------------------\n  _percentToTime(percent) {\n    const { duration } = this._media.$state;\n    return Math.round(percent / 100 * duration());\n  }\n  _timeToPercent(time) {\n    const { liveEdge, duration } = this._media.$state, rate = Math.max(0, Math.min(1, liveEdge() ? 1 : Math.min(time, duration()) / duration()));\n    return Number.isNaN(rate) ? 0 : Number.isFinite(rate) ? rate * 100 : 100;\n  }\n  _formatValue(percent) {\n    const time = this._percentToTime(percent), { live, duration } = this._media.$state;\n    return Number.isFinite(time) ? (live() ? time - duration() : time).toFixed(0) : \"LIVE\";\n  }\n  _formatTime(percent, padHours, padMinutes, showHours) {\n    const time = this._percentToTime(percent), { live, duration } = this._media.$state, value = live() ? time - duration() : time;\n    return Number.isFinite(time) ? `${value < 0 ? \"-\" : \"\"}${formatTime(Math.abs(value), padHours, padMinutes, showHours)}` : \"LIVE\";\n  }\n}\n\nvar __defProp$a = Object.defineProperty;\nvar __getOwnPropDesc$a = Object.getOwnPropertyDescriptor;\nvar __decorateClass$a = (decorators, target, key, kind) => {\n  var result = kind > 1 ? void 0 : kind ? __getOwnPropDesc$a(target, key) : target;\n  for (var i = decorators.length - 1, decorator; i >= 0; i--)\n    if (decorator = decorators[i])\n      result = (kind ? decorator(target, key, result) : decorator(result)) || result;\n  if (kind && result)\n    __defProp$a(target, key, result);\n  return result;\n};\nclass SliderChapters extends Component {\n  constructor() {\n    super(...arguments);\n    this._titleEl = null;\n    this._chapter = null;\n    this._currentTrack = signal(null);\n    this._refs = [];\n    this._cues = [];\n    this._$cues = signal(this._cues);\n    this._activeIndex = signal(-1);\n    this._activePointerIndex = signal(-1);\n    this._bufferedIndex = 0;\n    this._updateBufferedPercent = animationFrameThrottle((bufferedPercent) => {\n      let percent;\n      for (let i = this._bufferedIndex; i < this._refs.length; i++) {\n        percent = this._calcPercent(this._cues[i], bufferedPercent);\n        this._refs[i].style.setProperty(\"--chapter-progress\", percent + \"%\");\n        if (percent < 100) {\n          this._bufferedIndex = i;\n          break;\n        }\n      }\n    });\n    this._bufferedPercent = computed(this._calcMediaBufferedPercent.bind(this));\n  }\n  static {\n    this.props = {\n      disabled: false\n    };\n  }\n  get cues() {\n    return this._$cues();\n  }\n  get activeCue() {\n    return this._cues[this._activeIndex()] || null;\n  }\n  get activePointerCue() {\n    return this._cues[this._activePointerIndex()] || null;\n  }\n  onSetup() {\n    this._media = useMediaContext();\n    this._sliderState = useState(TimeSlider.state);\n  }\n  onAttach(el) {\n    const onChapterChange = this._onChapterChange.bind(this);\n    observeActiveTextTrack(this._media.textTracks, \"chapters\", onChapterChange);\n    effect(this._onTrackChange.bind(this));\n  }\n  onConnect() {\n    onDispose(this._reset.bind(this));\n  }\n  setRefs(refs) {\n    this._refs = refs;\n    this._updateScope?.dispose();\n    if (this._refs.length === 1) {\n      const el = this._refs[0];\n      el.style.width = \"100%\";\n      el.style.setProperty(\"--chapter-fill\", \"var(--slider-fill)\");\n      el.style.setProperty(\"--chapter-progress\", \"var(--slider-progress)\");\n    } else if (this._refs.length > 0) {\n      scoped(() => this._update(), this._updateScope = createScope());\n    }\n  }\n  _setTrack(track) {\n    if (peek(this._currentTrack) === track)\n      return;\n    this._currentTrack.set(track);\n    this._reset();\n    this._build();\n  }\n  _build() {\n    const track = this._currentTrack();\n    if (!track?.cues.length || this._cues.length)\n      return;\n    const chapters = this._fillGaps(track.cues);\n    this._cues = chapters;\n    this._$cues.set(chapters);\n    if (chapters[0].startTime === 0) {\n      this._activeIndex.set(0);\n    }\n  }\n  _reset() {\n    if (!this._cues.length)\n      return;\n    this._refs = [];\n    this._cues = [];\n    this._$cues.set(this._cues);\n    this._activeIndex.set(-1);\n    this._activePointerIndex.set(-1);\n    this._bufferedIndex = 0;\n    this._updateScope?.dispose();\n  }\n  _update() {\n    this._updateContainerWidths();\n    effect(this._watchFillPercent.bind(this));\n    effect(this._watchPointerPercent.bind(this));\n    effect(this._watchBufferedPercent.bind(this));\n  }\n  _getEndTime() {\n    return this._cues[this._cues.length - 1].endTime;\n  }\n  _updateContainerWidths() {\n    let cue, endTime = this._getEndTime();\n    for (let i = 0; i < this._cues.length; i++) {\n      cue = this._cues[i];\n      this._refs[i].style.width = round((cue.endTime - cue.startTime) / endTime * 100, 3) + \"%\";\n    }\n  }\n  _watchFillPercent() {\n    const { liveEdge, ended } = this._media.$state;\n    let { fillPercent, value } = this._sliderState, prevActiveIndex = peek(this._activeIndex), currentChapter = this._cues[prevActiveIndex], currentActiveIndex = this._findActiveChapterIndex(\n      currentChapter.startTime <= peek(value) ? prevActiveIndex : 0,\n      fillPercent()\n    );\n    if (liveEdge() || ended()) {\n      this._updateFillPercents(0, this._cues.length, \"100%\");\n    } else if (currentActiveIndex > prevActiveIndex) {\n      this._updateFillPercents(prevActiveIndex, currentActiveIndex, \"100%\");\n    } else if (currentActiveIndex < prevActiveIndex) {\n      this._updateFillPercents(currentActiveIndex + 1, prevActiveIndex + 1, \"0%\");\n    }\n    const percent = liveEdge() ? \"100%\" : this._calcPercent(this._cues[currentActiveIndex], fillPercent()) + \"%\";\n    this._updateFillPercent(this._refs[currentActiveIndex], percent);\n    this._activeIndex.set(currentActiveIndex);\n  }\n  _watchPointerPercent() {\n    let { pointing, pointerPercent } = this._sliderState;\n    if (!pointing()) {\n      this._activePointerIndex.set(-1);\n      return;\n    }\n    const activeIndex = this._findActiveChapterIndex(0, pointerPercent());\n    this._activePointerIndex.set(activeIndex);\n  }\n  _updateFillPercents(start, end, percent) {\n    for (let i = start; i < end; i++)\n      this._updateFillPercent(this._refs[i], percent);\n  }\n  _updateFillPercent(ref, percent) {\n    ref.style.setProperty(\"--chapter-fill\", percent);\n  }\n  _findActiveChapterIndex(startIndex, percent) {\n    let chapterPercent = 0;\n    for (let i = startIndex; i < this._cues.length; i++) {\n      chapterPercent = this._calcPercent(this._cues[i], percent);\n      if (chapterPercent >= 0 && chapterPercent < 100)\n        return i;\n    }\n    return 0;\n  }\n  _watchBufferedPercent() {\n    this._updateBufferedPercent(this._bufferedPercent());\n  }\n  _calcMediaBufferedPercent() {\n    const { bufferedEnd, duration } = this._media.$state;\n    return round(Math.min(bufferedEnd() / Math.max(duration(), 1), 1), 3) * 100;\n  }\n  _calcPercent(cue, percent) {\n    const lastChapter = this._cues[this._cues.length - 1], startPercent = cue.startTime / lastChapter.endTime * 100, endPercent = cue.endTime / lastChapter.endTime * 100;\n    return Math.max(\n      0,\n      round(\n        percent >= endPercent ? 100 : (percent - startPercent) / (endPercent - startPercent) * 100,\n        3\n      )\n    );\n  }\n  _fillGaps(cues) {\n    const chapters = [];\n    if (cues[0].startTime !== 0) {\n      chapters.push(new window.VTTCue(0, cues[0].startTime, \"\"));\n    }\n    for (let i = 0; i < cues.length - 1; i++) {\n      const currentCue = cues[i], nextCue = cues[i + 1];\n      chapters.push(currentCue);\n      if (nextCue) {\n        const timeDiff = nextCue.startTime - currentCue.endTime;\n        if (timeDiff > 0) {\n          chapters.push(new window.VTTCue(currentCue.endTime, currentCue.endTime + timeDiff, \"\"));\n        }\n      }\n    }\n    chapters.push(cues[cues.length - 1]);\n    return chapters;\n  }\n  _onChapterChange(track) {\n    this._chapter = track;\n    this._onTrackChange();\n  }\n  _onTrackChange() {\n    if (!this.scope)\n      return;\n    const { disabled } = this.$props;\n    if (disabled())\n      return;\n    this._setTrack(this._chapter);\n    this._titleEl = this._findParentSlider()?.querySelector('[data-part=\"chapter-title\"]') || null;\n    if (this._titleEl)\n      effect(this._onChapterTitleChange.bind(this));\n    return () => {\n      this._setTrack(null);\n      if (this._titleEl) {\n        this._titleEl.textContent = \"\";\n        this._titleEl = null;\n      }\n    };\n  }\n  _onChapterTitleChange() {\n    const cue = this.activePointerCue || this.activeCue;\n    if (this._titleEl)\n      this._titleEl.textContent = cue?.text || \"\";\n  }\n  _findParentSlider() {\n    let node = this.el;\n    while (node && node.getAttribute(\"role\") !== \"slider\") {\n      node = node.parentElement;\n    }\n    return node;\n  }\n}\n__decorateClass$a([\n  prop\n], SliderChapters.prototype, \"cues\", 1);\n__decorateClass$a([\n  prop\n], SliderChapters.prototype, \"activeCue\", 1);\n__decorateClass$a([\n  prop\n], SliderChapters.prototype, \"activePointerCue\", 1);\n__decorateClass$a([\n  method\n], SliderChapters.prototype, \"setRefs\", 1);\n\nconst menuContext = createContext();\n\nconst FOCUSABLE_ELEMENTS_SELECTOR = /* @__PURE__ */ [\n  \"a[href]\",\n  \"[tabindex]\",\n  \"input\",\n  \"select\",\n  \"button\"\n].map((selector) => `${selector}:not([aria-hidden])`).join(\",\");\nconst VALID_KEYS = /* @__PURE__ */ new Set([\n  \"Escape\",\n  \"Tab\",\n  \"ArrowUp\",\n  \"ArrowDown\",\n  \"Home\",\n  \"PageUp\",\n  \"End\",\n  \"PageDown\",\n  \"Enter\",\n  \" \"\n]);\nclass MenuFocusController {\n  constructor(_delegate) {\n    this._delegate = _delegate;\n    this._index = 0;\n    this._el = null;\n    this._elements = [];\n  }\n  get _items() {\n    return this._elements;\n  }\n  _attachMenu(el) {\n    listenEvent(el, \"focus\", this._onFocus.bind(this));\n    this._el = el;\n    onDispose(() => {\n      this._el = null;\n    });\n    return this;\n  }\n  _listen() {\n    if (!this._el)\n      return;\n    this._update();\n    listenEvent(this._el, \"keyup\", this._onKeyUp.bind(this));\n    listenEvent(this._el, \"keydown\", this._onKeyDown.bind(this));\n    onDispose(() => {\n      this._index = 0;\n      this._elements = [];\n    });\n  }\n  _update() {\n    this._index = 0;\n    this._elements = this._getFocusableElements();\n  }\n  _scroll(index = this._findActiveIndex()) {\n    const element = this._elements[index], container = this._delegate._getScrollContainer();\n    if (element && container) {\n      requestAnimationFrame(() => {\n        container.scrollTop = element.offsetTop - container.offsetHeight / 2 + element.offsetHeight / 2;\n      });\n    }\n  }\n  _focusAt(index) {\n    this._index = index;\n    this._elements[index]?.focus();\n    this._scroll(index);\n  }\n  _findActiveIndex() {\n    return this._elements.findIndex((el) => el.getAttribute(\"aria-checked\") === \"true\");\n  }\n  _onFocus() {\n    this._update();\n    setTimeout(() => {\n      const index = this._findActiveIndex();\n      this._focusAt(index >= 0 ? index : 0);\n    }, 100);\n  }\n  _onKeyUp(event) {\n    if (!VALID_KEYS.has(event.key))\n      return;\n    event.stopPropagation();\n    event.preventDefault();\n  }\n  _onKeyDown(event) {\n    if (!VALID_KEYS.has(event.key))\n      return;\n    event.stopPropagation();\n    event.preventDefault();\n    switch (event.key) {\n      case \"Escape\":\n        this._delegate._closeMenu(event);\n        break;\n      case \"Tab\":\n        this._focusAt(this._nextIndex(event.shiftKey ? -1 : 1));\n        break;\n      case \"ArrowUp\":\n        this._focusAt(this._nextIndex(-1));\n        break;\n      case \"ArrowDown\":\n        this._focusAt(this._nextIndex(1));\n        break;\n      case \"Home\":\n      case \"PageUp\":\n        this._focusAt(0);\n        break;\n      case \"End\":\n      case \"PageDown\":\n        this._focusAt(this._elements.length - 1);\n        break;\n    }\n  }\n  _nextIndex(delta) {\n    let index = this._index;\n    do {\n      index = (index + delta + this._elements.length) % this._elements.length;\n    } while (this._elements[index]?.offsetParent === null);\n    return index;\n  }\n  _getFocusableElements() {\n    if (!this._el)\n      return [];\n    const focusableElements = this._el.querySelectorAll(FOCUSABLE_ELEMENTS_SELECTOR), elements = [];\n    const is = (node) => {\n      return node.getAttribute(\"role\") === \"menu\";\n    };\n    for (const el of focusableElements) {\n      if (el instanceof HTMLElement && el.offsetParent !== null && // does not have display: none\n      isElementParent(this._el, el, is)) {\n        elements.push(el);\n      }\n    }\n    return elements;\n  }\n}\n\nvar __defProp$9 = Object.defineProperty;\nvar __getOwnPropDesc$9 = Object.getOwnPropertyDescriptor;\nvar __decorateClass$9 = (decorators, target, key, kind) => {\n  var result = kind > 1 ? void 0 : kind ? __getOwnPropDesc$9(target, key) : target;\n  for (var i = decorators.length - 1, decorator; i >= 0; i--)\n    if (decorator = decorators[i])\n      result = (kind ? decorator(target, key, result) : decorator(result)) || result;\n  if (kind && result)\n    __defProp$9(target, key, result);\n  return result;\n};\nlet idCount = 0;\nclass Menu extends Component {\n  constructor() {\n    super();\n    this._expanded = signal(false);\n    this._disabled = signal(false);\n    this._trigger = signal(null);\n    this._content = signal(null);\n    this._isTriggerDisabled = signal(false);\n    this._submenus = /* @__PURE__ */ new Set();\n    this._menuObserver = null;\n    this._removeSubmenuBind = this._removeSubmenu.bind(this);\n    this._onSubmenuOpenBind = this._onSubmenuOpen.bind(this);\n    this._onSubmenuCloseBind = this._onSubmenuClose.bind(this);\n    const { showDelay } = this.$props;\n    this._popper = new Popper({\n      _trigger: this._trigger,\n      _content: this._content,\n      _showDelay: showDelay,\n      _listen: (trigger, show, hide) => {\n        onPress(trigger, (event) => {\n          if (this._expanded())\n            hide(event);\n          else\n            show(event);\n        });\n        const closeTarget = this._getCloseTarget();\n        if (closeTarget) {\n          onPress(closeTarget, (event) => {\n            event.stopPropagation();\n            hide(event);\n          });\n        }\n      },\n      _onChange: this._onExpandedChange.bind(this)\n    });\n  }\n  static {\n    this.props = {\n      showDelay: 0\n    };\n  }\n  get triggerElement() {\n    return this._trigger();\n  }\n  get contentElement() {\n    return this._content();\n  }\n  get isSubmenu() {\n    return !!this._parentMenu;\n  }\n  onSetup() {\n    this._media = useMediaContext();\n    const currentIdCount = ++idCount;\n    this._menuId = `media-menu-${currentIdCount}`;\n    this._menuButtonId = `media-menu-button-${currentIdCount}`;\n    this._focus = new MenuFocusController({\n      _getScrollContainer: this._findScrollContainer.bind(this),\n      _closeMenu: this.close.bind(this)\n    });\n    if (hasProvidedContext(menuContext)) {\n      this._parentMenu = useContext(menuContext);\n    }\n    this.setAttributes({\n      \"data-open\": this._expanded,\n      \"data-submenu\": this.isSubmenu,\n      \"data-disabled\": this._isDisabled.bind(this)\n    });\n    provideContext(menuContext, {\n      _button: this._trigger,\n      _expanded: this._expanded,\n      _hint: signal(\"\"),\n      _disable: this._disable.bind(this),\n      _attachMenuButton: this._attachMenuButton.bind(this),\n      _attachMenuItems: this._attachMenuItems.bind(this),\n      _attachObserver: this._attachObserver.bind(this),\n      _disableMenuButton: this._disableMenuButton.bind(this),\n      _addSubmenu: this._addSubmenu.bind(this)\n    });\n  }\n  onAttach(el) {\n    el.style.setProperty(\"display\", \"contents\");\n    this._focus._attachMenu(el);\n  }\n  onConnect(el) {\n    effect(this._watchExpanded.bind(this));\n    if (this.isSubmenu)\n      this._parentMenu?._addSubmenu(this);\n    requestAnimationFrame(() => {\n      this._onResize();\n    });\n  }\n  onDestroy() {\n    this._trigger.set(null);\n    this._content.set(null);\n    this._menuObserver = null;\n  }\n  _watchExpanded() {\n    const expanded = this._isExpanded();\n    this._onResize();\n    this._updateMenuItemsHidden(expanded);\n    if (!expanded)\n      return;\n    effect(() => {\n      const { height } = this._media.$state, content = this._content();\n      content && setStyle(content, \"--player-height\", height() + \"px\");\n    });\n    this._focus._listen();\n    this.listen(\"pointerup\", this._onPointerUp.bind(this));\n    listenEvent(window, \"pointerup\", this._onWindowPointerUp.bind(this));\n  }\n  _attachMenuButton(button) {\n    const el = button.el, isMenuItem = this.isSubmenu, isARIADisabled = $ariaBool(this._isDisabled.bind(this));\n    setAttributeIfEmpty(el, \"tabindex\", isMenuItem ? \"-1\" : \"0\");\n    setAttributeIfEmpty(el, \"role\", isMenuItem ? \"menuitem\" : \"button\");\n    setAttribute(el, \"id\", this._menuButtonId);\n    setAttribute(el, \"aria-haspopup\", \"menu\");\n    setAttribute(el, \"aria-expanded\", \"false\");\n    setAttribute(el, \"data-submenu\", this.isSubmenu);\n    if (!this.isSubmenu) {\n      this._stopClickPropagation(el);\n    }\n    const watchAttrs = () => {\n      setAttribute(el, \"data-open\", this._expanded());\n      setAttribute(el, \"aria-disabled\", isARIADisabled());\n    };\n    effect(watchAttrs);\n    this._trigger.set(el);\n    onDispose(() => {\n      this._trigger.set(null);\n    });\n  }\n  _attachMenuItems(items) {\n    const el = items.el;\n    el.style.setProperty(\"display\", \"none\");\n    setAttribute(el, \"id\", this._menuId);\n    setAttributeIfEmpty(el, \"role\", \"menu\");\n    setAttributeIfEmpty(el, \"tabindex\", \"-1\");\n    setAttribute(el, \"data-submenu\", this.isSubmenu);\n    this._content.set(el);\n    onDispose(() => this._content.set(null));\n    if (!this.isSubmenu) {\n      this._stopClickPropagation(el);\n    }\n    const watchAttrs = () => {\n      setAttribute(el, \"data-open\", this._expanded());\n    };\n    effect(watchAttrs);\n    this._focus._attachMenu(el);\n    this._updateMenuItemsHidden(false);\n    {\n      requestAnimationFrame(this._onResize.bind(this));\n    }\n  }\n  _attachObserver(observer) {\n    this._menuObserver = observer;\n  }\n  _stopClickPropagation(el) {\n    listenEvent(el, \"click\", (e) => e.stopPropagation());\n    listenEvent(el, \"pointerup\", (e) => e.stopPropagation());\n  }\n  _updateMenuItemsHidden(expanded) {\n    const content = peek(this._content);\n    if (content)\n      setAttribute(content, \"aria-hidden\", ariaBool$1(!expanded));\n  }\n  _disableMenuButton(disabled) {\n    this._isTriggerDisabled.set(disabled);\n  }\n  _onExpandedChange(isExpanded, event) {\n    event?.stopPropagation();\n    if (this._expanded() === isExpanded)\n      return;\n    if (this._isDisabled()) {\n      if (isExpanded)\n        this._popper.hide(event);\n      return;\n    }\n    const trigger = this._trigger(), content = this._content();\n    if (trigger) {\n      setAttribute(trigger, \"aria-controls\", isExpanded && this._menuId);\n      setAttribute(trigger, \"aria-expanded\", ariaBool$1(isExpanded));\n    }\n    if (content)\n      setAttribute(content, \"aria-labelledby\", isExpanded && this._menuButtonId);\n    this._expanded.set(isExpanded);\n    this._toggleMediaControls(event);\n    tick();\n    if (isKeyboardEvent(event)) {\n      if (isExpanded) {\n        content?.focus();\n      } else {\n        trigger?.focus();\n      }\n      for (const el of [this.el, content]) {\n        el && el.setAttribute(\"data-keyboard\", \"\");\n      }\n    } else {\n      for (const el of [this.el, content]) {\n        el && el.removeAttribute(\"data-keyboard\");\n      }\n    }\n    this.dispatch(isExpanded ? \"open\" : \"close\", { trigger: event });\n    if (isExpanded) {\n      if (!this.isSubmenu && this._media.activeMenu !== this) {\n        this._media.activeMenu?.close(event);\n        this._media.activeMenu = this;\n      }\n      this._menuObserver?._onOpen?.(event);\n    } else {\n      if (this.isSubmenu) {\n        setTimeout(() => {\n          for (const el of this._submenus)\n            el.close(event);\n        }, 300);\n      } else {\n        this._media.activeMenu = null;\n      }\n      this._menuObserver?._onClose?.(event);\n    }\n    if (isExpanded && !isKeyboardEvent(event)) {\n      requestAnimationFrame(() => {\n        this._focus._update();\n        setTimeout(() => {\n          this._focus._scroll();\n        }, 100);\n      });\n    }\n  }\n  _isExpanded() {\n    return !this._isDisabled() && this._expanded();\n  }\n  _isDisabled() {\n    return this._disabled() || this._isTriggerDisabled();\n  }\n  _disable(disabled) {\n    this._disabled.set(disabled);\n  }\n  _onPointerUp(event) {\n    event.stopPropagation();\n  }\n  _onWindowPointerUp(event) {\n    if (this.isSubmenu)\n      return setTimeout(this.close.bind(this, event), 800);\n    else\n      this.close(event);\n  }\n  _getCloseTarget() {\n    const target = this.el.querySelector('[data-part=\"close-target\"]');\n    return isElementParent(this.el, target, (node) => node.getAttribute(\"role\") === \"menu\") ? target : null;\n  }\n  _findScrollContainer() {\n    if (!this.isSubmenu) {\n      const content = peek(this._content);\n      return content || null;\n    } else {\n      let el = this.el;\n      while (el && el.tagName !== \"media-menu\" && el.hasAttribute(\"data-submenu\")) {\n        el = el.parentNode;\n      }\n      return el;\n    }\n  }\n  _toggleMediaControls(trigger) {\n    if (this.isSubmenu)\n      return;\n    if (this._expanded())\n      this._media.remote.pauseControls(trigger);\n    else\n      this._media.remote.resumeControls(trigger);\n  }\n  _addSubmenu(menu) {\n    this._submenus.add(menu);\n    listenEvent(menu, \"open\", this._onSubmenuOpenBind);\n    listenEvent(menu, \"close\", this._onSubmenuCloseBind);\n    onDispose(this._removeSubmenuBind);\n  }\n  _removeSubmenu(menu) {\n    this._submenus.delete(menu);\n  }\n  _onSubmenuOpen(event) {\n    for (const target of this._submenus) {\n      if (target !== event.target) {\n        for (const el of [target.el, target.triggerElement]) {\n          el?.setAttribute(\"aria-hidden\", \"true\");\n        }\n      }\n    }\n    requestAnimationFrame(() => {\n      this._onResize();\n    });\n  }\n  _onSubmenuClose() {\n    for (const target of this._submenus) {\n      for (const el of [target.el, target.triggerElement]) {\n        el?.setAttribute(\"aria-hidden\", \"false\");\n      }\n    }\n    requestAnimationFrame(() => {\n      this._onResize();\n    });\n  }\n  _onResize() {\n    const content = peek(this._content);\n    if (!content || false)\n      return;\n    let { paddingTop, paddingBottom, borderTopWidth, borderBottomWidth } = getComputedStyle(content), height = parseFloat(paddingTop) + parseFloat(paddingBottom) + parseFloat(borderTopWidth) + parseFloat(borderBottomWidth), children = [...content.children];\n    for (const child of children) {\n      if (child instanceof HTMLElement && child.style.display === \"contents\") {\n        children.push(...child.children);\n      } else {\n        height += child.offsetHeight || 0;\n      }\n    }\n    requestAnimationFrame(() => {\n      if (!content)\n        return;\n      setAttribute(content, \"data-resizing\", \"\");\n      setTimeout(() => {\n        if (content)\n          setAttribute(content, \"data-resizing\", false);\n      }, 400);\n      setStyle(content, \"--menu-height\", height + \"px\");\n    });\n  }\n  open(trigger) {\n    if (peek(this._expanded))\n      return;\n    this._popper.show(trigger);\n    tick();\n  }\n  close(trigger) {\n    if (!peek(this._expanded))\n      return;\n    this._popper.hide(trigger);\n    tick();\n  }\n}\n__decorateClass$9([\n  prop\n], Menu.prototype, \"triggerElement\", 1);\n__decorateClass$9([\n  prop\n], Menu.prototype, \"contentElement\", 1);\n__decorateClass$9([\n  prop\n], Menu.prototype, \"isSubmenu\", 1);\n__decorateClass$9([\n  method\n], Menu.prototype, \"open\", 1);\n__decorateClass$9([\n  method\n], Menu.prototype, \"close\", 1);\n\nvar __defProp$8 = Object.defineProperty;\nvar __getOwnPropDesc$8 = Object.getOwnPropertyDescriptor;\nvar __decorateClass$8 = (decorators, target, key, kind) => {\n  var result = kind > 1 ? void 0 : kind ? __getOwnPropDesc$8(target, key) : target;\n  for (var i = decorators.length - 1, decorator; i >= 0; i--)\n    if (decorator = decorators[i])\n      result = (kind ? decorator(target, key, result) : decorator(result)) || result;\n  if (kind && result)\n    __defProp$8(target, key, result);\n  return result;\n};\nclass MenuButton extends Component {\n  constructor() {\n    super();\n    new FocusVisibleController();\n  }\n  static {\n    this.props = {\n      disabled: false\n    };\n  }\n  get expanded() {\n    return this._menu?._expanded() ?? false;\n  }\n  onSetup() {\n    this._menu = useContext(menuContext);\n  }\n  onAttach(el) {\n    this._menu._attachMenuButton(this);\n    effect(this._watchDisabled.bind(this));\n  }\n  onConnect(el) {\n    const hint = Array.from(el.querySelectorAll('[data-part=\"hint\"]')).pop();\n    if (hint) {\n      effect(() => {\n        const text = this._menu._hint();\n        if (text)\n          hint.textContent = text;\n      });\n    }\n    onPress(el, (trigger) => {\n      this.dispatch(\"select\", { trigger });\n    });\n  }\n  _watchDisabled() {\n    this._menu._disableMenuButton(this.$props.disabled());\n  }\n}\n__decorateClass$8([\n  prop\n], MenuButton.prototype, \"expanded\", 1);\n\nclass MenuPortal extends Component {\n  constructor() {\n    super(...arguments);\n    this._target = null;\n  }\n  static {\n    this.props = {\n      container: null,\n      disabled: false\n    };\n  }\n  onSetup() {\n    this._media = useMediaContext();\n    provideContext(menuPortalContext, {\n      _attach: this._attachElement.bind(this)\n    });\n  }\n  onAttach(el) {\n    el.style.setProperty(\"display\", \"contents\");\n  }\n  // Need this so connect scope is defined.\n  onConnect(el) {\n  }\n  onDestroy() {\n    this._target?.remove();\n    this._target = null;\n  }\n  _attachElement(el) {\n    this._portal(false);\n    this._target = el;\n    requestScopedAnimationFrame(() => {\n      requestScopedAnimationFrame(() => {\n        if (!this.connectScope)\n          return;\n        effect(this._watchDisabled.bind(this));\n      });\n    });\n  }\n  _watchDisabled() {\n    const { fullscreen } = this._media.$state, { disabled } = this.$props, _disabled = disabled();\n    this._portal(_disabled === \"fullscreen\" ? !fullscreen() : !_disabled);\n  }\n  _portal(shouldPortal) {\n    if (!this._target)\n      return;\n    let container = this._getContainer(this.$props.container());\n    if (!container)\n      return;\n    const isPortalled = this._target.parentElement === container;\n    setAttribute(this._target, \"data-portal\", shouldPortal);\n    if (shouldPortal) {\n      if (!isPortalled) {\n        this._target.remove();\n        container.append(this._target);\n      }\n    } else if (isPortalled && this._target.parentElement === container) {\n      this._target.remove();\n      this.el?.append(this._target);\n    }\n  }\n  _getContainer(selector) {\n    if (selector instanceof HTMLElement)\n      return selector;\n    return selector ? document.querySelector(selector) : document.body;\n  }\n}\nconst menuPortalContext = createContext();\n\nclass MenuItems extends Component {\n  constructor() {\n    super();\n    new FocusVisibleController();\n    const { placement } = this.$props;\n    this.setAttributes({\n      \"data-placement\": placement\n    });\n  }\n  static {\n    this.props = {\n      placement: null,\n      offset: 0,\n      alignOffset: 0\n    };\n  }\n  onAttach(el) {\n    this._menu = useContext(menuContext);\n    this._menu._attachMenuItems(this);\n    if (hasProvidedContext(menuPortalContext)) {\n      const portal = useContext(menuPortalContext);\n      if (portal) {\n        provideContext(menuPortalContext, null);\n        portal._attach(el);\n        onDispose(() => portal._attach(null));\n      }\n    }\n  }\n  onConnect(el) {\n    effect(this._watchPlacement.bind(this));\n  }\n  _watchPlacement() {\n    if (!this.el)\n      return;\n    const placement = this.$props.placement();\n    if (placement) {\n      Object.assign(this.el.style, {\n        position: \"absolute\",\n        top: 0,\n        left: 0,\n        width: \"max-content\"\n      });\n      const { offset: mainOffset, alignOffset } = this.$props;\n      return autoPlacement(this.el, this._getButton(), placement, {\n        offsetVarName: \"media-menu\",\n        xOffset: alignOffset(),\n        yOffset: mainOffset()\n      });\n    } else {\n      this.el.removeAttribute(\"style\");\n      this.el.style.display = \"none\";\n    }\n  }\n  _getButton() {\n    return this._menu._button();\n  }\n}\n\nconst radioControllerContext = createContext();\n\nclass RadioGroupController extends ViewController {\n  constructor() {\n    super(...arguments);\n    this._group = /* @__PURE__ */ new Set();\n    this._value = signal(\"\");\n    this._controller = null;\n    this._onChangeBind = this._onChange.bind(this);\n  }\n  get _values() {\n    return Array.from(this._group).map((radio) => radio._value());\n  }\n  get value() {\n    return this._value();\n  }\n  set value(value) {\n    this._onChange(value);\n  }\n  onSetup() {\n    provideContext(radioControllerContext, {\n      add: this._addRadio.bind(this),\n      remove: this._removeRadio.bind(this)\n    });\n  }\n  onAttach(el) {\n    const isMenuItem = hasProvidedContext(menuContext);\n    if (!isMenuItem)\n      setAttributeIfEmpty(el, \"role\", \"radiogroup\");\n    this.setAttributes({ value: this._value });\n  }\n  onDestroy() {\n    this._group.clear();\n  }\n  _addRadio(radio) {\n    if (this._group.has(radio))\n      return;\n    this._group.add(radio);\n    radio._onCheck = this._onChangeBind;\n    radio._check(radio._value() === this._value());\n  }\n  _removeRadio(radio) {\n    radio._onCheck = null;\n    this._group.delete(radio);\n  }\n  _onChange(newValue, trigger) {\n    const currentValue = peek(this._value);\n    if (!newValue || newValue === currentValue)\n      return;\n    const currentRadio = this._findRadio(currentValue), newRadio = this._findRadio(newValue);\n    currentRadio?._check(false, trigger);\n    newRadio?._check(true, trigger);\n    this._value.set(newValue);\n    this._onValueChange?.(newValue, trigger);\n  }\n  _findRadio(newValue) {\n    for (const radio of this._group) {\n      if (newValue === peek(radio._value))\n        return radio;\n    }\n    return null;\n  }\n}\n\nvar __defProp$7 = Object.defineProperty;\nvar __getOwnPropDesc$7 = Object.getOwnPropertyDescriptor;\nvar __decorateClass$7 = (decorators, target, key, kind) => {\n  var result = kind > 1 ? void 0 : kind ? __getOwnPropDesc$7(target, key) : target;\n  for (var i = decorators.length - 1, decorator; i >= 0; i--)\n    if (decorator = decorators[i])\n      result = (kind ? decorator(target, key, result) : decorator(result)) || result;\n  if (kind && result)\n    __defProp$7(target, key, result);\n  return result;\n};\nclass RadioGroup extends Component {\n  constructor() {\n    super();\n    this._controller = new RadioGroupController();\n    this._controller._onValueChange = this._onValueChange.bind(this);\n  }\n  static {\n    this.props = {\n      value: \"\"\n    };\n  }\n  get values() {\n    return this._controller._values;\n  }\n  get value() {\n    return this._controller.value;\n  }\n  onSetup() {\n    effect(this._watchValue.bind(this));\n  }\n  _watchValue() {\n    this._controller.value = this.$props.value();\n  }\n  _onValueChange(value, trigger) {\n    const event = this.createEvent(\"change\", { detail: value, trigger });\n    this.dispatch(event);\n  }\n}\n__decorateClass$7([\n  prop\n], RadioGroup.prototype, \"values\", 1);\n__decorateClass$7([\n  prop\n], RadioGroup.prototype, \"value\", 1);\n\nvar __defProp$6 = Object.defineProperty;\nvar __getOwnPropDesc$6 = Object.getOwnPropertyDescriptor;\nvar __decorateClass$6 = (decorators, target, key, kind) => {\n  var result = kind > 1 ? void 0 : kind ? __getOwnPropDesc$6(target, key) : target;\n  for (var i = decorators.length - 1, decorator; i >= 0; i--)\n    if (decorator = decorators[i])\n      result = (kind ? decorator(target, key, result) : decorator(result)) || result;\n  if (kind && result)\n    __defProp$6(target, key, result);\n  return result;\n};\nclass Radio extends Component {\n  constructor() {\n    super();\n    this._checked = signal(false);\n    this._controller = {\n      _value: this.$props.value,\n      _check: this._check.bind(this),\n      _onCheck: null\n    };\n    new FocusVisibleController();\n  }\n  static {\n    this.props = {\n      value: \"\"\n    };\n  }\n  get checked() {\n    return this._checked();\n  }\n  onSetup() {\n    this.setAttributes({\n      value: this.$props.value,\n      \"data-checked\": this._checked,\n      \"aria-checked\": $ariaBool(this._checked)\n    });\n  }\n  onAttach(el) {\n    const isMenuItem = hasProvidedContext(menuContext);\n    setAttributeIfEmpty(el, \"tabindex\", isMenuItem ? \"-1\" : \"0\");\n    setAttributeIfEmpty(el, \"role\", isMenuItem ? \"menuitemradio\" : \"radio\");\n    effect(this._watchValue.bind(this));\n  }\n  onConnect(el) {\n    this._addToGroup();\n    onPress(el, this._onPress.bind(this));\n    onDispose(this._onDisconnect.bind(this));\n  }\n  _onDisconnect() {\n    scoped(() => {\n      const group = useContext(radioControllerContext);\n      group.remove(this._controller);\n    }, this.connectScope);\n  }\n  _addToGroup() {\n    const group = useContext(radioControllerContext);\n    group.add(this._controller);\n  }\n  _watchValue() {\n    const { value } = this.$props, newValue = value();\n    if (peek(this._checked)) {\n      this._controller._onCheck?.(newValue);\n    }\n  }\n  _onPress(event) {\n    if (peek(this._checked))\n      return;\n    this._onChange(true, event);\n    this._onSelect(event);\n    this._controller._onCheck?.(peek(this.$props.value), event);\n  }\n  _check(value, trigger) {\n    if (peek(this._checked) === value)\n      return;\n    this._onChange(value, trigger);\n  }\n  _onChange(value, trigger) {\n    this._checked.set(value);\n    this.dispatch(\"change\", { detail: value, trigger });\n  }\n  _onSelect(trigger) {\n    this.dispatch(\"select\", { trigger });\n  }\n}\n__decorateClass$6([\n  prop\n], Radio.prototype, \"checked\", 1);\n\nvar __defProp$5 = Object.defineProperty;\nvar __getOwnPropDesc$5 = Object.getOwnPropertyDescriptor;\nvar __decorateClass$5 = (decorators, target, key, kind) => {\n  var result = kind > 1 ? void 0 : kind ? __getOwnPropDesc$5(target, key) : target;\n  for (var i = decorators.length - 1, decorator; i >= 0; i--)\n    if (decorator = decorators[i])\n      result = (kind ? decorator(target, key, result) : decorator(result)) || result;\n  if (kind && result)\n    __defProp$5(target, key, result);\n  return result;\n};\nclass ChaptersRadioGroup extends Component {\n  constructor() {\n    super();\n    this._index = signal(0);\n    this._track = signal(null);\n    this._controller = new RadioGroupController();\n    this._controller._onValueChange = this._onValueChange.bind(this);\n  }\n  static {\n    this.props = {\n      thumbnails: \"\"\n    };\n  }\n  get value() {\n    return this._controller.value;\n  }\n  get disabled() {\n    const track = this._track();\n    return !track || !track.cues.length;\n  }\n  onSetup() {\n    this._media = useMediaContext();\n    if (hasProvidedContext(menuContext)) {\n      this._menu = useContext(menuContext);\n    }\n    const { thumbnails } = this.$props;\n    this.setAttributes({\n      \"data-thumbnails\": () => !!thumbnails()\n    });\n  }\n  onAttach(el) {\n    this._menu?._attachObserver({\n      _onOpen: this._onOpen.bind(this)\n    });\n  }\n  getOptions() {\n    const track = this._track();\n    if (!track)\n      return [];\n    return track.cues.map((cue, i) => ({\n      cue,\n      value: i + \"\",\n      label: cue.text,\n      startTime: formatTime(cue.startTime, false),\n      duration: formatSpokenTime(cue.endTime - cue.startTime)\n    }));\n  }\n  _onOpen() {\n    peek(() => this._watchCurrentTime());\n  }\n  onConnect(el) {\n    effect(this._watchValue.bind(this));\n    effect(this._watchCurrentTime.bind(this));\n    effect(this._watchControllerDisabled.bind(this));\n    observeActiveTextTrack(this._media.textTracks, \"chapters\", this._track.set);\n  }\n  _watchValue() {\n    this._controller.value = this._getValue();\n  }\n  _watchCurrentTime() {\n    if (!this._menu?._expanded())\n      return;\n    const track = this._track();\n    if (!track) {\n      this._index.set(-1);\n      return;\n    }\n    const { currentTime } = this._media.$state, time = currentTime(), activeCueIndex = track.cues.findIndex((cue) => isCueActive(cue, time));\n    this._index.set(activeCueIndex);\n    if (activeCueIndex >= 0) {\n      const cue = track.cues[activeCueIndex], radio = this.el.querySelector(`[aria-checked='true']`), playedPercent = (time - cue.startTime) / (cue.endTime - cue.startTime) * 100;\n      radio && setStyle(radio, \"--progress\", round(playedPercent, 3) + \"%\");\n    }\n  }\n  _watchControllerDisabled() {\n    this._menu?._disable(this.disabled);\n  }\n  _getValue() {\n    return this._index() + \"\";\n  }\n  _onValueChange(value, trigger) {\n    if (this.disabled || !trigger)\n      return;\n    const index = +value, cues = this._track()?.cues;\n    if (isNumber(index) && cues?.[index]) {\n      this._index.set(index);\n      this._media.remote.seek(cues[index].startTime, trigger);\n      this.dispatch(\"change\", { detail: cues[index], trigger });\n    }\n  }\n}\n__decorateClass$5([\n  prop\n], ChaptersRadioGroup.prototype, \"value\", 1);\n__decorateClass$5([\n  prop\n], ChaptersRadioGroup.prototype, \"disabled\", 1);\n__decorateClass$5([\n  method\n], ChaptersRadioGroup.prototype, \"getOptions\", 1);\n\nvar __defProp$4 = Object.defineProperty;\nvar __getOwnPropDesc$4 = Object.getOwnPropertyDescriptor;\nvar __decorateClass$4 = (decorators, target, key, kind) => {\n  var result = kind > 1 ? void 0 : kind ? __getOwnPropDesc$4(target, key) : target;\n  for (var i = decorators.length - 1, decorator; i >= 0; i--)\n    if (decorator = decorators[i])\n      result = (kind ? decorator(target, key, result) : decorator(result)) || result;\n  if (kind && result)\n    __defProp$4(target, key, result);\n  return result;\n};\nclass AudioRadioGroup extends Component {\n  constructor() {\n    super();\n    this._controller = new RadioGroupController();\n    this._controller._onValueChange = this._onValueChange.bind(this);\n  }\n  static {\n    this.props = {\n      emptyLabel: \"Default\"\n    };\n  }\n  get value() {\n    return this._controller.value;\n  }\n  get disabled() {\n    const { audioTracks } = this._media.$state;\n    return audioTracks().length === 0;\n  }\n  onSetup() {\n    this._media = useMediaContext();\n    if (hasProvidedContext(menuContext)) {\n      this._menu = useContext(menuContext);\n    }\n  }\n  onConnect(el) {\n    effect(this._watchValue.bind(this));\n    effect(this._watchControllerDisabled.bind(this));\n    effect(this._watchHintText.bind(this));\n  }\n  getOptions() {\n    const { audioTracks } = this._media.$state;\n    return audioTracks().map((track) => ({\n      track,\n      label: track.label,\n      value: track.label.toLowerCase()\n    }));\n  }\n  _watchValue() {\n    this._controller.value = this._getValue();\n  }\n  _watchHintText() {\n    const { emptyLabel } = this.$props, { audioTrack } = this._media.$state, track = audioTrack();\n    this._menu?._hint.set(track?.label ?? emptyLabel());\n  }\n  _watchControllerDisabled() {\n    this._menu?._disable(this.disabled);\n  }\n  _getValue() {\n    const { audioTrack } = this._media.$state;\n    const track = audioTrack();\n    return track ? track.label.toLowerCase() : \"\";\n  }\n  _onValueChange(value, trigger) {\n    if (this.disabled)\n      return;\n    const index = this._media.audioTracks.toArray().findIndex((track) => track.label.toLowerCase() === value);\n    if (index >= 0) {\n      const track = this._media.audioTracks[index];\n      this._media.remote.changeAudioTrack(index, trigger);\n      this.dispatch(\"change\", { detail: track, trigger });\n    }\n  }\n}\n__decorateClass$4([\n  prop\n], AudioRadioGroup.prototype, \"value\", 1);\n__decorateClass$4([\n  prop\n], AudioRadioGroup.prototype, \"disabled\", 1);\n__decorateClass$4([\n  method\n], AudioRadioGroup.prototype, \"getOptions\", 1);\n\nvar __defProp$3 = Object.defineProperty;\nvar __getOwnPropDesc$3 = Object.getOwnPropertyDescriptor;\nvar __decorateClass$3 = (decorators, target, key, kind) => {\n  var result = kind > 1 ? void 0 : kind ? __getOwnPropDesc$3(target, key) : target;\n  for (var i = decorators.length - 1, decorator; i >= 0; i--)\n    if (decorator = decorators[i])\n      result = (kind ? decorator(target, key, result) : decorator(result)) || result;\n  if (kind && result)\n    __defProp$3(target, key, result);\n  return result;\n};\nclass CaptionsRadioGroup extends Component {\n  constructor() {\n    super();\n    this._controller = new RadioGroupController();\n    this._controller._onValueChange = this._onValueChange.bind(this);\n  }\n  static {\n    this.props = {\n      offLabel: \"Off\"\n    };\n  }\n  get value() {\n    return this._controller.value;\n  }\n  get disabled() {\n    const { textTracks } = this._media.$state;\n    return textTracks().filter(isTrackCaptionKind).length === 0;\n  }\n  onSetup() {\n    this._media = useMediaContext();\n    if (hasProvidedContext(menuContext)) {\n      this._menu = useContext(menuContext);\n    }\n  }\n  onConnect(el) {\n    super.onConnect?.(el);\n    effect(this._watchValue.bind(this));\n    effect(this._watchControllerDisabled.bind(this));\n    effect(this._watchHintText.bind(this));\n  }\n  getOptions() {\n    const { offLabel } = this.$props, { textTracks } = this._media.$state;\n    return [\n      { value: \"off\", label: offLabel },\n      ...textTracks().filter(isTrackCaptionKind).map((track) => ({\n        track,\n        label: track.label,\n        value: track.label.toLowerCase()\n      }))\n    ];\n  }\n  _watchValue() {\n    this._controller.value = this._getValue();\n  }\n  _watchHintText() {\n    const { offLabel } = this.$props, { textTrack } = this._media.$state, track = textTrack();\n    this._menu?._hint.set(\n      track && isTrackCaptionKind(track) && track.mode === \"showing\" ? track.label : offLabel()\n    );\n  }\n  _watchControllerDisabled() {\n    this._menu?._disable(this.disabled);\n  }\n  _getValue() {\n    const { textTrack } = this._media.$state, track = textTrack();\n    return track && isTrackCaptionKind(track) && track.mode === \"showing\" ? track.label.toLowerCase() : \"off\";\n  }\n  _onValueChange(value, trigger) {\n    if (this.disabled)\n      return;\n    if (value === \"off\") {\n      const track = this._media.textTracks.selected;\n      if (track) {\n        const index2 = this._media.textTracks.toArray().indexOf(track);\n        this._media.remote.changeTextTrackMode(index2, \"disabled\", trigger);\n        this.dispatch(\"change\", { detail: null, trigger });\n      }\n      return;\n    }\n    const index = this._media.textTracks.toArray().findIndex((track) => track.label.toLowerCase() === value);\n    if (index >= 0) {\n      const track = this._media.textTracks[index];\n      this._media.remote.changeTextTrackMode(index, \"showing\", trigger);\n      this.dispatch(\"change\", { detail: track, trigger });\n    }\n  }\n}\n__decorateClass$3([\n  prop\n], CaptionsRadioGroup.prototype, \"value\", 1);\n__decorateClass$3([\n  prop\n], CaptionsRadioGroup.prototype, \"disabled\", 1);\n__decorateClass$3([\n  method\n], CaptionsRadioGroup.prototype, \"getOptions\", 1);\n\nvar __defProp$2 = Object.defineProperty;\nvar __getOwnPropDesc$2 = Object.getOwnPropertyDescriptor;\nvar __decorateClass$2 = (decorators, target, key, kind) => {\n  var result = kind > 1 ? void 0 : kind ? __getOwnPropDesc$2(target, key) : target;\n  for (var i = decorators.length - 1, decorator; i >= 0; i--)\n    if (decorator = decorators[i])\n      result = (kind ? decorator(target, key, result) : decorator(result)) || result;\n  if (kind && result)\n    __defProp$2(target, key, result);\n  return result;\n};\nclass SpeedRadioGroup extends Component {\n  constructor() {\n    super();\n    this._controller = new RadioGroupController();\n    this._controller._onValueChange = this._onValueChange.bind(this);\n  }\n  static {\n    this.props = {\n      normalLabel: \"Normal\",\n      rates: [0.25, 0.5, 0.75, 1, 1.25, 1.5, 1.75, 2]\n    };\n  }\n  get value() {\n    return this._controller.value;\n  }\n  onSetup() {\n    this._media = useMediaContext();\n    if (hasProvidedContext(menuContext)) {\n      this._menu = useContext(menuContext);\n    }\n  }\n  onConnect(el) {\n    effect(this._watchValue.bind(this));\n    effect(this._watchHintText.bind(this));\n  }\n  getOptions() {\n    const { rates, normalLabel } = this.$props;\n    return rates().map((rate) => ({\n      label: rate === 1 ? normalLabel : rate + \"\\xD7\",\n      value: rate + \"\"\n    }));\n  }\n  _watchValue() {\n    this._controller.value = this._getValue();\n  }\n  _watchHintText() {\n    const { normalLabel } = this.$props, { playbackRate } = this._media.$state, rate = playbackRate();\n    this._menu?._hint.set(rate === 1 ? normalLabel() : rate + \"\\xD7\");\n  }\n  _getValue() {\n    const { playbackRate } = this._media.$state;\n    return playbackRate() + \"\";\n  }\n  _onValueChange(value, trigger) {\n    const rate = +value;\n    this._media.remote.changePlaybackRate(rate, trigger);\n    this.dispatch(\"change\", { detail: rate, trigger });\n  }\n}\n__decorateClass$2([\n  prop\n], SpeedRadioGroup.prototype, \"value\", 1);\n__decorateClass$2([\n  method\n], SpeedRadioGroup.prototype, \"getOptions\", 1);\n\nvar __defProp$1 = Object.defineProperty;\nvar __getOwnPropDesc$1 = Object.getOwnPropertyDescriptor;\nvar __decorateClass$1 = (decorators, target, key, kind) => {\n  var result = kind > 1 ? void 0 : kind ? __getOwnPropDesc$1(target, key) : target;\n  for (var i = decorators.length - 1, decorator; i >= 0; i--)\n    if (decorator = decorators[i])\n      result = (kind ? decorator(target, key, result) : decorator(result)) || result;\n  if (kind && result)\n    __defProp$1(target, key, result);\n  return result;\n};\nclass QualityRadioGroup extends Component {\n  constructor() {\n    super();\n    this._sortedQualities = computed(() => {\n      const { qualities } = this._media.$state;\n      return [...qualities()].sort(\n        (a, b) => b.height === a.height ? b.bitrate - a.bitrate : b.height - a.height\n      );\n    });\n    this._controller = new RadioGroupController();\n    this._controller._onValueChange = this._onValueChange.bind(this);\n  }\n  static {\n    this.props = {\n      autoLabel: \"Auto\",\n      hideBitrate: false\n    };\n  }\n  get value() {\n    return this._controller.value;\n  }\n  get disabled() {\n    const { canSetQuality, qualities } = this._media.$state;\n    return !canSetQuality() || qualities().length === 0;\n  }\n  onSetup() {\n    this._media = useMediaContext();\n    if (hasProvidedContext(menuContext)) {\n      this._menu = useContext(menuContext);\n    }\n  }\n  onConnect(el) {\n    effect(this._watchValue.bind(this));\n    effect(this._watchControllerDisabled.bind(this));\n    effect(this._watchHintText.bind(this));\n  }\n  getOptions() {\n    const { autoLabel, hideBitrate } = this.$props;\n    return [\n      { value: \"auto\", label: autoLabel },\n      ...this._sortedQualities().map((quality) => {\n        const rate = `${round(quality.bitrate / 1e6, 2)} Mbps`;\n        return {\n          quality,\n          label: quality.height + \"p\",\n          value: this._getQualityId(quality),\n          bitrate: () => !hideBitrate() ? rate : null\n        };\n      })\n    ];\n  }\n  _watchValue() {\n    this._controller.value = this._getValue();\n  }\n  _watchHintText() {\n    const { autoLabel } = this.$props, { autoQuality, quality } = this._media.$state, qualityText = quality() ? quality().height + \"p\" : \"\";\n    this._menu?._hint.set(!autoQuality() ? qualityText : autoLabel() + ` (${qualityText})`);\n  }\n  _watchControllerDisabled() {\n    const { qualities } = this._media.$state;\n    this._menu?._disable(qualities().length === 0);\n  }\n  _onValueChange(value, trigger) {\n    if (this.disabled)\n      return;\n    if (value === \"auto\") {\n      this._media.remote.changeQuality(-1, trigger);\n      this.dispatch(\"change\", { detail: \"auto\", trigger });\n      return;\n    }\n    const { qualities } = this._media.$state, index = peek(qualities).findIndex((quality) => this._getQualityId(quality) === value);\n    if (index >= 0) {\n      const quality = peek(qualities)[index];\n      this._media.remote.changeQuality(index, trigger);\n      this.dispatch(\"change\", { detail: quality, trigger });\n    }\n  }\n  _getValue() {\n    const { quality, autoQuality } = this._media.$state;\n    if (autoQuality())\n      return \"auto\";\n    const currentQuality = quality();\n    return currentQuality ? this._getQualityId(currentQuality) : \"auto\";\n  }\n  _getQualityId(quality) {\n    return quality.height + \"_\" + quality.bitrate;\n  }\n}\n__decorateClass$1([\n  prop\n], QualityRadioGroup.prototype, \"value\", 1);\n__decorateClass$1([\n  prop\n], QualityRadioGroup.prototype, \"disabled\", 1);\n__decorateClass$1([\n  method\n], QualityRadioGroup.prototype, \"getOptions\", 1);\n\nclass Gesture extends Component {\n  constructor() {\n    super(...arguments);\n    this._provider = null;\n    this._presses = 0;\n    this._pressTimerId = -1;\n  }\n  static {\n    this.props = {\n      event: void 0,\n      action: void 0\n    };\n  }\n  onSetup() {\n    this._media = useMediaContext();\n    const { event, action } = this.$props;\n    this.setAttributes({\n      event,\n      action\n    });\n  }\n  onAttach(el) {\n    el.setAttribute(\"data-media-gesture\", \"\");\n    el.style.setProperty(\"pointer-events\", \"none\");\n  }\n  onConnect(el) {\n    this._provider = this._media.player.el?.querySelector(\n      \"[data-media-provider]\"\n    );\n    effect(this._attachListener.bind(this));\n  }\n  _attachListener() {\n    let eventType = this.$props.event();\n    if (!this._provider || !eventType)\n      return;\n    if (/^dbl/.test(eventType)) {\n      eventType = eventType.split(/^dbl/)[1];\n    }\n    listenEvent(\n      this._provider,\n      eventType,\n      this._acceptEvent.bind(this)\n    );\n  }\n  _acceptEvent(event) {\n    if (!this._inBounds(event) || isPointerEvent(event) && (event.button !== 0 || this._media.activeMenu)) {\n      return;\n    }\n    event.MEDIA_GESTURE = true;\n    event.preventDefault();\n    const isDblEvent = peek(this.$props.event)?.startsWith(\"dbl\");\n    if (!isDblEvent) {\n      if (this._presses === 0) {\n        setTimeout(() => {\n          if (this._presses === 1)\n            this._handleEvent(event);\n        }, 250);\n      }\n    } else if (this._presses === 1) {\n      queueMicrotask(() => this._handleEvent(event));\n      clearTimeout(this._pressTimerId);\n      this._presses = 0;\n      return;\n    }\n    if (this._presses === 0) {\n      this._pressTimerId = window.setTimeout(() => {\n        this._presses = 0;\n      }, 275);\n    }\n    this._presses++;\n  }\n  _handleEvent(event) {\n    this.el.setAttribute(\"data-triggered\", \"\");\n    requestAnimationFrame(() => {\n      if (this._isTopLayer()) {\n        this._performAction(peek(this.$props.action), event);\n      }\n      requestAnimationFrame(() => {\n        this.el.removeAttribute(\"data-triggered\");\n      });\n    });\n  }\n  /** Validate event occurred in gesture bounds. */\n  _inBounds(event) {\n    if (!this.el)\n      return false;\n    if (isPointerEvent(event) || isMouseEvent(event) || isTouchEvent(event)) {\n      const touch = isTouchEvent(event) ? event.touches[0] : void 0;\n      const clientX = touch?.clientX ?? event.clientX;\n      const clientY = touch?.clientY ?? event.clientY;\n      const rect = this.el.getBoundingClientRect();\n      const inBounds = clientY >= rect.top && clientY <= rect.bottom && clientX >= rect.left && clientX <= rect.right;\n      return event.type.includes(\"leave\") ? !inBounds : inBounds;\n    }\n    return true;\n  }\n  /** Validate gesture has the highest z-index in this triggered group. */\n  _isTopLayer() {\n    const gestures = this._media.player.el.querySelectorAll(\n      \"[data-media-gesture][data-triggered]\"\n    );\n    return Array.from(gestures).sort(\n      (a, b) => +getComputedStyle(b).zIndex - +getComputedStyle(a).zIndex\n    )[0] === this.el;\n  }\n  _performAction(action, trigger) {\n    if (!action)\n      return;\n    const willTriggerEvent = new DOMEvent(\"will-trigger\", {\n      detail: action,\n      cancelable: true,\n      trigger\n    });\n    this.dispatchEvent(willTriggerEvent);\n    if (willTriggerEvent.defaultPrevented)\n      return;\n    const [method, value] = action.replace(/:([a-z])/, \"-$1\").split(\":\");\n    if (action.includes(\":fullscreen\")) {\n      this._media.remote.toggleFullscreen(\"prefer-media\", trigger);\n    } else if (action.includes(\"seek:\")) {\n      this._media.remote.seek(peek(this._media.$state.currentTime) + (+value || 0), trigger);\n    } else {\n      this._media.remote[kebabToCamelCase(method)](trigger);\n    }\n    this.dispatch(\"trigger\", {\n      detail: action,\n      trigger\n    });\n  }\n}\n\nclass CaptionsTextRenderer {\n  constructor(_renderer) {\n    this._renderer = _renderer;\n    this.priority = 10;\n    this._track = null;\n    this._disposal = createDisposalBin();\n  }\n  attach() {\n  }\n  canRender() {\n    return true;\n  }\n  detach() {\n    this._disposal.empty();\n    this._renderer.reset();\n    this._track = null;\n  }\n  changeTrack(track) {\n    if (!track || this._track === track)\n      return;\n    this._disposal.empty();\n    if (track.readyState < 2) {\n      this._renderer.reset();\n      this._disposal.add(\n        listenEvent(track, \"load\", () => this._changeTrack(track), { once: true })\n      );\n    } else {\n      this._changeTrack(track);\n    }\n    this._disposal.add(\n      listenEvent(track, \"add-cue\", (event) => {\n        this._renderer.addCue(event.detail);\n      }),\n      listenEvent(track, \"remove-cue\", (event) => {\n        this._renderer.removeCue(event.detail);\n      })\n    );\n    this._track = track;\n  }\n  _changeTrack(track) {\n    this._renderer.changeTrack({\n      cues: [...track.cues],\n      regions: [...track.regions]\n    });\n  }\n}\n\nclass Captions extends Component {\n  static {\n    this.props = {\n      textDir: \"ltr\"\n    };\n  }\n  onSetup() {\n    this._media = useMediaContext();\n    this.setAttributes({\n      \"aria-hidden\": $ariaBool(this._isHidden.bind(this))\n    });\n  }\n  onAttach(el) {\n    el.style.setProperty(\"pointer-events\", \"none\");\n  }\n  onConnect(el) {\n    if (this._renderer) {\n      effect(this._watchViewType.bind(this));\n      return;\n    }\n    import('media-captions').then((lib) => {\n      if (!this.connectScope)\n        return;\n      scoped(() => {\n        this._lib = lib;\n        const { CaptionsRenderer } = this._lib;\n        this._renderer = new CaptionsRenderer(el);\n        this._textRenderer = new CaptionsTextRenderer(this._renderer);\n        effect(this._watchViewType.bind(this));\n      }, this.connectScope);\n    });\n  }\n  onDestroy() {\n    if (this._textRenderer) {\n      this._textRenderer.detach();\n      this._media.textRenderers.remove(this._textRenderer);\n    }\n    this._renderer?.destroy();\n  }\n  _isHidden() {\n    const { textTrack } = this._media.$state, track = textTrack();\n    return !track || !isTrackCaptionKind(track);\n  }\n  _watchViewType() {\n    const { viewType } = this._media.$state;\n    if (viewType() === \"audio\") {\n      return this._setupAudioView();\n    } else {\n      return this._setupVideoView();\n    }\n  }\n  _setupAudioView() {\n    effect(this._onTrackChange.bind(this));\n    return () => {\n      this.el.textContent = \"\";\n    };\n  }\n  _onTrackChange() {\n    if (this._isHidden())\n      return;\n    const { textTrack } = this._media.$state;\n    this._onCueChange();\n    listenEvent(textTrack(), \"cue-change\", this._onCueChange.bind(this));\n    effect(this._onUpdateTimedNodes.bind(this));\n  }\n  _onCueChange() {\n    this.el.textContent = \"\";\n    const { currentTime, textTrack } = this._media.$state, time = peek(currentTime), activeCues = peek(textTrack).activeCues;\n    const { renderVTTCueString } = this._lib;\n    for (const cue of activeCues) {\n      const cueEl = document.createElement(\"div\");\n      cueEl.setAttribute(\"data-part\", \"cue\");\n      cueEl.innerHTML = renderVTTCueString(cue, time);\n      this.el.append(cueEl);\n    }\n  }\n  _onUpdateTimedNodes() {\n    const { currentTime } = this._media.$state, { updateTimedVTTCueNodes } = this._lib;\n    updateTimedVTTCueNodes(this.el, currentTime());\n  }\n  _setupVideoView() {\n    effect(this._watchTextDirection.bind(this));\n    effect(this._watchMediaTime.bind(this));\n    this._media.textRenderers.add(this._textRenderer);\n    return () => {\n      this.el.textContent = \"\";\n      this._textRenderer.detach();\n      this._media.textRenderers.remove(this._textRenderer);\n    };\n  }\n  _watchTextDirection() {\n    this._renderer.dir = this.$props.textDir();\n  }\n  _watchMediaTime() {\n    if (this._isHidden())\n      return;\n    const { currentTime } = this._media.$state;\n    this._renderer.currentTime = currentTime();\n  }\n}\n\nclass Poster extends Component {\n  static {\n    this.props = {\n      src: void 0,\n      alt: void 0\n    };\n  }\n  static {\n    this.state = new State({\n      img: null,\n      src: null,\n      alt: null,\n      loading: true,\n      error: null,\n      hidden: false\n    });\n  }\n  onSetup() {\n    this._media = useMediaContext();\n    this._watchImgSrc();\n    this._watchImgAlt();\n    this._watchHidden();\n  }\n  onAttach(el) {\n    el.style.setProperty(\"pointer-events\", \"none\");\n    effect(this._watchImg.bind(this));\n    effect(this._watchImgSrc.bind(this));\n    effect(this._watchImgAlt.bind(this));\n    effect(this._watchHidden.bind(this));\n    const { started } = this._media.$state;\n    this.setAttributes({\n      \"data-visible\": () => !started(),\n      \"data-loading\": this._isLoading.bind(this),\n      \"data-error\": this._hasError.bind(this),\n      \"data-hidden\": this.$state.hidden\n    });\n  }\n  onConnect(el) {\n    const { canLoad, poster } = this._media.$state;\n    window.requestAnimationFrame(() => {\n      if (!canLoad())\n        preconnect(poster());\n    });\n    effect(this._onLoadStart.bind(this));\n  }\n  _hasError() {\n    const { error } = this.$state;\n    return !isNull(error());\n  }\n  _watchHidden() {\n    const { src } = this.$props, { poster } = this._media.$state;\n    this.$state.hidden.set(this._hasError() || !(src() || poster()));\n  }\n  _isLoading() {\n    const { loading, hidden } = this.$state;\n    return !hidden() && loading();\n  }\n  _watchImg() {\n    const img = this.$state.img();\n    if (!img)\n      return;\n    listenEvent(img, \"load\", this._onLoad.bind(this));\n    listenEvent(img, \"error\", this._onError.bind(this));\n  }\n  _watchImgSrc() {\n    const { src: _src } = this.$props, { src } = this.$state, { canLoad, poster } = this._media.$state;\n    const _poster = _src() || poster();\n    src.set(canLoad() && _poster.length ? _poster : null);\n  }\n  _watchImgAlt() {\n    const { src, alt } = this.$state;\n    alt.set(src() ? this.$props.alt() : null);\n  }\n  _onLoadStart() {\n    const { loading, error } = this.$state, { canLoad, poster } = this._media.$state;\n    loading.set(canLoad() && !!poster());\n    error.set(null);\n  }\n  _onLoad() {\n    const { loading, error } = this.$state;\n    loading.set(false);\n    error.set(null);\n  }\n  _onError(event) {\n    const { loading, error } = this.$state;\n    loading.set(false);\n    error.set(event);\n  }\n}\n\nclass Time extends Component {\n  static {\n    this.props = {\n      type: \"current\",\n      showHours: false,\n      padHours: null,\n      padMinutes: null,\n      remainder: false\n    };\n  }\n  static {\n    this.state = new State({\n      timeText: \"\"\n    });\n  }\n  onSetup() {\n    this._media = useMediaContext();\n    this._watchTime();\n    const { type, remainder } = this.$props;\n    this.setAttributes({\n      \"data-type\": type,\n      \"data-remainder\": remainder\n    });\n  }\n  onAttach(el) {\n    effect(this._watchTime.bind(this));\n  }\n  _watchTime() {\n    const { type, remainder, padHours, padMinutes, showHours } = this.$props, seconds = this._getSeconds(type()), duration = this._media.$state.duration();\n    if (!Number.isFinite(seconds + duration)) {\n      this.$state.timeText.set(\"LIVE\");\n      return;\n    }\n    const time = remainder() ? Math.max(0, duration - seconds) : seconds, formattedTime = formatTime(time, padHours(), padMinutes(), showHours());\n    this.$state.timeText.set(formattedTime);\n  }\n  _getSeconds(type) {\n    const { bufferedEnd, duration, currentTime } = this._media.$state;\n    switch (type) {\n      case \"buffered\":\n        return bufferedEnd();\n      case \"duration\":\n        return duration();\n      default:\n        return currentTime();\n    }\n  }\n}\n\nvar __defProp = Object.defineProperty;\nvar __getOwnPropDesc = Object.getOwnPropertyDescriptor;\nvar __decorateClass = (decorators, target, key, kind) => {\n  var result = kind > 1 ? void 0 : kind ? __getOwnPropDesc(target, key) : target;\n  for (var i = decorators.length - 1, decorator; i >= 0; i--)\n    if (decorator = decorators[i])\n      result = (kind ? decorator(target, key, result) : decorator(result)) || result;\n  if (kind && result)\n    __defProp(target, key, result);\n  return result;\n};\nclass DefaultLayout extends Component {\n  constructor() {\n    super(...arguments);\n    this.menuContainer = null;\n  }\n  static {\n    this.props = {\n      when: \"\",\n      smallWhen: \"\",\n      thumbnails: \"\",\n      customIcons: false,\n      translations: null,\n      menuGroup: \"bottom\",\n      noModal: false\n    };\n  }\n  get isMatch() {\n    return this._whenQueryList.matches;\n  }\n  get isSmallLayout() {\n    return this._whenSmQueryList.matches;\n  }\n  onSetup() {\n    const { when, smallWhen, thumbnails, translations, menuGroup, noModal } = this.$props;\n    this._whenQueryList = PlayerQueryList.create(when);\n    this._whenSmQueryList = PlayerQueryList.create(smallWhen);\n    this.setAttributes({\n      \"data-match\": this._whenQueryList.$matches,\n      \"data-size\": () => this._whenSmQueryList.matches ? \"sm\" : null\n    });\n    const self = this;\n    provideContext(defaultLayoutContext, {\n      smQueryList: this._whenSmQueryList,\n      thumbnails,\n      translations,\n      menuGroup,\n      noModal,\n      get menuContainer() {\n        return self.menuContainer;\n      }\n    });\n  }\n}\n__decorateClass([\n  prop\n], DefaultLayout.prototype, \"menuContainer\", 2);\n__decorateClass([\n  prop\n], DefaultLayout.prototype, \"isMatch\", 1);\n__decorateClass([\n  prop\n], DefaultLayout.prototype, \"isSmallLayout\", 1);\nclass DefaultAudioLayout extends DefaultLayout {\n  static {\n    this.props = {\n      ...super.props,\n      when: \"(view-type: audio)\",\n      smallWhen: \"(width < 576)\"\n    };\n  }\n}\nclass DefaultVideoLayout extends DefaultLayout {\n  static {\n    this.props = {\n      ...super.props,\n      when: \"(view-type: video)\",\n      smallWhen: \"(width < 576) or (height < 380)\"\n    };\n  }\n}\nfunction getDefaultLayoutLang(translations, word) {\n  return translations()?.[word] ?? word;\n}\nconst defaultLayoutContext = createContext();\nfunction useDefaultLayoutContext() {\n  return useContext(defaultLayoutContext);\n}\n\nexport { LiveButton as $, ARIAKeyShortcuts as A, isHTMLAudioElement as B, isHTMLVideoElement as C, DefaultAudioLayout as D, isHTMLMediaElement as E, FullscreenController as F, sliderContext as G, HLSProviderLoader as H, DefaultLayout as I, defaultLayoutContext as J, getDefaultLayoutLang as K, Logger as L, MediaProvider as M, Controls as N, Tooltip as O, PlayerQueryList as P, TooltipContent as Q, ToggleButton as R, Slider as S, Thumbnail as T, PlayButton as U, VideoQualityList as V, CaptionButton as W, FullscreenButton as X, MuteButton as Y, PIPButton as Z, SeekButton as _, MediaPlayer as a, sliderState as a0, SliderController as a1, SliderVideo as a2, SliderValue as a3, SliderPreview as a4, updateSliderPreviewPlacement as a5, VolumeSlider as a6, TimeSlider as a7, SliderChapters as a8, Menu as a9, MenuButton as aa, MenuPortal as ab, menuPortalContext as ac, MenuItems as ad, RadioGroup as ae, Radio as af, ChaptersRadioGroup as ag, AudioRadioGroup as ah, CaptionsRadioGroup as ai, SpeedRadioGroup as aj, QualityRadioGroup as ak, Gesture as al, Captions as am, Poster as an, Time as ao, ThumbnailsLoader as ap, FocusVisibleController as aq, tooltipContext as ar, useDefaultLayoutContext as b, DefaultVideoLayout as c, formatSpokenTime as d, List as e, formatTime as f, canFullscreen as g, ScreenOrientationController as h, MediaRemoteControl as i, MediaControls as j, MEDIA_KEY_SHORTCUTS as k, mediaState as l, mediaContext as m, TimeRange as n, getTimeRangesStart as o, getTimeRangesEnd as p, TextRenderers as q, TextTrackList as r, softResetMediaState as s, AudioTrackList as t, useMediaContext as u, AudioProviderLoader as v, VideoProviderLoader as w, isAudioProvider as x, isVideoProvider as y, isHLSProvider as z };\n"]},"metadata":{},"sourceType":"module"}