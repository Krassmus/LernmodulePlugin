{"ast":null,"code":"import _defineProperty from \"/home/ann/dev/studip/54/public/plugins_packages/RasmusFuhse/LernmodulePlugin/vue/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nimport { b as VTTCue, p as parseVTTTimestamp } from './index.js';\nconst FORMAT_START_RE = /^Format:[\\s\\t]*/,\n      STYLE_START_RE = /^Style:[\\s\\t]*/,\n      DIALOGUE_START_RE = /^Dialogue:[\\s\\t]*/,\n      FORMAT_SPLIT_RE = /[\\s\\t]*,[\\s\\t]*/,\n      STYLE_FUNCTION_RE = /\\{[^}]+\\}/g,\n      NEW_LINE_RE = /\\\\N/g,\n      STYLES_SECTION_START_RE = /^\\[(.*)[\\s\\t]?Styles\\]$/,\n      EVENTS_SECTION_START_RE = /^\\[(.*)[\\s\\t]?Events\\]$/;\n\nclass SSAParser {\n  constructor() {\n    _defineProperty(this, \"_init\", void 0);\n\n    _defineProperty(this, \"_section\", 0\n    /* None */\n    );\n\n    _defineProperty(this, \"_cue\", null);\n\n    _defineProperty(this, \"_cues\", []);\n\n    _defineProperty(this, \"_errors\", []);\n\n    _defineProperty(this, \"_format\", null);\n\n    _defineProperty(this, \"_errorBuilder\", void 0);\n\n    _defineProperty(this, \"_styles\", {});\n  }\n\n  async init(init) {\n    this._init = init;\n    if (init.errors) this._errorBuilder = (await import('./errors.js')).ParseErrorBuilder;\n  }\n\n  parse(line, lineCount) {\n    if (this._section) {\n      switch (this._section) {\n        case 1\n        /* Style */\n        :\n          if (line === \"\") {\n            this._section = 0\n            /* None */\n            ;\n          } else if (STYLE_START_RE.test(line)) {\n            if (this._format) {\n              const styles = line.replace(STYLE_START_RE, \"\").split(FORMAT_SPLIT_RE);\n\n              this._parseStyles(styles);\n            } else {\n              this._handleError(this._errorBuilder?._missingFormat(\"Style\", lineCount));\n            }\n          } else if (FORMAT_START_RE.test(line)) {\n            this._format = line.replace(FORMAT_START_RE, \"\").split(FORMAT_SPLIT_RE);\n          } else if (EVENTS_SECTION_START_RE.test(line)) {\n            this._format = null;\n            this._section = 2\n            /* Event */\n            ;\n          }\n\n          break;\n\n        case 2\n        /* Event */\n        :\n          if (line === \"\") {\n            this._commitCue();\n          } else if (DIALOGUE_START_RE.test(line)) {\n            this._commitCue();\n\n            if (this._format) {\n              const dialogue = line.replace(DIALOGUE_START_RE, \"\").split(FORMAT_SPLIT_RE),\n                    cue = this._parseDialogue(dialogue, lineCount);\n\n              if (cue) this._cue = cue;\n            } else {\n              this._handleError(this._errorBuilder?._missingFormat(\"Dialogue\", lineCount));\n            }\n          } else if (this._cue) {\n            this._cue.text += \"\\n\" + line.replace(STYLE_FUNCTION_RE, \"\").replace(NEW_LINE_RE, \"\\n\");\n          } else if (FORMAT_START_RE.test(line)) {\n            this._format = line.replace(FORMAT_START_RE, \"\").split(FORMAT_SPLIT_RE);\n          } else if (STYLES_SECTION_START_RE.test(line)) {\n            this._format = null;\n            this._section = 1\n            /* Style */\n            ;\n          } else if (EVENTS_SECTION_START_RE.test(line)) {\n            this._format = null;\n          }\n\n      }\n    } else if (line === \"\") ;else if (STYLES_SECTION_START_RE.test(line)) {\n      this._format = null;\n      this._section = 1\n      /* Style */\n      ;\n    } else if (EVENTS_SECTION_START_RE.test(line)) {\n      this._format = null;\n      this._section = 2\n      /* Event */\n      ;\n    }\n  }\n\n  done() {\n    return {\n      metadata: {},\n      cues: this._cues,\n      regions: [],\n      errors: this._errors\n    };\n  }\n\n  _commitCue() {\n    if (!this._cue) return;\n\n    this._cues.push(this._cue);\n\n    this._init.onCue?.(this._cue);\n    this._cue = null;\n  }\n\n  _parseStyles(values) {\n    let name = \"Default\",\n        styles = {},\n        outlineX,\n        align = \"center\",\n        vertical = \"bottom\",\n        marginV,\n        outlineY = 1.2,\n        outlineColor,\n        bgColor,\n        borderStyle = 3,\n        transform = [];\n\n    for (let i = 0; i < this._format.length; i++) {\n      const field = this._format[i],\n            value = values[i];\n\n      switch (field) {\n        case \"Name\":\n          name = value;\n          break;\n\n        case \"Fontname\":\n          styles[\"font-family\"] = value;\n          break;\n\n        case \"Fontsize\":\n          styles[\"font-size\"] = `calc(${value} / var(--overlay-height))`;\n          break;\n\n        case \"PrimaryColour\":\n          const color = parseColor(value);\n          if (color) styles[\"--cue-color\"] = color;\n          break;\n\n        case \"BorderStyle\":\n          borderStyle = parseInt(value, 10);\n          break;\n\n        case \"BackColour\":\n          bgColor = parseColor(value);\n          break;\n\n        case \"OutlineColour\":\n          const _outlineColor = parseColor(value);\n\n          if (_outlineColor) outlineColor = _outlineColor;\n          break;\n\n        case \"Bold\":\n          if (parseInt(value)) styles[\"font-weight\"] = \"bold\";\n          break;\n\n        case \"Italic\":\n          if (parseInt(value)) styles[\"font-style\"] = \"italic\";\n          break;\n\n        case \"Underline\":\n          if (parseInt(value)) styles[\"text-decoration\"] = \"underline\";\n          break;\n\n        case \"StrikeOut\":\n          if (parseInt(value)) styles[\"text-decoration\"] = \"line-through\";\n          break;\n\n        case \"Spacing\":\n          styles[\"letter-spacing\"] = value + \"px\";\n          break;\n\n        case \"AlphaLevel\":\n          styles[\"opacity\"] = parseFloat(value);\n          break;\n\n        case \"ScaleX\":\n          transform.push(`scaleX(${parseFloat(value) / 100})`);\n          break;\n\n        case \"ScaleY\":\n          transform.push(`scaleY(${parseFloat(value) / 100})`);\n          break;\n\n        case \"Angle\":\n          transform.push(`rotate(${value}deg)`);\n          break;\n\n        case \"Shadow\":\n          outlineY = parseInt(value, 10) * 1.2;\n          break;\n\n        case \"MarginL\":\n          styles[\"--cue-width\"] = \"auto\";\n          styles[\"--cue-left\"] = parseFloat(value) + \"px\";\n          break;\n\n        case \"MarginR\":\n          styles[\"--cue-width\"] = \"auto\";\n          styles[\"--cue-right\"] = parseFloat(value) + \"px\";\n          break;\n\n        case \"MarginV\":\n          marginV = parseFloat(value);\n          break;\n\n        case \"Outline\":\n          outlineX = parseInt(value, 10);\n          break;\n\n        case \"Alignment\":\n          const alignment = parseInt(value, 10);\n          if (alignment >= 4) vertical = alignment >= 7 ? \"top\" : \"center\";\n\n          switch (alignment % 3) {\n            case 1:\n              align = \"start\";\n              break;\n\n            case 2:\n              align = \"center\";\n              break;\n\n            case 3:\n              align = \"end\";\n              break;\n          }\n\n      }\n    }\n\n    styles._vertical = vertical;\n    styles[\"--cue-white-space\"] = \"normal\";\n    styles[\"--cue-line-height\"] = \"normal\";\n    styles[\"--cue-text-align\"] = align;\n\n    if (vertical === \"center\") {\n      styles[`--cue-top`] = \"50%\";\n      transform.push(\"translateY(-50%)\");\n    } else {\n      styles[`--cue-${vertical}`] = (marginV || 0) + \"px\";\n    }\n\n    if (borderStyle === 1) {\n      styles[\"--cue-padding-y\"] = \"0\";\n    }\n\n    if (borderStyle === 1 || bgColor) {\n      styles[\"--cue-bg-color\"] = borderStyle === 1 ? \"none\" : bgColor;\n    }\n\n    if (borderStyle === 3 && outlineColor) {\n      styles[\"--cue-outline\"] = `${outlineX}px solid ${outlineColor}`;\n    }\n\n    if (borderStyle === 1 && typeof outlineX === \"number\") {\n      const color = bgColor ?? \"#000\";\n      styles[\"--cue-text-shadow\"] = [outlineColor && buildTextShadow(outlineX * 1.2, outlineY * 1.2, outlineColor), outlineColor ? buildTextShadow(outlineX * (outlineX / 2), outlineY * (outlineX / 2), color) : buildTextShadow(outlineX, outlineY, color)].filter(Boolean).join(\", \");\n    }\n\n    if (transform.length) styles[\"--cue-transform\"] = transform.join(\" \");\n    this._styles[name] = styles;\n  }\n\n  _parseDialogue(values, lineCount) {\n    const fields = this._buildFields(values);\n\n    const timestamp = this._parseTimestamp(fields.Start, fields.End, lineCount);\n\n    if (!timestamp) return;\n    const cue = new VTTCue(timestamp[0], timestamp[1], \"\"),\n          styles = { ...(this._styles[fields.Style] || {})\n    },\n          voice = fields.Name ? `<v ${fields.Name}>` : \"\";\n    const vertical = styles._vertical,\n          marginLeft = fields.MarginL && parseFloat(fields.MarginL),\n          marginRight = fields.MarginR && parseFloat(fields.MarginR),\n          marginV = fields.MarginV && parseFloat(fields.MarginV);\n\n    if (marginLeft) {\n      styles[\"--cue-width\"] = \"auto\";\n      styles[\"--cue-left\"] = marginLeft + \"px\";\n    }\n\n    if (marginRight) {\n      styles[\"--cue-width\"] = \"auto\";\n      styles[\"--cue-right\"] = marginRight + \"px\";\n    }\n\n    if (marginV && vertical !== \"center\") {\n      styles[`--cue-${vertical}`] = marginV + \"px\";\n    }\n\n    cue.text = voice + values.slice(this._format.length - 1).join(\", \").replace(STYLE_FUNCTION_RE, \"\").replace(NEW_LINE_RE, \"\\n\");\n    delete styles._vertical;\n    if (Object.keys(styles).length) cue.style = styles;\n    return cue;\n  }\n\n  _buildFields(values) {\n    const fields = {};\n\n    for (let i = 0; i < this._format.length; i++) {\n      fields[this._format[i]] = values[i];\n    }\n\n    return fields;\n  }\n\n  _parseTimestamp(startTimeText, endTimeText, lineCount) {\n    const startTime = parseVTTTimestamp(startTimeText),\n          endTime = parseVTTTimestamp(endTimeText);\n\n    if (startTime !== null && endTime !== null && endTime > startTime) {\n      return [startTime, endTime];\n    } else {\n      if (startTime === null) {\n        this._handleError(this._errorBuilder?._badStartTimestamp(startTimeText, lineCount));\n      }\n\n      if (endTime === null) {\n        this._handleError(this._errorBuilder?._badEndTimestamp(endTimeText, lineCount));\n      }\n\n      if (startTime != null && endTime !== null && endTime > startTime) {\n        this._handleError(this._errorBuilder?._badRangeTimestamp(startTime, endTime, lineCount));\n      }\n    }\n  }\n\n  _handleError(error) {\n    if (!error) return;\n\n    this._errors.push(error);\n\n    if (this._init.strict) {\n      this._init.cancel();\n\n      throw error;\n    } else {\n      this._init.onError?.(error);\n    }\n  }\n\n}\n\nfunction parseColor(color) {\n  const abgr = parseInt(color.replace(\"&H\", \"\"), 16);\n\n  if (abgr >= 0) {\n    const a = abgr >> 24 & 255 ^ 255;\n    const alpha = a / 255;\n    const b = abgr >> 16 & 255;\n    const g = abgr >> 8 & 255;\n    const r = abgr & 255;\n    return \"rgba(\" + [r, g, b, alpha].join(\",\") + \")\";\n  }\n\n  return null;\n}\n\nfunction buildTextShadow(x, y, color) {\n  const noOfShadows = Math.ceil(2 * Math.PI * x);\n  let textShadow = \"\";\n\n  for (let i = 0; i < noOfShadows; i++) {\n    const theta = 2 * Math.PI * i / noOfShadows;\n    textShadow += x * Math.cos(theta) + \"px \" + y * Math.sin(theta) + \"px 0 \" + color + (i == noOfShadows - 1 ? \"\" : \",\");\n  }\n\n  return textShadow;\n}\n\nfunction createSSAParser() {\n  return new SSAParser();\n}\n\nexport { SSAParser, createSSAParser as default };","map":{"version":3,"sources":["/home/ann/dev/studip/54/public/plugins_packages/RasmusFuhse/LernmodulePlugin/vue/node_modules/media-captions/dist/dev/ssa-parser.js"],"names":["b","VTTCue","p","parseVTTTimestamp","FORMAT_START_RE","STYLE_START_RE","DIALOGUE_START_RE","FORMAT_SPLIT_RE","STYLE_FUNCTION_RE","NEW_LINE_RE","STYLES_SECTION_START_RE","EVENTS_SECTION_START_RE","SSAParser","init","_init","errors","_errorBuilder","ParseErrorBuilder","parse","line","lineCount","_section","test","_format","styles","replace","split","_parseStyles","_handleError","_missingFormat","_commitCue","dialogue","cue","_parseDialogue","_cue","text","done","metadata","cues","_cues","regions","_errors","push","onCue","values","name","outlineX","align","vertical","marginV","outlineY","outlineColor","bgColor","borderStyle","transform","i","length","field","value","color","parseColor","parseInt","_outlineColor","parseFloat","alignment","_vertical","buildTextShadow","filter","Boolean","join","_styles","fields","_buildFields","timestamp","_parseTimestamp","Start","End","Style","voice","Name","marginLeft","MarginL","marginRight","MarginR","MarginV","slice","Object","keys","style","startTimeText","endTimeText","startTime","endTime","_badStartTimestamp","_badEndTimestamp","_badRangeTimestamp","error","strict","cancel","onError","abgr","a","alpha","g","r","x","y","noOfShadows","Math","ceil","PI","textShadow","theta","cos","sin","createSSAParser","default"],"mappings":"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","sourcesContent":["import { b as VTTCue, p as parseVTTTimestamp } from './index.js';\n\nconst FORMAT_START_RE = /^Format:[\\s\\t]*/, STYLE_START_RE = /^Style:[\\s\\t]*/, DIALOGUE_START_RE = /^Dialogue:[\\s\\t]*/, FORMAT_SPLIT_RE = /[\\s\\t]*,[\\s\\t]*/, STYLE_FUNCTION_RE = /\\{[^}]+\\}/g, NEW_LINE_RE = /\\\\N/g, STYLES_SECTION_START_RE = /^\\[(.*)[\\s\\t]?Styles\\]$/, EVENTS_SECTION_START_RE = /^\\[(.*)[\\s\\t]?Events\\]$/;\nclass SSAParser {\n  _init;\n  _section = 0 /* None */;\n  _cue = null;\n  _cues = [];\n  _errors = [];\n  _format = null;\n  _errorBuilder;\n  _styles = {};\n  async init(init) {\n    this._init = init;\n    if (init.errors)\n      this._errorBuilder = (await import('./errors.js')).ParseErrorBuilder;\n  }\n  parse(line, lineCount) {\n    if (this._section) {\n      switch (this._section) {\n        case 1 /* Style */:\n          if (line === \"\") {\n            this._section = 0 /* None */;\n          } else if (STYLE_START_RE.test(line)) {\n            if (this._format) {\n              const styles = line.replace(STYLE_START_RE, \"\").split(FORMAT_SPLIT_RE);\n              this._parseStyles(styles);\n            } else {\n              this._handleError(this._errorBuilder?._missingFormat(\"Style\", lineCount));\n            }\n          } else if (FORMAT_START_RE.test(line)) {\n            this._format = line.replace(FORMAT_START_RE, \"\").split(FORMAT_SPLIT_RE);\n          } else if (EVENTS_SECTION_START_RE.test(line)) {\n            this._format = null;\n            this._section = 2 /* Event */;\n          }\n          break;\n        case 2 /* Event */:\n          if (line === \"\") {\n            this._commitCue();\n          } else if (DIALOGUE_START_RE.test(line)) {\n            this._commitCue();\n            if (this._format) {\n              const dialogue = line.replace(DIALOGUE_START_RE, \"\").split(FORMAT_SPLIT_RE), cue = this._parseDialogue(dialogue, lineCount);\n              if (cue)\n                this._cue = cue;\n            } else {\n              this._handleError(this._errorBuilder?._missingFormat(\"Dialogue\", lineCount));\n            }\n          } else if (this._cue) {\n            this._cue.text += \"\\n\" + line.replace(STYLE_FUNCTION_RE, \"\").replace(NEW_LINE_RE, \"\\n\");\n          } else if (FORMAT_START_RE.test(line)) {\n            this._format = line.replace(FORMAT_START_RE, \"\").split(FORMAT_SPLIT_RE);\n          } else if (STYLES_SECTION_START_RE.test(line)) {\n            this._format = null;\n            this._section = 1 /* Style */;\n          } else if (EVENTS_SECTION_START_RE.test(line)) {\n            this._format = null;\n          }\n      }\n    } else if (line === \"\") ; else if (STYLES_SECTION_START_RE.test(line)) {\n      this._format = null;\n      this._section = 1 /* Style */;\n    } else if (EVENTS_SECTION_START_RE.test(line)) {\n      this._format = null;\n      this._section = 2 /* Event */;\n    }\n  }\n  done() {\n    return {\n      metadata: {},\n      cues: this._cues,\n      regions: [],\n      errors: this._errors\n    };\n  }\n  _commitCue() {\n    if (!this._cue)\n      return;\n    this._cues.push(this._cue);\n    this._init.onCue?.(this._cue);\n    this._cue = null;\n  }\n  _parseStyles(values) {\n    let name = \"Default\", styles = {}, outlineX, align = \"center\", vertical = \"bottom\", marginV, outlineY = 1.2, outlineColor, bgColor, borderStyle = 3, transform = [];\n    for (let i = 0; i < this._format.length; i++) {\n      const field = this._format[i], value = values[i];\n      switch (field) {\n        case \"Name\":\n          name = value;\n          break;\n        case \"Fontname\":\n          styles[\"font-family\"] = value;\n          break;\n        case \"Fontsize\":\n          styles[\"font-size\"] = `calc(${value} / var(--overlay-height))`;\n          break;\n        case \"PrimaryColour\":\n          const color = parseColor(value);\n          if (color)\n            styles[\"--cue-color\"] = color;\n          break;\n        case \"BorderStyle\":\n          borderStyle = parseInt(value, 10);\n          break;\n        case \"BackColour\":\n          bgColor = parseColor(value);\n          break;\n        case \"OutlineColour\":\n          const _outlineColor = parseColor(value);\n          if (_outlineColor)\n            outlineColor = _outlineColor;\n          break;\n        case \"Bold\":\n          if (parseInt(value))\n            styles[\"font-weight\"] = \"bold\";\n          break;\n        case \"Italic\":\n          if (parseInt(value))\n            styles[\"font-style\"] = \"italic\";\n          break;\n        case \"Underline\":\n          if (parseInt(value))\n            styles[\"text-decoration\"] = \"underline\";\n          break;\n        case \"StrikeOut\":\n          if (parseInt(value))\n            styles[\"text-decoration\"] = \"line-through\";\n          break;\n        case \"Spacing\":\n          styles[\"letter-spacing\"] = value + \"px\";\n          break;\n        case \"AlphaLevel\":\n          styles[\"opacity\"] = parseFloat(value);\n          break;\n        case \"ScaleX\":\n          transform.push(`scaleX(${parseFloat(value) / 100})`);\n          break;\n        case \"ScaleY\":\n          transform.push(`scaleY(${parseFloat(value) / 100})`);\n          break;\n        case \"Angle\":\n          transform.push(`rotate(${value}deg)`);\n          break;\n        case \"Shadow\":\n          outlineY = parseInt(value, 10) * 1.2;\n          break;\n        case \"MarginL\":\n          styles[\"--cue-width\"] = \"auto\";\n          styles[\"--cue-left\"] = parseFloat(value) + \"px\";\n          break;\n        case \"MarginR\":\n          styles[\"--cue-width\"] = \"auto\";\n          styles[\"--cue-right\"] = parseFloat(value) + \"px\";\n          break;\n        case \"MarginV\":\n          marginV = parseFloat(value);\n          break;\n        case \"Outline\":\n          outlineX = parseInt(value, 10);\n          break;\n        case \"Alignment\":\n          const alignment = parseInt(value, 10);\n          if (alignment >= 4)\n            vertical = alignment >= 7 ? \"top\" : \"center\";\n          switch (alignment % 3) {\n            case 1:\n              align = \"start\";\n              break;\n            case 2:\n              align = \"center\";\n              break;\n            case 3:\n              align = \"end\";\n              break;\n          }\n      }\n    }\n    styles._vertical = vertical;\n    styles[\"--cue-white-space\"] = \"normal\";\n    styles[\"--cue-line-height\"] = \"normal\";\n    styles[\"--cue-text-align\"] = align;\n    if (vertical === \"center\") {\n      styles[`--cue-top`] = \"50%\";\n      transform.push(\"translateY(-50%)\");\n    } else {\n      styles[`--cue-${vertical}`] = (marginV || 0) + \"px\";\n    }\n    if (borderStyle === 1) {\n      styles[\"--cue-padding-y\"] = \"0\";\n    }\n    if (borderStyle === 1 || bgColor) {\n      styles[\"--cue-bg-color\"] = borderStyle === 1 ? \"none\" : bgColor;\n    }\n    if (borderStyle === 3 && outlineColor) {\n      styles[\"--cue-outline\"] = `${outlineX}px solid ${outlineColor}`;\n    }\n    if (borderStyle === 1 && typeof outlineX === \"number\") {\n      const color = bgColor ?? \"#000\";\n      styles[\"--cue-text-shadow\"] = [\n        outlineColor && buildTextShadow(outlineX * 1.2, outlineY * 1.2, outlineColor),\n        outlineColor ? buildTextShadow(outlineX * (outlineX / 2), outlineY * (outlineX / 2), color) : buildTextShadow(outlineX, outlineY, color)\n      ].filter(Boolean).join(\", \");\n    }\n    if (transform.length)\n      styles[\"--cue-transform\"] = transform.join(\" \");\n    this._styles[name] = styles;\n  }\n  _parseDialogue(values, lineCount) {\n    const fields = this._buildFields(values);\n    const timestamp = this._parseTimestamp(fields.Start, fields.End, lineCount);\n    if (!timestamp)\n      return;\n    const cue = new VTTCue(timestamp[0], timestamp[1], \"\"), styles = { ...this._styles[fields.Style] || {} }, voice = fields.Name ? `<v ${fields.Name}>` : \"\";\n    const vertical = styles._vertical, marginLeft = fields.MarginL && parseFloat(fields.MarginL), marginRight = fields.MarginR && parseFloat(fields.MarginR), marginV = fields.MarginV && parseFloat(fields.MarginV);\n    if (marginLeft) {\n      styles[\"--cue-width\"] = \"auto\";\n      styles[\"--cue-left\"] = marginLeft + \"px\";\n    }\n    if (marginRight) {\n      styles[\"--cue-width\"] = \"auto\";\n      styles[\"--cue-right\"] = marginRight + \"px\";\n    }\n    if (marginV && vertical !== \"center\") {\n      styles[`--cue-${vertical}`] = marginV + \"px\";\n    }\n    cue.text = voice + values.slice(this._format.length - 1).join(\", \").replace(STYLE_FUNCTION_RE, \"\").replace(NEW_LINE_RE, \"\\n\");\n    delete styles._vertical;\n    if (Object.keys(styles).length)\n      cue.style = styles;\n    return cue;\n  }\n  _buildFields(values) {\n    const fields = {};\n    for (let i = 0; i < this._format.length; i++) {\n      fields[this._format[i]] = values[i];\n    }\n    return fields;\n  }\n  _parseTimestamp(startTimeText, endTimeText, lineCount) {\n    const startTime = parseVTTTimestamp(startTimeText), endTime = parseVTTTimestamp(endTimeText);\n    if (startTime !== null && endTime !== null && endTime > startTime) {\n      return [startTime, endTime];\n    } else {\n      if (startTime === null) {\n        this._handleError(this._errorBuilder?._badStartTimestamp(startTimeText, lineCount));\n      }\n      if (endTime === null) {\n        this._handleError(this._errorBuilder?._badEndTimestamp(endTimeText, lineCount));\n      }\n      if (startTime != null && endTime !== null && endTime > startTime) {\n        this._handleError(this._errorBuilder?._badRangeTimestamp(startTime, endTime, lineCount));\n      }\n    }\n  }\n  _handleError(error) {\n    if (!error)\n      return;\n    this._errors.push(error);\n    if (this._init.strict) {\n      this._init.cancel();\n      throw error;\n    } else {\n      this._init.onError?.(error);\n    }\n  }\n}\nfunction parseColor(color) {\n  const abgr = parseInt(color.replace(\"&H\", \"\"), 16);\n  if (abgr >= 0) {\n    const a = abgr >> 24 & 255 ^ 255;\n    const alpha = a / 255;\n    const b = abgr >> 16 & 255;\n    const g = abgr >> 8 & 255;\n    const r = abgr & 255;\n    return \"rgba(\" + [r, g, b, alpha].join(\",\") + \")\";\n  }\n  return null;\n}\nfunction buildTextShadow(x, y, color) {\n  const noOfShadows = Math.ceil(2 * Math.PI * x);\n  let textShadow = \"\";\n  for (let i = 0; i < noOfShadows; i++) {\n    const theta = 2 * Math.PI * i / noOfShadows;\n    textShadow += x * Math.cos(theta) + \"px \" + y * Math.sin(theta) + \"px 0 \" + color + (i == noOfShadows - 1 ? \"\" : \",\");\n  }\n  return textShadow;\n}\nfunction createSSAParser() {\n  return new SSAParser();\n}\n\nexport { SSAParser, createSSAParser as default };\n"]},"metadata":{},"sourceType":"module"}